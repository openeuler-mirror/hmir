(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[0],{

/***/ "./node_modules/base64-js/index.js":
/*!*****************************************!*\
  !*** ./node_modules/base64-js/index.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYmFzZTY0LWpzL2luZGV4LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2Jhc2U2NC1qcy9pbmRleC5qcz8xZmI1Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5leHBvcnRzLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoXG5leHBvcnRzLnRvQnl0ZUFycmF5ID0gdG9CeXRlQXJyYXlcbmV4cG9ydHMuZnJvbUJ5dGVBcnJheSA9IGZyb21CeXRlQXJyYXlcblxudmFyIGxvb2t1cCA9IFtdXG52YXIgcmV2TG9va3VwID0gW11cbnZhciBBcnIgPSB0eXBlb2YgVWludDhBcnJheSAhPT0gJ3VuZGVmaW5lZCcgPyBVaW50OEFycmF5IDogQXJyYXlcblxudmFyIGNvZGUgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLydcbmZvciAodmFyIGkgPSAwLCBsZW4gPSBjb2RlLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gIGxvb2t1cFtpXSA9IGNvZGVbaV1cbiAgcmV2TG9va3VwW2NvZGUuY2hhckNvZGVBdChpKV0gPSBpXG59XG5cbi8vIFN1cHBvcnQgZGVjb2RpbmcgVVJMLXNhZmUgYmFzZTY0IHN0cmluZ3MsIGFzIE5vZGUuanMgZG9lcy5cbi8vIFNlZTogaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQmFzZTY0I1VSTF9hcHBsaWNhdGlvbnNcbnJldkxvb2t1cFsnLScuY2hhckNvZGVBdCgwKV0gPSA2MlxucmV2TG9va3VwWydfJy5jaGFyQ29kZUF0KDApXSA9IDYzXG5cbmZ1bmN0aW9uIGdldExlbnMgKGI2NCkge1xuICB2YXIgbGVuID0gYjY0Lmxlbmd0aFxuXG4gIGlmIChsZW4gJSA0ID4gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJpbmcuIExlbmd0aCBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNCcpXG4gIH1cblxuICAvLyBUcmltIG9mZiBleHRyYSBieXRlcyBhZnRlciBwbGFjZWhvbGRlciBieXRlcyBhcmUgZm91bmRcbiAgLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vYmVhdGdhbW1pdC9iYXNlNjQtanMvaXNzdWVzLzQyXG4gIHZhciB2YWxpZExlbiA9IGI2NC5pbmRleE9mKCc9JylcbiAgaWYgKHZhbGlkTGVuID09PSAtMSkgdmFsaWRMZW4gPSBsZW5cblxuICB2YXIgcGxhY2VIb2xkZXJzTGVuID0gdmFsaWRMZW4gPT09IGxlblxuICAgID8gMFxuICAgIDogNCAtICh2YWxpZExlbiAlIDQpXG5cbiAgcmV0dXJuIFt2YWxpZExlbiwgcGxhY2VIb2xkZXJzTGVuXVxufVxuXG4vLyBiYXNlNjQgaXMgNC8zICsgdXAgdG8gdHdvIGNoYXJhY3RlcnMgb2YgdGhlIG9yaWdpbmFsIGRhdGFcbmZ1bmN0aW9uIGJ5dGVMZW5ndGggKGI2NCkge1xuICB2YXIgbGVucyA9IGdldExlbnMoYjY0KVxuICB2YXIgdmFsaWRMZW4gPSBsZW5zWzBdXG4gIHZhciBwbGFjZUhvbGRlcnNMZW4gPSBsZW5zWzFdXG4gIHJldHVybiAoKHZhbGlkTGVuICsgcGxhY2VIb2xkZXJzTGVuKSAqIDMgLyA0KSAtIHBsYWNlSG9sZGVyc0xlblxufVxuXG5mdW5jdGlvbiBfYnl0ZUxlbmd0aCAoYjY0LCB2YWxpZExlbiwgcGxhY2VIb2xkZXJzTGVuKSB7XG4gIHJldHVybiAoKHZhbGlkTGVuICsgcGxhY2VIb2xkZXJzTGVuKSAqIDMgLyA0KSAtIHBsYWNlSG9sZGVyc0xlblxufVxuXG5mdW5jdGlvbiB0b0J5dGVBcnJheSAoYjY0KSB7XG4gIHZhciB0bXBcbiAgdmFyIGxlbnMgPSBnZXRMZW5zKGI2NClcbiAgdmFyIHZhbGlkTGVuID0gbGVuc1swXVxuICB2YXIgcGxhY2VIb2xkZXJzTGVuID0gbGVuc1sxXVxuXG4gIHZhciBhcnIgPSBuZXcgQXJyKF9ieXRlTGVuZ3RoKGI2NCwgdmFsaWRMZW4sIHBsYWNlSG9sZGVyc0xlbikpXG5cbiAgdmFyIGN1ckJ5dGUgPSAwXG5cbiAgLy8gaWYgdGhlcmUgYXJlIHBsYWNlaG9sZGVycywgb25seSBnZXQgdXAgdG8gdGhlIGxhc3QgY29tcGxldGUgNCBjaGFyc1xuICB2YXIgbGVuID0gcGxhY2VIb2xkZXJzTGVuID4gMFxuICAgID8gdmFsaWRMZW4gLSA0XG4gICAgOiB2YWxpZExlblxuXG4gIHZhciBpXG4gIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgIHRtcCA9XG4gICAgICAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAxOCkgfFxuICAgICAgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDEyKSB8XG4gICAgICAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAyKV0gPDwgNikgfFxuICAgICAgcmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAzKV1cbiAgICBhcnJbY3VyQnl0ZSsrXSA9ICh0bXAgPj4gMTYpICYgMHhGRlxuICAgIGFycltjdXJCeXRlKytdID0gKHRtcCA+PiA4KSAmIDB4RkZcbiAgICBhcnJbY3VyQnl0ZSsrXSA9IHRtcCAmIDB4RkZcbiAgfVxuXG4gIGlmIChwbGFjZUhvbGRlcnNMZW4gPT09IDIpIHtcbiAgICB0bXAgPVxuICAgICAgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMikgfFxuICAgICAgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldID4+IDQpXG4gICAgYXJyW2N1ckJ5dGUrK10gPSB0bXAgJiAweEZGXG4gIH1cblxuICBpZiAocGxhY2VIb2xkZXJzTGVuID09PSAxKSB7XG4gICAgdG1wID1cbiAgICAgIChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDEwKSB8XG4gICAgICAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPDwgNCkgfFxuICAgICAgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildID4+IDIpXG4gICAgYXJyW2N1ckJ5dGUrK10gPSAodG1wID4+IDgpICYgMHhGRlxuICAgIGFycltjdXJCeXRlKytdID0gdG1wICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIGFyclxufVxuXG5mdW5jdGlvbiB0cmlwbGV0VG9CYXNlNjQgKG51bSkge1xuICByZXR1cm4gbG9va3VwW251bSA+PiAxOCAmIDB4M0ZdICtcbiAgICBsb29rdXBbbnVtID4+IDEyICYgMHgzRl0gK1xuICAgIGxvb2t1cFtudW0gPj4gNiAmIDB4M0ZdICtcbiAgICBsb29rdXBbbnVtICYgMHgzRl1cbn1cblxuZnVuY3Rpb24gZW5jb2RlQ2h1bmsgKHVpbnQ4LCBzdGFydCwgZW5kKSB7XG4gIHZhciB0bXBcbiAgdmFyIG91dHB1dCA9IFtdXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSArPSAzKSB7XG4gICAgdG1wID1cbiAgICAgICgodWludDhbaV0gPDwgMTYpICYgMHhGRjAwMDApICtcbiAgICAgICgodWludDhbaSArIDFdIDw8IDgpICYgMHhGRjAwKSArXG4gICAgICAodWludDhbaSArIDJdICYgMHhGRilcbiAgICBvdXRwdXQucHVzaCh0cmlwbGV0VG9CYXNlNjQodG1wKSlcbiAgfVxuICByZXR1cm4gb3V0cHV0LmpvaW4oJycpXG59XG5cbmZ1bmN0aW9uIGZyb21CeXRlQXJyYXkgKHVpbnQ4KSB7XG4gIHZhciB0bXBcbiAgdmFyIGxlbiA9IHVpbnQ4Lmxlbmd0aFxuICB2YXIgZXh0cmFCeXRlcyA9IGxlbiAlIDMgLy8gaWYgd2UgaGF2ZSAxIGJ5dGUgbGVmdCwgcGFkIDIgYnl0ZXNcbiAgdmFyIHBhcnRzID0gW11cbiAgdmFyIG1heENodW5rTGVuZ3RoID0gMTYzODMgLy8gbXVzdCBiZSBtdWx0aXBsZSBvZiAzXG5cbiAgLy8gZ28gdGhyb3VnaCB0aGUgYXJyYXkgZXZlcnkgdGhyZWUgYnl0ZXMsIHdlJ2xsIGRlYWwgd2l0aCB0cmFpbGluZyBzdHVmZiBsYXRlclxuICBmb3IgKHZhciBpID0gMCwgbGVuMiA9IGxlbiAtIGV4dHJhQnl0ZXM7IGkgPCBsZW4yOyBpICs9IG1heENodW5rTGVuZ3RoKSB7XG4gICAgcGFydHMucHVzaChlbmNvZGVDaHVuayh1aW50OCwgaSwgKGkgKyBtYXhDaHVua0xlbmd0aCkgPiBsZW4yID8gbGVuMiA6IChpICsgbWF4Q2h1bmtMZW5ndGgpKSlcbiAgfVxuXG4gIC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXNcbiAgaWYgKGV4dHJhQnl0ZXMgPT09IDEpIHtcbiAgICB0bXAgPSB1aW50OFtsZW4gLSAxXVxuICAgIHBhcnRzLnB1c2goXG4gICAgICBsb29rdXBbdG1wID4+IDJdICtcbiAgICAgIGxvb2t1cFsodG1wIDw8IDQpICYgMHgzRl0gK1xuICAgICAgJz09J1xuICAgIClcbiAgfSBlbHNlIGlmIChleHRyYUJ5dGVzID09PSAyKSB7XG4gICAgdG1wID0gKHVpbnQ4W2xlbiAtIDJdIDw8IDgpICsgdWludDhbbGVuIC0gMV1cbiAgICBwYXJ0cy5wdXNoKFxuICAgICAgbG9va3VwW3RtcCA+PiAxMF0gK1xuICAgICAgbG9va3VwWyh0bXAgPj4gNCkgJiAweDNGXSArXG4gICAgICBsb29rdXBbKHRtcCA8PCAyKSAmIDB4M0ZdICtcbiAgICAgICc9J1xuICAgIClcbiAgfVxuXG4gIHJldHVybiBwYXJ0cy5qb2luKCcnKVxufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/base64-js/index.js\n");

/***/ }),

/***/ "./node_modules/buffer/index.js":
/*!**************************************!*\
  !*** ./node_modules/buffer/index.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(global) {/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n\n\nvar base64 = __webpack_require__(/*! base64-js */ \"./node_modules/base64-js/index.js\")\nvar ieee754 = __webpack_require__(/*! ieee754 */ \"./node_modules/ieee754/index.js\")\nvar isArray = __webpack_require__(/*! isarray */ \"./node_modules/isarray/index.js\")\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\")))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYnVmZmVyL2luZGV4LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2J1ZmZlci9pbmRleC5qcz9iNjM5Il0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogVGhlIGJ1ZmZlciBtb2R1bGUgZnJvbSBub2RlLmpzLCBmb3IgdGhlIGJyb3dzZXIuXG4gKlxuICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGh0dHA6Ly9mZXJvc3Mub3JnPlxuICogQGxpY2Vuc2UgIE1JVFxuICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqL1xuXG4ndXNlIHN0cmljdCdcblxudmFyIGJhc2U2NCA9IHJlcXVpcmUoJ2Jhc2U2NC1qcycpXG52YXIgaWVlZTc1NCA9IHJlcXVpcmUoJ2llZWU3NTQnKVxudmFyIGlzQXJyYXkgPSByZXF1aXJlKCdpc2FycmF5JylcblxuZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXJcbmV4cG9ydHMuU2xvd0J1ZmZlciA9IFNsb3dCdWZmZXJcbmV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMgPSA1MFxuXG4vKipcbiAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6XG4gKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KVxuICogICA9PT0gZmFsc2UgICBVc2UgT2JqZWN0IGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KVxuICpcbiAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKyxcbiAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy5cbiAqXG4gKiBEdWUgdG8gdmFyaW91cyBicm93c2VyIGJ1Z3MsIHNvbWV0aW1lcyB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uIHdpbGwgYmUgdXNlZCBldmVuXG4gKiB3aGVuIHRoZSBicm93c2VyIHN1cHBvcnRzIHR5cGVkIGFycmF5cy5cbiAqXG4gKiBOb3RlOlxuICpcbiAqICAgLSBGaXJlZm94IDQtMjkgbGFja3Mgc3VwcG9ydCBmb3IgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMsXG4gKiAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzguXG4gKlxuICogICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uXG4gKlxuICogICAtIElFMTAgaGFzIGEgYnJva2VuIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhcnJheXMgb2ZcbiAqICAgICBpbmNvcnJlY3QgbGVuZ3RoIGluIHNvbWUgc2l0dWF0aW9ucy5cblxuICogV2UgZGV0ZWN0IHRoZXNlIGJ1Z2d5IGJyb3dzZXJzIGFuZCBzZXQgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYCB0byBgZmFsc2VgIHNvIHRoZXlcbiAqIGdldCB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uLCB3aGljaCBpcyBzbG93ZXIgYnV0IGJlaGF2ZXMgY29ycmVjdGx5LlxuICovXG5CdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCA9IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUICE9PSB1bmRlZmluZWRcbiAgPyBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVFxuICA6IHR5cGVkQXJyYXlTdXBwb3J0KClcblxuLypcbiAqIEV4cG9ydCBrTWF4TGVuZ3RoIGFmdGVyIHR5cGVkIGFycmF5IHN1cHBvcnQgaXMgZGV0ZXJtaW5lZC5cbiAqL1xuZXhwb3J0cy5rTWF4TGVuZ3RoID0ga01heExlbmd0aCgpXG5cbmZ1bmN0aW9uIHR5cGVkQXJyYXlTdXBwb3J0ICgpIHtcbiAgdHJ5IHtcbiAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSlcbiAgICBhcnIuX19wcm90b19fID0ge19fcHJvdG9fXzogVWludDhBcnJheS5wcm90b3R5cGUsIGZvbzogZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfX1cbiAgICByZXR1cm4gYXJyLmZvbygpID09PSA0MiAmJiAvLyB0eXBlZCBhcnJheSBpbnN0YW5jZXMgY2FuIGJlIGF1Z21lbnRlZFxuICAgICAgICB0eXBlb2YgYXJyLnN1YmFycmF5ID09PSAnZnVuY3Rpb24nICYmIC8vIGNocm9tZSA5LTEwIGxhY2sgYHN1YmFycmF5YFxuICAgICAgICBhcnIuc3ViYXJyYXkoMSwgMSkuYnl0ZUxlbmd0aCA9PT0gMCAvLyBpZTEwIGhhcyBicm9rZW4gYHN1YmFycmF5YFxuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZnVuY3Rpb24ga01heExlbmd0aCAoKSB7XG4gIHJldHVybiBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVFxuICAgID8gMHg3ZmZmZmZmZlxuICAgIDogMHgzZmZmZmZmZlxufVxuXG5mdW5jdGlvbiBjcmVhdGVCdWZmZXIgKHRoYXQsIGxlbmd0aCkge1xuICBpZiAoa01heExlbmd0aCgpIDwgbGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdHlwZWQgYXJyYXkgbGVuZ3RoJylcbiAgfVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKVxuICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3NcbiAgICBpZiAodGhhdCA9PT0gbnVsbCkge1xuICAgICAgdGhhdCA9IG5ldyBCdWZmZXIobGVuZ3RoKVxuICAgIH1cbiAgICB0aGF0Lmxlbmd0aCA9IGxlbmd0aFxuICB9XG5cbiAgcmV0dXJuIHRoYXRcbn1cblxuLyoqXG4gKiBUaGUgQnVmZmVyIGNvbnN0cnVjdG9yIHJldHVybnMgaW5zdGFuY2VzIG9mIGBVaW50OEFycmF5YCB0aGF0IGhhdmUgdGhlaXJcbiAqIHByb3RvdHlwZSBjaGFuZ2VkIHRvIGBCdWZmZXIucHJvdG90eXBlYC4gRnVydGhlcm1vcmUsIGBCdWZmZXJgIGlzIGEgc3ViY2xhc3Mgb2ZcbiAqIGBVaW50OEFycmF5YCwgc28gdGhlIHJldHVybmVkIGluc3RhbmNlcyB3aWxsIGhhdmUgYWxsIHRoZSBub2RlIGBCdWZmZXJgIG1ldGhvZHNcbiAqIGFuZCB0aGUgYFVpbnQ4QXJyYXlgIG1ldGhvZHMuIFNxdWFyZSBicmFja2V0IG5vdGF0aW9uIHdvcmtzIGFzIGV4cGVjdGVkIC0tIGl0XG4gKiByZXR1cm5zIGEgc2luZ2xlIG9jdGV0LlxuICpcbiAqIFRoZSBgVWludDhBcnJheWAgcHJvdG90eXBlIHJlbWFpbnMgdW5tb2RpZmllZC5cbiAqL1xuXG5mdW5jdGlvbiBCdWZmZXIgKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiYgISh0aGlzIGluc3RhbmNlb2YgQnVmZmVyKSkge1xuICAgIHJldHVybiBuZXcgQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgLy8gQ29tbW9uIGNhc2UuXG4gIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykge1xuICAgIGlmICh0eXBlb2YgZW5jb2RpbmdPck9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0lmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nJ1xuICAgICAgKVxuICAgIH1cbiAgICByZXR1cm4gYWxsb2NVbnNhZmUodGhpcywgYXJnKVxuICB9XG4gIHJldHVybiBmcm9tKHRoaXMsIGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxufVxuXG5CdWZmZXIucG9vbFNpemUgPSA4MTkyIC8vIG5vdCB1c2VkIGJ5IHRoaXMgaW1wbGVtZW50YXRpb25cblxuLy8gVE9ETzogTGVnYWN5LCBub3QgbmVlZGVkIGFueW1vcmUuIFJlbW92ZSBpbiBuZXh0IG1ham9yIHZlcnNpb24uXG5CdWZmZXIuX2F1Z21lbnQgPSBmdW5jdGlvbiAoYXJyKSB7XG4gIGFyci5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIHJldHVybiBhcnJcbn1cblxuZnVuY3Rpb24gZnJvbSAodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widmFsdWVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpXG4gIH1cblxuICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgcmV0dXJuIGZyb21BcnJheUJ1ZmZlcih0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZnJvbVN0cmluZyh0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldClcbiAgfVxuXG4gIHJldHVybiBmcm9tT2JqZWN0KHRoYXQsIHZhbHVlKVxufVxuXG4vKipcbiAqIEZ1bmN0aW9uYWxseSBlcXVpdmFsZW50IHRvIEJ1ZmZlcihhcmcsIGVuY29kaW5nKSBidXQgdGhyb3dzIGEgVHlwZUVycm9yXG4gKiBpZiB2YWx1ZSBpcyBhIG51bWJlci5cbiAqIEJ1ZmZlci5mcm9tKHN0clssIGVuY29kaW5nXSlcbiAqIEJ1ZmZlci5mcm9tKGFycmF5KVxuICogQnVmZmVyLmZyb20oYnVmZmVyKVxuICogQnVmZmVyLmZyb20oYXJyYXlCdWZmZXJbLCBieXRlT2Zmc2V0WywgbGVuZ3RoXV0pXG4gKiovXG5CdWZmZXIuZnJvbSA9IGZ1bmN0aW9uICh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBmcm9tKG51bGwsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpXG59XG5cbmlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICBCdWZmZXIucHJvdG90eXBlLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkucHJvdG90eXBlXG4gIEJ1ZmZlci5fX3Byb3RvX18gPSBVaW50OEFycmF5XG4gIGlmICh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wuc3BlY2llcyAmJlxuICAgICAgQnVmZmVyW1N5bWJvbC5zcGVjaWVzXSA9PT0gQnVmZmVyKSB7XG4gICAgLy8gRml4IHN1YmFycmF5KCkgaW4gRVMyMDE2LiBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL3B1bGwvOTdcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyLCBTeW1ib2wuc3BlY2llcywge1xuICAgICAgdmFsdWU6IG51bGwsXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KVxuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFNpemUgKHNpemUpIHtcbiAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3QgYmUgYSBudW1iZXInKVxuICB9IGVsc2UgaWYgKHNpemUgPCAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJylcbiAgfVxufVxuXG5mdW5jdGlvbiBhbGxvYyAodGhhdCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHtcbiAgYXNzZXJ0U2l6ZShzaXplKVxuICBpZiAoc2l6ZSA8PSAwKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxuICB9XG4gIGlmIChmaWxsICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBPbmx5IHBheSBhdHRlbnRpb24gdG8gZW5jb2RpbmcgaWYgaXQncyBhIHN0cmluZy4gVGhpc1xuICAgIC8vIHByZXZlbnRzIGFjY2lkZW50YWxseSBzZW5kaW5nIGluIGEgbnVtYmVyIHRoYXQgd291bGRcbiAgICAvLyBiZSBpbnRlcnByZXR0ZWQgYXMgYSBzdGFydCBvZmZzZXQuXG4gICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZydcbiAgICAgID8gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpLmZpbGwoZmlsbCwgZW5jb2RpbmcpXG4gICAgICA6IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwpXG4gIH1cbiAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqIGFsbG9jKHNpemVbLCBmaWxsWywgZW5jb2RpbmddXSlcbiAqKi9cbkJ1ZmZlci5hbGxvYyA9IGZ1bmN0aW9uIChzaXplLCBmaWxsLCBlbmNvZGluZykge1xuICByZXR1cm4gYWxsb2MobnVsbCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpXG59XG5cbmZ1bmN0aW9uIGFsbG9jVW5zYWZlICh0aGF0LCBzaXplKSB7XG4gIGFzc2VydFNpemUoc2l6ZSlcbiAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplIDwgMCA/IDAgOiBjaGVja2VkKHNpemUpIHwgMClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgKytpKSB7XG4gICAgICB0aGF0W2ldID0gMFxuICAgIH1cbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gQnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuXG4gKiAqL1xuQnVmZmVyLmFsbG9jVW5zYWZlID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gU2xvd0J1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICovXG5CdWZmZXIuYWxsb2NVbnNhZmVTbG93ID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG5cbmZ1bmN0aW9uIGZyb21TdHJpbmcgKHRoYXQsIHN0cmluZywgZW5jb2RpbmcpIHtcbiAgaWYgKHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycgfHwgZW5jb2RpbmcgPT09ICcnKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgfVxuXG4gIGlmICghQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJlbmNvZGluZ1wiIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKVxuICB9XG5cbiAgdmFyIGxlbmd0aCA9IGJ5dGVMZW5ndGgoc3RyaW5nLCBlbmNvZGluZykgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuXG4gIHZhciBhY3R1YWwgPSB0aGF0LndyaXRlKHN0cmluZywgZW5jb2RpbmcpXG5cbiAgaWYgKGFjdHVhbCAhPT0gbGVuZ3RoKSB7XG4gICAgLy8gV3JpdGluZyBhIGhleCBzdHJpbmcsIGZvciBleGFtcGxlLCB0aGF0IGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycyB3aWxsXG4gICAgLy8gY2F1c2UgZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QgaW52YWxpZCBjaGFyYWN0ZXIgdG8gYmUgaWdub3JlZC4gKGUuZy5cbiAgICAvLyAnYWJ4eGNkJyB3aWxsIGJlIHRyZWF0ZWQgYXMgJ2FiJylcbiAgICB0aGF0ID0gdGhhdC5zbGljZSgwLCBhY3R1YWwpXG4gIH1cblxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlMaWtlICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoIDwgMCA/IDAgOiBjaGVja2VkKGFycmF5Lmxlbmd0aCkgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgdGhhdFtpXSA9IGFycmF5W2ldICYgMjU1XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5QnVmZmVyICh0aGF0LCBhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKSB7XG4gIGFycmF5LmJ5dGVMZW5ndGggLy8gdGhpcyB0aHJvd3MgaWYgYGFycmF5YCBpcyBub3QgYSB2YWxpZCBBcnJheUJ1ZmZlclxuXG4gIGlmIChieXRlT2Zmc2V0IDwgMCB8fCBhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcXCdvZmZzZXRcXCcgaXMgb3V0IG9mIGJvdW5kcycpXG4gIH1cblxuICBpZiAoYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQgKyAobGVuZ3RoIHx8IDApKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1xcJ2xlbmd0aFxcJyBpcyBvdXQgb2YgYm91bmRzJylcbiAgfVxuXG4gIGlmIChieXRlT2Zmc2V0ID09PSB1bmRlZmluZWQgJiYgbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5KVxuICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldClcbiAgfSBlbHNlIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpXG4gIH1cblxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gYXJyYXlcbiAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgdGhhdCA9IGZyb21BcnJheUxpa2UodGhhdCwgYXJyYXkpXG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbU9iamVjdCAodGhhdCwgb2JqKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqKSkge1xuICAgIHZhciBsZW4gPSBjaGVja2VkKG9iai5sZW5ndGgpIHwgMFxuICAgIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuKVxuXG4gICAgaWYgKHRoYXQubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdGhhdFxuICAgIH1cblxuICAgIG9iai5jb3B5KHRoYXQsIDAsIDAsIGxlbilcbiAgICByZXR1cm4gdGhhdFxuICB9XG5cbiAgaWYgKG9iaikge1xuICAgIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIG9iaikge1xuICAgICAgaWYgKHR5cGVvZiBvYmoubGVuZ3RoICE9PSAnbnVtYmVyJyB8fCBpc25hbihvYmoubGVuZ3RoKSkge1xuICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIDApXG4gICAgICB9XG4gICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmopXG4gICAgfVxuXG4gICAgaWYgKG9iai50eXBlID09PSAnQnVmZmVyJyAmJiBpc0FycmF5KG9iai5kYXRhKSkge1xuICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqLmRhdGEpXG4gICAgfVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcignRmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZywgQnVmZmVyLCBBcnJheUJ1ZmZlciwgQXJyYXksIG9yIGFycmF5LWxpa2Ugb2JqZWN0LicpXG59XG5cbmZ1bmN0aW9uIGNoZWNrZWQgKGxlbmd0aCkge1xuICAvLyBOb3RlOiBjYW5ub3QgdXNlIGBsZW5ndGggPCBrTWF4TGVuZ3RoKClgIGhlcmUgYmVjYXVzZSB0aGF0IGZhaWxzIHdoZW5cbiAgLy8gbGVuZ3RoIGlzIE5hTiAod2hpY2ggaXMgb3RoZXJ3aXNlIGNvZXJjZWQgdG8gemVyby4pXG4gIGlmIChsZW5ndGggPj0ga01heExlbmd0aCgpKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ3NpemU6IDB4JyArIGtNYXhMZW5ndGgoKS50b1N0cmluZygxNikgKyAnIGJ5dGVzJylcbiAgfVxuICByZXR1cm4gbGVuZ3RoIHwgMFxufVxuXG5mdW5jdGlvbiBTbG93QnVmZmVyIChsZW5ndGgpIHtcbiAgaWYgKCtsZW5ndGggIT0gbGVuZ3RoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxXG4gICAgbGVuZ3RoID0gMFxuICB9XG4gIHJldHVybiBCdWZmZXIuYWxsb2MoK2xlbmd0aClcbn1cblxuQnVmZmVyLmlzQnVmZmVyID0gZnVuY3Rpb24gaXNCdWZmZXIgKGIpIHtcbiAgcmV0dXJuICEhKGIgIT0gbnVsbCAmJiBiLl9pc0J1ZmZlcilcbn1cblxuQnVmZmVyLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlIChhLCBiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGEpIHx8ICFCdWZmZXIuaXNCdWZmZXIoYikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJylcbiAgfVxuXG4gIGlmIChhID09PSBiKSByZXR1cm4gMFxuXG4gIHZhciB4ID0gYS5sZW5ndGhcbiAgdmFyIHkgPSBiLmxlbmd0aFxuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBNYXRoLm1pbih4LCB5KTsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKGFbaV0gIT09IGJbaV0pIHtcbiAgICAgIHggPSBhW2ldXG4gICAgICB5ID0gYltpXVxuICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbkJ1ZmZlci5pc0VuY29kaW5nID0gZnVuY3Rpb24gaXNFbmNvZGluZyAoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlICdoZXgnOlxuICAgIGNhc2UgJ3V0ZjgnOlxuICAgIGNhc2UgJ3V0Zi04JzpcbiAgICBjYXNlICdhc2NpaSc6XG4gICAgY2FzZSAnbGF0aW4xJzpcbiAgICBjYXNlICdiaW5hcnknOlxuICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgY2FzZSAndWNzMic6XG4gICAgY2FzZSAndWNzLTInOlxuICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbkJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkge1xuICBpZiAoIWlzQXJyYXkobGlzdCkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RcIiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKVxuICB9XG5cbiAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5hbGxvYygwKVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbGVuZ3RoID0gMFxuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgICBsZW5ndGggKz0gbGlzdFtpXS5sZW5ndGhcbiAgICB9XG4gIH1cblxuICB2YXIgYnVmZmVyID0gQnVmZmVyLmFsbG9jVW5zYWZlKGxlbmd0aClcbiAgdmFyIHBvcyA9IDBcbiAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgYnVmID0gbGlzdFtpXVxuICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wibGlzdFwiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpXG4gICAgfVxuICAgIGJ1Zi5jb3B5KGJ1ZmZlciwgcG9zKVxuICAgIHBvcyArPSBidWYubGVuZ3RoXG4gIH1cbiAgcmV0dXJuIGJ1ZmZlclxufVxuXG5mdW5jdGlvbiBieXRlTGVuZ3RoIChzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIoc3RyaW5nKSkge1xuICAgIHJldHVybiBzdHJpbmcubGVuZ3RoXG4gIH1cbiAgaWYgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEFycmF5QnVmZmVyLmlzVmlldyA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgKEFycmF5QnVmZmVyLmlzVmlldyhzdHJpbmcpIHx8IHN0cmluZyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSkge1xuICAgIHJldHVybiBzdHJpbmcuYnl0ZUxlbmd0aFxuICB9XG4gIGlmICh0eXBlb2Ygc3RyaW5nICE9PSAnc3RyaW5nJykge1xuICAgIHN0cmluZyA9ICcnICsgc3RyaW5nXG4gIH1cblxuICB2YXIgbGVuID0gc3RyaW5nLmxlbmd0aFxuICBpZiAobGVuID09PSAwKSByZXR1cm4gMFxuXG4gIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvblxuICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZVxuICBmb3IgKDs7KSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBsZW5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aFxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIGxlbiAqIDJcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBsZW4gPj4+IDFcbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aCAvLyBhc3N1bWUgdXRmOFxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoXG5cbmZ1bmN0aW9uIHNsb3dUb1N0cmluZyAoZW5jb2RpbmcsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcblxuICAvLyBObyBuZWVkIHRvIHZlcmlmeSB0aGF0IFwidGhpcy5sZW5ndGggPD0gTUFYX1VJTlQzMlwiIHNpbmNlIGl0J3MgYSByZWFkLW9ubHlcbiAgLy8gcHJvcGVydHkgb2YgYSB0eXBlZCBhcnJheS5cblxuICAvLyBUaGlzIGJlaGF2ZXMgbmVpdGhlciBsaWtlIFN0cmluZyBub3IgVWludDhBcnJheSBpbiB0aGF0IHdlIHNldCBzdGFydC9lbmRcbiAgLy8gdG8gdGhlaXIgdXBwZXIvbG93ZXIgYm91bmRzIGlmIHRoZSB2YWx1ZSBwYXNzZWQgaXMgb3V0IG9mIHJhbmdlLlxuICAvLyB1bmRlZmluZWQgaXMgaGFuZGxlZCBzcGVjaWFsbHkgYXMgcGVyIEVDTUEtMjYyIDZ0aCBFZGl0aW9uLFxuICAvLyBTZWN0aW9uIDEzLjMuMy43IFJ1bnRpbWUgU2VtYW50aWNzOiBLZXllZEJpbmRpbmdJbml0aWFsaXphdGlvbi5cbiAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQgfHwgc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgPSAwXG4gIH1cbiAgLy8gUmV0dXJuIGVhcmx5IGlmIHN0YXJ0ID4gdGhpcy5sZW5ndGguIERvbmUgaGVyZSB0byBwcmV2ZW50IHBvdGVudGlhbCB1aW50MzJcbiAgLy8gY29lcmNpb24gZmFpbCBiZWxvdy5cbiAgaWYgKHN0YXJ0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gIH1cblxuICBpZiAoZW5kIDw9IDApIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIC8vIEZvcmNlIGNvZXJzaW9uIHRvIHVpbnQzMi4gVGhpcyB3aWxsIGFsc28gY29lcmNlIGZhbHNleS9OYU4gdmFsdWVzIHRvIDAuXG4gIGVuZCA+Pj49IDBcbiAgc3RhcnQgPj4+PSAwXG5cbiAgaWYgKGVuZCA8PSBzdGFydCkge1xuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCdcblxuICB3aGlsZSAodHJ1ZSkge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBoZXhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICAgIHJldHVybiBhc2NpaVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICByZXR1cm4gbGF0aW4xU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiB1dGYxNmxlU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgICAgIGVuY29kaW5nID0gKGVuY29kaW5nICsgJycpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5cbi8vIFRoZSBwcm9wZXJ0eSBpcyB1c2VkIGJ5IGBCdWZmZXIuaXNCdWZmZXJgIGFuZCBgaXMtYnVmZmVyYCAoaW4gU2FmYXJpIDUtNykgdG8gZGV0ZWN0XG4vLyBCdWZmZXIgaW5zdGFuY2VzLlxuQnVmZmVyLnByb3RvdHlwZS5faXNCdWZmZXIgPSB0cnVlXG5cbmZ1bmN0aW9uIHN3YXAgKGIsIG4sIG0pIHtcbiAgdmFyIGkgPSBiW25dXG4gIGJbbl0gPSBiW21dXG4gIGJbbV0gPSBpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDE2ID0gZnVuY3Rpb24gc3dhcDE2ICgpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIGlmIChsZW4gJSAyICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAxNi1iaXRzJylcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG4gICAgc3dhcCh0aGlzLCBpLCBpICsgMSlcbiAgfVxuICByZXR1cm4gdGhpc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uIHN3YXAzMiAoKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBpZiAobGVuICUgNCAhPT0gMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgIHN3YXAodGhpcywgaSwgaSArIDMpXG4gICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDIpXG4gIH1cbiAgcmV0dXJuIHRoaXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zd2FwNjQgPSBmdW5jdGlvbiBzd2FwNjQgKCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgaWYgKGxlbiAlIDggIT09IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDY0LWJpdHMnKVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDgpIHtcbiAgICBzd2FwKHRoaXMsIGksIGkgKyA3KVxuICAgIHN3YXAodGhpcywgaSArIDEsIGkgKyA2KVxuICAgIHN3YXAodGhpcywgaSArIDIsIGkgKyA1KVxuICAgIHN3YXAodGhpcywgaSArIDMsIGkgKyA0KVxuICB9XG4gIHJldHVybiB0aGlzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZyAoKSB7XG4gIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCB8IDBcbiAgaWYgKGxlbmd0aCA9PT0gMCkgcmV0dXJuICcnXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIDAsIGxlbmd0aClcbiAgcmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gZXF1YWxzIChiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyJylcbiAgaWYgKHRoaXMgPT09IGIpIHJldHVybiB0cnVlXG4gIHJldHVybiBCdWZmZXIuY29tcGFyZSh0aGlzLCBiKSA9PT0gMFxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluc3BlY3QgPSBmdW5jdGlvbiBpbnNwZWN0ICgpIHtcbiAgdmFyIHN0ciA9ICcnXG4gIHZhciBtYXggPSBleHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTXG4gIGlmICh0aGlzLmxlbmd0aCA+IDApIHtcbiAgICBzdHIgPSB0aGlzLnRvU3RyaW5nKCdoZXgnLCAwLCBtYXgpLm1hdGNoKC8uezJ9L2cpLmpvaW4oJyAnKVxuICAgIGlmICh0aGlzLmxlbmd0aCA+IG1heCkgc3RyICs9ICcgLi4uICdcbiAgfVxuICByZXR1cm4gJzxCdWZmZXIgJyArIHN0ciArICc+J1xufVxuXG5CdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlICh0YXJnZXQsIHN0YXJ0LCBlbmQsIHRoaXNTdGFydCwgdGhpc0VuZCkge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcih0YXJnZXQpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIH1cblxuICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgIHN0YXJ0ID0gMFxuICB9XG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCkge1xuICAgIGVuZCA9IHRhcmdldCA/IHRhcmdldC5sZW5ndGggOiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpc1N0YXJ0ID0gMFxuICB9XG4gIGlmICh0aGlzRW5kID09PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzRW5kID0gdGhpcy5sZW5ndGhcbiAgfVxuXG4gIGlmIChzdGFydCA8IDAgfHwgZW5kID4gdGFyZ2V0Lmxlbmd0aCB8fCB0aGlzU3RhcnQgPCAwIHx8IHRoaXNFbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdvdXQgb2YgcmFuZ2UgaW5kZXgnKVxuICB9XG5cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kICYmIHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kKSB7XG4gICAgcmV0dXJuIC0xXG4gIH1cbiAgaWYgKHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAxXG4gIH1cblxuICBzdGFydCA+Pj49IDBcbiAgZW5kID4+Pj0gMFxuICB0aGlzU3RhcnQgPj4+PSAwXG4gIHRoaXNFbmQgPj4+PSAwXG5cbiAgaWYgKHRoaXMgPT09IHRhcmdldCkgcmV0dXJuIDBcblxuICB2YXIgeCA9IHRoaXNFbmQgLSB0aGlzU3RhcnRcbiAgdmFyIHkgPSBlbmQgLSBzdGFydFxuICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSlcblxuICB2YXIgdGhpc0NvcHkgPSB0aGlzLnNsaWNlKHRoaXNTdGFydCwgdGhpc0VuZClcbiAgdmFyIHRhcmdldENvcHkgPSB0YXJnZXQuc2xpY2Uoc3RhcnQsIGVuZClcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKHRoaXNDb3B5W2ldICE9PSB0YXJnZXRDb3B5W2ldKSB7XG4gICAgICB4ID0gdGhpc0NvcHlbaV1cbiAgICAgIHkgPSB0YXJnZXRDb3B5W2ldXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIGlmICh4IDwgeSkgcmV0dXJuIC0xXG4gIGlmICh5IDwgeCkgcmV0dXJuIDFcbiAgcmV0dXJuIDBcbn1cblxuLy8gRmluZHMgZWl0aGVyIHRoZSBmaXJzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPj0gYGJ5dGVPZmZzZXRgLFxuLy8gT1IgdGhlIGxhc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0IDw9IGBieXRlT2Zmc2V0YC5cbi8vXG4vLyBBcmd1bWVudHM6XG4vLyAtIGJ1ZmZlciAtIGEgQnVmZmVyIHRvIHNlYXJjaFxuLy8gLSB2YWwgLSBhIHN0cmluZywgQnVmZmVyLCBvciBudW1iZXJcbi8vIC0gYnl0ZU9mZnNldCAtIGFuIGluZGV4IGludG8gYGJ1ZmZlcmA7IHdpbGwgYmUgY2xhbXBlZCB0byBhbiBpbnQzMlxuLy8gLSBlbmNvZGluZyAtIGFuIG9wdGlvbmFsIGVuY29kaW5nLCByZWxldmFudCBpcyB2YWwgaXMgYSBzdHJpbmdcbi8vIC0gZGlyIC0gdHJ1ZSBmb3IgaW5kZXhPZiwgZmFsc2UgZm9yIGxhc3RJbmRleE9mXG5mdW5jdGlvbiBiaWRpcmVjdGlvbmFsSW5kZXhPZiAoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHtcbiAgLy8gRW1wdHkgYnVmZmVyIG1lYW5zIG5vIG1hdGNoXG4gIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSByZXR1cm4gLTFcblxuICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldFxuICBpZiAodHlwZW9mIGJ5dGVPZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgZW5jb2RpbmcgPSBieXRlT2Zmc2V0XG4gICAgYnl0ZU9mZnNldCA9IDBcbiAgfSBlbHNlIGlmIChieXRlT2Zmc2V0ID4gMHg3ZmZmZmZmZikge1xuICAgIGJ5dGVPZmZzZXQgPSAweDdmZmZmZmZmXG4gIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA8IC0weDgwMDAwMDAwKSB7XG4gICAgYnl0ZU9mZnNldCA9IC0weDgwMDAwMDAwXG4gIH1cbiAgYnl0ZU9mZnNldCA9ICtieXRlT2Zmc2V0ICAvLyBDb2VyY2UgdG8gTnVtYmVyLlxuICBpZiAoaXNOYU4oYnl0ZU9mZnNldCkpIHtcbiAgICAvLyBieXRlT2Zmc2V0OiBpdCBpdCdzIHVuZGVmaW5lZCwgbnVsbCwgTmFOLCBcImZvb1wiLCBldGMsIHNlYXJjaCB3aG9sZSBidWZmZXJcbiAgICBieXRlT2Zmc2V0ID0gZGlyID8gMCA6IChidWZmZXIubGVuZ3RoIC0gMSlcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSBieXRlT2Zmc2V0OiBuZWdhdGl2ZSBvZmZzZXRzIHN0YXJ0IGZyb20gdGhlIGVuZCBvZiB0aGUgYnVmZmVyXG4gIGlmIChieXRlT2Zmc2V0IDwgMCkgYnl0ZU9mZnNldCA9IGJ1ZmZlci5sZW5ndGggKyBieXRlT2Zmc2V0XG4gIGlmIChieXRlT2Zmc2V0ID49IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICBpZiAoZGlyKSByZXR1cm4gLTFcbiAgICBlbHNlIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoIC0gMVxuICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAwKSB7XG4gICAgaWYgKGRpcikgYnl0ZU9mZnNldCA9IDBcbiAgICBlbHNlIHJldHVybiAtMVxuICB9XG5cbiAgLy8gTm9ybWFsaXplIHZhbFxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICB2YWwgPSBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKVxuICB9XG5cbiAgLy8gRmluYWxseSwgc2VhcmNoIGVpdGhlciBpbmRleE9mIChpZiBkaXIgaXMgdHJ1ZSkgb3IgbGFzdEluZGV4T2ZcbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7XG4gICAgLy8gU3BlY2lhbCBjYXNlOiBsb29raW5nIGZvciBlbXB0eSBzdHJpbmcvYnVmZmVyIGFsd2F5cyBmYWlsc1xuICAgIGlmICh2YWwubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gLTFcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcilcbiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykge1xuICAgIHZhbCA9IHZhbCAmIDB4RkYgLy8gU2VhcmNoIGZvciBhIGJ5dGUgdmFsdWUgWzAtMjU1XVxuICAgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCAmJlxuICAgICAgICB0eXBlb2YgVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaWYgKGRpcikge1xuICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCBbIHZhbCBdLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcigndmFsIG11c3QgYmUgc3RyaW5nLCBudW1iZXIgb3IgQnVmZmVyJylcbn1cblxuZnVuY3Rpb24gYXJyYXlJbmRleE9mIChhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikge1xuICB2YXIgaW5kZXhTaXplID0gMVxuICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aFxuICB2YXIgdmFsTGVuZ3RoID0gdmFsLmxlbmd0aFxuXG4gIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSBTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKClcbiAgICBpZiAoZW5jb2RpbmcgPT09ICd1Y3MyJyB8fCBlbmNvZGluZyA9PT0gJ3Vjcy0yJyB8fFxuICAgICAgICBlbmNvZGluZyA9PT0gJ3V0ZjE2bGUnIHx8IGVuY29kaW5nID09PSAndXRmLTE2bGUnKSB7XG4gICAgICBpZiAoYXJyLmxlbmd0aCA8IDIgfHwgdmFsLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIC0xXG4gICAgICB9XG4gICAgICBpbmRleFNpemUgPSAyXG4gICAgICBhcnJMZW5ndGggLz0gMlxuICAgICAgdmFsTGVuZ3RoIC89IDJcbiAgICAgIGJ5dGVPZmZzZXQgLz0gMlxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWQgKGJ1ZiwgaSkge1xuICAgIGlmIChpbmRleFNpemUgPT09IDEpIHtcbiAgICAgIHJldHVybiBidWZbaV1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGJ1Zi5yZWFkVUludDE2QkUoaSAqIGluZGV4U2l6ZSlcbiAgICB9XG4gIH1cblxuICB2YXIgaVxuICBpZiAoZGlyKSB7XG4gICAgdmFyIGZvdW5kSW5kZXggPSAtMVxuICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPCBhcnJMZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHJlYWQoYXJyLCBpKSA9PT0gcmVhZCh2YWwsIGZvdW5kSW5kZXggPT09IC0xID8gMCA6IGkgLSBmb3VuZEluZGV4KSkge1xuICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIGZvdW5kSW5kZXggPSBpXG4gICAgICAgIGlmIChpIC0gZm91bmRJbmRleCArIDEgPT09IHZhbExlbmd0aCkgcmV0dXJuIGZvdW5kSW5kZXggKiBpbmRleFNpemVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkgaSAtPSBpIC0gZm91bmRJbmRleFxuICAgICAgICBmb3VuZEluZGV4ID0gLTFcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpIGJ5dGVPZmZzZXQgPSBhcnJMZW5ndGggLSB2YWxMZW5ndGhcbiAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkge1xuICAgICAgdmFyIGZvdW5kID0gdHJ1ZVxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWxMZW5ndGg7IGorKykge1xuICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7XG4gICAgICAgICAgZm91bmQgPSBmYWxzZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGlcbiAgICB9XG4gIH1cblxuICByZXR1cm4gLTFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbmNsdWRlcyA9IGZ1bmN0aW9uIGluY2x1ZGVzICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7XG4gIHJldHVybiB0aGlzLmluZGV4T2YodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgIT09IC0xXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIHRydWUpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUubGFzdEluZGV4T2YgPSBmdW5jdGlvbiBsYXN0SW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICByZXR1cm4gYmlkaXJlY3Rpb25hbEluZGV4T2YodGhpcywgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZmFsc2UpXG59XG5cbmZ1bmN0aW9uIGhleFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgb2Zmc2V0ID0gTnVtYmVyKG9mZnNldCkgfHwgMFxuICB2YXIgcmVtYWluaW5nID0gYnVmLmxlbmd0aCAtIG9mZnNldFxuICBpZiAoIWxlbmd0aCkge1xuICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICB9IGVsc2Uge1xuICAgIGxlbmd0aCA9IE51bWJlcihsZW5ndGgpXG4gICAgaWYgKGxlbmd0aCA+IHJlbWFpbmluZykge1xuICAgICAgbGVuZ3RoID0gcmVtYWluaW5nXG4gICAgfVxuICB9XG5cbiAgLy8gbXVzdCBiZSBhbiBldmVuIG51bWJlciBvZiBkaWdpdHNcbiAgdmFyIHN0ckxlbiA9IHN0cmluZy5sZW5ndGhcbiAgaWYgKHN0ckxlbiAlIDIgIT09IDApIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpXG5cbiAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHtcbiAgICBsZW5ndGggPSBzdHJMZW4gLyAyXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpXG4gICAgaWYgKGlzTmFOKHBhcnNlZCkpIHJldHVybiBpXG4gICAgYnVmW29mZnNldCArIGldID0gcGFyc2VkXG4gIH1cbiAgcmV0dXJuIGlcbn1cblxuZnVuY3Rpb24gdXRmOFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIodXRmOFRvQnl0ZXMoc3RyaW5nLCBidWYubGVuZ3RoIC0gb2Zmc2V0KSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYXNjaWlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKGFzY2lpVG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBsYXRpbjFXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBhc2NpaVdyaXRlKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYmFzZTY0V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcihiYXNlNjRUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIHVjczJXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKHV0ZjE2bGVUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiB3cml0ZSAoc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCwgZW5jb2RpbmcpIHtcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZylcbiAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgICBsZW5ndGggPSB0aGlzLmxlbmd0aFxuICAgIG9mZnNldCA9IDBcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgZW5jb2RpbmcpXG4gIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICBlbmNvZGluZyA9IG9mZnNldFxuICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoXG4gICAgb2Zmc2V0ID0gMFxuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBvZmZzZXRbLCBsZW5ndGhdWywgZW5jb2RpbmddKVxuICB9IGVsc2UgaWYgKGlzRmluaXRlKG9mZnNldCkpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gICAgaWYgKGlzRmluaXRlKGxlbmd0aCkpIHtcbiAgICAgIGxlbmd0aCA9IGxlbmd0aCB8IDBcbiAgICAgIGlmIChlbmNvZGluZyA9PT0gdW5kZWZpbmVkKSBlbmNvZGluZyA9ICd1dGY4J1xuICAgIH0gZWxzZSB7XG4gICAgICBlbmNvZGluZyA9IGxlbmd0aFxuICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkXG4gICAgfVxuICAvLyBsZWdhY3kgd3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0LCBsZW5ndGgpIC0gcmVtb3ZlIGluIHYwLjEzXG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0J1ZmZlci53cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXRbLCBsZW5ndGhdKSBpcyBubyBsb25nZXIgc3VwcG9ydGVkJ1xuICAgIClcbiAgfVxuXG4gIHZhciByZW1haW5pbmcgPSB0aGlzLmxlbmd0aCAtIG9mZnNldFxuICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgfHwgbGVuZ3RoID4gcmVtYWluaW5nKSBsZW5ndGggPSByZW1haW5pbmdcblxuICBpZiAoKHN0cmluZy5sZW5ndGggPiAwICYmIChsZW5ndGggPCAwIHx8IG9mZnNldCA8IDApKSB8fCBvZmZzZXQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIHdyaXRlIG91dHNpZGUgYnVmZmVyIGJvdW5kcycpXG4gIH1cblxuICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4J1xuXG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG4gIGZvciAoOzspIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gaGV4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndXRmOCc6XG4gICAgICBjYXNlICd1dGYtOCc6XG4gICAgICAgIHJldHVybiB1dGY4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICByZXR1cm4gYXNjaWlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGxhdGluMVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIC8vIFdhcm5pbmc6IG1heExlbmd0aCBub3QgdGFrZW4gaW50byBhY2NvdW50IGluIGJhc2U2NFdyaXRlXG4gICAgICAgIHJldHVybiBiYXNlNjRXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdWNzMldyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIHRvSlNPTiAoKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0J1ZmZlcicsXG4gICAgZGF0YTogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5fYXJyIHx8IHRoaXMsIDApXG4gIH1cbn1cblxuZnVuY3Rpb24gYmFzZTY0U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBpZiAoc3RhcnQgPT09IDAgJiYgZW5kID09PSBidWYubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1ZilcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmLnNsaWNlKHN0YXJ0LCBlbmQpKVxuICB9XG59XG5cbmZ1bmN0aW9uIHV0ZjhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcbiAgdmFyIHJlcyA9IFtdXG5cbiAgdmFyIGkgPSBzdGFydFxuICB3aGlsZSAoaSA8IGVuZCkge1xuICAgIHZhciBmaXJzdEJ5dGUgPSBidWZbaV1cbiAgICB2YXIgY29kZVBvaW50ID0gbnVsbFxuICAgIHZhciBieXRlc1BlclNlcXVlbmNlID0gKGZpcnN0Qnl0ZSA+IDB4RUYpID8gNFxuICAgICAgOiAoZmlyc3RCeXRlID4gMHhERikgPyAzXG4gICAgICA6IChmaXJzdEJ5dGUgPiAweEJGKSA/IDJcbiAgICAgIDogMVxuXG4gICAgaWYgKGkgKyBieXRlc1BlclNlcXVlbmNlIDw9IGVuZCkge1xuICAgICAgdmFyIHNlY29uZEJ5dGUsIHRoaXJkQnl0ZSwgZm91cnRoQnl0ZSwgdGVtcENvZGVQb2ludFxuXG4gICAgICBzd2l0Y2ggKGJ5dGVzUGVyU2VxdWVuY2UpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGlmIChmaXJzdEJ5dGUgPCAweDgwKSB7XG4gICAgICAgICAgICBjb2RlUG9pbnQgPSBmaXJzdEJ5dGVcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHgxRikgPDwgMHg2IHwgKHNlY29uZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkge1xuICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4QyB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKHRoaXJkQnl0ZSAmIDB4M0YpXG4gICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0ZGICYmICh0ZW1wQ29kZVBvaW50IDwgMHhEODAwIHx8IHRlbXBDb2RlUG9pbnQgPiAweERGRkYpKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGZvdXJ0aEJ5dGUgPSBidWZbaSArIDNdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwICYmIChmb3VydGhCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweDEyIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweEMgfCAodGhpcmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKGZvdXJ0aEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweEZGRkYgJiYgdGVtcENvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNvZGVQb2ludCA9PT0gbnVsbCkge1xuICAgICAgLy8gd2UgZGlkIG5vdCBnZW5lcmF0ZSBhIHZhbGlkIGNvZGVQb2ludCBzbyBpbnNlcnQgYVxuICAgICAgLy8gcmVwbGFjZW1lbnQgY2hhciAoVStGRkZEKSBhbmQgYWR2YW5jZSBvbmx5IDEgYnl0ZVxuICAgICAgY29kZVBvaW50ID0gMHhGRkZEXG4gICAgICBieXRlc1BlclNlcXVlbmNlID0gMVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50ID4gMHhGRkZGKSB7XG4gICAgICAvLyBlbmNvZGUgdG8gdXRmMTYgKHN1cnJvZ2F0ZSBwYWlyIGRhbmNlKVxuICAgICAgY29kZVBvaW50IC09IDB4MTAwMDBcbiAgICAgIHJlcy5wdXNoKGNvZGVQb2ludCA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMClcbiAgICAgIGNvZGVQb2ludCA9IDB4REMwMCB8IGNvZGVQb2ludCAmIDB4M0ZGXG4gICAgfVxuXG4gICAgcmVzLnB1c2goY29kZVBvaW50KVxuICAgIGkgKz0gYnl0ZXNQZXJTZXF1ZW5jZVxuICB9XG5cbiAgcmV0dXJuIGRlY29kZUNvZGVQb2ludHNBcnJheShyZXMpXG59XG5cbi8vIEJhc2VkIG9uIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIyNzQ3MjcyLzY4MDc0MiwgdGhlIGJyb3dzZXIgd2l0aFxuLy8gdGhlIGxvd2VzdCBsaW1pdCBpcyBDaHJvbWUsIHdpdGggMHgxMDAwMCBhcmdzLlxuLy8gV2UgZ28gMSBtYWduaXR1ZGUgbGVzcywgZm9yIHNhZmV0eVxudmFyIE1BWF9BUkdVTUVOVFNfTEVOR1RIID0gMHgxMDAwXG5cbmZ1bmN0aW9uIGRlY29kZUNvZGVQb2ludHNBcnJheSAoY29kZVBvaW50cykge1xuICB2YXIgbGVuID0gY29kZVBvaW50cy5sZW5ndGhcbiAgaWYgKGxlbiA8PSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkge1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgY29kZVBvaW50cykgLy8gYXZvaWQgZXh0cmEgc2xpY2UoKVxuICB9XG5cbiAgLy8gRGVjb2RlIGluIGNodW5rcyB0byBhdm9pZCBcImNhbGwgc3RhY2sgc2l6ZSBleGNlZWRlZFwiLlxuICB2YXIgcmVzID0gJydcbiAgdmFyIGkgPSAwXG4gIHdoaWxlIChpIDwgbGVuKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoXG4gICAgICBTdHJpbmcsXG4gICAgICBjb2RlUG9pbnRzLnNsaWNlKGksIGkgKz0gTUFYX0FSR1VNRU5UU19MRU5HVEgpXG4gICAgKVxuICB9XG4gIHJldHVybiByZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHZhciByZXQgPSAnJ1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0gJiAweDdGKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gbGF0aW4xU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gaGV4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gYnVmLmxlbmd0aFxuXG4gIGlmICghc3RhcnQgfHwgc3RhcnQgPCAwKSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgfHwgZW5kIDwgMCB8fCBlbmQgPiBsZW4pIGVuZCA9IGxlblxuXG4gIHZhciBvdXQgPSAnJ1xuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgIG91dCArPSB0b0hleChidWZbaV0pXG4gIH1cbiAgcmV0dXJuIG91dFxufVxuXG5mdW5jdGlvbiB1dGYxNmxlU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgYnl0ZXMgPSBidWYuc2xpY2Uoc3RhcnQsIGVuZClcbiAgdmFyIHJlcyA9ICcnXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSArIGJ5dGVzW2kgKyAxXSAqIDI1NilcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgc3RhcnQgPSB+fnN0YXJ0XG4gIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmRcblxuICBpZiAoc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgKz0gbGVuXG4gICAgaWYgKHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIH0gZWxzZSBpZiAoc3RhcnQgPiBsZW4pIHtcbiAgICBzdGFydCA9IGxlblxuICB9XG5cbiAgaWYgKGVuZCA8IDApIHtcbiAgICBlbmQgKz0gbGVuXG4gICAgaWYgKGVuZCA8IDApIGVuZCA9IDBcbiAgfSBlbHNlIGlmIChlbmQgPiBsZW4pIHtcbiAgICBlbmQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCBzdGFydCkgZW5kID0gc3RhcnRcblxuICB2YXIgbmV3QnVmXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIG5ld0J1ZiA9IHRoaXMuc3ViYXJyYXkoc3RhcnQsIGVuZClcbiAgICBuZXdCdWYuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIHZhciBzbGljZUxlbiA9IGVuZCAtIHN0YXJ0XG4gICAgbmV3QnVmID0gbmV3IEJ1ZmZlcihzbGljZUxlbiwgdW5kZWZpbmVkKVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2xpY2VMZW47ICsraSkge1xuICAgICAgbmV3QnVmW2ldID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ld0J1ZlxufVxuXG4vKlxuICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT2Zmc2V0IChvZmZzZXQsIGV4dCwgbGVuZ3RoKSB7XG4gIGlmICgob2Zmc2V0ICUgMSkgIT09IDAgfHwgb2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBpcyBub3QgdWludCcpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBsZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludExFID0gZnVuY3Rpb24gcmVhZFVJbnRMRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldF1cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludEJFID0gZnVuY3Rpb24gcmVhZFVJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcbiAgfVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF1cbiAgdmFyIG11bCA9IDFcbiAgd2hpbGUgKGJ5dGVMZW5ndGggPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bFxuICB9XG5cbiAgcmV0dXJuIHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50OCA9IGZ1bmN0aW9uIHJlYWRVSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCA4KSB8IHRoaXNbb2Zmc2V0ICsgMV1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyTEUgPSBmdW5jdGlvbiByZWFkVUludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcblxuICByZXR1cm4gKCh0aGlzW29mZnNldF0pIHxcbiAgICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHxcbiAgICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSkgK1xuICAgICAgKHRoaXNbb2Zmc2V0ICsgM10gKiAweDEwMDAwMDApXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gKiAweDEwMDAwMDApICtcbiAgICAoKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgdGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50TEUgPSBmdW5jdGlvbiByZWFkSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiByZWFkSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgaSA9IGJ5dGVMZW5ndGhcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgLS1pXVxuICB3aGlsZSAoaSA+IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyAtLWldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50OCA9IGZ1bmN0aW9uIHJlYWRJbnQ4IChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpXG4gIGlmICghKHRoaXNbb2Zmc2V0XSAmIDB4ODApKSByZXR1cm4gKHRoaXNbb2Zmc2V0XSlcbiAgcmV0dXJuICgoMHhmZiAtIHRoaXNbb2Zmc2V0XSArIDEpICogLTEpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2TEUgPSBmdW5jdGlvbiByZWFkSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbiAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gcmVhZEludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgMV0gfCAodGhpc1tvZmZzZXRdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJMRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0pIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSA8PCAyNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgMjQpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDgpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdExFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCAyMywgNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRCRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdEJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUxFID0gZnVuY3Rpb24gcmVhZERvdWJsZUxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCA1MiwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkUgPSBmdW5jdGlvbiByZWFkRG91YmxlQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCA1MiwgOClcbn1cblxuZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJ1ZmZlclwiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKVxuICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgaXMgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlVUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlVUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweGZmLCAwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIHJldHVybiBvZmZzZXQgKyAxXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDE2IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDIpOyBpIDwgajsgKytpKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlICYgKDB4ZmYgPDwgKDggKiAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSkpKSA+Pj5cbiAgICAgIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpICogOFxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDMyIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDFcbiAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCA0KTsgaSA8IGo7ICsraSkge1xuICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSA+Pj4gKGxpdHRsZUVuZGlhbiA/IGkgOiAzIC0gaSkgKiA4KSAmIDB4ZmZcbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyTEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSAwXG4gIHZhciBtdWwgPSAxXG4gIHZhciBzdWIgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gMFxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSArIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZiArIHZhbHVlICsgMVxuICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5mdW5jdGlvbiBjaGVja0lFRUU3NTQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG4gIGlmIChvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuZnVuY3Rpb24gd3JpdGVGbG9hdCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOClcbiAgfVxuICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCAyMywgNClcbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0TEUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRCRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG5mdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA4LCAxLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCwgLTEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4KVxuICB9XG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDUyLCA4KVxuICByZXR1cm4gb2Zmc2V0ICsgOFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVCRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpXG59XG5cbi8vIGNvcHkodGFyZ2V0QnVmZmVyLCB0YXJnZXRTdGFydD0wLCBzb3VyY2VTdGFydD0wLCBzb3VyY2VFbmQ9YnVmZmVyLmxlbmd0aClcbkJ1ZmZlci5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkgKHRhcmdldCwgdGFyZ2V0U3RhcnQsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKCFzdGFydCkgc3RhcnQgPSAwXG4gIGlmICghZW5kICYmIGVuZCAhPT0gMCkgZW5kID0gdGhpcy5sZW5ndGhcbiAgaWYgKHRhcmdldFN0YXJ0ID49IHRhcmdldC5sZW5ndGgpIHRhcmdldFN0YXJ0ID0gdGFyZ2V0Lmxlbmd0aFxuICBpZiAoIXRhcmdldFN0YXJ0KSB0YXJnZXRTdGFydCA9IDBcbiAgaWYgKGVuZCA+IDAgJiYgZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgLy8gQ29weSAwIGJ5dGVzOyB3ZSdyZSBkb25lXG4gIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm4gMFxuICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcblxuICAvLyBGYXRhbCBlcnJvciBjb25kaXRpb25zXG4gIGlmICh0YXJnZXRTdGFydCA8IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcigndGFyZ2V0U3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIH1cbiAgaWYgKHN0YXJ0IDwgMCB8fCBzdGFydCA+PSB0aGlzLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZVN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICBpZiAoZW5kIDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZUVuZCBvdXQgb2YgYm91bmRzJylcblxuICAvLyBBcmUgd2Ugb29iP1xuICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmICh0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgPCBlbmQgLSBzdGFydCkge1xuICAgIGVuZCA9IHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCArIHN0YXJ0XG4gIH1cblxuICB2YXIgbGVuID0gZW5kIC0gc3RhcnRcbiAgdmFyIGlcblxuICBpZiAodGhpcyA9PT0gdGFyZ2V0ICYmIHN0YXJ0IDwgdGFyZ2V0U3RhcnQgJiYgdGFyZ2V0U3RhcnQgPCBlbmQpIHtcbiAgICAvLyBkZXNjZW5kaW5nIGNvcHkgZnJvbSBlbmRcbiAgICBmb3IgKGkgPSBsZW4gLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gIH0gZWxzZSBpZiAobGVuIDwgMTAwMCB8fCAhQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBhc2NlbmRpbmcgY29weSBmcm9tIHN0YXJ0XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBVaW50OEFycmF5LnByb3RvdHlwZS5zZXQuY2FsbChcbiAgICAgIHRhcmdldCxcbiAgICAgIHRoaXMuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbGVuKSxcbiAgICAgIHRhcmdldFN0YXJ0XG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIGxlblxufVxuXG4vLyBVc2FnZTpcbi8vICAgIGJ1ZmZlci5maWxsKG51bWJlclssIG9mZnNldFssIGVuZF1dKVxuLy8gICAgYnVmZmVyLmZpbGwoYnVmZmVyWywgb2Zmc2V0WywgZW5kXV0pXG4vLyAgICBidWZmZXIuZmlsbChzdHJpbmdbLCBvZmZzZXRbLCBlbmRdXVssIGVuY29kaW5nXSlcbkJ1ZmZlci5wcm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9uIGZpbGwgKHZhbCwgc3RhcnQsIGVuZCwgZW5jb2RpbmcpIHtcbiAgLy8gSGFuZGxlIHN0cmluZyBjYXNlczpcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKHR5cGVvZiBzdGFydCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGVuY29kaW5nID0gc3RhcnRcbiAgICAgIHN0YXJ0ID0gMFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbmQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbmNvZGluZyA9IGVuZFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9XG4gICAgaWYgKHZhbC5sZW5ndGggPT09IDEpIHtcbiAgICAgIHZhciBjb2RlID0gdmFsLmNoYXJDb2RlQXQoMClcbiAgICAgIGlmIChjb2RlIDwgMjU2KSB7XG4gICAgICAgIHZhbCA9IGNvZGVcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBiZSBhIHN0cmluZycpXG4gICAgfVxuICAgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnICYmICFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICB2YWwgPSB2YWwgJiAyNTVcbiAgfVxuXG4gIC8vIEludmFsaWQgcmFuZ2VzIGFyZSBub3Qgc2V0IHRvIGEgZGVmYXVsdCwgc28gY2FuIHJhbmdlIGNoZWNrIGVhcmx5LlxuICBpZiAoc3RhcnQgPCAwIHx8IHRoaXMubGVuZ3RoIDwgc3RhcnQgfHwgdGhpcy5sZW5ndGggPCBlbmQpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignT3V0IG9mIHJhbmdlIGluZGV4JylcbiAgfVxuXG4gIGlmIChlbmQgPD0gc3RhcnQpIHtcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgc3RhcnQgPSBzdGFydCA+Pj4gMFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IHRoaXMubGVuZ3RoIDogZW5kID4+PiAwXG5cbiAgaWYgKCF2YWwpIHZhbCA9IDBcblxuICB2YXIgaVxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgICB0aGlzW2ldID0gdmFsXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpXG4gICAgICA/IHZhbFxuICAgICAgOiB1dGY4VG9CeXRlcyhuZXcgQnVmZmVyKHZhbCwgZW5jb2RpbmcpLnRvU3RyaW5nKCkpXG4gICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aFxuICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7XG4gICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8vIEhFTFBFUiBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT1cblxudmFyIElOVkFMSURfQkFTRTY0X1JFID0gL1teK1xcLzAtOUEtWmEtei1fXS9nXG5cbmZ1bmN0aW9uIGJhc2U2NGNsZWFuIChzdHIpIHtcbiAgLy8gTm9kZSBzdHJpcHMgb3V0IGludmFsaWQgY2hhcmFjdGVycyBsaWtlIFxcbiBhbmQgXFx0IGZyb20gdGhlIHN0cmluZywgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHN0ciA9IHN0cmluZ3RyaW0oc3RyKS5yZXBsYWNlKElOVkFMSURfQkFTRTY0X1JFLCAnJylcbiAgLy8gTm9kZSBjb252ZXJ0cyBzdHJpbmdzIHdpdGggbGVuZ3RoIDwgMiB0byAnJ1xuICBpZiAoc3RyLmxlbmd0aCA8IDIpIHJldHVybiAnJ1xuICAvLyBOb2RlIGFsbG93cyBmb3Igbm9uLXBhZGRlZCBiYXNlNjQgc3RyaW5ncyAobWlzc2luZyB0cmFpbGluZyA9PT0pLCBiYXNlNjQtanMgZG9lcyBub3RcbiAgd2hpbGUgKHN0ci5sZW5ndGggJSA0ICE9PSAwKSB7XG4gICAgc3RyID0gc3RyICsgJz0nXG4gIH1cbiAgcmV0dXJuIHN0clxufVxuXG5mdW5jdGlvbiBzdHJpbmd0cmltIChzdHIpIHtcbiAgaWYgKHN0ci50cmltKSByZXR1cm4gc3RyLnRyaW0oKVxuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKVxufVxuXG5mdW5jdGlvbiB0b0hleCAobikge1xuICBpZiAobiA8IDE2KSByZXR1cm4gJzAnICsgbi50b1N0cmluZygxNilcbiAgcmV0dXJuIG4udG9TdHJpbmcoMTYpXG59XG5cbmZ1bmN0aW9uIHV0ZjhUb0J5dGVzIChzdHJpbmcsIHVuaXRzKSB7XG4gIHVuaXRzID0gdW5pdHMgfHwgSW5maW5pdHlcbiAgdmFyIGNvZGVQb2ludFxuICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aFxuICB2YXIgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcbiAgdmFyIGJ5dGVzID0gW11cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgY29kZVBvaW50ID0gc3RyaW5nLmNoYXJDb2RlQXQoaSlcblxuICAgIC8vIGlzIHN1cnJvZ2F0ZSBjb21wb25lbnRcbiAgICBpZiAoY29kZVBvaW50ID4gMHhEN0ZGICYmIGNvZGVQb2ludCA8IDB4RTAwMCkge1xuICAgICAgLy8gbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgIGlmICghbGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgICAvLyBubyBsZWFkIHlldFxuICAgICAgICBpZiAoY29kZVBvaW50ID4gMHhEQkZGKSB7XG4gICAgICAgICAgLy8gdW5leHBlY3RlZCB0cmFpbFxuICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH0gZWxzZSBpZiAoaSArIDEgPT09IGxlbmd0aCkge1xuICAgICAgICAgIC8vIHVucGFpcmVkIGxlYWRcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gdmFsaWQgbGVhZFxuICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50XG5cbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gMiBsZWFkcyBpbiBhIHJvd1xuICAgICAgaWYgKGNvZGVQb2ludCA8IDB4REMwMCkge1xuICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICAvLyB2YWxpZCBzdXJyb2dhdGUgcGFpclxuICAgICAgY29kZVBvaW50ID0gKGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDApICsgMHgxMDAwMFxuICAgIH0gZWxzZSBpZiAobGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgLy8gdmFsaWQgYm1wIGNoYXIsIGJ1dCBsYXN0IGNoYXIgd2FzIGEgbGVhZFxuICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgfVxuXG4gICAgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcblxuICAgIC8vIGVuY29kZSB1dGY4XG4gICAgaWYgKGNvZGVQb2ludCA8IDB4ODApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMSkgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChjb2RlUG9pbnQpXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDgwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2IHwgMHhDMCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTAwMDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMykgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyB8IDB4RTAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDQpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDEyIHwgMHhGMCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjb2RlIHBvaW50JylcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYnl0ZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlUb0J5dGVzIChzdHIpIHtcbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgLy8gTm9kZSdzIGNvZGUgc2VlbXMgdG8gYmUgZG9pbmcgdGhpcyBhbmQgbm90ICYgMHg3Ri4uXG4gICAgYnl0ZUFycmF5LnB1c2goc3RyLmNoYXJDb2RlQXQoaSkgJiAweEZGKVxuICB9XG4gIHJldHVybiBieXRlQXJyYXlcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVRvQnl0ZXMgKHN0ciwgdW5pdHMpIHtcbiAgdmFyIGMsIGhpLCBsb1xuICB2YXIgYnl0ZUFycmF5ID0gW11cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWtcblxuICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKVxuICAgIGhpID0gYyA+PiA4XG4gICAgbG8gPSBjICUgMjU2XG4gICAgYnl0ZUFycmF5LnB1c2gobG8pXG4gICAgYnl0ZUFycmF5LnB1c2goaGkpXG4gIH1cblxuICByZXR1cm4gYnl0ZUFycmF5XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFRvQnl0ZXMgKHN0cikge1xuICByZXR1cm4gYmFzZTY0LnRvQnl0ZUFycmF5KGJhc2U2NGNsZWFuKHN0cikpXG59XG5cbmZ1bmN0aW9uIGJsaXRCdWZmZXIgKHNyYywgZHN0LCBvZmZzZXQsIGxlbmd0aCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgaWYgKChpICsgb2Zmc2V0ID49IGRzdC5sZW5ndGgpIHx8IChpID49IHNyYy5sZW5ndGgpKSBicmVha1xuICAgIGRzdFtpICsgb2Zmc2V0XSA9IHNyY1tpXVxuICB9XG4gIHJldHVybiBpXG59XG5cbmZ1bmN0aW9uIGlzbmFuICh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gdmFsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1jb21wYXJlXG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/buffer/index.js\n");

/***/ }),

/***/ "./node_modules/ieee754/index.js":
/*!***************************************!*\
  !*** ./node_modules/ieee754/index.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvaWVlZTc1NC9pbmRleC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9pZWVlNzU0L2luZGV4LmpzPzkxNTIiXSwic291cmNlc0NvbnRlbnQiOlsiLyohIGllZWU3NTQuIEJTRC0zLUNsYXVzZSBMaWNlbnNlLiBGZXJvc3MgQWJvdWtoYWRpamVoIDxodHRwczovL2Zlcm9zcy5vcmcvb3BlbnNvdXJjZT4gKi9cbmV4cG9ydHMucmVhZCA9IGZ1bmN0aW9uIChidWZmZXIsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBlLCBtXG4gIHZhciBlTGVuID0gKG5CeXRlcyAqIDgpIC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBuQml0cyA9IC03XG4gIHZhciBpID0gaXNMRSA/IChuQnl0ZXMgLSAxKSA6IDBcbiAgdmFyIGQgPSBpc0xFID8gLTEgOiAxXG4gIHZhciBzID0gYnVmZmVyW29mZnNldCArIGldXG5cbiAgaSArPSBkXG5cbiAgZSA9IHMgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgcyA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gZUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBlID0gKGUgKiAyNTYpICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9XG5cbiAgbSA9IGUgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgZSA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gbUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gKG0gKiAyNTYpICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9XG5cbiAgaWYgKGUgPT09IDApIHtcbiAgICBlID0gMSAtIGVCaWFzXG4gIH0gZWxzZSBpZiAoZSA9PT0gZU1heCkge1xuICAgIHJldHVybiBtID8gTmFOIDogKChzID8gLTEgOiAxKSAqIEluZmluaXR5KVxuICB9IGVsc2Uge1xuICAgIG0gPSBtICsgTWF0aC5wb3coMiwgbUxlbilcbiAgICBlID0gZSAtIGVCaWFzXG4gIH1cbiAgcmV0dXJuIChzID8gLTEgOiAxKSAqIG0gKiBNYXRoLnBvdygyLCBlIC0gbUxlbilcbn1cblxuZXhwb3J0cy53cml0ZSA9IGZ1bmN0aW9uIChidWZmZXIsIHZhbHVlLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICB2YXIgZSwgbSwgY1xuICB2YXIgZUxlbiA9IChuQnl0ZXMgKiA4KSAtIG1MZW4gLSAxXG4gIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxXG4gIHZhciBlQmlhcyA9IGVNYXggPj4gMVxuICB2YXIgcnQgPSAobUxlbiA9PT0gMjMgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDApXG4gIHZhciBpID0gaXNMRSA/IDAgOiAobkJ5dGVzIC0gMSlcbiAgdmFyIGQgPSBpc0xFID8gMSA6IC0xXG4gIHZhciBzID0gdmFsdWUgPCAwIHx8ICh2YWx1ZSA9PT0gMCAmJiAxIC8gdmFsdWUgPCAwKSA/IDEgOiAwXG5cbiAgdmFsdWUgPSBNYXRoLmFicyh2YWx1ZSlcblxuICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlID09PSBJbmZpbml0eSkge1xuICAgIG0gPSBpc05hTih2YWx1ZSkgPyAxIDogMFxuICAgIGUgPSBlTWF4XG4gIH0gZWxzZSB7XG4gICAgZSA9IE1hdGguZmxvb3IoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5MTjIpXG4gICAgaWYgKHZhbHVlICogKGMgPSBNYXRoLnBvdygyLCAtZSkpIDwgMSkge1xuICAgICAgZS0tXG4gICAgICBjICo9IDJcbiAgICB9XG4gICAgaWYgKGUgKyBlQmlhcyA+PSAxKSB7XG4gICAgICB2YWx1ZSArPSBydCAvIGNcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgKz0gcnQgKiBNYXRoLnBvdygyLCAxIC0gZUJpYXMpXG4gICAgfVxuICAgIGlmICh2YWx1ZSAqIGMgPj0gMikge1xuICAgICAgZSsrXG4gICAgICBjIC89IDJcbiAgICB9XG5cbiAgICBpZiAoZSArIGVCaWFzID49IGVNYXgpIHtcbiAgICAgIG0gPSAwXG4gICAgICBlID0gZU1heFxuICAgIH0gZWxzZSBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIG0gPSAoKHZhbHVlICogYykgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pXG4gICAgICBlID0gZSArIGVCaWFzXG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSB2YWx1ZSAqIE1hdGgucG93KDIsIGVCaWFzIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IDBcbiAgICB9XG4gIH1cblxuICBmb3IgKDsgbUxlbiA+PSA4OyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBtICYgMHhmZiwgaSArPSBkLCBtIC89IDI1NiwgbUxlbiAtPSA4KSB7fVxuXG4gIGUgPSAoZSA8PCBtTGVuKSB8IG1cbiAgZUxlbiArPSBtTGVuXG4gIGZvciAoOyBlTGVuID4gMDsgYnVmZmVyW29mZnNldCArIGldID0gZSAmIDB4ZmYsIGkgKz0gZCwgZSAvPSAyNTYsIGVMZW4gLT0gOCkge31cblxuICBidWZmZXJbb2Zmc2V0ICsgaSAtIGRdIHw9IHMgKiAxMjhcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/ieee754/index.js\n");

/***/ }),

/***/ "./node_modules/isarray/index.js":
/*!***************************************!*\
  !*** ./node_modules/isarray/index.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvaXNhcnJheS9pbmRleC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9pc2FycmF5L2luZGV4LmpzP2UzZGIiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XG5cbm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYXJyKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKGFycikgPT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/isarray/index.js\n");

/***/ }),

/***/ "./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcz9mMjhjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/process/browser.js\n");

/***/ }),

/***/ "./node_modules/punycode/punycode.js":
/*!*******************************************!*\
  !*** ./node_modules/punycode/punycode.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/* WEBPACK VAR INJECTION */(function(module, global) {var __WEBPACK_AMD_DEFINE_RESULT__;/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports =  true && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule =  true && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttrue\n\t) {\n\t\t!(__WEBPACK_AMD_DEFINE_RESULT__ = (function() {\n\t\t\treturn punycode;\n\t\t}).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t} else {}\n\n}(this));\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/module.js */ \"./node_modules/webpack/buildin/module.js\")(module), __webpack_require__(/*! ./../webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\")))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHVueWNvZGUvcHVueWNvZGUuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcHVueWNvZGUvcHVueWNvZGUuanM/OWQ4OCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgaHR0cHM6Ly9tdGhzLmJlL3B1bnljb2RlIHYxLjQuMSBieSBAbWF0aGlhcyAqL1xuOyhmdW5jdGlvbihyb290KSB7XG5cblx0LyoqIERldGVjdCBmcmVlIHZhcmlhYmxlcyAqL1xuXHR2YXIgZnJlZUV4cG9ydHMgPSB0eXBlb2YgZXhwb3J0cyA9PSAnb2JqZWN0JyAmJiBleHBvcnRzICYmXG5cdFx0IWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcblx0dmFyIGZyZWVNb2R1bGUgPSB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJlxuXHRcdCFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlO1xuXHR2YXIgZnJlZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsO1xuXHRpZiAoXG5cdFx0ZnJlZUdsb2JhbC5nbG9iYWwgPT09IGZyZWVHbG9iYWwgfHxcblx0XHRmcmVlR2xvYmFsLndpbmRvdyA9PT0gZnJlZUdsb2JhbCB8fFxuXHRcdGZyZWVHbG9iYWwuc2VsZiA9PT0gZnJlZUdsb2JhbFxuXHQpIHtcblx0XHRyb290ID0gZnJlZUdsb2JhbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBUaGUgYHB1bnljb2RlYCBvYmplY3QuXG5cdCAqIEBuYW1lIHB1bnljb2RlXG5cdCAqIEB0eXBlIE9iamVjdFxuXHQgKi9cblx0dmFyIHB1bnljb2RlLFxuXG5cdC8qKiBIaWdoZXN0IHBvc2l0aXZlIHNpZ25lZCAzMi1iaXQgZmxvYXQgdmFsdWUgKi9cblx0bWF4SW50ID0gMjE0NzQ4MzY0NywgLy8gYWthLiAweDdGRkZGRkZGIG9yIDJeMzEtMVxuXG5cdC8qKiBCb290c3RyaW5nIHBhcmFtZXRlcnMgKi9cblx0YmFzZSA9IDM2LFxuXHR0TWluID0gMSxcblx0dE1heCA9IDI2LFxuXHRza2V3ID0gMzgsXG5cdGRhbXAgPSA3MDAsXG5cdGluaXRpYWxCaWFzID0gNzIsXG5cdGluaXRpYWxOID0gMTI4LCAvLyAweDgwXG5cdGRlbGltaXRlciA9ICctJywgLy8gJ1xceDJEJ1xuXG5cdC8qKiBSZWd1bGFyIGV4cHJlc3Npb25zICovXG5cdHJlZ2V4UHVueWNvZGUgPSAvXnhuLS0vLFxuXHRyZWdleE5vbkFTQ0lJID0gL1teXFx4MjAtXFx4N0VdLywgLy8gdW5wcmludGFibGUgQVNDSUkgY2hhcnMgKyBub24tQVNDSUkgY2hhcnNcblx0cmVnZXhTZXBhcmF0b3JzID0gL1tcXHgyRVxcdTMwMDJcXHVGRjBFXFx1RkY2MV0vZywgLy8gUkZDIDM0OTAgc2VwYXJhdG9yc1xuXG5cdC8qKiBFcnJvciBtZXNzYWdlcyAqL1xuXHRlcnJvcnMgPSB7XG5cdFx0J292ZXJmbG93JzogJ092ZXJmbG93OiBpbnB1dCBuZWVkcyB3aWRlciBpbnRlZ2VycyB0byBwcm9jZXNzJyxcblx0XHQnbm90LWJhc2ljJzogJ0lsbGVnYWwgaW5wdXQgPj0gMHg4MCAobm90IGEgYmFzaWMgY29kZSBwb2ludCknLFxuXHRcdCdpbnZhbGlkLWlucHV0JzogJ0ludmFsaWQgaW5wdXQnXG5cdH0sXG5cblx0LyoqIENvbnZlbmllbmNlIHNob3J0Y3V0cyAqL1xuXHRiYXNlTWludXNUTWluID0gYmFzZSAtIHRNaW4sXG5cdGZsb29yID0gTWF0aC5mbG9vcixcblx0c3RyaW5nRnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZSxcblxuXHQvKiogVGVtcG9yYXJ5IHZhcmlhYmxlICovXG5cdGtleTtcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQvKipcblx0ICogQSBnZW5lcmljIGVycm9yIHV0aWxpdHkgZnVuY3Rpb24uXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIFRoZSBlcnJvciB0eXBlLlxuXHQgKiBAcmV0dXJucyB7RXJyb3J9IFRocm93cyBhIGBSYW5nZUVycm9yYCB3aXRoIHRoZSBhcHBsaWNhYmxlIGVycm9yIG1lc3NhZ2UuXG5cdCAqL1xuXHRmdW5jdGlvbiBlcnJvcih0eXBlKSB7XG5cdFx0dGhyb3cgbmV3IFJhbmdlRXJyb3IoZXJyb3JzW3R5cGVdKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBBIGdlbmVyaWMgYEFycmF5I21hcGAgdXRpbGl0eSBmdW5jdGlvbi5cblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRoYXQgZ2V0cyBjYWxsZWQgZm9yIGV2ZXJ5IGFycmF5XG5cdCAqIGl0ZW0uXG5cdCAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgYXJyYXkgb2YgdmFsdWVzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjayBmdW5jdGlvbi5cblx0ICovXG5cdGZ1bmN0aW9uIG1hcChhcnJheSwgZm4pIHtcblx0XHR2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuXHRcdHZhciByZXN1bHQgPSBbXTtcblx0XHR3aGlsZSAobGVuZ3RoLS0pIHtcblx0XHRcdHJlc3VsdFtsZW5ndGhdID0gZm4oYXJyYXlbbGVuZ3RoXSk7XG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cblxuXHQvKipcblx0ICogQSBzaW1wbGUgYEFycmF5I21hcGAtbGlrZSB3cmFwcGVyIHRvIHdvcmsgd2l0aCBkb21haW4gbmFtZSBzdHJpbmdzIG9yIGVtYWlsXG5cdCAqIGFkZHJlc3Nlcy5cblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcy5cblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRoYXQgZ2V0cyBjYWxsZWQgZm9yIGV2ZXJ5XG5cdCAqIGNoYXJhY3Rlci5cblx0ICogQHJldHVybnMge0FycmF5fSBBIG5ldyBzdHJpbmcgb2YgY2hhcmFjdGVycyByZXR1cm5lZCBieSB0aGUgY2FsbGJhY2tcblx0ICogZnVuY3Rpb24uXG5cdCAqL1xuXHRmdW5jdGlvbiBtYXBEb21haW4oc3RyaW5nLCBmbikge1xuXHRcdHZhciBwYXJ0cyA9IHN0cmluZy5zcGxpdCgnQCcpO1xuXHRcdHZhciByZXN1bHQgPSAnJztcblx0XHRpZiAocGFydHMubGVuZ3RoID4gMSkge1xuXHRcdFx0Ly8gSW4gZW1haWwgYWRkcmVzc2VzLCBvbmx5IHRoZSBkb21haW4gbmFtZSBzaG91bGQgYmUgcHVueWNvZGVkLiBMZWF2ZVxuXHRcdFx0Ly8gdGhlIGxvY2FsIHBhcnQgKGkuZS4gZXZlcnl0aGluZyB1cCB0byBgQGApIGludGFjdC5cblx0XHRcdHJlc3VsdCA9IHBhcnRzWzBdICsgJ0AnO1xuXHRcdFx0c3RyaW5nID0gcGFydHNbMV07XG5cdFx0fVxuXHRcdC8vIEF2b2lkIGBzcGxpdChyZWdleClgIGZvciBJRTggY29tcGF0aWJpbGl0eS4gU2VlICMxNy5cblx0XHRzdHJpbmcgPSBzdHJpbmcucmVwbGFjZShyZWdleFNlcGFyYXRvcnMsICdcXHgyRScpO1xuXHRcdHZhciBsYWJlbHMgPSBzdHJpbmcuc3BsaXQoJy4nKTtcblx0XHR2YXIgZW5jb2RlZCA9IG1hcChsYWJlbHMsIGZuKS5qb2luKCcuJyk7XG5cdFx0cmV0dXJuIHJlc3VsdCArIGVuY29kZWQ7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhbiBhcnJheSBjb250YWluaW5nIHRoZSBudW1lcmljIGNvZGUgcG9pbnRzIG9mIGVhY2ggVW5pY29kZVxuXHQgKiBjaGFyYWN0ZXIgaW4gdGhlIHN0cmluZy4gV2hpbGUgSmF2YVNjcmlwdCB1c2VzIFVDUy0yIGludGVybmFsbHksXG5cdCAqIHRoaXMgZnVuY3Rpb24gd2lsbCBjb252ZXJ0IGEgcGFpciBvZiBzdXJyb2dhdGUgaGFsdmVzIChlYWNoIG9mIHdoaWNoXG5cdCAqIFVDUy0yIGV4cG9zZXMgYXMgc2VwYXJhdGUgY2hhcmFjdGVycykgaW50byBhIHNpbmdsZSBjb2RlIHBvaW50LFxuXHQgKiBtYXRjaGluZyBVVEYtMTYuXG5cdCAqIEBzZWUgYHB1bnljb2RlLnVjczIuZW5jb2RlYFxuXHQgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz5cblx0ICogQG1lbWJlck9mIHB1bnljb2RlLnVjczJcblx0ICogQG5hbWUgZGVjb2RlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgVGhlIFVuaWNvZGUgaW5wdXQgc3RyaW5nIChVQ1MtMikuXG5cdCAqIEByZXR1cm5zIHtBcnJheX0gVGhlIG5ldyBhcnJheSBvZiBjb2RlIHBvaW50cy5cblx0ICovXG5cdGZ1bmN0aW9uIHVjczJkZWNvZGUoc3RyaW5nKSB7XG5cdFx0dmFyIG91dHB1dCA9IFtdLFxuXHRcdCAgICBjb3VudGVyID0gMCxcblx0XHQgICAgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aCxcblx0XHQgICAgdmFsdWUsXG5cdFx0ICAgIGV4dHJhO1xuXHRcdHdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7XG5cdFx0XHR2YWx1ZSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7XG5cdFx0XHRpZiAodmFsdWUgPj0gMHhEODAwICYmIHZhbHVlIDw9IDB4REJGRiAmJiBjb3VudGVyIDwgbGVuZ3RoKSB7XG5cdFx0XHRcdC8vIGhpZ2ggc3Vycm9nYXRlLCBhbmQgdGhlcmUgaXMgYSBuZXh0IGNoYXJhY3RlclxuXHRcdFx0XHRleHRyYSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7XG5cdFx0XHRcdGlmICgoZXh0cmEgJiAweEZDMDApID09IDB4REMwMCkgeyAvLyBsb3cgc3Vycm9nYXRlXG5cdFx0XHRcdFx0b3V0cHV0LnB1c2goKCh2YWx1ZSAmIDB4M0ZGKSA8PCAxMCkgKyAoZXh0cmEgJiAweDNGRikgKyAweDEwMDAwKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyB1bm1hdGNoZWQgc3Vycm9nYXRlOyBvbmx5IGFwcGVuZCB0aGlzIGNvZGUgdW5pdCwgaW4gY2FzZSB0aGUgbmV4dFxuXHRcdFx0XHRcdC8vIGNvZGUgdW5pdCBpcyB0aGUgaGlnaCBzdXJyb2dhdGUgb2YgYSBzdXJyb2dhdGUgcGFpclxuXHRcdFx0XHRcdG91dHB1dC5wdXNoKHZhbHVlKTtcblx0XHRcdFx0XHRjb3VudGVyLS07XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG91dHB1dC5wdXNoKHZhbHVlKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgc3RyaW5nIGJhc2VkIG9uIGFuIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuXG5cdCAqIEBzZWUgYHB1bnljb2RlLnVjczIuZGVjb2RlYFxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGUudWNzMlxuXHQgKiBAbmFtZSBlbmNvZGVcblx0ICogQHBhcmFtIHtBcnJheX0gY29kZVBvaW50cyBUaGUgYXJyYXkgb2YgbnVtZXJpYyBjb2RlIHBvaW50cy5cblx0ICogQHJldHVybnMge1N0cmluZ30gVGhlIG5ldyBVbmljb2RlIHN0cmluZyAoVUNTLTIpLlxuXHQgKi9cblx0ZnVuY3Rpb24gdWNzMmVuY29kZShhcnJheSkge1xuXHRcdHJldHVybiBtYXAoYXJyYXksIGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHR2YXIgb3V0cHV0ID0gJyc7XG5cdFx0XHRpZiAodmFsdWUgPiAweEZGRkYpIHtcblx0XHRcdFx0dmFsdWUgLT0gMHgxMDAwMDtcblx0XHRcdFx0b3V0cHV0ICs9IHN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMCk7XG5cdFx0XHRcdHZhbHVlID0gMHhEQzAwIHwgdmFsdWUgJiAweDNGRjtcblx0XHRcdH1cblx0XHRcdG91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUpO1xuXHRcdFx0cmV0dXJuIG91dHB1dDtcblx0XHR9KS5qb2luKCcnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIGJhc2ljIGNvZGUgcG9pbnQgaW50byBhIGRpZ2l0L2ludGVnZXIuXG5cdCAqIEBzZWUgYGRpZ2l0VG9CYXNpYygpYFxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0ge051bWJlcn0gY29kZVBvaW50IFRoZSBiYXNpYyBudW1lcmljIGNvZGUgcG9pbnQgdmFsdWUuXG5cdCAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBudW1lcmljIHZhbHVlIG9mIGEgYmFzaWMgY29kZSBwb2ludCAoZm9yIHVzZSBpblxuXHQgKiByZXByZXNlbnRpbmcgaW50ZWdlcnMpIGluIHRoZSByYW5nZSBgMGAgdG8gYGJhc2UgLSAxYCwgb3IgYGJhc2VgIGlmXG5cdCAqIHRoZSBjb2RlIHBvaW50IGRvZXMgbm90IHJlcHJlc2VudCBhIHZhbHVlLlxuXHQgKi9cblx0ZnVuY3Rpb24gYmFzaWNUb0RpZ2l0KGNvZGVQb2ludCkge1xuXHRcdGlmIChjb2RlUG9pbnQgLSA0OCA8IDEwKSB7XG5cdFx0XHRyZXR1cm4gY29kZVBvaW50IC0gMjI7XG5cdFx0fVxuXHRcdGlmIChjb2RlUG9pbnQgLSA2NSA8IDI2KSB7XG5cdFx0XHRyZXR1cm4gY29kZVBvaW50IC0gNjU7XG5cdFx0fVxuXHRcdGlmIChjb2RlUG9pbnQgLSA5NyA8IDI2KSB7XG5cdFx0XHRyZXR1cm4gY29kZVBvaW50IC0gOTc7XG5cdFx0fVxuXHRcdHJldHVybiBiYXNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgZGlnaXQvaW50ZWdlciBpbnRvIGEgYmFzaWMgY29kZSBwb2ludC5cblx0ICogQHNlZSBgYmFzaWNUb0RpZ2l0KClgXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB7TnVtYmVyfSBkaWdpdCBUaGUgbnVtZXJpYyB2YWx1ZSBvZiBhIGJhc2ljIGNvZGUgcG9pbnQuXG5cdCAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBiYXNpYyBjb2RlIHBvaW50IHdob3NlIHZhbHVlICh3aGVuIHVzZWQgZm9yXG5cdCAqIHJlcHJlc2VudGluZyBpbnRlZ2VycykgaXMgYGRpZ2l0YCwgd2hpY2ggbmVlZHMgdG8gYmUgaW4gdGhlIHJhbmdlXG5cdCAqIGAwYCB0byBgYmFzZSAtIDFgLiBJZiBgZmxhZ2AgaXMgbm9uLXplcm8sIHRoZSB1cHBlcmNhc2UgZm9ybSBpc1xuXHQgKiB1c2VkOyBlbHNlLCB0aGUgbG93ZXJjYXNlIGZvcm0gaXMgdXNlZC4gVGhlIGJlaGF2aW9yIGlzIHVuZGVmaW5lZFxuXHQgKiBpZiBgZmxhZ2AgaXMgbm9uLXplcm8gYW5kIGBkaWdpdGAgaGFzIG5vIHVwcGVyY2FzZSBmb3JtLlxuXHQgKi9cblx0ZnVuY3Rpb24gZGlnaXRUb0Jhc2ljKGRpZ2l0LCBmbGFnKSB7XG5cdFx0Ly8gIDAuLjI1IG1hcCB0byBBU0NJSSBhLi56IG9yIEEuLlpcblx0XHQvLyAyNi4uMzUgbWFwIHRvIEFTQ0lJIDAuLjlcblx0XHRyZXR1cm4gZGlnaXQgKyAyMiArIDc1ICogKGRpZ2l0IDwgMjYpIC0gKChmbGFnICE9IDApIDw8IDUpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEJpYXMgYWRhcHRhdGlvbiBmdW5jdGlvbiBhcyBwZXIgc2VjdGlvbiAzLjQgb2YgUkZDIDM0OTIuXG5cdCAqIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzNDkyI3NlY3Rpb24tMy40XG5cdCAqIEBwcml2YXRlXG5cdCAqL1xuXHRmdW5jdGlvbiBhZGFwdChkZWx0YSwgbnVtUG9pbnRzLCBmaXJzdFRpbWUpIHtcblx0XHR2YXIgayA9IDA7XG5cdFx0ZGVsdGEgPSBmaXJzdFRpbWUgPyBmbG9vcihkZWx0YSAvIGRhbXApIDogZGVsdGEgPj4gMTtcblx0XHRkZWx0YSArPSBmbG9vcihkZWx0YSAvIG51bVBvaW50cyk7XG5cdFx0Zm9yICgvKiBubyBpbml0aWFsaXphdGlvbiAqLzsgZGVsdGEgPiBiYXNlTWludXNUTWluICogdE1heCA+PiAxOyBrICs9IGJhc2UpIHtcblx0XHRcdGRlbHRhID0gZmxvb3IoZGVsdGEgLyBiYXNlTWludXNUTWluKTtcblx0XHR9XG5cdFx0cmV0dXJuIGZsb29yKGsgKyAoYmFzZU1pbnVzVE1pbiArIDEpICogZGVsdGEgLyAoZGVsdGEgKyBza2V3KSk7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzIHRvIGEgc3RyaW5nIG9mIFVuaWNvZGVcblx0ICogc3ltYm9scy5cblx0ICogQG1lbWJlck9mIHB1bnljb2RlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy5cblx0ICogQHJldHVybnMge1N0cmluZ30gVGhlIHJlc3VsdGluZyBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzLlxuXHQgKi9cblx0ZnVuY3Rpb24gZGVjb2RlKGlucHV0KSB7XG5cdFx0Ly8gRG9uJ3QgdXNlIFVDUy0yXG5cdFx0dmFyIG91dHB1dCA9IFtdLFxuXHRcdCAgICBpbnB1dExlbmd0aCA9IGlucHV0Lmxlbmd0aCxcblx0XHQgICAgb3V0LFxuXHRcdCAgICBpID0gMCxcblx0XHQgICAgbiA9IGluaXRpYWxOLFxuXHRcdCAgICBiaWFzID0gaW5pdGlhbEJpYXMsXG5cdFx0ICAgIGJhc2ljLFxuXHRcdCAgICBqLFxuXHRcdCAgICBpbmRleCxcblx0XHQgICAgb2xkaSxcblx0XHQgICAgdyxcblx0XHQgICAgayxcblx0XHQgICAgZGlnaXQsXG5cdFx0ICAgIHQsXG5cdFx0ICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqL1xuXHRcdCAgICBiYXNlTWludXNUO1xuXG5cdFx0Ly8gSGFuZGxlIHRoZSBiYXNpYyBjb2RlIHBvaW50czogbGV0IGBiYXNpY2AgYmUgdGhlIG51bWJlciBvZiBpbnB1dCBjb2RlXG5cdFx0Ly8gcG9pbnRzIGJlZm9yZSB0aGUgbGFzdCBkZWxpbWl0ZXIsIG9yIGAwYCBpZiB0aGVyZSBpcyBub25lLCB0aGVuIGNvcHlcblx0XHQvLyB0aGUgZmlyc3QgYmFzaWMgY29kZSBwb2ludHMgdG8gdGhlIG91dHB1dC5cblxuXHRcdGJhc2ljID0gaW5wdXQubGFzdEluZGV4T2YoZGVsaW1pdGVyKTtcblx0XHRpZiAoYmFzaWMgPCAwKSB7XG5cdFx0XHRiYXNpYyA9IDA7XG5cdFx0fVxuXG5cdFx0Zm9yIChqID0gMDsgaiA8IGJhc2ljOyArK2opIHtcblx0XHRcdC8vIGlmIGl0J3Mgbm90IGEgYmFzaWMgY29kZSBwb2ludFxuXHRcdFx0aWYgKGlucHV0LmNoYXJDb2RlQXQoaikgPj0gMHg4MCkge1xuXHRcdFx0XHRlcnJvcignbm90LWJhc2ljJyk7XG5cdFx0XHR9XG5cdFx0XHRvdXRwdXQucHVzaChpbnB1dC5jaGFyQ29kZUF0KGopKTtcblx0XHR9XG5cblx0XHQvLyBNYWluIGRlY29kaW5nIGxvb3A6IHN0YXJ0IGp1c3QgYWZ0ZXIgdGhlIGxhc3QgZGVsaW1pdGVyIGlmIGFueSBiYXNpYyBjb2RlXG5cdFx0Ly8gcG9pbnRzIHdlcmUgY29waWVkOyBzdGFydCBhdCB0aGUgYmVnaW5uaW5nIG90aGVyd2lzZS5cblxuXHRcdGZvciAoaW5kZXggPSBiYXNpYyA+IDAgPyBiYXNpYyArIDEgOiAwOyBpbmRleCA8IGlucHV0TGVuZ3RoOyAvKiBubyBmaW5hbCBleHByZXNzaW9uICovKSB7XG5cblx0XHRcdC8vIGBpbmRleGAgaXMgdGhlIGluZGV4IG9mIHRoZSBuZXh0IGNoYXJhY3RlciB0byBiZSBjb25zdW1lZC5cblx0XHRcdC8vIERlY29kZSBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyIGludG8gYGRlbHRhYCxcblx0XHRcdC8vIHdoaWNoIGdldHMgYWRkZWQgdG8gYGlgLiBUaGUgb3ZlcmZsb3cgY2hlY2tpbmcgaXMgZWFzaWVyXG5cdFx0XHQvLyBpZiB3ZSBpbmNyZWFzZSBgaWAgYXMgd2UgZ28sIHRoZW4gc3VidHJhY3Qgb2ZmIGl0cyBzdGFydGluZ1xuXHRcdFx0Ly8gdmFsdWUgYXQgdGhlIGVuZCB0byBvYnRhaW4gYGRlbHRhYC5cblx0XHRcdGZvciAob2xkaSA9IGksIHcgPSAxLCBrID0gYmFzZTsgLyogbm8gY29uZGl0aW9uICovOyBrICs9IGJhc2UpIHtcblxuXHRcdFx0XHRpZiAoaW5kZXggPj0gaW5wdXRMZW5ndGgpIHtcblx0XHRcdFx0XHRlcnJvcignaW52YWxpZC1pbnB1dCcpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZGlnaXQgPSBiYXNpY1RvRGlnaXQoaW5wdXQuY2hhckNvZGVBdChpbmRleCsrKSk7XG5cblx0XHRcdFx0aWYgKGRpZ2l0ID49IGJhc2UgfHwgZGlnaXQgPiBmbG9vcigobWF4SW50IC0gaSkgLyB3KSkge1xuXHRcdFx0XHRcdGVycm9yKCdvdmVyZmxvdycpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aSArPSBkaWdpdCAqIHc7XG5cdFx0XHRcdHQgPSBrIDw9IGJpYXMgPyB0TWluIDogKGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXMpO1xuXG5cdFx0XHRcdGlmIChkaWdpdCA8IHQpIHtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGJhc2VNaW51c1QgPSBiYXNlIC0gdDtcblx0XHRcdFx0aWYgKHcgPiBmbG9vcihtYXhJbnQgLyBiYXNlTWludXNUKSkge1xuXHRcdFx0XHRcdGVycm9yKCdvdmVyZmxvdycpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dyAqPSBiYXNlTWludXNUO1xuXG5cdFx0XHR9XG5cblx0XHRcdG91dCA9IG91dHB1dC5sZW5ndGggKyAxO1xuXHRcdFx0YmlhcyA9IGFkYXB0KGkgLSBvbGRpLCBvdXQsIG9sZGkgPT0gMCk7XG5cblx0XHRcdC8vIGBpYCB3YXMgc3VwcG9zZWQgdG8gd3JhcCBhcm91bmQgZnJvbSBgb3V0YCB0byBgMGAsXG5cdFx0XHQvLyBpbmNyZW1lbnRpbmcgYG5gIGVhY2ggdGltZSwgc28gd2UnbGwgZml4IHRoYXQgbm93OlxuXHRcdFx0aWYgKGZsb29yKGkgLyBvdXQpID4gbWF4SW50IC0gbikge1xuXHRcdFx0XHRlcnJvcignb3ZlcmZsb3cnKTtcblx0XHRcdH1cblxuXHRcdFx0biArPSBmbG9vcihpIC8gb3V0KTtcblx0XHRcdGkgJT0gb3V0O1xuXG5cdFx0XHQvLyBJbnNlcnQgYG5gIGF0IHBvc2l0aW9uIGBpYCBvZiB0aGUgb3V0cHV0XG5cdFx0XHRvdXRwdXQuc3BsaWNlKGkrKywgMCwgbik7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gdWNzMmVuY29kZShvdXRwdXQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scyAoZS5nLiBhIGRvbWFpbiBuYW1lIGxhYmVsKSB0byBhXG5cdCAqIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMuXG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy5cblx0ICovXG5cdGZ1bmN0aW9uIGVuY29kZShpbnB1dCkge1xuXHRcdHZhciBuLFxuXHRcdCAgICBkZWx0YSxcblx0XHQgICAgaGFuZGxlZENQQ291bnQsXG5cdFx0ICAgIGJhc2ljTGVuZ3RoLFxuXHRcdCAgICBiaWFzLFxuXHRcdCAgICBqLFxuXHRcdCAgICBtLFxuXHRcdCAgICBxLFxuXHRcdCAgICBrLFxuXHRcdCAgICB0LFxuXHRcdCAgICBjdXJyZW50VmFsdWUsXG5cdFx0ICAgIG91dHB1dCA9IFtdLFxuXHRcdCAgICAvKiogYGlucHV0TGVuZ3RoYCB3aWxsIGhvbGQgdGhlIG51bWJlciBvZiBjb2RlIHBvaW50cyBpbiBgaW5wdXRgLiAqL1xuXHRcdCAgICBpbnB1dExlbmd0aCxcblx0XHQgICAgLyoqIENhY2hlZCBjYWxjdWxhdGlvbiByZXN1bHRzICovXG5cdFx0ICAgIGhhbmRsZWRDUENvdW50UGx1c09uZSxcblx0XHQgICAgYmFzZU1pbnVzVCxcblx0XHQgICAgcU1pbnVzVDtcblxuXHRcdC8vIENvbnZlcnQgdGhlIGlucHV0IGluIFVDUy0yIHRvIFVuaWNvZGVcblx0XHRpbnB1dCA9IHVjczJkZWNvZGUoaW5wdXQpO1xuXG5cdFx0Ly8gQ2FjaGUgdGhlIGxlbmd0aFxuXHRcdGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xuXG5cdFx0Ly8gSW5pdGlhbGl6ZSB0aGUgc3RhdGVcblx0XHRuID0gaW5pdGlhbE47XG5cdFx0ZGVsdGEgPSAwO1xuXHRcdGJpYXMgPSBpbml0aWFsQmlhcztcblxuXHRcdC8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHNcblx0XHRmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikge1xuXHRcdFx0Y3VycmVudFZhbHVlID0gaW5wdXRbal07XG5cdFx0XHRpZiAoY3VycmVudFZhbHVlIDwgMHg4MCkge1xuXHRcdFx0XHRvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoY3VycmVudFZhbHVlKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aGFuZGxlZENQQ291bnQgPSBiYXNpY0xlbmd0aCA9IG91dHB1dC5sZW5ndGg7XG5cblx0XHQvLyBgaGFuZGxlZENQQ291bnRgIGlzIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgdGhhdCBoYXZlIGJlZW4gaGFuZGxlZDtcblx0XHQvLyBgYmFzaWNMZW5ndGhgIGlzIHRoZSBudW1iZXIgb2YgYmFzaWMgY29kZSBwb2ludHMuXG5cblx0XHQvLyBGaW5pc2ggdGhlIGJhc2ljIHN0cmluZyAtIGlmIGl0IGlzIG5vdCBlbXB0eSAtIHdpdGggYSBkZWxpbWl0ZXJcblx0XHRpZiAoYmFzaWNMZW5ndGgpIHtcblx0XHRcdG91dHB1dC5wdXNoKGRlbGltaXRlcik7XG5cdFx0fVxuXG5cdFx0Ly8gTWFpbiBlbmNvZGluZyBsb29wOlxuXHRcdHdoaWxlIChoYW5kbGVkQ1BDb3VudCA8IGlucHV0TGVuZ3RoKSB7XG5cblx0XHRcdC8vIEFsbCBub24tYmFzaWMgY29kZSBwb2ludHMgPCBuIGhhdmUgYmVlbiBoYW5kbGVkIGFscmVhZHkuIEZpbmQgdGhlIG5leHRcblx0XHRcdC8vIGxhcmdlciBvbmU6XG5cdFx0XHRmb3IgKG0gPSBtYXhJbnQsIGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikge1xuXHRcdFx0XHRjdXJyZW50VmFsdWUgPSBpbnB1dFtqXTtcblx0XHRcdFx0aWYgKGN1cnJlbnRWYWx1ZSA+PSBuICYmIGN1cnJlbnRWYWx1ZSA8IG0pIHtcblx0XHRcdFx0XHRtID0gY3VycmVudFZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIEluY3JlYXNlIGBkZWx0YWAgZW5vdWdoIHRvIGFkdmFuY2UgdGhlIGRlY29kZXIncyA8bixpPiBzdGF0ZSB0byA8bSwwPixcblx0XHRcdC8vIGJ1dCBndWFyZCBhZ2FpbnN0IG92ZXJmbG93XG5cdFx0XHRoYW5kbGVkQ1BDb3VudFBsdXNPbmUgPSBoYW5kbGVkQ1BDb3VudCArIDE7XG5cdFx0XHRpZiAobSAtIG4gPiBmbG9vcigobWF4SW50IC0gZGVsdGEpIC8gaGFuZGxlZENQQ291bnRQbHVzT25lKSkge1xuXHRcdFx0XHRlcnJvcignb3ZlcmZsb3cnKTtcblx0XHRcdH1cblxuXHRcdFx0ZGVsdGEgKz0gKG0gLSBuKSAqIGhhbmRsZWRDUENvdW50UGx1c09uZTtcblx0XHRcdG4gPSBtO1xuXG5cdFx0XHRmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikge1xuXHRcdFx0XHRjdXJyZW50VmFsdWUgPSBpbnB1dFtqXTtcblxuXHRcdFx0XHRpZiAoY3VycmVudFZhbHVlIDwgbiAmJiArK2RlbHRhID4gbWF4SW50KSB7XG5cdFx0XHRcdFx0ZXJyb3IoJ292ZXJmbG93Jyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoY3VycmVudFZhbHVlID09IG4pIHtcblx0XHRcdFx0XHQvLyBSZXByZXNlbnQgZGVsdGEgYXMgYSBnZW5lcmFsaXplZCB2YXJpYWJsZS1sZW5ndGggaW50ZWdlclxuXHRcdFx0XHRcdGZvciAocSA9IGRlbHRhLCBrID0gYmFzZTsgLyogbm8gY29uZGl0aW9uICovOyBrICs9IGJhc2UpIHtcblx0XHRcdFx0XHRcdHQgPSBrIDw9IGJpYXMgPyB0TWluIDogKGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXMpO1xuXHRcdFx0XHRcdFx0aWYgKHEgPCB0KSB7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cU1pbnVzVCA9IHEgLSB0O1xuXHRcdFx0XHRcdFx0YmFzZU1pbnVzVCA9IGJhc2UgLSB0O1xuXHRcdFx0XHRcdFx0b3V0cHV0LnB1c2goXG5cdFx0XHRcdFx0XHRcdHN0cmluZ0Zyb21DaGFyQ29kZShkaWdpdFRvQmFzaWModCArIHFNaW51c1QgJSBiYXNlTWludXNULCAwKSlcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRxID0gZmxvb3IocU1pbnVzVCAvIGJhc2VNaW51c1QpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShkaWdpdFRvQmFzaWMocSwgMCkpKTtcblx0XHRcdFx0XHRiaWFzID0gYWRhcHQoZGVsdGEsIGhhbmRsZWRDUENvdW50UGx1c09uZSwgaGFuZGxlZENQQ291bnQgPT0gYmFzaWNMZW5ndGgpO1xuXHRcdFx0XHRcdGRlbHRhID0gMDtcblx0XHRcdFx0XHQrK2hhbmRsZWRDUENvdW50O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdCsrZGVsdGE7XG5cdFx0XHQrK247XG5cblx0XHR9XG5cdFx0cmV0dXJuIG91dHB1dC5qb2luKCcnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzXG5cdCAqIHRvIFVuaWNvZGUuIE9ubHkgdGhlIFB1bnljb2RlZCBwYXJ0cyBvZiB0aGUgaW5wdXQgd2lsbCBiZSBjb252ZXJ0ZWQsIGkuZS5cblx0ICogaXQgZG9lc24ndCBtYXR0ZXIgaWYgeW91IGNhbGwgaXQgb24gYSBzdHJpbmcgdGhhdCBoYXMgYWxyZWFkeSBiZWVuXG5cdCAqIGNvbnZlcnRlZCB0byBVbmljb2RlLlxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZWQgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcyB0b1xuXHQgKiBjb252ZXJ0IHRvIFVuaWNvZGUuXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBVbmljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBQdW55Y29kZVxuXHQgKiBzdHJpbmcuXG5cdCAqL1xuXHRmdW5jdGlvbiB0b1VuaWNvZGUoaW5wdXQpIHtcblx0XHRyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHtcblx0XHRcdHJldHVybiByZWdleFB1bnljb2RlLnRlc3Qoc3RyaW5nKVxuXHRcdFx0XHQ/IGRlY29kZShzdHJpbmcuc2xpY2UoNCkudG9Mb3dlckNhc2UoKSlcblx0XHRcdFx0OiBzdHJpbmc7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBVbmljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzIHRvXG5cdCAqIFB1bnljb2RlLiBPbmx5IHRoZSBub24tQVNDSUkgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHdpbGwgYmUgY29udmVydGVkLFxuXHQgKiBpLmUuIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBjYWxsIGl0IHdpdGggYSBkb21haW4gdGhhdCdzIGFscmVhZHkgaW5cblx0ICogQVNDSUkuXG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MgdG8gY29udmVydCwgYXMgYVxuXHQgKiBVbmljb2RlIHN0cmluZy5cblx0ICogQHJldHVybnMge1N0cmluZ30gVGhlIFB1bnljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBkb21haW4gbmFtZSBvclxuXHQgKiBlbWFpbCBhZGRyZXNzLlxuXHQgKi9cblx0ZnVuY3Rpb24gdG9BU0NJSShpbnB1dCkge1xuXHRcdHJldHVybiBtYXBEb21haW4oaW5wdXQsIGZ1bmN0aW9uKHN0cmluZykge1xuXHRcdFx0cmV0dXJuIHJlZ2V4Tm9uQVNDSUkudGVzdChzdHJpbmcpXG5cdFx0XHRcdD8gJ3huLS0nICsgZW5jb2RlKHN0cmluZylcblx0XHRcdFx0OiBzdHJpbmc7XG5cdFx0fSk7XG5cdH1cblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQvKiogRGVmaW5lIHRoZSBwdWJsaWMgQVBJICovXG5cdHB1bnljb2RlID0ge1xuXHRcdC8qKlxuXHRcdCAqIEEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBQdW55Y29kZS5qcyB2ZXJzaW9uIG51bWJlci5cblx0XHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0XHQgKiBAdHlwZSBTdHJpbmdcblx0XHQgKi9cblx0XHQndmVyc2lvbic6ICcxLjQuMScsXG5cdFx0LyoqXG5cdFx0ICogQW4gb2JqZWN0IG9mIG1ldGhvZHMgdG8gY29udmVydCBmcm9tIEphdmFTY3JpcHQncyBpbnRlcm5hbCBjaGFyYWN0ZXJcblx0XHQgKiByZXByZXNlbnRhdGlvbiAoVUNTLTIpIHRvIFVuaWNvZGUgY29kZSBwb2ludHMsIGFuZCBiYWNrLlxuXHRcdCAqIEBzZWUgPGh0dHBzOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9qYXZhc2NyaXB0LWVuY29kaW5nPlxuXHRcdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHRcdCAqIEB0eXBlIE9iamVjdFxuXHRcdCAqL1xuXHRcdCd1Y3MyJzoge1xuXHRcdFx0J2RlY29kZSc6IHVjczJkZWNvZGUsXG5cdFx0XHQnZW5jb2RlJzogdWNzMmVuY29kZVxuXHRcdH0sXG5cdFx0J2RlY29kZSc6IGRlY29kZSxcblx0XHQnZW5jb2RlJzogZW5jb2RlLFxuXHRcdCd0b0FTQ0lJJzogdG9BU0NJSSxcblx0XHQndG9Vbmljb2RlJzogdG9Vbmljb2RlXG5cdH07XG5cblx0LyoqIEV4cG9zZSBgcHVueWNvZGVgICovXG5cdC8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJuc1xuXHQvLyBsaWtlIHRoZSBmb2xsb3dpbmc6XG5cdGlmIChcblx0XHR0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiZcblx0XHR0eXBlb2YgZGVmaW5lLmFtZCA9PSAnb2JqZWN0JyAmJlxuXHRcdGRlZmluZS5hbWRcblx0KSB7XG5cdFx0ZGVmaW5lKCdwdW55Y29kZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHB1bnljb2RlO1xuXHRcdH0pO1xuXHR9IGVsc2UgaWYgKGZyZWVFeHBvcnRzICYmIGZyZWVNb2R1bGUpIHtcblx0XHRpZiAobW9kdWxlLmV4cG9ydHMgPT0gZnJlZUV4cG9ydHMpIHtcblx0XHRcdC8vIGluIE5vZGUuanMsIGlvLmpzLCBvciBSaW5nb0pTIHYwLjguMCtcblx0XHRcdGZyZWVNb2R1bGUuZXhwb3J0cyA9IHB1bnljb2RlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBpbiBOYXJ3aGFsIG9yIFJpbmdvSlMgdjAuNy4wLVxuXHRcdFx0Zm9yIChrZXkgaW4gcHVueWNvZGUpIHtcblx0XHRcdFx0cHVueWNvZGUuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAoZnJlZUV4cG9ydHNba2V5XSA9IHB1bnljb2RlW2tleV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSBlbHNlIHtcblx0XHQvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyXG5cdFx0cm9vdC5wdW55Y29kZSA9IHB1bnljb2RlO1xuXHR9XG5cbn0odGhpcykpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBLFVBYUE7QUFDQTtBQUNBOztBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/punycode/punycode.js\n");

/***/ }),

/***/ "./node_modules/querystring-es3/decode.js":
/*!************************************************!*\
  !*** ./node_modules/querystring-es3/decode.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcXVlcnlzdHJpbmctZXMzL2RlY29kZS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9xdWVyeXN0cmluZy1lczMvZGVjb2RlLmpzPzkxZGQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbid1c2Ugc3RyaWN0JztcblxuLy8gSWYgb2JqLmhhc093blByb3BlcnR5IGhhcyBiZWVuIG92ZXJyaWRkZW4sIHRoZW4gY2FsbGluZ1xuLy8gb2JqLmhhc093blByb3BlcnR5KHByb3ApIHdpbGwgYnJlYWsuXG4vLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9qb3llbnQvbm9kZS9pc3N1ZXMvMTcwN1xuZnVuY3Rpb24gaGFzT3duUHJvcGVydHkob2JqLCBwcm9wKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihxcywgc2VwLCBlcSwgb3B0aW9ucykge1xuICBzZXAgPSBzZXAgfHwgJyYnO1xuICBlcSA9IGVxIHx8ICc9JztcbiAgdmFyIG9iaiA9IHt9O1xuXG4gIGlmICh0eXBlb2YgcXMgIT09ICdzdHJpbmcnIHx8IHFzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBvYmo7XG4gIH1cblxuICB2YXIgcmVnZXhwID0gL1xcKy9nO1xuICBxcyA9IHFzLnNwbGl0KHNlcCk7XG5cbiAgdmFyIG1heEtleXMgPSAxMDAwO1xuICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5tYXhLZXlzID09PSAnbnVtYmVyJykge1xuICAgIG1heEtleXMgPSBvcHRpb25zLm1heEtleXM7XG4gIH1cblxuICB2YXIgbGVuID0gcXMubGVuZ3RoO1xuICAvLyBtYXhLZXlzIDw9IDAgbWVhbnMgdGhhdCB3ZSBzaG91bGQgbm90IGxpbWl0IGtleXMgY291bnRcbiAgaWYgKG1heEtleXMgPiAwICYmIGxlbiA+IG1heEtleXMpIHtcbiAgICBsZW4gPSBtYXhLZXlzO1xuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgIHZhciB4ID0gcXNbaV0ucmVwbGFjZShyZWdleHAsICclMjAnKSxcbiAgICAgICAgaWR4ID0geC5pbmRleE9mKGVxKSxcbiAgICAgICAga3N0ciwgdnN0ciwgaywgdjtcblxuICAgIGlmIChpZHggPj0gMCkge1xuICAgICAga3N0ciA9IHguc3Vic3RyKDAsIGlkeCk7XG4gICAgICB2c3RyID0geC5zdWJzdHIoaWR4ICsgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGtzdHIgPSB4O1xuICAgICAgdnN0ciA9ICcnO1xuICAgIH1cblxuICAgIGsgPSBkZWNvZGVVUklDb21wb25lbnQoa3N0cik7XG4gICAgdiA9IGRlY29kZVVSSUNvbXBvbmVudCh2c3RyKTtcblxuICAgIGlmICghaGFzT3duUHJvcGVydHkob2JqLCBrKSkge1xuICAgICAgb2JqW2tdID0gdjtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkob2JqW2tdKSkge1xuICAgICAgb2JqW2tdLnB1c2godik7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9ialtrXSA9IFtvYmpba10sIHZdO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvYmo7XG59O1xuXG52YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKHhzKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeHMpID09PSAnW29iamVjdCBBcnJheV0nO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/querystring-es3/decode.js\n");

/***/ }),

/***/ "./node_modules/querystring-es3/encode.js":
/*!************************************************!*\
  !*** ./node_modules/querystring-es3/encode.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcXVlcnlzdHJpbmctZXMzL2VuY29kZS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9xdWVyeXN0cmluZy1lczMvZW5jb2RlLmpzP2UwOTkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIHN0cmluZ2lmeVByaW1pdGl2ZSA9IGZ1bmN0aW9uKHYpIHtcbiAgc3dpdGNoICh0eXBlb2Ygdikge1xuICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICByZXR1cm4gdjtcblxuICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgcmV0dXJuIHYgPyAndHJ1ZScgOiAnZmFsc2UnO1xuXG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgIHJldHVybiBpc0Zpbml0ZSh2KSA/IHYgOiAnJztcblxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gJyc7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqLCBzZXAsIGVxLCBuYW1lKSB7XG4gIHNlcCA9IHNlcCB8fCAnJic7XG4gIGVxID0gZXEgfHwgJz0nO1xuICBpZiAob2JqID09PSBudWxsKSB7XG4gICAgb2JqID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIG1hcChvYmplY3RLZXlzKG9iaiksIGZ1bmN0aW9uKGspIHtcbiAgICAgIHZhciBrcyA9IGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUoaykpICsgZXE7XG4gICAgICBpZiAoaXNBcnJheShvYmpba10pKSB7XG4gICAgICAgIHJldHVybiBtYXAob2JqW2tdLCBmdW5jdGlvbih2KSB7XG4gICAgICAgICAgcmV0dXJuIGtzICsgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZSh2KSk7XG4gICAgICAgIH0pLmpvaW4oc2VwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUob2JqW2tdKSk7XG4gICAgICB9XG4gICAgfSkuam9pbihzZXApO1xuXG4gIH1cblxuICBpZiAoIW5hbWUpIHJldHVybiAnJztcbiAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUobmFtZSkpICsgZXEgK1xuICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmopKTtcbn07XG5cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoeHMpIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4cykgPT09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xuXG5mdW5jdGlvbiBtYXAgKHhzLCBmKSB7XG4gIGlmICh4cy5tYXApIHJldHVybiB4cy5tYXAoZik7XG4gIHZhciByZXMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB4cy5sZW5ndGg7IGkrKykge1xuICAgIHJlcy5wdXNoKGYoeHNbaV0sIGkpKTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG52YXIgb2JqZWN0S2V5cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIChvYmopIHtcbiAgdmFyIHJlcyA9IFtdO1xuICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHJlcy5wdXNoKGtleSk7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/querystring-es3/encode.js\n");

/***/ }),

/***/ "./node_modules/querystring-es3/index.js":
/*!***********************************************!*\
  !*** ./node_modules/querystring-es3/index.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nexports.decode = exports.parse = __webpack_require__(/*! ./decode */ \"./node_modules/querystring-es3/decode.js\");\nexports.encode = exports.stringify = __webpack_require__(/*! ./encode */ \"./node_modules/querystring-es3/encode.js\");\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcXVlcnlzdHJpbmctZXMzL2luZGV4LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3F1ZXJ5c3RyaW5nLWVzMy9pbmRleC5qcz9iMzgzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5kZWNvZGUgPSBleHBvcnRzLnBhcnNlID0gcmVxdWlyZSgnLi9kZWNvZGUnKTtcbmV4cG9ydHMuZW5jb2RlID0gZXhwb3J0cy5zdHJpbmdpZnkgPSByZXF1aXJlKCcuL2VuY29kZScpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/querystring-es3/index.js\n");

/***/ }),

/***/ "./node_modules/svelte/compiler.mjs":
/*!******************************************!*\
  !*** ./node_modules/svelte/compiler.mjs ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(process, Buffer) {Object.defineProperty(exports,\"__esModule\",{value:true});exports.VERSION=void 0;exports.compile=compile;exports.parse=parse$3;exports.preprocess=preprocess;exports.walk=walk;const now=typeof process!=='undefined'&&process.hrtime?()=>{const t=process.hrtime();return t[0]*1e3+t[1]/1e6;}:()=>self.performance.now();function collapse_timings(timings){const result={};timings.forEach(timing=>{result[timing.label]=Object.assign({total:timing.end-timing.start},timing.children&&collapse_timings(timing.children));});return result;}class Stats{constructor(){this.start_time=now();this.stack=[];this.current_children=this.timings=[];}start(label){const timing={label,start:now(),end:null,children:[]};this.current_children.push(timing);this.stack.push(timing);this.current_timing=timing;this.current_children=timing.children;}stop(label){if(label!==this.current_timing.label){throw new Error(`Mismatched timing labels (expected ${this.current_timing.label}, got ${label})`);}this.current_timing.end=now();this.stack.pop();this.current_timing=this.stack[this.stack.length-1];this.current_children=this.current_timing?this.current_timing.children:this.timings;}render(){const timings=Object.assign({total:now()-this.start_time},collapse_timings(this.timings));return{timings};}}// This file was generated. Do not modify manually!\nvar astralIdentifierCodes=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,357,0,62,13,1495,6,110,6,6,9,4759,9,787719,239];// This file was generated. Do not modify manually!\nvar astralIdentifierStartCodes=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2637,96,16,1070,4050,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,46,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,482,44,11,6,17,0,322,29,19,43,1269,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4152,8,221,3,5761,15,7472,3104,541,1507,4938];// This file was generated. Do not modify manually!\nvar nonASCIIidentifierChars=\"\\u200c\\u200d\\xb7\\u0300-\\u036f\\u0387\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u0669\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u06f0-\\u06f9\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07c0-\\u07c9\\u07eb-\\u07f3\\u07fd\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u0898-\\u089f\\u08ca-\\u08e1\\u08e3-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09cb-\\u09cd\\u09d7\\u09e2\\u09e3\\u09e6-\\u09ef\\u09fe\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2\\u0ae3\\u0ae6-\\u0aef\\u0afa-\\u0aff\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b55-\\u0b57\\u0b62\\u0b63\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c00-\\u0c04\\u0c3c\\u0c3e-\\u0c44\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0c66-\\u0c6f\\u0c81-\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0ce6-\\u0cef\\u0d00-\\u0d03\\u0d3b\\u0d3c\\u0d3e-\\u0d44\\u0d46-\\u0d48\\u0d4a-\\u0d4d\\u0d57\\u0d62\\u0d63\\u0d66-\\u0d6f\\u0d81-\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0de6-\\u0def\\u0df2\\u0df3\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0e50-\\u0e59\\u0eb1\\u0eb4-\\u0ebc\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f3e\\u0f3f\\u0f71-\\u0f84\\u0f86\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102b-\\u103e\\u1040-\\u1049\\u1056-\\u1059\\u105e-\\u1060\\u1062-\\u1064\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u1369-\\u1371\\u1712-\\u1715\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b4-\\u17d3\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u180f-\\u1819\\u18a9\\u1920-\\u192b\\u1930-\\u193b\\u1946-\\u194f\\u19d0-\\u19da\\u1a17-\\u1a1b\\u1a55-\\u1a5e\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1ab0-\\u1abd\\u1abf-\\u1ace\\u1b00-\\u1b04\\u1b34-\\u1b44\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1b80-\\u1b82\\u1ba1-\\u1bad\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c24-\\u1c37\\u1c40-\\u1c49\\u1c50-\\u1c59\\u1cd0-\\u1cd2\\u1cd4-\\u1ce8\\u1ced\\u1cf4\\u1cf7-\\u1cf9\\u1dc0-\\u1dff\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2cef-\\u2cf1\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua620-\\ua629\\ua66f\\ua674-\\ua67d\\ua69e\\ua69f\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua823-\\ua827\\ua82c\\ua880\\ua881\\ua8b4-\\ua8c5\\ua8d0-\\ua8d9\\ua8e0-\\ua8f1\\ua8ff-\\ua909\\ua926-\\ua92d\\ua947-\\ua953\\ua980-\\ua983\\ua9b3-\\ua9c0\\ua9d0-\\ua9d9\\ua9e5\\ua9f0-\\ua9f9\\uaa29-\\uaa36\\uaa43\\uaa4c\\uaa4d\\uaa50-\\uaa59\\uaa7b-\\uaa7d\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uaaeb-\\uaaef\\uaaf5\\uaaf6\\uabe3-\\uabea\\uabec\\uabed\\uabf0-\\uabf9\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f\";// This file was generated. Do not modify manually!\nvar nonASCIIidentifierStartChars=\"\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u037f\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u052f\\u0531-\\u0556\\u0559\\u0560-\\u0588\\u05d0-\\u05ea\\u05ef-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086a\\u0870-\\u0887\\u0889-\\u088e\\u08a0-\\u08c9\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u09fc\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0af9\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c39\\u0c3d\\u0c58-\\u0c5a\\u0c5d\\u0c60\\u0c61\\u0c80\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cdd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d04-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d54-\\u0d56\\u0d5f-\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e86-\\u0e8a\\u0e8c-\\u0ea3\\u0ea5\\u0ea7-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f5\\u13f8-\\u13fd\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f8\\u1700-\\u1711\\u171f-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1878\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191e\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19b0-\\u19c9\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4c\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1c80-\\u1c88\\u1c90-\\u1cba\\u1cbd-\\u1cbf\\u1ce9-\\u1cec\\u1cee-\\u1cf3\\u1cf5\\u1cf6\\u1cfa\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2118-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309b-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312f\\u3131-\\u318e\\u31a0-\\u31bf\\u31f0-\\u31ff\\u3400-\\u4dbf\\u4e00-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua69d\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua7ca\\ua7d0\\ua7d1\\ua7d3\\ua7d5-\\ua7d9\\ua7f2-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua8fd\\ua8fe\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\ua9e0-\\ua9e4\\ua9e6-\\ua9ef\\ua9fa-\\ua9fe\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa7e-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uab30-\\uab5a\\uab5c-\\uab69\\uab70-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc\";// These are a run-length and offset encoded representation of the\n// Reserved word lists for various dialects of the language\nvar reservedWords={3:\"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile\",5:\"class enum extends super const export import\",6:\"enum\",strict:\"implements interface let package private protected public static yield\",strictBind:\"eval arguments\"};// And the keywords\nvar ecma5AndLessKeywords=\"break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this\";var keywords$1={5:ecma5AndLessKeywords,\"5module\":ecma5AndLessKeywords+\" export import\",6:ecma5AndLessKeywords+\" const class extends export import super\"};var keywordRelationalOperator=/^in(stanceof)?$/;// ## Character categories\nvar nonASCIIidentifierStart=new RegExp(\"[\"+nonASCIIidentifierStartChars+\"]\");var nonASCIIidentifier=new RegExp(\"[\"+nonASCIIidentifierStartChars+nonASCIIidentifierChars+\"]\");// This has a complexity linear to the value of the code. The\n// assumption is that looking up astral identifier characters is\n// rare.\nfunction isInAstralSet(code,set){var pos=0x10000;for(var i=0;i<set.length;i+=2){pos+=set[i];if(pos>code){return false;}pos+=set[i+1];if(pos>=code){return true;}}}// Test whether a given character code starts an identifier.\nfunction isIdentifierStart(code,astral){if(code<65){return code===36;}if(code<91){return true;}if(code<97){return code===95;}if(code<123){return true;}if(code<=0xffff){return code>=0xaa&&nonASCIIidentifierStart.test(String.fromCharCode(code));}if(astral===false){return false;}return isInAstralSet(code,astralIdentifierStartCodes);}// Test whether a given character is part of an identifier.\nfunction isIdentifierChar(code,astral){if(code<48){return code===36;}if(code<58){return true;}if(code<65){return false;}if(code<91){return true;}if(code<97){return code===95;}if(code<123){return true;}if(code<=0xffff){return code>=0xaa&&nonASCIIidentifier.test(String.fromCharCode(code));}if(astral===false){return false;}return isInAstralSet(code,astralIdentifierStartCodes)||isInAstralSet(code,astralIdentifierCodes);}// ## Token types\n// The assignment of fine-grained, information-carrying type objects\n// allows the tokenizer to store the information it has about a\n// token in a way that is very cheap for the parser to look up.\n// All token type variables start with an underscore, to make them\n// easy to recognize.\n// The `beforeExpr` property is used to disambiguate between regular\n// expressions and divisions. It is set on all token types that can\n// be followed by an expression (thus, a slash after them would be a\n// regular expression).\n//\n// The `startsExpr` property is used to check if the token ends a\n// `yield` expression. It is set on all token types that either can\n// directly start an expression (like a quotation mark) or can\n// continue an expression (like the body of a string).\n//\n// `isLoop` marks a keyword as starting a loop, which is important\n// to know when parsing a label, in order to allow or disallow\n// continue jumps to that label.\nvar TokenType=function TokenType(label,conf){if(conf===void 0)conf={};this.label=label;this.keyword=conf.keyword;this.beforeExpr=!!conf.beforeExpr;this.startsExpr=!!conf.startsExpr;this.isLoop=!!conf.isLoop;this.isAssign=!!conf.isAssign;this.prefix=!!conf.prefix;this.postfix=!!conf.postfix;this.binop=conf.binop||null;this.updateContext=null;};function binop(name,prec){return new TokenType(name,{beforeExpr:true,binop:prec});}var beforeExpr={beforeExpr:true},startsExpr={startsExpr:true};// Map keyword names to token types.\nvar keywords={};// Succinct definitions of keyword token types\nfunction kw(name,options){if(options===void 0)options={};options.keyword=name;return keywords[name]=new TokenType(name,options);}var types$1={num:new TokenType(\"num\",startsExpr),regexp:new TokenType(\"regexp\",startsExpr),string:new TokenType(\"string\",startsExpr),name:new TokenType(\"name\",startsExpr),privateId:new TokenType(\"privateId\",startsExpr),eof:new TokenType(\"eof\"),// Punctuation token types.\nbracketL:new TokenType(\"[\",{beforeExpr:true,startsExpr:true}),bracketR:new TokenType(\"]\"),braceL:new TokenType(\"{\",{beforeExpr:true,startsExpr:true}),braceR:new TokenType(\"}\"),parenL:new TokenType(\"(\",{beforeExpr:true,startsExpr:true}),parenR:new TokenType(\")\"),comma:new TokenType(\",\",beforeExpr),semi:new TokenType(\";\",beforeExpr),colon:new TokenType(\":\",beforeExpr),dot:new TokenType(\".\"),question:new TokenType(\"?\",beforeExpr),questionDot:new TokenType(\"?.\"),arrow:new TokenType(\"=>\",beforeExpr),template:new TokenType(\"template\"),invalidTemplate:new TokenType(\"invalidTemplate\"),ellipsis:new TokenType(\"...\",beforeExpr),backQuote:new TokenType(\"`\",startsExpr),dollarBraceL:new TokenType(\"${\",{beforeExpr:true,startsExpr:true}),// Operators. These carry several kinds of properties to help the\n// parser use them properly (the presence of these properties is\n// what categorizes them as operators).\n//\n// `binop`, when present, specifies that this operator is a binary\n// operator, and will refer to its precedence.\n//\n// `prefix` and `postfix` mark the operator as a prefix or postfix\n// unary operator.\n//\n// `isAssign` marks all of `=`, `+=`, `-=` etcetera, which act as\n// binary operators with a very low precedence, that should result\n// in AssignmentExpression nodes.\neq:new TokenType(\"=\",{beforeExpr:true,isAssign:true}),assign:new TokenType(\"_=\",{beforeExpr:true,isAssign:true}),incDec:new TokenType(\"++/--\",{prefix:true,postfix:true,startsExpr:true}),prefix:new TokenType(\"!/~\",{beforeExpr:true,prefix:true,startsExpr:true}),logicalOR:binop(\"||\",1),logicalAND:binop(\"&&\",2),bitwiseOR:binop(\"|\",3),bitwiseXOR:binop(\"^\",4),bitwiseAND:binop(\"&\",5),equality:binop(\"==/!=/===/!==\",6),relational:binop(\"</>/<=/>=\",7),bitShift:binop(\"<</>>/>>>\",8),plusMin:new TokenType(\"+/-\",{beforeExpr:true,binop:9,prefix:true,startsExpr:true}),modulo:binop(\"%\",10),star:binop(\"*\",10),slash:binop(\"/\",10),starstar:new TokenType(\"**\",{beforeExpr:true}),coalesce:binop(\"??\",1),// Keyword token types.\n_break:kw(\"break\"),_case:kw(\"case\",beforeExpr),_catch:kw(\"catch\"),_continue:kw(\"continue\"),_debugger:kw(\"debugger\"),_default:kw(\"default\",beforeExpr),_do:kw(\"do\",{isLoop:true,beforeExpr:true}),_else:kw(\"else\",beforeExpr),_finally:kw(\"finally\"),_for:kw(\"for\",{isLoop:true}),_function:kw(\"function\",startsExpr),_if:kw(\"if\"),_return:kw(\"return\",beforeExpr),_switch:kw(\"switch\"),_throw:kw(\"throw\",beforeExpr),_try:kw(\"try\"),_var:kw(\"var\"),_const:kw(\"const\"),_while:kw(\"while\",{isLoop:true}),_with:kw(\"with\"),_new:kw(\"new\",{beforeExpr:true,startsExpr:true}),_this:kw(\"this\",startsExpr),_super:kw(\"super\",startsExpr),_class:kw(\"class\",startsExpr),_extends:kw(\"extends\",beforeExpr),_export:kw(\"export\"),_import:kw(\"import\",startsExpr),_null:kw(\"null\",startsExpr),_true:kw(\"true\",startsExpr),_false:kw(\"false\",startsExpr),_in:kw(\"in\",{beforeExpr:true,binop:7}),_instanceof:kw(\"instanceof\",{beforeExpr:true,binop:7}),_typeof:kw(\"typeof\",{beforeExpr:true,prefix:true,startsExpr:true}),_void:kw(\"void\",{beforeExpr:true,prefix:true,startsExpr:true}),_delete:kw(\"delete\",{beforeExpr:true,prefix:true,startsExpr:true})};// Matches a whole line break (where CRLF is considered a single\n// line break). Used to count lines.\nvar lineBreak=/\\r\\n?|\\n|\\u2028|\\u2029/;var lineBreakG=new RegExp(lineBreak.source,\"g\");function isNewLine(code){return code===10||code===13||code===0x2028||code===0x2029;}function nextLineBreak(code,from,end){if(end===void 0)end=code.length;for(var i=from;i<end;i++){var next=code.charCodeAt(i);if(isNewLine(next)){return i<end-1&&next===13&&code.charCodeAt(i+1)===10?i+2:i+1;}}return-1;}var nonASCIIwhitespace=/[\\u1680\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]/;var skipWhiteSpace=/(?:\\s|\\/\\/.*|\\/\\*[^]*?\\*\\/)*/g;var ref=Object.prototype;var hasOwnProperty=ref.hasOwnProperty;var toString=ref.toString;var hasOwn=Object.hasOwn||function(obj,propName){return hasOwnProperty.call(obj,propName);};var isArray=Array.isArray||function(obj){return toString.call(obj)===\"[object Array]\";};function wordsRegexp(words){return new RegExp(\"^(?:\"+words.replace(/ /g,\"|\")+\")$\");}function codePointToString(code){// UTF-16 Decoding\nif(code<=0xFFFF){return String.fromCharCode(code);}code-=0x10000;return String.fromCharCode((code>>10)+0xD800,(code&1023)+0xDC00);}var loneSurrogate=/(?:[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])/;// These are used when `options.locations` is on, for the\n// `startLoc` and `endLoc` properties.\nvar Position=function Position(line,col){this.line=line;this.column=col;};Position.prototype.offset=function offset(n){return new Position(this.line,this.column+n);};var SourceLocation=function SourceLocation(p,start,end){this.start=start;this.end=end;if(p.sourceFile!==null){this.source=p.sourceFile;}};// The `getLineInfo` function is mostly useful when the\n// `locations` option is off (for performance reasons) and you\n// want to find the line/column position for a given character\n// offset. `input` should be the code string that the offset refers\n// into.\nfunction getLineInfo(input,offset){for(var line=1,cur=0;;){var nextBreak=nextLineBreak(input,cur,offset);if(nextBreak<0){return new Position(line,offset-cur);}++line;cur=nextBreak;}}// A second argument must be given to configure the parser process.\n// These options are recognized (only `ecmaVersion` is required):\nvar defaultOptions={// `ecmaVersion` indicates the ECMAScript version to parse. Must be\n// either 3, 5, 6 (or 2015), 7 (2016), 8 (2017), 9 (2018), 10\n// (2019), 11 (2020), 12 (2021), 13 (2022), or `\"latest\"` (the\n// latest version the library supports). This influences support\n// for strict mode, the set of reserved words, and support for\n// new syntax features.\necmaVersion:null,// `sourceType` indicates the mode the code should be parsed in.\n// Can be either `\"script\"` or `\"module\"`. This influences global\n// strict mode and parsing of `import` and `export` declarations.\nsourceType:\"script\",// `onInsertedSemicolon` can be a callback that will be called\n// when a semicolon is automatically inserted. It will be passed\n// the position of the comma as an offset, and if `locations` is\n// enabled, it is given the location as a `{line, column}` object\n// as second argument.\nonInsertedSemicolon:null,// `onTrailingComma` is similar to `onInsertedSemicolon`, but for\n// trailing commas.\nonTrailingComma:null,// By default, reserved words are only enforced if ecmaVersion >= 5.\n// Set `allowReserved` to a boolean value to explicitly turn this on\n// an off. When this option has the value \"never\", reserved words\n// and keywords can also not be used as property names.\nallowReserved:null,// When enabled, a return at the top level is not considered an\n// error.\nallowReturnOutsideFunction:false,// When enabled, import/export statements are not constrained to\n// appearing at the top of the program, and an import.meta expression\n// in a script isn't considered an error.\nallowImportExportEverywhere:false,// By default, await identifiers are allowed to appear at the top-level scope only if ecmaVersion >= 2022.\n// When enabled, await identifiers are allowed to appear at the top-level scope,\n// but they are still not allowed in non-async functions.\nallowAwaitOutsideFunction:null,// When enabled, super identifiers are not constrained to\n// appearing in methods and do not raise an error when they appear elsewhere.\nallowSuperOutsideMethod:null,// When enabled, hashbang directive in the beginning of file\n// is allowed and treated as a line comment.\nallowHashBang:false,// When `locations` is on, `loc` properties holding objects with\n// `start` and `end` properties in `{line, column}` form (with\n// line being 1-based and column 0-based) will be attached to the\n// nodes.\nlocations:false,// A function can be passed as `onToken` option, which will\n// cause Acorn to call that function with object in the same\n// format as tokens returned from `tokenizer().getToken()`. Note\n// that you are not allowed to call the parser from the\n// callback—that will corrupt its internal state.\nonToken:null,// A function can be passed as `onComment` option, which will\n// cause Acorn to call that function with `(block, text, start,\n// end)` parameters whenever a comment is skipped. `block` is a\n// boolean indicating whether this is a block (`/* */`) comment,\n// `text` is the content of the comment, and `start` and `end` are\n// character offsets that denote the start and end of the comment.\n// When the `locations` option is on, two more parameters are\n// passed, the full `{line, column}` locations of the start and\n// end of the comments. Note that you are not allowed to call the\n// parser from the callback—that will corrupt its internal state.\nonComment:null,// Nodes have their start and end characters offsets recorded in\n// `start` and `end` properties (directly on the node, rather than\n// the `loc` object, which holds line/column data. To also add a\n// [semi-standardized][range] `range` property holding a `[start,\n// end]` array with the same numbers, set the `ranges` option to\n// `true`.\n//\n// [range]: https://bugzilla.mozilla.org/show_bug.cgi?id=745678\nranges:false,// It is possible to parse multiple files into a single AST by\n// passing the tree produced by parsing the first file as\n// `program` option in subsequent parses. This will add the\n// toplevel forms of the parsed file to the `Program` (top) node\n// of an existing parse tree.\nprogram:null,// When `locations` is on, you can pass this to record the source\n// file in every node's `loc` object.\nsourceFile:null,// This value, if given, is stored in every node, whether\n// `locations` is on or off.\ndirectSourceFile:null,// When enabled, parenthesized expressions are represented by\n// (non-standard) ParenthesizedExpression nodes\npreserveParens:false};// Interpret and default an options object\nvar warnedAboutEcmaVersion=false;function getOptions(opts){var options={};for(var opt in defaultOptions){options[opt]=opts&&hasOwn(opts,opt)?opts[opt]:defaultOptions[opt];}if(options.ecmaVersion===\"latest\"){options.ecmaVersion=1e8;}else if(options.ecmaVersion==null){if(!warnedAboutEcmaVersion&&typeof console===\"object\"&&console.warn){warnedAboutEcmaVersion=true;console.warn(\"Since Acorn 8.0.0, options.ecmaVersion is required.\\nDefaulting to 2020, but this will stop working in the future.\");}options.ecmaVersion=11;}else if(options.ecmaVersion>=2015){options.ecmaVersion-=2009;}if(options.allowReserved==null){options.allowReserved=options.ecmaVersion<5;}if(isArray(options.onToken)){var tokens=options.onToken;options.onToken=function(token){return tokens.push(token);};}if(isArray(options.onComment)){options.onComment=pushComment(options,options.onComment);}return options;}function pushComment(options,array){return function(block,text,start,end,startLoc,endLoc){var comment={type:block?\"Block\":\"Line\",value:text,start:start,end:end};if(options.locations){comment.loc=new SourceLocation(this,startLoc,endLoc);}if(options.ranges){comment.range=[start,end];}array.push(comment);};}// Each scope gets a bitset that may contain these flags\nvar SCOPE_TOP=1,SCOPE_FUNCTION=2,SCOPE_ASYNC=4,SCOPE_GENERATOR=8,SCOPE_ARROW=16,SCOPE_SIMPLE_CATCH=32,SCOPE_SUPER=64,SCOPE_DIRECT_SUPER=128,SCOPE_CLASS_STATIC_BLOCK=256,SCOPE_VAR=SCOPE_TOP|SCOPE_FUNCTION|SCOPE_CLASS_STATIC_BLOCK;function functionFlags(async,generator){return SCOPE_FUNCTION|(async?SCOPE_ASYNC:0)|(generator?SCOPE_GENERATOR:0);}// Used in checkLVal* and declareName to determine the type of a binding\nvar BIND_NONE=0,// Not a binding\nBIND_VAR=1,// Var-style binding\nBIND_LEXICAL=2,// Let- or const-style binding\nBIND_FUNCTION=3,// Function declaration\nBIND_SIMPLE_CATCH=4,// Simple (identifier pattern) catch binding\nBIND_OUTSIDE=5;// Special case for function names as bound inside the function\nvar Parser=function Parser(options,input,startPos){this.options=options=getOptions(options);this.sourceFile=options.sourceFile;this.keywords=wordsRegexp(keywords$1[options.ecmaVersion>=6?6:options.sourceType===\"module\"?\"5module\":5]);var reserved=\"\";if(options.allowReserved!==true){reserved=reservedWords[options.ecmaVersion>=6?6:options.ecmaVersion===5?5:3];if(options.sourceType===\"module\"){reserved+=\" await\";}}this.reservedWords=wordsRegexp(reserved);var reservedStrict=(reserved?reserved+\" \":\"\")+reservedWords.strict;this.reservedWordsStrict=wordsRegexp(reservedStrict);this.reservedWordsStrictBind=wordsRegexp(reservedStrict+\" \"+reservedWords.strictBind);this.input=String(input);// Used to signal to callers of `readWord1` whether the word\n// contained any escape sequences. This is needed because words with\n// escape sequences must not be interpreted as keywords.\nthis.containsEsc=false;// Set up token state\n// The current position of the tokenizer in the input.\nif(startPos){this.pos=startPos;this.lineStart=this.input.lastIndexOf(\"\\n\",startPos-1)+1;this.curLine=this.input.slice(0,this.lineStart).split(lineBreak).length;}else{this.pos=this.lineStart=0;this.curLine=1;}// Properties of the current token:\n// Its type\nthis.type=types$1.eof;// For tokens that include more information than their type, the value\nthis.value=null;// Its start and end offset\nthis.start=this.end=this.pos;// And, if locations are used, the {line, column} object\n// corresponding to those offsets\nthis.startLoc=this.endLoc=this.curPosition();// Position information for the previous token\nthis.lastTokEndLoc=this.lastTokStartLoc=null;this.lastTokStart=this.lastTokEnd=this.pos;// The context stack is used to superficially track syntactic\n// context to predict whether a regular expression is allowed in a\n// given position.\nthis.context=this.initialContext();this.exprAllowed=true;// Figure out if it's a module code.\nthis.inModule=options.sourceType===\"module\";this.strict=this.inModule||this.strictDirective(this.pos);// Used to signify the start of a potential arrow function\nthis.potentialArrowAt=-1;this.potentialArrowInForAwait=false;// Positions to delayed-check that yield/await does not exist in default parameters.\nthis.yieldPos=this.awaitPos=this.awaitIdentPos=0;// Labels in scope.\nthis.labels=[];// Thus-far undefined exports.\nthis.undefinedExports=Object.create(null);// If enabled, skip leading hashbang line.\nif(this.pos===0&&options.allowHashBang&&this.input.slice(0,2)===\"#!\"){this.skipLineComment(2);}// Scope tracking for duplicate variable names (see scope.js)\nthis.scopeStack=[];this.enterScope(SCOPE_TOP);// For RegExp validation\nthis.regexpState=null;// The stack of private names.\n// Each element has two properties: 'declared' and 'used'.\n// When it exited from the outermost class definition, all used private names must be declared.\nthis.privateNameStack=[];};var prototypeAccessors={inFunction:{configurable:true},inGenerator:{configurable:true},inAsync:{configurable:true},canAwait:{configurable:true},allowSuper:{configurable:true},allowDirectSuper:{configurable:true},treatFunctionsAsVar:{configurable:true},allowNewDotTarget:{configurable:true},inClassStaticBlock:{configurable:true}};Parser.prototype.parse=function parse(){var node=this.options.program||this.startNode();this.nextToken();return this.parseTopLevel(node);};prototypeAccessors.inFunction.get=function(){return(this.currentVarScope().flags&SCOPE_FUNCTION)>0;};prototypeAccessors.inGenerator.get=function(){return(this.currentVarScope().flags&SCOPE_GENERATOR)>0&&!this.currentVarScope().inClassFieldInit;};prototypeAccessors.inAsync.get=function(){return(this.currentVarScope().flags&SCOPE_ASYNC)>0&&!this.currentVarScope().inClassFieldInit;};prototypeAccessors.canAwait.get=function(){for(var i=this.scopeStack.length-1;i>=0;i--){var scope=this.scopeStack[i];if(scope.inClassFieldInit||scope.flags&SCOPE_CLASS_STATIC_BLOCK){return false;}if(scope.flags&SCOPE_FUNCTION){return(scope.flags&SCOPE_ASYNC)>0;}}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction;};prototypeAccessors.allowSuper.get=function(){var ref=this.currentThisScope();var flags=ref.flags;var inClassFieldInit=ref.inClassFieldInit;return(flags&SCOPE_SUPER)>0||inClassFieldInit||this.options.allowSuperOutsideMethod;};prototypeAccessors.allowDirectSuper.get=function(){return(this.currentThisScope().flags&SCOPE_DIRECT_SUPER)>0;};prototypeAccessors.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope());};prototypeAccessors.allowNewDotTarget.get=function(){var ref=this.currentThisScope();var flags=ref.flags;var inClassFieldInit=ref.inClassFieldInit;return(flags&(SCOPE_FUNCTION|SCOPE_CLASS_STATIC_BLOCK))>0||inClassFieldInit;};prototypeAccessors.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&SCOPE_CLASS_STATIC_BLOCK)>0;};Parser.extend=function extend(){var plugins=[],len=arguments.length;while(len--)plugins[len]=arguments[len];var cls=this;for(var i=0;i<plugins.length;i++){cls=plugins[i](cls);}return cls;};Parser.parse=function parse(input,options){return new this(options,input).parse();};Parser.parseExpressionAt=function parseExpressionAt(input,pos,options){var parser=new this(options,input,pos);parser.nextToken();return parser.parseExpression();};Parser.tokenizer=function tokenizer(input,options){return new this(options,input);};Object.defineProperties(Parser.prototype,prototypeAccessors);var pp$9=Parser.prototype;// ## Parser utilities\nvar literal=/^(?:'((?:\\\\.|[^'\\\\])*?)'|\"((?:\\\\.|[^\"\\\\])*?)\")/;pp$9.strictDirective=function(start){if(this.options.ecmaVersion<5){return false;}for(;;){// Try to find string literal.\nskipWhiteSpace.lastIndex=start;start+=skipWhiteSpace.exec(this.input)[0].length;var match=literal.exec(this.input.slice(start));if(!match){return false;}if((match[1]||match[2])===\"use strict\"){skipWhiteSpace.lastIndex=start+match[0].length;var spaceAfter=skipWhiteSpace.exec(this.input),end=spaceAfter.index+spaceAfter[0].length;var next=this.input.charAt(end);return next===\";\"||next===\"}\"||lineBreak.test(spaceAfter[0])&&!(/[(`.[+\\-/*%<>=,?^&]/.test(next)||next===\"!\"&&this.input.charAt(end+1)===\"=\");}start+=match[0].length;// Skip semicolon, if any.\nskipWhiteSpace.lastIndex=start;start+=skipWhiteSpace.exec(this.input)[0].length;if(this.input[start]===\";\"){start++;}}};// Predicate that tests whether the next token is of the given\n// type, and if yes, consumes it as a side effect.\npp$9.eat=function(type){if(this.type===type){this.next();return true;}else{return false;}};// Tests whether parsed token is a contextual keyword.\npp$9.isContextual=function(name){return this.type===types$1.name&&this.value===name&&!this.containsEsc;};// Consumes contextual keyword if possible.\npp$9.eatContextual=function(name){if(!this.isContextual(name)){return false;}this.next();return true;};// Asserts that following token is given contextual keyword.\npp$9.expectContextual=function(name){if(!this.eatContextual(name)){this.unexpected();}};// Test whether a semicolon can be inserted at the current position.\npp$9.canInsertSemicolon=function(){return this.type===types$1.eof||this.type===types$1.braceR||lineBreak.test(this.input.slice(this.lastTokEnd,this.start));};pp$9.insertSemicolon=function(){if(this.canInsertSemicolon()){if(this.options.onInsertedSemicolon){this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc);}return true;}};// Consume a semicolon, or, failing that, see if we are allowed to\n// pretend that there is a semicolon at this position.\npp$9.semicolon=function(){if(!this.eat(types$1.semi)&&!this.insertSemicolon()){this.unexpected();}};pp$9.afterTrailingComma=function(tokType,notNext){if(this.type===tokType){if(this.options.onTrailingComma){this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc);}if(!notNext){this.next();}return true;}};// Expect a token of a given type. If found, consume it, otherwise,\n// raise an unexpected token error.\npp$9.expect=function(type){this.eat(type)||this.unexpected();};// Raise an unexpected token error.\npp$9.unexpected=function(pos){this.raise(pos!=null?pos:this.start,\"Unexpected token\");};var DestructuringErrors=function DestructuringErrors(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1;};pp$9.checkPatternErrors=function(refDestructuringErrors,isAssign){if(!refDestructuringErrors){return;}if(refDestructuringErrors.trailingComma>-1){this.raiseRecoverable(refDestructuringErrors.trailingComma,\"Comma is not permitted after the rest element\");}var parens=isAssign?refDestructuringErrors.parenthesizedAssign:refDestructuringErrors.parenthesizedBind;if(parens>-1){this.raiseRecoverable(parens,\"Parenthesized pattern\");}};pp$9.checkExpressionErrors=function(refDestructuringErrors,andThrow){if(!refDestructuringErrors){return false;}var shorthandAssign=refDestructuringErrors.shorthandAssign;var doubleProto=refDestructuringErrors.doubleProto;if(!andThrow){return shorthandAssign>=0||doubleProto>=0;}if(shorthandAssign>=0){this.raise(shorthandAssign,\"Shorthand property assignments are valid only in destructuring patterns\");}if(doubleProto>=0){this.raiseRecoverable(doubleProto,\"Redefinition of __proto__ property\");}};pp$9.checkYieldAwaitInDefaultParams=function(){if(this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)){this.raise(this.yieldPos,\"Yield expression cannot be a default value\");}if(this.awaitPos){this.raise(this.awaitPos,\"Await expression cannot be a default value\");}};pp$9.isSimpleAssignTarget=function(expr){if(expr.type===\"ParenthesizedExpression\"){return this.isSimpleAssignTarget(expr.expression);}return expr.type===\"Identifier\"||expr.type===\"MemberExpression\";};var pp$8=Parser.prototype;// ### Statement parsing\n// Parse a program. Initializes the parser, reads any number of\n// statements, and wraps them in a Program node.  Optionally takes a\n// `program` argument.  If present, the statements will be appended\n// to its body instead of creating a new node.\npp$8.parseTopLevel=function(node){var exports=Object.create(null);if(!node.body){node.body=[];}while(this.type!==types$1.eof){var stmt=this.parseStatement(null,true,exports);node.body.push(stmt);}if(this.inModule){for(var i=0,list=Object.keys(this.undefinedExports);i<list.length;i+=1){var name=list[i];this.raiseRecoverable(this.undefinedExports[name].start,\"Export '\"+name+\"' is not defined\");}}this.adaptDirectivePrologue(node.body);this.next();node.sourceType=this.options.sourceType;return this.finishNode(node,\"Program\");};var loopLabel={kind:\"loop\"},switchLabel={kind:\"switch\"};pp$8.isLet=function(context){if(this.options.ecmaVersion<6||!this.isContextual(\"let\")){return false;}skipWhiteSpace.lastIndex=this.pos;var skip=skipWhiteSpace.exec(this.input);var next=this.pos+skip[0].length,nextCh=this.input.charCodeAt(next);// For ambiguous cases, determine if a LexicalDeclaration (or only a\n// Statement) is allowed here. If context is not empty then only a Statement\n// is allowed. However, `let [` is an explicit negative lookahead for\n// ExpressionStatement, so special-case it first.\nif(nextCh===91||nextCh===92||nextCh>0xd7ff&&nextCh<0xdc00){return true;}// '[', '/', astral\nif(context){return false;}if(nextCh===123){return true;}// '{'\nif(isIdentifierStart(nextCh,true)){var pos=next+1;while(isIdentifierChar(nextCh=this.input.charCodeAt(pos),true)){++pos;}if(nextCh===92||nextCh>0xd7ff&&nextCh<0xdc00){return true;}var ident=this.input.slice(next,pos);if(!keywordRelationalOperator.test(ident)){return true;}}return false;};// check 'async [no LineTerminator here] function'\n// - 'async /*foo*/ function' is OK.\n// - 'async /*\\n*/ function' is invalid.\npp$8.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual(\"async\")){return false;}skipWhiteSpace.lastIndex=this.pos;var skip=skipWhiteSpace.exec(this.input);var next=this.pos+skip[0].length,after;return!lineBreak.test(this.input.slice(this.pos,next))&&this.input.slice(next,next+8)===\"function\"&&(next+8===this.input.length||!(isIdentifierChar(after=this.input.charCodeAt(next+8))||after>0xd7ff&&after<0xdc00));};// Parse a single statement.\n//\n// If expecting a statement and finding a slash operator, parse a\n// regular expression literal. This is to handle cases like\n// `if (foo) /blah/.exec(foo)`, where looking at the previous token\n// does not help.\npp$8.parseStatement=function(context,topLevel,exports){var starttype=this.type,node=this.startNode(),kind;if(this.isLet(context)){starttype=types$1._var;kind=\"let\";}// Most types of statements are recognized by the keyword they\n// start with. Many are trivial to parse, some require a bit of\n// complexity.\nswitch(starttype){case types$1._break:case types$1._continue:return this.parseBreakContinueStatement(node,starttype.keyword);case types$1._debugger:return this.parseDebuggerStatement(node);case types$1._do:return this.parseDoStatement(node);case types$1._for:return this.parseForStatement(node);case types$1._function:// Function as sole body of either an if statement or a labeled statement\n// works, but not when it is part of a labeled statement that is the sole\n// body of an if statement.\nif(context&&(this.strict||context!==\"if\"&&context!==\"label\")&&this.options.ecmaVersion>=6){this.unexpected();}return this.parseFunctionStatement(node,false,!context);case types$1._class:if(context){this.unexpected();}return this.parseClass(node,true);case types$1._if:return this.parseIfStatement(node);case types$1._return:return this.parseReturnStatement(node);case types$1._switch:return this.parseSwitchStatement(node);case types$1._throw:return this.parseThrowStatement(node);case types$1._try:return this.parseTryStatement(node);case types$1._const:case types$1._var:kind=kind||this.value;if(context&&kind!==\"var\"){this.unexpected();}return this.parseVarStatement(node,kind);case types$1._while:return this.parseWhileStatement(node);case types$1._with:return this.parseWithStatement(node);case types$1.braceL:return this.parseBlock(true,node);case types$1.semi:return this.parseEmptyStatement(node);case types$1._export:case types$1._import:if(this.options.ecmaVersion>10&&starttype===types$1._import){skipWhiteSpace.lastIndex=this.pos;var skip=skipWhiteSpace.exec(this.input);var next=this.pos+skip[0].length,nextCh=this.input.charCodeAt(next);if(nextCh===40||nextCh===46)// '(' or '.'\n{return this.parseExpressionStatement(node,this.parseExpression());}}if(!this.options.allowImportExportEverywhere){if(!topLevel){this.raise(this.start,\"'import' and 'export' may only appear at the top level\");}if(!this.inModule){this.raise(this.start,\"'import' and 'export' may appear only with 'sourceType: module'\");}}return starttype===types$1._import?this.parseImport(node):this.parseExport(node,exports);// If the statement does not start with a statement keyword or a\n// brace, it's an ExpressionStatement or LabeledStatement. We\n// simply start parsing an expression, and afterwards, if the\n// next token is a colon and the expression was a simple\n// Identifier node, we switch to interpreting it as a label.\ndefault:if(this.isAsyncFunction()){if(context){this.unexpected();}this.next();return this.parseFunctionStatement(node,true,!context);}var maybeName=this.value,expr=this.parseExpression();if(starttype===types$1.name&&expr.type===\"Identifier\"&&this.eat(types$1.colon)){return this.parseLabeledStatement(node,maybeName,expr,context);}else{return this.parseExpressionStatement(node,expr);}}};pp$8.parseBreakContinueStatement=function(node,keyword){var isBreak=keyword===\"break\";this.next();if(this.eat(types$1.semi)||this.insertSemicolon()){node.label=null;}else if(this.type!==types$1.name){this.unexpected();}else{node.label=this.parseIdent();this.semicolon();}// Verify that there is an actual destination to break or\n// continue to.\nvar i=0;for(;i<this.labels.length;++i){var lab=this.labels[i];if(node.label==null||lab.name===node.label.name){if(lab.kind!=null&&(isBreak||lab.kind===\"loop\")){break;}if(node.label&&isBreak){break;}}}if(i===this.labels.length){this.raise(node.start,\"Unsyntactic \"+keyword);}return this.finishNode(node,isBreak?\"BreakStatement\":\"ContinueStatement\");};pp$8.parseDebuggerStatement=function(node){this.next();this.semicolon();return this.finishNode(node,\"DebuggerStatement\");};pp$8.parseDoStatement=function(node){this.next();this.labels.push(loopLabel);node.body=this.parseStatement(\"do\");this.labels.pop();this.expect(types$1._while);node.test=this.parseParenExpression();if(this.options.ecmaVersion>=6){this.eat(types$1.semi);}else{this.semicolon();}return this.finishNode(node,\"DoWhileStatement\");};// Disambiguating between a `for` and a `for`/`in` or `for`/`of`\n// loop is non-trivial. Basically, we have to parse the init `var`\n// statement or expression, disallowing the `in` operator (see\n// the second parameter to `parseExpression`), and then check\n// whether the next token is `in` or `of`. When there is no init\n// part (semicolon immediately after the opening parenthesis), it\n// is a regular `for` loop.\npp$8.parseForStatement=function(node){this.next();var awaitAt=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual(\"await\")?this.lastTokStart:-1;this.labels.push(loopLabel);this.enterScope(0);this.expect(types$1.parenL);if(this.type===types$1.semi){if(awaitAt>-1){this.unexpected(awaitAt);}return this.parseFor(node,null);}var isLet=this.isLet();if(this.type===types$1._var||this.type===types$1._const||isLet){var init$1=this.startNode(),kind=isLet?\"let\":this.value;this.next();this.parseVar(init$1,true,kind);this.finishNode(init$1,\"VariableDeclaration\");if((this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual(\"of\"))&&init$1.declarations.length===1){if(this.options.ecmaVersion>=9){if(this.type===types$1._in){if(awaitAt>-1){this.unexpected(awaitAt);}}else{node.await=awaitAt>-1;}}return this.parseForIn(node,init$1);}if(awaitAt>-1){this.unexpected(awaitAt);}return this.parseFor(node,init$1);}var startsWithLet=this.isContextual(\"let\"),isForOf=false;var refDestructuringErrors=new DestructuringErrors();var init=this.parseExpression(awaitAt>-1?\"await\":true,refDestructuringErrors);if(this.type===types$1._in||(isForOf=this.options.ecmaVersion>=6&&this.isContextual(\"of\"))){if(this.options.ecmaVersion>=9){if(this.type===types$1._in){if(awaitAt>-1){this.unexpected(awaitAt);}}else{node.await=awaitAt>-1;}}if(startsWithLet&&isForOf){this.raise(init.start,\"The left-hand side of a for-of loop may not start with 'let'.\");}this.toAssignable(init,false,refDestructuringErrors);this.checkLValPattern(init);return this.parseForIn(node,init);}else{this.checkExpressionErrors(refDestructuringErrors,true);}if(awaitAt>-1){this.unexpected(awaitAt);}return this.parseFor(node,init);};pp$8.parseFunctionStatement=function(node,isAsync,declarationPosition){this.next();return this.parseFunction(node,FUNC_STATEMENT|(declarationPosition?0:FUNC_HANGING_STATEMENT),false,isAsync);};pp$8.parseIfStatement=function(node){this.next();node.test=this.parseParenExpression();// allow function declarations in branches, but only in non-strict mode\nnode.consequent=this.parseStatement(\"if\");node.alternate=this.eat(types$1._else)?this.parseStatement(\"if\"):null;return this.finishNode(node,\"IfStatement\");};pp$8.parseReturnStatement=function(node){if(!this.inFunction&&!this.options.allowReturnOutsideFunction){this.raise(this.start,\"'return' outside of function\");}this.next();// In `return` (and `break`/`continue`), the keywords with\n// optional arguments, we eagerly look for a semicolon or the\n// possibility to insert one.\nif(this.eat(types$1.semi)||this.insertSemicolon()){node.argument=null;}else{node.argument=this.parseExpression();this.semicolon();}return this.finishNode(node,\"ReturnStatement\");};pp$8.parseSwitchStatement=function(node){this.next();node.discriminant=this.parseParenExpression();node.cases=[];this.expect(types$1.braceL);this.labels.push(switchLabel);this.enterScope(0);// Statements under must be grouped (by label) in SwitchCase\n// nodes. `cur` is used to keep the node that we are currently\n// adding statements to.\nvar cur;for(var sawDefault=false;this.type!==types$1.braceR;){if(this.type===types$1._case||this.type===types$1._default){var isCase=this.type===types$1._case;if(cur){this.finishNode(cur,\"SwitchCase\");}node.cases.push(cur=this.startNode());cur.consequent=[];this.next();if(isCase){cur.test=this.parseExpression();}else{if(sawDefault){this.raiseRecoverable(this.lastTokStart,\"Multiple default clauses\");}sawDefault=true;cur.test=null;}this.expect(types$1.colon);}else{if(!cur){this.unexpected();}cur.consequent.push(this.parseStatement(null));}}this.exitScope();if(cur){this.finishNode(cur,\"SwitchCase\");}this.next();// Closing brace\nthis.labels.pop();return this.finishNode(node,\"SwitchStatement\");};pp$8.parseThrowStatement=function(node){this.next();if(lineBreak.test(this.input.slice(this.lastTokEnd,this.start))){this.raise(this.lastTokEnd,\"Illegal newline after throw\");}node.argument=this.parseExpression();this.semicolon();return this.finishNode(node,\"ThrowStatement\");};// Reused empty array added for node fields that are always empty.\nvar empty$1=[];pp$8.parseTryStatement=function(node){this.next();node.block=this.parseBlock();node.handler=null;if(this.type===types$1._catch){var clause=this.startNode();this.next();if(this.eat(types$1.parenL)){clause.param=this.parseBindingAtom();var simple=clause.param.type===\"Identifier\";this.enterScope(simple?SCOPE_SIMPLE_CATCH:0);this.checkLValPattern(clause.param,simple?BIND_SIMPLE_CATCH:BIND_LEXICAL);this.expect(types$1.parenR);}else{if(this.options.ecmaVersion<10){this.unexpected();}clause.param=null;this.enterScope(0);}clause.body=this.parseBlock(false);this.exitScope();node.handler=this.finishNode(clause,\"CatchClause\");}node.finalizer=this.eat(types$1._finally)?this.parseBlock():null;if(!node.handler&&!node.finalizer){this.raise(node.start,\"Missing catch or finally clause\");}return this.finishNode(node,\"TryStatement\");};pp$8.parseVarStatement=function(node,kind){this.next();this.parseVar(node,false,kind);this.semicolon();return this.finishNode(node,\"VariableDeclaration\");};pp$8.parseWhileStatement=function(node){this.next();node.test=this.parseParenExpression();this.labels.push(loopLabel);node.body=this.parseStatement(\"while\");this.labels.pop();return this.finishNode(node,\"WhileStatement\");};pp$8.parseWithStatement=function(node){if(this.strict){this.raise(this.start,\"'with' in strict mode\");}this.next();node.object=this.parseParenExpression();node.body=this.parseStatement(\"with\");return this.finishNode(node,\"WithStatement\");};pp$8.parseEmptyStatement=function(node){this.next();return this.finishNode(node,\"EmptyStatement\");};pp$8.parseLabeledStatement=function(node,maybeName,expr,context){for(var i$1=0,list=this.labels;i$1<list.length;i$1+=1){var label=list[i$1];if(label.name===maybeName){this.raise(expr.start,\"Label '\"+maybeName+\"' is already declared\");}}var kind=this.type.isLoop?\"loop\":this.type===types$1._switch?\"switch\":null;for(var i=this.labels.length-1;i>=0;i--){var label$1=this.labels[i];if(label$1.statementStart===node.start){// Update information about previous labels on this node\nlabel$1.statementStart=this.start;label$1.kind=kind;}else{break;}}this.labels.push({name:maybeName,kind:kind,statementStart:this.start});node.body=this.parseStatement(context?context.indexOf(\"label\")===-1?context+\"label\":context:\"label\");this.labels.pop();node.label=expr;return this.finishNode(node,\"LabeledStatement\");};pp$8.parseExpressionStatement=function(node,expr){node.expression=expr;this.semicolon();return this.finishNode(node,\"ExpressionStatement\");};// Parse a semicolon-enclosed block of statements, handling `\"use\n// strict\"` declarations when `allowStrict` is true (used for\n// function bodies).\npp$8.parseBlock=function(createNewLexicalScope,node,exitStrict){if(createNewLexicalScope===void 0)createNewLexicalScope=true;if(node===void 0)node=this.startNode();node.body=[];this.expect(types$1.braceL);if(createNewLexicalScope){this.enterScope(0);}while(this.type!==types$1.braceR){var stmt=this.parseStatement(null);node.body.push(stmt);}if(exitStrict){this.strict=false;}this.next();if(createNewLexicalScope){this.exitScope();}return this.finishNode(node,\"BlockStatement\");};// Parse a regular `for` loop. The disambiguation code in\n// `parseStatement` will already have parsed the init statement or\n// expression.\npp$8.parseFor=function(node,init){node.init=init;this.expect(types$1.semi);node.test=this.type===types$1.semi?null:this.parseExpression();this.expect(types$1.semi);node.update=this.type===types$1.parenR?null:this.parseExpression();this.expect(types$1.parenR);node.body=this.parseStatement(\"for\");this.exitScope();this.labels.pop();return this.finishNode(node,\"ForStatement\");};// Parse a `for`/`in` and `for`/`of` loop, which are almost\n// same from parser's perspective.\npp$8.parseForIn=function(node,init){var isForIn=this.type===types$1._in;this.next();if(init.type===\"VariableDeclaration\"&&init.declarations[0].init!=null&&(!isForIn||this.options.ecmaVersion<8||this.strict||init.kind!==\"var\"||init.declarations[0].id.type!==\"Identifier\")){this.raise(init.start,(isForIn?\"for-in\":\"for-of\")+\" loop variable declaration may not have an initializer\");}node.left=init;node.right=isForIn?this.parseExpression():this.parseMaybeAssign();this.expect(types$1.parenR);node.body=this.parseStatement(\"for\");this.exitScope();this.labels.pop();return this.finishNode(node,isForIn?\"ForInStatement\":\"ForOfStatement\");};// Parse a list of variable declarations.\npp$8.parseVar=function(node,isFor,kind){node.declarations=[];node.kind=kind;for(;;){var decl=this.startNode();this.parseVarId(decl,kind);if(this.eat(types$1.eq)){decl.init=this.parseMaybeAssign(isFor);}else if(kind===\"const\"&&!(this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual(\"of\"))){this.unexpected();}else if(decl.id.type!==\"Identifier\"&&!(isFor&&(this.type===types$1._in||this.isContextual(\"of\")))){this.raise(this.lastTokEnd,\"Complex binding patterns require an initialization value\");}else{decl.init=null;}node.declarations.push(this.finishNode(decl,\"VariableDeclarator\"));if(!this.eat(types$1.comma)){break;}}return node;};pp$8.parseVarId=function(decl,kind){decl.id=this.parseBindingAtom();this.checkLValPattern(decl.id,kind===\"var\"?BIND_VAR:BIND_LEXICAL,false);};var FUNC_STATEMENT=1,FUNC_HANGING_STATEMENT=2,FUNC_NULLABLE_ID=4;// Parse a function declaration or literal (depending on the\n// `statement & FUNC_STATEMENT`).\n// Remove `allowExpressionBody` for 7.0.0, as it is only called with false\npp$8.parseFunction=function(node,statement,allowExpressionBody,isAsync,forInit){this.initFunction(node);if(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!isAsync){if(this.type===types$1.star&&statement&FUNC_HANGING_STATEMENT){this.unexpected();}node.generator=this.eat(types$1.star);}if(this.options.ecmaVersion>=8){node.async=!!isAsync;}if(statement&FUNC_STATEMENT){node.id=statement&FUNC_NULLABLE_ID&&this.type!==types$1.name?null:this.parseIdent();if(node.id&&!(statement&FUNC_HANGING_STATEMENT))// If it is a regular function declaration in sloppy mode, then it is\n// subject to Annex B semantics (BIND_FUNCTION). Otherwise, the binding\n// mode depends on properties of the current scope (see\n// treatFunctionsAsVar).\n{this.checkLValSimple(node.id,this.strict||node.generator||node.async?this.treatFunctionsAsVar?BIND_VAR:BIND_LEXICAL:BIND_FUNCTION);}}var oldYieldPos=this.yieldPos,oldAwaitPos=this.awaitPos,oldAwaitIdentPos=this.awaitIdentPos;this.yieldPos=0;this.awaitPos=0;this.awaitIdentPos=0;this.enterScope(functionFlags(node.async,node.generator));if(!(statement&FUNC_STATEMENT)){node.id=this.type===types$1.name?this.parseIdent():null;}this.parseFunctionParams(node);this.parseFunctionBody(node,allowExpressionBody,false,forInit);this.yieldPos=oldYieldPos;this.awaitPos=oldAwaitPos;this.awaitIdentPos=oldAwaitIdentPos;return this.finishNode(node,statement&FUNC_STATEMENT?\"FunctionDeclaration\":\"FunctionExpression\");};pp$8.parseFunctionParams=function(node){this.expect(types$1.parenL);node.params=this.parseBindingList(types$1.parenR,false,this.options.ecmaVersion>=8);this.checkYieldAwaitInDefaultParams();};// Parse a class declaration or literal (depending on the\n// `isStatement` parameter).\npp$8.parseClass=function(node,isStatement){this.next();// ecma-262 14.6 Class Definitions\n// A class definition is always strict mode code.\nvar oldStrict=this.strict;this.strict=true;this.parseClassId(node,isStatement);this.parseClassSuper(node);var privateNameMap=this.enterClassBody();var classBody=this.startNode();var hadConstructor=false;classBody.body=[];this.expect(types$1.braceL);while(this.type!==types$1.braceR){var element=this.parseClassElement(node.superClass!==null);if(element){classBody.body.push(element);if(element.type===\"MethodDefinition\"&&element.kind===\"constructor\"){if(hadConstructor){this.raise(element.start,\"Duplicate constructor in the same class\");}hadConstructor=true;}else if(element.key&&element.key.type===\"PrivateIdentifier\"&&isPrivateNameConflicted(privateNameMap,element)){this.raiseRecoverable(element.key.start,\"Identifier '#\"+element.key.name+\"' has already been declared\");}}}this.strict=oldStrict;this.next();node.body=this.finishNode(classBody,\"ClassBody\");this.exitClassBody();return this.finishNode(node,isStatement?\"ClassDeclaration\":\"ClassExpression\");};pp$8.parseClassElement=function(constructorAllowsSuper){if(this.eat(types$1.semi)){return null;}var ecmaVersion=this.options.ecmaVersion;var node=this.startNode();var keyName=\"\";var isGenerator=false;var isAsync=false;var kind=\"method\";var isStatic=false;if(this.eatContextual(\"static\")){// Parse static init block\nif(ecmaVersion>=13&&this.eat(types$1.braceL)){this.parseClassStaticBlock(node);return node;}if(this.isClassElementNameStart()||this.type===types$1.star){isStatic=true;}else{keyName=\"static\";}}node.static=isStatic;if(!keyName&&ecmaVersion>=8&&this.eatContextual(\"async\")){if((this.isClassElementNameStart()||this.type===types$1.star)&&!this.canInsertSemicolon()){isAsync=true;}else{keyName=\"async\";}}if(!keyName&&(ecmaVersion>=9||!isAsync)&&this.eat(types$1.star)){isGenerator=true;}if(!keyName&&!isAsync&&!isGenerator){var lastValue=this.value;if(this.eatContextual(\"get\")||this.eatContextual(\"set\")){if(this.isClassElementNameStart()){kind=lastValue;}else{keyName=lastValue;}}}// Parse element name\nif(keyName){// 'async', 'get', 'set', or 'static' were not a keyword contextually.\n// The last token is any of those. Make it the element name.\nnode.computed=false;node.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc);node.key.name=keyName;this.finishNode(node.key,\"Identifier\");}else{this.parseClassElementName(node);}// Parse element value\nif(ecmaVersion<13||this.type===types$1.parenL||kind!==\"method\"||isGenerator||isAsync){var isConstructor=!node.static&&checkKeyName(node,\"constructor\");var allowsDirectSuper=isConstructor&&constructorAllowsSuper;// Couldn't move this check into the 'parseClassMethod' method for backward compatibility.\nif(isConstructor&&kind!==\"method\"){this.raise(node.key.start,\"Constructor can't have get/set modifier\");}node.kind=isConstructor?\"constructor\":kind;this.parseClassMethod(node,isGenerator,isAsync,allowsDirectSuper);}else{this.parseClassField(node);}return node;};pp$8.isClassElementNameStart=function(){return this.type===types$1.name||this.type===types$1.privateId||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword;};pp$8.parseClassElementName=function(element){if(this.type===types$1.privateId){if(this.value===\"constructor\"){this.raise(this.start,\"Classes can't have an element named '#constructor'\");}element.computed=false;element.key=this.parsePrivateIdent();}else{this.parsePropertyName(element);}};pp$8.parseClassMethod=function(method,isGenerator,isAsync,allowsDirectSuper){// Check key and flags\nvar key=method.key;if(method.kind===\"constructor\"){if(isGenerator){this.raise(key.start,\"Constructor can't be a generator\");}if(isAsync){this.raise(key.start,\"Constructor can't be an async method\");}}else if(method.static&&checkKeyName(method,\"prototype\")){this.raise(key.start,\"Classes may not have a static property named prototype\");}// Parse value\nvar value=method.value=this.parseMethod(isGenerator,isAsync,allowsDirectSuper);// Check value\nif(method.kind===\"get\"&&value.params.length!==0){this.raiseRecoverable(value.start,\"getter should have no params\");}if(method.kind===\"set\"&&value.params.length!==1){this.raiseRecoverable(value.start,\"setter should have exactly one param\");}if(method.kind===\"set\"&&value.params[0].type===\"RestElement\"){this.raiseRecoverable(value.params[0].start,\"Setter cannot use rest params\");}return this.finishNode(method,\"MethodDefinition\");};pp$8.parseClassField=function(field){if(checkKeyName(field,\"constructor\")){this.raise(field.key.start,\"Classes can't have a field named 'constructor'\");}else if(field.static&&checkKeyName(field,\"prototype\")){this.raise(field.key.start,\"Classes can't have a static field named 'prototype'\");}if(this.eat(types$1.eq)){// To raise SyntaxError if 'arguments' exists in the initializer.\nvar scope=this.currentThisScope();var inClassFieldInit=scope.inClassFieldInit;scope.inClassFieldInit=true;field.value=this.parseMaybeAssign();scope.inClassFieldInit=inClassFieldInit;}else{field.value=null;}this.semicolon();return this.finishNode(field,\"PropertyDefinition\");};pp$8.parseClassStaticBlock=function(node){node.body=[];var oldLabels=this.labels;this.labels=[];this.enterScope(SCOPE_CLASS_STATIC_BLOCK|SCOPE_SUPER);while(this.type!==types$1.braceR){var stmt=this.parseStatement(null);node.body.push(stmt);}this.next();this.exitScope();this.labels=oldLabels;return this.finishNode(node,\"StaticBlock\");};pp$8.parseClassId=function(node,isStatement){if(this.type===types$1.name){node.id=this.parseIdent();if(isStatement){this.checkLValSimple(node.id,BIND_LEXICAL,false);}}else{if(isStatement===true){this.unexpected();}node.id=null;}};pp$8.parseClassSuper=function(node){node.superClass=this.eat(types$1._extends)?this.parseExprSubscripts(false):null;};pp$8.enterClassBody=function(){var element={declared:Object.create(null),used:[]};this.privateNameStack.push(element);return element.declared;};pp$8.exitClassBody=function(){var ref=this.privateNameStack.pop();var declared=ref.declared;var used=ref.used;var len=this.privateNameStack.length;var parent=len===0?null:this.privateNameStack[len-1];for(var i=0;i<used.length;++i){var id=used[i];if(!hasOwn(declared,id.name)){if(parent){parent.used.push(id);}else{this.raiseRecoverable(id.start,\"Private field '#\"+id.name+\"' must be declared in an enclosing class\");}}}};function isPrivateNameConflicted(privateNameMap,element){var name=element.key.name;var curr=privateNameMap[name];var next=\"true\";if(element.type===\"MethodDefinition\"&&(element.kind===\"get\"||element.kind===\"set\")){next=(element.static?\"s\":\"i\")+element.kind;}// `class { get #a(){}; static set #a(_){} }` is also conflict.\nif(curr===\"iget\"&&next===\"iset\"||curr===\"iset\"&&next===\"iget\"||curr===\"sget\"&&next===\"sset\"||curr===\"sset\"&&next===\"sget\"){privateNameMap[name]=\"true\";return false;}else if(!curr){privateNameMap[name]=next;return false;}else{return true;}}function checkKeyName(node,name){var computed=node.computed;var key=node.key;return!computed&&(key.type===\"Identifier\"&&key.name===name||key.type===\"Literal\"&&key.value===name);}// Parses module export declaration.\npp$8.parseExport=function(node,exports){this.next();// export * from '...'\nif(this.eat(types$1.star)){if(this.options.ecmaVersion>=11){if(this.eatContextual(\"as\")){node.exported=this.parseModuleExportName();this.checkExport(exports,node.exported,this.lastTokStart);}else{node.exported=null;}}this.expectContextual(\"from\");if(this.type!==types$1.string){this.unexpected();}node.source=this.parseExprAtom();this.semicolon();return this.finishNode(node,\"ExportAllDeclaration\");}if(this.eat(types$1._default)){// export default ...\nthis.checkExport(exports,\"default\",this.lastTokStart);var isAsync;if(this.type===types$1._function||(isAsync=this.isAsyncFunction())){var fNode=this.startNode();this.next();if(isAsync){this.next();}node.declaration=this.parseFunction(fNode,FUNC_STATEMENT|FUNC_NULLABLE_ID,false,isAsync);}else if(this.type===types$1._class){var cNode=this.startNode();node.declaration=this.parseClass(cNode,\"nullableID\");}else{node.declaration=this.parseMaybeAssign();this.semicolon();}return this.finishNode(node,\"ExportDefaultDeclaration\");}// export var|const|let|function|class ...\nif(this.shouldParseExportStatement()){node.declaration=this.parseStatement(null);if(node.declaration.type===\"VariableDeclaration\"){this.checkVariableExport(exports,node.declaration.declarations);}else{this.checkExport(exports,node.declaration.id,node.declaration.id.start);}node.specifiers=[];node.source=null;}else{// export { x, y as z } [from '...']\nnode.declaration=null;node.specifiers=this.parseExportSpecifiers(exports);if(this.eatContextual(\"from\")){if(this.type!==types$1.string){this.unexpected();}node.source=this.parseExprAtom();}else{for(var i=0,list=node.specifiers;i<list.length;i+=1){// check for keywords used as local names\nvar spec=list[i];this.checkUnreserved(spec.local);// check if export is defined\nthis.checkLocalExport(spec.local);if(spec.local.type===\"Literal\"){this.raise(spec.local.start,\"A string literal cannot be used as an exported binding without `from`.\");}}node.source=null;}this.semicolon();}return this.finishNode(node,\"ExportNamedDeclaration\");};pp$8.checkExport=function(exports,name,pos){if(!exports){return;}if(typeof name!==\"string\"){name=name.type===\"Identifier\"?name.name:name.value;}if(hasOwn(exports,name)){this.raiseRecoverable(pos,\"Duplicate export '\"+name+\"'\");}exports[name]=true;};pp$8.checkPatternExport=function(exports,pat){var type=pat.type;if(type===\"Identifier\"){this.checkExport(exports,pat,pat.start);}else if(type===\"ObjectPattern\"){for(var i=0,list=pat.properties;i<list.length;i+=1){var prop=list[i];this.checkPatternExport(exports,prop);}}else if(type===\"ArrayPattern\"){for(var i$1=0,list$1=pat.elements;i$1<list$1.length;i$1+=1){var elt=list$1[i$1];if(elt){this.checkPatternExport(exports,elt);}}}else if(type===\"Property\"){this.checkPatternExport(exports,pat.value);}else if(type===\"AssignmentPattern\"){this.checkPatternExport(exports,pat.left);}else if(type===\"RestElement\"){this.checkPatternExport(exports,pat.argument);}else if(type===\"ParenthesizedExpression\"){this.checkPatternExport(exports,pat.expression);}};pp$8.checkVariableExport=function(exports,decls){if(!exports){return;}for(var i=0,list=decls;i<list.length;i+=1){var decl=list[i];this.checkPatternExport(exports,decl.id);}};pp$8.shouldParseExportStatement=function(){return this.type.keyword===\"var\"||this.type.keyword===\"const\"||this.type.keyword===\"class\"||this.type.keyword===\"function\"||this.isLet()||this.isAsyncFunction();};// Parses a comma-separated list of module exports.\npp$8.parseExportSpecifiers=function(exports){var nodes=[],first=true;// export { x, y as z } [from '...']\nthis.expect(types$1.braceL);while(!this.eat(types$1.braceR)){if(!first){this.expect(types$1.comma);if(this.afterTrailingComma(types$1.braceR)){break;}}else{first=false;}var node=this.startNode();node.local=this.parseModuleExportName();node.exported=this.eatContextual(\"as\")?this.parseModuleExportName():node.local;this.checkExport(exports,node.exported,node.exported.start);nodes.push(this.finishNode(node,\"ExportSpecifier\"));}return nodes;};// Parses import declaration.\npp$8.parseImport=function(node){this.next();// import '...'\nif(this.type===types$1.string){node.specifiers=empty$1;node.source=this.parseExprAtom();}else{node.specifiers=this.parseImportSpecifiers();this.expectContextual(\"from\");node.source=this.type===types$1.string?this.parseExprAtom():this.unexpected();}this.semicolon();return this.finishNode(node,\"ImportDeclaration\");};// Parses a comma-separated list of module imports.\npp$8.parseImportSpecifiers=function(){var nodes=[],first=true;if(this.type===types$1.name){// import defaultObj, { x, y as z } from '...'\nvar node=this.startNode();node.local=this.parseIdent();this.checkLValSimple(node.local,BIND_LEXICAL);nodes.push(this.finishNode(node,\"ImportDefaultSpecifier\"));if(!this.eat(types$1.comma)){return nodes;}}if(this.type===types$1.star){var node$1=this.startNode();this.next();this.expectContextual(\"as\");node$1.local=this.parseIdent();this.checkLValSimple(node$1.local,BIND_LEXICAL);nodes.push(this.finishNode(node$1,\"ImportNamespaceSpecifier\"));return nodes;}this.expect(types$1.braceL);while(!this.eat(types$1.braceR)){if(!first){this.expect(types$1.comma);if(this.afterTrailingComma(types$1.braceR)){break;}}else{first=false;}var node$2=this.startNode();node$2.imported=this.parseModuleExportName();if(this.eatContextual(\"as\")){node$2.local=this.parseIdent();}else{this.checkUnreserved(node$2.imported);node$2.local=node$2.imported;}this.checkLValSimple(node$2.local,BIND_LEXICAL);nodes.push(this.finishNode(node$2,\"ImportSpecifier\"));}return nodes;};pp$8.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===types$1.string){var stringLiteral=this.parseLiteral(this.value);if(loneSurrogate.test(stringLiteral.value)){this.raise(stringLiteral.start,\"An export name cannot include a lone surrogate.\");}return stringLiteral;}return this.parseIdent(true);};// Set `ExpressionStatement#directive` property for directive prologues.\npp$8.adaptDirectivePrologue=function(statements){for(var i=0;i<statements.length&&this.isDirectiveCandidate(statements[i]);++i){statements[i].directive=statements[i].expression.raw.slice(1,-1);}};pp$8.isDirectiveCandidate=function(statement){return statement.type===\"ExpressionStatement\"&&statement.expression.type===\"Literal\"&&typeof statement.expression.value===\"string\"&&(// Reject parenthesized strings.\nthis.input[statement.start]===\"\\\"\"||this.input[statement.start]===\"'\");};var pp$7=Parser.prototype;// Convert existing expression atom to assignable pattern\n// if possible.\npp$7.toAssignable=function(node,isBinding,refDestructuringErrors){if(this.options.ecmaVersion>=6&&node){switch(node.type){case\"Identifier\":if(this.inAsync&&node.name===\"await\"){this.raise(node.start,\"Cannot use 'await' as identifier inside an async function\");}break;case\"ObjectPattern\":case\"ArrayPattern\":case\"AssignmentPattern\":case\"RestElement\":break;case\"ObjectExpression\":node.type=\"ObjectPattern\";if(refDestructuringErrors){this.checkPatternErrors(refDestructuringErrors,true);}for(var i=0,list=node.properties;i<list.length;i+=1){var prop=list[i];this.toAssignable(prop,isBinding);// Early error:\n//   AssignmentRestProperty[Yield, Await] :\n//     `...` DestructuringAssignmentTarget[Yield, Await]\n//\n//   It is a Syntax Error if |DestructuringAssignmentTarget| is an |ArrayLiteral| or an |ObjectLiteral|.\nif(prop.type===\"RestElement\"&&(prop.argument.type===\"ArrayPattern\"||prop.argument.type===\"ObjectPattern\")){this.raise(prop.argument.start,\"Unexpected token\");}}break;case\"Property\":// AssignmentProperty has type === \"Property\"\nif(node.kind!==\"init\"){this.raise(node.key.start,\"Object pattern can't contain getter or setter\");}this.toAssignable(node.value,isBinding);break;case\"ArrayExpression\":node.type=\"ArrayPattern\";if(refDestructuringErrors){this.checkPatternErrors(refDestructuringErrors,true);}this.toAssignableList(node.elements,isBinding);break;case\"SpreadElement\":node.type=\"RestElement\";this.toAssignable(node.argument,isBinding);if(node.argument.type===\"AssignmentPattern\"){this.raise(node.argument.start,\"Rest elements cannot have a default value\");}break;case\"AssignmentExpression\":if(node.operator!==\"=\"){this.raise(node.left.end,\"Only '=' operator can be used for specifying default value.\");}node.type=\"AssignmentPattern\";delete node.operator;this.toAssignable(node.left,isBinding);break;case\"ParenthesizedExpression\":this.toAssignable(node.expression,isBinding,refDestructuringErrors);break;case\"ChainExpression\":this.raiseRecoverable(node.start,\"Optional chaining cannot appear in left-hand side\");break;case\"MemberExpression\":if(!isBinding){break;}default:this.raise(node.start,\"Assigning to rvalue\");}}else if(refDestructuringErrors){this.checkPatternErrors(refDestructuringErrors,true);}return node;};// Convert list of expression atoms to binding list.\npp$7.toAssignableList=function(exprList,isBinding){var end=exprList.length;for(var i=0;i<end;i++){var elt=exprList[i];if(elt){this.toAssignable(elt,isBinding);}}if(end){var last=exprList[end-1];if(this.options.ecmaVersion===6&&isBinding&&last&&last.type===\"RestElement\"&&last.argument.type!==\"Identifier\"){this.unexpected(last.argument.start);}}return exprList;};// Parses spread element.\npp$7.parseSpread=function(refDestructuringErrors){var node=this.startNode();this.next();node.argument=this.parseMaybeAssign(false,refDestructuringErrors);return this.finishNode(node,\"SpreadElement\");};pp$7.parseRestBinding=function(){var node=this.startNode();this.next();// RestElement inside of a function parameter must be an identifier\nif(this.options.ecmaVersion===6&&this.type!==types$1.name){this.unexpected();}node.argument=this.parseBindingAtom();return this.finishNode(node,\"RestElement\");};// Parses lvalue (assignable) atom.\npp$7.parseBindingAtom=function(){if(this.options.ecmaVersion>=6){switch(this.type){case types$1.bracketL:var node=this.startNode();this.next();node.elements=this.parseBindingList(types$1.bracketR,true,true);return this.finishNode(node,\"ArrayPattern\");case types$1.braceL:return this.parseObj(true);}}return this.parseIdent();};pp$7.parseBindingList=function(close,allowEmpty,allowTrailingComma){var elts=[],first=true;while(!this.eat(close)){if(first){first=false;}else{this.expect(types$1.comma);}if(allowEmpty&&this.type===types$1.comma){elts.push(null);}else if(allowTrailingComma&&this.afterTrailingComma(close)){break;}else if(this.type===types$1.ellipsis){var rest=this.parseRestBinding();this.parseBindingListItem(rest);elts.push(rest);if(this.type===types$1.comma){this.raise(this.start,\"Comma is not permitted after the rest element\");}this.expect(close);break;}else{var elem=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(elem);elts.push(elem);}}return elts;};pp$7.parseBindingListItem=function(param){return param;};// Parses assignment pattern around given atom if possible.\npp$7.parseMaybeDefault=function(startPos,startLoc,left){left=left||this.parseBindingAtom();if(this.options.ecmaVersion<6||!this.eat(types$1.eq)){return left;}var node=this.startNodeAt(startPos,startLoc);node.left=left;node.right=this.parseMaybeAssign();return this.finishNode(node,\"AssignmentPattern\");};// The following three functions all verify that a node is an lvalue —\n// something that can be bound, or assigned to. In order to do so, they perform\n// a variety of checks:\n//\n// - Check that none of the bound/assigned-to identifiers are reserved words.\n// - Record name declarations for bindings in the appropriate scope.\n// - Check duplicate argument names, if checkClashes is set.\n//\n// If a complex binding pattern is encountered (e.g., object and array\n// destructuring), the entire pattern is recursively checked.\n//\n// There are three versions of checkLVal*() appropriate for different\n// circumstances:\n//\n// - checkLValSimple() shall be used if the syntactic construct supports\n//   nothing other than identifiers and member expressions. Parenthesized\n//   expressions are also correctly handled. This is generally appropriate for\n//   constructs for which the spec says\n//\n//   > It is a Syntax Error if AssignmentTargetType of [the production] is not\n//   > simple.\n//\n//   It is also appropriate for checking if an identifier is valid and not\n//   defined elsewhere, like import declarations or function/class identifiers.\n//\n//   Examples where this is used include:\n//     a += …;\n//     import a from '…';\n//   where a is the node to be checked.\n//\n// - checkLValPattern() shall be used if the syntactic construct supports\n//   anything checkLValSimple() supports, as well as object and array\n//   destructuring patterns. This is generally appropriate for constructs for\n//   which the spec says\n//\n//   > It is a Syntax Error if [the production] is neither an ObjectLiteral nor\n//   > an ArrayLiteral and AssignmentTargetType of [the production] is not\n//   > simple.\n//\n//   Examples where this is used include:\n//     (a = …);\n//     const a = …;\n//     try { … } catch (a) { … }\n//   where a is the node to be checked.\n//\n// - checkLValInnerPattern() shall be used if the syntactic construct supports\n//   anything checkLValPattern() supports, as well as default assignment\n//   patterns, rest elements, and other constructs that may appear within an\n//   object or array destructuring pattern.\n//\n//   As a special case, function parameters also use checkLValInnerPattern(),\n//   as they also support defaults and rest constructs.\n//\n// These functions deliberately support both assignment and binding constructs,\n// as the logic for both is exceedingly similar. If the node is the target of\n// an assignment, then bindingType should be set to BIND_NONE. Otherwise, it\n// should be set to the appropriate BIND_* constant, like BIND_VAR or\n// BIND_LEXICAL.\n//\n// If the function is called with a non-BIND_NONE bindingType, then\n// additionally a checkClashes object may be specified to allow checking for\n// duplicate argument names. checkClashes is ignored if the provided construct\n// is an assignment (i.e., bindingType is BIND_NONE).\npp$7.checkLValSimple=function(expr,bindingType,checkClashes){if(bindingType===void 0)bindingType=BIND_NONE;var isBind=bindingType!==BIND_NONE;switch(expr.type){case\"Identifier\":if(this.strict&&this.reservedWordsStrictBind.test(expr.name)){this.raiseRecoverable(expr.start,(isBind?\"Binding \":\"Assigning to \")+expr.name+\" in strict mode\");}if(isBind){if(bindingType===BIND_LEXICAL&&expr.name===\"let\"){this.raiseRecoverable(expr.start,\"let is disallowed as a lexically bound name\");}if(checkClashes){if(hasOwn(checkClashes,expr.name)){this.raiseRecoverable(expr.start,\"Argument name clash\");}checkClashes[expr.name]=true;}if(bindingType!==BIND_OUTSIDE){this.declareName(expr.name,bindingType,expr.start);}}break;case\"ChainExpression\":this.raiseRecoverable(expr.start,\"Optional chaining cannot appear in left-hand side\");break;case\"MemberExpression\":if(isBind){this.raiseRecoverable(expr.start,\"Binding member expression\");}break;case\"ParenthesizedExpression\":if(isBind){this.raiseRecoverable(expr.start,\"Binding parenthesized expression\");}return this.checkLValSimple(expr.expression,bindingType,checkClashes);default:this.raise(expr.start,(isBind?\"Binding\":\"Assigning to\")+\" rvalue\");}};pp$7.checkLValPattern=function(expr,bindingType,checkClashes){if(bindingType===void 0)bindingType=BIND_NONE;switch(expr.type){case\"ObjectPattern\":for(var i=0,list=expr.properties;i<list.length;i+=1){var prop=list[i];this.checkLValInnerPattern(prop,bindingType,checkClashes);}break;case\"ArrayPattern\":for(var i$1=0,list$1=expr.elements;i$1<list$1.length;i$1+=1){var elem=list$1[i$1];if(elem){this.checkLValInnerPattern(elem,bindingType,checkClashes);}}break;default:this.checkLValSimple(expr,bindingType,checkClashes);}};pp$7.checkLValInnerPattern=function(expr,bindingType,checkClashes){if(bindingType===void 0)bindingType=BIND_NONE;switch(expr.type){case\"Property\":// AssignmentProperty has type === \"Property\"\nthis.checkLValInnerPattern(expr.value,bindingType,checkClashes);break;case\"AssignmentPattern\":this.checkLValPattern(expr.left,bindingType,checkClashes);break;case\"RestElement\":this.checkLValPattern(expr.argument,bindingType,checkClashes);break;default:this.checkLValPattern(expr,bindingType,checkClashes);}};// The algorithm used to determine whether a regexp can appear at a\nvar TokContext=function TokContext(token,isExpr,preserveSpace,override,generator){this.token=token;this.isExpr=!!isExpr;this.preserveSpace=!!preserveSpace;this.override=override;this.generator=!!generator;};var types={b_stat:new TokContext(\"{\",false),b_expr:new TokContext(\"{\",true),b_tmpl:new TokContext(\"${\",false),p_stat:new TokContext(\"(\",false),p_expr:new TokContext(\"(\",true),q_tmpl:new TokContext(\"`\",true,true,function(p){return p.tryReadTemplateToken();}),f_stat:new TokContext(\"function\",false),f_expr:new TokContext(\"function\",true),f_expr_gen:new TokContext(\"function\",true,false,null,true),f_gen:new TokContext(\"function\",false,false,null,true)};var pp$6=Parser.prototype;pp$6.initialContext=function(){return[types.b_stat];};pp$6.curContext=function(){return this.context[this.context.length-1];};pp$6.braceIsBlock=function(prevType){var parent=this.curContext();if(parent===types.f_expr||parent===types.f_stat){return true;}if(prevType===types$1.colon&&(parent===types.b_stat||parent===types.b_expr)){return!parent.isExpr;}// The check for `tt.name && exprAllowed` detects whether we are\n// after a `yield` or `of` construct. See the `updateContext` for\n// `tt.name`.\nif(prevType===types$1._return||prevType===types$1.name&&this.exprAllowed){return lineBreak.test(this.input.slice(this.lastTokEnd,this.start));}if(prevType===types$1._else||prevType===types$1.semi||prevType===types$1.eof||prevType===types$1.parenR||prevType===types$1.arrow){return true;}if(prevType===types$1.braceL){return parent===types.b_stat;}if(prevType===types$1._var||prevType===types$1._const||prevType===types$1.name){return false;}return!this.exprAllowed;};pp$6.inGeneratorContext=function(){for(var i=this.context.length-1;i>=1;i--){var context=this.context[i];if(context.token===\"function\"){return context.generator;}}return false;};pp$6.updateContext=function(prevType){var update,type=this.type;if(type.keyword&&prevType===types$1.dot){this.exprAllowed=false;}else if(update=type.updateContext){update.call(this,prevType);}else{this.exprAllowed=type.beforeExpr;}};// Used to handle egde case when token context could not be inferred correctly in tokenize phase\npp$6.overrideContext=function(tokenCtx){if(this.curContext()!==tokenCtx){this.context[this.context.length-1]=tokenCtx;}};// Token-specific context update code\ntypes$1.parenR.updateContext=types$1.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=true;return;}var out=this.context.pop();if(out===types.b_stat&&this.curContext().token===\"function\"){out=this.context.pop();}this.exprAllowed=!out.isExpr;};types$1.braceL.updateContext=function(prevType){this.context.push(this.braceIsBlock(prevType)?types.b_stat:types.b_expr);this.exprAllowed=true;};types$1.dollarBraceL.updateContext=function(){this.context.push(types.b_tmpl);this.exprAllowed=true;};types$1.parenL.updateContext=function(prevType){var statementParens=prevType===types$1._if||prevType===types$1._for||prevType===types$1._with||prevType===types$1._while;this.context.push(statementParens?types.p_stat:types.p_expr);this.exprAllowed=true;};types$1.incDec.updateContext=function(){// tokExprAllowed stays unchanged\n};types$1._function.updateContext=types$1._class.updateContext=function(prevType){if(prevType.beforeExpr&&prevType!==types$1._else&&!(prevType===types$1.semi&&this.curContext()!==types.p_stat)&&!(prevType===types$1._return&&lineBreak.test(this.input.slice(this.lastTokEnd,this.start)))&&!((prevType===types$1.colon||prevType===types$1.braceL)&&this.curContext()===types.b_stat)){this.context.push(types.f_expr);}else{this.context.push(types.f_stat);}this.exprAllowed=false;};types$1.backQuote.updateContext=function(){if(this.curContext()===types.q_tmpl){this.context.pop();}else{this.context.push(types.q_tmpl);}this.exprAllowed=false;};types$1.star.updateContext=function(prevType){if(prevType===types$1._function){var index=this.context.length-1;if(this.context[index]===types.f_expr){this.context[index]=types.f_expr_gen;}else{this.context[index]=types.f_gen;}}this.exprAllowed=true;};types$1.name.updateContext=function(prevType){var allowed=false;if(this.options.ecmaVersion>=6&&prevType!==types$1.dot){if(this.value===\"of\"&&!this.exprAllowed||this.value===\"yield\"&&this.inGeneratorContext()){allowed=true;}}this.exprAllowed=allowed;};// A recursive descent parser operates by defining functions for all\nvar pp$5=Parser.prototype;// Check if property name clashes with already added.\n// Object/class getters and setters are not allowed to clash —\n// either with each other or with an init property — and in\n// strict mode, init properties are also not allowed to be repeated.\npp$5.checkPropClash=function(prop,propHash,refDestructuringErrors){if(this.options.ecmaVersion>=9&&prop.type===\"SpreadElement\"){return;}if(this.options.ecmaVersion>=6&&(prop.computed||prop.method||prop.shorthand)){return;}var key=prop.key;var name;switch(key.type){case\"Identifier\":name=key.name;break;case\"Literal\":name=String(key.value);break;default:return;}var kind=prop.kind;if(this.options.ecmaVersion>=6){if(name===\"__proto__\"&&kind===\"init\"){if(propHash.proto){if(refDestructuringErrors){if(refDestructuringErrors.doubleProto<0){refDestructuringErrors.doubleProto=key.start;}}else{this.raiseRecoverable(key.start,\"Redefinition of __proto__ property\");}}propHash.proto=true;}return;}name=\"$\"+name;var other=propHash[name];if(other){var redefinition;if(kind===\"init\"){redefinition=this.strict&&other.init||other.get||other.set;}else{redefinition=other.init||other[kind];}if(redefinition){this.raiseRecoverable(key.start,\"Redefinition of property\");}}else{other=propHash[name]={init:false,get:false,set:false};}other[kind]=true;};// ### Expression parsing\n// These nest, from the most general expression type at the top to\n// 'atomic', nondivisible expression types at the bottom. Most of\n// the functions will simply let the function(s) below them parse,\n// and, *if* the syntactic construct they handle is present, wrap\n// the AST node that the inner parser gave them in another node.\n// Parse a full expression. The optional arguments are used to\n// forbid the `in` operator (in for loops initalization expressions)\n// and provide reference for storing '=' operator inside shorthand\n// property assignment in contexts where both object expression\n// and object pattern might appear (so it's possible to raise\n// delayed syntax error at correct position).\npp$5.parseExpression=function(forInit,refDestructuringErrors){var startPos=this.start,startLoc=this.startLoc;var expr=this.parseMaybeAssign(forInit,refDestructuringErrors);if(this.type===types$1.comma){var node=this.startNodeAt(startPos,startLoc);node.expressions=[expr];while(this.eat(types$1.comma)){node.expressions.push(this.parseMaybeAssign(forInit,refDestructuringErrors));}return this.finishNode(node,\"SequenceExpression\");}return expr;};// Parse an assignment expression. This includes applications of\n// operators like `+=`.\npp$5.parseMaybeAssign=function(forInit,refDestructuringErrors,afterLeftParse){if(this.isContextual(\"yield\")){if(this.inGenerator){return this.parseYield(forInit);}// The tokenizer will assume an expression is allowed after\n// `yield`, but this isn't that kind of yield\nelse{this.exprAllowed=false;}}var ownDestructuringErrors=false,oldParenAssign=-1,oldTrailingComma=-1,oldDoubleProto=-1;if(refDestructuringErrors){oldParenAssign=refDestructuringErrors.parenthesizedAssign;oldTrailingComma=refDestructuringErrors.trailingComma;oldDoubleProto=refDestructuringErrors.doubleProto;refDestructuringErrors.parenthesizedAssign=refDestructuringErrors.trailingComma=-1;}else{refDestructuringErrors=new DestructuringErrors();ownDestructuringErrors=true;}var startPos=this.start,startLoc=this.startLoc;if(this.type===types$1.parenL||this.type===types$1.name){this.potentialArrowAt=this.start;this.potentialArrowInForAwait=forInit===\"await\";}var left=this.parseMaybeConditional(forInit,refDestructuringErrors);if(afterLeftParse){left=afterLeftParse.call(this,left,startPos,startLoc);}if(this.type.isAssign){var node=this.startNodeAt(startPos,startLoc);node.operator=this.value;if(this.type===types$1.eq){left=this.toAssignable(left,false,refDestructuringErrors);}if(!ownDestructuringErrors){refDestructuringErrors.parenthesizedAssign=refDestructuringErrors.trailingComma=refDestructuringErrors.doubleProto=-1;}if(refDestructuringErrors.shorthandAssign>=left.start){refDestructuringErrors.shorthandAssign=-1;}// reset because shorthand default was used correctly\nif(this.type===types$1.eq){this.checkLValPattern(left);}else{this.checkLValSimple(left);}node.left=left;this.next();node.right=this.parseMaybeAssign(forInit);if(oldDoubleProto>-1){refDestructuringErrors.doubleProto=oldDoubleProto;}return this.finishNode(node,\"AssignmentExpression\");}else{if(ownDestructuringErrors){this.checkExpressionErrors(refDestructuringErrors,true);}}if(oldParenAssign>-1){refDestructuringErrors.parenthesizedAssign=oldParenAssign;}if(oldTrailingComma>-1){refDestructuringErrors.trailingComma=oldTrailingComma;}return left;};// Parse a ternary conditional (`?:`) operator.\npp$5.parseMaybeConditional=function(forInit,refDestructuringErrors){var startPos=this.start,startLoc=this.startLoc;var expr=this.parseExprOps(forInit,refDestructuringErrors);if(this.checkExpressionErrors(refDestructuringErrors)){return expr;}if(this.eat(types$1.question)){var node=this.startNodeAt(startPos,startLoc);node.test=expr;node.consequent=this.parseMaybeAssign();this.expect(types$1.colon);node.alternate=this.parseMaybeAssign(forInit);return this.finishNode(node,\"ConditionalExpression\");}return expr;};// Start the precedence parser.\npp$5.parseExprOps=function(forInit,refDestructuringErrors){var startPos=this.start,startLoc=this.startLoc;var expr=this.parseMaybeUnary(refDestructuringErrors,false,false,forInit);if(this.checkExpressionErrors(refDestructuringErrors)){return expr;}return expr.start===startPos&&expr.type===\"ArrowFunctionExpression\"?expr:this.parseExprOp(expr,startPos,startLoc,-1,forInit);};// Parse binary operators with the operator precedence parsing\n// algorithm. `left` is the left-hand side of the operator.\n// `minPrec` provides context that allows the function to stop and\n// defer further parser to one of its callers when it encounters an\n// operator that has a lower precedence than the set it is parsing.\npp$5.parseExprOp=function(left,leftStartPos,leftStartLoc,minPrec,forInit){var prec=this.type.binop;if(prec!=null&&(!forInit||this.type!==types$1._in)){if(prec>minPrec){var logical=this.type===types$1.logicalOR||this.type===types$1.logicalAND;var coalesce=this.type===types$1.coalesce;if(coalesce){// Handle the precedence of `tt.coalesce` as equal to the range of logical expressions.\n// In other words, `node.right` shouldn't contain logical expressions in order to check the mixed error.\nprec=types$1.logicalAND.binop;}var op=this.value;this.next();var startPos=this.start,startLoc=this.startLoc;var right=this.parseExprOp(this.parseMaybeUnary(null,false,false,forInit),startPos,startLoc,prec,forInit);var node=this.buildBinary(leftStartPos,leftStartLoc,left,right,op,logical||coalesce);if(logical&&this.type===types$1.coalesce||coalesce&&(this.type===types$1.logicalOR||this.type===types$1.logicalAND)){this.raiseRecoverable(this.start,\"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses\");}return this.parseExprOp(node,leftStartPos,leftStartLoc,minPrec,forInit);}}return left;};pp$5.buildBinary=function(startPos,startLoc,left,right,op,logical){if(right.type===\"PrivateIdentifier\"){this.raise(right.start,\"Private identifier can only be left side of binary expression\");}var node=this.startNodeAt(startPos,startLoc);node.left=left;node.operator=op;node.right=right;return this.finishNode(node,logical?\"LogicalExpression\":\"BinaryExpression\");};// Parse unary operators, both prefix and postfix.\npp$5.parseMaybeUnary=function(refDestructuringErrors,sawUnary,incDec,forInit){var startPos=this.start,startLoc=this.startLoc,expr;if(this.isContextual(\"await\")&&this.canAwait){expr=this.parseAwait(forInit);sawUnary=true;}else if(this.type.prefix){var node=this.startNode(),update=this.type===types$1.incDec;node.operator=this.value;node.prefix=true;this.next();node.argument=this.parseMaybeUnary(null,true,update,forInit);this.checkExpressionErrors(refDestructuringErrors,true);if(update){this.checkLValSimple(node.argument);}else if(this.strict&&node.operator===\"delete\"&&node.argument.type===\"Identifier\"){this.raiseRecoverable(node.start,\"Deleting local variable in strict mode\");}else if(node.operator===\"delete\"&&isPrivateFieldAccess(node.argument)){this.raiseRecoverable(node.start,\"Private fields can not be deleted\");}else{sawUnary=true;}expr=this.finishNode(node,update?\"UpdateExpression\":\"UnaryExpression\");}else if(!sawUnary&&this.type===types$1.privateId){if(forInit||this.privateNameStack.length===0){this.unexpected();}expr=this.parsePrivateIdent();// only could be private fields in 'in', such as #x in obj\nif(this.type!==types$1._in){this.unexpected();}}else{expr=this.parseExprSubscripts(refDestructuringErrors,forInit);if(this.checkExpressionErrors(refDestructuringErrors)){return expr;}while(this.type.postfix&&!this.canInsertSemicolon()){var node$1=this.startNodeAt(startPos,startLoc);node$1.operator=this.value;node$1.prefix=false;node$1.argument=expr;this.checkLValSimple(expr);this.next();expr=this.finishNode(node$1,\"UpdateExpression\");}}if(!incDec&&this.eat(types$1.starstar)){if(sawUnary){this.unexpected(this.lastTokStart);}else{return this.buildBinary(startPos,startLoc,expr,this.parseMaybeUnary(null,false,false,forInit),\"**\",false);}}else{return expr;}};function isPrivateFieldAccess(node){return node.type===\"MemberExpression\"&&node.property.type===\"PrivateIdentifier\"||node.type===\"ChainExpression\"&&isPrivateFieldAccess(node.expression);}// Parse call, dot, and `[]`-subscript expressions.\npp$5.parseExprSubscripts=function(refDestructuringErrors,forInit){var startPos=this.start,startLoc=this.startLoc;var expr=this.parseExprAtom(refDestructuringErrors,forInit);if(expr.type===\"ArrowFunctionExpression\"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==\")\"){return expr;}var result=this.parseSubscripts(expr,startPos,startLoc,false,forInit);if(refDestructuringErrors&&result.type===\"MemberExpression\"){if(refDestructuringErrors.parenthesizedAssign>=result.start){refDestructuringErrors.parenthesizedAssign=-1;}if(refDestructuringErrors.parenthesizedBind>=result.start){refDestructuringErrors.parenthesizedBind=-1;}if(refDestructuringErrors.trailingComma>=result.start){refDestructuringErrors.trailingComma=-1;}}return result;};pp$5.parseSubscripts=function(base,startPos,startLoc,noCalls,forInit){var maybeAsyncArrow=this.options.ecmaVersion>=8&&base.type===\"Identifier\"&&base.name===\"async\"&&this.lastTokEnd===base.end&&!this.canInsertSemicolon()&&base.end-base.start===5&&this.potentialArrowAt===base.start;var optionalChained=false;while(true){var element=this.parseSubscript(base,startPos,startLoc,noCalls,maybeAsyncArrow,optionalChained,forInit);if(element.optional){optionalChained=true;}if(element===base||element.type===\"ArrowFunctionExpression\"){if(optionalChained){var chainNode=this.startNodeAt(startPos,startLoc);chainNode.expression=element;element=this.finishNode(chainNode,\"ChainExpression\");}return element;}base=element;}};pp$5.parseSubscript=function(base,startPos,startLoc,noCalls,maybeAsyncArrow,optionalChained,forInit){var optionalSupported=this.options.ecmaVersion>=11;var optional=optionalSupported&&this.eat(types$1.questionDot);if(noCalls&&optional){this.raise(this.lastTokStart,\"Optional chaining cannot appear in the callee of new expressions\");}var computed=this.eat(types$1.bracketL);if(computed||optional&&this.type!==types$1.parenL&&this.type!==types$1.backQuote||this.eat(types$1.dot)){var node=this.startNodeAt(startPos,startLoc);node.object=base;if(computed){node.property=this.parseExpression();this.expect(types$1.bracketR);}else if(this.type===types$1.privateId&&base.type!==\"Super\"){node.property=this.parsePrivateIdent();}else{node.property=this.parseIdent(this.options.allowReserved!==\"never\");}node.computed=!!computed;if(optionalSupported){node.optional=optional;}base=this.finishNode(node,\"MemberExpression\");}else if(!noCalls&&this.eat(types$1.parenL)){var refDestructuringErrors=new DestructuringErrors(),oldYieldPos=this.yieldPos,oldAwaitPos=this.awaitPos,oldAwaitIdentPos=this.awaitIdentPos;this.yieldPos=0;this.awaitPos=0;this.awaitIdentPos=0;var exprList=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,false,refDestructuringErrors);if(maybeAsyncArrow&&!optional&&!this.canInsertSemicolon()&&this.eat(types$1.arrow)){this.checkPatternErrors(refDestructuringErrors,false);this.checkYieldAwaitInDefaultParams();if(this.awaitIdentPos>0){this.raise(this.awaitIdentPos,\"Cannot use 'await' as identifier inside an async function\");}this.yieldPos=oldYieldPos;this.awaitPos=oldAwaitPos;this.awaitIdentPos=oldAwaitIdentPos;return this.parseArrowExpression(this.startNodeAt(startPos,startLoc),exprList,true,forInit);}this.checkExpressionErrors(refDestructuringErrors,true);this.yieldPos=oldYieldPos||this.yieldPos;this.awaitPos=oldAwaitPos||this.awaitPos;this.awaitIdentPos=oldAwaitIdentPos||this.awaitIdentPos;var node$1=this.startNodeAt(startPos,startLoc);node$1.callee=base;node$1.arguments=exprList;if(optionalSupported){node$1.optional=optional;}base=this.finishNode(node$1,\"CallExpression\");}else if(this.type===types$1.backQuote){if(optional||optionalChained){this.raise(this.start,\"Optional chaining cannot appear in the tag of tagged template expressions\");}var node$2=this.startNodeAt(startPos,startLoc);node$2.tag=base;node$2.quasi=this.parseTemplate({isTagged:true});base=this.finishNode(node$2,\"TaggedTemplateExpression\");}return base;};// Parse an atomic expression — either a single token that is an\n// expression, an expression started by a keyword like `function` or\n// `new`, or an expression wrapped in punctuation like `()`, `[]`,\n// or `{}`.\npp$5.parseExprAtom=function(refDestructuringErrors,forInit){// If a division operator appears in an expression position, the\n// tokenizer got confused, and we force it to read a regexp instead.\nif(this.type===types$1.slash){this.readRegexp();}var node,canBeArrow=this.potentialArrowAt===this.start;switch(this.type){case types$1._super:if(!this.allowSuper){this.raise(this.start,\"'super' keyword outside a method\");}node=this.startNode();this.next();if(this.type===types$1.parenL&&!this.allowDirectSuper){this.raise(node.start,\"super() call outside constructor of a subclass\");}// The `super` keyword can appear at below:\n// SuperProperty:\n//     super [ Expression ]\n//     super . IdentifierName\n// SuperCall:\n//     super ( Arguments )\nif(this.type!==types$1.dot&&this.type!==types$1.bracketL&&this.type!==types$1.parenL){this.unexpected();}return this.finishNode(node,\"Super\");case types$1._this:node=this.startNode();this.next();return this.finishNode(node,\"ThisExpression\");case types$1.name:var startPos=this.start,startLoc=this.startLoc,containsEsc=this.containsEsc;var id=this.parseIdent(false);if(this.options.ecmaVersion>=8&&!containsEsc&&id.name===\"async\"&&!this.canInsertSemicolon()&&this.eat(types$1._function)){this.overrideContext(types.f_expr);return this.parseFunction(this.startNodeAt(startPos,startLoc),0,false,true,forInit);}if(canBeArrow&&!this.canInsertSemicolon()){if(this.eat(types$1.arrow)){return this.parseArrowExpression(this.startNodeAt(startPos,startLoc),[id],false,forInit);}if(this.options.ecmaVersion>=8&&id.name===\"async\"&&this.type===types$1.name&&!containsEsc&&(!this.potentialArrowInForAwait||this.value!==\"of\"||this.containsEsc)){id=this.parseIdent(false);if(this.canInsertSemicolon()||!this.eat(types$1.arrow)){this.unexpected();}return this.parseArrowExpression(this.startNodeAt(startPos,startLoc),[id],true,forInit);}}return id;case types$1.regexp:var value=this.value;node=this.parseLiteral(value.value);node.regex={pattern:value.pattern,flags:value.flags};return node;case types$1.num:case types$1.string:return this.parseLiteral(this.value);case types$1._null:case types$1._true:case types$1._false:node=this.startNode();node.value=this.type===types$1._null?null:this.type===types$1._true;node.raw=this.type.keyword;this.next();return this.finishNode(node,\"Literal\");case types$1.parenL:var start=this.start,expr=this.parseParenAndDistinguishExpression(canBeArrow,forInit);if(refDestructuringErrors){if(refDestructuringErrors.parenthesizedAssign<0&&!this.isSimpleAssignTarget(expr)){refDestructuringErrors.parenthesizedAssign=start;}if(refDestructuringErrors.parenthesizedBind<0){refDestructuringErrors.parenthesizedBind=start;}}return expr;case types$1.bracketL:node=this.startNode();this.next();node.elements=this.parseExprList(types$1.bracketR,true,true,refDestructuringErrors);return this.finishNode(node,\"ArrayExpression\");case types$1.braceL:this.overrideContext(types.b_expr);return this.parseObj(false,refDestructuringErrors);case types$1._function:node=this.startNode();this.next();return this.parseFunction(node,0);case types$1._class:return this.parseClass(this.startNode(),false);case types$1._new:return this.parseNew();case types$1.backQuote:return this.parseTemplate();case types$1._import:if(this.options.ecmaVersion>=11){return this.parseExprImport();}else{return this.unexpected();}default:this.unexpected();}};pp$5.parseExprImport=function(){var node=this.startNode();// Consume `import` as an identifier for `import.meta`.\n// Because `this.parseIdent(true)` doesn't check escape sequences, it needs the check of `this.containsEsc`.\nif(this.containsEsc){this.raiseRecoverable(this.start,\"Escape sequence in keyword import\");}var meta=this.parseIdent(true);switch(this.type){case types$1.parenL:return this.parseDynamicImport(node);case types$1.dot:node.meta=meta;return this.parseImportMeta(node);default:this.unexpected();}};pp$5.parseDynamicImport=function(node){this.next();// skip `(`\n// Parse node.source.\nnode.source=this.parseMaybeAssign();// Verify ending.\nif(!this.eat(types$1.parenR)){var errorPos=this.start;if(this.eat(types$1.comma)&&this.eat(types$1.parenR)){this.raiseRecoverable(errorPos,\"Trailing comma is not allowed in import()\");}else{this.unexpected(errorPos);}}return this.finishNode(node,\"ImportExpression\");};pp$5.parseImportMeta=function(node){this.next();// skip `.`\nvar containsEsc=this.containsEsc;node.property=this.parseIdent(true);if(node.property.name!==\"meta\"){this.raiseRecoverable(node.property.start,\"The only valid meta property for import is 'import.meta'\");}if(containsEsc){this.raiseRecoverable(node.start,\"'import.meta' must not contain escaped characters\");}if(this.options.sourceType!==\"module\"&&!this.options.allowImportExportEverywhere){this.raiseRecoverable(node.start,\"Cannot use 'import.meta' outside a module\");}return this.finishNode(node,\"MetaProperty\");};pp$5.parseLiteral=function(value){var node=this.startNode();node.value=value;node.raw=this.input.slice(this.start,this.end);if(node.raw.charCodeAt(node.raw.length-1)===110){node.bigint=node.raw.slice(0,-1).replace(/_/g,\"\");}this.next();return this.finishNode(node,\"Literal\");};pp$5.parseParenExpression=function(){this.expect(types$1.parenL);var val=this.parseExpression();this.expect(types$1.parenR);return val;};pp$5.parseParenAndDistinguishExpression=function(canBeArrow,forInit){var startPos=this.start,startLoc=this.startLoc,val,allowTrailingComma=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var innerStartPos=this.start,innerStartLoc=this.startLoc;var exprList=[],first=true,lastIsComma=false;var refDestructuringErrors=new DestructuringErrors(),oldYieldPos=this.yieldPos,oldAwaitPos=this.awaitPos,spreadStart;this.yieldPos=0;this.awaitPos=0;// Do not save awaitIdentPos to allow checking awaits nested in parameters\nwhile(this.type!==types$1.parenR){first?first=false:this.expect(types$1.comma);if(allowTrailingComma&&this.afterTrailingComma(types$1.parenR,true)){lastIsComma=true;break;}else if(this.type===types$1.ellipsis){spreadStart=this.start;exprList.push(this.parseParenItem(this.parseRestBinding()));if(this.type===types$1.comma){this.raise(this.start,\"Comma is not permitted after the rest element\");}break;}else{exprList.push(this.parseMaybeAssign(false,refDestructuringErrors,this.parseParenItem));}}var innerEndPos=this.lastTokEnd,innerEndLoc=this.lastTokEndLoc;this.expect(types$1.parenR);if(canBeArrow&&!this.canInsertSemicolon()&&this.eat(types$1.arrow)){this.checkPatternErrors(refDestructuringErrors,false);this.checkYieldAwaitInDefaultParams();this.yieldPos=oldYieldPos;this.awaitPos=oldAwaitPos;return this.parseParenArrowList(startPos,startLoc,exprList,forInit);}if(!exprList.length||lastIsComma){this.unexpected(this.lastTokStart);}if(spreadStart){this.unexpected(spreadStart);}this.checkExpressionErrors(refDestructuringErrors,true);this.yieldPos=oldYieldPos||this.yieldPos;this.awaitPos=oldAwaitPos||this.awaitPos;if(exprList.length>1){val=this.startNodeAt(innerStartPos,innerStartLoc);val.expressions=exprList;this.finishNodeAt(val,\"SequenceExpression\",innerEndPos,innerEndLoc);}else{val=exprList[0];}}else{val=this.parseParenExpression();}if(this.options.preserveParens){var par=this.startNodeAt(startPos,startLoc);par.expression=val;return this.finishNode(par,\"ParenthesizedExpression\");}else{return val;}};pp$5.parseParenItem=function(item){return item;};pp$5.parseParenArrowList=function(startPos,startLoc,exprList,forInit){return this.parseArrowExpression(this.startNodeAt(startPos,startLoc),exprList,false,forInit);};// New's precedence is slightly tricky. It must allow its argument to\n// be a `[]` or dot subscript expression, but not a call — at least,\n// not without wrapping it in parentheses. Thus, it uses the noCalls\n// argument to parseSubscripts to prevent it from consuming the\n// argument list.\nvar empty=[];pp$5.parseNew=function(){if(this.containsEsc){this.raiseRecoverable(this.start,\"Escape sequence in keyword new\");}var node=this.startNode();var meta=this.parseIdent(true);if(this.options.ecmaVersion>=6&&this.eat(types$1.dot)){node.meta=meta;var containsEsc=this.containsEsc;node.property=this.parseIdent(true);if(node.property.name!==\"target\"){this.raiseRecoverable(node.property.start,\"The only valid meta property for new is 'new.target'\");}if(containsEsc){this.raiseRecoverable(node.start,\"'new.target' must not contain escaped characters\");}if(!this.allowNewDotTarget){this.raiseRecoverable(node.start,\"'new.target' can only be used in functions and class static block\");}return this.finishNode(node,\"MetaProperty\");}var startPos=this.start,startLoc=this.startLoc,isImport=this.type===types$1._import;node.callee=this.parseSubscripts(this.parseExprAtom(),startPos,startLoc,true,false);if(isImport&&node.callee.type===\"ImportExpression\"){this.raise(startPos,\"Cannot use new with import()\");}if(this.eat(types$1.parenL)){node.arguments=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,false);}else{node.arguments=empty;}return this.finishNode(node,\"NewExpression\");};// Parse template expression.\npp$5.parseTemplateElement=function(ref){var isTagged=ref.isTagged;var elem=this.startNode();if(this.type===types$1.invalidTemplate){if(!isTagged){this.raiseRecoverable(this.start,\"Bad escape sequence in untagged template literal\");}elem.value={raw:this.value,cooked:null};}else{elem.value={raw:this.input.slice(this.start,this.end).replace(/\\r\\n?/g,\"\\n\"),cooked:this.value};}this.next();elem.tail=this.type===types$1.backQuote;return this.finishNode(elem,\"TemplateElement\");};pp$5.parseTemplate=function(ref){if(ref===void 0)ref={};var isTagged=ref.isTagged;if(isTagged===void 0)isTagged=false;var node=this.startNode();this.next();node.expressions=[];var curElt=this.parseTemplateElement({isTagged:isTagged});node.quasis=[curElt];while(!curElt.tail){if(this.type===types$1.eof){this.raise(this.pos,\"Unterminated template literal\");}this.expect(types$1.dollarBraceL);node.expressions.push(this.parseExpression());this.expect(types$1.braceR);node.quasis.push(curElt=this.parseTemplateElement({isTagged:isTagged}));}this.next();return this.finishNode(node,\"TemplateLiteral\");};pp$5.isAsyncProp=function(prop){return!prop.computed&&prop.key.type===\"Identifier\"&&prop.key.name===\"async\"&&(this.type===types$1.name||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===types$1.star)&&!lineBreak.test(this.input.slice(this.lastTokEnd,this.start));};// Parse an object literal or binding pattern.\npp$5.parseObj=function(isPattern,refDestructuringErrors){var node=this.startNode(),first=true,propHash={};node.properties=[];this.next();while(!this.eat(types$1.braceR)){if(!first){this.expect(types$1.comma);if(this.options.ecmaVersion>=5&&this.afterTrailingComma(types$1.braceR)){break;}}else{first=false;}var prop=this.parseProperty(isPattern,refDestructuringErrors);if(!isPattern){this.checkPropClash(prop,propHash,refDestructuringErrors);}node.properties.push(prop);}return this.finishNode(node,isPattern?\"ObjectPattern\":\"ObjectExpression\");};pp$5.parseProperty=function(isPattern,refDestructuringErrors){var prop=this.startNode(),isGenerator,isAsync,startPos,startLoc;if(this.options.ecmaVersion>=9&&this.eat(types$1.ellipsis)){if(isPattern){prop.argument=this.parseIdent(false);if(this.type===types$1.comma){this.raise(this.start,\"Comma is not permitted after the rest element\");}return this.finishNode(prop,\"RestElement\");}// To disallow parenthesized identifier via `this.toAssignable()`.\nif(this.type===types$1.parenL&&refDestructuringErrors){if(refDestructuringErrors.parenthesizedAssign<0){refDestructuringErrors.parenthesizedAssign=this.start;}if(refDestructuringErrors.parenthesizedBind<0){refDestructuringErrors.parenthesizedBind=this.start;}}// Parse argument.\nprop.argument=this.parseMaybeAssign(false,refDestructuringErrors);// To disallow trailing comma via `this.toAssignable()`.\nif(this.type===types$1.comma&&refDestructuringErrors&&refDestructuringErrors.trailingComma<0){refDestructuringErrors.trailingComma=this.start;}// Finish\nreturn this.finishNode(prop,\"SpreadElement\");}if(this.options.ecmaVersion>=6){prop.method=false;prop.shorthand=false;if(isPattern||refDestructuringErrors){startPos=this.start;startLoc=this.startLoc;}if(!isPattern){isGenerator=this.eat(types$1.star);}}var containsEsc=this.containsEsc;this.parsePropertyName(prop);if(!isPattern&&!containsEsc&&this.options.ecmaVersion>=8&&!isGenerator&&this.isAsyncProp(prop)){isAsync=true;isGenerator=this.options.ecmaVersion>=9&&this.eat(types$1.star);this.parsePropertyName(prop,refDestructuringErrors);}else{isAsync=false;}this.parsePropertyValue(prop,isPattern,isGenerator,isAsync,startPos,startLoc,refDestructuringErrors,containsEsc);return this.finishNode(prop,\"Property\");};pp$5.parsePropertyValue=function(prop,isPattern,isGenerator,isAsync,startPos,startLoc,refDestructuringErrors,containsEsc){if((isGenerator||isAsync)&&this.type===types$1.colon){this.unexpected();}if(this.eat(types$1.colon)){prop.value=isPattern?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(false,refDestructuringErrors);prop.kind=\"init\";}else if(this.options.ecmaVersion>=6&&this.type===types$1.parenL){if(isPattern){this.unexpected();}prop.kind=\"init\";prop.method=true;prop.value=this.parseMethod(isGenerator,isAsync);}else if(!isPattern&&!containsEsc&&this.options.ecmaVersion>=5&&!prop.computed&&prop.key.type===\"Identifier\"&&(prop.key.name===\"get\"||prop.key.name===\"set\")&&this.type!==types$1.comma&&this.type!==types$1.braceR&&this.type!==types$1.eq){if(isGenerator||isAsync){this.unexpected();}prop.kind=prop.key.name;this.parsePropertyName(prop);prop.value=this.parseMethod(false);var paramCount=prop.kind===\"get\"?0:1;if(prop.value.params.length!==paramCount){var start=prop.value.start;if(prop.kind===\"get\"){this.raiseRecoverable(start,\"getter should have no params\");}else{this.raiseRecoverable(start,\"setter should have exactly one param\");}}else{if(prop.kind===\"set\"&&prop.value.params[0].type===\"RestElement\"){this.raiseRecoverable(prop.value.params[0].start,\"Setter cannot use rest params\");}}}else if(this.options.ecmaVersion>=6&&!prop.computed&&prop.key.type===\"Identifier\"){if(isGenerator||isAsync){this.unexpected();}this.checkUnreserved(prop.key);if(prop.key.name===\"await\"&&!this.awaitIdentPos){this.awaitIdentPos=startPos;}prop.kind=\"init\";if(isPattern){prop.value=this.parseMaybeDefault(startPos,startLoc,this.copyNode(prop.key));}else if(this.type===types$1.eq&&refDestructuringErrors){if(refDestructuringErrors.shorthandAssign<0){refDestructuringErrors.shorthandAssign=this.start;}prop.value=this.parseMaybeDefault(startPos,startLoc,this.copyNode(prop.key));}else{prop.value=this.copyNode(prop.key);}prop.shorthand=true;}else{this.unexpected();}};pp$5.parsePropertyName=function(prop){if(this.options.ecmaVersion>=6){if(this.eat(types$1.bracketL)){prop.computed=true;prop.key=this.parseMaybeAssign();this.expect(types$1.bracketR);return prop.key;}else{prop.computed=false;}}return prop.key=this.type===types$1.num||this.type===types$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!==\"never\");};// Initialize empty function node.\npp$5.initFunction=function(node){node.id=null;if(this.options.ecmaVersion>=6){node.generator=node.expression=false;}if(this.options.ecmaVersion>=8){node.async=false;}};// Parse object or class method.\npp$5.parseMethod=function(isGenerator,isAsync,allowDirectSuper){var node=this.startNode(),oldYieldPos=this.yieldPos,oldAwaitPos=this.awaitPos,oldAwaitIdentPos=this.awaitIdentPos;this.initFunction(node);if(this.options.ecmaVersion>=6){node.generator=isGenerator;}if(this.options.ecmaVersion>=8){node.async=!!isAsync;}this.yieldPos=0;this.awaitPos=0;this.awaitIdentPos=0;this.enterScope(functionFlags(isAsync,node.generator)|SCOPE_SUPER|(allowDirectSuper?SCOPE_DIRECT_SUPER:0));this.expect(types$1.parenL);node.params=this.parseBindingList(types$1.parenR,false,this.options.ecmaVersion>=8);this.checkYieldAwaitInDefaultParams();this.parseFunctionBody(node,false,true,false);this.yieldPos=oldYieldPos;this.awaitPos=oldAwaitPos;this.awaitIdentPos=oldAwaitIdentPos;return this.finishNode(node,\"FunctionExpression\");};// Parse arrow function expression with given parameters.\npp$5.parseArrowExpression=function(node,params,isAsync,forInit){var oldYieldPos=this.yieldPos,oldAwaitPos=this.awaitPos,oldAwaitIdentPos=this.awaitIdentPos;this.enterScope(functionFlags(isAsync,false)|SCOPE_ARROW);this.initFunction(node);if(this.options.ecmaVersion>=8){node.async=!!isAsync;}this.yieldPos=0;this.awaitPos=0;this.awaitIdentPos=0;node.params=this.toAssignableList(params,true);this.parseFunctionBody(node,true,false,forInit);this.yieldPos=oldYieldPos;this.awaitPos=oldAwaitPos;this.awaitIdentPos=oldAwaitIdentPos;return this.finishNode(node,\"ArrowFunctionExpression\");};// Parse function body and check parameters.\npp$5.parseFunctionBody=function(node,isArrowFunction,isMethod,forInit){var isExpression=isArrowFunction&&this.type!==types$1.braceL;var oldStrict=this.strict,useStrict=false;if(isExpression){node.body=this.parseMaybeAssign(forInit);node.expression=true;this.checkParams(node,false);}else{var nonSimple=this.options.ecmaVersion>=7&&!this.isSimpleParamList(node.params);if(!oldStrict||nonSimple){useStrict=this.strictDirective(this.end);// If this is a strict mode function, verify that argument names\n// are not repeated, and it does not try to bind the words `eval`\n// or `arguments`.\nif(useStrict&&nonSimple){this.raiseRecoverable(node.start,\"Illegal 'use strict' directive in function with non-simple parameter list\");}}// Start a new scope with regard to labels and the `inFunction`\n// flag (restore them to their old value afterwards).\nvar oldLabels=this.labels;this.labels=[];if(useStrict){this.strict=true;}// Add the params to varDeclaredNames to ensure that an error is thrown\n// if a let/const declaration in the function clashes with one of the params.\nthis.checkParams(node,!oldStrict&&!useStrict&&!isArrowFunction&&!isMethod&&this.isSimpleParamList(node.params));// Ensure the function name isn't a forbidden identifier in strict mode, e.g. 'eval'\nif(this.strict&&node.id){this.checkLValSimple(node.id,BIND_OUTSIDE);}node.body=this.parseBlock(false,undefined,useStrict&&!oldStrict);node.expression=false;this.adaptDirectivePrologue(node.body.body);this.labels=oldLabels;}this.exitScope();};pp$5.isSimpleParamList=function(params){for(var i=0,list=params;i<list.length;i+=1){var param=list[i];if(param.type!==\"Identifier\"){return false;}}return true;};// Checks function params for various disallowed patterns such as using \"eval\"\n// or \"arguments\" and duplicate parameters.\npp$5.checkParams=function(node,allowDuplicates){var nameHash=Object.create(null);for(var i=0,list=node.params;i<list.length;i+=1){var param=list[i];this.checkLValInnerPattern(param,BIND_VAR,allowDuplicates?null:nameHash);}};// Parses a comma-separated list of expressions, and returns them as\n// an array. `close` is the token type that ends the list, and\n// `allowEmpty` can be turned on to allow subsequent commas with\n// nothing in between them to be parsed as `null` (which is needed\n// for array literals).\npp$5.parseExprList=function(close,allowTrailingComma,allowEmpty,refDestructuringErrors){var elts=[],first=true;while(!this.eat(close)){if(!first){this.expect(types$1.comma);if(allowTrailingComma&&this.afterTrailingComma(close)){break;}}else{first=false;}var elt=void 0;if(allowEmpty&&this.type===types$1.comma){elt=null;}else if(this.type===types$1.ellipsis){elt=this.parseSpread(refDestructuringErrors);if(refDestructuringErrors&&this.type===types$1.comma&&refDestructuringErrors.trailingComma<0){refDestructuringErrors.trailingComma=this.start;}}else{elt=this.parseMaybeAssign(false,refDestructuringErrors);}elts.push(elt);}return elts;};pp$5.checkUnreserved=function(ref){var start=ref.start;var end=ref.end;var name=ref.name;if(this.inGenerator&&name===\"yield\"){this.raiseRecoverable(start,\"Cannot use 'yield' as identifier inside a generator\");}if(this.inAsync&&name===\"await\"){this.raiseRecoverable(start,\"Cannot use 'await' as identifier inside an async function\");}if(this.currentThisScope().inClassFieldInit&&name===\"arguments\"){this.raiseRecoverable(start,\"Cannot use 'arguments' in class field initializer\");}if(this.inClassStaticBlock&&(name===\"arguments\"||name===\"await\")){this.raise(start,\"Cannot use \"+name+\" in class static initialization block\");}if(this.keywords.test(name)){this.raise(start,\"Unexpected keyword '\"+name+\"'\");}if(this.options.ecmaVersion<6&&this.input.slice(start,end).indexOf(\"\\\\\")!==-1){return;}var re=this.strict?this.reservedWordsStrict:this.reservedWords;if(re.test(name)){if(!this.inAsync&&name===\"await\"){this.raiseRecoverable(start,\"Cannot use keyword 'await' outside an async function\");}this.raiseRecoverable(start,\"The keyword '\"+name+\"' is reserved\");}};// Parse the next token as an identifier. If `liberal` is true (used\n// when parsing properties), it will also convert keywords into\n// identifiers.\npp$5.parseIdent=function(liberal,isBinding){var node=this.startNode();if(this.type===types$1.name){node.name=this.value;}else if(this.type.keyword){node.name=this.type.keyword;// To fix https://github.com/acornjs/acorn/issues/575\n// `class` and `function` keywords push new context into this.context.\n// But there is no chance to pop the context if the keyword is consumed as an identifier such as a property name.\n// If the previous token is a dot, this does not apply because the context-managing code already ignored the keyword\nif((node.name===\"class\"||node.name===\"function\")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)){this.context.pop();}}else{this.unexpected();}this.next(!!liberal);this.finishNode(node,\"Identifier\");if(!liberal){this.checkUnreserved(node);if(node.name===\"await\"&&!this.awaitIdentPos){this.awaitIdentPos=node.start;}}return node;};pp$5.parsePrivateIdent=function(){var node=this.startNode();if(this.type===types$1.privateId){node.name=this.value;}else{this.unexpected();}this.next();this.finishNode(node,\"PrivateIdentifier\");// For validating existence\nif(this.privateNameStack.length===0){this.raise(node.start,\"Private field '#\"+node.name+\"' must be declared in an enclosing class\");}else{this.privateNameStack[this.privateNameStack.length-1].used.push(node);}return node;};// Parses yield expression inside generator.\npp$5.parseYield=function(forInit){if(!this.yieldPos){this.yieldPos=this.start;}var node=this.startNode();this.next();if(this.type===types$1.semi||this.canInsertSemicolon()||this.type!==types$1.star&&!this.type.startsExpr){node.delegate=false;node.argument=null;}else{node.delegate=this.eat(types$1.star);node.argument=this.parseMaybeAssign(forInit);}return this.finishNode(node,\"YieldExpression\");};pp$5.parseAwait=function(forInit){if(!this.awaitPos){this.awaitPos=this.start;}var node=this.startNode();this.next();node.argument=this.parseMaybeUnary(null,true,false,forInit);return this.finishNode(node,\"AwaitExpression\");};var pp$4=Parser.prototype;// This function is used to raise exceptions on parse errors. It\n// takes an offset integer (into the current `input`) to indicate\n// the location of the error, attaches the position to the end\n// of the error message, and then raises a `SyntaxError` with that\n// message.\npp$4.raise=function(pos,message){var loc=getLineInfo(this.input,pos);message+=\" (\"+loc.line+\":\"+loc.column+\")\";var err=new SyntaxError(message);err.pos=pos;err.loc=loc;err.raisedAt=this.pos;throw err;};pp$4.raiseRecoverable=pp$4.raise;pp$4.curPosition=function(){if(this.options.locations){return new Position(this.curLine,this.pos-this.lineStart);}};var pp$3=Parser.prototype;var Scope=function Scope(flags){this.flags=flags;// A list of var-declared names in the current lexical scope\nthis.var=[];// A list of lexically-declared names in the current lexical scope\nthis.lexical=[];// A list of lexically-declared FunctionDeclaration names in the current lexical scope\nthis.functions=[];// A switch to disallow the identifier reference 'arguments'\nthis.inClassFieldInit=false;};// The functions in this module keep track of declared variables in the current scope in order to detect duplicate variable names.\npp$3.enterScope=function(flags){this.scopeStack.push(new Scope(flags));};pp$3.exitScope=function(){this.scopeStack.pop();};// The spec says:\n// > At the top level of a function, or script, function declarations are\n// > treated like var declarations rather than like lexical declarations.\npp$3.treatFunctionsAsVarInScope=function(scope){return scope.flags&SCOPE_FUNCTION||!this.inModule&&scope.flags&SCOPE_TOP;};pp$3.declareName=function(name,bindingType,pos){var redeclared=false;if(bindingType===BIND_LEXICAL){var scope=this.currentScope();redeclared=scope.lexical.indexOf(name)>-1||scope.functions.indexOf(name)>-1||scope.var.indexOf(name)>-1;scope.lexical.push(name);if(this.inModule&&scope.flags&SCOPE_TOP){delete this.undefinedExports[name];}}else if(bindingType===BIND_SIMPLE_CATCH){var scope$1=this.currentScope();scope$1.lexical.push(name);}else if(bindingType===BIND_FUNCTION){var scope$2=this.currentScope();if(this.treatFunctionsAsVar){redeclared=scope$2.lexical.indexOf(name)>-1;}else{redeclared=scope$2.lexical.indexOf(name)>-1||scope$2.var.indexOf(name)>-1;}scope$2.functions.push(name);}else{for(var i=this.scopeStack.length-1;i>=0;--i){var scope$3=this.scopeStack[i];if(scope$3.lexical.indexOf(name)>-1&&!(scope$3.flags&SCOPE_SIMPLE_CATCH&&scope$3.lexical[0]===name)||!this.treatFunctionsAsVarInScope(scope$3)&&scope$3.functions.indexOf(name)>-1){redeclared=true;break;}scope$3.var.push(name);if(this.inModule&&scope$3.flags&SCOPE_TOP){delete this.undefinedExports[name];}if(scope$3.flags&SCOPE_VAR){break;}}}if(redeclared){this.raiseRecoverable(pos,\"Identifier '\"+name+\"' has already been declared\");}};pp$3.checkLocalExport=function(id){// scope.functions must be empty as Module code is always strict.\nif(this.scopeStack[0].lexical.indexOf(id.name)===-1&&this.scopeStack[0].var.indexOf(id.name)===-1){this.undefinedExports[id.name]=id;}};pp$3.currentScope=function(){return this.scopeStack[this.scopeStack.length-1];};pp$3.currentVarScope=function(){for(var i=this.scopeStack.length-1;;i--){var scope=this.scopeStack[i];if(scope.flags&SCOPE_VAR){return scope;}}};// Could be useful for `this`, `new.target`, `super()`, `super.property`, and `super[property]`.\npp$3.currentThisScope=function(){for(var i=this.scopeStack.length-1;;i--){var scope=this.scopeStack[i];if(scope.flags&SCOPE_VAR&&!(scope.flags&SCOPE_ARROW)){return scope;}}};var Node=function Node(parser,pos,loc){this.type=\"\";this.start=pos;this.end=0;if(parser.options.locations){this.loc=new SourceLocation(parser,loc);}if(parser.options.directSourceFile){this.sourceFile=parser.options.directSourceFile;}if(parser.options.ranges){this.range=[pos,0];}};// Start an AST node, attaching a start offset.\nvar pp$2=Parser.prototype;pp$2.startNode=function(){return new Node(this,this.start,this.startLoc);};pp$2.startNodeAt=function(pos,loc){return new Node(this,pos,loc);};// Finish an AST node, adding `type` and `end` properties.\nfunction finishNodeAt(node,type,pos,loc){node.type=type;node.end=pos;if(this.options.locations){node.loc.end=loc;}if(this.options.ranges){node.range[1]=pos;}return node;}pp$2.finishNode=function(node,type){return finishNodeAt.call(this,node,type,this.lastTokEnd,this.lastTokEndLoc);};// Finish node at given position\npp$2.finishNodeAt=function(node,type,pos,loc){return finishNodeAt.call(this,node,type,pos,loc);};pp$2.copyNode=function(node){var newNode=new Node(this,node.start,this.startLoc);for(var prop in node){newNode[prop]=node[prop];}return newNode;};// This file contains Unicode properties extracted from the ECMAScript\n// specification. The lists are extracted like so:\n// $$('#table-binary-unicode-properties > figure > table > tbody > tr > td:nth-child(1) code').map(el => el.innerText)\n// #table-binary-unicode-properties\nvar ecma9BinaryProperties=\"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS\";var ecma10BinaryProperties=ecma9BinaryProperties+\" Extended_Pictographic\";var ecma11BinaryProperties=ecma10BinaryProperties;var ecma12BinaryProperties=ecma11BinaryProperties+\" EBase EComp EMod EPres ExtPict\";var ecma13BinaryProperties=ecma12BinaryProperties;var unicodeBinaryProperties={9:ecma9BinaryProperties,10:ecma10BinaryProperties,11:ecma11BinaryProperties,12:ecma12BinaryProperties,13:ecma13BinaryProperties};// #table-unicode-general-category-values\nvar unicodeGeneralCategoryValues=\"Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu\";// #table-unicode-script-values\nvar ecma9ScriptValues=\"Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb\";var ecma10ScriptValues=ecma9ScriptValues+\" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd\";var ecma11ScriptValues=ecma10ScriptValues+\" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho\";var ecma12ScriptValues=ecma11ScriptValues+\" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi\";var ecma13ScriptValues=ecma12ScriptValues+\" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith\";var unicodeScriptValues={9:ecma9ScriptValues,10:ecma10ScriptValues,11:ecma11ScriptValues,12:ecma12ScriptValues,13:ecma13ScriptValues};var data={};function buildUnicodeData(ecmaVersion){var d=data[ecmaVersion]={binary:wordsRegexp(unicodeBinaryProperties[ecmaVersion]+\" \"+unicodeGeneralCategoryValues),nonBinary:{General_Category:wordsRegexp(unicodeGeneralCategoryValues),Script:wordsRegexp(unicodeScriptValues[ecmaVersion])}};d.nonBinary.Script_Extensions=d.nonBinary.Script;d.nonBinary.gc=d.nonBinary.General_Category;d.nonBinary.sc=d.nonBinary.Script;d.nonBinary.scx=d.nonBinary.Script_Extensions;}for(var i=0,list=[9,10,11,12,13];i<list.length;i+=1){var ecmaVersion=list[i];buildUnicodeData(ecmaVersion);}var pp$1=Parser.prototype;var RegExpValidationState=function RegExpValidationState(parser){this.parser=parser;this.validFlags=\"gim\"+(parser.options.ecmaVersion>=6?\"uy\":\"\")+(parser.options.ecmaVersion>=9?\"s\":\"\")+(parser.options.ecmaVersion>=13?\"d\":\"\");this.unicodeProperties=data[parser.options.ecmaVersion>=13?13:parser.options.ecmaVersion];this.source=\"\";this.flags=\"\";this.start=0;this.switchU=false;this.switchN=false;this.pos=0;this.lastIntValue=0;this.lastStringValue=\"\";this.lastAssertionIsQuantifiable=false;this.numCapturingParens=0;this.maxBackReference=0;this.groupNames=[];this.backReferenceNames=[];};RegExpValidationState.prototype.reset=function reset(start,pattern,flags){var unicode=flags.indexOf(\"u\")!==-1;this.start=start|0;this.source=pattern+\"\";this.flags=flags;this.switchU=unicode&&this.parser.options.ecmaVersion>=6;this.switchN=unicode&&this.parser.options.ecmaVersion>=9;};RegExpValidationState.prototype.raise=function raise(message){this.parser.raiseRecoverable(this.start,\"Invalid regular expression: /\"+this.source+\"/: \"+message);};// If u flag is given, this returns the code point at the index (it combines a surrogate pair).\n// Otherwise, this returns the code unit of the index (can be a part of a surrogate pair).\nRegExpValidationState.prototype.at=function at(i,forceU){if(forceU===void 0)forceU=false;var s=this.source;var l=s.length;if(i>=l){return-1;}var c=s.charCodeAt(i);if(!(forceU||this.switchU)||c<=0xD7FF||c>=0xE000||i+1>=l){return c;}var next=s.charCodeAt(i+1);return next>=0xDC00&&next<=0xDFFF?(c<<10)+next-0x35FDC00:c;};RegExpValidationState.prototype.nextIndex=function nextIndex(i,forceU){if(forceU===void 0)forceU=false;var s=this.source;var l=s.length;if(i>=l){return l;}var c=s.charCodeAt(i),next;if(!(forceU||this.switchU)||c<=0xD7FF||c>=0xE000||i+1>=l||(next=s.charCodeAt(i+1))<0xDC00||next>0xDFFF){return i+1;}return i+2;};RegExpValidationState.prototype.current=function current(forceU){if(forceU===void 0)forceU=false;return this.at(this.pos,forceU);};RegExpValidationState.prototype.lookahead=function lookahead(forceU){if(forceU===void 0)forceU=false;return this.at(this.nextIndex(this.pos,forceU),forceU);};RegExpValidationState.prototype.advance=function advance(forceU){if(forceU===void 0)forceU=false;this.pos=this.nextIndex(this.pos,forceU);};RegExpValidationState.prototype.eat=function eat(ch,forceU){if(forceU===void 0)forceU=false;if(this.current(forceU)===ch){this.advance(forceU);return true;}return false;};/**\n * Validate the flags part of a given RegExpLiteral.\n *\n * @param {RegExpValidationState} state The state to validate RegExp.\n * @returns {void}\n */pp$1.validateRegExpFlags=function(state){var validFlags=state.validFlags;var flags=state.flags;for(var i=0;i<flags.length;i++){var flag=flags.charAt(i);if(validFlags.indexOf(flag)===-1){this.raise(state.start,\"Invalid regular expression flag\");}if(flags.indexOf(flag,i+1)>-1){this.raise(state.start,\"Duplicate regular expression flag\");}}};/**\n * Validate the pattern part of a given RegExpLiteral.\n *\n * @param {RegExpValidationState} state The state to validate RegExp.\n * @returns {void}\n */pp$1.validateRegExpPattern=function(state){this.regexp_pattern(state);// The goal symbol for the parse is |Pattern[~U, ~N]|. If the result of\n// parsing contains a |GroupName|, reparse with the goal symbol\n// |Pattern[~U, +N]| and use this result instead. Throw a *SyntaxError*\n// exception if _P_ did not conform to the grammar, if any elements of _P_\n// were not matched by the parse, or if any Early Error conditions exist.\nif(!state.switchN&&this.options.ecmaVersion>=9&&state.groupNames.length>0){state.switchN=true;this.regexp_pattern(state);}};// https://www.ecma-international.org/ecma-262/8.0/#prod-Pattern\npp$1.regexp_pattern=function(state){state.pos=0;state.lastIntValue=0;state.lastStringValue=\"\";state.lastAssertionIsQuantifiable=false;state.numCapturingParens=0;state.maxBackReference=0;state.groupNames.length=0;state.backReferenceNames.length=0;this.regexp_disjunction(state);if(state.pos!==state.source.length){// Make the same messages as V8.\nif(state.eat(0x29/* ) */)){state.raise(\"Unmatched ')'\");}if(state.eat(0x5D/* ] */)||state.eat(0x7D/* } */)){state.raise(\"Lone quantifier brackets\");}}if(state.maxBackReference>state.numCapturingParens){state.raise(\"Invalid escape\");}for(var i=0,list=state.backReferenceNames;i<list.length;i+=1){var name=list[i];if(state.groupNames.indexOf(name)===-1){state.raise(\"Invalid named capture referenced\");}}};// https://www.ecma-international.org/ecma-262/8.0/#prod-Disjunction\npp$1.regexp_disjunction=function(state){this.regexp_alternative(state);while(state.eat(0x7C/* | */)){this.regexp_alternative(state);}// Make the same message as V8.\nif(this.regexp_eatQuantifier(state,true)){state.raise(\"Nothing to repeat\");}if(state.eat(0x7B/* { */)){state.raise(\"Lone quantifier brackets\");}};// https://www.ecma-international.org/ecma-262/8.0/#prod-Alternative\npp$1.regexp_alternative=function(state){while(state.pos<state.source.length&&this.regexp_eatTerm(state)){}};// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-Term\npp$1.regexp_eatTerm=function(state){if(this.regexp_eatAssertion(state)){// Handle `QuantifiableAssertion Quantifier` alternative.\n// `state.lastAssertionIsQuantifiable` is true if the last eaten Assertion\n// is a QuantifiableAssertion.\nif(state.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(state)){// Make the same message as V8.\nif(state.switchU){state.raise(\"Invalid quantifier\");}}return true;}if(state.switchU?this.regexp_eatAtom(state):this.regexp_eatExtendedAtom(state)){this.regexp_eatQuantifier(state);return true;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-Assertion\npp$1.regexp_eatAssertion=function(state){var start=state.pos;state.lastAssertionIsQuantifiable=false;// ^, $\nif(state.eat(0x5E/* ^ */)||state.eat(0x24/* $ */)){return true;}// \\b \\B\nif(state.eat(0x5C/* \\ */)){if(state.eat(0x42/* B */)||state.eat(0x62/* b */)){return true;}state.pos=start;}// Lookahead / Lookbehind\nif(state.eat(0x28/* ( */)&&state.eat(0x3F/* ? */)){var lookbehind=false;if(this.options.ecmaVersion>=9){lookbehind=state.eat(0x3C/* < */);}if(state.eat(0x3D/* = */)||state.eat(0x21/* ! */)){this.regexp_disjunction(state);if(!state.eat(0x29/* ) */)){state.raise(\"Unterminated group\");}state.lastAssertionIsQuantifiable=!lookbehind;return true;}}state.pos=start;return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-Quantifier\npp$1.regexp_eatQuantifier=function(state,noError){if(noError===void 0)noError=false;if(this.regexp_eatQuantifierPrefix(state,noError)){state.eat(0x3F/* ? */);return true;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-QuantifierPrefix\npp$1.regexp_eatQuantifierPrefix=function(state,noError){return state.eat(0x2A/* * */)||state.eat(0x2B/* + */)||state.eat(0x3F/* ? */)||this.regexp_eatBracedQuantifier(state,noError);};pp$1.regexp_eatBracedQuantifier=function(state,noError){var start=state.pos;if(state.eat(0x7B/* { */)){var min=0,max=-1;if(this.regexp_eatDecimalDigits(state)){min=state.lastIntValue;if(state.eat(0x2C/* , */)&&this.regexp_eatDecimalDigits(state)){max=state.lastIntValue;}if(state.eat(0x7D/* } */)){// SyntaxError in https://www.ecma-international.org/ecma-262/8.0/#sec-term\nif(max!==-1&&max<min&&!noError){state.raise(\"numbers out of order in {} quantifier\");}return true;}}if(state.switchU&&!noError){state.raise(\"Incomplete quantifier\");}state.pos=start;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-Atom\npp$1.regexp_eatAtom=function(state){return this.regexp_eatPatternCharacters(state)||state.eat(0x2E/* . */)||this.regexp_eatReverseSolidusAtomEscape(state)||this.regexp_eatCharacterClass(state)||this.regexp_eatUncapturingGroup(state)||this.regexp_eatCapturingGroup(state);};pp$1.regexp_eatReverseSolidusAtomEscape=function(state){var start=state.pos;if(state.eat(0x5C/* \\ */)){if(this.regexp_eatAtomEscape(state)){return true;}state.pos=start;}return false;};pp$1.regexp_eatUncapturingGroup=function(state){var start=state.pos;if(state.eat(0x28/* ( */)){if(state.eat(0x3F/* ? */)&&state.eat(0x3A/* : */)){this.regexp_disjunction(state);if(state.eat(0x29/* ) */)){return true;}state.raise(\"Unterminated group\");}state.pos=start;}return false;};pp$1.regexp_eatCapturingGroup=function(state){if(state.eat(0x28/* ( */)){if(this.options.ecmaVersion>=9){this.regexp_groupSpecifier(state);}else if(state.current()===0x3F/* ? */){state.raise(\"Invalid group\");}this.regexp_disjunction(state);if(state.eat(0x29/* ) */)){state.numCapturingParens+=1;return true;}state.raise(\"Unterminated group\");}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-ExtendedAtom\npp$1.regexp_eatExtendedAtom=function(state){return state.eat(0x2E/* . */)||this.regexp_eatReverseSolidusAtomEscape(state)||this.regexp_eatCharacterClass(state)||this.regexp_eatUncapturingGroup(state)||this.regexp_eatCapturingGroup(state)||this.regexp_eatInvalidBracedQuantifier(state)||this.regexp_eatExtendedPatternCharacter(state);};// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-InvalidBracedQuantifier\npp$1.regexp_eatInvalidBracedQuantifier=function(state){if(this.regexp_eatBracedQuantifier(state,true)){state.raise(\"Nothing to repeat\");}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-SyntaxCharacter\npp$1.regexp_eatSyntaxCharacter=function(state){var ch=state.current();if(isSyntaxCharacter(ch)){state.lastIntValue=ch;state.advance();return true;}return false;};function isSyntaxCharacter(ch){return ch===0x24/* $ */||ch>=0x28/* ( */&&ch<=0x2B/* + */||ch===0x2E/* . */||ch===0x3F/* ? */||ch>=0x5B/* [ */&&ch<=0x5E/* ^ */||ch>=0x7B/* { */&&ch<=0x7D/* } */;}// https://www.ecma-international.org/ecma-262/8.0/#prod-PatternCharacter\n// But eat eager.\npp$1.regexp_eatPatternCharacters=function(state){var start=state.pos;var ch=0;while((ch=state.current())!==-1&&!isSyntaxCharacter(ch)){state.advance();}return state.pos!==start;};// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-ExtendedPatternCharacter\npp$1.regexp_eatExtendedPatternCharacter=function(state){var ch=state.current();if(ch!==-1&&ch!==0x24/* $ */&&!(ch>=0x28/* ( */&&ch<=0x2B/* + */)&&ch!==0x2E/* . */&&ch!==0x3F/* ? */&&ch!==0x5B/* [ */&&ch!==0x5E/* ^ */&&ch!==0x7C/* | */){state.advance();return true;}return false;};// GroupSpecifier ::\n//   [empty]\n//   `?` GroupName\npp$1.regexp_groupSpecifier=function(state){if(state.eat(0x3F/* ? */)){if(this.regexp_eatGroupName(state)){if(state.groupNames.indexOf(state.lastStringValue)!==-1){state.raise(\"Duplicate capture group name\");}state.groupNames.push(state.lastStringValue);return;}state.raise(\"Invalid group\");}};// GroupName ::\n//   `<` RegExpIdentifierName `>`\n// Note: this updates `state.lastStringValue` property with the eaten name.\npp$1.regexp_eatGroupName=function(state){state.lastStringValue=\"\";if(state.eat(0x3C/* < */)){if(this.regexp_eatRegExpIdentifierName(state)&&state.eat(0x3E/* > */)){return true;}state.raise(\"Invalid capture group name\");}return false;};// RegExpIdentifierName ::\n//   RegExpIdentifierStart\n//   RegExpIdentifierName RegExpIdentifierPart\n// Note: this updates `state.lastStringValue` property with the eaten name.\npp$1.regexp_eatRegExpIdentifierName=function(state){state.lastStringValue=\"\";if(this.regexp_eatRegExpIdentifierStart(state)){state.lastStringValue+=codePointToString(state.lastIntValue);while(this.regexp_eatRegExpIdentifierPart(state)){state.lastStringValue+=codePointToString(state.lastIntValue);}return true;}return false;};// RegExpIdentifierStart ::\n//   UnicodeIDStart\n//   `$`\n//   `_`\n//   `\\` RegExpUnicodeEscapeSequence[+U]\npp$1.regexp_eatRegExpIdentifierStart=function(state){var start=state.pos;var forceU=this.options.ecmaVersion>=11;var ch=state.current(forceU);state.advance(forceU);if(ch===0x5C/* \\ */&&this.regexp_eatRegExpUnicodeEscapeSequence(state,forceU)){ch=state.lastIntValue;}if(isRegExpIdentifierStart(ch)){state.lastIntValue=ch;return true;}state.pos=start;return false;};function isRegExpIdentifierStart(ch){return isIdentifierStart(ch,true)||ch===0x24/* $ */||ch===0x5F;/* _ */}// RegExpIdentifierPart ::\n//   UnicodeIDContinue\n//   `$`\n//   `_`\n//   `\\` RegExpUnicodeEscapeSequence[+U]\n//   <ZWNJ>\n//   <ZWJ>\npp$1.regexp_eatRegExpIdentifierPart=function(state){var start=state.pos;var forceU=this.options.ecmaVersion>=11;var ch=state.current(forceU);state.advance(forceU);if(ch===0x5C/* \\ */&&this.regexp_eatRegExpUnicodeEscapeSequence(state,forceU)){ch=state.lastIntValue;}if(isRegExpIdentifierPart(ch)){state.lastIntValue=ch;return true;}state.pos=start;return false;};function isRegExpIdentifierPart(ch){return isIdentifierChar(ch,true)||ch===0x24/* $ */||ch===0x5F/* _ */||ch===0x200C/* <ZWNJ> */||ch===0x200D;/* <ZWJ> */}// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-AtomEscape\npp$1.regexp_eatAtomEscape=function(state){if(this.regexp_eatBackReference(state)||this.regexp_eatCharacterClassEscape(state)||this.regexp_eatCharacterEscape(state)||state.switchN&&this.regexp_eatKGroupName(state)){return true;}if(state.switchU){// Make the same message as V8.\nif(state.current()===0x63/* c */){state.raise(\"Invalid unicode escape\");}state.raise(\"Invalid escape\");}return false;};pp$1.regexp_eatBackReference=function(state){var start=state.pos;if(this.regexp_eatDecimalEscape(state)){var n=state.lastIntValue;if(state.switchU){// For SyntaxError in https://www.ecma-international.org/ecma-262/8.0/#sec-atomescape\nif(n>state.maxBackReference){state.maxBackReference=n;}return true;}if(n<=state.numCapturingParens){return true;}state.pos=start;}return false;};pp$1.regexp_eatKGroupName=function(state){if(state.eat(0x6B/* k */)){if(this.regexp_eatGroupName(state)){state.backReferenceNames.push(state.lastStringValue);return true;}state.raise(\"Invalid named reference\");}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-CharacterEscape\npp$1.regexp_eatCharacterEscape=function(state){return this.regexp_eatControlEscape(state)||this.regexp_eatCControlLetter(state)||this.regexp_eatZero(state)||this.regexp_eatHexEscapeSequence(state)||this.regexp_eatRegExpUnicodeEscapeSequence(state,false)||!state.switchU&&this.regexp_eatLegacyOctalEscapeSequence(state)||this.regexp_eatIdentityEscape(state);};pp$1.regexp_eatCControlLetter=function(state){var start=state.pos;if(state.eat(0x63/* c */)){if(this.regexp_eatControlLetter(state)){return true;}state.pos=start;}return false;};pp$1.regexp_eatZero=function(state){if(state.current()===0x30/* 0 */&&!isDecimalDigit(state.lookahead())){state.lastIntValue=0;state.advance();return true;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-ControlEscape\npp$1.regexp_eatControlEscape=function(state){var ch=state.current();if(ch===0x74/* t */){state.lastIntValue=0x09;/* \\t */state.advance();return true;}if(ch===0x6E/* n */){state.lastIntValue=0x0A;/* \\n */state.advance();return true;}if(ch===0x76/* v */){state.lastIntValue=0x0B;/* \\v */state.advance();return true;}if(ch===0x66/* f */){state.lastIntValue=0x0C;/* \\f */state.advance();return true;}if(ch===0x72/* r */){state.lastIntValue=0x0D;/* \\r */state.advance();return true;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-ControlLetter\npp$1.regexp_eatControlLetter=function(state){var ch=state.current();if(isControlLetter(ch)){state.lastIntValue=ch%0x20;state.advance();return true;}return false;};function isControlLetter(ch){return ch>=0x41/* A */&&ch<=0x5A/* Z */||ch>=0x61/* a */&&ch<=0x7A/* z */;}// https://www.ecma-international.org/ecma-262/8.0/#prod-RegExpUnicodeEscapeSequence\npp$1.regexp_eatRegExpUnicodeEscapeSequence=function(state,forceU){if(forceU===void 0)forceU=false;var start=state.pos;var switchU=forceU||state.switchU;if(state.eat(0x75/* u */)){if(this.regexp_eatFixedHexDigits(state,4)){var lead=state.lastIntValue;if(switchU&&lead>=0xD800&&lead<=0xDBFF){var leadSurrogateEnd=state.pos;if(state.eat(0x5C/* \\ */)&&state.eat(0x75/* u */)&&this.regexp_eatFixedHexDigits(state,4)){var trail=state.lastIntValue;if(trail>=0xDC00&&trail<=0xDFFF){state.lastIntValue=(lead-0xD800)*0x400+(trail-0xDC00)+0x10000;return true;}}state.pos=leadSurrogateEnd;state.lastIntValue=lead;}return true;}if(switchU&&state.eat(0x7B/* { */)&&this.regexp_eatHexDigits(state)&&state.eat(0x7D/* } */)&&isValidUnicode(state.lastIntValue)){return true;}if(switchU){state.raise(\"Invalid unicode escape\");}state.pos=start;}return false;};function isValidUnicode(ch){return ch>=0&&ch<=0x10FFFF;}// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-IdentityEscape\npp$1.regexp_eatIdentityEscape=function(state){if(state.switchU){if(this.regexp_eatSyntaxCharacter(state)){return true;}if(state.eat(0x2F/* / */)){state.lastIntValue=0x2F;/* / */return true;}return false;}var ch=state.current();if(ch!==0x63/* c */&&(!state.switchN||ch!==0x6B/* k */)){state.lastIntValue=ch;state.advance();return true;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-DecimalEscape\npp$1.regexp_eatDecimalEscape=function(state){state.lastIntValue=0;var ch=state.current();if(ch>=0x31/* 1 */&&ch<=0x39/* 9 */){do{state.lastIntValue=10*state.lastIntValue+(ch-0x30/* 0 */);state.advance();}while((ch=state.current())>=0x30/* 0 */&&ch<=0x39/* 9 */);return true;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-CharacterClassEscape\npp$1.regexp_eatCharacterClassEscape=function(state){var ch=state.current();if(isCharacterClassEscape(ch)){state.lastIntValue=-1;state.advance();return true;}if(state.switchU&&this.options.ecmaVersion>=9&&(ch===0x50/* P */||ch===0x70/* p */)){state.lastIntValue=-1;state.advance();if(state.eat(0x7B/* { */)&&this.regexp_eatUnicodePropertyValueExpression(state)&&state.eat(0x7D/* } */)){return true;}state.raise(\"Invalid property name\");}return false;};function isCharacterClassEscape(ch){return ch===0x64/* d */||ch===0x44/* D */||ch===0x73/* s */||ch===0x53/* S */||ch===0x77/* w */||ch===0x57/* W */;}// UnicodePropertyValueExpression ::\n//   UnicodePropertyName `=` UnicodePropertyValue\n//   LoneUnicodePropertyNameOrValue\npp$1.regexp_eatUnicodePropertyValueExpression=function(state){var start=state.pos;// UnicodePropertyName `=` UnicodePropertyValue\nif(this.regexp_eatUnicodePropertyName(state)&&state.eat(0x3D/* = */)){var name=state.lastStringValue;if(this.regexp_eatUnicodePropertyValue(state)){var value=state.lastStringValue;this.regexp_validateUnicodePropertyNameAndValue(state,name,value);return true;}}state.pos=start;// LoneUnicodePropertyNameOrValue\nif(this.regexp_eatLoneUnicodePropertyNameOrValue(state)){var nameOrValue=state.lastStringValue;this.regexp_validateUnicodePropertyNameOrValue(state,nameOrValue);return true;}return false;};pp$1.regexp_validateUnicodePropertyNameAndValue=function(state,name,value){if(!hasOwn(state.unicodeProperties.nonBinary,name)){state.raise(\"Invalid property name\");}if(!state.unicodeProperties.nonBinary[name].test(value)){state.raise(\"Invalid property value\");}};pp$1.regexp_validateUnicodePropertyNameOrValue=function(state,nameOrValue){if(!state.unicodeProperties.binary.test(nameOrValue)){state.raise(\"Invalid property name\");}};// UnicodePropertyName ::\n//   UnicodePropertyNameCharacters\npp$1.regexp_eatUnicodePropertyName=function(state){var ch=0;state.lastStringValue=\"\";while(isUnicodePropertyNameCharacter(ch=state.current())){state.lastStringValue+=codePointToString(ch);state.advance();}return state.lastStringValue!==\"\";};function isUnicodePropertyNameCharacter(ch){return isControlLetter(ch)||ch===0x5F;/* _ */}// UnicodePropertyValue ::\n//   UnicodePropertyValueCharacters\npp$1.regexp_eatUnicodePropertyValue=function(state){var ch=0;state.lastStringValue=\"\";while(isUnicodePropertyValueCharacter(ch=state.current())){state.lastStringValue+=codePointToString(ch);state.advance();}return state.lastStringValue!==\"\";};function isUnicodePropertyValueCharacter(ch){return isUnicodePropertyNameCharacter(ch)||isDecimalDigit(ch);}// LoneUnicodePropertyNameOrValue ::\n//   UnicodePropertyValueCharacters\npp$1.regexp_eatLoneUnicodePropertyNameOrValue=function(state){return this.regexp_eatUnicodePropertyValue(state);};// https://www.ecma-international.org/ecma-262/8.0/#prod-CharacterClass\npp$1.regexp_eatCharacterClass=function(state){if(state.eat(0x5B/* [ */)){state.eat(0x5E/* ^ */);this.regexp_classRanges(state);if(state.eat(0x5D/* ] */)){return true;}// Unreachable since it threw \"unterminated regular expression\" error before.\nstate.raise(\"Unterminated character class\");}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-ClassRanges\n// https://www.ecma-international.org/ecma-262/8.0/#prod-NonemptyClassRanges\n// https://www.ecma-international.org/ecma-262/8.0/#prod-NonemptyClassRangesNoDash\npp$1.regexp_classRanges=function(state){while(this.regexp_eatClassAtom(state)){var left=state.lastIntValue;if(state.eat(0x2D/* - */)&&this.regexp_eatClassAtom(state)){var right=state.lastIntValue;if(state.switchU&&(left===-1||right===-1)){state.raise(\"Invalid character class\");}if(left!==-1&&right!==-1&&left>right){state.raise(\"Range out of order in character class\");}}}};// https://www.ecma-international.org/ecma-262/8.0/#prod-ClassAtom\n// https://www.ecma-international.org/ecma-262/8.0/#prod-ClassAtomNoDash\npp$1.regexp_eatClassAtom=function(state){var start=state.pos;if(state.eat(0x5C/* \\ */)){if(this.regexp_eatClassEscape(state)){return true;}if(state.switchU){// Make the same message as V8.\nvar ch$1=state.current();if(ch$1===0x63/* c */||isOctalDigit(ch$1)){state.raise(\"Invalid class escape\");}state.raise(\"Invalid escape\");}state.pos=start;}var ch=state.current();if(ch!==0x5D/* ] */){state.lastIntValue=ch;state.advance();return true;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-ClassEscape\npp$1.regexp_eatClassEscape=function(state){var start=state.pos;if(state.eat(0x62/* b */)){state.lastIntValue=0x08;/* <BS> */return true;}if(state.switchU&&state.eat(0x2D/* - */)){state.lastIntValue=0x2D;/* - */return true;}if(!state.switchU&&state.eat(0x63/* c */)){if(this.regexp_eatClassControlLetter(state)){return true;}state.pos=start;}return this.regexp_eatCharacterClassEscape(state)||this.regexp_eatCharacterEscape(state);};// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-ClassControlLetter\npp$1.regexp_eatClassControlLetter=function(state){var ch=state.current();if(isDecimalDigit(ch)||ch===0x5F/* _ */){state.lastIntValue=ch%0x20;state.advance();return true;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-HexEscapeSequence\npp$1.regexp_eatHexEscapeSequence=function(state){var start=state.pos;if(state.eat(0x78/* x */)){if(this.regexp_eatFixedHexDigits(state,2)){return true;}if(state.switchU){state.raise(\"Invalid escape\");}state.pos=start;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-DecimalDigits\npp$1.regexp_eatDecimalDigits=function(state){var start=state.pos;var ch=0;state.lastIntValue=0;while(isDecimalDigit(ch=state.current())){state.lastIntValue=10*state.lastIntValue+(ch-0x30/* 0 */);state.advance();}return state.pos!==start;};function isDecimalDigit(ch){return ch>=0x30/* 0 */&&ch<=0x39;/* 9 */}// https://www.ecma-international.org/ecma-262/8.0/#prod-HexDigits\npp$1.regexp_eatHexDigits=function(state){var start=state.pos;var ch=0;state.lastIntValue=0;while(isHexDigit(ch=state.current())){state.lastIntValue=16*state.lastIntValue+hexToInt(ch);state.advance();}return state.pos!==start;};function isHexDigit(ch){return ch>=0x30/* 0 */&&ch<=0x39/* 9 */||ch>=0x41/* A */&&ch<=0x46/* F */||ch>=0x61/* a */&&ch<=0x66/* f */;}function hexToInt(ch){if(ch>=0x41/* A */&&ch<=0x46/* F */){return 10+(ch-0x41/* A */);}if(ch>=0x61/* a */&&ch<=0x66/* f */){return 10+(ch-0x61/* a */);}return ch-0x30;/* 0 */}// https://www.ecma-international.org/ecma-262/8.0/#prod-annexB-LegacyOctalEscapeSequence\n// Allows only 0-377(octal) i.e. 0-255(decimal).\npp$1.regexp_eatLegacyOctalEscapeSequence=function(state){if(this.regexp_eatOctalDigit(state)){var n1=state.lastIntValue;if(this.regexp_eatOctalDigit(state)){var n2=state.lastIntValue;if(n1<=3&&this.regexp_eatOctalDigit(state)){state.lastIntValue=n1*64+n2*8+state.lastIntValue;}else{state.lastIntValue=n1*8+n2;}}else{state.lastIntValue=n1;}return true;}return false;};// https://www.ecma-international.org/ecma-262/8.0/#prod-OctalDigit\npp$1.regexp_eatOctalDigit=function(state){var ch=state.current();if(isOctalDigit(ch)){state.lastIntValue=ch-0x30;/* 0 */state.advance();return true;}state.lastIntValue=0;return false;};function isOctalDigit(ch){return ch>=0x30/* 0 */&&ch<=0x37;/* 7 */}// https://www.ecma-international.org/ecma-262/8.0/#prod-Hex4Digits\n// https://www.ecma-international.org/ecma-262/8.0/#prod-HexDigit\n// And HexDigit HexDigit in https://www.ecma-international.org/ecma-262/8.0/#prod-HexEscapeSequence\npp$1.regexp_eatFixedHexDigits=function(state,length){var start=state.pos;state.lastIntValue=0;for(var i=0;i<length;++i){var ch=state.current();if(!isHexDigit(ch)){state.pos=start;return false;}state.lastIntValue=16*state.lastIntValue+hexToInt(ch);state.advance();}return true;};// Object type used to represent tokens. Note that normally, tokens\n// simply exist as properties on the parser object. This is only\n// used for the onToken callback and the external tokenizer.\nvar Token=function Token(p){this.type=p.type;this.value=p.value;this.start=p.start;this.end=p.end;if(p.options.locations){this.loc=new SourceLocation(p,p.startLoc,p.endLoc);}if(p.options.ranges){this.range=[p.start,p.end];}};// ## Tokenizer\nvar pp=Parser.prototype;// Move to the next token\npp.next=function(ignoreEscapeSequenceInKeyword){if(!ignoreEscapeSequenceInKeyword&&this.type.keyword&&this.containsEsc){this.raiseRecoverable(this.start,\"Escape sequence in keyword \"+this.type.keyword);}if(this.options.onToken){this.options.onToken(new Token(this));}this.lastTokEnd=this.end;this.lastTokStart=this.start;this.lastTokEndLoc=this.endLoc;this.lastTokStartLoc=this.startLoc;this.nextToken();};pp.getToken=function(){this.next();return new Token(this);};// If we're in an ES6 environment, make parsers iterable\nif(typeof Symbol!==\"undefined\"){pp[Symbol.iterator]=function(){var this$1$1=this;return{next:function(){var token=this$1$1.getToken();return{done:token.type===types$1.eof,value:token};}};};}// Toggle strict mode. Re-reads the next number or string to please\n// pedantic tests (`\"use strict\"; 010;` should fail).\n// Read a single token, updating the parser object's token-related\n// properties.\npp.nextToken=function(){var curContext=this.curContext();if(!curContext||!curContext.preserveSpace){this.skipSpace();}this.start=this.pos;if(this.options.locations){this.startLoc=this.curPosition();}if(this.pos>=this.input.length){return this.finishToken(types$1.eof);}if(curContext.override){return curContext.override(this);}else{this.readToken(this.fullCharCodeAtPos());}};pp.readToken=function(code){// Identifier or keyword. '\\uXXXX' sequences are allowed in\n// identifiers, so '\\' also dispatches to that.\nif(isIdentifierStart(code,this.options.ecmaVersion>=6)||code===92/* '\\' */){return this.readWord();}return this.getTokenFromCode(code);};pp.fullCharCodeAtPos=function(){var code=this.input.charCodeAt(this.pos);if(code<=0xd7ff||code>=0xdc00){return code;}var next=this.input.charCodeAt(this.pos+1);return next<=0xdbff||next>=0xe000?code:(code<<10)+next-0x35fdc00;};pp.skipBlockComment=function(){var startLoc=this.options.onComment&&this.curPosition();var start=this.pos,end=this.input.indexOf(\"*/\",this.pos+=2);if(end===-1){this.raise(this.pos-2,\"Unterminated comment\");}this.pos=end+2;if(this.options.locations){for(var nextBreak=void 0,pos=start;(nextBreak=nextLineBreak(this.input,pos,this.pos))>-1;){++this.curLine;pos=this.lineStart=nextBreak;}}if(this.options.onComment){this.options.onComment(true,this.input.slice(start+2,end),start,this.pos,startLoc,this.curPosition());}};pp.skipLineComment=function(startSkip){var start=this.pos;var startLoc=this.options.onComment&&this.curPosition();var ch=this.input.charCodeAt(this.pos+=startSkip);while(this.pos<this.input.length&&!isNewLine(ch)){ch=this.input.charCodeAt(++this.pos);}if(this.options.onComment){this.options.onComment(false,this.input.slice(start+startSkip,this.pos),start,this.pos,startLoc,this.curPosition());}};// Called at the start of the parse and after every token. Skips\n// whitespace and comments, and.\npp.skipSpace=function(){loop:while(this.pos<this.input.length){var ch=this.input.charCodeAt(this.pos);switch(ch){case 32:case 160:// ' '\n++this.pos;break;case 13:if(this.input.charCodeAt(this.pos+1)===10){++this.pos;}case 10:case 8232:case 8233:++this.pos;if(this.options.locations){++this.curLine;this.lineStart=this.pos;}break;case 47:// '/'\nswitch(this.input.charCodeAt(this.pos+1)){case 42:// '*'\nthis.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break loop;}break;default:if(ch>8&&ch<14||ch>=5760&&nonASCIIwhitespace.test(String.fromCharCode(ch))){++this.pos;}else{break loop;}}}};// Called at the end of every token. Sets `end`, `val`, and\n// maintains `context` and `exprAllowed`, and skips the space after\n// the token, so that the next one's `start` will point at the\n// right position.\npp.finishToken=function(type,val){this.end=this.pos;if(this.options.locations){this.endLoc=this.curPosition();}var prevType=this.type;this.type=type;this.value=val;this.updateContext(prevType);};// ### Token reading\n// This is the function that is called to fetch the next token. It\n// is somewhat obscure, because it works in character codes rather\n// than characters, and because operator parsing has been inlined\n// into it.\n//\n// All in the name of speed.\n//\npp.readToken_dot=function(){var next=this.input.charCodeAt(this.pos+1);if(next>=48&&next<=57){return this.readNumber(true);}var next2=this.input.charCodeAt(this.pos+2);if(this.options.ecmaVersion>=6&&next===46&&next2===46){// 46 = dot '.'\nthis.pos+=3;return this.finishToken(types$1.ellipsis);}else{++this.pos;return this.finishToken(types$1.dot);}};pp.readToken_slash=function(){// '/'\nvar next=this.input.charCodeAt(this.pos+1);if(this.exprAllowed){++this.pos;return this.readRegexp();}if(next===61){return this.finishOp(types$1.assign,2);}return this.finishOp(types$1.slash,1);};pp.readToken_mult_modulo_exp=function(code){// '%*'\nvar next=this.input.charCodeAt(this.pos+1);var size=1;var tokentype=code===42?types$1.star:types$1.modulo;// exponentiation operator ** and **=\nif(this.options.ecmaVersion>=7&&code===42&&next===42){++size;tokentype=types$1.starstar;next=this.input.charCodeAt(this.pos+2);}if(next===61){return this.finishOp(types$1.assign,size+1);}return this.finishOp(tokentype,size);};pp.readToken_pipe_amp=function(code){// '|&'\nvar next=this.input.charCodeAt(this.pos+1);if(next===code){if(this.options.ecmaVersion>=12){var next2=this.input.charCodeAt(this.pos+2);if(next2===61){return this.finishOp(types$1.assign,3);}}return this.finishOp(code===124?types$1.logicalOR:types$1.logicalAND,2);}if(next===61){return this.finishOp(types$1.assign,2);}return this.finishOp(code===124?types$1.bitwiseOR:types$1.bitwiseAND,1);};pp.readToken_caret=function(){// '^'\nvar next=this.input.charCodeAt(this.pos+1);if(next===61){return this.finishOp(types$1.assign,2);}return this.finishOp(types$1.bitwiseXOR,1);};pp.readToken_plus_min=function(code){// '+-'\nvar next=this.input.charCodeAt(this.pos+1);if(next===code){if(next===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||lineBreak.test(this.input.slice(this.lastTokEnd,this.pos)))){// A `-->` line comment\nthis.skipLineComment(3);this.skipSpace();return this.nextToken();}return this.finishOp(types$1.incDec,2);}if(next===61){return this.finishOp(types$1.assign,2);}return this.finishOp(types$1.plusMin,1);};pp.readToken_lt_gt=function(code){// '<>'\nvar next=this.input.charCodeAt(this.pos+1);var size=1;if(next===code){size=code===62&&this.input.charCodeAt(this.pos+2)===62?3:2;if(this.input.charCodeAt(this.pos+size)===61){return this.finishOp(types$1.assign,size+1);}return this.finishOp(types$1.bitShift,size);}if(next===33&&code===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45){// `<!--`, an XML-style comment that should be interpreted as a line comment\nthis.skipLineComment(4);this.skipSpace();return this.nextToken();}if(next===61){size=2;}return this.finishOp(types$1.relational,size);};pp.readToken_eq_excl=function(code){// '=!'\nvar next=this.input.charCodeAt(this.pos+1);if(next===61){return this.finishOp(types$1.equality,this.input.charCodeAt(this.pos+2)===61?3:2);}if(code===61&&next===62&&this.options.ecmaVersion>=6){// '=>'\nthis.pos+=2;return this.finishToken(types$1.arrow);}return this.finishOp(code===61?types$1.eq:types$1.prefix,1);};pp.readToken_question=function(){// '?'\nvar ecmaVersion=this.options.ecmaVersion;if(ecmaVersion>=11){var next=this.input.charCodeAt(this.pos+1);if(next===46){var next2=this.input.charCodeAt(this.pos+2);if(next2<48||next2>57){return this.finishOp(types$1.questionDot,2);}}if(next===63){if(ecmaVersion>=12){var next2$1=this.input.charCodeAt(this.pos+2);if(next2$1===61){return this.finishOp(types$1.assign,3);}}return this.finishOp(types$1.coalesce,2);}}return this.finishOp(types$1.question,1);};pp.readToken_numberSign=function(){// '#'\nvar ecmaVersion=this.options.ecmaVersion;var code=35;// '#'\nif(ecmaVersion>=13){++this.pos;code=this.fullCharCodeAtPos();if(isIdentifierStart(code,true)||code===92/* '\\' */){return this.finishToken(types$1.privateId,this.readWord1());}}this.raise(this.pos,\"Unexpected character '\"+codePointToString(code)+\"'\");};pp.getTokenFromCode=function(code){switch(code){// The interpretation of a dot depends on whether it is followed\n// by a digit or another two dots.\ncase 46:// '.'\nreturn this.readToken_dot();// Punctuation tokens.\ncase 40:++this.pos;return this.finishToken(types$1.parenL);case 41:++this.pos;return this.finishToken(types$1.parenR);case 59:++this.pos;return this.finishToken(types$1.semi);case 44:++this.pos;return this.finishToken(types$1.comma);case 91:++this.pos;return this.finishToken(types$1.bracketL);case 93:++this.pos;return this.finishToken(types$1.bracketR);case 123:++this.pos;return this.finishToken(types$1.braceL);case 125:++this.pos;return this.finishToken(types$1.braceR);case 58:++this.pos;return this.finishToken(types$1.colon);case 96:// '`'\nif(this.options.ecmaVersion<6){break;}++this.pos;return this.finishToken(types$1.backQuote);case 48:// '0'\nvar next=this.input.charCodeAt(this.pos+1);if(next===120||next===88){return this.readRadixNumber(16);}// '0x', '0X' - hex number\nif(this.options.ecmaVersion>=6){if(next===111||next===79){return this.readRadixNumber(8);}// '0o', '0O' - octal number\nif(next===98||next===66){return this.readRadixNumber(2);}// '0b', '0B' - binary number\n}// Anything else beginning with a digit is an integer, octal\n// number, or float.\ncase 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:// 1-9\nreturn this.readNumber(false);// Quotes produce strings.\ncase 34:case 39:// '\"', \"'\"\nreturn this.readString(code);// Operators are parsed inline in tiny state machines. '=' (61) is\n// often referred to. `finishOp` simply skips the amount of\n// characters it is given as second argument, and returns a token\n// of the type given by its first argument.\ncase 47:// '/'\nreturn this.readToken_slash();case 37:case 42:// '%*'\nreturn this.readToken_mult_modulo_exp(code);case 124:case 38:// '|&'\nreturn this.readToken_pipe_amp(code);case 94:// '^'\nreturn this.readToken_caret();case 43:case 45:// '+-'\nreturn this.readToken_plus_min(code);case 60:case 62:// '<>'\nreturn this.readToken_lt_gt(code);case 61:case 33:// '=!'\nreturn this.readToken_eq_excl(code);case 63:// '?'\nreturn this.readToken_question();case 126:// '~'\nreturn this.finishOp(types$1.prefix,1);case 35:// '#'\nreturn this.readToken_numberSign();}this.raise(this.pos,\"Unexpected character '\"+codePointToString(code)+\"'\");};pp.finishOp=function(type,size){var str=this.input.slice(this.pos,this.pos+size);this.pos+=size;return this.finishToken(type,str);};pp.readRegexp=function(){var escaped,inClass,start=this.pos;for(;;){if(this.pos>=this.input.length){this.raise(start,\"Unterminated regular expression\");}var ch=this.input.charAt(this.pos);if(lineBreak.test(ch)){this.raise(start,\"Unterminated regular expression\");}if(!escaped){if(ch===\"[\"){inClass=true;}else if(ch===\"]\"&&inClass){inClass=false;}else if(ch===\"/\"&&!inClass){break;}escaped=ch===\"\\\\\";}else{escaped=false;}++this.pos;}var pattern=this.input.slice(start,this.pos);++this.pos;var flagsStart=this.pos;var flags=this.readWord1();if(this.containsEsc){this.unexpected(flagsStart);}// Validate pattern\nvar state=this.regexpState||(this.regexpState=new RegExpValidationState(this));state.reset(start,pattern,flags);this.validateRegExpFlags(state);this.validateRegExpPattern(state);// Create Literal#value property value.\nvar value=null;try{value=new RegExp(pattern,flags);}catch(e){// ESTree requires null if it failed to instantiate RegExp object.\n// https://github.com/estree/estree/blob/a27003adf4fd7bfad44de9cef372a2eacd527b1c/es5.md#regexpliteral\n}return this.finishToken(types$1.regexp,{pattern:pattern,flags:flags,value:value});};// Read an integer in the given radix. Return null if zero digits\n// were read, the integer value otherwise. When `len` is given, this\n// will return `null` unless the integer has exactly `len` digits.\npp.readInt=function(radix,len,maybeLegacyOctalNumericLiteral){// `len` is used for character escape sequences. In that case, disallow separators.\nvar allowSeparators=this.options.ecmaVersion>=12&&len===undefined;// `maybeLegacyOctalNumericLiteral` is true if it doesn't have prefix (0x,0o,0b)\n// and isn't fraction part nor exponent part. In that case, if the first digit\n// is zero then disallow separators.\nvar isLegacyOctalNumericLiteral=maybeLegacyOctalNumericLiteral&&this.input.charCodeAt(this.pos)===48;var start=this.pos,total=0,lastCode=0;for(var i=0,e=len==null?Infinity:len;i<e;++i,++this.pos){var code=this.input.charCodeAt(this.pos),val=void 0;if(allowSeparators&&code===95){if(isLegacyOctalNumericLiteral){this.raiseRecoverable(this.pos,\"Numeric separator is not allowed in legacy octal numeric literals\");}if(lastCode===95){this.raiseRecoverable(this.pos,\"Numeric separator must be exactly one underscore\");}if(i===0){this.raiseRecoverable(this.pos,\"Numeric separator is not allowed at the first of digits\");}lastCode=code;continue;}if(code>=97){val=code-97+10;}// a\nelse if(code>=65){val=code-65+10;}// A\nelse if(code>=48&&code<=57){val=code-48;}// 0-9\nelse{val=Infinity;}if(val>=radix){break;}lastCode=code;total=total*radix+val;}if(allowSeparators&&lastCode===95){this.raiseRecoverable(this.pos-1,\"Numeric separator is not allowed at the last of digits\");}if(this.pos===start||len!=null&&this.pos-start!==len){return null;}return total;};function stringToNumber(str,isLegacyOctalNumericLiteral){if(isLegacyOctalNumericLiteral){return parseInt(str,8);}// `parseFloat(value)` stops parsing at the first numeric separator then returns a wrong value.\nreturn parseFloat(str.replace(/_/g,\"\"));}function stringToBigInt(str){if(typeof BigInt!==\"function\"){return null;}// `BigInt(value)` throws syntax error if the string contains numeric separators.\nreturn BigInt(str.replace(/_/g,\"\"));}pp.readRadixNumber=function(radix){var start=this.pos;this.pos+=2;// 0x\nvar val=this.readInt(radix);if(val==null){this.raise(this.start+2,\"Expected number in radix \"+radix);}if(this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110){val=stringToBigInt(this.input.slice(start,this.pos));++this.pos;}else if(isIdentifierStart(this.fullCharCodeAtPos())){this.raise(this.pos,\"Identifier directly after number\");}return this.finishToken(types$1.num,val);};// Read an integer, octal integer, or floating-point number.\npp.readNumber=function(startsWithDot){var start=this.pos;if(!startsWithDot&&this.readInt(10,undefined,true)===null){this.raise(start,\"Invalid number\");}var octal=this.pos-start>=2&&this.input.charCodeAt(start)===48;if(octal&&this.strict){this.raise(start,\"Invalid number\");}var next=this.input.charCodeAt(this.pos);if(!octal&&!startsWithDot&&this.options.ecmaVersion>=11&&next===110){var val$1=stringToBigInt(this.input.slice(start,this.pos));++this.pos;if(isIdentifierStart(this.fullCharCodeAtPos())){this.raise(this.pos,\"Identifier directly after number\");}return this.finishToken(types$1.num,val$1);}if(octal&&/[89]/.test(this.input.slice(start,this.pos))){octal=false;}if(next===46&&!octal){// '.'\n++this.pos;this.readInt(10);next=this.input.charCodeAt(this.pos);}if((next===69||next===101)&&!octal){// 'eE'\nnext=this.input.charCodeAt(++this.pos);if(next===43||next===45){++this.pos;}// '+-'\nif(this.readInt(10)===null){this.raise(start,\"Invalid number\");}}if(isIdentifierStart(this.fullCharCodeAtPos())){this.raise(this.pos,\"Identifier directly after number\");}var val=stringToNumber(this.input.slice(start,this.pos),octal);return this.finishToken(types$1.num,val);};// Read a string value, interpreting backslash-escapes.\npp.readCodePoint=function(){var ch=this.input.charCodeAt(this.pos),code;if(ch===123){// '{'\nif(this.options.ecmaVersion<6){this.unexpected();}var codePos=++this.pos;code=this.readHexChar(this.input.indexOf(\"}\",this.pos)-this.pos);++this.pos;if(code>0x10FFFF){this.invalidStringToken(codePos,\"Code point out of bounds\");}}else{code=this.readHexChar(4);}return code;};pp.readString=function(quote){var out=\"\",chunkStart=++this.pos;for(;;){if(this.pos>=this.input.length){this.raise(this.start,\"Unterminated string constant\");}var ch=this.input.charCodeAt(this.pos);if(ch===quote){break;}if(ch===92){// '\\'\nout+=this.input.slice(chunkStart,this.pos);out+=this.readEscapedChar(false);chunkStart=this.pos;}else if(ch===0x2028||ch===0x2029){if(this.options.ecmaVersion<10){this.raise(this.start,\"Unterminated string constant\");}++this.pos;if(this.options.locations){this.curLine++;this.lineStart=this.pos;}}else{if(isNewLine(ch)){this.raise(this.start,\"Unterminated string constant\");}++this.pos;}}out+=this.input.slice(chunkStart,this.pos++);return this.finishToken(types$1.string,out);};// Reads template string tokens.\nvar INVALID_TEMPLATE_ESCAPE_ERROR={};pp.tryReadTemplateToken=function(){this.inTemplateElement=true;try{this.readTmplToken();}catch(err){if(err===INVALID_TEMPLATE_ESCAPE_ERROR){this.readInvalidTemplateToken();}else{throw err;}}this.inTemplateElement=false;};pp.invalidStringToken=function(position,message){if(this.inTemplateElement&&this.options.ecmaVersion>=9){throw INVALID_TEMPLATE_ESCAPE_ERROR;}else{this.raise(position,message);}};pp.readTmplToken=function(){var out=\"\",chunkStart=this.pos;for(;;){if(this.pos>=this.input.length){this.raise(this.start,\"Unterminated template\");}var ch=this.input.charCodeAt(this.pos);if(ch===96||ch===36&&this.input.charCodeAt(this.pos+1)===123){// '`', '${'\nif(this.pos===this.start&&(this.type===types$1.template||this.type===types$1.invalidTemplate)){if(ch===36){this.pos+=2;return this.finishToken(types$1.dollarBraceL);}else{++this.pos;return this.finishToken(types$1.backQuote);}}out+=this.input.slice(chunkStart,this.pos);return this.finishToken(types$1.template,out);}if(ch===92){// '\\'\nout+=this.input.slice(chunkStart,this.pos);out+=this.readEscapedChar(true);chunkStart=this.pos;}else if(isNewLine(ch)){out+=this.input.slice(chunkStart,this.pos);++this.pos;switch(ch){case 13:if(this.input.charCodeAt(this.pos)===10){++this.pos;}case 10:out+=\"\\n\";break;default:out+=String.fromCharCode(ch);break;}if(this.options.locations){++this.curLine;this.lineStart=this.pos;}chunkStart=this.pos;}else{++this.pos;}}};// Reads a template token to search for the end, without validating any escape sequences\npp.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++){switch(this.input[this.pos]){case\"\\\\\":++this.pos;break;case\"$\":if(this.input[this.pos+1]!==\"{\"){break;}// falls through\ncase\"`\":return this.finishToken(types$1.invalidTemplate,this.input.slice(this.start,this.pos));// no default\n}}this.raise(this.start,\"Unterminated template\");};// Used to read escaped characters\npp.readEscapedChar=function(inTemplate){var ch=this.input.charCodeAt(++this.pos);++this.pos;switch(ch){case 110:return\"\\n\";// 'n' -> '\\n'\ncase 114:return\"\\r\";// 'r' -> '\\r'\ncase 120:return String.fromCharCode(this.readHexChar(2));// 'x'\ncase 117:return codePointToString(this.readCodePoint());// 'u'\ncase 116:return\"\\t\";// 't' -> '\\t'\ncase 98:return\"\\b\";// 'b' -> '\\b'\ncase 118:return\"\\u000b\";// 'v' -> '\\u000b'\ncase 102:return\"\\f\";// 'f' -> '\\f'\ncase 13:if(this.input.charCodeAt(this.pos)===10){++this.pos;}// '\\r\\n'\ncase 10:// ' \\n'\nif(this.options.locations){this.lineStart=this.pos;++this.curLine;}return\"\";case 56:case 57:if(this.strict){this.invalidStringToken(this.pos-1,\"Invalid escape sequence\");}if(inTemplate){var codePos=this.pos-1;this.invalidStringToken(codePos,\"Invalid escape sequence in template string\");return null;}default:if(ch>=48&&ch<=55){var octalStr=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0];var octal=parseInt(octalStr,8);if(octal>255){octalStr=octalStr.slice(0,-1);octal=parseInt(octalStr,8);}this.pos+=octalStr.length-1;ch=this.input.charCodeAt(this.pos);if((octalStr!==\"0\"||ch===56||ch===57)&&(this.strict||inTemplate)){this.invalidStringToken(this.pos-1-octalStr.length,inTemplate?\"Octal literal in template string\":\"Octal literal in strict mode\");}return String.fromCharCode(octal);}if(isNewLine(ch)){// Unicode new line characters after \\ get removed from output in both\n// template literals and strings\nreturn\"\";}return String.fromCharCode(ch);}};// Used to read character escape sequences ('\\x', '\\u', '\\U').\npp.readHexChar=function(len){var codePos=this.pos;var n=this.readInt(16,len);if(n===null){this.invalidStringToken(codePos,\"Bad character escape sequence\");}return n;};// Read an identifier, and return it as a string. Sets `this.containsEsc`\n// to whether the word contained a '\\u' escape.\n//\n// Incrementally adds only escaped chars, adding other chunks as-is\n// as a micro-optimization.\npp.readWord1=function(){this.containsEsc=false;var word=\"\",first=true,chunkStart=this.pos;var astral=this.options.ecmaVersion>=6;while(this.pos<this.input.length){var ch=this.fullCharCodeAtPos();if(isIdentifierChar(ch,astral)){this.pos+=ch<=0xffff?1:2;}else if(ch===92){// \"\\\"\nthis.containsEsc=true;word+=this.input.slice(chunkStart,this.pos);var escStart=this.pos;if(this.input.charCodeAt(++this.pos)!==117)// \"u\"\n{this.invalidStringToken(this.pos,\"Expecting Unicode escape sequence \\\\uXXXX\");}++this.pos;var esc=this.readCodePoint();if(!(first?isIdentifierStart:isIdentifierChar)(esc,astral)){this.invalidStringToken(escStart,\"Invalid Unicode escape\");}word+=codePointToString(esc);chunkStart=this.pos;}else{break;}first=false;}return word+this.input.slice(chunkStart,this.pos);};// Read an identifier or keyword token. Will check for reserved\n// words when necessary.\npp.readWord=function(){var word=this.readWord1();var type=types$1.name;if(this.keywords.test(word)){type=keywords[word];}return this.finishToken(type,word);};// Acorn is a tiny, fast JavaScript parser written in JavaScript.\nvar version=\"8.7.1\";Parser.acorn={Parser:Parser,version:version,defaultOptions:defaultOptions,Position:Position,SourceLocation:SourceLocation,getLineInfo:getLineInfo,Node:Node,TokenType:TokenType,tokTypes:types$1,keywordTypes:keywords,TokContext:TokContext,tokContexts:types,isIdentifierChar:isIdentifierChar,isIdentifierStart:isIdentifierStart,Token:Token,isNewLine:isNewLine,lineBreak:lineBreak,lineBreakG:lineBreakG,nonASCIIwhitespace:nonASCIIwhitespace};// The main exported interface (under `self.acorn` when in the\n// browser) is a `parse` function that takes a code string and\n// returns an abstract syntax tree as specified by [Mozilla parser\n// API][api].\n//\n// [api]: https://developer.mozilla.org/en-US/docs/SpiderMonkey/Parser_API\nfunction parse(input,options){return Parser.parse(input,options);}// This function tries to parse a single expression at a given\n// offset in a string. Useful for parsing mixed-language formats\n// that embed JavaScript expressions.\nfunction parseExpressionAt(input,pos,options){return Parser.parseExpressionAt(input,pos,options);}function flatten(nodes){let target=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];for(let i=0;i<nodes.length;i+=1){const node=nodes[i];if(Array.isArray(node)){flatten(node,target);}else{target.push(node);}}return target;}const regex_whitespace=/\\s/;const regex_whitespaces=/\\s+/;const regex_starts_with_whitespace=/^\\s/;const regex_starts_with_whitespaces=/^[ \\t\\r\\n]*/;const regex_ends_with_whitespace=/\\s$/;const regex_ends_with_whitespaces=/[ \\t\\r\\n]*$/;const regex_only_whitespaces=/^\\s+$/;const regex_whitespace_characters=/\\s/g;const regex_non_whitespace_character=/\\S/;const regex_starts_with_newline=/^\\r?\\n/;const regex_not_newline_characters=/[^\\n]/g;const regex_double_quotes=/\"/g;const regex_backslashes=/\\\\/g;const regex_starts_with_underscore=/^_/;const regex_ends_with_underscore=/_$/;const regex_dimensions=/^(?:offset|client)(?:Width|Height)$/;const regex_svelte_ignore=/^\\s*svelte-ignore\\s+([\\s\\S]+)\\s*$/m;function extract_svelte_ignore(text){const match=regex_svelte_ignore.exec(text);return match?match[1].split(regex_whitespace).map(x=>x.trim()).filter(Boolean):[];}function extract_svelte_ignore_from_comments(node){return flatten((node.leadingComments||[]).map(comment=>extract_svelte_ignore(comment.value)));}function extract_ignores_above_position(position,template_nodes){const previous_node_idx=template_nodes.findIndex(child=>child.end===position);if(previous_node_idx===-1){return[];}for(let i=previous_node_idx;i>=0;i--){const node=template_nodes[i];if(node.type!=='Comment'&&node.type!=='Text'){return[];}if(node.type==='Comment'){if(node.ignores.length){return node.ignores;}}}return[];}function fuzzymatch(name,names){const set=new FuzzySet(names);const matches=set.get(name);return matches&&matches[0]&&matches[0][0]>0.7?matches[0][1]:null;}// adapted from https://github.com/Glench/fuzzyset.js/blob/master/lib/fuzzyset.js\n// BSD Licensed\nconst GRAM_SIZE_LOWER=2;const GRAM_SIZE_UPPER=3;// return an edit distance from 0 to 1\nfunction _distance(str1,str2){if(str1===null&&str2===null){throw'Trying to compare two null values';}if(str1===null||str2===null)return 0;str1=String(str1);str2=String(str2);const distance=levenshtein(str1,str2);if(str1.length>str2.length){return 1-distance/str1.length;}else{return 1-distance/str2.length;}}// helper functions\nfunction levenshtein(str1,str2){const current=[];let prev;let value;for(let i=0;i<=str2.length;i++){for(let j=0;j<=str1.length;j++){if(i&&j){if(str1.charAt(j-1)===str2.charAt(i-1)){value=prev;}else{value=Math.min(current[j],current[j-1],prev)+1;}}else{value=i+j;}prev=current[j];current[j]=value;}}return current.pop();}const non_word_regex=/[^\\w, ]+/;function iterate_grams(value){let gram_size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;const simplified='-'+value.toLowerCase().replace(non_word_regex,'')+'-';const len_diff=gram_size-simplified.length;const results=[];if(len_diff>0){for(let i=0;i<len_diff;++i){value+='-';}}for(let i=0;i<simplified.length-gram_size+1;++i){results.push(simplified.slice(i,i+gram_size));}return results;}function gram_counter(value){let gram_size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;// return an object where key=gram, value=number of occurrences\nconst result={};const grams=iterate_grams(value,gram_size);let i=0;for(i;i<grams.length;++i){if(grams[i]in result){result[grams[i]]+=1;}else{result[grams[i]]=1;}}return result;}function sort_descending(a,b){return b[0]-a[0];}class FuzzySet{constructor(arr){this.exact_set={};this.match_dict={};this.items={};// initialization\nfor(let i=GRAM_SIZE_LOWER;i<GRAM_SIZE_UPPER+1;++i){this.items[i]=[];}// add all the items to the set\nfor(let i=0;i<arr.length;++i){this.add(arr[i]);}}add(value){const normalized_value=value.toLowerCase();if(normalized_value in this.exact_set){return false;}let i=GRAM_SIZE_LOWER;for(i;i<GRAM_SIZE_UPPER+1;++i){this._add(value,i);}}_add(value,gram_size){const normalized_value=value.toLowerCase();const items=this.items[gram_size]||[];const index=items.length;items.push(0);const gram_counts=gram_counter(normalized_value,gram_size);let sum_of_square_gram_counts=0;let gram;let gram_count;for(gram in gram_counts){gram_count=gram_counts[gram];sum_of_square_gram_counts+=Math.pow(gram_count,2);if(gram in this.match_dict){this.match_dict[gram].push([index,gram_count]);}else{this.match_dict[gram]=[[index,gram_count]];}}const vector_normal=Math.sqrt(sum_of_square_gram_counts);items[index]=[vector_normal,normalized_value];this.items[gram_size]=items;this.exact_set[normalized_value]=value;}get(value){const normalized_value=value.toLowerCase();const result=this.exact_set[normalized_value];if(result){return[[1,result]];}let results=[];// start with high gram size and if there are no results, go to lower gram sizes\nfor(let gram_size=GRAM_SIZE_UPPER;gram_size>=GRAM_SIZE_LOWER;--gram_size){results=this.__get(value,gram_size);if(results){return results;}}return null;}__get(value,gram_size){const normalized_value=value.toLowerCase();const matches={};const gram_counts=gram_counter(normalized_value,gram_size);const items=this.items[gram_size];let sum_of_square_gram_counts=0;let gram;let gram_count;let i;let index;let other_gram_count;for(gram in gram_counts){gram_count=gram_counts[gram];sum_of_square_gram_counts+=Math.pow(gram_count,2);if(gram in this.match_dict){for(i=0;i<this.match_dict[gram].length;++i){index=this.match_dict[gram][i][0];other_gram_count=this.match_dict[gram][i][1];if(index in matches){matches[index]+=gram_count*other_gram_count;}else{matches[index]=gram_count*other_gram_count;}}}}const vector_normal=Math.sqrt(sum_of_square_gram_counts);let results=[];let match_score;// build a results list of [score, str]\nfor(const match_index in matches){match_score=matches[match_index];results.push([match_score/(vector_normal*items[match_index][0]),items[match_index][1]]);}results.sort(sort_descending);let new_results=[];const end_index=Math.min(50,results.length);// truncate somewhat arbitrarily to 50\nfor(let i=0;i<end_index;++i){new_results.push([_distance(results[i][1],normalized_value),results[i][1]]);}results=new_results;results.sort(sort_descending);new_results=[];for(let i=0;i<results.length;++i){if(results[i][0]==results[0][0]){new_results.push([results[i][0],this.exact_set[results[i][1]]]);}}return new_results;}}/** regex of all html void element names */const void_element_names=/^(?:area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/;/** regex of all html element names. svg and math are omitted because they belong to the svg elements namespace */const html_element_names=/^(?:a|abbr|address|area|article|aside|audio|b|base|bdi|bdo|blockquote|body|br|button|canvas|caption|cite|code|col|colgroup|data|datalist|dd|del|details|dfn|dialog|div|dl|dt|em|embed|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|head|header|hr|html|i|iframe|img|input|ins|kbd|label|legend|li|link|main|map|mark|meta|meter|nav|noscript|object|ol|optgroup|option|output|p|param|picture|pre|progress|q|rp|rt|ruby|s|samp|script|section|select|small|source|span|strong|style|sub|summary|sup|table|tbody|td|template|textarea|tfoot|th|thead|time|title|tr|track|u|ul|var|video|wbr)$/;/** regex of all svg element names */const svg=/^(?:altGlyph|altGlyphDef|altGlyphItem|animate|animateColor|animateMotion|animateTransform|circle|clipPath|color-profile|cursor|defs|desc|discard|ellipse|feBlend|feColorMatrix|feComponentTransfer|feComposite|feConvolveMatrix|feDiffuseLighting|feDisplacementMap|feDistantLight|feDropShadow|feFlood|feFuncA|feFuncB|feFuncG|feFuncR|feGaussianBlur|feImage|feMerge|feMergeNode|feMorphology|feOffset|fePointLight|feSpecularLighting|feSpotLight|feTile|feTurbulence|filter|font|font-face|font-face-format|font-face-name|font-face-src|font-face-uri|foreignObject|g|glyph|glyphRef|hatch|hatchpath|hkern|image|line|linearGradient|marker|mask|mesh|meshgradient|meshpatch|meshrow|metadata|missing-glyph|mpath|path|pattern|polygon|polyline|radialGradient|rect|set|solidcolor|stop|svg|switch|symbol|text|textPath|tref|tspan|unknown|use|view|vkern)$/;function is_void(name){return void_element_names.test(name)||name.toLowerCase()==='!doctype';}function is_html(name){return html_element_names.test(name);}function is_svg(name){return svg.test(name);}function list$1(items){let conjunction=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'or';if(items.length===1)return items[0];return`${items.slice(0,-1).join(', ')} ${conjunction} ${items[items.length-1]}`;}// All parser errors should be listed and accessed from here\n/**\n * @internal\n */var parser_errors={css_syntax_error:message=>({code:'css-syntax-error',message}),duplicate_attribute:{code:'duplicate-attribute',message:'Attributes need to be unique'},duplicate_element:(slug,name)=>({code:`duplicate-${slug}`,message:`A component can only have one <${name}> tag`}),duplicate_style:{code:'duplicate-style',message:'You can only have one top-level <style> tag per component'},empty_attribute_shorthand:{code:'empty-attribute-shorthand',message:'Attribute shorthand cannot be empty'},empty_directive_name:type=>({code:'empty-directive-name',message:`${type} name cannot be empty`}),empty_global_selector:{code:'css-syntax-error',message:':global() must contain a selector'},expected_block_type:{code:'expected-block-type',message:'Expected if, each or await'},expected_name:{code:'expected-name',message:'Expected name'},invalid_catch_placement_unclosed_block:block=>({code:'invalid-catch-placement',message:`Expected to close ${block} before seeing {:catch} block`}),invalid_catch_placement_without_await:{code:'invalid-catch-placement',message:'Cannot have an {:catch} block outside an {#await ...} block'},invalid_component_definition:{code:'invalid-component-definition',message:'invalid component definition'},invalid_closing_tag_unopened:name=>({code:'invalid-closing-tag',message:`</${name}> attempted to close an element that was not open`}),invalid_closing_tag_autoclosed:(name,reason)=>({code:'invalid-closing-tag',message:`</${name}> attempted to close <${name}> that was already automatically closed by <${reason}>`}),invalid_debug_args:{code:'invalid-debug-args',message:'{@debug ...} arguments must be identifiers, not arbitrary expressions'},invalid_declaration:{code:'invalid-declaration',message:'Declaration cannot be empty'},invalid_directive_value:{code:'invalid-directive-value',message:'Directive value must be a JavaScript expression enclosed in curly braces'},invalid_elseif:{code:'invalid-elseif',message:'\\'elseif\\' should be \\'else if\\''},invalid_elseif_placement_outside_if:{code:'invalid-elseif-placement',message:'Cannot have an {:else if ...} block outside an {#if ...} block'},invalid_elseif_placement_unclosed_block:block=>({code:'invalid-elseif-placement',message:`Expected to close ${block} before seeing {:else if ...} block`}),invalid_else_placement_outside_if:{code:'invalid-else-placement',message:'Cannot have an {:else} block outside an {#if ...} or {#each ...} block'},invalid_else_placement_unclosed_block:block=>({code:'invalid-else-placement',message:`Expected to close ${block} before seeing {:else} block`}),invalid_element_content:(slug,name)=>({code:`invalid-${slug}-content`,message:`<${name}> cannot have children`}),invalid_element_definition:{code:'invalid-element-definition',message:'Invalid element definition'},invalid_element_placement:(slug,name)=>({code:`invalid-${slug}-placement`,message:`<${name}> tags cannot be inside elements or blocks`}),invalid_logic_block_placement:(location,name)=>({code:'invalid-logic-block-placement',message:`{#${name}} logic block cannot be ${location}`}),invalid_tag_placement:(location,name)=>({code:'invalid-tag-placement',message:`{@${name}} tag cannot be ${location}`}),invalid_ref_directive:name=>({code:'invalid-ref-directive',message:`The ref directive is no longer supported — use \\`bind:this={${name}}\\` instead`}),invalid_ref_selector:{code:'invalid-ref-selector',message:'ref selectors are no longer supported'},invalid_self_placement:{code:'invalid-self-placement',message:'<svelte:self> components can only exist inside {#if} blocks, {#each} blocks, or slots passed to components'},invalid_script_instance:{code:'invalid-script',message:'A component can only have one instance-level <script> element'},invalid_script_module:{code:'invalid-script',message:'A component can only have one <script context=\"module\"> element'},invalid_script_context_attribute:{code:'invalid-script',message:'context attribute must be static'},invalid_script_context_value:{code:'invalid-script',message:'If the context attribute is supplied, its value must be \"module\"'},invalid_tag_name:{code:'invalid-tag-name',message:'Expected valid tag name'},invalid_tag_name_svelte_element:(tags,match)=>({code:'invalid-tag-name',message:`Valid <svelte:...> tag names are ${list$1(tags)}${match?' (did you mean '+match+'?)':''}`}),invalid_then_placement_unclosed_block:block=>({code:'invalid-then-placement',message:`Expected to close ${block} before seeing {:then} block`}),invalid_then_placement_without_await:{code:'invalid-then-placement',message:'Cannot have an {:then} block outside an {#await ...} block'},invalid_void_content:name=>({code:'invalid-void-content',message:`<${name}> is a void element and cannot have children, or a closing tag`}),missing_component_definition:{code:'missing-component-definition',message:'<svelte:component> must have a \\'this\\' attribute'},missing_attribute_value:{code:'missing-attribute-value',message:'Expected value for the attribute'},missing_element_definition:{code:'missing-element-definition',message:'<svelte:element> must have a \\'this\\' attribute'},unclosed_script:{code:'unclosed-script',message:'<script> must have a closing tag'},unclosed_style:{code:'unclosed-style',message:'<style> must have a closing tag'},unclosed_comment:{code:'unclosed-comment',message:'comment was left open, expected -->'},unclosed_attribute_value:token=>({code:'unclosed-attribute-value',message:`Expected to close the attribute value with ${token}`}),unexpected_block_close:{code:'unexpected-block-close',message:'Unexpected block closing tag'},unexpected_eof:{code:'unexpected-eof',message:'Unexpected end of input'},unexpected_eof_token:token=>({code:'unexpected-eof',message:`Unexpected ${token}`}),unexpected_token:token=>({code:'unexpected-token',message:`Expected ${token}`}),unexpected_token_destructure:{code:'unexpected-token',message:'Expected identifier or destructure pattern'}};// @ts-check\n/** @typedef { import('estree').BaseNode} BaseNode */ /** @typedef {{\n\tskip: () => void;\n\tremove: () => void;\n\treplace: (node: BaseNode) => void;\n}} WalkerContext */class WalkerBase{constructor(){/** @type {boolean} */this.should_skip=false;/** @type {boolean} */this.should_remove=false;/** @type {BaseNode | null} */this.replacement=null;/** @type {WalkerContext} */this.context={skip:()=>this.should_skip=true,remove:()=>this.should_remove=true,replace:node=>this.replacement=node};}/**\n\t *\n\t * @param {any} parent\n\t * @param {string} prop\n\t * @param {number} index\n\t * @param {BaseNode} node\n\t */replace(parent,prop,index,node){if(parent){if(index!==null){parent[prop][index]=node;}else{parent[prop]=node;}}}/**\n\t *\n\t * @param {any} parent\n\t * @param {string} prop\n\t * @param {number} index\n\t */remove(parent,prop,index){if(parent){if(index!==null){parent[prop].splice(index,1);}else{delete parent[prop];}}}}// @ts-check\n/** @typedef { import('estree').BaseNode} BaseNode */ /** @typedef { import('./walker.js').WalkerContext} WalkerContext */ /** @typedef {(\n *    this: WalkerContext,\n *    node: BaseNode,\n *    parent: BaseNode,\n *    key: string,\n *    index: number\n * ) => void} SyncHandler */class SyncWalker extends WalkerBase{/**\n\t *\n\t * @param {SyncHandler} enter\n\t * @param {SyncHandler} leave\n\t */constructor(enter,leave){super();/** @type {SyncHandler} */this.enter=enter;/** @type {SyncHandler} */this.leave=leave;}/**\n\t *\n\t * @param {BaseNode} node\n\t * @param {BaseNode} parent\n\t * @param {string} [prop]\n\t * @param {number} [index]\n\t * @returns {BaseNode}\n\t */visit(node,parent,prop,index){if(node){if(this.enter){const _should_skip=this.should_skip;const _should_remove=this.should_remove;const _replacement=this.replacement;this.should_skip=false;this.should_remove=false;this.replacement=null;this.enter.call(this.context,node,parent,prop,index);if(this.replacement){node=this.replacement;this.replace(parent,prop,index,node);}if(this.should_remove){this.remove(parent,prop,index);}const skipped=this.should_skip;const removed=this.should_remove;this.should_skip=_should_skip;this.should_remove=_should_remove;this.replacement=_replacement;if(skipped)return node;if(removed)return null;}for(const key in node){const value=node[key];if(typeof value!==\"object\"){continue;}else if(Array.isArray(value)){for(let i=0;i<value.length;i+=1){if(value[i]!==null&&typeof value[i].type==='string'){if(!this.visit(value[i],node,key,i)){// removed\ni--;}}}}else if(value!==null&&typeof value.type===\"string\"){this.visit(value,node,key,null);}}if(this.leave){const _replacement=this.replacement;const _should_remove=this.should_remove;this.replacement=null;this.should_remove=false;this.leave.call(this.context,node,parent,prop,index);if(this.replacement){node=this.replacement;this.replace(parent,prop,index,node);}if(this.should_remove){this.remove(parent,prop,index);}const removed=this.should_remove;this.replacement=_replacement;this.should_remove=_should_remove;if(removed)return null;}}return node;}}// @ts-check\n/** @typedef { import('estree').BaseNode} BaseNode */ /** @typedef { import('./sync.js').SyncHandler} SyncHandler */ /** @typedef { import('./async.js').AsyncHandler} AsyncHandler */ /**\n *\n * @param {BaseNode} ast\n * @param {{\n *   enter?: SyncHandler\n *   leave?: SyncHandler\n * }} walker\n * @returns {BaseNode}\n */function walk(ast,_ref9){let{enter,leave}=_ref9;const instance=new SyncWalker(enter,leave);return instance.visit(ast,null);}// generate an ID that is, to all intents and purposes, unique\nconst id=Math.round(Math.random()*1e20).toString(36);const re=new RegExp(`_${id}_(?:(\\\\d+)|(AT)|(HASH))_(\\\\w+)?`,'g');/** @typedef {import('estree').Comment} Comment */ /** @typedef {import('estree').Node} Node */ /**\n * @typedef {Node & {\n *   start: number;\n *   end: number;\n *   has_trailing_newline?: boolean\n * }} NodeWithLocation\n */ /**\n * @typedef {Comment & {\n *   start: number;\n *   end: number;\n *   has_trailing_newline?: boolean\n * }} CommentWithLocation\n */ /**\n * @param {CommentWithLocation[]} comments\n * @param {string} raw\n */const get_comment_handlers=(comments,raw)=>({// pass to acorn options\n/**\n\t * @param {boolean} block\n\t * @param {string} value\n\t * @param {number} start\n\t * @param {number} end\n\t */onComment:(block,value,start,end)=>{if(block&&/\\n/.test(value)){let a=start;while(a>0&&raw[a-1]!=='\\n')a-=1;let b=a;while(/[ \\t]/.test(raw[b]))b+=1;const indentation=raw.slice(a,b);value=value.replace(new RegExp(`^${indentation}`,'gm'),'');}comments.push({type:block?'Block':'Line',value,start,end});},// pass to estree-walker options\n/** @param {NodeWithLocation} node */enter(node){let comment;while(comments[0]&&comments[0].start<node.start){comment=comments.shift();comment.value=comment.value.replace(re,(match,id,at,hash,value)=>{if(hash)return`#${value}`;if(at)return`@${value}`;return match;});const next=comments[0]||node;comment.has_trailing_newline=comment.type==='Line'||/\\n/.test(raw.slice(comment.end,next.start));(node.leadingComments||(node.leadingComments=[])).push(comment);}},/** @param {NodeWithLocation} node */leave(node){if(comments[0]){const slice=raw.slice(node.end,comments[0].start);if(/^[,) \\t]*$/.test(slice)){node.trailingComments=[comments.shift()];}}}});//@ts-check\n/** @typedef { import('estree').Node} Node */ /** @typedef {Node | {\n *   type: 'PropertyDefinition';\n *   computed: boolean;\n *   value: Node\n * }} NodeWithPropertyDefinition */ /**\n *\n * @param {NodeWithPropertyDefinition} node\n * @param {NodeWithPropertyDefinition} parent\n * @returns boolean\n */function is_reference(node,parent){if(node.type==='MemberExpression'){return!node.computed&&is_reference(node.object,node);}if(node.type==='Identifier'){if(!parent)return true;switch(parent.type){// disregard `bar` in `foo.bar`\ncase'MemberExpression':return parent.computed||node===parent.object;// disregard the `foo` in `class {foo(){}}` but keep it in `class {[foo](){}}`\ncase'MethodDefinition':return parent.computed;// disregard the `foo` in `class {foo=bar}` but keep it in `class {[foo]=bar}` and `class {bar=foo}`\ncase'PropertyDefinition':return parent.computed||node===parent.value;// disregard the `bar` in `{ bar: foo }`, but keep it in `{ [bar]: foo }`\ncase'Property':return parent.computed||node===parent.value;// disregard the `bar` in `export { foo as bar }` or\n// the foo in `import { foo as bar }`\ncase'ExportSpecifier':case'ImportSpecifier':return node===parent.local;// disregard the `foo` in `foo: while (...) { ... break foo; ... continue foo;}`\ncase'LabeledStatement':case'BreakStatement':case'ContinueStatement':return false;default:return true;}}return false;}/** @param {import('estree').Node} expression */function analyze(expression){/** @typedef {import('estree').Node} Node */ /** @type {WeakMap<Node, Scope>} */const map=new WeakMap();/** @type {Map<string, Node>} */const globals=new Map();const scope=new Scope$1(null,false);/** @type {[Scope, import('estree').Identifier][]} */const references=[];let current_scope=scope;walk(expression,{/**\n\t\t * @param {Node} node\n\t\t * @param {any} parent\n\t\t */enter(node,parent){switch(node.type){case'Identifier':if(is_reference(node,parent)){references.push([current_scope,node]);}break;case'ImportDeclaration':node.specifiers.forEach(specifier=>{current_scope.declarations.set(specifier.local.name,specifier);});break;case'FunctionExpression':case'FunctionDeclaration':case'ArrowFunctionExpression':if(node.type==='FunctionDeclaration'){if(node.id){current_scope.declarations.set(node.id.name,node);}map.set(node,current_scope=new Scope$1(current_scope,false));}else{map.set(node,current_scope=new Scope$1(current_scope,false));if(node.type==='FunctionExpression'&&node.id){current_scope.declarations.set(node.id.name,node);}}node.params.forEach(param=>{extract_names(param).forEach(name=>{current_scope.declarations.set(name,node);});});break;case'ForStatement':case'ForInStatement':case'ForOfStatement':map.set(node,current_scope=new Scope$1(current_scope,true));break;case'BlockStatement':map.set(node,current_scope=new Scope$1(current_scope,true));break;case'ClassDeclaration':case'VariableDeclaration':current_scope.add_declaration(node);break;case'CatchClause':map.set(node,current_scope=new Scope$1(current_scope,true));if(node.param){extract_names(node.param).forEach(name=>{current_scope.declarations.set(name,node.param);});}break;}},/** @param {Node} node */leave(node){if(map.has(node)){current_scope=current_scope.parent;}}});for(let i=references.length-1;i>=0;--i){const[scope,reference]=references[i];if(!scope.references.has(reference.name)){add_reference(scope,reference.name);}if(!scope.find_owner(reference.name)){globals.set(reference.name,reference);}}return{map,scope,globals};}/**\n *\n * @param {Scope} scope\n * @param {string} name\n */function add_reference(scope,name){scope.references.add(name);if(scope.parent)add_reference(scope.parent,name);}class Scope$1{constructor(parent,block){/** @type {Scope | null} */this.parent=parent;/** @type {boolean} */this.block=block;/** @type {Map<string, import('estree').Node>} */this.declarations=new Map();/** @type {Set<string>} */this.initialised_declarations=new Set();/** @type {Set<string>} */this.references=new Set();}/** @param {import('estree').VariableDeclaration | import('estree').ClassDeclaration} node */add_declaration(node){if(node.type==='VariableDeclaration'){if(node.kind==='var'&&this.block&&this.parent){this.parent.add_declaration(node);}else{/** @param {import('estree').VariableDeclarator} declarator */const handle_declarator=declarator=>{extract_names(declarator.id).forEach(name=>{this.declarations.set(name,node);if(declarator.init)this.initialised_declarations.add(name);});};node.declarations.forEach(handle_declarator);}}else if(node.id){this.declarations.set(node.id.name,node);}}/**\n\t * @param {string} name\n\t * @returns {Scope | null}\n\t */find_owner(name){if(this.declarations.has(name))return this;return this.parent&&this.parent.find_owner(name);}/**\n\t * @param {string} name\n\t * @returns {boolean}\n\t */has(name){return this.declarations.has(name)||!!this.parent&&this.parent.has(name);}}/**\n * @param {import('estree').Node} param\n * @returns {string[]}\n */function extract_names(param){return extract_identifiers(param).map(node=>node.name);}/**\n * @param {import('estree').Node} param\n * @param {import('estree').Identifier[]} nodes\n * @returns {import('estree').Identifier[]}\n */function extract_identifiers(param){let nodes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];switch(param.type){case'Identifier':nodes.push(param);break;case'MemberExpression':let object=param;while(object.type==='MemberExpression'){object=/** @type {any} */object.object;}nodes.push(/** @type {any} */object);break;case'ObjectPattern':/** @param {import('estree').Property | import('estree').RestElement} prop */const handle_prop=prop=>{if(prop.type==='RestElement'){extract_identifiers(prop.argument,nodes);}else{extract_identifiers(prop.value,nodes);}};param.properties.forEach(handle_prop);break;case'ArrayPattern':/** @param {import('estree').Node} element */const handle_element=element=>{if(element)extract_identifiers(element,nodes);};param.elements.forEach(handle_element);break;case'RestElement':extract_identifiers(param.argument,nodes);break;case'AssignmentPattern':extract_identifiers(param.left,nodes);break;}return nodes;}/**\n * Does `array.push` for all `items`. Needed because `array.push(...items)` throws\n * \"Maximum call stack size exceeded\" when `items` is too big of an array.\n *\n * @param {any[]} array \n * @param {any[]} items \n */function push_array(array,items){for(let i=0;i<items.length;i++){array.push(items[i]);}}// heavily based on https://github.com/davidbonnet/astring\n/** @typedef {import('estree').ArrowFunctionExpression} ArrowFunctionExpression */ /** @typedef {import('estree').BinaryExpression} BinaryExpression */ /** @typedef {import('estree').CallExpression} CallExpression */ /** @typedef {import('estree').Comment} Comment */ /** @typedef {import('estree').ExportSpecifier} ExportSpecifier */ /** @typedef {import('estree').Expression} Expression */ /** @typedef {import('estree').FunctionDeclaration} FunctionDeclaration */ /** @typedef {import('estree').ImportDeclaration} ImportDeclaration */ /** @typedef {import('estree').ImportSpecifier} ImportSpecifier */ /** @typedef {import('estree').Literal} Literal */ /** @typedef {import('estree').LogicalExpression} LogicalExpression */ /** @typedef {import('estree').NewExpression} NewExpression */ /** @typedef {import('estree').Node} Node */ /** @typedef {import('estree').ObjectExpression} ObjectExpression */ /** @typedef {import('estree').Pattern} Pattern */ /** @typedef {import('estree').SequenceExpression} SequenceExpression */ /** @typedef {import('estree').SimpleCallExpression} SimpleCallExpression */ /** @typedef {import('estree').SwitchStatement} SwitchStatement */ /** @typedef {import('estree').VariableDeclaration} VariableDeclaration */ /**\n * @typedef {{\n *   content: string;\n *   loc?: {\n *     start: { line: number; column: number; };\n *     end: { line: number; column: number; };\n *   };\n *   has_newline: boolean;\n * }} Chunk\n */ /**\n * @typedef {(node: any, state: State) => Chunk[]} Handler\n */ /**\n * @typedef {{\n *   indent: string;\n *   scope: any; // TODO import from periscopic\n *   scope_map: WeakMap<Node, any>;\n *   getName: (name: string) => string;\n *   deconflicted: WeakMap<Node, Map<string, string>>;\n *   comments: Comment[];\n * }} State\n */ /**\n * @param {Node} node\n * @param {State} state\n * @returns {Chunk[]}\n */function handle(node,state){const handler=handlers[node.type];if(!handler){throw new Error(`Not implemented ${node.type}`);}const result=handler(node,state);if(node.leadingComments){result.unshift(c(node.leadingComments.map(comment=>comment.type==='Block'?`/*${comment.value}*/${/** @type {any} */comment.has_trailing_newline?`\\n${state.indent}`:` `}`:`//${comment.value}${/** @type {any} */comment.has_trailing_newline?`\\n${state.indent}`:` `}`).join(``)));}if(node.trailingComments){state.comments.push(node.trailingComments[0]);// there is only ever one\n}return result;}/**\n * @param {string} content\n * @param {Node} [node]\n * @returns {Chunk}\n */function c(content,node){return{content,loc:node&&node.loc,has_newline:/\\n/.test(content)};}const OPERATOR_PRECEDENCE={'||':2,'&&':3,'??':4,'|':5,'^':6,'&':7,'==':8,'!=':8,'===':8,'!==':8,'<':9,'>':9,'<=':9,'>=':9,in:9,instanceof:9,'<<':10,'>>':10,'>>>':10,'+':11,'-':11,'*':12,'%':12,'/':12,'**':13};/** @type {Record<string, number>} */const EXPRESSIONS_PRECEDENCE={ArrayExpression:20,TaggedTemplateExpression:20,ThisExpression:20,Identifier:20,Literal:18,TemplateLiteral:20,Super:20,SequenceExpression:20,MemberExpression:19,CallExpression:19,NewExpression:19,AwaitExpression:17,ClassExpression:17,FunctionExpression:17,ObjectExpression:17,UpdateExpression:16,UnaryExpression:15,BinaryExpression:14,LogicalExpression:13,ConditionalExpression:4,ArrowFunctionExpression:3,AssignmentExpression:3,YieldExpression:2,RestElement:1};/**\n *\n * @param {Expression} node\n * @param {BinaryExpression | LogicalExpression} parent\n * @param {boolean} is_right\n * @returns\n */function needs_parens(node,parent,is_right){// special case where logical expressions and coalesce expressions cannot be mixed,\n// either of them need to be wrapped with parentheses\nif(node.type==='LogicalExpression'&&parent.type==='LogicalExpression'&&(parent.operator==='??'&&node.operator!=='??'||parent.operator!=='??'&&node.operator==='??')){return true;}const precedence=EXPRESSIONS_PRECEDENCE[node.type];const parent_precedence=EXPRESSIONS_PRECEDENCE[parent.type];if(precedence!==parent_precedence){// Different node types\nreturn!is_right&&precedence===15&&parent_precedence===14&&parent.operator==='**'||precedence<parent_precedence;}if(precedence!==13&&precedence!==14){// Not a `LogicalExpression` or `BinaryExpression`\nreturn false;}if(/** @type {BinaryExpression} */node.operator==='**'&&parent.operator==='**'){// Exponentiation operator has right-to-left associativity\nreturn!is_right;}if(is_right){// Parenthesis are used if both operators have the same precedence\nreturn OPERATOR_PRECEDENCE[/** @type {BinaryExpression} */node.operator]<=OPERATOR_PRECEDENCE[parent.operator];}return OPERATOR_PRECEDENCE[/** @type {BinaryExpression} */node.operator]<OPERATOR_PRECEDENCE[parent.operator];}/** @param {Node} node */function has_call_expression(node){while(node){if(node.type[0]==='CallExpression'){return true;}else if(node.type==='MemberExpression'){node=node.object;}else{return false;}}}/** @param {Chunk[]} chunks */const has_newline=chunks=>{for(let i=0;i<chunks.length;i+=1){if(chunks[i].has_newline)return true;}return false;};/** @param {Chunk[]} chunks */const get_length=chunks=>{let total=0;for(let i=0;i<chunks.length;i+=1){total+=chunks[i].content.length;}return total;};/**\n * @param {number} a\n * @param {number} b\n */const sum=(a,b)=>a+b;/**\n * @param {Chunk[][]} nodes\n * @param {Chunk} separator\n * @returns {Chunk[]}\n */const join=(nodes,separator)=>{if(nodes.length===0)return[];const joined=[...nodes[0]];for(let i=1;i<nodes.length;i+=1){joined.push(separator);push_array(joined,nodes[i]);}return joined;};/**\n * @param {(node: any, state: State) => Chunk[]} fn\n */const scoped=fn=>{/**\n\t * @param {any} node\n\t * @param {State} state\n\t */const scoped_fn=(node,state)=>{return fn(node,{...state,scope:state.scope_map.get(node)});};return scoped_fn;};/**\n * @param {string} name\n * @param {Set<string>} names\n */const deconflict=(name,names)=>{const original=name;let i=1;while(names.has(name)){name=`${original}$${i++}`;}return name;};/**\n * @param {Node[]} nodes\n * @param {State} state\n */const handle_body=(nodes,state)=>{const chunks=[];const body=nodes.map(statement=>{const chunks=handle(statement,{...state,indent:state.indent});let add_newline=false;while(state.comments.length){const comment=state.comments.shift();const prefix=add_newline?`\\n${state.indent}`:` `;chunks.push(c(comment.type==='Block'?`${prefix}/*${comment.value}*/`:`${prefix}//${comment.value}`));add_newline=comment.type==='Line';}return chunks;});let needed_padding=false;for(let i=0;i<body.length;i+=1){const needs_padding=has_newline(body[i]);if(i>0){chunks.push(c(needs_padding||needed_padding?`\\n\\n${state.indent}`:`\\n${state.indent}`));}push_array(chunks,body[i]);needed_padding=needs_padding;}return chunks;};/**\n * @param {VariableDeclaration} node\n * @param {State} state\n */const handle_var_declaration=(node,state)=>{const chunks=[c(`${node.kind} `)];const declarators=node.declarations.map(d=>handle(d,{...state,indent:state.indent+(node.declarations.length===1?'':'\\t')}));const multiple_lines=declarators.some(has_newline)||declarators.map(get_length).reduce(sum,0)+(state.indent.length+declarators.length-1)*2>80;const separator=c(multiple_lines?`,\\n${state.indent}\\t`:', ');push_array(chunks,join(declarators,separator));return chunks;};/** @type {Record<string, Handler>} */const handlers={Program(node,state){return handle_body(node.body,state);},BlockStatement:scoped((node,state)=>{return[c(`{\\n${state.indent}\\t`),...handle_body(node.body,{...state,indent:state.indent+'\\t'}),c(`\\n${state.indent}}`)];}),EmptyStatement(node,state){return[c(';')];},ParenthesizedExpression(node,state){return handle(node.expression,state);},ExpressionStatement(node,state){if(node.expression.type==='AssignmentExpression'&&node.expression.left.type==='ObjectPattern'){// is an AssignmentExpression to an ObjectPattern\nreturn[c('('),...handle(node.expression,state),c(');')];}return[...handle(node.expression,state),c(';')];},IfStatement(node,state){const chunks=[c('if ('),...handle(node.test,state),c(') '),...handle(node.consequent,state)];if(node.alternate){chunks.push(c(' else '));push_array(chunks,handle(node.alternate,state));}return chunks;},LabeledStatement(node,state){return[...handle(node.label,state),c(': '),...handle(node.body,state)];},BreakStatement(node,state){return node.label?[c('break '),...handle(node.label,state),c(';')]:[c('break;')];},ContinueStatement(node,state){return node.label?[c('continue '),...handle(node.label,state),c(';')]:[c('continue;')];},WithStatement(node,state){return[c('with ('),...handle(node.object,state),c(') '),...handle(node.body,state)];},SwitchStatement(/** @type {SwitchStatement} */node,state){const chunks=[c('switch ('),...handle(node.discriminant,state),c(') {')];node.cases.forEach(block=>{if(block.test){chunks.push(c(`\\n${state.indent}\\tcase `));push_array(chunks,handle(block.test,{...state,indent:`${state.indent}\\t`}));chunks.push(c(':'));}else{chunks.push(c(`\\n${state.indent}\\tdefault:`));}block.consequent.forEach(statement=>{chunks.push(c(`\\n${state.indent}\\t\\t`));push_array(chunks,handle(statement,{...state,indent:`${state.indent}\\t\\t`}));});});chunks.push(c(`\\n${state.indent}}`));return chunks;},ReturnStatement(node,state){if(node.argument){const contains_comment=node.argument.leadingComments&&node.argument.leadingComments.some((/** @type import('../utils/comments.js').CommentWithLocation */comment)=>comment.has_trailing_newline);return[c(contains_comment?'return (':'return '),...handle(node.argument,state),c(contains_comment?');':';')];}else{return[c('return;')];}},ThrowStatement(node,state){return[c('throw '),...handle(node.argument,state),c(';')];},TryStatement(node,state){const chunks=[c('try '),...handle(node.block,state)];if(node.handler){if(node.handler.param){chunks.push(c(' catch('));push_array(chunks,handle(node.handler.param,state));chunks.push(c(') '));}else{chunks.push(c(' catch '));}push_array(chunks,handle(node.handler.body,state));}if(node.finalizer){chunks.push(c(' finally '));push_array(chunks,handle(node.finalizer,state));}return chunks;},WhileStatement(node,state){return[c('while ('),...handle(node.test,state),c(') '),...handle(node.body,state)];},DoWhileStatement(node,state){return[c('do '),...handle(node.body,state),c(' while ('),...handle(node.test,state),c(');')];},ForStatement:scoped((node,state)=>{const chunks=[c('for (')];if(node.init){if(node.init.type==='VariableDeclaration'){push_array(chunks,handle_var_declaration(node.init,state));}else{push_array(chunks,handle(node.init,state));}}chunks.push(c('; '));if(node.test)push_array(chunks,handle(node.test,state));chunks.push(c('; '));if(node.update)push_array(chunks,handle(node.update,state));chunks.push(c(') '));push_array(chunks,handle(node.body,state));return chunks;}),ForInStatement:scoped((node,state)=>{const chunks=[c(`for ${node.await?'await ':''}(`)];if(node.left.type==='VariableDeclaration'){push_array(chunks,handle_var_declaration(node.left,state));}else{push_array(chunks,handle(node.left,state));}chunks.push(c(node.type==='ForInStatement'?` in `:` of `));push_array(chunks,handle(node.right,state));chunks.push(c(') '));push_array(chunks,handle(node.body,state));return chunks;}),DebuggerStatement(node,state){return[c('debugger',node),c(';')];},FunctionDeclaration:scoped((/** @type {FunctionDeclaration} */node,state)=>{const chunks=[];if(node.async)chunks.push(c('async '));chunks.push(c(node.generator?'function* ':'function '));if(node.id)push_array(chunks,handle(node.id,state));chunks.push(c('('));const params=node.params.map(p=>handle(p,{...state,indent:state.indent+'\\t'}));const multiple_lines=params.some(has_newline)||params.map(get_length).reduce(sum,0)+(state.indent.length+params.length-1)*2>80;const separator=c(multiple_lines?`,\\n${state.indent}`:', ');if(multiple_lines){chunks.push(c(`\\n${state.indent}\\t`));push_array(chunks,join(params,separator));chunks.push(c(`\\n${state.indent}`));}else{push_array(chunks,join(params,separator));}chunks.push(c(') '));push_array(chunks,handle(node.body,state));return chunks;}),VariableDeclaration(node,state){return handle_var_declaration(node,state).concat(c(';'));},VariableDeclarator(node,state){if(node.init){return[...handle(node.id,state),c(' = '),...handle(node.init,state)];}else{return handle(node.id,state);}},ClassDeclaration(node,state){const chunks=[c('class ')];if(node.id){push_array(chunks,handle(node.id,state));chunks.push(c(' '));}if(node.superClass){chunks.push(c('extends '));push_array(chunks,handle(node.superClass,state));chunks.push(c(' '));}push_array(chunks,handle(node.body,state));return chunks;},ImportDeclaration(/** @type {ImportDeclaration} */node,state){const chunks=[c('import ')];const{length}=node.specifiers;const source=handle(node.source,state);if(length>0){let i=0;while(i<length){if(i>0){chunks.push(c(', '));}const specifier=node.specifiers[i];if(specifier.type==='ImportDefaultSpecifier'){chunks.push(c(specifier.local.name,specifier));i+=1;}else if(specifier.type==='ImportNamespaceSpecifier'){chunks.push(c('* as '+specifier.local.name,specifier));i+=1;}else{break;}}if(i<length){// we have named specifiers\nconst specifiers=node.specifiers.slice(i).map((/** @type {ImportSpecifier} */specifier)=>{const name=handle(specifier.imported,state)[0];const as=handle(specifier.local,state)[0];if(name.content===as.content){return[as];}return[name,c(' as '),as];});const width=get_length(chunks)+specifiers.map(get_length).reduce(sum,0)+2*specifiers.length+6+get_length(source);if(width>80){chunks.push(c(`{\\n\\t`));push_array(chunks,join(specifiers,c(',\\n\\t')));chunks.push(c('\\n}'));}else{chunks.push(c(`{ `));push_array(chunks,join(specifiers,c(', ')));chunks.push(c(' }'));}}chunks.push(c(' from '));}push_array(chunks,source);chunks.push(c(';'));return chunks;},ImportExpression(node,state){return[c('import('),...handle(node.source,state),c(')')];},ExportDefaultDeclaration(node,state){const chunks=[c(`export default `),...handle(node.declaration,state)];if(node.declaration.type!=='FunctionDeclaration'){chunks.push(c(';'));}return chunks;},ExportNamedDeclaration(node,state){const chunks=[c('export ')];if(node.declaration){push_array(chunks,handle(node.declaration,state));}else{const specifiers=node.specifiers.map((/** @type {ExportSpecifier} */specifier)=>{const name=handle(specifier.local,state)[0];const as=handle(specifier.exported,state)[0];if(name.content===as.content){return[name];}return[name,c(' as '),as];});const width=7+specifiers.map(get_length).reduce(sum,0)+2*specifiers.length;if(width>80){chunks.push(c('{\\n\\t'));push_array(chunks,join(specifiers,c(',\\n\\t')));chunks.push(c('\\n}'));}else{chunks.push(c('{ '));push_array(chunks,join(specifiers,c(', ')));chunks.push(c(' }'));}if(node.source){chunks.push(c(' from '));push_array(chunks,handle(node.source,state));}}chunks.push(c(';'));return chunks;},ExportAllDeclaration(node,state){return[c(`export * from `),...handle(node.source,state),c(`;`)];},MethodDefinition(node,state){const chunks=[];if(node.static){chunks.push(c('static '));}if(node.kind==='get'||node.kind==='set'){// Getter or setter\nchunks.push(c(node.kind+' '));}if(node.value.async){chunks.push(c('async '));}if(node.value.generator){chunks.push(c('*'));}if(node.computed){chunks.push(c('['));push_array(chunks,handle(node.key,state));chunks.push(c(']'));}else{push_array(chunks,handle(node.key,state));}chunks.push(c('('));const{params}=node.value;for(let i=0;i<params.length;i+=1){push_array(chunks,handle(params[i],state));if(i<params.length-1)chunks.push(c(', '));}chunks.push(c(') '));push_array(chunks,handle(node.value.body,state));return chunks;},ArrowFunctionExpression:scoped((/** @type {ArrowFunctionExpression} */node,state)=>{const chunks=[];if(node.async)chunks.push(c('async '));if(node.params.length===1&&node.params[0].type==='Identifier'){push_array(chunks,handle(node.params[0],state));}else{const params=node.params.map(param=>handle(param,{...state,indent:state.indent+'\\t'}));chunks.push(c('('));push_array(chunks,join(params,c(', ')));chunks.push(c(')'));}chunks.push(c(' => '));if(node.body.type==='ObjectExpression'||node.body.type==='AssignmentExpression'&&node.body.left.type==='ObjectPattern'){chunks.push(c('('));push_array(chunks,handle(node.body,state));chunks.push(c(')'));}else{push_array(chunks,handle(node.body,state));}return chunks;}),ThisExpression(node,state){return[c('this',node)];},Super(node,state){return[c('super',node)];},RestElement(node,state){return[c('...'),...handle(node.argument,state)];},YieldExpression(node,state){if(node.argument){return[c(node.delegate?`yield* `:`yield `),...handle(node.argument,state)];}return[c(node.delegate?`yield*`:`yield`)];},AwaitExpression(node,state){if(node.argument){const precedence=EXPRESSIONS_PRECEDENCE[node.argument.type];if(precedence&&precedence<EXPRESSIONS_PRECEDENCE.AwaitExpression){return[c('await ('),...handle(node.argument,state),c(')')];}else{return[c('await '),...handle(node.argument,state)];}}return[c('await')];},TemplateLiteral(node,state){const chunks=[c('`')];const{quasis,expressions}=node;for(let i=0;i<expressions.length;i++){chunks.push(c(quasis[i].value.raw),c('${'));push_array(chunks,handle(expressions[i],state));chunks.push(c('}'));}chunks.push(c(quasis[quasis.length-1].value.raw),c('`'));return chunks;},TaggedTemplateExpression(node,state){return handle(node.tag,state).concat(handle(node.quasi,state));},ArrayExpression(node,state){const chunks=[c('[')];/** @type {Chunk[][]} */const elements=[];/** @type {Chunk[]} */let sparse_commas=[];for(let i=0;i<node.elements.length;i+=1){// can't use map/forEach because of sparse arrays\nconst element=node.elements[i];if(element){elements.push([...sparse_commas,...handle(element,{...state,indent:state.indent+'\\t'})]);sparse_commas=[];}else{sparse_commas.push(c(','));}}const multiple_lines=elements.some(has_newline)||elements.map(get_length).reduce(sum,0)+(state.indent.length+elements.length-1)*2>80;if(multiple_lines){chunks.push(c(`\\n${state.indent}\\t`));push_array(chunks,join(elements,c(`,\\n${state.indent}\\t`)));chunks.push(c(`\\n${state.indent}`));push_array(chunks,sparse_commas);}else{push_array(chunks,join(elements,c(', ')));push_array(chunks,sparse_commas);}chunks.push(c(']'));return chunks;},ObjectExpression(/** @type {ObjectExpression} */node,state){if(node.properties.length===0){return[c('{}')];}let has_inline_comment=false;/** @type {Chunk[]} */const chunks=[];const separator=c(', ');node.properties.forEach((p,i)=>{push_array(chunks,handle(p,{...state,indent:state.indent+'\\t'}));if(state.comments.length){// TODO generalise this, so it works with ArrayExpressions and other things.\n// At present, stuff will just get appended to the closest statement/declaration\nchunks.push(c(', '));while(state.comments.length){const comment=state.comments.shift();chunks.push(c(comment.type==='Block'?`/*${comment.value}*/\\n${state.indent}\\t`:`//${comment.value}\\n${state.indent}\\t`));if(comment.type==='Line'){has_inline_comment=true;}}}else{if(i<node.properties.length-1){chunks.push(separator);}}});const multiple_lines=has_inline_comment||has_newline(chunks)||get_length(chunks)>40;if(multiple_lines){separator.content=`,\\n${state.indent}\\t`;}return[c(multiple_lines?`{\\n${state.indent}\\t`:`{ `),...chunks,c(multiple_lines?`\\n${state.indent}}`:` }`)];},Property(node,state){const value=handle(node.value,state);if(node.key===node.value){return value;}// special case\nif(!node.computed&&node.value.type==='AssignmentPattern'&&node.value.left.type==='Identifier'&&node.value.left.name===node.key.name){return value;}if(!node.computed&&node.value.type==='Identifier'&&(node.key.type==='Identifier'&&node.key.name===value[0].content||node.key.type==='Literal'&&node.key.value===value[0].content)){return value;}const key=handle(node.key,state);if(node.value.type==='FunctionExpression'&&!node.value.id){state={...state,scope:state.scope_map.get(node.value)};const chunks=node.kind!=='init'?[c(`${node.kind} `)]:[];if(node.value.async){chunks.push(c('async '));}if(node.value.generator){chunks.push(c('*'));}push_array(chunks,node.computed?[c('['),...key,c(']')]:key);chunks.push(c('('));push_array(chunks,join(node.value.params.map((/** @type {Pattern} */param)=>handle(param,state)),c(', ')));chunks.push(c(') '));push_array(chunks,handle(node.value.body,state));return chunks;}if(node.computed){return[c('['),...key,c(']: '),...value];}return[...key,c(': '),...value];},ObjectPattern(node,state){const chunks=[c('{ ')];for(let i=0;i<node.properties.length;i+=1){push_array(chunks,handle(node.properties[i],state));if(i<node.properties.length-1)chunks.push(c(', '));}chunks.push(c(' }'));return chunks;},SequenceExpression(/** @type {SequenceExpression} */node,state){const expressions=node.expressions.map(e=>handle(e,state));return[c('('),...join(expressions,c(', ')),c(')')];},UnaryExpression(node,state){const chunks=[c(node.operator)];if(node.operator.length>1){chunks.push(c(' '));}if(EXPRESSIONS_PRECEDENCE[node.argument.type]<EXPRESSIONS_PRECEDENCE.UnaryExpression){chunks.push(c('('));push_array(chunks,handle(node.argument,state));chunks.push(c(')'));}else{push_array(chunks,handle(node.argument,state));}return chunks;},UpdateExpression(node,state){return node.prefix?[c(node.operator),...handle(node.argument,state)]:[...handle(node.argument,state),c(node.operator)];},AssignmentExpression(node,state){return[...handle(node.left,state),c(` ${node.operator||'='} `),...handle(node.right,state)];},BinaryExpression(node,state){/**\n\t\t * @type any[]\n\t\t */const chunks=[];// TODO\n// const is_in = node.operator === 'in';\n// if (is_in) {\n// \t// Avoids confusion in `for` loops initializers\n// \tchunks.push(c('('));\n// }\nif(needs_parens(node.left,node,false)){chunks.push(c('('));push_array(chunks,handle(node.left,state));chunks.push(c(')'));}else{push_array(chunks,handle(node.left,state));}chunks.push(c(` ${node.operator} `));if(needs_parens(node.right,node,true)){chunks.push(c('('));push_array(chunks,handle(node.right,state));chunks.push(c(')'));}else{push_array(chunks,handle(node.right,state));}return chunks;},ConditionalExpression(node,state){/**\n\t\t * @type any[]\n\t\t */const chunks=[];if(EXPRESSIONS_PRECEDENCE[node.test.type]>EXPRESSIONS_PRECEDENCE.ConditionalExpression){push_array(chunks,handle(node.test,state));}else{chunks.push(c('('));push_array(chunks,handle(node.test,state));chunks.push(c(')'));}const child_state={...state,indent:state.indent+'\\t'};const consequent=handle(node.consequent,child_state);const alternate=handle(node.alternate,child_state);const multiple_lines=has_newline(consequent)||has_newline(alternate)||get_length(chunks)+get_length(consequent)+get_length(alternate)>50;if(multiple_lines){chunks.push(c(`\\n${state.indent}? `));push_array(chunks,consequent);chunks.push(c(`\\n${state.indent}: `));push_array(chunks,alternate);}else{chunks.push(c(` ? `));push_array(chunks,consequent);chunks.push(c(` : `));push_array(chunks,alternate);}return chunks;},NewExpression(/** @type {NewExpression} */node,state){const chunks=[c('new ')];if(EXPRESSIONS_PRECEDENCE[node.callee.type]<EXPRESSIONS_PRECEDENCE.CallExpression||has_call_expression(node.callee)){chunks.push(c('('));push_array(chunks,handle(node.callee,state));chunks.push(c(')'));}else{push_array(chunks,handle(node.callee,state));}// TODO this is copied from CallExpression — DRY it out\nconst args=node.arguments.map(arg=>handle(arg,{...state,indent:state.indent+'\\t'}));const separator=args.some(has_newline)// TODO or length exceeds 80\n?c(',\\n'+state.indent):c(', ');chunks.push(c('('));push_array(chunks,join(args,separator));chunks.push(c(')'));return chunks;},ChainExpression(node,state){return handle(node.expression,state);},CallExpression(/** @type {CallExpression} */node,state){/**\n\t\t * @type any[]\n\t\t */const chunks=[];if(EXPRESSIONS_PRECEDENCE[node.callee.type]<EXPRESSIONS_PRECEDENCE.CallExpression){chunks.push(c('('));push_array(chunks,handle(node.callee,state));chunks.push(c(')'));}else{push_array(chunks,handle(node.callee,state));}if(/** @type {SimpleCallExpression} */node.optional){chunks.push(c('?.'));}const args=node.arguments.map(arg=>handle(arg,state));const multiple_lines=args.slice(0,-1).some(has_newline);// TODO or length exceeds 80\nif(multiple_lines){// need to handle args again. TODO find alternative approach?\nconst args=node.arguments.map(arg=>handle(arg,{...state,indent:`${state.indent}\\t`}));chunks.push(c(`(\\n${state.indent}\\t`));push_array(chunks,join(args,c(`,\\n${state.indent}\\t`)));chunks.push(c(`\\n${state.indent})`));}else{chunks.push(c('('));push_array(chunks,join(args,c(', ')));chunks.push(c(')'));}return chunks;},MemberExpression(node,state){/**\n\t\t * @type any[]\n\t\t */const chunks=[];if(EXPRESSIONS_PRECEDENCE[node.object.type]<EXPRESSIONS_PRECEDENCE.MemberExpression){chunks.push(c('('));push_array(chunks,handle(node.object,state));chunks.push(c(')'));}else{push_array(chunks,handle(node.object,state));}if(node.computed){if(node.optional){chunks.push(c('?.'));}chunks.push(c('['));push_array(chunks,handle(node.property,state));chunks.push(c(']'));}else{chunks.push(c(node.optional?'?.':'.'));push_array(chunks,handle(node.property,state));}return chunks;},MetaProperty(node,state){return[...handle(node.meta,state),c('.'),...handle(node.property,state)];},Identifier(node,state){let name=node.name;if(name[0]==='@'){name=state.getName(name.slice(1));}else if(node.name[0]==='#'){const owner=state.scope.find_owner(node.name);if(!owner){throw new Error(`Could not find owner for node`);}if(!state.deconflicted.has(owner)){state.deconflicted.set(owner,new Map());}const deconflict_map=state.deconflicted.get(owner);if(!deconflict_map.has(node.name)){deconflict_map.set(node.name,deconflict(node.name.slice(1),owner.references));}name=deconflict_map.get(node.name);}return[c(name,node)];},Literal(/** @type {Literal} */node,state){if(typeof node.value==='string'){return[// TODO do we need to handle weird unicode characters somehow?\n// str.replace(/\\\\u(\\d{4})/g, (m, n) => String.fromCharCode(+n))\nc((node.raw||JSON.stringify(node.value)).replace(re,(_m,_i,at,hash,name)=>{if(at)return'@'+name;if(hash)return'#'+name;throw new Error(`this shouldn't happen`);}),node)];}return[c(node.raw||String(node.value),node)];}};handlers.ForOfStatement=handlers.ForInStatement;handlers.FunctionExpression=handlers.FunctionDeclaration;handlers.ClassExpression=handlers.ClassDeclaration;handlers.ClassBody=handlers.BlockStatement;handlers.SpreadElement=handlers.RestElement;handlers.ArrayPattern=handlers.ArrayExpression;handlers.LogicalExpression=handlers.BinaryExpression;handlers.AssignmentPattern=handlers.AssignmentExpression;var charToInteger={};var chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';for(var i$1=0;i$1<chars.length;i$1++){charToInteger[chars.charCodeAt(i$1)]=i$1;}function decode(mappings){var decoded=[];var line=[];var segment=[0,0,0,0,0];var j=0;for(var i=0,shift=0,value=0;i<mappings.length;i++){var c=mappings.charCodeAt(i);if(c===44){// \",\"\nsegmentify(line,segment,j);j=0;}else if(c===59){// \";\"\nsegmentify(line,segment,j);j=0;decoded.push(line);line=[];segment[0]=0;}else{var integer=charToInteger[c];if(integer===undefined){throw new Error('Invalid character ('+String.fromCharCode(c)+')');}var hasContinuationBit=integer&32;integer&=31;value+=integer<<shift;if(hasContinuationBit){shift+=5;}else{var shouldNegate=value&1;value>>>=1;if(shouldNegate){value=value===0?-0x80000000:-value;}segment[j]+=value;j++;value=shift=0;// reset\n}}}segmentify(line,segment,j);decoded.push(line);return decoded;}function segmentify(line,segment,j){// This looks ugly, but we're creating specialized arrays with a specific\n// length. This is much faster than creating a new array (which v8 expands to\n// a capacity of 17 after pushing the first item), or slicing out a subarray\n// (which is slow). Length 4 is assumed to be the most frequent, followed by\n// length 5 (since not everything will have an associated name), followed by\n// length 1 (it's probably rare for a source substring to not have an\n// associated segment data).\nif(j===4)line.push([segment[0],segment[1],segment[2],segment[3]]);else if(j===5)line.push([segment[0],segment[1],segment[2],segment[3],segment[4]]);else if(j===1)line.push([segment[0]]);}function encode(decoded){var sourceFileIndex=0;// second field\nvar sourceCodeLine=0;// third field\nvar sourceCodeColumn=0;// fourth field\nvar nameIndex=0;// fifth field\nvar mappings='';for(var i=0;i<decoded.length;i++){var line=decoded[i];if(i>0)mappings+=';';if(line.length===0)continue;var generatedCodeColumn=0;// first field\nvar lineMappings=[];for(var _i=0,line_1=line;_i<line_1.length;_i++){var segment=line_1[_i];var segmentMappings=encodeInteger(segment[0]-generatedCodeColumn);generatedCodeColumn=segment[0];if(segment.length>1){segmentMappings+=encodeInteger(segment[1]-sourceFileIndex)+encodeInteger(segment[2]-sourceCodeLine)+encodeInteger(segment[3]-sourceCodeColumn);sourceFileIndex=segment[1];sourceCodeLine=segment[2];sourceCodeColumn=segment[3];}if(segment.length===5){segmentMappings+=encodeInteger(segment[4]-nameIndex);nameIndex=segment[4];}lineMappings.push(segmentMappings);}mappings+=lineMappings.join(',');}return mappings;}function encodeInteger(num){var result='';num=num<0?-num<<1|1:num<<1;do{var clamped=num&31;num>>>=5;if(num>0){clamped|=32;}result+=chars[clamped];}while(num>0);return result;}/** @type {(str?: string) => string} str */let btoa$1=()=>{throw new Error('Unsupported environment: `window.btoa` or `Buffer` should be supported.');};if(typeof window!=='undefined'&&typeof window.btoa==='function'){btoa$1=str=>window.btoa(unescape(encodeURIComponent(str)));}else if(typeof Buffer==='function'){btoa$1=str=>Buffer.from(str,'utf-8').toString('base64');}/** @typedef {import('estree').Node} Node */ /**\n * @typedef {{\n *   file?: string;\n *   sourceMapSource?: string;\n *   sourceMapContent?: string;\n *   sourceMapEncodeMappings?: boolean; // default true\n *   getName?: (name: string) => string;\n * }} PrintOptions\n */ /**\n * @param {Node} node\n * @param {PrintOptions} opts\n * @returns {{ code: string, map: any }} // TODO\n */function print(node){let opts=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(Array.isArray(node)){return print({type:'Program',body:node,sourceType:'module'},opts);}const{getName=/** @param {string} x */x=>{throw new Error(`Unhandled sigil @${x}`);}}=opts;let{map:scope_map,scope}=analyze(node);const deconflicted=new WeakMap();const chunks=handle(node,{indent:'',getName,scope,scope_map,deconflicted,comments:[]});/** @typedef {[number, number, number, number]} Segment */let code='';let current_column=0;/** @type {Segment[][]} */let mappings=[];/** @type {Segment[]} */let current_line=[];for(let i=0;i<chunks.length;i+=1){const chunk=chunks[i];code+=chunk.content;if(chunk.loc){current_line.push([current_column,0,// source index is always zero\nchunk.loc.start.line-1,chunk.loc.start.column]);}for(let i=0;i<chunk.content.length;i+=1){if(chunk.content[i]==='\\n'){mappings.push(current_line);current_line=[];current_column=0;}else{current_column+=1;}}if(chunk.loc){current_line.push([current_column,0,// source index is always zero\nchunk.loc.end.line-1,chunk.loc.end.column]);}}mappings.push(current_line);const map={version:3,/** @type {string[]} */names:[],sources:[opts.sourceMapSource||null],sourcesContent:[opts.sourceMapContent||null],mappings:opts.sourceMapEncodeMappings==undefined||opts.sourceMapEncodeMappings?encode(mappings):mappings};Object.defineProperties(map,{toString:{enumerable:false,value:function toString(){return JSON.stringify(this);}},toUrl:{enumerable:false,value:function toUrl(){return'data:application/json;charset=utf-8;base64,'+btoa$1(this.toString());}}});return{code,map};}/** @typedef {import('estree').Expression} Expression */ /** @typedef {import('estree').Node} Node */ /** @typedef {import('estree').ObjectExpression} ObjectExpression */ /** @typedef {import('estree').Property} Property */ /** @typedef {import('estree').SpreadElement} SpreadElement */ /** @typedef {import('./utils/comments').CommentWithLocation} CommentWithLocation */ /** @type {Record<string, string>} */const sigils={'@':'AT','#':'HASH'};/** @param {TemplateStringsArray} strings */const join$1=strings=>{let str=strings[0];for(let i=1;i<strings.length;i+=1){str+=`_${id}_${i-1}_${strings[i]}`;}return str.replace(/([@#])(\\w+)/g,(_m,sigil,name)=>`_${id}_${sigils[sigil]}_${name}`);};/**\n * @param {any[]} array\n * @param {any[]} target\n */const flatten_body=(array,target)=>{for(let i=0;i<array.length;i+=1){const statement=array[i];if(Array.isArray(statement)){flatten_body(statement,target);continue;}if(statement.type==='ExpressionStatement'){if(statement.expression===EMPTY)continue;if(Array.isArray(statement.expression)){// TODO this is hacktacular\nlet node=statement.expression[0];while(Array.isArray(node))node=node[0];if(node)node.leadingComments=statement.leadingComments;flatten_body(statement.expression,target);continue;}if(/(Expression|Literal)$/.test(statement.expression.type)){target.push(statement);continue;}if(statement.leadingComments)statement.expression.leadingComments=statement.leadingComments;if(statement.trailingComments)statement.expression.trailingComments=statement.trailingComments;target.push(statement.expression);continue;}target.push(statement);}return target;};/**\n * @param {any[]} array\n * @param {any[]} target\n */const flatten_properties=(array,target)=>{for(let i=0;i<array.length;i+=1){const property=array[i];if(property.value===EMPTY)continue;if(property.key===property.value&&Array.isArray(property.key)){flatten_properties(property.key,target);continue;}target.push(property);}return target;};/**\n * @param {any[]} nodes\n * @param {any[]} target\n */const flatten$1=(nodes,target)=>{for(let i=0;i<nodes.length;i+=1){const node=nodes[i];if(node===EMPTY)continue;if(Array.isArray(node)){flatten$1(node,target);continue;}target.push(node);}return target;};const EMPTY={type:'Empty'};/**\n *\n * @param {CommentWithLocation[]} comments\n * @param {string} raw\n * @returns {any}\n */const acorn_opts=(comments,raw)=>{const{onComment}=get_comment_handlers(comments,raw);return{ecmaVersion:2020,sourceType:'module',allowAwaitOutsideFunction:true,allowImportExportEverywhere:true,allowReturnOutsideFunction:true,onComment};};/**\n * @param {string} raw\n * @param {Node} node\n * @param {any[]} values\n * @param {CommentWithLocation[]} comments\n */const inject=(raw,node,values,comments)=>{comments.forEach(comment=>{comment.value=comment.value.replace(re,(m,i)=>+i in values?values[+i]:m);});const{enter,leave}=get_comment_handlers(comments,raw);return walk(node,{enter,/** @param {any} node */leave(node){if(node.type==='Identifier'){re.lastIndex=0;const match=re.exec(node.name);if(match){if(match[1]){if(+match[1]in values){let value=values[+match[1]];if(typeof value==='string'){value={type:'Identifier',name:value,leadingComments:node.leadingComments,trailingComments:node.trailingComments};}else if(typeof value==='number'){value={type:'Literal',value,leadingComments:node.leadingComments,trailingComments:node.trailingComments};}this.replace(value||EMPTY);}}else{node.name=`${match[2]?`@`:`#`}${match[4]}`;}}}if(node.type==='Literal'){if(typeof node.value==='string'){re.lastIndex=0;const new_value=/** @type {string} */node.value.replace(re,(m,i)=>+i in values?values[+i]:m);const has_changed=new_value!==node.value;node.value=new_value;if(has_changed&&node.raw){// preserve the quotes\nnode.raw=`${node.raw[0]}${JSON.stringify(node.value).slice(1,-1)}${node.raw[node.raw.length-1]}`;}}}if(node.type==='TemplateElement'){re.lastIndex=0;node.value.raw=/** @type {string} */node.value.raw.replace(re,(m,i)=>+i in values?values[+i]:m);}if(node.type==='Program'||node.type==='BlockStatement'){node.body=flatten_body(node.body,[]);}if(node.type==='ObjectExpression'||node.type==='ObjectPattern'){node.properties=flatten_properties(node.properties,[]);}if(node.type==='ArrayExpression'||node.type==='ArrayPattern'){node.elements=flatten$1(node.elements,[]);}if(node.type==='FunctionExpression'||node.type==='FunctionDeclaration'||node.type==='ArrowFunctionExpression'){node.params=flatten$1(node.params,[]);}if(node.type==='CallExpression'||node.type==='NewExpression'){node.arguments=flatten$1(node.arguments,[]);}if(node.type==='ImportDeclaration'||node.type==='ExportNamedDeclaration'){node.specifiers=flatten$1(node.specifiers,[]);}if(node.type==='ForStatement'){node.init=node.init===EMPTY?null:node.init;node.test=node.test===EMPTY?null:node.test;node.update=node.update===EMPTY?null:node.update;}leave(node);}});};/**\n *\n * @param {TemplateStringsArray} strings\n * @param  {any[]} values\n * @returns {Node[]}\n */function b(strings){const str=join$1(strings);/** @type {CommentWithLocation[]} */const comments=[];try{let ast=/** @type {any} */parse(str,acorn_opts(comments,str));for(var _len=arguments.length,values=new Array(_len>1?_len-1:0),_key2=1;_key2<_len;_key2++){values[_key2-1]=arguments[_key2];}ast=inject(str,ast,values,comments);return ast.body;}catch(err){handle_error(str,err);}}/**\n *\n * @param {TemplateStringsArray} strings\n * @param  {any[]} values\n * @returns {Expression & { start: Number, end: number }}\n */function x(strings){const str=join$1(strings);/** @type {CommentWithLocation[]} */const comments=[];try{let expression=/** @type {Expression & { start: Number, end: number }} */parseExpressionAt(str,0,acorn_opts(comments,str));const match=/\\S+/.exec(str.slice(expression.end));if(match){throw new Error(`Unexpected token '${match[0]}'`);}for(var _len2=arguments.length,values=new Array(_len2>1?_len2-1:0),_key3=1;_key3<_len2;_key3++){values[_key3-1]=arguments[_key3];}expression=/** @type {Expression & { start: Number, end: number }} */inject(str,expression,values,comments);return expression;}catch(err){handle_error(str,err);}}/**\n *\n * @param {TemplateStringsArray} strings\n * @param  {any[]} values\n * @returns {(Property | SpreadElement) & { start: Number, end: number }}\n */function p(strings){const str=`{${join$1(strings)}}`;/** @type {CommentWithLocation[]} */const comments=[];try{let expression=/** @type {any} */parseExpressionAt(str,0,acorn_opts(comments,str));for(var _len3=arguments.length,values=new Array(_len3>1?_len3-1:0),_key4=1;_key4<_len3;_key4++){values[_key4-1]=arguments[_key4];}expression=inject(str,expression,values,comments);return expression.properties[0];}catch(err){handle_error(str,err);}}/**\n * @param {string} str\n * @param {Error} err\n */function handle_error(str,err){// TODO location/code frame\nre.lastIndex=0;str=str.replace(re,(m,i,at,hash,name)=>{if(at)return`@${name}`;if(hash)return`#${name}`;return'${...}';});console.log(`failed to parse:\\n${str}`);throw err;}/**\n * @param {string} source\n * @param {any} opts\n */const parse$1=(source,opts)=>{/** @type {CommentWithLocation[]} */const comments=[];const{onComment,enter,leave}=get_comment_handlers(comments,source);const ast=/** @type {any} */parse(source,{onComment,...opts});walk(ast,{enter,leave});return ast;};/**\n * @param {string} source\n * @param {number} index\n * @param {any} opts\n */const parseExpressionAt$1=(source,index,opts)=>{/** @type {CommentWithLocation[]} */const comments=[];const{onComment,enter,leave}=get_comment_handlers(comments,source);const ast=/** @type {any} */parseExpressionAt(source,index,{onComment,...opts});walk(ast,{enter,leave});return ast;};const parse$2=source=>parse$1(source,{sourceType:'module',ecmaVersion:12,locations:true});const parse_expression_at=(source,index)=>parseExpressionAt$1(source,index,{sourceType:'module',ecmaVersion:12,locations:true});function read_expression(parser){try{const node=parse_expression_at(parser.template,parser.index);let num_parens=0;for(let i=parser.index;i<node.start;i+=1){if(parser.template[i]==='(')num_parens+=1;}let index=node.end;while(num_parens>0){const char=parser.template[index];if(char===')'){num_parens-=1;}else if(!regex_whitespace.test(char)){parser.error(parser_errors.unexpected_token(')'),index);}index+=1;}parser.index=index;return node;}catch(err){parser.acorn_error(err);}}const regex_closing_script_tag=/<\\/script\\s*>/;function get_context(parser,attributes,start){const context=attributes.find(attribute=>attribute.name==='context');if(!context)return'default';if(context.value.length!==1||context.value[0].type!=='Text'){parser.error(parser_errors.invalid_script_context_attribute,start);}const value=context.value[0].data;if(value!=='module'){parser.error(parser_errors.invalid_script_context_value,context.start);}return value;}function read_script(parser,start,attributes){const script_start=parser.index;const data=parser.read_until(regex_closing_script_tag,parser_errors.unclosed_script);if(parser.index>=parser.template.length){parser.error(parser_errors.unclosed_script);}const source=parser.template.slice(0,script_start).replace(regex_not_newline_characters,' ')+data;parser.read(regex_closing_script_tag);let ast;try{ast=parse$2(source);}catch(err){parser.acorn_error(err);}// TODO is this necessary?\nast.start=script_start;return{type:'Script',start,end:parser.index,context:get_context(parser,attributes,start),content:ast};}var MIN_SIZE=16*1024;var SafeUint32Array=typeof Uint32Array!=='undefined'?Uint32Array:Array;// fallback on Array when TypedArray is not supported\nvar adoptBuffer=function adoptBuffer(buffer,size){if(buffer===null||buffer.length<size){return new SafeUint32Array(Math.max(size+1024,MIN_SIZE));}return buffer;};// CSS Syntax Module Level 3\n// https://www.w3.org/TR/css-syntax-3/\nvar TYPE={EOF:0,// <EOF-token>\nIdent:1,// <ident-token>\nFunction:2,// <function-token>\nAtKeyword:3,// <at-keyword-token>\nHash:4,// <hash-token>\nString:5,// <string-token>\nBadString:6,// <bad-string-token>\nUrl:7,// <url-token>\nBadUrl:8,// <bad-url-token>\nDelim:9,// <delim-token>\nNumber:10,// <number-token>\nPercentage:11,// <percentage-token>\nDimension:12,// <dimension-token>\nWhiteSpace:13,// <whitespace-token>\nCDO:14,// <CDO-token>\nCDC:15,// <CDC-token>\nColon:16,// <colon-token>     :\nSemicolon:17,// <semicolon-token> ;\nComma:18,// <comma-token>     ,\nLeftSquareBracket:19,// <[-token>\nRightSquareBracket:20,// <]-token>\nLeftParenthesis:21,// <(-token>\nRightParenthesis:22,// <)-token>\nLeftCurlyBracket:23,// <{-token>\nRightCurlyBracket:24,// <}-token>\nComment:25};var NAME=Object.keys(TYPE).reduce(function(result,key){result[TYPE[key]]=key;return result;},{});var _const={TYPE:TYPE,NAME:NAME};var EOF=0;// https://drafts.csswg.org/css-syntax-3/\n// § 4.2. Definitions\n// digit\n// A code point between U+0030 DIGIT ZERO (0) and U+0039 DIGIT NINE (9).\nfunction isDigit(code){return code>=0x0030&&code<=0x0039;}// hex digit\n// A digit, or a code point between U+0041 LATIN CAPITAL LETTER A (A) and U+0046 LATIN CAPITAL LETTER F (F),\n// or a code point between U+0061 LATIN SMALL LETTER A (a) and U+0066 LATIN SMALL LETTER F (f).\nfunction isHexDigit$1(code){return isDigit(code)||// 0 .. 9\ncode>=0x0041&&code<=0x0046||// A .. F\ncode>=0x0061&&code<=0x0066// a .. f\n;}// uppercase letter\n// A code point between U+0041 LATIN CAPITAL LETTER A (A) and U+005A LATIN CAPITAL LETTER Z (Z).\nfunction isUppercaseLetter(code){return code>=0x0041&&code<=0x005A;}// lowercase letter\n// A code point between U+0061 LATIN SMALL LETTER A (a) and U+007A LATIN SMALL LETTER Z (z).\nfunction isLowercaseLetter(code){return code>=0x0061&&code<=0x007A;}// letter\n// An uppercase letter or a lowercase letter.\nfunction isLetter(code){return isUppercaseLetter(code)||isLowercaseLetter(code);}// non-ASCII code point\n// A code point with a value equal to or greater than U+0080 <control>.\nfunction isNonAscii(code){return code>=0x0080;}// name-start code point\n// A letter, a non-ASCII code point, or U+005F LOW LINE (_).\nfunction isNameStart(code){return isLetter(code)||isNonAscii(code)||code===0x005F;}// name code point\n// A name-start code point, a digit, or U+002D HYPHEN-MINUS (-).\nfunction isName(code){return isNameStart(code)||isDigit(code)||code===0x002D;}// non-printable code point\n// A code point between U+0000 NULL and U+0008 BACKSPACE, or U+000B LINE TABULATION,\n// or a code point between U+000E SHIFT OUT and U+001F INFORMATION SEPARATOR ONE, or U+007F DELETE.\nfunction isNonPrintable(code){return code>=0x0000&&code<=0x0008||code===0x000B||code>=0x000E&&code<=0x001F||code===0x007F;}// newline\n// U+000A LINE FEED. Note that U+000D CARRIAGE RETURN and U+000C FORM FEED are not included in this definition,\n// as they are converted to U+000A LINE FEED during preprocessing.\n// TODO: we doesn't do a preprocessing, so check a code point for U+000D CARRIAGE RETURN and U+000C FORM FEED\nfunction isNewline(code){return code===0x000A||code===0x000D||code===0x000C;}// whitespace\n// A newline, U+0009 CHARACTER TABULATION, or U+0020 SPACE.\nfunction isWhiteSpace(code){return isNewline(code)||code===0x0020||code===0x0009;}// § 4.3.8. Check if two code points are a valid escape\nfunction isValidEscape(first,second){// If the first code point is not U+005C REVERSE SOLIDUS (\\), return false.\nif(first!==0x005C){return false;}// Otherwise, if the second code point is a newline or EOF, return false.\nif(isNewline(second)||second===EOF){return false;}// Otherwise, return true.\nreturn true;}// § 4.3.9. Check if three code points would start an identifier\nfunction isIdentifierStart$1(first,second,third){// Look at the first code point:\n// U+002D HYPHEN-MINUS\nif(first===0x002D){// If the second code point is a name-start code point or a U+002D HYPHEN-MINUS,\n// or the second and third code points are a valid escape, return true. Otherwise, return false.\nreturn isNameStart(second)||second===0x002D||isValidEscape(second,third);}// name-start code point\nif(isNameStart(first)){// Return true.\nreturn true;}// U+005C REVERSE SOLIDUS (\\)\nif(first===0x005C){// If the first and second code points are a valid escape, return true. Otherwise, return false.\nreturn isValidEscape(first,second);}// anything else\n// Return false.\nreturn false;}// § 4.3.10. Check if three code points would start a number\nfunction isNumberStart(first,second,third){// Look at the first code point:\n// U+002B PLUS SIGN (+)\n// U+002D HYPHEN-MINUS (-)\nif(first===0x002B||first===0x002D){// If the second code point is a digit, return true.\nif(isDigit(second)){return 2;}// Otherwise, if the second code point is a U+002E FULL STOP (.)\n// and the third code point is a digit, return true.\n// Otherwise, return false.\nreturn second===0x002E&&isDigit(third)?3:0;}// U+002E FULL STOP (.)\nif(first===0x002E){// If the second code point is a digit, return true. Otherwise, return false.\nreturn isDigit(second)?2:0;}// digit\nif(isDigit(first)){// Return true.\nreturn 1;}// anything else\n// Return false.\nreturn 0;}//\n// Misc\n//\n// detect BOM (https://en.wikipedia.org/wiki/Byte_order_mark)\nfunction isBOM(code){// UTF-16BE\nif(code===0xFEFF){return 1;}// UTF-16LE\nif(code===0xFFFE){return 1;}return 0;}// Fast code category\n//\n// https://drafts.csswg.org/css-syntax/#tokenizer-definitions\n// > non-ASCII code point\n// >   A code point with a value equal to or greater than U+0080 <control>\n// > name-start code point\n// >   A letter, a non-ASCII code point, or U+005F LOW LINE (_).\n// > name code point\n// >   A name-start code point, a digit, or U+002D HYPHEN-MINUS (-)\n// That means only ASCII code points has a special meaning and we define a maps for 0..127 codes only\nvar CATEGORY=new Array(0x80);charCodeCategory.Eof=0x80;charCodeCategory.WhiteSpace=0x82;charCodeCategory.Digit=0x83;charCodeCategory.NameStart=0x84;charCodeCategory.NonPrintable=0x85;for(var i$2=0;i$2<CATEGORY.length;i$2++){switch(true){case isWhiteSpace(i$2):CATEGORY[i$2]=charCodeCategory.WhiteSpace;break;case isDigit(i$2):CATEGORY[i$2]=charCodeCategory.Digit;break;case isNameStart(i$2):CATEGORY[i$2]=charCodeCategory.NameStart;break;case isNonPrintable(i$2):CATEGORY[i$2]=charCodeCategory.NonPrintable;break;default:CATEGORY[i$2]=i$2||charCodeCategory.Eof;}}function charCodeCategory(code){return code<0x80?CATEGORY[code]:charCodeCategory.NameStart;}var charCodeDefinitions={isDigit:isDigit,isHexDigit:isHexDigit$1,isUppercaseLetter:isUppercaseLetter,isLowercaseLetter:isLowercaseLetter,isLetter:isLetter,isNonAscii:isNonAscii,isNameStart:isNameStart,isName:isName,isNonPrintable:isNonPrintable,isNewline:isNewline,isWhiteSpace:isWhiteSpace,isValidEscape:isValidEscape,isIdentifierStart:isIdentifierStart$1,isNumberStart:isNumberStart,isBOM:isBOM,charCodeCategory:charCodeCategory};var isDigit$1=charCodeDefinitions.isDigit;var isHexDigit$2=charCodeDefinitions.isHexDigit;var isUppercaseLetter$1=charCodeDefinitions.isUppercaseLetter;var isName$1=charCodeDefinitions.isName;var isWhiteSpace$1=charCodeDefinitions.isWhiteSpace;var isValidEscape$1=charCodeDefinitions.isValidEscape;function getCharCode(source,offset){return offset<source.length?source.charCodeAt(offset):0;}function getNewlineLength(source,offset,code){if(code===13/* \\r */&&getCharCode(source,offset+1)===10/* \\n */){return 2;}return 1;}function cmpChar(testStr,offset,referenceCode){var code=testStr.charCodeAt(offset);// code.toLowerCase() for A..Z\nif(isUppercaseLetter$1(code)){code=code|32;}return code===referenceCode;}function cmpStr(testStr,start,end,referenceStr){if(end-start!==referenceStr.length){return false;}if(start<0||end>testStr.length){return false;}for(var i=start;i<end;i++){var testCode=testStr.charCodeAt(i);var referenceCode=referenceStr.charCodeAt(i-start);// testCode.toLowerCase() for A..Z\nif(isUppercaseLetter$1(testCode)){testCode=testCode|32;}if(testCode!==referenceCode){return false;}}return true;}function findWhiteSpaceStart(source,offset){for(;offset>=0;offset--){if(!isWhiteSpace$1(source.charCodeAt(offset))){break;}}return offset+1;}function findWhiteSpaceEnd(source,offset){for(;offset<source.length;offset++){if(!isWhiteSpace$1(source.charCodeAt(offset))){break;}}return offset;}function findDecimalNumberEnd(source,offset){for(;offset<source.length;offset++){if(!isDigit$1(source.charCodeAt(offset))){break;}}return offset;}// § 4.3.7. Consume an escaped code point\nfunction consumeEscaped(source,offset){// It assumes that the U+005C REVERSE SOLIDUS (\\) has already been consumed and\n// that the next input code point has already been verified to be part of a valid escape.\noffset+=2;// hex digit\nif(isHexDigit$2(getCharCode(source,offset-1))){// Consume as many hex digits as possible, but no more than 5.\n// Note that this means 1-6 hex digits have been consumed in total.\nfor(var maxOffset=Math.min(source.length,offset+5);offset<maxOffset;offset++){if(!isHexDigit$2(getCharCode(source,offset))){break;}}// If the next input code point is whitespace, consume it as well.\nvar code=getCharCode(source,offset);if(isWhiteSpace$1(code)){offset+=getNewlineLength(source,offset,code);}}return offset;}// §4.3.11. Consume a name\n// Note: This algorithm does not do the verification of the first few code points that are necessary\n// to ensure the returned code points would constitute an <ident-token>. If that is the intended use,\n// ensure that the stream starts with an identifier before calling this algorithm.\nfunction consumeName(source,offset){// Let result initially be an empty string.\n// Repeatedly consume the next input code point from the stream:\nfor(;offset<source.length;offset++){var code=source.charCodeAt(offset);// name code point\nif(isName$1(code)){// Append the code point to result.\ncontinue;}// the stream starts with a valid escape\nif(isValidEscape$1(code,getCharCode(source,offset+1))){// Consume an escaped code point. Append the returned code point to result.\noffset=consumeEscaped(source,offset)-1;continue;}// anything else\n// Reconsume the current input code point. Return result.\nbreak;}return offset;}// §4.3.12. Consume a number\nfunction consumeNumber(source,offset){var code=source.charCodeAt(offset);// 2. If the next input code point is U+002B PLUS SIGN (+) or U+002D HYPHEN-MINUS (-),\n// consume it and append it to repr.\nif(code===0x002B||code===0x002D){code=source.charCodeAt(offset+=1);}// 3. While the next input code point is a digit, consume it and append it to repr.\nif(isDigit$1(code)){offset=findDecimalNumberEnd(source,offset+1);code=source.charCodeAt(offset);}// 4. If the next 2 input code points are U+002E FULL STOP (.) followed by a digit, then:\nif(code===0x002E&&isDigit$1(source.charCodeAt(offset+1))){// 4.1 Consume them.\n// 4.2 Append them to repr.\ncode=source.charCodeAt(offset+=2);// 4.3 Set type to \"number\".\n// TODO\n// 4.4 While the next input code point is a digit, consume it and append it to repr.\noffset=findDecimalNumberEnd(source,offset);}// 5. If the next 2 or 3 input code points are U+0045 LATIN CAPITAL LETTER E (E)\n// or U+0065 LATIN SMALL LETTER E (e), ... , followed by a digit, then:\nif(cmpChar(source,offset,101/* e */)){var sign=0;code=source.charCodeAt(offset+1);// ... optionally followed by U+002D HYPHEN-MINUS (-) or U+002B PLUS SIGN (+) ...\nif(code===0x002D||code===0x002B){sign=1;code=source.charCodeAt(offset+2);}// ... followed by a digit\nif(isDigit$1(code)){// 5.1 Consume them.\n// 5.2 Append them to repr.\n// 5.3 Set type to \"number\".\n// TODO\n// 5.4 While the next input code point is a digit, consume it and append it to repr.\noffset=findDecimalNumberEnd(source,offset+1+sign+1);}}return offset;}// § 4.3.14. Consume the remnants of a bad url\n// ... its sole use is to consume enough of the input stream to reach a recovery point\n// where normal tokenizing can resume.\nfunction consumeBadUrlRemnants(source,offset){// Repeatedly consume the next input code point from the stream:\nfor(;offset<source.length;offset++){var code=source.charCodeAt(offset);// U+0029 RIGHT PARENTHESIS ())\n// EOF\nif(code===0x0029){// Return.\noffset++;break;}if(isValidEscape$1(code,getCharCode(source,offset+1))){// Consume an escaped code point.\n// Note: This allows an escaped right parenthesis (\"\\)\") to be encountered\n// without ending the <bad-url-token>. This is otherwise identical to\n// the \"anything else\" clause.\noffset=consumeEscaped(source,offset);}}return offset;}var utils={consumeEscaped:consumeEscaped,consumeName:consumeName,consumeNumber:consumeNumber,consumeBadUrlRemnants:consumeBadUrlRemnants,cmpChar:cmpChar,cmpStr:cmpStr,getNewlineLength:getNewlineLength,findWhiteSpaceStart:findWhiteSpaceStart,findWhiteSpaceEnd:findWhiteSpaceEnd};var TYPE$1=_const.TYPE;var NAME$1=_const.NAME;var cmpStr$1=utils.cmpStr;var EOF$1=TYPE$1.EOF;var WHITESPACE=TYPE$1.WhiteSpace;var COMMENT=TYPE$1.Comment;var OFFSET_MASK=0x00FFFFFF;var TYPE_SHIFT=24;var TokenStream=function(){this.offsetAndType=null;this.balance=null;this.reset();};TokenStream.prototype={reset:function(){this.eof=false;this.tokenIndex=-1;this.tokenType=0;this.tokenStart=this.firstCharOffset;this.tokenEnd=this.firstCharOffset;},lookupType:function(offset){offset+=this.tokenIndex;if(offset<this.tokenCount){return this.offsetAndType[offset]>>TYPE_SHIFT;}return EOF$1;},lookupOffset:function(offset){offset+=this.tokenIndex;if(offset<this.tokenCount){return this.offsetAndType[offset-1]&OFFSET_MASK;}return this.source.length;},lookupValue:function(offset,referenceStr){offset+=this.tokenIndex;if(offset<this.tokenCount){return cmpStr$1(this.source,this.offsetAndType[offset-1]&OFFSET_MASK,this.offsetAndType[offset]&OFFSET_MASK,referenceStr);}return false;},getTokenStart:function(tokenIndex){if(tokenIndex===this.tokenIndex){return this.tokenStart;}if(tokenIndex>0){return tokenIndex<this.tokenCount?this.offsetAndType[tokenIndex-1]&OFFSET_MASK:this.offsetAndType[this.tokenCount]&OFFSET_MASK;}return this.firstCharOffset;},// TODO: -> skipUntilBalanced\ngetRawLength:function(startToken,mode){var cursor=startToken;var balanceEnd;var offset=this.offsetAndType[Math.max(cursor-1,0)]&OFFSET_MASK;var type;loop:for(;cursor<this.tokenCount;cursor++){balanceEnd=this.balance[cursor];// stop scanning on balance edge that points to offset before start token\nif(balanceEnd<startToken){break loop;}type=this.offsetAndType[cursor]>>TYPE_SHIFT;// check token is stop type\nswitch(mode(type,this.source,offset)){case 1:break loop;case 2:cursor++;break loop;default:offset=this.offsetAndType[cursor]&OFFSET_MASK;// fast forward to the end of balanced block\nif(this.balance[balanceEnd]===cursor){cursor=balanceEnd;}}}return cursor-this.tokenIndex;},isBalanceEdge:function(pos){return this.balance[this.tokenIndex]<pos;},isDelim:function(code,offset){if(offset){return this.lookupType(offset)===TYPE$1.Delim&&this.source.charCodeAt(this.lookupOffset(offset))===code;}return this.tokenType===TYPE$1.Delim&&this.source.charCodeAt(this.tokenStart)===code;},getTokenValue:function(){return this.source.substring(this.tokenStart,this.tokenEnd);},getTokenLength:function(){return this.tokenEnd-this.tokenStart;},substrToCursor:function(start){return this.source.substring(start,this.tokenStart);},skipWS:function(){for(var i=this.tokenIndex,skipTokenCount=0;i<this.tokenCount;i++,skipTokenCount++){if(this.offsetAndType[i]>>TYPE_SHIFT!==WHITESPACE){break;}}if(skipTokenCount>0){this.skip(skipTokenCount);}},skipSC:function(){while(this.tokenType===WHITESPACE||this.tokenType===COMMENT){this.next();}},skip:function(tokenCount){var next=this.tokenIndex+tokenCount;if(next<this.tokenCount){this.tokenIndex=next;this.tokenStart=this.offsetAndType[next-1]&OFFSET_MASK;next=this.offsetAndType[next];this.tokenType=next>>TYPE_SHIFT;this.tokenEnd=next&OFFSET_MASK;}else{this.tokenIndex=this.tokenCount;this.next();}},next:function(){var next=this.tokenIndex+1;if(next<this.tokenCount){this.tokenIndex=next;this.tokenStart=this.tokenEnd;next=this.offsetAndType[next];this.tokenType=next>>TYPE_SHIFT;this.tokenEnd=next&OFFSET_MASK;}else{this.tokenIndex=this.tokenCount;this.eof=true;this.tokenType=EOF$1;this.tokenStart=this.tokenEnd=this.source.length;}},forEachToken(fn){for(var i=0,offset=this.firstCharOffset;i<this.tokenCount;i++){var start=offset;var item=this.offsetAndType[i];var end=item&OFFSET_MASK;var type=item>>TYPE_SHIFT;offset=end;fn(type,start,end,i);}},dump(){var tokens=new Array(this.tokenCount);this.forEachToken((type,start,end,index)=>{tokens[index]={idx:index,type:NAME$1[type],chunk:this.source.substring(start,end),balance:this.balance[index]};});return tokens;}};var TokenStream_1=TokenStream;var TYPE$2=_const.TYPE;var isNewline$1=charCodeDefinitions.isNewline;var isName$2=charCodeDefinitions.isName;var isValidEscape$2=charCodeDefinitions.isValidEscape;var isNumberStart$1=charCodeDefinitions.isNumberStart;var isIdentifierStart$2=charCodeDefinitions.isIdentifierStart;var charCodeCategory$1=charCodeDefinitions.charCodeCategory;var isBOM$1=charCodeDefinitions.isBOM;var cmpStr$2=utils.cmpStr;var getNewlineLength$1=utils.getNewlineLength;var findWhiteSpaceEnd$1=utils.findWhiteSpaceEnd;var consumeEscaped$1=utils.consumeEscaped;var consumeName$1=utils.consumeName;var consumeNumber$1=utils.consumeNumber;var consumeBadUrlRemnants$1=utils.consumeBadUrlRemnants;var OFFSET_MASK$1=0x00FFFFFF;var TYPE_SHIFT$1=24;function tokenize(source,stream){function getCharCode(offset){return offset<sourceLength?source.charCodeAt(offset):0;}// § 4.3.3. Consume a numeric token\nfunction consumeNumericToken(){// Consume a number and let number be the result.\noffset=consumeNumber$1(source,offset);// If the next 3 input code points would start an identifier, then:\nif(isIdentifierStart$2(getCharCode(offset),getCharCode(offset+1),getCharCode(offset+2))){// Create a <dimension-token> with the same value and type flag as number, and a unit set initially to the empty string.\n// Consume a name. Set the <dimension-token>’s unit to the returned value.\n// Return the <dimension-token>.\ntype=TYPE$2.Dimension;offset=consumeName$1(source,offset);return;}// Otherwise, if the next input code point is U+0025 PERCENTAGE SIGN (%), consume it.\nif(getCharCode(offset)===0x0025){// Create a <percentage-token> with the same value as number, and return it.\ntype=TYPE$2.Percentage;offset++;return;}// Otherwise, create a <number-token> with the same value and type flag as number, and return it.\ntype=TYPE$2.Number;}// § 4.3.4. Consume an ident-like token\nfunction consumeIdentLikeToken(){const nameStartOffset=offset;// Consume a name, and let string be the result.\noffset=consumeName$1(source,offset);// If string’s value is an ASCII case-insensitive match for \"url\",\n// and the next input code point is U+0028 LEFT PARENTHESIS ((), consume it.\nif(cmpStr$2(source,nameStartOffset,offset,'url')&&getCharCode(offset)===0x0028){// While the next two input code points are whitespace, consume the next input code point.\noffset=findWhiteSpaceEnd$1(source,offset+1);// If the next one or two input code points are U+0022 QUOTATION MARK (\"), U+0027 APOSTROPHE ('),\n// or whitespace followed by U+0022 QUOTATION MARK (\") or U+0027 APOSTROPHE ('),\n// then create a <function-token> with its value set to string and return it.\nif(getCharCode(offset)===0x0022||getCharCode(offset)===0x0027){type=TYPE$2.Function;offset=nameStartOffset+4;return;}// Otherwise, consume a url token, and return it.\nconsumeUrlToken();return;}// Otherwise, if the next input code point is U+0028 LEFT PARENTHESIS ((), consume it.\n// Create a <function-token> with its value set to string and return it.\nif(getCharCode(offset)===0x0028){type=TYPE$2.Function;offset++;return;}// Otherwise, create an <ident-token> with its value set to string and return it.\ntype=TYPE$2.Ident;}// § 4.3.5. Consume a string token\nfunction consumeStringToken(endingCodePoint){// This algorithm may be called with an ending code point, which denotes the code point\n// that ends the string. If an ending code point is not specified,\n// the current input code point is used.\nif(!endingCodePoint){endingCodePoint=getCharCode(offset++);}// Initially create a <string-token> with its value set to the empty string.\ntype=TYPE$2.String;// Repeatedly consume the next input code point from the stream:\nfor(;offset<source.length;offset++){var code=source.charCodeAt(offset);switch(charCodeCategory$1(code)){// ending code point\ncase endingCodePoint:// Return the <string-token>.\noffset++;return;// EOF\ncase charCodeCategory$1.Eof:// This is a parse error. Return the <string-token>.\nreturn;// newline\ncase charCodeCategory$1.WhiteSpace:if(isNewline$1(code)){// This is a parse error. Reconsume the current input code point,\n// create a <bad-string-token>, and return it.\noffset+=getNewlineLength$1(source,offset,code);type=TYPE$2.BadString;return;}break;// U+005C REVERSE SOLIDUS (\\)\ncase 0x005C:// If the next input code point is EOF, do nothing.\nif(offset===source.length-1){break;}var nextCode=getCharCode(offset+1);// Otherwise, if the next input code point is a newline, consume it.\nif(isNewline$1(nextCode)){offset+=getNewlineLength$1(source,offset+1,nextCode);}else if(isValidEscape$2(code,nextCode)){// Otherwise, (the stream starts with a valid escape) consume\n// an escaped code point and append the returned code point to\n// the <string-token>’s value.\noffset=consumeEscaped$1(source,offset)-1;}break;// anything else\n// Append the current input code point to the <string-token>’s value.\n}}}// § 4.3.6. Consume a url token\n// Note: This algorithm assumes that the initial \"url(\" has already been consumed.\n// This algorithm also assumes that it’s being called to consume an \"unquoted\" value, like url(foo).\n// A quoted value, like url(\"foo\"), is parsed as a <function-token>. Consume an ident-like token\n// automatically handles this distinction; this algorithm shouldn’t be called directly otherwise.\nfunction consumeUrlToken(){// Initially create a <url-token> with its value set to the empty string.\ntype=TYPE$2.Url;// Consume as much whitespace as possible.\noffset=findWhiteSpaceEnd$1(source,offset);// Repeatedly consume the next input code point from the stream:\nfor(;offset<source.length;offset++){var code=source.charCodeAt(offset);switch(charCodeCategory$1(code)){// U+0029 RIGHT PARENTHESIS ())\ncase 0x0029:// Return the <url-token>.\noffset++;return;// EOF\ncase charCodeCategory$1.Eof:// This is a parse error. Return the <url-token>.\nreturn;// whitespace\ncase charCodeCategory$1.WhiteSpace:// Consume as much whitespace as possible.\noffset=findWhiteSpaceEnd$1(source,offset);// If the next input code point is U+0029 RIGHT PARENTHESIS ()) or EOF,\n// consume it and return the <url-token>\n// (if EOF was encountered, this is a parse error);\nif(getCharCode(offset)===0x0029||offset>=source.length){if(offset<source.length){offset++;}return;}// otherwise, consume the remnants of a bad url, create a <bad-url-token>,\n// and return it.\noffset=consumeBadUrlRemnants$1(source,offset);type=TYPE$2.BadUrl;return;// U+0022 QUOTATION MARK (\")\n// U+0027 APOSTROPHE (')\n// U+0028 LEFT PARENTHESIS (()\n// non-printable code point\ncase 0x0022:case 0x0027:case 0x0028:case charCodeCategory$1.NonPrintable:// This is a parse error. Consume the remnants of a bad url,\n// create a <bad-url-token>, and return it.\noffset=consumeBadUrlRemnants$1(source,offset);type=TYPE$2.BadUrl;return;// U+005C REVERSE SOLIDUS (\\)\ncase 0x005C:// If the stream starts with a valid escape, consume an escaped code point and\n// append the returned code point to the <url-token>’s value.\nif(isValidEscape$2(code,getCharCode(offset+1))){offset=consumeEscaped$1(source,offset)-1;break;}// Otherwise, this is a parse error. Consume the remnants of a bad url,\n// create a <bad-url-token>, and return it.\noffset=consumeBadUrlRemnants$1(source,offset);type=TYPE$2.BadUrl;return;// anything else\n// Append the current input code point to the <url-token>’s value.\n}}}if(!stream){stream=new TokenStream_1();}// ensure source is a string\nsource=String(source||'');var sourceLength=source.length;var offsetAndType=adoptBuffer(stream.offsetAndType,sourceLength+1);// +1 because of eof-token\nvar balance=adoptBuffer(stream.balance,sourceLength+1);var tokenCount=0;var start=isBOM$1(getCharCode(0));var offset=start;var balanceCloseType=0;var balanceStart=0;var balancePrev=0;// https://drafts.csswg.org/css-syntax-3/#consume-token\n// § 4.3.1. Consume a token\nwhile(offset<sourceLength){var code=source.charCodeAt(offset);var type=0;balance[tokenCount]=sourceLength;switch(charCodeCategory$1(code)){// whitespace\ncase charCodeCategory$1.WhiteSpace:// Consume as much whitespace as possible. Return a <whitespace-token>.\ntype=TYPE$2.WhiteSpace;offset=findWhiteSpaceEnd$1(source,offset+1);break;// U+0022 QUOTATION MARK (\")\ncase 0x0022:// Consume a string token and return it.\nconsumeStringToken();break;// U+0023 NUMBER SIGN (#)\ncase 0x0023:// If the next input code point is a name code point or the next two input code points are a valid escape, then:\nif(isName$2(getCharCode(offset+1))||isValidEscape$2(getCharCode(offset+1),getCharCode(offset+2))){// Create a <hash-token>.\ntype=TYPE$2.Hash;// If the next 3 input code points would start an identifier, set the <hash-token>’s type flag to \"id\".\n// if (isIdentifierStart(getCharCode(offset + 1), getCharCode(offset + 2), getCharCode(offset + 3))) {\n//     // TODO: set id flag\n// }\n// Consume a name, and set the <hash-token>’s value to the returned string.\noffset=consumeName$1(source,offset+1);// Return the <hash-token>.\n}else{// Otherwise, return a <delim-token> with its value set to the current input code point.\ntype=TYPE$2.Delim;offset++;}break;// U+0027 APOSTROPHE (')\ncase 0x0027:// Consume a string token and return it.\nconsumeStringToken();break;// U+0028 LEFT PARENTHESIS (()\ncase 0x0028:// Return a <(-token>.\ntype=TYPE$2.LeftParenthesis;offset++;break;// U+0029 RIGHT PARENTHESIS ())\ncase 0x0029:// Return a <)-token>.\ntype=TYPE$2.RightParenthesis;offset++;break;// U+002B PLUS SIGN (+)\ncase 0x002B:// If the input stream starts with a number, ...\nif(isNumberStart$1(code,getCharCode(offset+1),getCharCode(offset+2))){// ... reconsume the current input code point, consume a numeric token, and return it.\nconsumeNumericToken();}else{// Otherwise, return a <delim-token> with its value set to the current input code point.\ntype=TYPE$2.Delim;offset++;}break;// U+002C COMMA (,)\ncase 0x002C:// Return a <comma-token>.\ntype=TYPE$2.Comma;offset++;break;// U+002D HYPHEN-MINUS (-)\ncase 0x002D:// If the input stream starts with a number, reconsume the current input code point, consume a numeric token, and return it.\nif(isNumberStart$1(code,getCharCode(offset+1),getCharCode(offset+2))){consumeNumericToken();}else{// Otherwise, if the next 2 input code points are U+002D HYPHEN-MINUS U+003E GREATER-THAN SIGN (->), consume them and return a <CDC-token>.\nif(getCharCode(offset+1)===0x002D&&getCharCode(offset+2)===0x003E){type=TYPE$2.CDC;offset=offset+3;}else{// Otherwise, if the input stream starts with an identifier, ...\nif(isIdentifierStart$2(code,getCharCode(offset+1),getCharCode(offset+2))){// ... reconsume the current input code point, consume an ident-like token, and return it.\nconsumeIdentLikeToken();}else{// Otherwise, return a <delim-token> with its value set to the current input code point.\ntype=TYPE$2.Delim;offset++;}}}break;// U+002E FULL STOP (.)\ncase 0x002E:// If the input stream starts with a number, ...\nif(isNumberStart$1(code,getCharCode(offset+1),getCharCode(offset+2))){// ... reconsume the current input code point, consume a numeric token, and return it.\nconsumeNumericToken();}else{// Otherwise, return a <delim-token> with its value set to the current input code point.\ntype=TYPE$2.Delim;offset++;}break;// U+002F SOLIDUS (/)\ncase 0x002F:// If the next two input code point are U+002F SOLIDUS (/) followed by a U+002A ASTERISK (*),\nif(getCharCode(offset+1)===0x002A){// ... consume them and all following code points up to and including the first U+002A ASTERISK (*)\n// followed by a U+002F SOLIDUS (/), or up to an EOF code point.\ntype=TYPE$2.Comment;offset=source.indexOf('*/',offset+2)+2;if(offset===1){offset=source.length;}}else{type=TYPE$2.Delim;offset++;}break;// U+003A COLON (:)\ncase 0x003A:// Return a <colon-token>.\ntype=TYPE$2.Colon;offset++;break;// U+003B SEMICOLON (;)\ncase 0x003B:// Return a <semicolon-token>.\ntype=TYPE$2.Semicolon;offset++;break;// U+003C LESS-THAN SIGN (<)\ncase 0x003C:// If the next 3 input code points are U+0021 EXCLAMATION MARK U+002D HYPHEN-MINUS U+002D HYPHEN-MINUS (!--), ...\nif(getCharCode(offset+1)===0x0021&&getCharCode(offset+2)===0x002D&&getCharCode(offset+3)===0x002D){// ... consume them and return a <CDO-token>.\ntype=TYPE$2.CDO;offset=offset+4;}else{// Otherwise, return a <delim-token> with its value set to the current input code point.\ntype=TYPE$2.Delim;offset++;}break;// U+0040 COMMERCIAL AT (@)\ncase 0x0040:// If the next 3 input code points would start an identifier, ...\nif(isIdentifierStart$2(getCharCode(offset+1),getCharCode(offset+2),getCharCode(offset+3))){// ... consume a name, create an <at-keyword-token> with its value set to the returned value, and return it.\ntype=TYPE$2.AtKeyword;offset=consumeName$1(source,offset+1);}else{// Otherwise, return a <delim-token> with its value set to the current input code point.\ntype=TYPE$2.Delim;offset++;}break;// U+005B LEFT SQUARE BRACKET ([)\ncase 0x005B:// Return a <[-token>.\ntype=TYPE$2.LeftSquareBracket;offset++;break;// U+005C REVERSE SOLIDUS (\\)\ncase 0x005C:// If the input stream starts with a valid escape, ...\nif(isValidEscape$2(code,getCharCode(offset+1))){// ... reconsume the current input code point, consume an ident-like token, and return it.\nconsumeIdentLikeToken();}else{// Otherwise, this is a parse error. Return a <delim-token> with its value set to the current input code point.\ntype=TYPE$2.Delim;offset++;}break;// U+005D RIGHT SQUARE BRACKET (])\ncase 0x005D:// Return a <]-token>.\ntype=TYPE$2.RightSquareBracket;offset++;break;// U+007B LEFT CURLY BRACKET ({)\ncase 0x007B:// Return a <{-token>.\ntype=TYPE$2.LeftCurlyBracket;offset++;break;// U+007D RIGHT CURLY BRACKET (})\ncase 0x007D:// Return a <}-token>.\ntype=TYPE$2.RightCurlyBracket;offset++;break;// digit\ncase charCodeCategory$1.Digit:// Reconsume the current input code point, consume a numeric token, and return it.\nconsumeNumericToken();break;// name-start code point\ncase charCodeCategory$1.NameStart:// Reconsume the current input code point, consume an ident-like token, and return it.\nconsumeIdentLikeToken();break;// EOF\ncase charCodeCategory$1.Eof:// Return an <EOF-token>.\nbreak;// anything else\ndefault:// Return a <delim-token> with its value set to the current input code point.\ntype=TYPE$2.Delim;offset++;}switch(type){case balanceCloseType:balancePrev=balanceStart&OFFSET_MASK$1;balanceStart=balance[balancePrev];balanceCloseType=balanceStart>>TYPE_SHIFT$1;balance[tokenCount]=balancePrev;balance[balancePrev++]=tokenCount;for(;balancePrev<tokenCount;balancePrev++){if(balance[balancePrev]===sourceLength){balance[balancePrev]=tokenCount;}}break;case TYPE$2.LeftParenthesis:case TYPE$2.Function:balance[tokenCount]=balanceStart;balanceCloseType=TYPE$2.RightParenthesis;balanceStart=balanceCloseType<<TYPE_SHIFT$1|tokenCount;break;case TYPE$2.LeftSquareBracket:balance[tokenCount]=balanceStart;balanceCloseType=TYPE$2.RightSquareBracket;balanceStart=balanceCloseType<<TYPE_SHIFT$1|tokenCount;break;case TYPE$2.LeftCurlyBracket:balance[tokenCount]=balanceStart;balanceCloseType=TYPE$2.RightCurlyBracket;balanceStart=balanceCloseType<<TYPE_SHIFT$1|tokenCount;break;}offsetAndType[tokenCount++]=type<<TYPE_SHIFT$1|offset;}// finalize buffers\noffsetAndType[tokenCount]=TYPE$2.EOF<<TYPE_SHIFT$1|offset;// <EOF-token>\nbalance[tokenCount]=sourceLength;balance[sourceLength]=sourceLength;// prevents false positive balance match with any token\nwhile(balanceStart!==0){balancePrev=balanceStart&OFFSET_MASK$1;balanceStart=balance[balancePrev];balance[balancePrev]=sourceLength;}// update stream\nstream.source=source;stream.firstCharOffset=start;stream.offsetAndType=offsetAndType;stream.tokenCount=tokenCount;stream.balance=balance;stream.reset();stream.next();return stream;}// extend tokenizer with constants\nObject.keys(_const).forEach(function(key){tokenize[key]=_const[key];});// extend tokenizer with static methods from utils\nObject.keys(charCodeDefinitions).forEach(function(key){tokenize[key]=charCodeDefinitions[key];});Object.keys(utils).forEach(function(key){tokenize[key]=utils[key];});var tokenizer=tokenize;var isBOM$2=tokenizer.isBOM;var N=10;var F=12;var R=13;function computeLinesAndColumns(host,source){var sourceLength=source.length;var lines=adoptBuffer(host.lines,sourceLength);// +1\nvar line=host.startLine;var columns=adoptBuffer(host.columns,sourceLength);var column=host.startColumn;var startOffset=source.length>0?isBOM$2(source.charCodeAt(0)):0;for(var i=startOffset;i<sourceLength;i++){// -1\nvar code=source.charCodeAt(i);lines[i]=line;columns[i]=column++;if(code===N||code===R||code===F){if(code===R&&i+1<sourceLength&&source.charCodeAt(i+1)===N){i++;lines[i]=line;columns[i]=column;}line++;column=1;}}lines[i]=line;columns[i]=column;host.lines=lines;host.columns=columns;}var OffsetToLocation=function(){this.lines=null;this.columns=null;this.linesAndColumnsComputed=false;};OffsetToLocation.prototype={setSource:function(source,startOffset,startLine,startColumn){this.source=source;this.startOffset=typeof startOffset==='undefined'?0:startOffset;this.startLine=typeof startLine==='undefined'?1:startLine;this.startColumn=typeof startColumn==='undefined'?1:startColumn;this.linesAndColumnsComputed=false;},ensureLinesAndColumnsComputed:function(){if(!this.linesAndColumnsComputed){computeLinesAndColumns(this,this.source);this.linesAndColumnsComputed=true;}},getLocation:function(offset,filename){this.ensureLinesAndColumnsComputed();return{source:filename,offset:this.startOffset+offset,line:this.lines[offset],column:this.columns[offset]};},getLocationRange:function(start,end,filename){this.ensureLinesAndColumnsComputed();return{source:filename,start:{offset:this.startOffset+start,line:this.lines[start],column:this.columns[start]},end:{offset:this.startOffset+end,line:this.lines[end],column:this.columns[end]}};}};var OffsetToLocation_1=OffsetToLocation;var createCustomError=function createCustomError(name,message){// use Object.create(), because some VMs prevent setting line/column otherwise\n// (iOS Safari 10 even throws an exception)\nvar error=Object.create(SyntaxError.prototype);var errorStack=new Error();error.name=name;error.message=message;Object.defineProperty(error,'stack',{get:function(){return(errorStack.stack||'').replace(/^(.+\\n){1,3}/,name+': '+message+'\\n');}});return error;};var MAX_LINE_LENGTH=100;var OFFSET_CORRECTION=60;var TAB_REPLACEMENT='    ';function sourceFragment(error,extraLines){function processLines(start,end){return lines.slice(start,end).map(function(line,idx){var num=String(start+idx+1);while(num.length<maxNumLength){num=' '+num;}return num+' |'+line;}).join('\\n');}var lines=error.source.split(/\\r\\n?|\\n|\\f/);var line=error.line;var column=error.column;var startLine=Math.max(1,line-extraLines)-1;var endLine=Math.min(line+extraLines,lines.length+1);var maxNumLength=Math.max(4,String(endLine).length)+1;var cutLeft=0;// column correction according to replaced tab before column\ncolumn+=(TAB_REPLACEMENT.length-1)*(lines[line-1].substr(0,column-1).match(/\\t/g)||[]).length;if(column>MAX_LINE_LENGTH){cutLeft=column-OFFSET_CORRECTION+3;column=OFFSET_CORRECTION-2;}for(var i=startLine;i<=endLine;i++){if(i>=0&&i<lines.length){lines[i]=lines[i].replace(/\\t/g,TAB_REPLACEMENT);lines[i]=(cutLeft>0&&lines[i].length>cutLeft?'\\u2026':'')+lines[i].substr(cutLeft,MAX_LINE_LENGTH-2)+(lines[i].length>cutLeft+MAX_LINE_LENGTH-1?'\\u2026':'');}}return[processLines(startLine,line),new Array(column+maxNumLength+2).join('-')+'^',processLines(line,endLine)].filter(Boolean).join('\\n');}var SyntaxError$1=function(message,source,offset,line,column){var error=createCustomError('SyntaxError',message);error.source=source;error.offset=offset;error.line=line;error.column=column;error.sourceFragment=function(extraLines){return sourceFragment(error,isNaN(extraLines)?0:extraLines);};Object.defineProperty(error,'formattedMessage',{get:function(){return'Parse error: '+error.message+'\\n'+sourceFragment(error,2);}});// for backward capability\nerror.parseError={offset:offset,line:line,column:column};return error;};var _SyntaxError=SyntaxError$1;//\n//                              list\n//                            ┌──────┐\n//             ┌──────────────┼─head │\n//             │              │ tail─┼──────────────┐\n//             │              └──────┘              │\n//             ▼                                    ▼\n//            item        item        item        item\n//          ┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐\n//  null ◀──┼─prev │◀───┼─prev │◀───┼─prev │◀───┼─prev │\n//          │ next─┼───▶│ next─┼───▶│ next─┼───▶│ next─┼──▶ null\n//          ├──────┤    ├──────┤    ├──────┤    ├──────┤\n//          │ data │    │ data │    │ data │    │ data │\n//          └──────┘    └──────┘    └──────┘    └──────┘\n//\nfunction createItem(data){return{prev:null,next:null,data:data};}function allocateCursor(node,prev,next){var cursor;if(cursors!==null){cursor=cursors;cursors=cursors.cursor;cursor.prev=prev;cursor.next=next;cursor.cursor=node.cursor;}else{cursor={prev:prev,next:next,cursor:node.cursor};}node.cursor=cursor;return cursor;}function releaseCursor(node){var cursor=node.cursor;node.cursor=cursor.cursor;cursor.prev=null;cursor.next=null;cursor.cursor=cursors;cursors=cursor;}var cursors=null;var List=function(){this.cursor=null;this.head=null;this.tail=null;};List.createItem=createItem;List.prototype.createItem=createItem;List.prototype.updateCursors=function(prevOld,prevNew,nextOld,nextNew){var cursor=this.cursor;while(cursor!==null){if(cursor.prev===prevOld){cursor.prev=prevNew;}if(cursor.next===nextOld){cursor.next=nextNew;}cursor=cursor.cursor;}};List.prototype.getSize=function(){var size=0;var cursor=this.head;while(cursor){size++;cursor=cursor.next;}return size;};List.prototype.fromArray=function(array){var cursor=null;this.head=null;for(var i=0;i<array.length;i++){var item=createItem(array[i]);if(cursor!==null){cursor.next=item;}else{this.head=item;}item.prev=cursor;cursor=item;}this.tail=cursor;return this;};List.prototype.toArray=function(){var cursor=this.head;var result=[];while(cursor){result.push(cursor.data);cursor=cursor.next;}return result;};List.prototype.toJSON=List.prototype.toArray;List.prototype.isEmpty=function(){return this.head===null;};List.prototype.first=function(){return this.head&&this.head.data;};List.prototype.last=function(){return this.tail&&this.tail.data;};List.prototype.each=function(fn,context){var item;if(context===undefined){context=this;}// push cursor\nvar cursor=allocateCursor(this,null,this.head);while(cursor.next!==null){item=cursor.next;cursor.next=item.next;fn.call(context,item.data,item,this);}// pop cursor\nreleaseCursor(this);};List.prototype.forEach=List.prototype.each;List.prototype.eachRight=function(fn,context){var item;if(context===undefined){context=this;}// push cursor\nvar cursor=allocateCursor(this,this.tail,null);while(cursor.prev!==null){item=cursor.prev;cursor.prev=item.prev;fn.call(context,item.data,item,this);}// pop cursor\nreleaseCursor(this);};List.prototype.forEachRight=List.prototype.eachRight;List.prototype.reduce=function(fn,initialValue,context){var item;if(context===undefined){context=this;}// push cursor\nvar cursor=allocateCursor(this,null,this.head);var acc=initialValue;while(cursor.next!==null){item=cursor.next;cursor.next=item.next;acc=fn.call(context,acc,item.data,item,this);}// pop cursor\nreleaseCursor(this);return acc;};List.prototype.reduceRight=function(fn,initialValue,context){var item;if(context===undefined){context=this;}// push cursor\nvar cursor=allocateCursor(this,this.tail,null);var acc=initialValue;while(cursor.prev!==null){item=cursor.prev;cursor.prev=item.prev;acc=fn.call(context,acc,item.data,item,this);}// pop cursor\nreleaseCursor(this);return acc;};List.prototype.nextUntil=function(start,fn,context){if(start===null){return;}var item;if(context===undefined){context=this;}// push cursor\nvar cursor=allocateCursor(this,null,start);while(cursor.next!==null){item=cursor.next;cursor.next=item.next;if(fn.call(context,item.data,item,this)){break;}}// pop cursor\nreleaseCursor(this);};List.prototype.prevUntil=function(start,fn,context){if(start===null){return;}var item;if(context===undefined){context=this;}// push cursor\nvar cursor=allocateCursor(this,start,null);while(cursor.prev!==null){item=cursor.prev;cursor.prev=item.prev;if(fn.call(context,item.data,item,this)){break;}}// pop cursor\nreleaseCursor(this);};List.prototype.some=function(fn,context){var cursor=this.head;if(context===undefined){context=this;}while(cursor!==null){if(fn.call(context,cursor.data,cursor,this)){return true;}cursor=cursor.next;}return false;};List.prototype.map=function(fn,context){var result=new List();var cursor=this.head;if(context===undefined){context=this;}while(cursor!==null){result.appendData(fn.call(context,cursor.data,cursor,this));cursor=cursor.next;}return result;};List.prototype.filter=function(fn,context){var result=new List();var cursor=this.head;if(context===undefined){context=this;}while(cursor!==null){if(fn.call(context,cursor.data,cursor,this)){result.appendData(cursor.data);}cursor=cursor.next;}return result;};List.prototype.clear=function(){this.head=null;this.tail=null;};List.prototype.copy=function(){var result=new List();var cursor=this.head;while(cursor!==null){result.insert(createItem(cursor.data));cursor=cursor.next;}return result;};List.prototype.prepend=function(item){//      head\n//    ^\n// item\nthis.updateCursors(null,item,this.head,item);// insert to the beginning of the list\nif(this.head!==null){// new item <- first item\nthis.head.prev=item;// new item -> first item\nitem.next=this.head;}else{// if list has no head, then it also has no tail\n// in this case tail points to the new item\nthis.tail=item;}// head always points to new item\nthis.head=item;return this;};List.prototype.prependData=function(data){return this.prepend(createItem(data));};List.prototype.append=function(item){return this.insert(item);};List.prototype.appendData=function(data){return this.insert(createItem(data));};List.prototype.insert=function(item,before){if(before!==undefined&&before!==null){// prev   before\n//      ^\n//     item\nthis.updateCursors(before.prev,item,before,item);if(before.prev===null){// insert to the beginning of list\nif(this.head!==before){throw new Error('before doesn\\'t belong to list');}// since head points to before therefore list doesn't empty\n// no need to check tail\nthis.head=item;before.prev=item;item.next=before;this.updateCursors(null,item);}else{// insert between two items\nbefore.prev.next=item;item.prev=before.prev;before.prev=item;item.next=before;}}else{// tail\n//      ^\n//      item\nthis.updateCursors(this.tail,item,null,item);// insert to the ending of the list\nif(this.tail!==null){// last item -> new item\nthis.tail.next=item;// last item <- new item\nitem.prev=this.tail;}else{// if list has no tail, then it also has no head\n// in this case head points to new item\nthis.head=item;}// tail always points to new item\nthis.tail=item;}return this;};List.prototype.insertData=function(data,before){return this.insert(createItem(data),before);};List.prototype.remove=function(item){//      item\n//       ^\n// prev     next\nthis.updateCursors(item,item.prev,item,item.next);if(item.prev!==null){item.prev.next=item.next;}else{if(this.head!==item){throw new Error('item doesn\\'t belong to list');}this.head=item.next;}if(item.next!==null){item.next.prev=item.prev;}else{if(this.tail!==item){throw new Error('item doesn\\'t belong to list');}this.tail=item.prev;}item.prev=null;item.next=null;return item;};List.prototype.push=function(data){this.insert(createItem(data));};List.prototype.pop=function(){if(this.tail!==null){return this.remove(this.tail);}};List.prototype.unshift=function(data){this.prepend(createItem(data));};List.prototype.shift=function(){if(this.head!==null){return this.remove(this.head);}};List.prototype.prependList=function(list){return this.insertList(list,this.head);};List.prototype.appendList=function(list){return this.insertList(list);};List.prototype.insertList=function(list,before){// ignore empty lists\nif(list.head===null){return this;}if(before!==undefined&&before!==null){this.updateCursors(before.prev,list.tail,before,list.head);// insert in the middle of dist list\nif(before.prev!==null){// before.prev <-> list.head\nbefore.prev.next=list.head;list.head.prev=before.prev;}else{this.head=list.head;}before.prev=list.tail;list.tail.next=before;}else{this.updateCursors(this.tail,list.tail,null,list.head);// insert to end of the list\nif(this.tail!==null){// if destination list has a tail, then it also has a head,\n// but head doesn't change\n// dest tail -> source head\nthis.tail.next=list.head;// dest tail <- source head\nlist.head.prev=this.tail;}else{// if list has no a tail, then it also has no a head\n// in this case points head to new item\nthis.head=list.head;}// tail always start point to new item\nthis.tail=list.tail;}list.head=null;list.tail=null;return this;};List.prototype.replace=function(oldItem,newItemOrList){if('head'in newItemOrList){this.insertList(newItemOrList,oldItem);}else{this.insert(newItemOrList,oldItem);}this.remove(oldItem);};var List_1=List;var TYPE$3=tokenizer.TYPE;var WHITESPACE$1=TYPE$3.WhiteSpace;var COMMENT$1=TYPE$3.Comment;var sequence=function readSequence(recognizer){var children=this.createList();var child=null;var context={recognizer:recognizer,space:null,ignoreWS:false,ignoreWSAfter:false};this.scanner.skipSC();while(!this.scanner.eof){switch(this.scanner.tokenType){case COMMENT$1:this.scanner.next();continue;case WHITESPACE$1:if(context.ignoreWS){this.scanner.next();}else{context.space=this.WhiteSpace();}continue;}child=recognizer.getNode.call(this,context);if(child===undefined){break;}if(context.space!==null){children.push(context.space);context.space=null;}children.push(child);if(context.ignoreWSAfter){context.ignoreWSAfter=false;context.ignoreWS=true;}else{context.ignoreWS=false;}}return children;};var{findWhiteSpaceStart:findWhiteSpaceStart$1,cmpStr:cmpStr$3}=utils;var noop=function(){};var TYPE$4=_const.TYPE;var NAME$2=_const.NAME;var WHITESPACE$2=TYPE$4.WhiteSpace;var COMMENT$2=TYPE$4.Comment;var IDENT=TYPE$4.Ident;var FUNCTION=TYPE$4.Function;var URL$1=TYPE$4.Url;var HASH=TYPE$4.Hash;var PERCENTAGE=TYPE$4.Percentage;var NUMBER=TYPE$4.Number;var NUMBERSIGN=0x0023;// U+0023 NUMBER SIGN (#)\nvar NULL=0;function createParseContext(name){return function(){return this[name]();};}function processConfig(config){var parserConfig={context:{},scope:{},atrule:{},pseudo:{}};if(config.parseContext){for(var name in config.parseContext){switch(typeof config.parseContext[name]){case'function':parserConfig.context[name]=config.parseContext[name];break;case'string':parserConfig.context[name]=createParseContext(config.parseContext[name]);break;}}}if(config.scope){for(var name in config.scope){parserConfig.scope[name]=config.scope[name];}}if(config.atrule){for(var name in config.atrule){var atrule=config.atrule[name];if(atrule.parse){parserConfig.atrule[name]=atrule.parse;}}}if(config.pseudo){for(var name in config.pseudo){var pseudo=config.pseudo[name];if(pseudo.parse){parserConfig.pseudo[name]=pseudo.parse;}}}if(config.node){for(var name in config.node){parserConfig[name]=config.node[name].parse;}}return parserConfig;}var create=function createParser(config){var parser={scanner:new TokenStream_1(),locationMap:new OffsetToLocation_1(),filename:'<unknown>',needPositions:false,onParseError:noop,onParseErrorThrow:false,parseAtrulePrelude:true,parseRulePrelude:true,parseValue:true,parseCustomProperty:false,readSequence:sequence,createList:function(){return new List_1();},createSingleNodeList:function(node){return new List_1().appendData(node);},getFirstListNode:function(list){return list&&list.first();},getLastListNode:function(list){return list.last();},parseWithFallback:function(consumer,fallback){var startToken=this.scanner.tokenIndex;try{return consumer.call(this);}catch(e){if(this.onParseErrorThrow){throw e;}var fallbackNode=fallback.call(this,startToken);this.onParseErrorThrow=true;this.onParseError(e,fallbackNode);this.onParseErrorThrow=false;return fallbackNode;}},lookupNonWSType:function(offset){do{var type=this.scanner.lookupType(offset++);if(type!==WHITESPACE$2){return type;}}while(type!==NULL);return NULL;},eat:function(tokenType){if(this.scanner.tokenType!==tokenType){var offset=this.scanner.tokenStart;var message=NAME$2[tokenType]+' is expected';// tweak message and offset\nswitch(tokenType){case IDENT:// when identifier is expected but there is a function or url\nif(this.scanner.tokenType===FUNCTION||this.scanner.tokenType===URL$1){offset=this.scanner.tokenEnd-1;message='Identifier is expected but function found';}else{message='Identifier is expected';}break;case HASH:if(this.scanner.isDelim(NUMBERSIGN)){this.scanner.next();offset++;message='Name is expected';}break;case PERCENTAGE:if(this.scanner.tokenType===NUMBER){offset=this.scanner.tokenEnd;message='Percent sign is expected';}break;default:// when test type is part of another token show error for current position + 1\n// e.g. eat(HYPHENMINUS) will fail on \"-foo\", but pointing on \"-\" is odd\nif(this.scanner.source.charCodeAt(this.scanner.tokenStart)===tokenType){offset=offset+1;}}this.error(message,offset);}this.scanner.next();},consume:function(tokenType){var value=this.scanner.getTokenValue();this.eat(tokenType);return value;},consumeFunctionName:function(){var name=this.scanner.source.substring(this.scanner.tokenStart,this.scanner.tokenEnd-1);this.eat(FUNCTION);return name;},getLocation:function(start,end){if(this.needPositions){return this.locationMap.getLocationRange(start,end,this.filename);}return null;},getLocationFromList:function(list){if(this.needPositions){var head=this.getFirstListNode(list);var tail=this.getLastListNode(list);return this.locationMap.getLocationRange(head!==null?head.loc.start.offset-this.locationMap.startOffset:this.scanner.tokenStart,tail!==null?tail.loc.end.offset-this.locationMap.startOffset:this.scanner.tokenStart,this.filename);}return null;},error:function(message,offset){var location=typeof offset!=='undefined'&&offset<this.scanner.source.length?this.locationMap.getLocation(offset):this.scanner.eof?this.locationMap.getLocation(findWhiteSpaceStart$1(this.scanner.source,this.scanner.source.length-1)):this.locationMap.getLocation(this.scanner.tokenStart);throw new _SyntaxError(message||'Unexpected input',this.scanner.source,location.offset,location.line,location.column);}};config=processConfig(config||{});for(var key in config){parser[key]=config[key];}return function(source,options){options=options||{};var context=options.context||'default';var onComment=options.onComment;var ast;tokenizer(source,parser.scanner);parser.locationMap.setSource(source,options.offset,options.line,options.column);parser.filename=options.filename||'<unknown>';parser.needPositions=Boolean(options.positions);parser.onParseError=typeof options.onParseError==='function'?options.onParseError:noop;parser.onParseErrorThrow=false;parser.parseAtrulePrelude='parseAtrulePrelude'in options?Boolean(options.parseAtrulePrelude):true;parser.parseRulePrelude='parseRulePrelude'in options?Boolean(options.parseRulePrelude):true;parser.parseValue='parseValue'in options?Boolean(options.parseValue):true;parser.parseCustomProperty='parseCustomProperty'in options?Boolean(options.parseCustomProperty):false;if(!parser.context.hasOwnProperty(context)){throw new Error('Unknown context `'+context+'`');}if(typeof onComment==='function'){parser.scanner.forEachToken((type,start,end)=>{if(type===COMMENT$2){const loc=parser.getLocation(start,end);const value=cmpStr$3(source,end-2,end,'*/')?source.slice(start+2,end-2):source.slice(start+2,end);onComment(value,loc);}});}ast=parser.context[context].call(parser,options);if(!parser.scanner.eof){parser.error();}return ast;};};var cmpChar$1=tokenizer.cmpChar;var cmpStr$4=tokenizer.cmpStr;var TYPE$5=tokenizer.TYPE;var IDENT$1=TYPE$5.Ident;var STRING=TYPE$5.String;var NUMBER$1=TYPE$5.Number;var FUNCTION$1=TYPE$5.Function;var URL$2=TYPE$5.Url;var HASH$1=TYPE$5.Hash;var DIMENSION=TYPE$5.Dimension;var PERCENTAGE$1=TYPE$5.Percentage;var LEFTPARENTHESIS=TYPE$5.LeftParenthesis;var LEFTSQUAREBRACKET=TYPE$5.LeftSquareBracket;var COMMA=TYPE$5.Comma;var DELIM=TYPE$5.Delim;var NUMBERSIGN$1=0x0023;// U+0023 NUMBER SIGN (#)\nvar ASTERISK=0x002A;// U+002A ASTERISK (*)\nvar PLUSSIGN=0x002B;// U+002B PLUS SIGN (+)\nvar HYPHENMINUS=0x002D;// U+002D HYPHEN-MINUS (-)\nvar SOLIDUS=0x002F;// U+002F SOLIDUS (/)\nvar U=0x0075;// U+0075 LATIN SMALL LETTER U (u)\nvar _default=function defaultRecognizer(context){switch(this.scanner.tokenType){case HASH$1:return this.Hash();case COMMA:context.space=null;context.ignoreWSAfter=true;return this.Operator();case LEFTPARENTHESIS:return this.Parentheses(this.readSequence,context.recognizer);case LEFTSQUAREBRACKET:return this.Brackets(this.readSequence,context.recognizer);case STRING:return this.String();case DIMENSION:return this.Dimension();case PERCENTAGE$1:return this.Percentage();case NUMBER$1:return this.Number();case FUNCTION$1:return cmpStr$4(this.scanner.source,this.scanner.tokenStart,this.scanner.tokenEnd,'url(')?this.Url():this.Function(this.readSequence,context.recognizer);case URL$2:return this.Url();case IDENT$1:// check for unicode range, it should start with u+ or U+\nif(cmpChar$1(this.scanner.source,this.scanner.tokenStart,U)&&cmpChar$1(this.scanner.source,this.scanner.tokenStart+1,PLUSSIGN)){return this.UnicodeRange();}else{return this.Identifier();}case DELIM:var code=this.scanner.source.charCodeAt(this.scanner.tokenStart);if(code===SOLIDUS||code===ASTERISK||code===PLUSSIGN||code===HYPHENMINUS){return this.Operator();// TODO: replace with Delim\n}// TODO: produce a node with Delim node type\nif(code===NUMBERSIGN$1){this.error('Hex or identifier is expected',this.scanner.tokenStart+1);}break;}};var atrulePrelude={getNode:_default};var TYPE$6=tokenizer.TYPE;var DELIM$1=TYPE$6.Delim;var IDENT$2=TYPE$6.Ident;var DIMENSION$1=TYPE$6.Dimension;var PERCENTAGE$2=TYPE$6.Percentage;var NUMBER$2=TYPE$6.Number;var HASH$2=TYPE$6.Hash;var COLON=TYPE$6.Colon;var LEFTSQUAREBRACKET$1=TYPE$6.LeftSquareBracket;var NUMBERSIGN$2=0x0023;// U+0023 NUMBER SIGN (#)\nvar ASTERISK$1=0x002A;// U+002A ASTERISK (*)\nvar PLUSSIGN$1=0x002B;// U+002B PLUS SIGN (+)\nvar SOLIDUS$1=0x002F;// U+002F SOLIDUS (/)\nvar FULLSTOP=0x002E;// U+002E FULL STOP (.)\nvar GREATERTHANSIGN=0x003E;// U+003E GREATER-THAN SIGN (>)\nvar VERTICALLINE=0x007C;// U+007C VERTICAL LINE (|)\nvar TILDE=0x007E;// U+007E TILDE (~)\nfunction getNode(context){switch(this.scanner.tokenType){case LEFTSQUAREBRACKET$1:return this.AttributeSelector();case HASH$2:return this.IdSelector();case COLON:if(this.scanner.lookupType(1)===COLON){return this.PseudoElementSelector();}else{return this.PseudoClassSelector();}case IDENT$2:return this.TypeSelector();case NUMBER$2:case PERCENTAGE$2:return this.Percentage();case DIMENSION$1:// throws when .123ident\nif(this.scanner.source.charCodeAt(this.scanner.tokenStart)===FULLSTOP){this.error('Identifier is expected',this.scanner.tokenStart+1);}break;case DELIM$1:var code=this.scanner.source.charCodeAt(this.scanner.tokenStart);switch(code){case PLUSSIGN$1:case GREATERTHANSIGN:case TILDE:context.space=null;context.ignoreWSAfter=true;return this.Combinator();case SOLIDUS$1:// /deep/\nreturn this.Combinator();case FULLSTOP:return this.ClassSelector();case ASTERISK$1:case VERTICALLINE:return this.TypeSelector();case NUMBERSIGN$2:return this.IdSelector();}break;}}var selector={getNode:getNode};// legacy IE function\n// expression( <any-value> )\nvar expression=function(){return this.createSingleNodeList(this.Raw(this.scanner.tokenIndex,null,false));};var TYPE$7=tokenizer.TYPE;var WhiteSpace=TYPE$7.WhiteSpace;var Semicolon=TYPE$7.Semicolon;var LeftCurlyBracket=TYPE$7.LeftCurlyBracket;var Delim=TYPE$7.Delim;var EXCLAMATIONMARK=0x0021;// U+0021 EXCLAMATION MARK (!)\nfunction getOffsetExcludeWS(){if(this.scanner.tokenIndex>0){if(this.scanner.lookupType(-1)===WhiteSpace){return this.scanner.tokenIndex>1?this.scanner.getTokenStart(this.scanner.tokenIndex-1):this.scanner.firstCharOffset;}}return this.scanner.tokenStart;}// 0, 0, false\nfunction balanceEnd(){return 0;}// LEFTCURLYBRACKET, 0, false\nfunction leftCurlyBracket(tokenType){return tokenType===LeftCurlyBracket?1:0;}// LEFTCURLYBRACKET, SEMICOLON, false\nfunction leftCurlyBracketOrSemicolon(tokenType){return tokenType===LeftCurlyBracket||tokenType===Semicolon?1:0;}// EXCLAMATIONMARK, SEMICOLON, false\nfunction exclamationMarkOrSemicolon(tokenType,source,offset){if(tokenType===Delim&&source.charCodeAt(offset)===EXCLAMATIONMARK){return 1;}return tokenType===Semicolon?1:0;}// 0, SEMICOLON, true\nfunction semicolonIncluded(tokenType){return tokenType===Semicolon?2:0;}var Raw={name:'Raw',structure:{value:String},parse:function(startToken,mode,excludeWhiteSpace){var startOffset=this.scanner.getTokenStart(startToken);var endOffset;this.scanner.skip(this.scanner.getRawLength(startToken,mode||balanceEnd));if(excludeWhiteSpace&&this.scanner.tokenStart>startOffset){endOffset=getOffsetExcludeWS.call(this);}else{endOffset=this.scanner.tokenStart;}return{type:'Raw',loc:this.getLocation(startOffset,endOffset),value:this.scanner.source.substring(startOffset,endOffset)};},generate:function(node){this.chunk(node.value);},mode:{default:balanceEnd,leftCurlyBracket:leftCurlyBracket,leftCurlyBracketOrSemicolon:leftCurlyBracketOrSemicolon,exclamationMarkOrSemicolon:exclamationMarkOrSemicolon,semicolonIncluded:semicolonIncluded}};var TYPE$8=tokenizer.TYPE;var rawMode=Raw.mode;var COMMA$1=TYPE$8.Comma;var WHITESPACE$3=TYPE$8.WhiteSpace;// var( <ident> , <value>? )\nvar _var=function(){var children=this.createList();this.scanner.skipSC();// NOTE: Don't check more than a first argument is an ident, rest checks are for lexer\nchildren.push(this.Identifier());this.scanner.skipSC();if(this.scanner.tokenType===COMMA$1){children.push(this.Operator());const startIndex=this.scanner.tokenIndex;const value=this.parseCustomProperty?this.Value(null):this.Raw(this.scanner.tokenIndex,rawMode.exclamationMarkOrSemicolon,false);if(value.type==='Value'&&value.children.isEmpty()){for(let offset=startIndex-this.scanner.tokenIndex;offset<=0;offset++){if(this.scanner.lookupType(offset)===WHITESPACE$3){value.children.appendData({type:'WhiteSpace',loc:null,value:' '});break;}}}children.push(value);}return children;};var value={getNode:_default,'expression':expression,'var':_var};var scope={AtrulePrelude:atrulePrelude,Selector:selector,Value:value};var fontFace={parse:{prelude:null,block:function(){return this.Block(true);}}};var TYPE$9=tokenizer.TYPE;var STRING$1=TYPE$9.String;var IDENT$3=TYPE$9.Ident;var URL$3=TYPE$9.Url;var FUNCTION$2=TYPE$9.Function;var LEFTPARENTHESIS$1=TYPE$9.LeftParenthesis;var _import={parse:{prelude:function(){var children=this.createList();this.scanner.skipSC();switch(this.scanner.tokenType){case STRING$1:children.push(this.String());break;case URL$3:case FUNCTION$2:children.push(this.Url());break;default:this.error('String or url() is expected');}if(this.lookupNonWSType(0)===IDENT$3||this.lookupNonWSType(0)===LEFTPARENTHESIS$1){children.push(this.WhiteSpace());children.push(this.MediaQueryList());}return children;},block:null}};var media={parse:{prelude:function(){return this.createSingleNodeList(this.MediaQueryList());},block:function(){return this.Block(false);}}};var page={parse:{prelude:function(){return this.createSingleNodeList(this.SelectorList());},block:function(){return this.Block(true);}}};var TYPE$a=tokenizer.TYPE;var WHITESPACE$4=TYPE$a.WhiteSpace;var COMMENT$3=TYPE$a.Comment;var IDENT$4=TYPE$a.Ident;var FUNCTION$3=TYPE$a.Function;var COLON$1=TYPE$a.Colon;var LEFTPARENTHESIS$2=TYPE$a.LeftParenthesis;function consumeRaw(){return this.createSingleNodeList(this.Raw(this.scanner.tokenIndex,null,false));}function parentheses(){this.scanner.skipSC();if(this.scanner.tokenType===IDENT$4&&this.lookupNonWSType(1)===COLON$1){return this.createSingleNodeList(this.Declaration());}return readSequence.call(this);}function readSequence(){var children=this.createList();var space=null;var child;this.scanner.skipSC();scan:while(!this.scanner.eof){switch(this.scanner.tokenType){case WHITESPACE$4:space=this.WhiteSpace();continue;case COMMENT$3:this.scanner.next();continue;case FUNCTION$3:child=this.Function(consumeRaw,this.scope.AtrulePrelude);break;case IDENT$4:child=this.Identifier();break;case LEFTPARENTHESIS$2:child=this.Parentheses(parentheses,this.scope.AtrulePrelude);break;default:break scan;}if(space!==null){children.push(space);space=null;}children.push(child);}return children;}var supports={parse:{prelude:function(){var children=readSequence.call(this);if(this.getFirstListNode(children)===null){this.error('Condition is expected');}return children;},block:function(){return this.Block(false);}}};var atrule={'font-face':fontFace,'import':_import,'media':media,'page':page,'supports':supports};var dir={parse:function(){return this.createSingleNodeList(this.Identifier());}};var has={parse:function(){return this.createSingleNodeList(this.SelectorList());}};var lang={parse:function(){return this.createSingleNodeList(this.Identifier());}};var selectorList={parse:function selectorList(){return this.createSingleNodeList(this.SelectorList());}};var matches=selectorList;var not=selectorList;var ALLOW_OF_CLAUSE=true;var nthWithOfClause={parse:function nthWithOfClause(){return this.createSingleNodeList(this.Nth(ALLOW_OF_CLAUSE));}};var nthChild=nthWithOfClause;var nthLastChild=nthWithOfClause;var DISALLOW_OF_CLAUSE=false;var nth={parse:function nth(){return this.createSingleNodeList(this.Nth(DISALLOW_OF_CLAUSE));}};var nthLastOfType=nth;var nthOfType=nth;var slotted={parse:function compoundSelector(){return this.createSingleNodeList(this.Selector());}};var pseudo={'dir':dir,'has':has,'lang':lang,'matches':matches,'not':not,'nth-child':nthChild,'nth-last-child':nthLastChild,'nth-last-of-type':nthLastOfType,'nth-of-type':nthOfType,'slotted':slotted};var cmpChar$2=tokenizer.cmpChar;var isDigit$2=tokenizer.isDigit;var TYPE$b=tokenizer.TYPE;var WHITESPACE$5=TYPE$b.WhiteSpace;var COMMENT$4=TYPE$b.Comment;var IDENT$5=TYPE$b.Ident;var NUMBER$3=TYPE$b.Number;var DIMENSION$2=TYPE$b.Dimension;var PLUSSIGN$2=0x002B;// U+002B PLUS SIGN (+)\nvar HYPHENMINUS$1=0x002D;// U+002D HYPHEN-MINUS (-)\nvar N$1=0x006E;// U+006E LATIN SMALL LETTER N (n)\nvar DISALLOW_SIGN=true;var ALLOW_SIGN=false;function checkInteger(offset,disallowSign){var pos=this.scanner.tokenStart+offset;var code=this.scanner.source.charCodeAt(pos);if(code===PLUSSIGN$2||code===HYPHENMINUS$1){if(disallowSign){this.error('Number sign is not allowed');}pos++;}for(;pos<this.scanner.tokenEnd;pos++){if(!isDigit$2(this.scanner.source.charCodeAt(pos))){this.error('Integer is expected',pos);}}}function checkTokenIsInteger(disallowSign){return checkInteger.call(this,0,disallowSign);}function expectCharCode(offset,code){if(!cmpChar$2(this.scanner.source,this.scanner.tokenStart+offset,code)){var msg='';switch(code){case N$1:msg='N is expected';break;case HYPHENMINUS$1:msg='HyphenMinus is expected';break;}this.error(msg,this.scanner.tokenStart+offset);}}// ... <signed-integer>\n// ... ['+' | '-'] <signless-integer>\nfunction consumeB(){var offset=0;var sign=0;var type=this.scanner.tokenType;while(type===WHITESPACE$5||type===COMMENT$4){type=this.scanner.lookupType(++offset);}if(type!==NUMBER$3){if(this.scanner.isDelim(PLUSSIGN$2,offset)||this.scanner.isDelim(HYPHENMINUS$1,offset)){sign=this.scanner.isDelim(PLUSSIGN$2,offset)?PLUSSIGN$2:HYPHENMINUS$1;do{type=this.scanner.lookupType(++offset);}while(type===WHITESPACE$5||type===COMMENT$4);if(type!==NUMBER$3){this.scanner.skip(offset);checkTokenIsInteger.call(this,DISALLOW_SIGN);}}else{return null;}}if(offset>0){this.scanner.skip(offset);}if(sign===0){type=this.scanner.source.charCodeAt(this.scanner.tokenStart);if(type!==PLUSSIGN$2&&type!==HYPHENMINUS$1){this.error('Number sign is expected');}}checkTokenIsInteger.call(this,sign!==0);return sign===HYPHENMINUS$1?'-'+this.consume(NUMBER$3):this.consume(NUMBER$3);}// An+B microsyntax https://www.w3.org/TR/css-syntax-3/#anb\nvar AnPlusB={name:'AnPlusB',structure:{a:[String,null],b:[String,null]},parse:function(){/* eslint-disable brace-style*/var start=this.scanner.tokenStart;var a=null;var b=null;// <integer>\nif(this.scanner.tokenType===NUMBER$3){checkTokenIsInteger.call(this,ALLOW_SIGN);b=this.consume(NUMBER$3);}// -n\n// -n <signed-integer>\n// -n ['+' | '-'] <signless-integer>\n// -n- <signless-integer>\n// <dashndashdigit-ident>\nelse if(this.scanner.tokenType===IDENT$5&&cmpChar$2(this.scanner.source,this.scanner.tokenStart,HYPHENMINUS$1)){a='-1';expectCharCode.call(this,1,N$1);switch(this.scanner.getTokenLength()){// -n\n// -n <signed-integer>\n// -n ['+' | '-'] <signless-integer>\ncase 2:this.scanner.next();b=consumeB.call(this);break;// -n- <signless-integer>\ncase 3:expectCharCode.call(this,2,HYPHENMINUS$1);this.scanner.next();this.scanner.skipSC();checkTokenIsInteger.call(this,DISALLOW_SIGN);b='-'+this.consume(NUMBER$3);break;// <dashndashdigit-ident>\ndefault:expectCharCode.call(this,2,HYPHENMINUS$1);checkInteger.call(this,3,DISALLOW_SIGN);this.scanner.next();b=this.scanner.substrToCursor(start+2);}}// '+'? n\n// '+'? n <signed-integer>\n// '+'? n ['+' | '-'] <signless-integer>\n// '+'? n- <signless-integer>\n// '+'? <ndashdigit-ident>\nelse if(this.scanner.tokenType===IDENT$5||this.scanner.isDelim(PLUSSIGN$2)&&this.scanner.lookupType(1)===IDENT$5){var sign=0;a='1';// just ignore a plus\nif(this.scanner.isDelim(PLUSSIGN$2)){sign=1;this.scanner.next();}expectCharCode.call(this,0,N$1);switch(this.scanner.getTokenLength()){// '+'? n\n// '+'? n <signed-integer>\n// '+'? n ['+' | '-'] <signless-integer>\ncase 1:this.scanner.next();b=consumeB.call(this);break;// '+'? n- <signless-integer>\ncase 2:expectCharCode.call(this,1,HYPHENMINUS$1);this.scanner.next();this.scanner.skipSC();checkTokenIsInteger.call(this,DISALLOW_SIGN);b='-'+this.consume(NUMBER$3);break;// '+'? <ndashdigit-ident>\ndefault:expectCharCode.call(this,1,HYPHENMINUS$1);checkInteger.call(this,2,DISALLOW_SIGN);this.scanner.next();b=this.scanner.substrToCursor(start+sign+1);}}// <ndashdigit-dimension>\n// <ndash-dimension> <signless-integer>\n// <n-dimension>\n// <n-dimension> <signed-integer>\n// <n-dimension> ['+' | '-'] <signless-integer>\nelse if(this.scanner.tokenType===DIMENSION$2){var code=this.scanner.source.charCodeAt(this.scanner.tokenStart);var sign=code===PLUSSIGN$2||code===HYPHENMINUS$1;for(var i=this.scanner.tokenStart+sign;i<this.scanner.tokenEnd;i++){if(!isDigit$2(this.scanner.source.charCodeAt(i))){break;}}if(i===this.scanner.tokenStart+sign){this.error('Integer is expected',this.scanner.tokenStart+sign);}expectCharCode.call(this,i-this.scanner.tokenStart,N$1);a=this.scanner.source.substring(start,i);// <n-dimension>\n// <n-dimension> <signed-integer>\n// <n-dimension> ['+' | '-'] <signless-integer>\nif(i+1===this.scanner.tokenEnd){this.scanner.next();b=consumeB.call(this);}else{expectCharCode.call(this,i-this.scanner.tokenStart+1,HYPHENMINUS$1);// <ndash-dimension> <signless-integer>\nif(i+2===this.scanner.tokenEnd){this.scanner.next();this.scanner.skipSC();checkTokenIsInteger.call(this,DISALLOW_SIGN);b='-'+this.consume(NUMBER$3);}// <ndashdigit-dimension>\nelse{checkInteger.call(this,i-this.scanner.tokenStart+2,DISALLOW_SIGN);this.scanner.next();b=this.scanner.substrToCursor(i+1);}}}else{this.error();}if(a!==null&&a.charCodeAt(0)===PLUSSIGN$2){a=a.substr(1);}if(b!==null&&b.charCodeAt(0)===PLUSSIGN$2){b=b.substr(1);}return{type:'AnPlusB',loc:this.getLocation(start,this.scanner.tokenStart),a:a,b:b};},generate:function(node){var a=node.a!==null&&node.a!==undefined;var b=node.b!==null&&node.b!==undefined;if(a){this.chunk(node.a==='+1'?'+n':// eslint-disable-line operator-linebreak, indent\nnode.a==='1'?'n':// eslint-disable-line operator-linebreak, indent\nnode.a==='-1'?'-n':// eslint-disable-line operator-linebreak, indent\nnode.a+'n'// eslint-disable-line operator-linebreak, indent\n);if(b){b=String(node.b);if(b.charAt(0)==='-'||b.charAt(0)==='+'){this.chunk(b.charAt(0));this.chunk(b.substr(1));}else{this.chunk('+');this.chunk(b);}}}else{this.chunk(String(node.b));}}};var TYPE$c=tokenizer.TYPE;var rawMode$1=Raw.mode;var ATKEYWORD=TYPE$c.AtKeyword;var SEMICOLON=TYPE$c.Semicolon;var LEFTCURLYBRACKET=TYPE$c.LeftCurlyBracket;var RIGHTCURLYBRACKET=TYPE$c.RightCurlyBracket;function consumeRaw$1(startToken){return this.Raw(startToken,rawMode$1.leftCurlyBracketOrSemicolon,true);}function isDeclarationBlockAtrule(){for(var offset=1,type;type=this.scanner.lookupType(offset);offset++){if(type===RIGHTCURLYBRACKET){return true;}if(type===LEFTCURLYBRACKET||type===ATKEYWORD){return false;}}return false;}var Atrule={name:'Atrule',structure:{name:String,prelude:['AtrulePrelude','Raw',null],block:['Block',null]},parse:function(){var start=this.scanner.tokenStart;var name;var nameLowerCase;var prelude=null;var block=null;this.eat(ATKEYWORD);name=this.scanner.substrToCursor(start+1);nameLowerCase=name.toLowerCase();this.scanner.skipSC();// parse prelude\nif(this.scanner.eof===false&&this.scanner.tokenType!==LEFTCURLYBRACKET&&this.scanner.tokenType!==SEMICOLON){if(this.parseAtrulePrelude){prelude=this.parseWithFallback(this.AtrulePrelude.bind(this,name),consumeRaw$1);// turn empty AtrulePrelude into null\nif(prelude.type==='AtrulePrelude'&&prelude.children.head===null){prelude=null;}}else{prelude=consumeRaw$1.call(this,this.scanner.tokenIndex);}this.scanner.skipSC();}switch(this.scanner.tokenType){case SEMICOLON:this.scanner.next();break;case LEFTCURLYBRACKET:if(this.atrule.hasOwnProperty(nameLowerCase)&&typeof this.atrule[nameLowerCase].block==='function'){block=this.atrule[nameLowerCase].block.call(this);}else{// TODO: should consume block content as Raw?\nblock=this.Block(isDeclarationBlockAtrule.call(this));}break;}return{type:'Atrule',loc:this.getLocation(start,this.scanner.tokenStart),name:name,prelude:prelude,block:block};},generate:function(node){this.chunk('@');this.chunk(node.name);if(node.prelude!==null){this.chunk(' ');this.node(node.prelude);}if(node.block){this.node(node.block);}else{this.chunk(';');}},walkContext:'atrule'};var TYPE$d=tokenizer.TYPE;var SEMICOLON$1=TYPE$d.Semicolon;var LEFTCURLYBRACKET$1=TYPE$d.LeftCurlyBracket;var AtrulePrelude={name:'AtrulePrelude',structure:{children:[[]]},parse:function(name){var children=null;if(name!==null){name=name.toLowerCase();}this.scanner.skipSC();if(this.atrule.hasOwnProperty(name)&&typeof this.atrule[name].prelude==='function'){// custom consumer\nchildren=this.atrule[name].prelude.call(this);}else{// default consumer\nchildren=this.readSequence(this.scope.AtrulePrelude);}this.scanner.skipSC();if(this.scanner.eof!==true&&this.scanner.tokenType!==LEFTCURLYBRACKET$1&&this.scanner.tokenType!==SEMICOLON$1){this.error('Semicolon or block is expected');}if(children===null){children=this.createList();}return{type:'AtrulePrelude',loc:this.getLocationFromList(children),children:children};},generate:function(node){this.children(node);},walkContext:'atrulePrelude'};var TYPE$e=tokenizer.TYPE;var IDENT$6=TYPE$e.Ident;var STRING$2=TYPE$e.String;var COLON$2=TYPE$e.Colon;var LEFTSQUAREBRACKET$2=TYPE$e.LeftSquareBracket;var RIGHTSQUAREBRACKET=TYPE$e.RightSquareBracket;var DOLLARSIGN=0x0024;// U+0024 DOLLAR SIGN ($)\nvar ASTERISK$2=0x002A;// U+002A ASTERISK (*)\nvar EQUALSSIGN=0x003D;// U+003D EQUALS SIGN (=)\nvar CIRCUMFLEXACCENT=0x005E;// U+005E (^)\nvar VERTICALLINE$1=0x007C;// U+007C VERTICAL LINE (|)\nvar TILDE$1=0x007E;// U+007E TILDE (~)\nfunction getAttributeName(){if(this.scanner.eof){this.error('Unexpected end of input');}var start=this.scanner.tokenStart;var expectIdent=false;var checkColon=true;if(this.scanner.isDelim(ASTERISK$2)){expectIdent=true;checkColon=false;this.scanner.next();}else if(!this.scanner.isDelim(VERTICALLINE$1)){this.eat(IDENT$6);}if(this.scanner.isDelim(VERTICALLINE$1)){if(this.scanner.source.charCodeAt(this.scanner.tokenStart+1)!==EQUALSSIGN){this.scanner.next();this.eat(IDENT$6);}else if(expectIdent){this.error('Identifier is expected',this.scanner.tokenEnd);}}else if(expectIdent){this.error('Vertical line is expected');}if(checkColon&&this.scanner.tokenType===COLON$2){this.scanner.next();this.eat(IDENT$6);}return{type:'Identifier',loc:this.getLocation(start,this.scanner.tokenStart),name:this.scanner.substrToCursor(start)};}function getOperator(){var start=this.scanner.tokenStart;var code=this.scanner.source.charCodeAt(start);if(code!==EQUALSSIGN&&// =\ncode!==TILDE$1&&// ~=\ncode!==CIRCUMFLEXACCENT&&// ^=\ncode!==DOLLARSIGN&&// $=\ncode!==ASTERISK$2&&// *=\ncode!==VERTICALLINE$1// |=\n){this.error('Attribute selector (=, ~=, ^=, $=, *=, |=) is expected');}this.scanner.next();if(code!==EQUALSSIGN){if(!this.scanner.isDelim(EQUALSSIGN)){this.error('Equal sign is expected');}this.scanner.next();}return this.scanner.substrToCursor(start);}// '[' <wq-name> ']'\n// '[' <wq-name> <attr-matcher> [ <string-token> | <ident-token> ] <attr-modifier>? ']'\nvar AttributeSelector={name:'AttributeSelector',structure:{name:'Identifier',matcher:[String,null],value:['String','Identifier',null],flags:[String,null]},parse:function(){var start=this.scanner.tokenStart;var name;var matcher=null;var value=null;var flags=null;this.eat(LEFTSQUAREBRACKET$2);this.scanner.skipSC();name=getAttributeName.call(this);this.scanner.skipSC();if(this.scanner.tokenType!==RIGHTSQUAREBRACKET){// avoid case `[name i]`\nif(this.scanner.tokenType!==IDENT$6){matcher=getOperator.call(this);this.scanner.skipSC();value=this.scanner.tokenType===STRING$2?this.String():this.Identifier();this.scanner.skipSC();}// attribute flags\nif(this.scanner.tokenType===IDENT$6){flags=this.scanner.getTokenValue();this.scanner.next();this.scanner.skipSC();}}this.eat(RIGHTSQUAREBRACKET);return{type:'AttributeSelector',loc:this.getLocation(start,this.scanner.tokenStart),name:name,matcher:matcher,value:value,flags:flags};},generate:function(node){var flagsPrefix=' ';this.chunk('[');this.node(node.name);if(node.matcher!==null){this.chunk(node.matcher);if(node.value!==null){this.node(node.value);// space between string and flags is not required\nif(node.value.type==='String'){flagsPrefix='';}}}if(node.flags!==null){this.chunk(flagsPrefix);this.chunk(node.flags);}this.chunk(']');}};var TYPE$f=tokenizer.TYPE;var rawMode$2=Raw.mode;var WHITESPACE$6=TYPE$f.WhiteSpace;var COMMENT$5=TYPE$f.Comment;var SEMICOLON$2=TYPE$f.Semicolon;var ATKEYWORD$1=TYPE$f.AtKeyword;var LEFTCURLYBRACKET$2=TYPE$f.LeftCurlyBracket;var RIGHTCURLYBRACKET$1=TYPE$f.RightCurlyBracket;function consumeRaw$2(startToken){return this.Raw(startToken,null,true);}function consumeRule(){return this.parseWithFallback(this.Rule,consumeRaw$2);}function consumeRawDeclaration(startToken){return this.Raw(startToken,rawMode$2.semicolonIncluded,true);}function consumeDeclaration(){if(this.scanner.tokenType===SEMICOLON$2){return consumeRawDeclaration.call(this,this.scanner.tokenIndex);}var node=this.parseWithFallback(this.Declaration,consumeRawDeclaration);if(this.scanner.tokenType===SEMICOLON$2){this.scanner.next();}return node;}var Block={name:'Block',structure:{children:[['Atrule','Rule','Declaration']]},parse:function(isDeclaration){var consumer=isDeclaration?consumeDeclaration:consumeRule;var start=this.scanner.tokenStart;var children=this.createList();this.eat(LEFTCURLYBRACKET$2);scan:while(!this.scanner.eof){switch(this.scanner.tokenType){case RIGHTCURLYBRACKET$1:break scan;case WHITESPACE$6:case COMMENT$5:this.scanner.next();break;case ATKEYWORD$1:children.push(this.parseWithFallback(this.Atrule,consumeRaw$2));break;default:children.push(consumer.call(this));}}if(!this.scanner.eof){this.eat(RIGHTCURLYBRACKET$1);}return{type:'Block',loc:this.getLocation(start,this.scanner.tokenStart),children:children};},generate:function(node){this.chunk('{');this.children(node,function(prev){if(prev.type==='Declaration'){this.chunk(';');}});this.chunk('}');},walkContext:'block'};var TYPE$g=tokenizer.TYPE;var LEFTSQUAREBRACKET$3=TYPE$g.LeftSquareBracket;var RIGHTSQUAREBRACKET$1=TYPE$g.RightSquareBracket;var Brackets={name:'Brackets',structure:{children:[[]]},parse:function(readSequence,recognizer){var start=this.scanner.tokenStart;var children=null;this.eat(LEFTSQUAREBRACKET$3);children=readSequence.call(this,recognizer);if(!this.scanner.eof){this.eat(RIGHTSQUAREBRACKET$1);}return{type:'Brackets',loc:this.getLocation(start,this.scanner.tokenStart),children:children};},generate:function(node){this.chunk('[');this.children(node);this.chunk(']');}};var CDC=tokenizer.TYPE.CDC;var CDC_1={name:'CDC',structure:[],parse:function(){var start=this.scanner.tokenStart;this.eat(CDC);// -->\nreturn{type:'CDC',loc:this.getLocation(start,this.scanner.tokenStart)};},generate:function(){this.chunk('-->');}};var CDO=tokenizer.TYPE.CDO;var CDO_1={name:'CDO',structure:[],parse:function(){var start=this.scanner.tokenStart;this.eat(CDO);// <!--\nreturn{type:'CDO',loc:this.getLocation(start,this.scanner.tokenStart)};},generate:function(){this.chunk('<!--');}};var TYPE$h=tokenizer.TYPE;var IDENT$7=TYPE$h.Ident;var FULLSTOP$1=0x002E;// U+002E FULL STOP (.)\n// '.' ident\nvar ClassSelector={name:'ClassSelector',structure:{name:String},parse:function(){if(!this.scanner.isDelim(FULLSTOP$1)){this.error('Full stop is expected');}this.scanner.next();return{type:'ClassSelector',loc:this.getLocation(this.scanner.tokenStart-1,this.scanner.tokenEnd),name:this.consume(IDENT$7)};},generate:function(node){this.chunk('.');this.chunk(node.name);}};var TYPE$i=tokenizer.TYPE;var IDENT$8=TYPE$i.Ident;var PLUSSIGN$3=0x002B;// U+002B PLUS SIGN (+)\nvar SOLIDUS$2=0x002F;// U+002F SOLIDUS (/)\nvar GREATERTHANSIGN$1=0x003E;// U+003E GREATER-THAN SIGN (>)\nvar TILDE$2=0x007E;// U+007E TILDE (~)\n// + | > | ~ | /deep/\nvar Combinator={name:'Combinator',structure:{name:String},parse:function(){var start=this.scanner.tokenStart;var code=this.scanner.source.charCodeAt(this.scanner.tokenStart);switch(code){case GREATERTHANSIGN$1:case PLUSSIGN$3:case TILDE$2:this.scanner.next();break;case SOLIDUS$2:this.scanner.next();if(this.scanner.tokenType!==IDENT$8||this.scanner.lookupValue(0,'deep')===false){this.error('Identifier `deep` is expected');}this.scanner.next();if(!this.scanner.isDelim(SOLIDUS$2)){this.error('Solidus is expected');}this.scanner.next();break;default:this.error('Combinator is expected');}return{type:'Combinator',loc:this.getLocation(start,this.scanner.tokenStart),name:this.scanner.substrToCursor(start)};},generate:function(node){this.chunk(node.name);}};var TYPE$j=tokenizer.TYPE;var COMMENT$6=TYPE$j.Comment;var ASTERISK$3=0x002A;// U+002A ASTERISK (*)\nvar SOLIDUS$3=0x002F;// U+002F SOLIDUS (/)\n// '/*' .* '*/'\nvar Comment={name:'Comment',structure:{value:String},parse:function(){var start=this.scanner.tokenStart;var end=this.scanner.tokenEnd;this.eat(COMMENT$6);if(end-start+2>=2&&this.scanner.source.charCodeAt(end-2)===ASTERISK$3&&this.scanner.source.charCodeAt(end-1)===SOLIDUS$3){end-=2;}return{type:'Comment',loc:this.getLocation(start,this.scanner.tokenStart),value:this.scanner.source.substring(start+2,end)};},generate:function(node){this.chunk('/*');this.chunk(node.value);this.chunk('*/');}};var hasOwnProperty$1=Object.prototype.hasOwnProperty;var keywords$2=Object.create(null);var properties=Object.create(null);var HYPHENMINUS$2=45;// '-'.charCodeAt()\nfunction isCustomProperty(str,offset){offset=offset||0;return str.length-offset>=2&&str.charCodeAt(offset)===HYPHENMINUS$2&&str.charCodeAt(offset+1)===HYPHENMINUS$2;}function getVendorPrefix(str,offset){offset=offset||0;// verdor prefix should be at least 3 chars length\nif(str.length-offset>=3){// vendor prefix starts with hyper minus following non-hyper minus\nif(str.charCodeAt(offset)===HYPHENMINUS$2&&str.charCodeAt(offset+1)!==HYPHENMINUS$2){// vendor prefix should contain a hyper minus at the ending\nvar secondDashIndex=str.indexOf('-',offset+2);if(secondDashIndex!==-1){return str.substring(offset,secondDashIndex+1);}}}return'';}function getKeywordDescriptor(keyword){if(hasOwnProperty$1.call(keywords$2,keyword)){return keywords$2[keyword];}var name=keyword.toLowerCase();if(hasOwnProperty$1.call(keywords$2,name)){return keywords$2[keyword]=keywords$2[name];}var custom=isCustomProperty(name,0);var vendor=!custom?getVendorPrefix(name,0):'';return keywords$2[keyword]=Object.freeze({basename:name.substr(vendor.length),name:name,vendor:vendor,prefix:vendor,custom:custom});}function getPropertyDescriptor(property){if(hasOwnProperty$1.call(properties,property)){return properties[property];}var name=property;var hack=property[0];if(hack==='/'){hack=property[1]==='/'?'//':'/';}else if(hack!=='_'&&hack!=='*'&&hack!=='$'&&hack!=='#'&&hack!=='+'&&hack!=='&'){hack='';}var custom=isCustomProperty(name,hack.length);// re-use result when possible (the same as for lower case)\nif(!custom){name=name.toLowerCase();if(hasOwnProperty$1.call(properties,name)){return properties[property]=properties[name];}}var vendor=!custom?getVendorPrefix(name,hack.length):'';var prefix=name.substr(0,hack.length+vendor.length);return properties[property]=Object.freeze({basename:name.substr(prefix.length),name:name.substr(hack.length),hack:hack,vendor:vendor,prefix:prefix,custom:custom});}var names={keyword:getKeywordDescriptor,property:getPropertyDescriptor,isCustomProperty:isCustomProperty,vendorPrefix:getVendorPrefix};var isCustomProperty$1=names.isCustomProperty;var TYPE$k=tokenizer.TYPE;var rawMode$3=Raw.mode;var IDENT$9=TYPE$k.Ident;var HASH$3=TYPE$k.Hash;var COLON$3=TYPE$k.Colon;var SEMICOLON$3=TYPE$k.Semicolon;var DELIM$2=TYPE$k.Delim;var WHITESPACE$7=TYPE$k.WhiteSpace;var EXCLAMATIONMARK$1=0x0021;// U+0021 EXCLAMATION MARK (!)\nvar NUMBERSIGN$3=0x0023;// U+0023 NUMBER SIGN (#)\nvar DOLLARSIGN$1=0x0024;// U+0024 DOLLAR SIGN ($)\nvar AMPERSAND=0x0026;// U+0026 ANPERSAND (&)\nvar ASTERISK$4=0x002A;// U+002A ASTERISK (*)\nvar PLUSSIGN$4=0x002B;// U+002B PLUS SIGN (+)\nvar SOLIDUS$4=0x002F;// U+002F SOLIDUS (/)\nfunction consumeValueRaw(startToken){return this.Raw(startToken,rawMode$3.exclamationMarkOrSemicolon,true);}function consumeCustomPropertyRaw(startToken){return this.Raw(startToken,rawMode$3.exclamationMarkOrSemicolon,false);}function consumeValue(){var startValueToken=this.scanner.tokenIndex;var value=this.Value();if(value.type!=='Raw'&&this.scanner.eof===false&&this.scanner.tokenType!==SEMICOLON$3&&this.scanner.isDelim(EXCLAMATIONMARK$1)===false&&this.scanner.isBalanceEdge(startValueToken)===false){this.error();}return value;}var Declaration={name:'Declaration',structure:{important:[Boolean,String],property:String,value:['Value','Raw']},parse:function(){var start=this.scanner.tokenStart;var startToken=this.scanner.tokenIndex;var property=readProperty.call(this);var customProperty=isCustomProperty$1(property);var parseValue=customProperty?this.parseCustomProperty:this.parseValue;var consumeRaw=customProperty?consumeCustomPropertyRaw:consumeValueRaw;var important=false;var value;this.scanner.skipSC();this.eat(COLON$3);const valueStart=this.scanner.tokenIndex;if(!customProperty){this.scanner.skipSC();}if(parseValue){value=this.parseWithFallback(consumeValue,consumeRaw);}else{value=consumeRaw.call(this,this.scanner.tokenIndex);}if(customProperty&&value.type==='Value'&&value.children.isEmpty()){for(let offset=valueStart-this.scanner.tokenIndex;offset<=0;offset++){if(this.scanner.lookupType(offset)===WHITESPACE$7){value.children.appendData({type:'WhiteSpace',loc:null,value:' '});break;}}}if(this.scanner.isDelim(EXCLAMATIONMARK$1)){important=getImportant.call(this);this.scanner.skipSC();}// Do not include semicolon to range per spec\n// https://drafts.csswg.org/css-syntax/#declaration-diagram\nif(this.scanner.eof===false&&this.scanner.tokenType!==SEMICOLON$3&&this.scanner.isBalanceEdge(startToken)===false){this.error();}return{type:'Declaration',loc:this.getLocation(start,this.scanner.tokenStart),important:important,property:property,value:value};},generate:function(node){this.chunk(node.property);this.chunk(':');this.node(node.value);if(node.important){this.chunk(node.important===true?'!important':'!'+node.important);}},walkContext:'declaration'};function readProperty(){var start=this.scanner.tokenStart;// hacks\nif(this.scanner.tokenType===DELIM$2){switch(this.scanner.source.charCodeAt(this.scanner.tokenStart)){case ASTERISK$4:case DOLLARSIGN$1:case PLUSSIGN$4:case NUMBERSIGN$3:case AMPERSAND:this.scanner.next();break;// TODO: not sure we should support this hack\ncase SOLIDUS$4:this.scanner.next();if(this.scanner.isDelim(SOLIDUS$4)){this.scanner.next();}break;}}if(this.scanner.tokenType===HASH$3){this.eat(HASH$3);}else{this.eat(IDENT$9);}return this.scanner.substrToCursor(start);}// ! ws* important\nfunction getImportant(){this.eat(DELIM$2);this.scanner.skipSC();var important=this.consume(IDENT$9);// store original value in case it differ from `important`\n// for better original source restoring and hacks like `!ie` support\nreturn important==='important'?true:important;}var TYPE$l=tokenizer.TYPE;var rawMode$4=Raw.mode;var WHITESPACE$8=TYPE$l.WhiteSpace;var COMMENT$7=TYPE$l.Comment;var SEMICOLON$4=TYPE$l.Semicolon;function consumeRaw$3(startToken){return this.Raw(startToken,rawMode$4.semicolonIncluded,true);}var DeclarationList={name:'DeclarationList',structure:{children:[['Declaration']]},parse:function(){var children=this.createList();while(!this.scanner.eof){switch(this.scanner.tokenType){case WHITESPACE$8:case COMMENT$7:case SEMICOLON$4:this.scanner.next();break;default:children.push(this.parseWithFallback(this.Declaration,consumeRaw$3));}}return{type:'DeclarationList',loc:this.getLocationFromList(children),children:children};},generate:function(node){this.children(node,function(prev){if(prev.type==='Declaration'){this.chunk(';');}});}};var consumeNumber$2=utils.consumeNumber;var TYPE$m=tokenizer.TYPE;var DIMENSION$3=TYPE$m.Dimension;var Dimension={name:'Dimension',structure:{value:String,unit:String},parse:function(){var start=this.scanner.tokenStart;var numberEnd=consumeNumber$2(this.scanner.source,start);this.eat(DIMENSION$3);return{type:'Dimension',loc:this.getLocation(start,this.scanner.tokenStart),value:this.scanner.source.substring(start,numberEnd),unit:this.scanner.source.substring(numberEnd,this.scanner.tokenStart)};},generate:function(node){this.chunk(node.value);this.chunk(node.unit);}};var TYPE$n=tokenizer.TYPE;var RIGHTPARENTHESIS=TYPE$n.RightParenthesis;// <function-token> <sequence> )\nvar _Function={name:'Function',structure:{name:String,children:[[]]},parse:function(readSequence,recognizer){var start=this.scanner.tokenStart;var name=this.consumeFunctionName();var nameLowerCase=name.toLowerCase();var children;children=recognizer.hasOwnProperty(nameLowerCase)?recognizer[nameLowerCase].call(this,recognizer):readSequence.call(this,recognizer);if(!this.scanner.eof){this.eat(RIGHTPARENTHESIS);}return{type:'Function',loc:this.getLocation(start,this.scanner.tokenStart),name:name,children:children};},generate:function(node){this.chunk(node.name);this.chunk('(');this.children(node);this.chunk(')');},walkContext:'function'};var TYPE$o=tokenizer.TYPE;var HASH$4=TYPE$o.Hash;// '#' ident\nvar Hash={name:'Hash',structure:{value:String},parse:function(){var start=this.scanner.tokenStart;this.eat(HASH$4);return{type:'Hash',loc:this.getLocation(start,this.scanner.tokenStart),value:this.scanner.substrToCursor(start+1)};},generate:function(node){this.chunk('#');this.chunk(node.value);}};var TYPE$p=tokenizer.TYPE;var IDENT$a=TYPE$p.Ident;var Identifier={name:'Identifier',structure:{name:String},parse:function(){return{type:'Identifier',loc:this.getLocation(this.scanner.tokenStart,this.scanner.tokenEnd),name:this.consume(IDENT$a)};},generate:function(node){this.chunk(node.name);}};var TYPE$q=tokenizer.TYPE;var HASH$5=TYPE$q.Hash;// <hash-token>\nvar IdSelector={name:'IdSelector',structure:{name:String},parse:function(){var start=this.scanner.tokenStart;// TODO: check value is an ident\nthis.eat(HASH$5);return{type:'IdSelector',loc:this.getLocation(start,this.scanner.tokenStart),name:this.scanner.substrToCursor(start+1)};},generate:function(node){this.chunk('#');this.chunk(node.name);}};var TYPE$r=tokenizer.TYPE;var IDENT$b=TYPE$r.Ident;var NUMBER$4=TYPE$r.Number;var DIMENSION$4=TYPE$r.Dimension;var LEFTPARENTHESIS$3=TYPE$r.LeftParenthesis;var RIGHTPARENTHESIS$1=TYPE$r.RightParenthesis;var COLON$4=TYPE$r.Colon;var DELIM$3=TYPE$r.Delim;var MediaFeature={name:'MediaFeature',structure:{name:String,value:['Identifier','Number','Dimension','Ratio',null]},parse:function(){var start=this.scanner.tokenStart;var name;var value=null;this.eat(LEFTPARENTHESIS$3);this.scanner.skipSC();name=this.consume(IDENT$b);this.scanner.skipSC();if(this.scanner.tokenType!==RIGHTPARENTHESIS$1){this.eat(COLON$4);this.scanner.skipSC();switch(this.scanner.tokenType){case NUMBER$4:if(this.lookupNonWSType(1)===DELIM$3){value=this.Ratio();}else{value=this.Number();}break;case DIMENSION$4:value=this.Dimension();break;case IDENT$b:value=this.Identifier();break;default:this.error('Number, dimension, ratio or identifier is expected');}this.scanner.skipSC();}this.eat(RIGHTPARENTHESIS$1);return{type:'MediaFeature',loc:this.getLocation(start,this.scanner.tokenStart),name:name,value:value};},generate:function(node){this.chunk('(');this.chunk(node.name);if(node.value!==null){this.chunk(':');this.node(node.value);}this.chunk(')');}};var TYPE$s=tokenizer.TYPE;var WHITESPACE$9=TYPE$s.WhiteSpace;var COMMENT$8=TYPE$s.Comment;var IDENT$c=TYPE$s.Ident;var LEFTPARENTHESIS$4=TYPE$s.LeftParenthesis;var MediaQuery={name:'MediaQuery',structure:{children:[['Identifier','MediaFeature','WhiteSpace']]},parse:function(){this.scanner.skipSC();var children=this.createList();var child=null;var space=null;scan:while(!this.scanner.eof){switch(this.scanner.tokenType){case COMMENT$8:this.scanner.next();continue;case WHITESPACE$9:space=this.WhiteSpace();continue;case IDENT$c:child=this.Identifier();break;case LEFTPARENTHESIS$4:child=this.MediaFeature();break;default:break scan;}if(space!==null){children.push(space);space=null;}children.push(child);}if(child===null){this.error('Identifier or parenthesis is expected');}return{type:'MediaQuery',loc:this.getLocationFromList(children),children:children};},generate:function(node){this.children(node);}};var COMMA$2=tokenizer.TYPE.Comma;var MediaQueryList={name:'MediaQueryList',structure:{children:[['MediaQuery']]},parse:function(relative){var children=this.createList();this.scanner.skipSC();while(!this.scanner.eof){children.push(this.MediaQuery(relative));if(this.scanner.tokenType!==COMMA$2){break;}this.scanner.next();}return{type:'MediaQueryList',loc:this.getLocationFromList(children),children:children};},generate:function(node){this.children(node,function(){this.chunk(',');});}};var Nth={name:'Nth',structure:{nth:['AnPlusB','Identifier'],selector:['SelectorList',null]},parse:function(allowOfClause){this.scanner.skipSC();var start=this.scanner.tokenStart;var end=start;var selector=null;var query;if(this.scanner.lookupValue(0,'odd')||this.scanner.lookupValue(0,'even')){query=this.Identifier();}else{query=this.AnPlusB();}this.scanner.skipSC();if(allowOfClause&&this.scanner.lookupValue(0,'of')){this.scanner.next();selector=this.SelectorList();if(this.needPositions){end=this.getLastListNode(selector.children).loc.end.offset;}}else{if(this.needPositions){end=query.loc.end.offset;}}return{type:'Nth',loc:this.getLocation(start,end),nth:query,selector:selector};},generate:function(node){this.node(node.nth);if(node.selector!==null){this.chunk(' of ');this.node(node.selector);}}};var NUMBER$5=tokenizer.TYPE.Number;var _Number={name:'Number',structure:{value:String},parse:function(){return{type:'Number',loc:this.getLocation(this.scanner.tokenStart,this.scanner.tokenEnd),value:this.consume(NUMBER$5)};},generate:function(node){this.chunk(node.value);}};// '/' | '*' | ',' | ':' | '+' | '-'\nvar Operator={name:'Operator',structure:{value:String},parse:function(){var start=this.scanner.tokenStart;this.scanner.next();return{type:'Operator',loc:this.getLocation(start,this.scanner.tokenStart),value:this.scanner.substrToCursor(start)};},generate:function(node){this.chunk(node.value);}};var TYPE$t=tokenizer.TYPE;var LEFTPARENTHESIS$5=TYPE$t.LeftParenthesis;var RIGHTPARENTHESIS$2=TYPE$t.RightParenthesis;var Parentheses={name:'Parentheses',structure:{children:[[]]},parse:function(readSequence,recognizer){var start=this.scanner.tokenStart;var children=null;this.eat(LEFTPARENTHESIS$5);children=readSequence.call(this,recognizer);if(!this.scanner.eof){this.eat(RIGHTPARENTHESIS$2);}return{type:'Parentheses',loc:this.getLocation(start,this.scanner.tokenStart),children:children};},generate:function(node){this.chunk('(');this.children(node);this.chunk(')');}};var consumeNumber$3=utils.consumeNumber;var TYPE$u=tokenizer.TYPE;var PERCENTAGE$3=TYPE$u.Percentage;var Percentage={name:'Percentage',structure:{value:String},parse:function(){var start=this.scanner.tokenStart;var numberEnd=consumeNumber$3(this.scanner.source,start);this.eat(PERCENTAGE$3);return{type:'Percentage',loc:this.getLocation(start,this.scanner.tokenStart),value:this.scanner.source.substring(start,numberEnd)};},generate:function(node){this.chunk(node.value);this.chunk('%');}};var TYPE$v=tokenizer.TYPE;var IDENT$d=TYPE$v.Ident;var FUNCTION$4=TYPE$v.Function;var COLON$5=TYPE$v.Colon;var RIGHTPARENTHESIS$3=TYPE$v.RightParenthesis;// : [ <ident> | <function-token> <any-value>? ) ]\nvar PseudoClassSelector={name:'PseudoClassSelector',structure:{name:String,children:[['Raw'],null]},parse:function(){var start=this.scanner.tokenStart;var children=null;var name;var nameLowerCase;this.eat(COLON$5);if(this.scanner.tokenType===FUNCTION$4){name=this.consumeFunctionName();nameLowerCase=name.toLowerCase();if(this.pseudo.hasOwnProperty(nameLowerCase)){this.scanner.skipSC();children=this.pseudo[nameLowerCase].call(this);this.scanner.skipSC();}else{children=this.createList();children.push(this.Raw(this.scanner.tokenIndex,null,false));}this.eat(RIGHTPARENTHESIS$3);}else{name=this.consume(IDENT$d);}return{type:'PseudoClassSelector',loc:this.getLocation(start,this.scanner.tokenStart),name:name,children:children};},generate:function(node){this.chunk(':');this.chunk(node.name);if(node.children!==null){this.chunk('(');this.children(node);this.chunk(')');}},walkContext:'function'};var TYPE$w=tokenizer.TYPE;var IDENT$e=TYPE$w.Ident;var FUNCTION$5=TYPE$w.Function;var COLON$6=TYPE$w.Colon;var RIGHTPARENTHESIS$4=TYPE$w.RightParenthesis;// :: [ <ident> | <function-token> <any-value>? ) ]\nvar PseudoElementSelector={name:'PseudoElementSelector',structure:{name:String,children:[['Raw'],null]},parse:function(){var start=this.scanner.tokenStart;var children=null;var name;var nameLowerCase;this.eat(COLON$6);this.eat(COLON$6);if(this.scanner.tokenType===FUNCTION$5){name=this.consumeFunctionName();nameLowerCase=name.toLowerCase();if(this.pseudo.hasOwnProperty(nameLowerCase)){this.scanner.skipSC();children=this.pseudo[nameLowerCase].call(this);this.scanner.skipSC();}else{children=this.createList();children.push(this.Raw(this.scanner.tokenIndex,null,false));}this.eat(RIGHTPARENTHESIS$4);}else{name=this.consume(IDENT$e);}return{type:'PseudoElementSelector',loc:this.getLocation(start,this.scanner.tokenStart),name:name,children:children};},generate:function(node){this.chunk('::');this.chunk(node.name);if(node.children!==null){this.chunk('(');this.children(node);this.chunk(')');}},walkContext:'function'};var isDigit$3=tokenizer.isDigit;var TYPE$x=tokenizer.TYPE;var NUMBER$6=TYPE$x.Number;var DELIM$4=TYPE$x.Delim;var SOLIDUS$5=0x002F;// U+002F SOLIDUS (/)\nvar FULLSTOP$2=0x002E;// U+002E FULL STOP (.)\n// Terms of <ratio> should be a positive numbers (not zero or negative)\n// (see https://drafts.csswg.org/mediaqueries-3/#values)\n// However, -o-min-device-pixel-ratio takes fractional values as a ratio's term\n// and this is using by various sites. Therefore we relax checking on parse\n// to test a term is unsigned number without an exponent part.\n// Additional checking may be applied on lexer validation.\nfunction consumeNumber$4(){this.scanner.skipWS();var value=this.consume(NUMBER$6);for(var i=0;i<value.length;i++){var code=value.charCodeAt(i);if(!isDigit$3(code)&&code!==FULLSTOP$2){this.error('Unsigned number is expected',this.scanner.tokenStart-value.length+i);}}if(Number(value)===0){this.error('Zero number is not allowed',this.scanner.tokenStart-value.length);}return value;}// <positive-integer> S* '/' S* <positive-integer>\nvar Ratio={name:'Ratio',structure:{left:String,right:String},parse:function(){var start=this.scanner.tokenStart;var left=consumeNumber$4.call(this);var right;this.scanner.skipWS();if(!this.scanner.isDelim(SOLIDUS$5)){this.error('Solidus is expected');}this.eat(DELIM$4);right=consumeNumber$4.call(this);return{type:'Ratio',loc:this.getLocation(start,this.scanner.tokenStart),left:left,right:right};},generate:function(node){this.chunk(node.left);this.chunk('/');this.chunk(node.right);}};var TYPE$y=tokenizer.TYPE;var rawMode$5=Raw.mode;var LEFTCURLYBRACKET$3=TYPE$y.LeftCurlyBracket;function consumeRaw$4(startToken){return this.Raw(startToken,rawMode$5.leftCurlyBracket,true);}function consumePrelude(){var prelude=this.SelectorList();if(prelude.type!=='Raw'&&this.scanner.eof===false&&this.scanner.tokenType!==LEFTCURLYBRACKET$3){this.error();}return prelude;}var Rule={name:'Rule',structure:{prelude:['SelectorList','Raw'],block:['Block']},parse:function(){var startToken=this.scanner.tokenIndex;var startOffset=this.scanner.tokenStart;var prelude;var block;if(this.parseRulePrelude){prelude=this.parseWithFallback(consumePrelude,consumeRaw$4);}else{prelude=consumeRaw$4.call(this,startToken);}block=this.Block(true);return{type:'Rule',loc:this.getLocation(startOffset,this.scanner.tokenStart),prelude:prelude,block:block};},generate:function(node){this.node(node.prelude);this.node(node.block);},walkContext:'rule'};var Selector={name:'Selector',structure:{children:[['TypeSelector','IdSelector','ClassSelector','AttributeSelector','PseudoClassSelector','PseudoElementSelector','Combinator','WhiteSpace']]},parse:function(){var children=this.readSequence(this.scope.Selector);// nothing were consumed\nif(this.getFirstListNode(children)===null){this.error('Selector is expected');}return{type:'Selector',loc:this.getLocationFromList(children),children:children};},generate:function(node){this.children(node);}};var TYPE$z=tokenizer.TYPE;var COMMA$3=TYPE$z.Comma;var SelectorList={name:'SelectorList',structure:{children:[['Selector','Raw']]},parse:function(){var children=this.createList();while(!this.scanner.eof){children.push(this.Selector());if(this.scanner.tokenType===COMMA$3){this.scanner.next();continue;}break;}return{type:'SelectorList',loc:this.getLocationFromList(children),children:children};},generate:function(node){this.children(node,function(){this.chunk(',');});},walkContext:'selector'};var STRING$3=tokenizer.TYPE.String;var _String={name:'String',structure:{value:String},parse:function(){return{type:'String',loc:this.getLocation(this.scanner.tokenStart,this.scanner.tokenEnd),value:this.consume(STRING$3)};},generate:function(node){this.chunk(node.value);}};var TYPE$A=tokenizer.TYPE;var WHITESPACE$a=TYPE$A.WhiteSpace;var COMMENT$9=TYPE$A.Comment;var ATKEYWORD$2=TYPE$A.AtKeyword;var CDO$1=TYPE$A.CDO;var CDC$1=TYPE$A.CDC;var EXCLAMATIONMARK$2=0x0021;// U+0021 EXCLAMATION MARK (!)\nfunction consumeRaw$5(startToken){return this.Raw(startToken,null,false);}var StyleSheet={name:'StyleSheet',structure:{children:[['Comment','CDO','CDC','Atrule','Rule','Raw']]},parse:function(){var start=this.scanner.tokenStart;var children=this.createList();var child;while(!this.scanner.eof){switch(this.scanner.tokenType){case WHITESPACE$a:this.scanner.next();continue;case COMMENT$9:// ignore comments except exclamation comments (i.e. /*! .. */) on top level\nif(this.scanner.source.charCodeAt(this.scanner.tokenStart+2)!==EXCLAMATIONMARK$2){this.scanner.next();continue;}child=this.Comment();break;case CDO$1:// <!--\nchild=this.CDO();break;case CDC$1:// -->\nchild=this.CDC();break;// CSS Syntax Module Level 3\n// §2.2 Error handling\n// At the \"top level\" of a stylesheet, an <at-keyword-token> starts an at-rule.\ncase ATKEYWORD$2:child=this.parseWithFallback(this.Atrule,consumeRaw$5);break;// Anything else starts a qualified rule ...\ndefault:child=this.parseWithFallback(this.Rule,consumeRaw$5);}children.push(child);}return{type:'StyleSheet',loc:this.getLocation(start,this.scanner.tokenStart),children:children};},generate:function(node){this.children(node);},walkContext:'stylesheet'};var TYPE$B=tokenizer.TYPE;var IDENT$f=TYPE$B.Ident;var ASTERISK$5=0x002A;// U+002A ASTERISK (*)\nvar VERTICALLINE$2=0x007C;// U+007C VERTICAL LINE (|)\nfunction eatIdentifierOrAsterisk(){if(this.scanner.tokenType!==IDENT$f&&this.scanner.isDelim(ASTERISK$5)===false){this.error('Identifier or asterisk is expected');}this.scanner.next();}// ident\n// ident|ident\n// ident|*\n// *\n// *|ident\n// *|*\n// |ident\n// |*\nvar TypeSelector={name:'TypeSelector',structure:{name:String},parse:function(){var start=this.scanner.tokenStart;if(this.scanner.isDelim(VERTICALLINE$2)){this.scanner.next();eatIdentifierOrAsterisk.call(this);}else{eatIdentifierOrAsterisk.call(this);if(this.scanner.isDelim(VERTICALLINE$2)){this.scanner.next();eatIdentifierOrAsterisk.call(this);}}return{type:'TypeSelector',loc:this.getLocation(start,this.scanner.tokenStart),name:this.scanner.substrToCursor(start)};},generate:function(node){this.chunk(node.name);}};var isHexDigit$3=tokenizer.isHexDigit;var cmpChar$3=tokenizer.cmpChar;var TYPE$C=tokenizer.TYPE;var NAME$3=tokenizer.NAME;var IDENT$g=TYPE$C.Ident;var NUMBER$7=TYPE$C.Number;var DIMENSION$5=TYPE$C.Dimension;var PLUSSIGN$5=0x002B;// U+002B PLUS SIGN (+)\nvar HYPHENMINUS$3=0x002D;// U+002D HYPHEN-MINUS (-)\nvar QUESTIONMARK=0x003F;// U+003F QUESTION MARK (?)\nvar U$1=0x0075;// U+0075 LATIN SMALL LETTER U (u)\nfunction eatHexSequence(offset,allowDash){for(var pos=this.scanner.tokenStart+offset,len=0;pos<this.scanner.tokenEnd;pos++){var code=this.scanner.source.charCodeAt(pos);if(code===HYPHENMINUS$3&&allowDash&&len!==0){if(eatHexSequence.call(this,offset+len+1,false)===0){this.error();}return-1;}if(!isHexDigit$3(code)){this.error(allowDash&&len!==0?'HyphenMinus'+(len<6?' or hex digit':'')+' is expected':len<6?'Hex digit is expected':'Unexpected input',pos);}if(++len>6){this.error('Too many hex digits',pos);}}this.scanner.next();return len;}function eatQuestionMarkSequence(max){var count=0;while(this.scanner.isDelim(QUESTIONMARK)){if(++count>max){this.error('Too many question marks');}this.scanner.next();}}function startsWith(code){if(this.scanner.source.charCodeAt(this.scanner.tokenStart)!==code){this.error(NAME$3[code]+' is expected');}}// https://drafts.csswg.org/css-syntax/#urange\n// Informally, the <urange> production has three forms:\n// U+0001\n//      Defines a range consisting of a single code point, in this case the code point \"1\".\n// U+0001-00ff\n//      Defines a range of codepoints between the first and the second value, in this case\n//      the range between \"1\" and \"ff\" (255 in decimal) inclusive.\n// U+00??\n//      Defines a range of codepoints where the \"?\" characters range over all hex digits,\n//      in this case defining the same as the value U+0000-00ff.\n// In each form, a maximum of 6 digits is allowed for each hexadecimal number (if you treat \"?\" as a hexadecimal digit).\n//\n// <urange> =\n//   u '+' <ident-token> '?'* |\n//   u <dimension-token> '?'* |\n//   u <number-token> '?'* |\n//   u <number-token> <dimension-token> |\n//   u <number-token> <number-token> |\n//   u '+' '?'+\nfunction scanUnicodeRange(){var hexLength=0;// u '+' <ident-token> '?'*\n// u '+' '?'+\nif(this.scanner.isDelim(PLUSSIGN$5)){this.scanner.next();if(this.scanner.tokenType===IDENT$g){hexLength=eatHexSequence.call(this,0,true);if(hexLength>0){eatQuestionMarkSequence.call(this,6-hexLength);}return;}if(this.scanner.isDelim(QUESTIONMARK)){this.scanner.next();eatQuestionMarkSequence.call(this,5);return;}this.error('Hex digit or question mark is expected');return;}// u <number-token> '?'*\n// u <number-token> <dimension-token>\n// u <number-token> <number-token>\nif(this.scanner.tokenType===NUMBER$7){startsWith.call(this,PLUSSIGN$5);hexLength=eatHexSequence.call(this,1,true);if(this.scanner.isDelim(QUESTIONMARK)){eatQuestionMarkSequence.call(this,6-hexLength);return;}if(this.scanner.tokenType===DIMENSION$5||this.scanner.tokenType===NUMBER$7){startsWith.call(this,HYPHENMINUS$3);eatHexSequence.call(this,1,false);return;}return;}// u <dimension-token> '?'*\nif(this.scanner.tokenType===DIMENSION$5){startsWith.call(this,PLUSSIGN$5);hexLength=eatHexSequence.call(this,1,true);if(hexLength>0){eatQuestionMarkSequence.call(this,6-hexLength);}return;}this.error();}var UnicodeRange={name:'UnicodeRange',structure:{value:String},parse:function(){var start=this.scanner.tokenStart;// U or u\nif(!cmpChar$3(this.scanner.source,start,U$1)){this.error('U is expected');}if(!cmpChar$3(this.scanner.source,start+1,PLUSSIGN$5)){this.error('Plus sign is expected');}this.scanner.next();scanUnicodeRange.call(this);return{type:'UnicodeRange',loc:this.getLocation(start,this.scanner.tokenStart),value:this.scanner.substrToCursor(start)};},generate:function(node){this.chunk(node.value);}};var isWhiteSpace$2=tokenizer.isWhiteSpace;var cmpStr$5=tokenizer.cmpStr;var TYPE$D=tokenizer.TYPE;var FUNCTION$6=TYPE$D.Function;var URL$4=TYPE$D.Url;var RIGHTPARENTHESIS$5=TYPE$D.RightParenthesis;// <url-token> | <function-token> <string> )\nvar Url={name:'Url',structure:{value:['String','Raw']},parse:function(){var start=this.scanner.tokenStart;var value;switch(this.scanner.tokenType){case URL$4:var rawStart=start+4;var rawEnd=this.scanner.tokenEnd-1;while(rawStart<rawEnd&&isWhiteSpace$2(this.scanner.source.charCodeAt(rawStart))){rawStart++;}while(rawStart<rawEnd&&isWhiteSpace$2(this.scanner.source.charCodeAt(rawEnd-1))){rawEnd--;}value={type:'Raw',loc:this.getLocation(rawStart,rawEnd),value:this.scanner.source.substring(rawStart,rawEnd)};this.eat(URL$4);break;case FUNCTION$6:if(!cmpStr$5(this.scanner.source,this.scanner.tokenStart,this.scanner.tokenEnd,'url(')){this.error('Function name must be `url`');}this.eat(FUNCTION$6);this.scanner.skipSC();value=this.String();this.scanner.skipSC();this.eat(RIGHTPARENTHESIS$5);break;default:this.error('Url or Function is expected');}return{type:'Url',loc:this.getLocation(start,this.scanner.tokenStart),value:value};},generate:function(node){this.chunk('url');this.chunk('(');this.node(node.value);this.chunk(')');}};var Value={name:'Value',structure:{children:[[]]},parse:function(){var start=this.scanner.tokenStart;var children=this.readSequence(this.scope.Value);return{type:'Value',loc:this.getLocation(start,this.scanner.tokenStart),children:children};},generate:function(node){this.children(node);}};var WHITESPACE$b=tokenizer.TYPE.WhiteSpace;var SPACE=Object.freeze({type:'WhiteSpace',loc:null,value:' '});var WhiteSpace$1={name:'WhiteSpace',structure:{value:String},parse:function(){this.eat(WHITESPACE$b);return SPACE;// return {\n//     type: 'WhiteSpace',\n//     loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\n//     value: this.consume(WHITESPACE)\n// };\n},generate:function(node){this.chunk(node.value);}};var node={AnPlusB:AnPlusB,Atrule:Atrule,AtrulePrelude:AtrulePrelude,AttributeSelector:AttributeSelector,Block:Block,Brackets:Brackets,CDC:CDC_1,CDO:CDO_1,ClassSelector:ClassSelector,Combinator:Combinator,Comment:Comment,Declaration:Declaration,DeclarationList:DeclarationList,Dimension:Dimension,Function:_Function,Hash:Hash,Identifier:Identifier,IdSelector:IdSelector,MediaFeature:MediaFeature,MediaQuery:MediaQuery,MediaQueryList:MediaQueryList,Nth:Nth,Number:_Number,Operator:Operator,Parentheses:Parentheses,Percentage:Percentage,PseudoClassSelector:PseudoClassSelector,PseudoElementSelector:PseudoElementSelector,Ratio:Ratio,Raw:Raw,Rule:Rule,Selector:Selector,SelectorList:SelectorList,String:_String,StyleSheet:StyleSheet,TypeSelector:TypeSelector,UnicodeRange:UnicodeRange,Url:Url,Value:Value,WhiteSpace:WhiteSpace$1};var parser={parseContext:{default:'StyleSheet',stylesheet:'StyleSheet',atrule:'Atrule',atrulePrelude:function(options){return this.AtrulePrelude(options.atrule?String(options.atrule):null);},mediaQueryList:'MediaQueryList',mediaQuery:'MediaQuery',rule:'Rule',selectorList:'SelectorList',selector:'Selector',block:function(){return this.Block(true);},declarationList:'DeclarationList',declaration:'Declaration',value:'Value'},scope:scope,atrule:atrule,pseudo:pseudo,node:node};var parser$1=create(parser);const regex_closing_style_tag=/<\\/style\\s*>/;function read_style(parser,start,attributes){const content_start=parser.index;const styles=parser.read_until(regex_closing_style_tag,parser_errors.unclosed_style);if(parser.index>=parser.template.length){parser.error(parser_errors.unclosed_style);}const content_end=parser.index;let ast;try{ast=parser$1(styles,{positions:true,offset:content_start,onParseError(error){throw error;}});}catch(err){if(err.name==='SyntaxError'){parser.error(parser_errors.css_syntax_error(err.message),err.offset);}else{throw err;}}ast=JSON.parse(JSON.stringify(ast));// tidy up AST\nwalk(ast,{enter:node=>{// replace `ref:a` nodes\nif(node.type==='Selector'){for(let i=0;i<node.children.length;i+=1){const a=node.children[i];const b=node.children[i+1];if(is_ref_selector(a,b)){parser.error(parser_errors.invalid_ref_selector,a.loc.start.offset);}}}if(node.type==='Declaration'&&node.value.type==='Value'&&node.value.children.length===0){parser.error(parser_errors.invalid_declaration,node.start);}if(node.type==='PseudoClassSelector'&&node.name==='global'&&node.children===null){parser.error(parser_errors.empty_global_selector,node.loc.start.offset);}if(node.loc){node.start=node.loc.start.offset;node.end=node.loc.end.offset;delete node.loc;}}});parser.read(regex_closing_style_tag);const end=parser.index;return{type:'Style',start,end,attributes,children:ast.children,content:{start:content_start,end:content_end,styles}};}function is_ref_selector(a,b){if(!b)return false;return a.type==='TypeSelector'&&a.name==='ref'&&b.type==='PseudoClassSelector';}// https://dev.w3.org/html5/html-author/charref\nvar entities={CounterClockwiseContourIntegral:8755,ClockwiseContourIntegral:8754,DoubleLongLeftRightArrow:10234,DiacriticalDoubleAcute:733,NotSquareSupersetEqual:8931,CloseCurlyDoubleQuote:8221,DoubleContourIntegral:8751,FilledVerySmallSquare:9642,NegativeVeryThinSpace:8203,NotPrecedesSlantEqual:8928,NotRightTriangleEqual:8941,NotSucceedsSlantEqual:8929,CapitalDifferentialD:8517,DoubleLeftRightArrow:8660,DoubleLongRightArrow:10233,EmptyVerySmallSquare:9643,NestedGreaterGreater:8811,NotDoubleVerticalBar:8742,NotLeftTriangleEqual:8940,NotSquareSubsetEqual:8930,OpenCurlyDoubleQuote:8220,ReverseUpEquilibrium:10607,DoubleLongLeftArrow:10232,DownLeftRightVector:10576,LeftArrowRightArrow:8646,NegativeMediumSpace:8203,RightArrowLeftArrow:8644,SquareSupersetEqual:8850,leftrightsquigarrow:8621,DownRightTeeVector:10591,DownRightVectorBar:10583,LongLeftRightArrow:10231,Longleftrightarrow:10234,NegativeThickSpace:8203,PrecedesSlantEqual:8828,ReverseEquilibrium:8651,RightDoubleBracket:10215,RightDownTeeVector:10589,RightDownVectorBar:10581,RightTriangleEqual:8885,SquareIntersection:8851,SucceedsSlantEqual:8829,blacktriangleright:9656,longleftrightarrow:10231,DoubleUpDownArrow:8661,DoubleVerticalBar:8741,DownLeftTeeVector:10590,DownLeftVectorBar:10582,FilledSmallSquare:9724,GreaterSlantEqual:10878,LeftDoubleBracket:10214,LeftDownTeeVector:10593,LeftDownVectorBar:10585,LeftTriangleEqual:8884,NegativeThinSpace:8203,NotReverseElement:8716,NotTildeFullEqual:8775,RightAngleBracket:10217,RightUpDownVector:10575,SquareSubsetEqual:8849,VerticalSeparator:10072,blacktriangledown:9662,blacktriangleleft:9666,leftrightharpoons:8651,rightleftharpoons:8652,twoheadrightarrow:8608,DiacriticalAcute:180,DiacriticalGrave:96,DiacriticalTilde:732,DoubleRightArrow:8658,DownArrowUpArrow:8693,EmptySmallSquare:9723,GreaterEqualLess:8923,GreaterFullEqual:8807,LeftAngleBracket:10216,LeftUpDownVector:10577,LessEqualGreater:8922,NonBreakingSpace:160,NotRightTriangle:8939,NotSupersetEqual:8841,RightTriangleBar:10704,RightUpTeeVector:10588,RightUpVectorBar:10580,UnderParenthesis:9181,UpArrowDownArrow:8645,circlearrowright:8635,downharpoonright:8642,ntrianglerighteq:8941,rightharpoondown:8641,rightrightarrows:8649,twoheadleftarrow:8606,vartriangleright:8883,CloseCurlyQuote:8217,ContourIntegral:8750,DoubleDownArrow:8659,DoubleLeftArrow:8656,DownRightVector:8641,LeftRightVector:10574,LeftTriangleBar:10703,LeftUpTeeVector:10592,LeftUpVectorBar:10584,LowerRightArrow:8600,NotGreaterEqual:8817,NotGreaterTilde:8821,NotLeftTriangle:8938,OverParenthesis:9180,RightDownVector:8642,ShortRightArrow:8594,UpperRightArrow:8599,bigtriangledown:9661,circlearrowleft:8634,curvearrowright:8631,downharpoonleft:8643,leftharpoondown:8637,leftrightarrows:8646,nLeftrightarrow:8654,nleftrightarrow:8622,ntrianglelefteq:8940,rightleftarrows:8644,rightsquigarrow:8605,rightthreetimes:8908,straightepsilon:1013,trianglerighteq:8885,vartriangleleft:8882,DiacriticalDot:729,DoubleRightTee:8872,DownLeftVector:8637,GreaterGreater:10914,HorizontalLine:9472,InvisibleComma:8291,InvisibleTimes:8290,LeftDownVector:8643,LeftRightArrow:8596,Leftrightarrow:8660,LessSlantEqual:10877,LongRightArrow:10230,Longrightarrow:10233,LowerLeftArrow:8601,NestedLessLess:8810,NotGreaterLess:8825,NotLessGreater:8824,NotSubsetEqual:8840,NotVerticalBar:8740,OpenCurlyQuote:8216,ReverseElement:8715,RightTeeVector:10587,RightVectorBar:10579,ShortDownArrow:8595,ShortLeftArrow:8592,SquareSuperset:8848,TildeFullEqual:8773,UpperLeftArrow:8598,ZeroWidthSpace:8203,curvearrowleft:8630,doublebarwedge:8966,downdownarrows:8650,hookrightarrow:8618,leftleftarrows:8647,leftrightarrow:8596,leftthreetimes:8907,longrightarrow:10230,looparrowright:8620,nshortparallel:8742,ntriangleright:8939,rightarrowtail:8611,rightharpoonup:8640,trianglelefteq:8884,upharpoonright:8638,ApplyFunction:8289,DifferentialD:8518,DoubleLeftTee:10980,DoubleUpArrow:8657,LeftTeeVector:10586,LeftVectorBar:10578,LessFullEqual:8806,LongLeftArrow:10229,Longleftarrow:10232,NotTildeEqual:8772,NotTildeTilde:8777,Poincareplane:8460,PrecedesEqual:10927,PrecedesTilde:8830,RightArrowBar:8677,RightTeeArrow:8614,RightTriangle:8883,RightUpVector:8638,SucceedsEqual:10928,SucceedsTilde:8831,SupersetEqual:8839,UpEquilibrium:10606,VerticalTilde:8768,VeryThinSpace:8202,bigtriangleup:9651,blacktriangle:9652,divideontimes:8903,fallingdotseq:8786,hookleftarrow:8617,leftarrowtail:8610,leftharpoonup:8636,longleftarrow:10229,looparrowleft:8619,measuredangle:8737,ntriangleleft:8938,shortparallel:8741,smallsetminus:8726,triangleright:9657,upharpoonleft:8639,DownArrowBar:10515,DownTeeArrow:8615,ExponentialE:8519,GreaterEqual:8805,GreaterTilde:8819,HilbertSpace:8459,HumpDownHump:8782,Intersection:8898,LeftArrowBar:8676,LeftTeeArrow:8612,LeftTriangle:8882,LeftUpVector:8639,NotCongruent:8802,NotLessEqual:8816,NotLessTilde:8820,Proportional:8733,RightCeiling:8969,RoundImplies:10608,ShortUpArrow:8593,SquareSubset:8847,UnderBracket:9141,VerticalLine:124,blacklozenge:10731,exponentiale:8519,risingdotseq:8787,triangledown:9663,triangleleft:9667,CircleMinus:8854,CircleTimes:8855,Equilibrium:8652,GreaterLess:8823,LeftCeiling:8968,LessGreater:8822,MediumSpace:8287,NotPrecedes:8832,NotSucceeds:8833,OverBracket:9140,RightVector:8640,Rrightarrow:8667,RuleDelayed:10740,SmallCircle:8728,SquareUnion:8852,SubsetEqual:8838,UpDownArrow:8597,Updownarrow:8661,VerticalBar:8739,backepsilon:1014,blacksquare:9642,circledcirc:8858,circleddash:8861,curlyeqprec:8926,curlyeqsucc:8927,diamondsuit:9830,eqslantless:10901,expectation:8496,nRightarrow:8655,nrightarrow:8603,preccurlyeq:8828,precnapprox:10937,quaternions:8461,straightphi:981,succcurlyeq:8829,succnapprox:10938,thickapprox:8776,updownarrow:8597,Bernoullis:8492,CirclePlus:8853,EqualTilde:8770,Fouriertrf:8497,ImaginaryI:8520,Laplacetrf:8466,LeftVector:8636,Lleftarrow:8666,NotElement:8713,NotGreater:8815,Proportion:8759,RightArrow:8594,RightFloor:8971,Rightarrow:8658,TildeEqual:8771,TildeTilde:8776,UnderBrace:9183,UpArrowBar:10514,UpTeeArrow:8613,circledast:8859,complement:8705,curlywedge:8911,eqslantgtr:10902,gtreqqless:10892,lessapprox:10885,lesseqqgtr:10891,lmoustache:9136,longmapsto:10236,mapstodown:8615,mapstoleft:8612,nLeftarrow:8653,nleftarrow:8602,precapprox:10935,rightarrow:8594,rmoustache:9137,sqsubseteq:8849,sqsupseteq:8850,subsetneqq:10955,succapprox:10936,supsetneqq:10956,upuparrows:8648,varepsilon:949,varnothing:8709,Backslash:8726,CenterDot:183,CircleDot:8857,Congruent:8801,Coproduct:8720,DoubleDot:168,DownArrow:8595,DownBreve:785,Downarrow:8659,HumpEqual:8783,LeftArrow:8592,LeftFloor:8970,Leftarrow:8656,LessTilde:8818,Mellintrf:8499,MinusPlus:8723,NotCupCap:8813,NotExists:8708,OverBrace:9182,PlusMinus:177,Therefore:8756,ThinSpace:8201,TripleDot:8411,UnionPlus:8846,backprime:8245,backsimeq:8909,bigotimes:10754,centerdot:183,checkmark:10003,complexes:8450,dotsquare:8865,downarrow:8595,gtrapprox:10886,gtreqless:8923,heartsuit:9829,leftarrow:8592,lesseqgtr:8922,nparallel:8742,nshortmid:8740,nsubseteq:8840,nsupseteq:8841,pitchfork:8916,rationals:8474,spadesuit:9824,subseteqq:10949,subsetneq:8842,supseteqq:10950,supsetneq:8843,therefore:8756,triangleq:8796,varpropto:8733,DDotrahd:10513,DotEqual:8784,Integral:8747,LessLess:10913,NotEqual:8800,NotTilde:8769,PartialD:8706,Precedes:8826,RightTee:8866,Succeeds:8827,SuchThat:8715,Superset:8835,Uarrocir:10569,UnderBar:818,andslope:10840,angmsdaa:10664,angmsdab:10665,angmsdac:10666,angmsdad:10667,angmsdae:10668,angmsdaf:10669,angmsdag:10670,angmsdah:10671,angrtvbd:10653,approxeq:8778,awconint:8755,backcong:8780,barwedge:8965,bbrktbrk:9142,bigoplus:10753,bigsqcup:10758,biguplus:10756,bigwedge:8896,boxminus:8863,boxtimes:8864,capbrcup:10825,circledR:174,circledS:9416,cirfnint:10768,clubsuit:9827,cupbrcap:10824,curlyvee:8910,cwconint:8754,doteqdot:8785,dotminus:8760,drbkarow:10512,dzigrarr:10239,elinters:9191,emptyset:8709,eqvparsl:10725,fpartint:10765,geqslant:10878,gesdotol:10884,gnapprox:10890,hksearow:10533,hkswarow:10534,imagline:8464,imagpart:8465,infintie:10717,integers:8484,intercal:8890,intlarhk:10775,laemptyv:10676,ldrushar:10571,leqslant:10877,lesdotor:10883,llcorner:8990,lnapprox:10889,lrcorner:8991,lurdshar:10570,mapstoup:8613,multimap:8888,naturals:8469,otimesas:10806,parallel:8741,plusacir:10787,pointint:10773,precneqq:10933,precnsim:8936,profalar:9006,profline:8978,profsurf:8979,raemptyv:10675,realpart:8476,rppolint:10770,rtriltri:10702,scpolint:10771,setminus:8726,shortmid:8739,smeparsl:10724,sqsubset:8847,sqsupset:8848,subseteq:8838,succneqq:10934,succnsim:8937,supseteq:8839,thetasym:977,thicksim:8764,timesbar:10801,triangle:9653,triminus:10810,trpezium:9186,ulcorner:8988,urcorner:8989,varkappa:1008,varsigma:962,vartheta:977,Because:8757,Cayleys:8493,Cconint:8752,Cedilla:184,Diamond:8900,DownTee:8868,Element:8712,Epsilon:917,Implies:8658,LeftTee:8867,NewLine:10,NoBreak:8288,NotLess:8814,Omicron:927,OverBar:175,Product:8719,UpArrow:8593,Uparrow:8657,Upsilon:933,alefsym:8501,angrtvb:8894,angzarr:9084,asympeq:8781,backsim:8765,because:8757,bemptyv:10672,between:8812,bigcirc:9711,bigodot:10752,bigstar:9733,boxplus:8862,ccupssm:10832,cemptyv:10674,cirscir:10690,coloneq:8788,congdot:10861,cudarrl:10552,cudarrr:10549,cularrp:10557,curarrm:10556,dbkarow:10511,ddagger:8225,ddotseq:10871,demptyv:10673,diamond:8900,digamma:989,dotplus:8724,dwangle:10662,epsilon:949,eqcolon:8789,equivDD:10872,gesdoto:10882,gtquest:10876,gtrless:8823,harrcir:10568,intprod:10812,isindot:8949,larrbfs:10527,larrsim:10611,lbrksld:10639,lbrkslu:10637,ldrdhar:10599,lesdoto:10881,lessdot:8918,lessgtr:8822,lesssim:8818,lotimes:10804,lozenge:9674,ltquest:10875,luruhar:10598,maltese:10016,minusdu:10794,napprox:8777,natural:9838,nearrow:8599,nexists:8708,notinva:8713,notinvb:8951,notinvc:8950,notniva:8716,notnivb:8958,notnivc:8957,npolint:10772,nsqsube:8930,nsqsupe:8931,nvinfin:10718,nwarrow:8598,olcross:10683,omicron:959,orderof:8500,orslope:10839,pertenk:8241,planckh:8462,pluscir:10786,plussim:10790,plustwo:10791,precsim:8830,quatint:10774,questeq:8799,rarrbfs:10528,rarrsim:10612,rbrksld:10638,rbrkslu:10640,rdldhar:10601,realine:8475,rotimes:10805,ruluhar:10600,searrow:8600,simplus:10788,simrarr:10610,subedot:10947,submult:10945,subplus:10943,subrarr:10617,succsim:8831,supdsub:10968,supedot:10948,suphsub:10967,suplarr:10619,supmult:10946,supplus:10944,swarrow:8601,topfork:10970,triplus:10809,tritime:10811,uparrow:8593,upsilon:965,uwangle:10663,vzigzag:10650,zigrarr:8669,Aacute:193,Abreve:258,Agrave:192,Assign:8788,Atilde:195,Barwed:8966,Bumpeq:8782,Cacute:262,Ccaron:268,Ccedil:199,Colone:10868,Conint:8751,CupCap:8781,Dagger:8225,Dcaron:270,DotDot:8412,Dstrok:272,Eacute:201,Ecaron:282,Egrave:200,Exists:8707,ForAll:8704,Gammad:988,Gbreve:286,Gcedil:290,HARDcy:1066,Hstrok:294,Iacute:205,Igrave:204,Itilde:296,Jsercy:1032,Kcedil:310,Lacute:313,Lambda:923,Lcaron:317,Lcedil:315,Lmidot:319,Lstrok:321,Nacute:323,Ncaron:327,Ncedil:325,Ntilde:209,Oacute:211,Odblac:336,Ograve:210,Oslash:216,Otilde:213,Otimes:10807,Racute:340,Rarrtl:10518,Rcaron:344,Rcedil:342,SHCHcy:1065,SOFTcy:1068,Sacute:346,Scaron:352,Scedil:350,Square:9633,Subset:8912,Supset:8913,Tcaron:356,Tcedil:354,Tstrok:358,Uacute:218,Ubreve:364,Udblac:368,Ugrave:217,Utilde:360,Vdashl:10982,Verbar:8214,Vvdash:8874,Yacute:221,Zacute:377,Zcaron:381,aacute:225,abreve:259,agrave:224,andand:10837,angmsd:8737,angsph:8738,apacir:10863,approx:8776,atilde:227,barvee:8893,barwed:8965,becaus:8757,bernou:8492,bigcap:8898,bigcup:8899,bigvee:8897,bkarow:10509,bottom:8869,bowtie:8904,boxbox:10697,bprime:8245,brvbar:166,bullet:8226,bumpeq:8783,cacute:263,capand:10820,capcap:10827,capcup:10823,capdot:10816,ccaron:269,ccedil:231,circeq:8791,cirmid:10991,colone:8788,commat:64,compfn:8728,conint:8750,coprod:8720,copysr:8471,cularr:8630,cupcap:10822,cupcup:10826,cupdot:8845,curarr:8631,curren:164,cylcty:9005,dagger:8224,daleth:8504,dcaron:271,dfisht:10623,divide:247,divonx:8903,dlcorn:8990,dlcrop:8973,dollar:36,drcorn:8991,drcrop:8972,dstrok:273,eacute:233,easter:10862,ecaron:283,ecolon:8789,egrave:232,egsdot:10904,elsdot:10903,emptyv:8709,emsp13:8196,emsp14:8197,eparsl:10723,eqcirc:8790,equals:61,equest:8799,female:9792,ffilig:64259,ffllig:64260,forall:8704,frac12:189,frac13:8531,frac14:188,frac15:8533,frac16:8537,frac18:8539,frac23:8532,frac25:8534,frac34:190,frac35:8535,frac38:8540,frac45:8536,frac56:8538,frac58:8541,frac78:8542,gacute:501,gammad:989,gbreve:287,gesdot:10880,gesles:10900,gtlPar:10645,gtrarr:10616,gtrdot:8919,gtrsim:8819,hairsp:8202,hamilt:8459,hardcy:1098,hearts:9829,hellip:8230,hercon:8889,homtht:8763,horbar:8213,hslash:8463,hstrok:295,hybull:8259,hyphen:8208,iacute:237,igrave:236,iiiint:10764,iinfin:10716,incare:8453,inodot:305,intcal:8890,iquest:191,isinsv:8947,itilde:297,jsercy:1112,kappav:1008,kcedil:311,kgreen:312,lAtail:10523,lacute:314,lagran:8466,lambda:955,langle:10216,larrfs:10525,larrhk:8617,larrlp:8619,larrpl:10553,larrtl:8610,latail:10521,lbrace:123,lbrack:91,lcaron:318,lcedil:316,ldquor:8222,lesdot:10879,lesges:10899,lfisht:10620,lfloor:8970,lharul:10602,llhard:10603,lmidot:320,lmoust:9136,loplus:10797,lowast:8727,lowbar:95,lparlt:10643,lrhard:10605,lsaquo:8249,lsquor:8218,lstrok:322,lthree:8907,ltimes:8905,ltlarr:10614,ltrPar:10646,mapsto:8614,marker:9646,mcomma:10793,midast:42,midcir:10992,middot:183,minusb:8863,minusd:8760,mnplus:8723,models:8871,mstpos:8766,nVDash:8879,nVdash:8878,nacute:324,ncaron:328,ncedil:326,nearhk:10532,nequiv:8802,nesear:10536,nexist:8708,nltrie:8940,nprcue:8928,nrtrie:8941,nsccue:8929,nsimeq:8772,ntilde:241,numero:8470,nvDash:8877,nvHarr:10500,nvdash:8876,nvlArr:10498,nvrArr:10499,nwarhk:10531,nwnear:10535,oacute:243,odblac:337,odsold:10684,ograve:242,ominus:8854,origof:8886,oslash:248,otilde:245,otimes:8855,parsim:10995,percnt:37,period:46,permil:8240,phmmat:8499,planck:8463,plankv:8463,plusdo:8724,plusdu:10789,plusmn:177,preceq:10927,primes:8473,prnsim:8936,propto:8733,prurel:8880,puncsp:8200,qprime:8279,rAtail:10524,racute:341,rangle:10217,rarrap:10613,rarrfs:10526,rarrhk:8618,rarrlp:8620,rarrpl:10565,rarrtl:8611,ratail:10522,rbrace:125,rbrack:93,rcaron:345,rcedil:343,rdquor:8221,rfisht:10621,rfloor:8971,rharul:10604,rmoust:9137,roplus:10798,rpargt:10644,rsaquo:8250,rsquor:8217,rthree:8908,rtimes:8906,sacute:347,scaron:353,scedil:351,scnsim:8937,searhk:10533,seswar:10537,sfrown:8994,shchcy:1097,sigmaf:962,sigmav:962,simdot:10858,smashp:10803,softcy:1100,solbar:9023,spades:9824,sqsube:8849,sqsupe:8850,square:9633,squarf:9642,ssetmn:8726,ssmile:8995,sstarf:8902,subdot:10941,subset:8834,subsim:10951,subsub:10965,subsup:10963,succeq:10928,supdot:10942,supset:8835,supsim:10952,supsub:10964,supsup:10966,swarhk:10534,swnwar:10538,target:8982,tcaron:357,tcedil:355,telrec:8981,there4:8756,thetav:977,thinsp:8201,thksim:8764,timesb:8864,timesd:10800,topbot:9014,topcir:10993,tprime:8244,tridot:9708,tstrok:359,uacute:250,ubreve:365,udblac:369,ufisht:10622,ugrave:249,ulcorn:8988,ulcrop:8975,urcorn:8989,urcrop:8974,utilde:361,vangrt:10652,varphi:966,varrho:1009,veebar:8891,vellip:8942,verbar:124,wedbar:10847,wedgeq:8793,weierp:8472,wreath:8768,xoplus:10753,xotime:10754,xsqcup:10758,xuplus:10756,xwedge:8896,yacute:253,zacute:378,zcaron:382,zeetrf:8488,AElig:198,Acirc:194,Alpha:913,Amacr:256,Aogon:260,Aring:197,Breve:728,Ccirc:264,Colon:8759,Cross:10799,Dashv:10980,Delta:916,Ecirc:202,Emacr:274,Eogon:280,Equal:10869,Gamma:915,Gcirc:284,Hacek:711,Hcirc:292,IJlig:306,Icirc:206,Imacr:298,Iogon:302,Iukcy:1030,Jcirc:308,Jukcy:1028,Kappa:922,OElig:338,Ocirc:212,Omacr:332,Omega:937,Prime:8243,RBarr:10512,Scirc:348,Sigma:931,THORN:222,TRADE:8482,TSHcy:1035,Theta:920,Tilde:8764,Ubrcy:1038,Ucirc:219,Umacr:362,Union:8899,Uogon:370,UpTee:8869,Uring:366,VDash:8875,Vdash:8873,Wcirc:372,Wedge:8896,Ycirc:374,acirc:226,acute:180,aelig:230,aleph:8501,alpha:945,amacr:257,amalg:10815,angle:8736,angrt:8735,angst:8491,aogon:261,aring:229,asymp:8776,awint:10769,bcong:8780,bdquo:8222,bepsi:1014,blank:9251,blk12:9618,blk14:9617,blk34:9619,block:9608,boxDL:9559,boxDR:9556,boxDl:9558,boxDr:9555,boxHD:9574,boxHU:9577,boxHd:9572,boxHu:9575,boxUL:9565,boxUR:9562,boxUl:9564,boxUr:9561,boxVH:9580,boxVL:9571,boxVR:9568,boxVh:9579,boxVl:9570,boxVr:9567,boxdL:9557,boxdR:9554,boxdl:9488,boxdr:9484,boxhD:9573,boxhU:9576,boxhd:9516,boxhu:9524,boxuL:9563,boxuR:9560,boxul:9496,boxur:9492,boxvH:9578,boxvL:9569,boxvR:9566,boxvh:9532,boxvl:9508,boxvr:9500,breve:728,bsemi:8271,bsime:8909,bsolb:10693,bumpE:10926,bumpe:8783,caret:8257,caron:711,ccaps:10829,ccirc:265,ccups:10828,cedil:184,check:10003,clubs:9827,colon:58,comma:44,crarr:8629,cross:10007,csube:10961,csupe:10962,ctdot:8943,cuepr:8926,cuesc:8927,cupor:10821,cuvee:8910,cuwed:8911,cwint:8753,dashv:8867,dblac:733,ddarr:8650,delta:948,dharl:8643,dharr:8642,diams:9830,disin:8946,doteq:8784,dtdot:8945,dtrif:9662,duarr:8693,duhar:10607,eDDot:10871,ecirc:234,efDot:8786,emacr:275,empty:8709,eogon:281,eplus:10865,epsiv:949,eqsim:8770,equiv:8801,erDot:8787,erarr:10609,esdot:8784,exist:8707,fflig:64256,filig:64257,fllig:64258,fltns:9649,forkv:10969,frasl:8260,frown:8994,gamma:947,gcirc:285,gescc:10921,gimel:8503,gneqq:8809,gnsim:8935,grave:96,gsime:10894,gsiml:10896,gtcir:10874,gtdot:8919,harrw:8621,hcirc:293,hoarr:8703,icirc:238,iexcl:161,iiint:8749,iiota:8489,ijlig:307,imacr:299,image:8465,imath:305,imped:437,infin:8734,iogon:303,iprod:10812,isinE:8953,isins:8948,isinv:8712,iukcy:1110,jcirc:309,jmath:567,jukcy:1108,kappa:954,lAarr:8666,lBarr:10510,langd:10641,laquo:171,larrb:8676,lbarr:10508,lbbrk:10098,lbrke:10635,lceil:8968,ldquo:8220,lescc:10920,lhard:8637,lharu:8636,lhblk:9604,llarr:8647,lltri:9722,lneqq:8808,lnsim:8934,loang:10220,loarr:8701,lobrk:10214,lopar:10629,lrarr:8646,lrhar:8651,lrtri:8895,lsime:10893,lsimg:10895,lsquo:8216,ltcir:10873,ltdot:8918,ltrie:8884,ltrif:9666,mDDot:8762,mdash:8212,micro:181,minus:8722,mumap:8888,nabla:8711,napos:329,natur:9838,ncong:8775,ndash:8211,neArr:8663,nearr:8599,ngsim:8821,nhArr:8654,nharr:8622,nhpar:10994,nlArr:8653,nlarr:8602,nless:8814,nlsim:8820,nltri:8938,notin:8713,notni:8716,nprec:8832,nrArr:8655,nrarr:8603,nrtri:8939,nsime:8772,nsmid:8740,nspar:8742,nsube:8840,nsucc:8833,nsupe:8841,numsp:8199,nwArr:8662,nwarr:8598,ocirc:244,odash:8861,oelig:339,ofcir:10687,ohbar:10677,olarr:8634,olcir:10686,oline:8254,omacr:333,omega:969,operp:10681,oplus:8853,orarr:8635,order:8500,ovbar:9021,parsl:11005,phone:9742,plusb:8862,pluse:10866,pound:163,prcue:8828,prime:8242,prnap:10937,prsim:8830,quest:63,rAarr:8667,rBarr:10511,radic:8730,rangd:10642,range:10661,raquo:187,rarrb:8677,rarrc:10547,rarrw:8605,ratio:8758,rbarr:10509,rbbrk:10099,rbrke:10636,rceil:8969,rdquo:8221,reals:8477,rhard:8641,rharu:8640,rlarr:8644,rlhar:8652,rnmid:10990,roang:10221,roarr:8702,robrk:10215,ropar:10630,rrarr:8649,rsquo:8217,rtrie:8885,rtrif:9656,sbquo:8218,sccue:8829,scirc:349,scnap:10938,scsim:8831,sdotb:8865,sdote:10854,seArr:8664,searr:8600,setmn:8726,sharp:9839,sigma:963,simeq:8771,simgE:10912,simlE:10911,simne:8774,slarr:8592,smile:8995,sqcap:8851,sqcup:8852,sqsub:8847,sqsup:8848,srarr:8594,starf:9733,strns:175,subnE:10955,subne:8842,supnE:10956,supne:8843,swArr:8665,swarr:8601,szlig:223,theta:952,thkap:8776,thorn:254,tilde:732,times:215,trade:8482,trisb:10701,tshcy:1115,twixt:8812,ubrcy:1118,ucirc:251,udarr:8645,udhar:10606,uharl:8639,uharr:8638,uhblk:9600,ultri:9720,umacr:363,uogon:371,uplus:8846,upsih:978,uring:367,urtri:9721,utdot:8944,utrif:9652,uuarr:8648,vBarv:10985,vDash:8872,varpi:982,vdash:8866,veeeq:8794,vltri:8882,vprop:8733,vrtri:8883,wcirc:373,wedge:8743,xcirc:9711,xdtri:9661,xhArr:10234,xharr:10231,xlArr:10232,xlarr:10229,xodot:10752,xrArr:10233,xrarr:10230,xutri:9651,ycirc:375,Aopf:120120,Ascr:119964,Auml:196,Barv:10983,Beta:914,Bopf:120121,Bscr:8492,CHcy:1063,COPY:169,Cdot:266,Copf:8450,Cscr:119966,DJcy:1026,DScy:1029,DZcy:1039,Darr:8609,Dopf:120123,Dscr:119967,Edot:278,Eopf:120124,Escr:8496,Esim:10867,Euml:203,Fopf:120125,Fscr:8497,GJcy:1027,Gdot:288,Gopf:120126,Gscr:119970,Hopf:8461,Hscr:8459,IEcy:1045,IOcy:1025,Idot:304,Iopf:120128,Iota:921,Iscr:8464,Iuml:207,Jopf:120129,Jscr:119973,KHcy:1061,KJcy:1036,Kopf:120130,Kscr:119974,LJcy:1033,Lang:10218,Larr:8606,Lopf:120131,Lscr:8466,Mopf:120132,Mscr:8499,NJcy:1034,Nopf:8469,Nscr:119977,Oopf:120134,Oscr:119978,Ouml:214,Popf:8473,Pscr:119979,QUOT:34,Qopf:8474,Qscr:119980,Rang:10219,Rarr:8608,Ropf:8477,Rscr:8475,SHcy:1064,Sopf:120138,Sqrt:8730,Sscr:119982,Star:8902,TScy:1062,Topf:120139,Tscr:119983,Uarr:8607,Uopf:120140,Upsi:978,Uscr:119984,Uuml:220,Vbar:10987,Vert:8214,Vopf:120141,Vscr:119985,Wopf:120142,Wscr:119986,Xopf:120143,Xscr:119987,YAcy:1071,YIcy:1031,YUcy:1070,Yopf:120144,Yscr:119988,Yuml:376,ZHcy:1046,Zdot:379,Zeta:918,Zopf:8484,Zscr:119989,andd:10844,andv:10842,ange:10660,aopf:120146,apid:8779,apos:39,ascr:119990,auml:228,bNot:10989,bbrk:9141,beta:946,beth:8502,bnot:8976,bopf:120147,boxH:9552,boxV:9553,boxh:9472,boxv:9474,bscr:119991,bsim:8765,bsol:92,bull:8226,bump:8782,cdot:267,cent:162,chcy:1095,cirE:10691,circ:710,cire:8791,comp:8705,cong:8773,copf:120148,copy:169,cscr:119992,csub:10959,csup:10960,dArr:8659,dHar:10597,darr:8595,dash:8208,diam:8900,djcy:1106,dopf:120149,dscr:119993,dscy:1109,dsol:10742,dtri:9663,dzcy:1119,eDot:8785,ecir:8790,edot:279,emsp:8195,ensp:8194,eopf:120150,epar:8917,epsi:1013,escr:8495,esim:8770,euml:235,euro:8364,excl:33,flat:9837,fnof:402,fopf:120151,fork:8916,fscr:119995,gdot:289,geqq:8807,gjcy:1107,gnap:10890,gneq:10888,gopf:120152,gscr:8458,gsim:8819,gtcc:10919,hArr:8660,half:189,harr:8596,hbar:8463,hopf:120153,hscr:119997,iecy:1077,imof:8887,iocy:1105,iopf:120154,iota:953,iscr:119998,isin:8712,iuml:239,jopf:120155,jscr:119999,khcy:1093,kjcy:1116,kopf:120156,kscr:120000,lArr:8656,lHar:10594,lang:10216,larr:8592,late:10925,lcub:123,ldca:10550,ldsh:8626,leqq:8806,ljcy:1113,lnap:10889,lneq:10887,lopf:120157,lozf:10731,lpar:40,lscr:120001,lsim:8818,lsqb:91,ltcc:10918,ltri:9667,macr:175,male:9794,malt:10016,mlcp:10971,mldr:8230,mopf:120158,mscr:120002,nbsp:160,ncap:10819,ncup:10818,ngeq:8817,ngtr:8815,nisd:8954,njcy:1114,nldr:8229,nleq:8816,nmid:8740,nopf:120159,npar:8742,nscr:120003,nsim:8769,nsub:8836,nsup:8837,ntgl:8825,ntlg:8824,oast:8859,ocir:8858,odiv:10808,odot:8857,ogon:731,oint:8750,omid:10678,oopf:120160,opar:10679,ordf:170,ordm:186,oror:10838,oscr:8500,osol:8856,ouml:246,para:182,part:8706,perp:8869,phiv:966,plus:43,popf:120161,prap:10935,prec:8826,prnE:10933,prod:8719,prop:8733,pscr:120005,qint:10764,qopf:120162,qscr:120006,quot:34,rArr:8658,rHar:10596,race:10714,rang:10217,rarr:8594,rcub:125,rdca:10551,rdsh:8627,real:8476,rect:9645,rhov:1009,ring:730,ropf:120163,rpar:41,rscr:120007,rsqb:93,rtri:9657,scap:10936,scnE:10934,sdot:8901,sect:167,semi:59,sext:10038,shcy:1096,sime:8771,simg:10910,siml:10909,smid:8739,smte:10924,solb:10692,sopf:120164,spar:8741,squf:9642,sscr:120008,star:9734,subE:10949,sube:8838,succ:8827,sung:9834,sup1:185,sup2:178,sup3:179,supE:10950,supe:8839,tbrk:9140,tdot:8411,tint:8749,toea:10536,topf:120165,tosa:10537,trie:8796,tscr:120009,tscy:1094,uArr:8657,uHar:10595,uarr:8593,uopf:120166,upsi:965,uscr:120010,utri:9653,uuml:252,vArr:8661,vBar:10984,varr:8597,vert:124,vopf:120167,vscr:120011,wopf:120168,wscr:120012,xcap:8898,xcup:8899,xmap:10236,xnis:8955,xopf:120169,xscr:120013,xvee:8897,yacy:1103,yicy:1111,yopf:120170,yscr:120014,yucy:1102,yuml:255,zdot:380,zeta:950,zhcy:1078,zopf:120171,zscr:120015,zwnj:8204,AMP:38,Acy:1040,Afr:120068,And:10835,Bcy:1041,Bfr:120069,Cap:8914,Cfr:8493,Chi:935,Cup:8915,Dcy:1044,Del:8711,Dfr:120071,Dot:168,ENG:330,ETH:208,Ecy:1069,Efr:120072,Eta:919,Fcy:1060,Ffr:120073,Gcy:1043,Gfr:120074,Hat:94,Hfr:8460,Icy:1048,Ifr:8465,Int:8748,Jcy:1049,Jfr:120077,Kcy:1050,Kfr:120078,Lcy:1051,Lfr:120079,Lsh:8624,Map:10501,Mcy:1052,Mfr:120080,Ncy:1053,Nfr:120081,Not:10988,Ocy:1054,Ofr:120082,Pcy:1055,Pfr:120083,Phi:934,Psi:936,Qfr:120084,REG:174,Rcy:1056,Rfr:8476,Rho:929,Rsh:8625,Scy:1057,Sfr:120086,Sub:8912,Sum:8721,Sup:8913,Tab:9,Tau:932,Tcy:1058,Tfr:120087,Ucy:1059,Ufr:120088,Vcy:1042,Vee:8897,Vfr:120089,Wfr:120090,Xfr:120091,Ycy:1067,Yfr:120092,Zcy:1047,Zfr:8488,acd:8767,acy:1072,afr:120094,amp:38,and:8743,ang:8736,apE:10864,ape:8778,ast:42,bcy:1073,bfr:120095,bot:8869,cap:8745,cfr:120096,chi:967,cir:9675,cup:8746,dcy:1076,deg:176,dfr:120097,die:168,div:247,dot:729,ecy:1101,efr:120098,egs:10902,ell:8467,els:10901,eng:331,eta:951,eth:240,fcy:1092,ffr:120099,gEl:10892,gap:10886,gcy:1075,gel:8923,geq:8805,ges:10878,gfr:120100,ggg:8921,glE:10898,gla:10917,glj:10916,gnE:8809,gne:10888,hfr:120101,icy:1080,iff:8660,ifr:120102,int:8747,jcy:1081,jfr:120103,kcy:1082,kfr:120104,lEg:10891,lap:10885,lat:10923,lcy:1083,leg:8922,leq:8804,les:10877,lfr:120105,lgE:10897,lnE:8808,lne:10887,loz:9674,lrm:8206,lsh:8624,map:8614,mcy:1084,mfr:120106,mho:8487,mid:8739,nap:8777,ncy:1085,nfr:120107,nge:8817,ngt:8815,nis:8956,niv:8715,nle:8816,nlt:8814,not:172,npr:8832,nsc:8833,num:35,ocy:1086,ofr:120108,ogt:10689,ohm:8486,olt:10688,ord:10845,orv:10843,par:8741,pcy:1087,pfr:120109,phi:966,piv:982,prE:10931,pre:10927,psi:968,qfr:120110,rcy:1088,reg:174,rfr:120111,rho:961,rlm:8207,rsh:8625,scE:10932,sce:10928,scy:1089,sfr:120112,shy:173,sim:8764,smt:10922,sol:47,squ:9633,sub:8834,sum:8721,sup:8835,tau:964,tcy:1090,tfr:120113,top:8868,ucy:1091,ufr:120114,uml:168,vcy:1074,vee:8744,vfr:120115,wfr:120116,xfr:120117,ycy:1099,yen:165,yfr:120118,zcy:1079,zfr:120119,zwj:8205,DD:8517,GT:62,Gg:8921,Gt:8811,Im:8465,LT:60,Ll:8920,Lt:8810,Mu:924,Nu:925,Or:10836,Pi:928,Pr:10939,Re:8476,Sc:10940,Xi:926,ac:8766,af:8289,ap:8776,dd:8518,ee:8519,eg:10906,el:10905,gE:8807,ge:8805,gg:8811,gl:8823,gt:62,ic:8291,ii:8520,in:8712,it:8290,lE:8806,le:8804,lg:8822,ll:8810,lt:60,mp:8723,mu:956,ne:8800,ni:8715,nu:957,oS:9416,or:8744,pi:960,pm:177,pr:8826,rx:8478,sc:8827,wp:8472,wr:8768,xi:958};const windows_1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376];const entity_pattern=new RegExp(`&(#?(?:x[\\\\w\\\\d]+|\\\\d+|${Object.keys(entities).join('|')}))(?:;|\\\\b)`,'g');function decode_character_references(html){return html.replace(entity_pattern,(match,entity)=>{let code;// Handle named entities\nif(entity[0]!=='#'){code=entities[entity];}else if(entity[1]==='x'){code=parseInt(entity.substring(2),16);}else{code=parseInt(entity.substring(1),10);}if(!code){return match;}return String.fromCodePoint(validate_code(code));});}const NUL=0;// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\nfunction validate_code(code){// line feed becomes generic whitespace\nif(code===10){return 32;}// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\nif(code<128){return code;}// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n// to correct the mistake or we'll end up with missing € signs and so on\nif(code<=159){return windows_1252[code-128];}// basic multilingual plane\nif(code<55296){return code;}// UTF-16 surrogate halves\nif(code<=57343){return NUL;}// rest of the basic multilingual plane\nif(code<=65535){return code;}// supplementary multilingual plane 0x10000 - 0x1ffff\nif(code>=65536&&code<=131071){return code;}// supplementary ideographic plane 0x20000 - 0x2ffff\nif(code>=131072&&code<=196607){return code;}return NUL;}// based on http://developers.whatwg.org/syntax.html#syntax-tag-omission\nconst disallowed_contents=new Map([['li',new Set(['li'])],['dt',new Set(['dt','dd'])],['dd',new Set(['dt','dd'])],['p',new Set('address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul'.split(' '))],['rt',new Set(['rt','rp'])],['rp',new Set(['rt','rp'])],['optgroup',new Set(['optgroup'])],['option',new Set(['option','optgroup'])],['thead',new Set(['tbody','tfoot'])],['tbody',new Set(['tbody','tfoot'])],['tfoot',new Set(['tbody'])],['tr',new Set(['tr','tbody'])],['td',new Set(['td','th','tr'])],['th',new Set(['td','th','tr'])]]);// can this be a child of the parent element, or does it implicitly\n// close it, like `<li>one<li>two`?\nfunction closing_tag_omitted(current,next){if(disallowed_contents.has(current)){if(!next||disallowed_contents.get(current).has(next)){return true;}}return false;}// eslint-disable-next-line no-useless-escape\nconst valid_tag_name=/^\\!?[a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*/;const meta_tags=new Map([['svelte:head','Head'],['svelte:options','Options'],['svelte:window','Window'],['svelte:body','Body']]);const valid_meta_tags=Array.from(meta_tags.keys()).concat('svelte:self','svelte:component','svelte:fragment','svelte:element');const specials=new Map([['script',{read:read_script,property:'js'}],['style',{read:read_style,property:'css'}]]);const SELF=/^svelte:self(?=[\\s/>])/;const COMPONENT=/^svelte:component(?=[\\s/>])/;const SLOT=/^svelte:fragment(?=[\\s/>])/;const ELEMENT=/^svelte:element(?=[\\s/>])/;function parent_is_head(stack){let i=stack.length;while(i--){const{type}=stack[i];if(type==='Head')return true;if(type==='Element'||type==='InlineComponent')return false;}return false;}const regex_closing_textarea_tag=/^<\\/textarea(\\s[^>]*)?>/i;const regex_closing_comment=/-->/;const regex_capital_letter=/[A-Z]/;function tag(parser){const start=parser.index++;let parent=parser.current();if(parser.eat('!--')){const data=parser.read_until(regex_closing_comment);parser.eat('-->',true,parser_errors.unclosed_comment);parser.current().children.push({start,end:parser.index,type:'Comment',data,ignores:extract_svelte_ignore(data)});return;}const is_closing_tag=parser.eat('/');const name=read_tag_name(parser);if(meta_tags.has(name)){const slug=meta_tags.get(name).toLowerCase();if(is_closing_tag){if((name==='svelte:window'||name==='svelte:body')&&parser.current().children.length){parser.error(parser_errors.invalid_element_content(slug,name),parser.current().children[0].start);}}else{if(name in parser.meta_tags){parser.error(parser_errors.duplicate_element(slug,name),start);}if(parser.stack.length>1){parser.error(parser_errors.invalid_element_placement(slug,name),start);}parser.meta_tags[name]=true;}}const type=meta_tags.has(name)?meta_tags.get(name):regex_capital_letter.test(name[0])||name==='svelte:self'||name==='svelte:component'?'InlineComponent':name==='svelte:fragment'?'SlotTemplate':name==='title'&&parent_is_head(parser.stack)?'Title':name==='slot'&&!parser.customElement?'Slot':'Element';const element={start,end:null,type,name,attributes:[],children:[]};parser.allow_whitespace();if(is_closing_tag){if(is_void(name)){parser.error(parser_errors.invalid_void_content(name),start);}parser.eat('>',true);// close any elements that don't have their own closing tags, e.g. <div><p></div>\nwhile(parent.name!==name){if(parent.type!=='Element'){const error=parser.last_auto_closed_tag&&parser.last_auto_closed_tag.tag===name?parser_errors.invalid_closing_tag_autoclosed(name,parser.last_auto_closed_tag.reason):parser_errors.invalid_closing_tag_unopened(name);parser.error(error,start);}parent.end=start;parser.stack.pop();parent=parser.current();}parent.end=parser.index;parser.stack.pop();if(parser.last_auto_closed_tag&&parser.stack.length<parser.last_auto_closed_tag.depth){parser.last_auto_closed_tag=null;}return;}else if(closing_tag_omitted(parent.name,name)){parent.end=start;parser.stack.pop();parser.last_auto_closed_tag={tag:parent.name,reason:name,depth:parser.stack.length};}const unique_names=new Set();let attribute;while(attribute=read_attribute(parser,unique_names)){element.attributes.push(attribute);parser.allow_whitespace();}if(name==='svelte:component'){const index=element.attributes.findIndex(attr=>attr.type==='Attribute'&&attr.name==='this');if(index===-1){parser.error(parser_errors.missing_component_definition,start);}const definition=element.attributes.splice(index,1)[0];if(definition.value===true||definition.value.length!==1||definition.value[0].type==='Text'){parser.error(parser_errors.invalid_component_definition,definition.start);}element.expression=definition.value[0].expression;}if(name==='svelte:element'){const index=element.attributes.findIndex(attr=>attr.type==='Attribute'&&attr.name==='this');if(index===-1){parser.error(parser_errors.missing_element_definition,start);}const definition=element.attributes.splice(index,1)[0];if(definition.value===true){parser.error(parser_errors.invalid_element_definition,definition.start);}element.tag=definition.value[0].data||definition.value[0].expression;}// special cases – top-level <script> and <style>\nif(specials.has(name)&&parser.stack.length===1){const special=specials.get(name);parser.eat('>',true);const content=special.read(parser,start,element.attributes);if(content)parser[special.property].push(content);return;}parser.current().children.push(element);const self_closing=parser.eat('/')||is_void(name);parser.eat('>',true);if(self_closing){// don't push self-closing elements onto the stack\nelement.end=parser.index;}else if(name==='textarea'){// special case\nelement.children=read_sequence(parser,()=>regex_closing_textarea_tag.test(parser.template.slice(parser.index)),'inside <textarea>');parser.read(regex_closing_textarea_tag);element.end=parser.index;}else if(name==='script'||name==='style'){// special case\nconst start=parser.index;const data=parser.read_until(new RegExp(`</${name}>`));const end=parser.index;element.children.push({start,end,type:'Text',data});parser.eat(`</${name}>`,true);element.end=parser.index;}else{parser.stack.push(element);}}const regex_whitespace_or_slash_or_closing_tag=/(\\s|\\/|>)/;function read_tag_name(parser){const start=parser.index;if(parser.read(SELF)){// check we're inside a block, otherwise this\n// will cause infinite recursion\nlet i=parser.stack.length;let legal=false;while(i--){const fragment=parser.stack[i];if(fragment.type==='IfBlock'||fragment.type==='EachBlock'||fragment.type==='InlineComponent'){legal=true;break;}}if(!legal){parser.error(parser_errors.invalid_self_placement,start);}return'svelte:self';}if(parser.read(COMPONENT))return'svelte:component';if(parser.read(ELEMENT))return'svelte:element';if(parser.read(SLOT))return'svelte:fragment';const name=parser.read_until(regex_whitespace_or_slash_or_closing_tag);if(meta_tags.has(name))return name;if(name.startsWith('svelte:')){const match=fuzzymatch(name.slice(7),valid_meta_tags);parser.error(parser_errors.invalid_tag_name_svelte_element(valid_meta_tags,match),start);}if(!valid_tag_name.test(name)){parser.error(parser_errors.invalid_tag_name,start);}return name;}// eslint-disable-next-line no-useless-escape\nconst regex_token_ending_character=/[\\s=\\/>\"']/;const regex_quote_characters=/[\"']/;function read_attribute(parser,unique_names){const start=parser.index;function check_unique(name){if(unique_names.has(name)){parser.error(parser_errors.duplicate_attribute,start);}unique_names.add(name);}if(parser.eat('{')){parser.allow_whitespace();if(parser.eat('...')){const expression=read_expression(parser);parser.allow_whitespace();parser.eat('}',true);return{start,end:parser.index,type:'Spread',expression};}else{const value_start=parser.index;const name=parser.read_identifier();parser.allow_whitespace();parser.eat('}',true);if(name===null){parser.error(parser_errors.empty_attribute_shorthand,start);}check_unique(name);return{start,end:parser.index,type:'Attribute',name,value:[{start:value_start,end:value_start+name.length,type:'AttributeShorthand',expression:{start:value_start,end:value_start+name.length,type:'Identifier',name}}]};}}const name=parser.read_until(regex_token_ending_character);if(!name)return null;let end=parser.index;parser.allow_whitespace();const colon_index=name.indexOf(':');const type=colon_index!==-1&&get_directive_type(name.slice(0,colon_index));let value=true;if(parser.eat('=')){parser.allow_whitespace();value=read_attribute_value(parser);end=parser.index;}else if(parser.match_regex(regex_quote_characters)){parser.error(parser_errors.unexpected_token('='),parser.index);}if(type){const[directive_name,...modifiers]=name.slice(colon_index+1).split('|');if(directive_name===''){parser.error(parser_errors.empty_directive_name(type),start+colon_index+1);}if(type==='Binding'&&directive_name!=='this'){check_unique(directive_name);}else if(type!=='EventHandler'&&type!=='Action'){check_unique(name);}if(type==='Ref'){parser.error(parser_errors.invalid_ref_directive(directive_name),start);}if(type==='StyleDirective'){return{start,end,type,name:directive_name,modifiers,value};}const first_value=value[0];let expression=null;if(first_value){const attribute_contains_text=value.length>1||first_value.type==='Text';if(attribute_contains_text){parser.error(parser_errors.invalid_directive_value,first_value.start);}else{expression=first_value.expression;}}const directive={start,end,type,name:directive_name,modifiers,expression};if(type==='Transition'){const direction=name.slice(0,colon_index);directive.intro=direction==='in'||direction==='transition';directive.outro=direction==='out'||direction==='transition';}// Directive name is expression, e.g. <p class:isRed />\nif(!directive.expression&&(type==='Binding'||type==='Class')){directive.expression={start:directive.start+colon_index+1,end:directive.end,type:'Identifier',name:directive.name};}return directive;}check_unique(name);return{start,end,type:'Attribute',name,value};}function get_directive_type(name){if(name==='use')return'Action';if(name==='animate')return'Animation';if(name==='bind')return'Binding';if(name==='class')return'Class';if(name==='style')return'StyleDirective';if(name==='on')return'EventHandler';if(name==='let')return'Let';if(name==='ref')return'Ref';if(name==='in'||name==='out'||name==='transition')return'Transition';}function read_attribute_value(parser){const quote_mark=parser.eat(\"'\")?\"'\":parser.eat('\"')?'\"':null;if(quote_mark&&parser.eat(quote_mark)){return[{start:parser.index-1,end:parser.index-1,type:'Text',raw:'',data:''}];}const regex=quote_mark===\"'\"?/'/:quote_mark==='\"'?/\"/:/(\\/>|[\\s\"'=<>`])/;let value;try{value=read_sequence(parser,()=>!!parser.match_regex(regex),'in attribute value');}catch(error){if(error.code==='parse-error'){// if the attribute value didn't close + self-closing tag\n// eg: `<Component test={{a:1} />`\n// acorn may throw a `Unterminated regular expression` because of `/>`\nif(parser.template.slice(error.pos-1,error.pos+1)==='/>'){parser.index=error.pos;parser.error(parser_errors.unclosed_attribute_value(quote_mark||'}'));}}throw error;}if(value.length===0&&!quote_mark){parser.error(parser_errors.missing_attribute_value);}if(quote_mark)parser.index+=1;return value;}function read_sequence(parser,done,location){let current_chunk={start:parser.index,end:null,type:'Text',raw:'',data:null};const chunks=[];function flush(end){if(current_chunk.raw){current_chunk.data=decode_character_references(current_chunk.raw);current_chunk.end=end;chunks.push(current_chunk);}}while(parser.index<parser.template.length){const index=parser.index;if(done()){flush(parser.index);return chunks;}else if(parser.eat('{')){if(parser.match('#')){const index=parser.index-1;parser.eat('#');const name=parser.read_until(/[^a-z]/);parser.error(parser_errors.invalid_logic_block_placement(location,name),index);}else if(parser.match('@')){const index=parser.index-1;parser.eat('@');const name=parser.read_until(/[^a-z]/);parser.error(parser_errors.invalid_tag_placement(location,name),index);}flush(parser.index-1);parser.allow_whitespace();const expression=read_expression(parser);parser.allow_whitespace();parser.eat('}',true);chunks.push({start:index,end:parser.index,type:'MustacheTag',expression});current_chunk={start:parser.index,end:null,type:'Text',raw:'',data:null};}else{current_chunk.raw+=parser.template[parser.index++];}}parser.error(parser_errors.unexpected_eof);}// Adapted from https://github.com/acornjs/acorn/blob/6584815dca7440e00de841d1dad152302fdd7ca5/src/tokenize.js\n// Reproduced under MIT License https://github.com/acornjs/acorn/blob/master/LICENSE\nfunction full_char_code_at(str,i){const code=str.charCodeAt(i);if(code<=0xd7ff||code>=0xe000)return code;const next=str.charCodeAt(i+1);return(code<<10)+next-0x35fdc00;}const SQUARE_BRACKET_OPEN='['.charCodeAt(0);const SQUARE_BRACKET_CLOSE=']'.charCodeAt(0);const CURLY_BRACKET_OPEN='{'.charCodeAt(0);const CURLY_BRACKET_CLOSE='}'.charCodeAt(0);function is_bracket_open(code){return code===SQUARE_BRACKET_OPEN||code===CURLY_BRACKET_OPEN;}function is_bracket_close(code){return code===SQUARE_BRACKET_CLOSE||code===CURLY_BRACKET_CLOSE;}function is_bracket_pair(open,close){return open===SQUARE_BRACKET_OPEN&&close===SQUARE_BRACKET_CLOSE||open===CURLY_BRACKET_OPEN&&close===CURLY_BRACKET_CLOSE;}function get_bracket_close(open){if(open===SQUARE_BRACKET_OPEN){return SQUARE_BRACKET_CLOSE;}if(open===CURLY_BRACKET_OPEN){return CURLY_BRACKET_CLOSE;}}function read_context(parser){const start=parser.index;let i=parser.index;const code=full_char_code_at(parser.template,i);if(isIdentifierStart(code,true)){return{type:'Identifier',name:parser.read_identifier(),start,end:parser.index};}if(!is_bracket_open(code)){parser.error(parser_errors.unexpected_token_destructure);}const bracket_stack=[code];i+=code<=0xffff?1:2;while(i<parser.template.length){const code=full_char_code_at(parser.template,i);if(is_bracket_open(code)){bracket_stack.push(code);}else if(is_bracket_close(code)){if(!is_bracket_pair(bracket_stack[bracket_stack.length-1],code)){parser.error(parser_errors.unexpected_token(String.fromCharCode(get_bracket_close(bracket_stack[bracket_stack.length-1]))));}bracket_stack.pop();if(bracket_stack.length===0){i+=code<=0xffff?1:2;break;}}i+=code<=0xffff?1:2;}parser.index=i;const pattern_string=parser.template.slice(start,i);try{// the length of the `space_with_newline` has to be start - 1\n// because we added a `(` in front of the pattern_string,\n// which shifted the entire string to right by 1\n// so we offset it by removing 1 character in the `space_with_newline`\n// to achieve that, we remove the 1st space encountered,\n// so it will not affect the `column` of the node\nlet space_with_newline=parser.template.slice(0,start).replace(regex_not_newline_characters,' ');const first_space=space_with_newline.indexOf(' ');space_with_newline=space_with_newline.slice(0,first_space)+space_with_newline.slice(first_space+1);return parse_expression_at(`${space_with_newline}(${pattern_string} = 1)`,start-1).left;}catch(error){parser.acorn_error(error);}}function trim_start(str){return str.replace(regex_starts_with_whitespaces,'');}function trim_end(str){return str.replace(regex_ends_with_whitespaces,'');}function to_string(node){switch(node.type){case'IfBlock':return'{#if} block';case'ThenBlock':return'{:then} block';case'ElseBlock':return'{:else} block';case'PendingBlock':case'AwaitBlock':return'{#await} block';case'CatchBlock':return'{:catch} block';case'EachBlock':return'{#each} block';case'RawMustacheTag':return'{@html} block';case'DebugTag':return'{@debug} block';case'ConstTag':return'{@const} tag';case'Element':case'InlineComponent':case'Slot':case'Title':return`<${node.name}> tag`;default:return node.type;}}function trim_whitespace(block,trim_before,trim_after){if(!block.children||block.children.length===0)return;// AwaitBlock\nconst first_child=block.children[0];const last_child=block.children[block.children.length-1];if(first_child.type==='Text'&&trim_before){first_child.data=trim_start(first_child.data);if(!first_child.data)block.children.shift();}if(last_child.type==='Text'&&trim_after){last_child.data=trim_end(last_child.data);if(!last_child.data)block.children.pop();}if(block.else){trim_whitespace(block.else,trim_before,trim_after);}if(first_child.elseif){trim_whitespace(first_child,trim_before,trim_after);}}const regex_whitespace_with_closing_curly_brace=/\\s*}/;function mustache(parser){const start=parser.index;parser.index+=1;parser.allow_whitespace();// {/if}, {/each}, {/await} or {/key}\nif(parser.eat('/')){let block=parser.current();let expected;if(closing_tag_omitted(block.name)){block.end=start;parser.stack.pop();block=parser.current();}if(block.type==='ElseBlock'||block.type==='PendingBlock'||block.type==='ThenBlock'||block.type==='CatchBlock'){block.end=start;parser.stack.pop();block=parser.current();expected='await';}if(block.type==='IfBlock'){expected='if';}else if(block.type==='EachBlock'){expected='each';}else if(block.type==='AwaitBlock'){expected='await';}else if(block.type==='KeyBlock'){expected='key';}else{parser.error(parser_errors.unexpected_block_close);}parser.eat(expected,true);parser.allow_whitespace();parser.eat('}',true);while(block.elseif){block.end=parser.index;parser.stack.pop();block=parser.current();if(block.else){block.else.end=start;}}// strip leading/trailing whitespace as necessary\nconst char_before=parser.template[block.start-1];const char_after=parser.template[parser.index];const trim_before=!char_before||regex_whitespace.test(char_before);const trim_after=!char_after||regex_whitespace.test(char_after);trim_whitespace(block,trim_before,trim_after);block.end=parser.index;parser.stack.pop();}else if(parser.eat(':else')){if(parser.eat('if')){parser.error(parser_errors.invalid_elseif);}parser.allow_whitespace();// :else if\nif(parser.eat('if')){const block=parser.current();if(block.type!=='IfBlock'){parser.error(parser.stack.some(block=>block.type==='IfBlock')?parser_errors.invalid_elseif_placement_unclosed_block(to_string(block)):parser_errors.invalid_elseif_placement_outside_if);}parser.require_whitespace();const expression=read_expression(parser);parser.allow_whitespace();parser.eat('}',true);block.else={start:parser.index,end:null,type:'ElseBlock',children:[{start:parser.index,end:null,type:'IfBlock',elseif:true,expression,children:[]}]};parser.stack.push(block.else.children[0]);}else{// :else\nconst block=parser.current();if(block.type!=='IfBlock'&&block.type!=='EachBlock'){parser.error(parser.stack.some(block=>block.type==='IfBlock'||block.type==='EachBlock')?parser_errors.invalid_else_placement_unclosed_block(to_string(block)):parser_errors.invalid_else_placement_outside_if);}parser.allow_whitespace();parser.eat('}',true);block.else={start:parser.index,end:null,type:'ElseBlock',children:[]};parser.stack.push(block.else);}}else if(parser.match(':then')||parser.match(':catch')){const block=parser.current();const is_then=parser.eat(':then')||!parser.eat(':catch');if(is_then){if(block.type!=='PendingBlock'){parser.error(parser.stack.some(block=>block.type==='PendingBlock')?parser_errors.invalid_then_placement_unclosed_block(to_string(block)):parser_errors.invalid_then_placement_without_await);}}else{if(block.type!=='ThenBlock'&&block.type!=='PendingBlock'){parser.error(parser.stack.some(block=>block.type==='ThenBlock'||block.type==='PendingBlock')?parser_errors.invalid_catch_placement_unclosed_block(to_string(block)):parser_errors.invalid_catch_placement_without_await);}}block.end=start;parser.stack.pop();const await_block=parser.current();if(!parser.eat('}')){parser.require_whitespace();await_block[is_then?'value':'error']=read_context(parser);parser.allow_whitespace();parser.eat('}',true);}const new_block={start,end:null,type:is_then?'ThenBlock':'CatchBlock',children:[],skip:false};await_block[is_then?'then':'catch']=new_block;parser.stack.push(new_block);}else if(parser.eat('#')){// {#if foo}, {#each foo} or {#await foo}\nlet type;if(parser.eat('if')){type='IfBlock';}else if(parser.eat('each')){type='EachBlock';}else if(parser.eat('await')){type='AwaitBlock';}else if(parser.eat('key')){type='KeyBlock';}else{parser.error(parser_errors.expected_block_type);}parser.require_whitespace();const expression=read_expression(parser);const block=type==='AwaitBlock'?{start,end:null,type,expression,value:null,error:null,pending:{start:null,end:null,type:'PendingBlock',children:[],skip:true},then:{start:null,end:null,type:'ThenBlock',children:[],skip:true},catch:{start:null,end:null,type:'CatchBlock',children:[],skip:true}}:{start,end:null,type,expression,children:[]};parser.allow_whitespace();// {#each} blocks must declare a context – {#each list as item}\nif(type==='EachBlock'){parser.eat('as',true);parser.require_whitespace();block.context=read_context(parser);parser.allow_whitespace();if(parser.eat(',')){parser.allow_whitespace();block.index=parser.read_identifier();if(!block.index)parser.error(parser_errors.expected_name);parser.allow_whitespace();}if(parser.eat('(')){parser.allow_whitespace();block.key=read_expression(parser);parser.allow_whitespace();parser.eat(')',true);parser.allow_whitespace();}}const await_block_shorthand=type==='AwaitBlock'&&parser.eat('then');if(await_block_shorthand){if(parser.match_regex(regex_whitespace_with_closing_curly_brace)){parser.allow_whitespace();}else{parser.require_whitespace();block.value=read_context(parser);parser.allow_whitespace();}}const await_block_catch_shorthand=!await_block_shorthand&&type==='AwaitBlock'&&parser.eat('catch');if(await_block_catch_shorthand){if(parser.match_regex(regex_whitespace_with_closing_curly_brace)){parser.allow_whitespace();}else{parser.require_whitespace();block.error=read_context(parser);parser.allow_whitespace();}}parser.eat('}',true);parser.current().children.push(block);parser.stack.push(block);if(type==='AwaitBlock'){let child_block;if(await_block_shorthand){block.then.skip=false;child_block=block.then;}else if(await_block_catch_shorthand){block.catch.skip=false;child_block=block.catch;}else{block.pending.skip=false;child_block=block.pending;}child_block.start=parser.index;parser.stack.push(child_block);}}else if(parser.eat('@html')){// {@html content} tag\nparser.require_whitespace();const expression=read_expression(parser);parser.allow_whitespace();parser.eat('}',true);parser.current().children.push({start,end:parser.index,type:'RawMustacheTag',expression});}else if(parser.eat('@debug')){let identifiers;// Implies {@debug} which indicates \"debug all\"\nif(parser.read(regex_whitespace_with_closing_curly_brace)){identifiers=[];}else{const expression=read_expression(parser);identifiers=expression.type==='SequenceExpression'?expression.expressions:[expression];identifiers.forEach(node=>{if(node.type!=='Identifier'){parser.error(parser_errors.invalid_debug_args,node.start);}});parser.allow_whitespace();parser.eat('}',true);}parser.current().children.push({start,end:parser.index,type:'DebugTag',identifiers});}else if(parser.eat('@const')){// {@const a = b}\nparser.require_whitespace();const expression=read_expression(parser);if(!(expression.type==='AssignmentExpression'&&expression.operator==='=')){parser.error({code:'invalid-const-args',message:'{@const ...} must be an assignment.'},start);}parser.allow_whitespace();parser.eat('}',true);parser.current().children.push({start,end:parser.index,type:'ConstTag',expression});}else{const expression=read_expression(parser);parser.allow_whitespace();parser.eat('}',true);parser.current().children.push({start,end:parser.index,type:'MustacheTag',expression});}}function text(parser){const start=parser.index;let data='';while(parser.index<parser.template.length&&!parser.match('<')&&!parser.match('{')){data+=parser.template[parser.index++];}const node={start,end:parser.index,type:'Text',raw:data,data:decode_character_references(data)};parser.current().children.push(node);}function fragment(parser){if(parser.match('<')){return tag;}if(parser.match('{')){return mustache;}return text;}const reserved=new Set(['arguments','await','break','case','catch','class','const','continue','debugger','default','delete','do','else','enum','eval','export','extends','false','finally','for','function','if','implements','import','in','instanceof','interface','let','new','null','package','private','protected','public','return','static','super','switch','this','throw','true','try','typeof','var','void','while','with','yield']);function is_valid(str){let i=0;while(i<str.length){const code=full_char_code_at(str,i);if(!(i===0?isIdentifierStart:isIdentifierChar)(code,true))return false;i+=code<=0xffff?1:2;}return true;}const regex_non_standard_characters=/[^a-zA-Z0-9_]+/g;const regex_starts_with_number=/^[0-9]/;function sanitize(name){return name.replace(regex_non_standard_characters,'_').replace(regex_starts_with_underscore,'').replace(regex_ends_with_underscore,'').replace(regex_starts_with_number,'_$&');}function getLocator(source,options){if(options===void 0){options={};}var offsetLine=options.offsetLine||0;var offsetColumn=options.offsetColumn||0;var originalLines=source.split('\\n');var start=0;var lineRanges=originalLines.map(function(line,i){var end=start+line.length+1;var range={start:start,end:end,line:i};start=end;return range;});var i=0;function rangeContains(range,index){return range.start<=index&&index<range.end;}function getLocation(range,index){return{line:offsetLine+range.line,column:offsetColumn+index-range.start,character:index};}function locate(search,startIndex){if(typeof search==='string'){search=source.indexOf(search,startIndex||0);}var range=lineRanges[i];var d=search>=range.end?1:-1;while(range){if(rangeContains(range,search))return getLocation(range,search);i+=d;range=lineRanges[i];}}return locate;}function locate(source,search,options){if(typeof options==='number'){throw new Error('locate takes a { startIndex, offsetLine, offsetColumn } object as the third argument');}return getLocator(source,options)(search,options&&options.startIndex);}const regex_tabs=/^\\t+/;function tabs_to_spaces(str){return str.replace(regex_tabs,match=>match.split('\\t').join('  '));}function get_code_frame(source,line,column){const lines=source.split('\\n');const frame_start=Math.max(0,line-2);const frame_end=Math.min(line+3,lines.length);const digits=String(frame_end+1).length;return lines.slice(frame_start,frame_end).map((str,i)=>{const isErrorLine=frame_start+i===line;const line_num=String(i+frame_start+1).padStart(digits,' ');if(isErrorLine){const indicator=' '.repeat(digits+2+tabs_to_spaces(str.slice(0,column)).length)+'^';return`${line_num}: ${tabs_to_spaces(str)}\\n${indicator}`;}return`${line_num}: ${tabs_to_spaces(str)}`;}).join('\\n');}class CompileError extends Error{toString(){return`${this.message} (${this.start.line}:${this.start.column})\\n${this.frame}`;}}function error(message,props){const error=new CompileError(message);error.name=props.name;const start=locate(props.source,props.start,{offsetLine:1});const end=locate(props.source,props.end||props.start,{offsetLine:1});error.code=props.code;error.start=start;error.end=end;error.pos=props.start;error.filename=props.filename;error.frame=get_code_frame(props.source,start.line-1,start.column);throw error;}const regex_position_indicator=/ \\(\\d+:\\d+\\)$/;class Parser$1{constructor(template,options){this.index=0;this.stack=[];this.css=[];this.js=[];this.meta_tags={};if(typeof template!=='string'){throw new TypeError('Template must be a string');}this.template=template.trimRight();this.filename=options.filename;this.customElement=options.customElement;this.html={start:null,end:null,type:'Fragment',children:[]};this.stack.push(this.html);let state=fragment;while(this.index<this.template.length){state=state(this)||fragment;}if(this.stack.length>1){const current=this.current();const type=current.type==='Element'?`<${current.name}>`:'Block';const slug=current.type==='Element'?'element':'block';this.error({code:`unclosed-${slug}`,message:`${type} was left open`},current.start);}if(state!==fragment){this.error({code:'unexpected-eof',message:'Unexpected end of input'});}if(this.html.children.length){let start=this.html.children[0].start;while(regex_whitespace.test(template[start]))start+=1;let end=this.html.children[this.html.children.length-1].end;while(regex_whitespace.test(template[end-1]))end-=1;this.html.start=start;this.html.end=end;}else{this.html.start=this.html.end=null;}}current(){return this.stack[this.stack.length-1];}acorn_error(err){this.error({code:'parse-error',message:err.message.replace(regex_position_indicator,'')},err.pos);}error(_ref10){let{code,message}=_ref10;let index=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.index;error(message,{name:'ParseError',code,source:this.template,start:index,filename:this.filename});}eat(str,required,error){if(this.match(str)){this.index+=str.length;return true;}if(required){this.error(error||(this.index===this.template.length?parser_errors.unexpected_eof_token(str):parser_errors.unexpected_token(str)));}return false;}match(str){return this.template.slice(this.index,this.index+str.length)===str;}match_regex(pattern){const match=pattern.exec(this.template.slice(this.index));if(!match||match.index!==0)return null;return match[0];}allow_whitespace(){while(this.index<this.template.length&&regex_whitespace.test(this.template[this.index])){this.index++;}}read(pattern){const result=this.match_regex(pattern);if(result)this.index+=result.length;return result;}read_identifier(){let allow_reserved=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;const start=this.index;let i=this.index;const code=full_char_code_at(this.template,i);if(!isIdentifierStart(code,true))return null;i+=code<=0xffff?1:2;while(i<this.template.length){const code=full_char_code_at(this.template,i);if(!isIdentifierChar(code,true))break;i+=code<=0xffff?1:2;}const identifier=this.template.slice(this.index,this.index=i);if(!allow_reserved&&reserved.has(identifier)){this.error({code:'unexpected-reserved-word',message:`'${identifier}' is a reserved word in JavaScript and cannot be used here`},start);}return identifier;}read_until(pattern,error_message){if(this.index>=this.template.length){this.error(error_message||{code:'unexpected-eof',message:'Unexpected end of input'});}const start=this.index;const match=pattern.exec(this.template.slice(start));if(match){this.index=start+match.index;return this.template.slice(start,this.index);}this.index=this.template.length;return this.template.slice(start);}require_whitespace(){if(!regex_whitespace.test(this.template[this.index])){this.error({code:'missing-whitespace',message:'Expected whitespace'});}this.allow_whitespace();}}function parse$3(template){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const parser=new Parser$1(template,options);// TODO we may want to allow multiple <style> tags —\n// one scoped, one global. for now, only allow one\nif(parser.css.length>1){parser.error(parser_errors.duplicate_style,parser.css[1].start);}const instance_scripts=parser.js.filter(script=>script.context==='default');const module_scripts=parser.js.filter(script=>script.context==='module');if(instance_scripts.length>1){parser.error(parser_errors.invalid_script_instance,instance_scripts[1].start);}if(module_scripts.length>1){parser.error(parser_errors.invalid_script_module,module_scripts[1].start);}return{html:parser.html,css:parser.css[0],instance:instance_scripts[0],module:module_scripts[0]};}function is_head(node){return node&&node.type==='MemberExpression'&&node.object['name']==='@_document'&&node.property['name']==='head';}class Block$1{constructor(options){this.dependencies=new Set();this.binding_group_initialised=new Set();this.event_listeners=[];this.variables=new Map();this.has_update_method=false;this.parent=options.parent;this.renderer=options.renderer;this.name=options.name;this.type=options.type;this.comment=options.comment;this.wrappers=[];// for keyed each blocks\nthis.key=options.key;this.first=null;this.bindings=options.bindings;this.chunks={declarations:[],init:[],create:[],claim:[],hydrate:[],mount:[],measure:[],restore_measurements:[],fix:[],animate:[],intro:[],update:[],outro:[],destroy:[]};this.has_animation=false;this.has_intro_method=false;// a block could have an intro method but not intro transitions, e.g. if a sibling block has intros\nthis.has_outro_method=false;this.outros=0;this.get_unique_name=this.renderer.component.get_unique_name_maker();this.aliases=new Map();if(this.key)this.aliases.set('key',this.get_unique_name('key'));}assign_variable_names(){const seen=new Set();const dupes=new Set();let i=this.wrappers.length;while(i--){const wrapper=this.wrappers[i];if(!wrapper.var)continue;if(seen.has(wrapper.var.name)){dupes.add(wrapper.var.name);}seen.add(wrapper.var.name);}const counts=new Map();i=this.wrappers.length;while(i--){const wrapper=this.wrappers[i];if(!wrapper.var)continue;let suffix='';if(dupes.has(wrapper.var.name)){const i=counts.get(wrapper.var.name)||0;counts.set(wrapper.var.name,i+1);suffix=i;}wrapper.var.name=this.get_unique_name(wrapper.var.name+suffix).name;}}add_dependencies(dependencies){dependencies.forEach(dependency=>{this.dependencies.add(dependency);});this.has_update_method=true;if(this.parent){this.parent.add_dependencies(dependencies);}}add_element(id,render_statement,claim_statement,parent_node,no_detach){this.add_variable(id);this.chunks.create.push(b`${id} = ${render_statement};`);if(this.renderer.options.hydratable){this.chunks.claim.push(b`${id} = ${claim_statement||render_statement};`);}if(parent_node){this.chunks.mount.push(b`@append(${parent_node}, ${id});`);if(is_head(parent_node)&&!no_detach)this.chunks.destroy.push(b`@detach(${id});`);}else{this.chunks.mount.push(b`@insert(#target, ${id}, #anchor);`);if(!no_detach)this.chunks.destroy.push(b`if (detaching) @detach(${id});`);}}add_intro(local){this.has_intros=this.has_intro_method=true;if(!local&&this.parent)this.parent.add_intro();}add_outro(local){this.has_outros=this.has_outro_method=true;this.outros+=1;if(!local&&this.parent)this.parent.add_outro();}add_animation(){this.has_animation=true;}add_variable(id,init){if(this.variables.has(id.name)){throw new Error(`Variable '${id.name}' already initialised with a different value`);}this.variables.set(id.name,{id,init});}alias(name){if(!this.aliases.has(name)){this.aliases.set(name,this.get_unique_name(name));}return this.aliases.get(name);}child(options){return new Block$1(Object.assign({},this,{key:null},options,{parent:this}));}get_contents(key){const{dev}=this.renderer.options;if(this.has_outros){this.add_variable({type:'Identifier',name:'#current'});if(this.chunks.intro.length>0){this.chunks.intro.push(b`#current = true;`);this.chunks.mount.push(b`#current = true;`);}if(this.chunks.outro.length>0){this.chunks.outro.push(b`#current = false;`);}}if(this.autofocus){if(this.autofocus.condition_expression){this.chunks.mount.push(b`if (${this.autofocus.condition_expression}) ${this.autofocus.element_var}.focus();`);}else{this.chunks.mount.push(b`${this.autofocus.element_var}.focus();`);}}this.render_listeners();const properties={};const noop=x`@noop`;properties.key=key;if(this.first){properties.first=x`null`;this.chunks.hydrate.push(b`this.first = ${this.first};`);}if(this.chunks.create.length===0&&this.chunks.hydrate.length===0){properties.create=noop;}else{const hydrate=this.chunks.hydrate.length>0&&(this.renderer.options.hydratable?b`this.h();`:this.chunks.hydrate);properties.create=x`function #create() {\n\t\t\t\t${this.chunks.create}\n\t\t\t\t${hydrate}\n\t\t\t}`;}if(this.renderer.options.hydratable||this.chunks.claim.length>0){if(this.chunks.claim.length===0&&this.chunks.hydrate.length===0){properties.claim=noop;}else{properties.claim=x`function #claim(#nodes) {\n\t\t\t\t\t${this.chunks.claim}\n\t\t\t\t\t${this.renderer.options.hydratable&&this.chunks.hydrate.length>0&&b`this.h();`}\n\t\t\t\t}`;}}if(this.renderer.options.hydratable&&this.chunks.hydrate.length>0){properties.hydrate=x`function #hydrate() {\n\t\t\t\t${this.chunks.hydrate}\n\t\t\t}`;}if(this.chunks.mount.length===0){properties.mount=noop;}else if(this.event_listeners.length===0){properties.mount=x`function #mount(#target, #anchor) {\n\t\t\t\t${this.chunks.mount}\n\t\t\t}`;}else{properties.mount=x`function #mount(#target, #anchor) {\n\t\t\t\t${this.chunks.mount}\n\t\t\t}`;}if(this.has_update_method||this.maintain_context){if(this.chunks.update.length===0&&!this.maintain_context){properties.update=noop;}else{const ctx=this.maintain_context?x`#new_ctx`:x`#ctx`;let dirty={type:'Identifier',name:'#dirty'};if(!this.renderer.context_overflow&&!this.parent){dirty={type:'ArrayPattern',elements:[dirty]};}properties.update=x`function #update(${ctx}, ${dirty}) {\n\t\t\t\t\t${this.maintain_context&&b`#ctx = ${ctx};`}\n\t\t\t\t\t${this.chunks.update}\n\t\t\t\t}`;}}if(this.has_animation){properties.measure=x`function #measure() {\n\t\t\t\t${this.chunks.measure}\n\t\t\t}`;if(this.chunks.restore_measurements.length){properties.restore_measurements=x`function #restore_measurements(#measurement) {\n\t\t\t\t\t${this.chunks.restore_measurements}\n\t\t\t\t}`;}properties.fix=x`function #fix() {\n\t\t\t\t${this.chunks.fix}\n\t\t\t}`;properties.animate=x`function #animate() {\n\t\t\t\t${this.chunks.animate}\n\t\t\t}`;}if(this.has_intro_method||this.has_outro_method){if(this.chunks.intro.length===0){properties.intro=noop;}else{properties.intro=x`function #intro(#local) {\n\t\t\t\t\t${this.has_outros&&b`if (#current) return;`}\n\t\t\t\t\t${this.chunks.intro}\n\t\t\t\t}`;}if(this.chunks.outro.length===0){properties.outro=noop;}else{properties.outro=x`function #outro(#local) {\n\t\t\t\t\t${this.chunks.outro}\n\t\t\t\t}`;}}if(this.chunks.destroy.length===0){properties.destroy=noop;}else{properties.destroy=x`function #destroy(detaching) {\n\t\t\t\t${this.chunks.destroy}\n\t\t\t}`;}if(!this.renderer.component.compile_options.dev){// allow shorthand names\nfor(const name in properties){const property=properties[name];if(property)property.id=null;}}const return_value=x`{\n\t\t\tkey: ${properties.key},\n\t\t\tfirst: ${properties.first},\n\t\t\tc: ${properties.create},\n\t\t\tl: ${properties.claim},\n\t\t\th: ${properties.hydrate},\n\t\t\tm: ${properties.mount},\n\t\t\tp: ${properties.update},\n\t\t\tr: ${properties.measure},\n\t\t\ts: ${properties.restore_measurements},\n\t\t\tf: ${properties.fix},\n\t\t\ta: ${properties.animate},\n\t\t\ti: ${properties.intro},\n\t\t\to: ${properties.outro},\n\t\t\td: ${properties.destroy}\n\t\t}`;const block=dev&&this.get_unique_name('block');const body=b`\n\t\t\t${this.chunks.declarations}\n\n\t\t\t${Array.from(this.variables.values()).map(_ref11=>{let{id,init}=_ref11;return init?b`let ${id} = ${init}`:b`let ${id}`;})}\n\n\t\t\t${this.chunks.init}\n\n\t\t\t${dev?b`\n\t\t\t\t\tconst ${block} = ${return_value};\n\t\t\t\t\t@dispatch_dev(\"SvelteRegisterBlock\", {\n\t\t\t\t\t\tblock: ${block},\n\t\t\t\t\t\tid: ${this.name||'create_fragment'}.name,\n\t\t\t\t\t\ttype: \"${this.type}\",\n\t\t\t\t\t\tsource: \"${this.comment?this.comment.replace(regex_double_quotes,'\\\\\"'):''}\",\n\t\t\t\t\t\tctx: #ctx\n\t\t\t\t\t});\n\t\t\t\t\treturn ${block};`:b`\n\t\t\t\t\treturn ${return_value};`}\n\t\t`;return body;}has_content(){return!!this.first||this.event_listeners.length>0||this.chunks.intro.length>0||this.chunks.outro.length>0||this.chunks.create.length>0||this.chunks.hydrate.length>0||this.chunks.claim.length>0||this.chunks.mount.length>0||this.chunks.update.length>0||this.chunks.destroy.length>0||this.has_animation;}render(){const key=this.key&&this.get_unique_name('key');const args=[x`#ctx`];if(key)args.unshift(key);const fn=b`function ${this.name}(${args}) {\n\t\t\t${this.get_contents(key)}\n\t\t}`;return this.comment?b`\n\t\t\t\t// ${this.comment}\n\t\t\t\t${fn}`:fn;}render_listeners(){let chunk=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';if(this.event_listeners.length>0){this.add_variable({type:'Identifier',name:'#mounted'});this.chunks.destroy.push(b`#mounted = false`);const dispose={type:'Identifier',name:`#dispose${chunk}`};this.add_variable(dispose);if(this.event_listeners.length===1){this.chunks.mount.push(b`\n\t\t\t\t\t\tif (!#mounted) {\n\t\t\t\t\t\t\t${dispose} = ${this.event_listeners[0]};\n\t\t\t\t\t\t\t#mounted = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t`);this.chunks.destroy.push(b`${dispose}();`);}else{this.chunks.mount.push(b`\n\t\t\t\t\tif (!#mounted) {\n\t\t\t\t\t\t${dispose} = [\n\t\t\t\t\t\t\t${this.event_listeners}\n\t\t\t\t\t\t];\n\t\t\t\t\t\t#mounted = true;\n\t\t\t\t\t}\n\t\t\t\t`);this.chunks.destroy.push(b`@run_all(${dispose});`);}}}}class Wrapper{constructor(renderer,block,parent,node){this.node=node;// make these non-enumerable so that they can be logged sensibly\n// (TODO in dev only?)\nObject.defineProperties(this,{renderer:{value:renderer},parent:{value:parent}});this.can_use_innerhtml=!renderer.options.hydratable;this.is_static_content=!renderer.options.hydratable;block.wrappers.push(this);}cannot_use_innerhtml(){this.can_use_innerhtml=false;if(this.parent)this.parent.cannot_use_innerhtml();}not_static_content(){this.is_static_content=false;if(this.parent)this.parent.not_static_content();}get_or_create_anchor(block,parent_node,parent_nodes){// TODO use this in EachBlock and IfBlock — tricky because\n// children need to be created first\nconst needs_anchor=this.next?!this.next.is_dom_node():!parent_node||!this.parent.is_dom_node();const anchor=needs_anchor?block.get_unique_name(`${this.var.name}_anchor`):this.next&&this.next.var||{type:'Identifier',name:'null'};if(needs_anchor){block.add_element(anchor,x`@empty()`,parent_nodes&&x`@empty()`,parent_node);}return anchor;}get_update_mount_node(anchor){return this.parent&&this.parent.is_dom_node()?this.parent.var:x`${anchor}.parentNode`;}is_dom_node(){return this.node.type==='Element'||this.node.type==='Text'||this.node.type==='MustacheTag';}render(_block,_parent_node,_parent_nodes){throw Error('Wrapper class is not renderable');}}function create_debugging_comment(node,component){const{locate,source}=component;let c=node.start;if(node.type==='ElseBlock'){while(source[c-1]!=='{')c-=1;while(source[c-1]==='{')c-=1;}let d;if(node.type==='InlineComponent'||node.type==='Element'||node.type==='SlotTemplate'){if(node.children.length){d=node.children[0].start;while(source[d-1]!=='>')d-=1;}else{d=node.start;while(source[d]!=='>')d+=1;d+=1;}}else if(node.type==='Text'||node.type==='Comment'){d=node.end;}else{// @ts-ignore\nd=node.expression?node.expression.node.end:c;while(source[d]!=='}'&&d<=source.length)d+=1;while(source[d]==='}')d+=1;}const start=locate(c);const loc=`(${start.line}:${start.column})`;return`${loc} ${source.slice(c,d)}`.replace(regex_whitespace_characters,' ');}class Node$1{constructor(component,parent,_scope,info){this.start=info.start;this.end=info.end;this.type=info.type;// this makes properties non-enumerable, which makes logging\n// bearable. might have a performance cost. TODO remove in prod?\nObject.defineProperties(this,{component:{value:component},parent:{value:parent}});}cannot_use_innerhtml(){if(this.can_use_innerhtml!==false){this.can_use_innerhtml=false;if(this.parent)this.parent.cannot_use_innerhtml();}}find_nearest(selector){if(selector.test(this.type))return this;if(this.parent)return this.parent.find_nearest(selector);}get_static_attribute_value(name){const attribute=this.attributes&&this.attributes.find(attr=>attr.type==='Attribute'&&attr.name.toLowerCase()===name);if(!attribute)return null;if(attribute.is_true)return true;if(attribute.chunks.length===0)return'';if(attribute.chunks.length===1&&attribute.chunks[0].type==='Text'){return attribute.chunks[0].data;}return null;}has_ancestor(type){return this.parent?this.parent.type===type||this.parent.has_ancestor(type):false;}}// All compiler warnings should be listed and accessed from here\n/**\n * @internal\n */var compiler_warnings={custom_element_no_tag:{code:'custom-element-no-tag',message:'No custom element \\'tag\\' option was specified. To automatically register a custom element, specify a name with a hyphen in it, e.g. <svelte:options tag=\"my-thing\"/>. To hide this warning, use <svelte:options tag={null}/>'},unused_export_let:(component,property)=>({code:'unused-export-let',message:`${component} has unused export property '${property}'. If it is for external reference only, please consider using \\`export const ${property}\\``}),module_script_reactive_declaration:{code:'module-script-reactive-declaration',message:'$: has no effect in a module script'},non_top_level_reactive_declaration:{code:'non-top-level-reactive-declaration',message:'$: has no effect outside of the top-level'},module_script_variable_reactive_declaration:names=>({code:'module-script-reactive-declaration',message:`${names.map(name=>`\"${name}\"`).join(', ')} ${names.length>1?'are':'is'} declared in a module script and will not be reactive`}),missing_declaration:(name,has_script)=>({code:'missing-declaration',message:`'${name}' is not defined`+(has_script?'':`. Consider adding a <script> block with 'export let ${name}' to declare a prop`)}),missing_custom_element_compile_options:{code:'missing-custom-element-compile-options',message:\"The 'tag' option is used when generating a custom element. Did you forget the 'customElement: true' compile option?\"},css_unused_selector:selector=>({code:'css-unused-selector',message:`Unused CSS selector \"${selector}\"`}),empty_block:{code:'empty-block',message:'Empty block'},reactive_component:name=>({code:'reactive-component',message:`<${name}/> will not be reactive if ${name} changes. Use <svelte:component this={${name}}/> if you want this reactivity.`}),component_name_lowercase:name=>({code:'component-name-lowercase',message:`<${name}> will be treated as an HTML element unless it begins with a capital letter`}),avoid_is:{code:'avoid-is',message:'The \\'is\\' attribute is not supported cross-browser and should be avoided'},invalid_html_attribute:(name,suggestion)=>({code:'invalid-html-attribute',message:`'${name}' is not a valid HTML attribute. Did you mean '${suggestion}'?`}),a11y_aria_attributes:name=>({code:'a11y-aria-attributes',message:`A11y: <${name}> should not have aria-* attributes`}),a11y_incorrect_attribute_type:(schema,attribute)=>{let message;switch(schema.type){case'boolean':message=`The value of '${attribute}' must be exactly one of true or false`;break;case'id':message=`The value of '${attribute}' must be a string that represents a DOM element ID`;break;case'idlist':message=`The value of '${attribute}' must be a space-separated list of strings that represent DOM element IDs`;break;case'tristate':message=`The value of '${attribute}' must be exactly one of true, false, or mixed`;break;case'token':message=`The value of '${attribute}' must be exactly one of ${(schema.values||[]).join(', ')}`;break;case'tokenlist':message=`The value of '${attribute}' must be a space-separated list of one or more of ${(schema.values||[]).join(', ')}`;break;default:message=`The value of '${attribute}' must be of type ${schema.type}`;}return{code:'a11y-incorrect-aria-attribute-type',message:`A11y: ${message}`};},a11y_unknown_aria_attribute:(attribute,suggestion)=>({code:'a11y-unknown-aria-attribute',message:`A11y: Unknown aria attribute 'aria-${attribute}'`+(suggestion?` (did you mean '${suggestion}'?)`:'')}),a11y_hidden:name=>({code:'a11y-hidden',message:`A11y: <${name}> element should not be hidden`}),a11y_misplaced_role:name=>({code:'a11y-misplaced-role',message:`A11y: <${name}> should not have role attribute`}),a11y_unknown_role:(role,suggestion)=>({code:'a11y-unknown-role',message:`A11y: Unknown role '${role}'`+(suggestion?` (did you mean '${suggestion}'?)`:'')}),a11y_no_abstract_role:role=>({code:'a11y-no-abstract-role',message:`A11y: Abstract role '${role}' is forbidden`}),a11y_no_redundant_roles:role=>({code:'a11y-no-redundant-roles',message:`A11y: Redundant role '${role}'`}),a11y_no_interactive_element_to_noninteractive_role:(role,element)=>({code:'a11y-no-interactive-element-to-noninteractive-role',message:`A11y: <${element}> cannot have role '${role}'`}),a11y_role_has_required_aria_props:(role,props)=>({code:'a11y-role-has-required-aria-props',message:`A11y: Elements with the ARIA role \"${role}\" must have the following attributes defined: ${props.map(name=>`\"${name}\"`).join(', ')}`}),a11y_accesskey:{code:'a11y-accesskey',message:'A11y: Avoid using accesskey'},a11y_autofocus:{code:'a11y-autofocus',message:'A11y: Avoid using autofocus'},a11y_misplaced_scope:{code:'a11y-misplaced-scope',message:'A11y: The scope attribute should only be used with <th> elements'},a11y_positive_tabindex:{code:'a11y-positive-tabindex',message:'A11y: avoid tabindex values above zero'},a11y_invalid_attribute:(href_attribute,href_value)=>({code:'a11y-invalid-attribute',message:`A11y: '${href_value}' is not a valid ${href_attribute} attribute`}),a11y_missing_attribute:(name,article,sequence)=>({code:'a11y-missing-attribute',message:`A11y: <${name}> element should have ${article} ${sequence} attribute`}),a11y_img_redundant_alt:{code:'a11y-img-redundant-alt',message:'A11y: Screenreaders already announce <img> elements as an image.'},a11y_label_has_associated_control:{code:'a11y-label-has-associated-control',message:'A11y: A form label must be associated with a control.'},a11y_media_has_caption:{code:'a11y-media-has-caption',message:'A11y: <video> elements must have a <track kind=\"captions\">'},a11y_distracting_elements:name=>({code:'a11y-distracting-elements',message:`A11y: Avoid <${name}> elements`}),a11y_structure_immediate:{code:'a11y-structure',message:'A11y: <figcaption> must be an immediate child of <figure>'},a11y_structure_first_or_last:{code:'a11y-structure',message:'A11y: <figcaption> must be first or last child of <figure>'},a11y_mouse_events_have_key_events:(event,accompanied_by)=>({code:'a11y-mouse-events-have-key-events',message:`A11y: on:${event} must be accompanied by on:${accompanied_by}`}),a11y_click_events_have_key_events:()=>({code:'a11y-click-events-have-key-events',message:'A11y: visible, non-interactive elements with an on:click event must be accompanied by an on:keydown, on:keyup, or on:keypress event.'}),a11y_missing_content:name=>({code:'a11y-missing-content',message:`A11y: <${name}> element should have child content`}),a11y_no_noninteractive_tabindex:{code:'a11y-no-noninteractive-tabindex',message:'A11y: noninteractive element cannot have positive tabIndex value'},redundant_event_modifier_for_touch:{code:'redundant-event-modifier',message:'Touch event handlers that don\\'t use the \\'event\\' object are passive by default'},redundant_event_modifier_passive:{code:'redundant-event-modifier',message:'The passive modifier only works with wheel and touch events'},invalid_rest_eachblock_binding:rest_element_name=>({code:'invalid-rest-eachblock-binding',message:`...${rest_element_name} operator will create a new object and binding propogation with original object will not work`})};const regex_non_whitespace_characters=/[^ \\r\\n\\f\\v\\t]/;class AbstractBlock extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);}warn_if_empty_block(){if(!this.children||this.children.length>1)return;const child=this.children[0];if(!child||child.type==='Text'&&!regex_non_whitespace_characters.test(child.data)){this.component.warn(this,compiler_warnings.empty_block);}}}function flatten_reference(node){const nodes=[];const parts=[];while(node.type==='MemberExpression'){nodes.unshift(node.property);if(!node.computed){parts.unshift(node.property.name);}else{const computed_property=to_string$1(node.property);if(computed_property){parts.unshift(`[${computed_property}]`);}}node=node.object;}const name=node.type==='Identifier'?node.name:node.type==='ThisExpression'?'this':null;nodes.unshift(node);parts.unshift(name);return{name,nodes,parts};}function to_string$1(node){switch(node.type){case'Literal':return String(node.value);case'Identifier':return node.name;}}function create_scopes(expression){return analyze(expression);}function get_object(node){while(node.type==='MemberExpression')node=node.object;return node;}const reserved_keywords=new Set(['$$props','$$restProps','$$slots']);function is_reserved_keyword(name){return reserved_keywords.has(name);}function is_dynamic(variable){if(variable){if(variable.mutated||variable.reassigned)return true;// dynamic internal state\nif(!variable.module&&variable.writable&&variable.export_name)return true;// writable props\nif(is_reserved_keyword(variable.name))return true;}return false;}function nodes_match(a,b){if(!!a!==!!b)return false;if(Array.isArray(a)!==Array.isArray(b))return false;if(a&&typeof a==='object'){if(Array.isArray(a)){if(a.length!==b.length)return false;return a.every((child,i)=>nodes_match(child,b[i]));}const a_keys=Object.keys(a).sort();const b_keys=Object.keys(b).sort();if(a_keys.length!==b_keys.length)return false;let i=a_keys.length;while(i--){const key=a_keys[i];if(b_keys[i]!==key)return false;if(key==='start'||key==='end')continue;if(!nodes_match(a[key],b[key])){return false;}}return true;}return a===b;}function invalidate(renderer,scope,node,names){let main_execution_context=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;const{component}=renderer;const[head,...tail]=Array.from(names).filter(name=>{const owner=scope.find_owner(name);return!owner||owner===component.instance_scope;}).map(name=>component.var_lookup.get(name)).filter(variable=>{return variable&&!variable.hoistable&&!variable.global&&!variable.module&&(variable.referenced||variable.subscribable||variable.is_reactive_dependency||variable.export_name||variable.name[0]==='$');});function get_invalidated(variable,node){if(main_execution_context&&!variable.subscribable&&variable.name[0]!=='$'){return node;}return renderer_invalidate(renderer,variable.name,undefined,main_execution_context);}if(!head){return node;}component.has_reactive_assignments=true;if(node.type==='AssignmentExpression'&&node.operator==='='&&nodes_match(node.left,node.right)&&tail.length===0){return get_invalidated(head,node);}const is_store_value=head.name[0]==='$'&&head.name[1]!=='$';const extra_args=tail.map(variable=>get_invalidated(variable)).filter(Boolean);if(is_store_value){return x`@set_store_value(${head.name.slice(1)}, ${node}, ${head.name}, ${extra_args})`;}let invalidate;if(!main_execution_context){const pass_value=extra_args.length>0||node.type==='AssignmentExpression'&&node.left.type!=='Identifier'||node.type==='UpdateExpression'&&(!node.prefix||node.argument.type!=='Identifier');if(pass_value){extra_args.unshift({type:'Identifier',name:head.name});}invalidate=x`$$invalidate(${renderer.context_lookup.get(head.name).index}, ${node}, ${extra_args})`;}else{// skip `$$invalidate` if it is in the main execution context\ninvalidate=extra_args.length?[node,...extra_args]:node;}if(head.subscribable&&head.reassigned){const subscribe=`$$subscribe_${head.name}`;invalidate=x`${subscribe}(${invalidate})`;}return invalidate;}function renderer_invalidate(renderer,name,value){let main_execution_context=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const variable=renderer.component.var_lookup.get(name);if(variable&&variable.subscribable&&(variable.reassigned||variable.export_name)){if(main_execution_context){return x`${`$$subscribe_${name}`}(${value||name})`;}else{const member=renderer.context_lookup.get(name);return x`${`$$subscribe_${name}`}($$invalidate(${member.index}, ${value||name}))`;}}if(name[0]==='$'&&name[1]!=='$'){return x`${name.slice(1)}.set(${value||name})`;}if(variable&&(variable.module||!variable.referenced&&!variable.is_reactive_dependency&&!variable.export_name&&!name.startsWith('$$'))){return value||name;}if(value){if(main_execution_context){return x`${value}`;}else{const member=renderer.context_lookup.get(name);return x`$$invalidate(${member.index}, ${value})`;}}if(main_execution_context)return;// if this is a reactive declaration, invalidate dependencies recursively\nconst deps=new Set([name]);deps.forEach(name=>{const reactive_declarations=renderer.component.reactive_declarations.filter(x=>x.assignees.has(name));reactive_declarations.forEach(declaration=>{declaration.dependencies.forEach(name=>{deps.add(name);});});});// TODO ideally globals etc wouldn't be here in the first place\nconst filtered=Array.from(deps).filter(n=>renderer.context_lookup.has(n));if(!filtered.length)return null;return filtered.map(n=>x`$$invalidate(${renderer.context_lookup.get(n).index}, ${n})`).reduce((lhs,rhs)=>x`${lhs}, ${rhs}`);}function replace_object(node,replacement){if(node.type==='Identifier')return replacement;const ancestor=node;let parent;while(node.type==='MemberExpression'){parent=node;node=node.object;}parent.object=replacement;return ancestor;}function is_contextual(component,scope,name){if(is_reserved_keyword(name))return true;// if it's a name below root scope, it's contextual\nif(!scope.is_top_level(name))return true;const variable=component.var_lookup.get(name);// hoistables, module declarations, and imports are non-contextual\nif(!variable||variable.hoistable)return false;// assume contextual\nreturn true;}// adapted from klona v2.0.4 - https://github.com/lukeed/klona\n// (c) Luke Edwards, under MIT License\n// The sole modification is to skip function values in objects when cloning, so we don't break tests.\nfunction clone(val){let k,out,tmp;if(Array.isArray(val)){out=Array(k=val.length);while(k--)out[k]=(tmp=val[k])&&typeof tmp==='object'?clone(tmp):tmp;return out;}if(Object.prototype.toString.call(val)==='[object Object]'){out={};// null\nfor(k in val){if(k==='__proto__'){Object.defineProperty(out,k,{value:clone(val[k]),configurable:true,enumerable:true,writable:true});}else if(typeof val[k]!=='function'){// MODIFICATION: skip functions\nout[k]=(tmp=val[k])&&typeof tmp==='object'?clone(tmp):tmp;}}return out;}return val;}// All compiler errors should be listed and accessed from here\n/**\n * @internal\n */var compiler_errors={invalid_binding_elements:(element,binding)=>({code:'invalid-binding',message:`'${binding}' is not a valid binding on <${element}> elements`}),invalid_binding_element_with:(elements,binding)=>({code:'invalid-binding',message:`'${binding}' binding can only be used with ${elements}`}),invalid_binding_on:(binding,element,post)=>({code:'invalid-binding',message:`'${binding}' is not a valid binding on ${element}`+(post||'')}),invalid_binding_foreign:binding=>({code:'invalid-binding',message:`'${binding}' is not a valid binding. Foreign elements only support bind:this`}),invalid_binding_no_checkbox:(binding,is_radio)=>({code:'invalid-binding',message:`'${binding}' binding can only be used with <input type=\"checkbox\">`+(is_radio?' — for <input type=\"radio\">, use \\'group\\' binding':'')}),invalid_binding:binding=>({code:'invalid-binding',message:`'${binding}' is not a valid binding`}),invalid_binding_window:parts=>({code:'invalid-binding',message:`Bindings on <svelte:window> must be to top-level properties, e.g. '${parts[parts.length-1]}' rather than '${parts.join('.')}'`}),invalid_binding_let:{code:'invalid-binding',message:'Cannot bind to a variable declared with the let: directive'},invalid_binding_await:{code:'invalid-binding',message:'Cannot bind to a variable declared with {#await ... then} or {:catch} blocks'},invalid_binding_const:{code:'invalid-binding',message:'Cannot bind to a variable declared with {@const ...}'},invalid_binding_writibale:{code:'invalid-binding',message:'Cannot bind to a variable which is not writable'},binding_undeclared:name=>({code:'binding-undeclared',message:`${name} is not declared`}),invalid_type:{code:'invalid-type',message:'\\'type\\' attribute cannot be dynamic if input uses two-way binding'},missing_type:{code:'missing-type',message:'\\'type\\' attribute must be specified'},dynamic_multiple_attribute:{code:'dynamic-multiple-attribute',message:'\\'multiple\\' attribute cannot be dynamic if select uses two-way binding'},missing_contenteditable_attribute:{code:'missing-contenteditable-attribute',message:'\\'contenteditable\\' attribute is required for textContent and innerHTML two-way bindings'},dynamic_contenteditable_attribute:{code:'dynamic-contenteditable-attribute',message:'\\'contenteditable\\' attribute cannot be dynamic if element uses two-way binding'},invalid_event_modifier_combination:(modifier1,modifier2)=>({code:'invalid-event-modifier',message:`The '${modifier1}' and '${modifier2}' modifiers cannot be used together`}),invalid_event_modifier_legacy:modifier=>({code:'invalid-event-modifier',message:`The '${modifier}' modifier cannot be used in legacy mode`}),invalid_event_modifier:valid=>({code:'invalid-event-modifier',message:`Valid event modifiers are ${valid}`}),invalid_event_modifier_component:{code:'invalid-event-modifier',message:\"Event modifiers other than 'once' can only be used on DOM elements\"},textarea_duplicate_value:{code:'textarea-duplicate-value',message:'A <textarea> can have either a value attribute or (equivalently) child content, but not both'},illegal_attribute:name=>({code:'illegal-attribute',message:`'${name}' is not a valid attribute name`}),invalid_slot_attribute:{code:'invalid-slot-attribute',message:'slot attribute cannot have a dynamic value'},duplicate_slot_attribute:name=>({code:'duplicate-slot-attribute',message:`Duplicate '${name}' slot`}),invalid_slotted_content:{code:'invalid-slotted-content',message:'Element with a slot=\\'...\\' attribute must be a child of a component or a descendant of a custom element'},invalid_attribute_head:{code:'invalid-attribute',message:'<svelte:head> should not have any attributes or directives'},invalid_action:{code:'invalid-action',message:'Actions can only be applied to DOM elements, not components'},invalid_class:{code:'invalid-class',message:'Classes can only be applied to DOM elements, not components'},invalid_transition:{code:'invalid-transition',message:'Transitions can only be applied to DOM elements, not components'},invalid_let:{code:'invalid-let',message:'let directive value must be an identifier or an object/array pattern'},invalid_slot_directive:{code:'invalid-slot-directive',message:'<slot> cannot have directives'},dynamic_slot_name:{code:'dynamic-slot-name',message:'<slot> name cannot be dynamic'},invalid_slot_name:{code:'invalid-slot-name',message:'default is a reserved word — it cannot be used as a slot name'},invalid_slot_attribute_value_missing:{code:'invalid-slot-attribute',message:'slot attribute value is missing'},invalid_slotted_content_fragment:{code:'invalid-slotted-content',message:'<svelte:fragment> must be a child of a component'},illegal_attribute_title:{code:'illegal-attribute',message:'<title> cannot have attributes'},illegal_structure_title:{code:'illegal-structure',message:'<title> can only contain text and {tags}'},duplicate_transition:(directive,parent_directive)=>{function describe(_directive){return _directive==='transition'?\"a 'transition'\":`an '${_directive}'`;}const message=directive===parent_directive?`An element can only have one '${directive}' directive`:`An element cannot have both ${describe(parent_directive)} directive and ${describe(directive)} directive`;return{code:'duplicate-transition',message};},contextual_store:{code:'contextual-store',message:'Stores must be declared at the top level of the component (this may change in a future version of Svelte)'},default_export:{code:'default-export',message:'A component cannot have a default export'},illegal_declaration:{code:'illegal-declaration',message:'The $ prefix is reserved, and cannot be used for variable and import names'},illegal_subscription:{code:'illegal-subscription',message:'Cannot reference store value inside <script context=\"module\">'},illegal_global:name=>({code:'illegal-global',message:`${name} is an illegal variable name`}),illegal_variable_declaration:{code:'illegal-variable-declaration',message:'Cannot declare same variable name which is imported inside <script context=\"module\">'},cyclical_reactive_declaration:cycle=>({code:'cyclical-reactive-declaration',message:`Cyclical dependency detected: ${cycle.join(' → ')}`}),invalid_tag_property:{code:'invalid-tag-property',message:\"tag name must be two or more words joined by the '-' character\"},invalid_tag_attribute:{code:'invalid-tag-attribute',message:\"'tag' must be a string literal\"},invalid_namespace_property:(namespace,suggestion)=>({code:'invalid-namespace-property',message:`Invalid namespace '${namespace}'`+(suggestion?` (did you mean '${suggestion}'?)`:'')}),invalid_namespace_attribute:{code:'invalid-namespace-attribute',message:\"The 'namespace' attribute must be a string literal representing a valid namespace\"},invalid_attribute_value:name=>({code:`invalid-${name}-value`,message:`${name} attribute must be true or false`}),invalid_options_attribute_unknown:{code:'invalid-options-attribute',message:'<svelte:options> unknown attribute'},invalid_options_attribute:{code:'invalid-options-attribute',message:\"<svelte:options> can only have static 'tag', 'namespace', 'accessors', 'immutable' and 'preserveWhitespace' attributes\"},css_invalid_global:{code:'css-invalid-global',message:':global(...) can be at the start or end of a selector sequence, but not in the middle'},css_invalid_global_selector:{code:'css-invalid-global-selector',message:':global(...) must contain a single selector'},css_invalid_selector:selector=>({code:'css-invalid-selector',message:`Invalid selector \"${selector}\"`}),duplicate_animation:{code:'duplicate-animation',message:\"An element can only have one 'animate' directive\"},invalid_animation_immediate:{code:'invalid-animation',message:'An element that uses the animate directive must be the immediate child of a keyed each block'},invalid_animation_key:{code:'invalid-animation',message:'An element that uses the animate directive must be used inside a keyed each block. Did you forget to add a key to your each block?'},invalid_animation_sole:{code:'invalid-animation',message:'An element that uses the animate directive must be the sole child of a keyed each block'},invalid_animation_dynamic_element:{code:'invalid-animation',message:'<svelte:element> cannot have a animate directive'},invalid_directive_value:{code:'invalid-directive-value',message:'Can only bind to an identifier (e.g. `foo`) or a member expression (e.g. `foo.bar` or `foo[baz]`)'},invalid_const_placement:{code:'invalid-const-placement',message:'{@const} must be the immediate child of {#if}, {:else if}, {:else}, {#each}, {:then}, {:catch}, <svelte:fragment> or <Component>'},invalid_const_declaration:name=>({code:'invalid-const-declaration',message:`'${name}' has already been declared`}),invalid_const_update:name=>({code:'invalid-const-update',message:`'${name}' is declared using {@const ...} and is read-only`}),cyclical_const_tags:cycle=>({code:'cyclical-const-tags',message:`Cyclical dependency detected: ${cycle.join(' → ')}`}),invalid_component_style_directive:{code:'invalid-component-style-directive',message:'Style directives cannot be used on components'},invalid_style_directive_modifier:valid=>({code:'invalid-style-directive-modifier',message:`Valid modifiers for style directives are: ${valid}`})};const regex_contains_term_function_expression=/FunctionExpression/;class Expression{constructor(component,owner,template_scope,info,lazy){this.type='Expression';this.references=new Set();this.dependencies=new Set();this.contextual_dependencies=new Set();this.declarations=[];this.uses_context=false;// TODO revert to direct property access in prod?\nObject.defineProperties(this,{component:{value:component}});this.node=info;this.template_scope=template_scope;this.owner=owner;const{dependencies,contextual_dependencies,references}=this;let{map,scope}=create_scopes(info);this.scope=scope;this.scope_map=map;const expression=this;let function_expression;// discover dependencies, but don't change the code yet\nwalk(info,{enter(node,parent,key){// don't manipulate shorthand props twice\nif(key==='key'&&parent.shorthand)return;// don't manipulate `import.meta`, `new.target`\nif(node.type==='MetaProperty')return this.skip();if(map.has(node)){scope=map.get(node);}if(!function_expression&&regex_contains_term_function_expression.test(node.type)){function_expression=node;}if(is_reference(node,parent)){const{name,nodes}=flatten_reference(node);references.add(name);if(scope.has(name))return;if(name[0]==='$'){const store_name=name.slice(1);if(template_scope.names.has(store_name)||scope.has(store_name)){return component.error(node,compiler_errors.contextual_store);}}if(template_scope.is_let(name)){if(!lazy){contextual_dependencies.add(name);dependencies.add(name);}}else if(template_scope.names.has(name)){expression.uses_context=true;contextual_dependencies.add(name);const owner=template_scope.get_owner(name);const is_index=owner.type==='EachBlock'&&owner.key&&name===owner.index;if(!lazy||is_index){template_scope.dependencies_for_name.get(name).forEach(name=>dependencies.add(name));}}else{if(!lazy){dependencies.add(name);}component.add_reference(node,name);component.warn_if_undefined(name,nodes[0],template_scope);}this.skip();}// track any assignments from template expressions as mutable\nlet names;let deep=false;if(function_expression){if(node.type==='AssignmentExpression'){deep=node.left.type==='MemberExpression';names=extract_names(deep?get_object(node.left):node.left);}else if(node.type==='UpdateExpression'){deep=node.argument.type==='MemberExpression';names=extract_names(get_object(node.argument));}}if(names){names.forEach(name=>{var _a;if(template_scope.names.has(name)){if(template_scope.is_const(name)){component.error(node,compiler_errors.invalid_const_update(name));}template_scope.dependencies_for_name.get(name).forEach(name=>{const variable=component.var_lookup.get(name);if(variable)variable[deep?'mutated':'reassigned']=true;});const each_block=template_scope.get_owner(name);each_block.has_binding=true;}else{component.add_reference(node,name);const variable=component.var_lookup.get(name);if(variable){variable[deep?'mutated':'reassigned']=true;}const declaration=(_a=scope.find_owner(name))===null||_a===void 0?void 0:_a.declarations.get(name);if(declaration){if(declaration.kind==='const'&&!deep){component.error(node,{code:'assignment-to-const',message:'You are assigning to a const'});}}else if(variable&&variable.writable===false&&!deep){component.error(node,{code:'assignment-to-const',message:'You are assigning to a const'});}}});}},leave(node){if(map.has(node)){scope=scope.parent;}if(node===function_expression){function_expression=null;}}});}dynamic_dependencies(){return Array.from(this.dependencies).filter(name=>{if(this.template_scope.is_let(name))return true;if(is_reserved_keyword(name))return true;const variable=this.component.var_lookup.get(name);return is_dynamic(variable);});}// TODO move this into a render-dom wrapper?\nmanipulate(block,ctx){// TODO ideally we wouldn't end up calling this method\n// multiple times\nif(this.manipulated)return this.manipulated;const{component,declarations,scope_map:map,template_scope,owner}=this;let scope=this.scope;let function_expression;let dependencies;let contextual_dependencies;const node=walk(this.node,{enter(node,parent){if(node.type==='Property'&&node.shorthand){node.value=clone(node.value);node.shorthand=false;}if(map.has(node)){scope=map.get(node);}if(node.type==='Identifier'&&is_reference(node,parent)){const{name}=flatten_reference(node);if(scope.has(name))return;if(function_expression){if(template_scope.names.has(name)){contextual_dependencies.add(name);template_scope.dependencies_for_name.get(name).forEach(dependency=>{dependencies.add(dependency);});}else{dependencies.add(name);component.add_reference(node,name);// TODO is this redundant/misplaced?\n}}else if(is_contextual(component,template_scope,name)){const reference=block.renderer.reference(node,ctx);this.replace(reference);}this.skip();}if(!function_expression){if(node.type==='AssignmentExpression');if(node.type==='FunctionExpression'||node.type==='ArrowFunctionExpression'){function_expression=node;dependencies=new Set();contextual_dependencies=new Set();}}},leave(node,parent){if(map.has(node))scope=scope.parent;if(node===function_expression){const id=component.get_unique_name(sanitize(get_function_name(node,owner)));const declaration=b`const ${id} = ${node}`;if(owner.type==='ConstTag'){let child_scope=scope;walk(node,{enter(node,parent){if(map.has(node))child_scope=map.get(node);if(node.type==='Identifier'&&is_reference(node,parent)){if(child_scope.has(node.name))return;this.replace(block.renderer.reference(node,ctx));}},leave(node){if(map.has(node))child_scope=child_scope.parent;}});}else if(dependencies.size===0&&contextual_dependencies.size===0){// we can hoist this out of the component completely\ncomponent.fully_hoisted.push(declaration);this.replace(id);component.add_var(node,{name:id.name,internal:true,hoistable:true,referenced:true});}else if(contextual_dependencies.size===0){// function can be hoisted inside the component init\ncomponent.partly_hoisted.push(declaration);block.renderer.add_to_context(id.name);this.replace(block.renderer.reference(id));}else{// we need a combo block/init recipe\nconst deps=Array.from(contextual_dependencies);const function_expression=node;const has_args=function_expression.params.length>0;function_expression.params=[...deps.map(name=>({type:'Identifier',name})),...function_expression.params];const context_args=deps.map(name=>block.renderer.reference(name));component.partly_hoisted.push(declaration);block.renderer.add_to_context(id.name);const callee=block.renderer.reference(id);this.replace(id);const func_declaration=has_args?b`function ${id}(...args) {\n\t\t\t\t\t\t\t\treturn ${callee}(${context_args}, ...args);\n\t\t\t\t\t\t\t}`:b`function ${id}() {\n\t\t\t\t\t\t\t\treturn ${callee}(${context_args});\n\t\t\t\t\t\t\t}`;if(owner.type==='Attribute'&&owner.parent.name==='slot'){const dep_scopes=new Set(deps.map(name=>template_scope.get_owner(name)));// find the nearest scopes\nlet node=owner.parent;while(node&&!dep_scopes.has(node)){node=node.parent;}const func_expression=func_declaration[0];if(node.type==='InlineComponent'||node.type==='SlotTemplate'){// <Comp let:data />\nthis.replace(func_expression);}else{// {#each}, {#await}\nconst func_id=component.get_unique_name(id.name+'_func');block.renderer.add_to_context(func_id.name,true);// rename #ctx -> child_ctx;\nwalk(func_expression,{enter(node){if(node.type==='Identifier'&&node.name==='#ctx'){node.name='child_ctx';}}});// add to get_xxx_context\n// child_ctx[x] = function () { ... }\ntemplate_scope.get_owner(deps[0]).contexts.push({key:func_id,modifier:()=>func_expression,default_modifier:node=>node});this.replace(block.renderer.reference(func_id));}}else{declarations.push(func_declaration);}}function_expression=null;dependencies=null;contextual_dependencies=null;if(parent&&parent.type==='Property'){parent.method=false;}}if(node.type==='AssignmentExpression'||node.type==='UpdateExpression'){const assignee=node.type==='AssignmentExpression'?node.left:node.argument;const object_name=get_object(assignee).name;if(scope.has(object_name))return;// normally (`a = 1`, `b.c = 2`), there'll be a single name\n// (a or b). In destructuring cases (`[d, e] = [e, d]`) there\n// may be more, in which case we need to tack the extra ones\n// onto the initial function call\nconst names=new Set(extract_names(assignee));const traced=new Set();names.forEach(name=>{const dependencies=template_scope.dependencies_for_name.get(name);if(dependencies){dependencies.forEach(name=>traced.add(name));}else{traced.add(name);}});const context=block.bindings.get(object_name);if(context){// for `{#each array as item}`\n// replace `item = 1` to `each_array[each_index] = 1`, this allow us to mutate the array\n// rather than mutating the local `item` variable\nconst{snippet,object,property}=context;const replaced=replace_object(assignee,snippet);if(node.type==='AssignmentExpression'){node.left=replaced;}else{node.argument=replaced;}contextual_dependencies.add(object.name);contextual_dependencies.add(property.name);}this.replace(invalidate(block.renderer,scope,node,traced));}}});if(declarations.length>0){block.maintain_context=true;declarations.forEach(declaration=>{block.chunks.init.push(declaration);});}return this.manipulated=node;}}function get_function_name(_node,parent){if(parent.type==='EventHandler'){return`${parent.name}_handler`;}if(parent.type==='Action'){return`${parent.name}_function`;}return'func';}function unpack_destructuring(_ref12){let{contexts,node,modifier=node=>node,default_modifier=node=>node,scope,component,context_rest_properties}=_ref12;if(!node)return;if(node.type==='Identifier'){contexts.push({key:node,modifier,default_modifier});}else if(node.type==='RestElement'){contexts.push({key:node.argument,modifier,default_modifier});context_rest_properties.set(node.argument.name,node);}else if(node.type==='ArrayPattern'){node.elements.forEach((element,i)=>{if(element&&element.type==='RestElement'){unpack_destructuring({contexts,node:element,modifier:node=>x`${modifier(node)}.slice(${i})`,default_modifier,scope,component,context_rest_properties});context_rest_properties.set(element.argument.name,element);}else if(element&&element.type==='AssignmentPattern'){const n=contexts.length;mark_referenced(element.right,scope,component);unpack_destructuring({contexts,node:element.left,modifier:node=>x`${modifier(node)}[${i}]`,default_modifier:(node,to_ctx)=>x`${node} !== undefined ? ${node} : ${update_reference(contexts,n,element.right,to_ctx)}`,scope,component,context_rest_properties});}else{unpack_destructuring({contexts,node:element,modifier:node=>x`${modifier(node)}[${i}]`,default_modifier,scope,component,context_rest_properties});}});}else if(node.type==='ObjectPattern'){const used_properties=[];node.properties.forEach(property=>{if(property.type==='RestElement'){unpack_destructuring({contexts,node:property.argument,modifier:node=>x`@object_without_properties(${modifier(node)}, [${used_properties}])`,default_modifier,scope,component,context_rest_properties});context_rest_properties.set(property.argument.name,property);}else{const key=property.key;const value=property.value;used_properties.push(x`\"${key.name}\"`);if(value.type==='AssignmentPattern'){const n=contexts.length;mark_referenced(value.right,scope,component);unpack_destructuring({contexts,node:value.left,modifier:node=>x`${modifier(node)}.${key.name}`,default_modifier:(node,to_ctx)=>x`${node} !== undefined ? ${node} : ${update_reference(contexts,n,value.right,to_ctx)}`,scope,component,context_rest_properties});}else{unpack_destructuring({contexts,node:value,modifier:node=>x`${modifier(node)}.${key.name}`,default_modifier,scope,component,context_rest_properties});}}});}}function update_reference(contexts,n,expression,to_ctx){const find_from_context=node=>{for(let i=n;i<contexts.length;i++){const{key}=contexts[i];if(node.name===key.name){throw new Error(`Cannot access '${node.name}' before initialization`);}}return to_ctx(node.name);};if(expression.type==='Identifier'){return find_from_context(expression);}// NOTE: avoid unnecessary deep clone?\nexpression=clone(expression);walk(expression,{enter(node,parent){if(is_reference(node,parent)){this.replace(find_from_context(node));this.skip();}}});return expression;}function mark_referenced(node,scope,component){walk(node,{enter(node,parent){if(is_reference(node,parent)){const{name}=flatten_reference(node);if(!scope.is_let(name)&&!scope.names.has(name)){component.add_reference(node,name);}}}});}const allowed_parents=new Set(['EachBlock','CatchBlock','ThenBlock','InlineComponent','SlotTemplate','IfBlock','ElseBlock']);class ConstTag extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.contexts=[];this.context_rest_properties=new Map();this.assignees=new Set();this.dependencies=new Set();if(!allowed_parents.has(parent.type)){component.error(info,compiler_errors.invalid_const_placement);}this.node=info;this.scope=scope;const{assignees,dependencies}=this;extract_identifiers(info.expression.left).forEach(_ref13=>{let{name}=_ref13;assignees.add(name);const owner=this.scope.get_owner(name);if(owner===parent){component.error(info,compiler_errors.invalid_const_declaration(name));}});walk(info.expression.right,{enter(node,parent){if(is_reference(node,parent)){const identifier=get_object(node);const{name}=identifier;dependencies.add(name);}}});}parse_expression(){unpack_destructuring({contexts:this.contexts,node:this.node.expression.left,scope:this.scope,component:this.component,context_rest_properties:this.context_rest_properties});this.expression=new Expression(this.component,this,this.scope,this.node.expression.right);this.contexts.forEach(context=>{const owner=this.scope.get_owner(context.key.name);if(owner&&owner.type==='ConstTag'&&owner.parent===this.parent){this.component.error(this.node,compiler_errors.invalid_const_declaration(context.key.name));}this.scope.add(context.key.name,this.expression.dependencies,this);});}}class PendingBlock extends AbstractBlock{constructor(component,parent,scope,info){super(component,parent,scope,info);this.children=map_children(component,parent,scope,info.children);if(!info.skip){this.warn_if_empty_block();}}}class CatchBlock extends AbstractBlock{constructor(component,parent,scope,info){super(component,parent,scope,info);this.scope=scope.child();if(parent.catch_node){parent.catch_contexts.forEach(context=>{this.scope.add(context.key.name,parent.expression.dependencies,this);});}[this.const_tags,this.children]=get_const_tags(info.children,component,this,parent);if(!info.skip){this.warn_if_empty_block();}}}class AwaitBlock extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.context_rest_properties=new Map();this.expression=new Expression(component,this,scope,info.expression);this.then_node=info.value;this.catch_node=info.error;if(this.then_node){this.then_contexts=[];unpack_destructuring({contexts:this.then_contexts,node:info.value,scope,component,context_rest_properties:this.context_rest_properties});}if(this.catch_node){this.catch_contexts=[];unpack_destructuring({contexts:this.catch_contexts,node:info.error,scope,component,context_rest_properties:this.context_rest_properties});}this.pending=new PendingBlock(component,this,scope,info.pending);this.then=new ThenBlock(component,this,scope,info.then);this.catch=new CatchBlock(component,this,scope,info.catch);}}const regex_contains_term_function_expression$1=/FunctionExpression/;class EventHandler extends Node$1{constructor(component,parent,template_scope,info){super(component,parent,template_scope,info);this.uses_context=false;this.can_make_passive=false;this.name=info.name;this.modifiers=new Set(info.modifiers);if(info.expression){this.expression=new Expression(component,this,template_scope,info.expression);this.uses_context=this.expression.uses_context;if(regex_contains_term_function_expression$1.test(info.expression.type)&&info.expression.params.length===0){// TODO make this detection more accurate — if `event.preventDefault` isn't called, and\n// `event` is passed to another function, we can make it passive\nthis.can_make_passive=true;}else if(info.expression.type==='Identifier'){let node=component.node_for_declaration.get(info.expression.name);if(node){if(node.type==='VariableDeclaration'){// for `const handleClick = () => {...}`, we want the [arrow] function expression node\nconst declarator=node.declarations.find(d=>d.id.name===info.expression.name);node=declarator&&declarator.init;}if(node&&(node.type==='FunctionExpression'||node.type==='FunctionDeclaration'||node.type==='ArrowFunctionExpression')&&node.params.length===0){this.can_make_passive=true;}}}}else{this.handler_name=component.get_unique_name(`${sanitize(this.name)}_handler`);}}get reassigned(){if(!this.expression){return false;}const node=this.expression.node;if(regex_contains_term_function_expression$1.test(node.type)){return false;}return this.expression.dynamic_dependencies().length>0;}}class Action extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);const object=info.name.split('.')[0];component.warn_if_undefined(object,info,scope);this.name=info.name;component.add_reference(this,object);this.expression=info.expression?new Expression(component,this,scope,info.expression):null;this.template_scope=scope;this.uses_context=this.expression&&this.expression.uses_context;}}class Body extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.handlers=[];this.actions=[];info.attributes.forEach(node=>{if(node.type==='EventHandler'){this.handlers.push(new EventHandler(component,this,scope,node));}else if(node.type==='Action'){this.actions.push(new Action(component,this,scope,node));}});}}class Comment$1 extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.data=info.data;this.ignores=info.ignores;}}class ElseBlock extends AbstractBlock{constructor(component,parent,scope,info){super(component,parent,scope,info);this.scope=scope.child();[this.const_tags,this.children]=get_const_tags(info.children,component,this,this);this.warn_if_empty_block();}}class EachBlock extends AbstractBlock{constructor(component,parent,scope,info){super(component,parent,scope,info);this.has_binding=false;this.has_index_binding=false;this.expression=new Expression(component,this,scope,info.expression);this.context=info.context.name||'each';// TODO this is used to facilitate binding; currently fails with destructuring\nthis.context_node=info.context;this.index=info.index;this.scope=scope.child();this.context_rest_properties=new Map();this.contexts=[];unpack_destructuring({contexts:this.contexts,node:info.context,scope,component,context_rest_properties:this.context_rest_properties});this.contexts.forEach(context=>{this.scope.add(context.key.name,this.expression.dependencies,this);});if(this.index){// index can only change if this is a keyed each block\nconst dependencies=info.key?this.expression.dependencies:new Set([]);this.scope.add(this.index,dependencies,this);}this.key=info.key?new Expression(component,this,this.scope,info.key):null;this.has_animation=false;[this.const_tags,this.children]=get_const_tags(info.children,component,this,this);if(this.has_animation){this.children=this.children.filter(child=>!isEmptyNode(child)&&!isCommentNode(child));if(this.children.length!==1){const child=this.children.find(child=>!!child.animation);component.error(child.animation,compiler_errors.invalid_animation_sole);return;}}this.warn_if_empty_block();this.else=info.else?new ElseBlock(component,this,this.scope,info.else):null;}}function isEmptyNode(node){return node.type==='Text'&&node.data.trim()==='';}function isCommentNode(node){return node.type==='Comment';}function string_literal(data){return{type:'Literal',value:data};}const escaped={'\"':'&quot;',\"'\":'&#39;','&':'&amp;','<':'&lt;','>':'&gt;'};const regex_html_characters_to_escape=/[\"'&<>]/g;function escape_html(html){return String(html).replace(regex_html_characters_to_escape,match=>escaped[match]);}const regex_template_characters_to_escape=/(\\${|`|\\\\)/g;function escape_template(str){return str.replace(regex_template_characters_to_escape,'\\\\$1');}function add_to_set(a,b){// @ts-ignore\nb.forEach(item=>{a.add(item);});}class Attribute extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.scope=scope;if(info.type==='Spread'){this.name=null;this.is_spread=true;this.is_true=false;this.expression=new Expression(component,this,scope,info.expression);this.dependencies=this.expression.dependencies;this.chunks=null;this.is_static=false;}else{this.name=info.name;this.is_true=info.value===true;this.is_static=true;this.dependencies=new Set();this.chunks=this.is_true?[]:info.value.map(node=>{if(node.type==='Text')return node;this.is_static=false;const expression=new Expression(component,this,scope,node.expression);add_to_set(this.dependencies,expression.dependencies);return expression;});}}get_dependencies(){if(this.is_spread)return this.expression.dynamic_dependencies();const dependencies=new Set();this.chunks.forEach(chunk=>{if(chunk.type==='Expression'){add_to_set(dependencies,chunk.dynamic_dependencies());}});return Array.from(dependencies);}get_value(block){if(this.is_true)return x`true`;if(this.chunks.length===0)return x`\"\"`;if(this.chunks.length===1){return this.chunks[0].type==='Text'?string_literal(this.chunks[0].data):this.chunks[0].manipulate(block);}let expression=this.chunks.map(chunk=>chunk.type==='Text'?string_literal(chunk.data):chunk.manipulate(block)).reduce((lhs,rhs)=>x`${lhs} + ${rhs}`);if(this.chunks[0].type!=='Text'){expression=x`\"\" + ${expression}`;}return expression;}get_static_value(){if(!this.is_static)return null;return this.is_true?true:this.chunks[0]// method should be called only when `is_static = true`\n?this.chunks[0].data:'';}should_cache(){return this.is_static?false:this.chunks.length===1// @ts-ignore todo: probably error\n?this.chunks[0].node.type!=='Identifier'||this.scope.names.has(this.chunks[0].node.name):true;}}// TODO this should live in a specific binding\nconst read_only_media_attributes=new Set(['duration','buffered','seekable','played','seeking','ended','videoHeight','videoWidth']);class Binding extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);if(info.expression.type!=='Identifier'&&info.expression.type!=='MemberExpression'){component.error(info,compiler_errors.invalid_directive_value);return;}this.name=info.name;this.expression=new Expression(component,this,scope,info.expression);this.raw_expression=clone(info.expression);const{name}=get_object(this.expression.node);this.is_contextual=Array.from(this.expression.references).some(name=>scope.names.has(name));if(this.is_contextual)this.validate_binding_rest_properties(scope);// make sure we track this as a mutable ref\nif(scope.is_let(name)){component.error(this,compiler_errors.invalid_binding_let);return;}else if(scope.names.has(name)){if(scope.is_await(name)){component.error(this,compiler_errors.invalid_binding_await);return;}if(scope.is_const(name)){component.error(this,compiler_errors.invalid_binding_const);}scope.dependencies_for_name.get(name).forEach(name=>{const variable=component.var_lookup.get(name);if(variable){variable.mutated=true;}});}else{const variable=component.var_lookup.get(name);if(!variable||variable.global){component.error(this.expression.node,compiler_errors.binding_undeclared(name));return;}variable[this.expression.node.type==='MemberExpression'?'mutated':'reassigned']=true;if(info.expression.type==='Identifier'&&!variable.writable){component.error(this.expression.node,compiler_errors.invalid_binding_writibale);return;}}const type=parent.get_static_attribute_value('type');this.is_readonly=regex_dimensions.test(this.name)||isElement(parent)&&(parent.is_media_node()&&read_only_media_attributes.has(this.name)||parent.name==='input'&&type==='file')/* TODO others? */;}is_readonly_media_attribute(){return read_only_media_attributes.has(this.name);}validate_binding_rest_properties(scope){this.expression.references.forEach(name=>{const each_block=scope.get_owner(name);if(each_block&&each_block.type==='EachBlock'){const rest_node=each_block.context_rest_properties.get(name);if(rest_node){this.component.warn(rest_node,compiler_warnings.invalid_rest_eachblock_binding(name));}}});}}function isElement(node){return!!node.is_media_node;}class Transition extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);component.warn_if_undefined(info.name,info,scope);this.name=info.name;component.add_reference(this,info.name.split('.')[0]);this.directive=info.intro&&info.outro?'transition':info.intro?'in':'out';this.is_local=info.modifiers.includes('local');if(info.intro&&parent.intro||info.outro&&parent.outro){const parent_transition=parent.intro||parent.outro;component.error(info,compiler_errors.duplicate_transition(this.directive,parent_transition.directive));return;}this.expression=info.expression?new Expression(component,this,scope,info.expression):null;}}class Animation extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);component.warn_if_undefined(info.name,info,scope);this.name=info.name;component.add_reference(this,info.name.split('.')[0]);if(parent.animation){component.error(this,compiler_errors.duplicate_animation);return;}const block=parent.parent;if(!block||block.type!=='EachBlock'){// TODO can we relax the 'immediate child' rule?\ncomponent.error(this,compiler_errors.invalid_animation_immediate);return;}if(!block.key){component.error(this,compiler_errors.invalid_animation_key);return;}block.has_animation=true;this.expression=info.expression?new Expression(component,this,scope,info.expression,true):null;}}class Class extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.name=info.name;this.expression=info.expression?new Expression(component,this,scope,info.expression):null;}}/**\n * Transforms a list of Text and MustacheTags into a TemplateLiteral expression.\n * Start/End positions on the elements of the expression are not set.\n */function nodes_to_template_literal(value){const literal={type:'TemplateLiteral',expressions:[],quasis:[]};let quasi={type:'TemplateElement',value:{raw:'',cooked:null},tail:false};value.forEach(node=>{if(node.type==='Text'){quasi.value.raw+=node.raw;}else if(node.type==='MustacheTag'){literal.quasis.push(quasi);literal.expressions.push(node.expression);quasi={type:'TemplateElement',value:{raw:'',cooked:null},tail:false};}});quasi.tail=true;literal.quasis.push(quasi);return literal;}const valid_modifiers=new Set(['important']);class StyleDirective extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.name=info.name;this.modifiers=new Set(info.modifiers);for(const modifier of this.modifiers){if(!valid_modifiers.has(modifier)){component.error(this,compiler_errors.invalid_style_directive_modifier(list$1([...valid_modifiers])));}}// Convert the value array to an expression so it's easier to handle\n// the StyleDirective going forward.\nif(info.value===true||info.value.length===1&&info.value[0].type==='MustacheTag'){const identifier=info.value===true?{type:'Identifier',start:info.end-info.name.length,end:info.end,name:info.name}:info.value[0].expression;this.expression=new Expression(component,this,scope,identifier);this.should_cache=false;}else{const raw_expression=nodes_to_template_literal(info.value);this.expression=new Expression(component,this,scope,raw_expression);this.should_cache=raw_expression.expressions.length>0;}}get important(){return this.modifiers.has('important');}}// Whitespace inside one of these elements will not result in\n// a whitespace node being created in any circumstances. (This\n// list is almost certainly very incomplete)\nconst elements_without_text=new Set(['audio','datalist','dl','optgroup','select','video']);const regex_ends_with_svg=/svg$/;class Text extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.data=info.data;this.synthetic=info.synthetic||false;}should_skip(){if(regex_non_whitespace_character.test(this.data))return false;const parent_element=this.find_nearest(/(?:Element|InlineComponent|SlotTemplate|Head)/);if(!parent_element)return false;if(parent_element.type==='Head')return true;if(parent_element.type==='InlineComponent')return parent_element.children.length===1&&this===parent_element.children[0];// svg namespace exclusions\nif(regex_ends_with_svg.test(parent_element.namespace)){if(this.prev&&this.prev.type==='Element'&&this.prev.name==='tspan')return false;}return parent_element.namespace||elements_without_text.has(parent_element.name);}keep_space(){if(this.component.component_options.preserveWhitespace)return true;return this.within_pre();}within_pre(){let node=this.parent;while(node){if(node.type==='Element'&&node.name==='pre'){return true;}node=node.parent;}return false;}}// The `foreign` namespace covers all DOM implementations that aren't HTML5.\n// It opts out of HTML5-specific a11y checks and case-insensitive attribute names.\nconst foreign='https://svelte.dev/docs#template-syntax-svelte-options';const html='http://www.w3.org/1999/xhtml';const mathml='http://www.w3.org/1998/Math/MathML';const svg$1='http://www.w3.org/2000/svg';const xlink='http://www.w3.org/1999/xlink';const xml='http://www.w3.org/XML/1998/namespace';const xmlns='http://www.w3.org/2000/xmlns';const valid_namespaces=['foreign','html','mathml','svg','xlink','xml','xmlns',foreign,html,mathml,svg$1,xlink,xml,xmlns];const namespaces={foreign,html,mathml,svg:svg$1,xlink,xml,xmlns};const applicable=new Set(['Identifier','ObjectExpression','ArrayExpression','Property']);class Let extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.names=[];this.name={type:'Identifier',name:info.name};const{names}=this;if(info.expression){this.value=info.expression;walk(info.expression,{enter(node){if(!applicable.has(node.type)){return component.error(node,compiler_errors.invalid_let);}if(node.type==='Identifier'){names.push(node.name);}// slightly unfortunate hack\nif(node.type==='ArrayExpression'){node.type='ArrayPattern';}if(node.type==='ObjectExpression'){node.type='ObjectPattern';}}});}else{names.push(this.name.name);}}}function unwrapExports(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,'default')?x['default']:x;}function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports;}var ariaPropsMap_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==\"undefined\"&&arr[Symbol.iterator]||arr[\"@@iterator\"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i[\"return\"]!=null)_i[\"return\"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}var properties=[['aria-activedescendant',{'type':'id'}],['aria-atomic',{'type':'boolean'}],['aria-autocomplete',{'type':'token','values':['inline','list','both','none']}],['aria-busy',{'type':'boolean'}],['aria-checked',{'type':'tristate'}],['aria-colcount',{type:'integer'}],['aria-colindex',{type:'integer'}],['aria-colspan',{type:'integer'}],['aria-controls',{'type':'idlist'}],['aria-current',{type:'token',values:['page','step','location','date','time',true,false]}],['aria-describedby',{'type':'idlist'}],['aria-details',{'type':'id'}],['aria-disabled',{'type':'boolean'}],['aria-dropeffect',{'type':'tokenlist','values':['copy','execute','link','move','none','popup']}],['aria-errormessage',{'type':'id'}],['aria-expanded',{'type':'boolean','allowundefined':true}],['aria-flowto',{'type':'idlist'}],['aria-grabbed',{'type':'boolean','allowundefined':true}],['aria-haspopup',{'type':'token','values':[false,true,'menu','listbox','tree','grid','dialog']}],['aria-hidden',{'type':'boolean','allowundefined':true}],['aria-invalid',{'type':'token','values':['grammar',false,'spelling',true]}],['aria-keyshortcuts',{type:'string'}],['aria-label',{'type':'string'}],['aria-labelledby',{'type':'idlist'}],['aria-level',{'type':'integer'}],['aria-live',{'type':'token','values':['assertive','off','polite']}],['aria-modal',{type:'boolean'}],['aria-multiline',{'type':'boolean'}],['aria-multiselectable',{'type':'boolean'}],['aria-orientation',{'type':'token','values':['vertical','undefined','horizontal']}],['aria-owns',{'type':'idlist'}],['aria-placeholder',{type:'string'}],['aria-posinset',{'type':'integer'}],['aria-pressed',{'type':'tristate'}],['aria-readonly',{'type':'boolean'}],['aria-relevant',{'type':'tokenlist','values':['additions','all','removals','text']}],['aria-required',{'type':'boolean'}],['aria-roledescription',{type:'string'}],['aria-rowcount',{type:'integer'}],['aria-rowindex',{type:'integer'}],['aria-rowspan',{type:'integer'}],['aria-selected',{'type':'boolean','allowundefined':true}],['aria-setsize',{'type':'integer'}],['aria-sort',{'type':'token','values':['ascending','descending','none','other']}],['aria-valuemax',{'type':'number'}],['aria-valuemin',{'type':'number'}],['aria-valuenow',{'type':'number'}],['aria-valuetext',{'type':'string'}]];var ariaPropsMap={entries:function entries(){return properties;},get:function get(key){var item=properties.find(function(tuple){return tuple[0]===key?true:false;});return item&&item[1];},has:function has(key){return!!this.get(key);},keys:function keys(){return properties.map(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];return key;});},values:function values(){return properties.map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),values=_ref4[1];return values;});}};var _default=ariaPropsMap;exports.default=_default;});unwrapExports(ariaPropsMap_1);var domMap_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==\"undefined\"&&arr[Symbol.iterator]||arr[\"@@iterator\"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i[\"return\"]!=null)_i[\"return\"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}var dom=[['a',{reserved:false}],['abbr',{reserved:false}],['acronym',{reserved:false}],['address',{reserved:false}],['applet',{reserved:false}],['area',{reserved:false}],['article',{reserved:false}],['aside',{reserved:false}],['audio',{reserved:false}],['b',{reserved:false}],['base',{reserved:true}],['bdi',{reserved:false}],['bdo',{reserved:false}],['big',{reserved:false}],['blink',{reserved:false}],['blockquote',{reserved:false}],['body',{reserved:false}],['br',{reserved:false}],['button',{reserved:false}],['canvas',{reserved:false}],['caption',{reserved:false}],['center',{reserved:false}],['cite',{reserved:false}],['code',{reserved:false}],['col',{reserved:true}],['colgroup',{reserved:true}],['content',{reserved:false}],['data',{reserved:false}],['datalist',{reserved:false}],['dd',{reserved:false}],['del',{reserved:false}],['details',{reserved:false}],['dfn',{reserved:false}],['dialog',{reserved:false}],['dir',{reserved:false}],['div',{reserved:false}],['dl',{reserved:false}],['dt',{reserved:false}],['em',{reserved:false}],['embed',{reserved:false}],['fieldset',{reserved:false}],['figcaption',{reserved:false}],['figure',{reserved:false}],['font',{reserved:false}],['footer',{reserved:false}],['form',{reserved:false}],['frame',{reserved:false}],['frameset',{reserved:false}],['h1',{reserved:false}],['h2',{reserved:false}],['h3',{reserved:false}],['h4',{reserved:false}],['h5',{reserved:false}],['h6',{reserved:false}],['head',{reserved:true}],['header',{reserved:false}],['hgroup',{reserved:false}],['hr',{reserved:false}],['html',{reserved:true}],['i',{reserved:false}],['iframe',{reserved:false}],['img',{reserved:false}],['input',{reserved:false}],['ins',{reserved:false}],['kbd',{reserved:false}],['keygen',{reserved:false}],['label',{reserved:false}],['legend',{reserved:false}],['li',{reserved:false}],['link',{reserved:true}],['main',{reserved:false}],['map',{reserved:false}],['mark',{reserved:false}],['marquee',{reserved:false}],['menu',{reserved:false}],['menuitem',{reserved:false}],['meta',{reserved:true}],['meter',{reserved:false}],['nav',{reserved:false}],['noembed',{reserved:true}],['noscript',{reserved:true}],['object',{reserved:false}],['ol',{reserved:false}],['optgroup',{reserved:false}],['option',{reserved:false}],['output',{reserved:false}],['p',{reserved:false}],['param',{reserved:true}],['picture',{reserved:true}],['pre',{reserved:false}],['progress',{reserved:false}],['q',{reserved:false}],['rp',{reserved:false}],['rt',{reserved:false}],['rtc',{reserved:false}],['ruby',{reserved:false}],['s',{reserved:false}],['samp',{reserved:false}],['script',{reserved:true}],['section',{reserved:false}],['select',{reserved:false}],['small',{reserved:false}],['source',{reserved:true}],['spacer',{reserved:false}],['span',{reserved:false}],['strike',{reserved:false}],['strong',{reserved:false}],['style',{reserved:true}],['sub',{reserved:false}],['summary',{reserved:false}],['sup',{reserved:false}],['table',{reserved:false}],['tbody',{reserved:false}],['td',{reserved:false}],['textarea',{reserved:false}],['tfoot',{reserved:false}],['th',{reserved:false}],['thead',{reserved:false}],['time',{reserved:false}],['title',{reserved:true}],['tr',{reserved:false}],['track',{reserved:true}],['tt',{reserved:false}],['u',{reserved:false}],['ul',{reserved:false}],['var',{reserved:false}],['video',{reserved:false}],['wbr',{reserved:false}],['xmp',{reserved:false}]];var domMap={entries:function entries(){return dom;},get:function get(key){var item=dom.find(function(tuple){return tuple[0]===key?true:false;});return item&&item[1];},has:function has(key){return!!this.get(key);},keys:function keys(){return dom.map(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];return key;});},values:function values(){return dom.map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),values=_ref4[1];return values;});}};var _default=domMap;exports.default=_default;});unwrapExports(domMap_1);var commandRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var commandRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'menuitem'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget']]};var _default=commandRole;exports.default=_default;});unwrapExports(commandRole_1);var compositeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var compositeRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-activedescendant':null,'aria-disabled':null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget']]};var _default=compositeRole;exports.default=_default;});unwrapExports(compositeRole_1);var inputRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var inputRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null},relatedConcepts:[{concept:{name:'input'},module:'XForms'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget']]};var _default=inputRole;exports.default=_default;});unwrapExports(inputRole_1);var landmarkRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var landmarkRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=landmarkRole;exports.default=_default;});unwrapExports(landmarkRole_1);var rangeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var rangeRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-valuemax':null,'aria-valuemin':null,'aria-valuenow':null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure']]};var _default=rangeRole;exports.default=_default;});unwrapExports(rangeRole_1);var roletypeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var roletypeRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:[],prohibitedProps:[],props:{'aria-atomic':null,'aria-busy':null,'aria-controls':null,'aria-current':null,'aria-describedby':null,'aria-details':null,'aria-dropeffect':null,'aria-flowto':null,'aria-grabbed':null,'aria-hidden':null,'aria-keyshortcuts':null,'aria-label':null,'aria-labelledby':null,'aria-live':null,'aria-owns':null,'aria-relevant':null,'aria-roledescription':null},relatedConcepts:[{concept:{name:'rel'},module:'HTML'},{concept:{name:'role'},module:'XHTML'},{concept:{name:'type'},module:'Dublin Core'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]};var _default=roletypeRole;exports.default=_default;});unwrapExports(roletypeRole_1);var sectionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var sectionRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'frontmatter'},module:'DTB'},{concept:{name:'level'},module:'DTB'},{concept:{name:'level'},module:'SMIL'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure']]};var _default=sectionRole;exports.default=_default;});unwrapExports(sectionRole_1);var sectionheadRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var sectionheadRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure']]};var _default=sectionheadRole;exports.default=_default;});unwrapExports(sectionheadRole_1);var selectRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var selectRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-orientation':null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','composite'],['roletype','structure','section','group']]};var _default=selectRole;exports.default=_default;});unwrapExports(selectRole_1);var structureRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var structureRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype']]};var _default=structureRole;exports.default=_default;});unwrapExports(structureRole_1);var widgetRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var widgetRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype']]};var _default=widgetRole;exports.default=_default;});unwrapExports(widgetRole_1);var windowRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var windowRole={abstract:true,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-modal':null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype']]};var _default=windowRole;exports.default=_default;});unwrapExports(windowRole_1);var ariaAbstractRoles_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _commandRole=_interopRequireDefault(commandRole_1);var _compositeRole=_interopRequireDefault(compositeRole_1);var _inputRole=_interopRequireDefault(inputRole_1);var _landmarkRole=_interopRequireDefault(landmarkRole_1);var _rangeRole=_interopRequireDefault(rangeRole_1);var _roletypeRole=_interopRequireDefault(roletypeRole_1);var _sectionRole=_interopRequireDefault(sectionRole_1);var _sectionheadRole=_interopRequireDefault(sectionheadRole_1);var _selectRole=_interopRequireDefault(selectRole_1);var _structureRole=_interopRequireDefault(structureRole_1);var _widgetRole=_interopRequireDefault(widgetRole_1);var _windowRole=_interopRequireDefault(windowRole_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var ariaAbstractRoles=[['command',_commandRole.default],['composite',_compositeRole.default],['input',_inputRole.default],['landmark',_landmarkRole.default],['range',_rangeRole.default],['roletype',_roletypeRole.default],['section',_sectionRole.default],['sectionhead',_sectionheadRole.default],['select',_selectRole.default],['structure',_structureRole.default],['widget',_widgetRole.default],['window',_windowRole.default]];var _default=ariaAbstractRoles;exports.default=_default;});unwrapExports(ariaAbstractRoles_1);var alertRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var alertRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-atomic':'true','aria-live':'assertive'},relatedConcepts:[{concept:{name:'alert'},module:'XForms'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=alertRole;exports.default=_default;});unwrapExports(alertRole_1);var alertdialogRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var alertdialogRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'alert'},module:'XForms'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','alert'],['roletype','window','dialog']]};var _default=alertdialogRole;exports.default=_default;});unwrapExports(alertdialogRole_1);var applicationRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var applicationRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-activedescendant':null,'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'Device Independence Delivery Unit'}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure']]};var _default=applicationRole;exports.default=_default;});unwrapExports(applicationRole_1);var articleRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var articleRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-posinset':null,'aria-setsize':null},relatedConcepts:[{concept:{name:'article'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','document']]};var _default=articleRole;exports.default=_default;});unwrapExports(articleRole_1);var bannerRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var bannerRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:['direct descendant of document'],name:'header'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=bannerRole;exports.default=_default;});unwrapExports(bannerRole_1);var blockquoteRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var blockquoteRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=blockquoteRole;exports.default=_default;});unwrapExports(blockquoteRole_1);var buttonRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var buttonRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-disabled':null,'aria-expanded':null,'aria-haspopup':null,'aria-pressed':null},relatedConcepts:[{concept:{attributes:[{constraints:['set'],name:'aria-pressed'},{name:'type',value:'checkbox'}],name:'input'},module:'HTML'},{concept:{attributes:[{name:'aria-expanded',value:'false'}],name:'summary'},module:'HTML'},{concept:{attributes:[{name:'aria-expanded',value:'true'}],constraints:['direct descendant of details element with the open attribute defined'],name:'summary'},module:'HTML'},{concept:{attributes:[{name:'type',value:'button'}],name:'input'},module:'HTML'},{concept:{attributes:[{name:'type',value:'image'}],name:'input'},module:'HTML'},{concept:{attributes:[{name:'type',value:'reset'}],name:'input'},module:'HTML'},{concept:{attributes:[{name:'type',value:'submit'}],name:'input'},module:'HTML'},{concept:{name:'button'},module:'HTML'},{concept:{name:'trigger'},module:'XForms'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','command']]};var _default=buttonRole;exports.default=_default;});unwrapExports(buttonRole_1);var captionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var captionRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:['figure','grid','table'],requiredContextRole:['figure','grid','table'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=captionRole;exports.default=_default;});unwrapExports(captionRole_1);var cellRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var cellRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-colindex':null,'aria-colspan':null,'aria-rowindex':null,'aria-rowspan':null},relatedConcepts:[{concept:{constraints:['descendant of table'],name:'td'},module:'HTML'}],requireContextRole:['row'],requiredContextRole:['row'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=cellRole;exports.default=_default;});unwrapExports(cellRole_1);var checkboxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var checkboxRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-checked':null,'aria-errormessage':null,'aria-expanded':null,'aria-invalid':null,'aria-readonly':null,'aria-required':null},relatedConcepts:[{concept:{attributes:[{name:'type',value:'checkbox'}],name:'input'},module:'HTML'},{concept:{name:'option'},module:'ARIA'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{'aria-checked':null},superClass:[['roletype','widget','input']]};var _default=checkboxRole;exports.default=_default;});unwrapExports(checkboxRole_1);var codeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var codeRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=codeRole;exports.default=_default;});unwrapExports(codeRole_1);var columnheaderRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var columnheaderRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-sort':null},relatedConcepts:[{attributes:[{name:'scope',value:'col'}],concept:{name:'th'},module:'HTML'}],requireContextRole:['row'],requiredContextRole:['row'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','cell'],['roletype','structure','section','cell','gridcell'],['roletype','widget','gridcell'],['roletype','structure','sectionhead']]};var _default=columnheaderRole;exports.default=_default;});unwrapExports(columnheaderRole_1);var comboboxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var comboboxRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-activedescendant':null,'aria-autocomplete':null,'aria-errormessage':null,'aria-invalid':null,'aria-readonly':null,'aria-required':null,'aria-expanded':'false','aria-haspopup':'listbox'},relatedConcepts:[{concept:{attributes:[{constraints:['set'],name:'list'},{name:'type',value:'email'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['set'],name:'list'},{name:'type',value:'search'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['set'],name:'list'},{name:'type',value:'tel'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['set'],name:'list'},{name:'type',value:'text'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['set'],name:'list'},{name:'type',value:'url'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['set'],name:'list'},{name:'type',value:'url'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['undefined'],name:'multiple'},{constraints:['undefined'],name:'size'}],name:'select'},module:'HTML'},{concept:{attributes:[{constraints:['undefined'],name:'multiple'},{name:'size',value:1}],name:'select'},module:'HTML'},{concept:{name:'select'},module:'XForms'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{'aria-controls':null,'aria-expanded':'false'},superClass:[['roletype','widget','input']]};var _default=comboboxRole;exports.default=_default;});unwrapExports(comboboxRole_1);var complementaryRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var complementaryRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'aside'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=complementaryRole;exports.default=_default;});unwrapExports(complementaryRole_1);var contentinfoRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var contentinfoRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:['direct descendant of document'],name:'footer'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=contentinfoRole;exports.default=_default;});unwrapExports(contentinfoRole_1);var definitionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var definitionRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'dd'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=definitionRole;exports.default=_default;});unwrapExports(definitionRole_1);var deletionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var deletionRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=deletionRole;exports.default=_default;});unwrapExports(deletionRole_1);var dialogRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var dialogRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'dialog'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','window']]};var _default=dialogRole;exports.default=_default;});unwrapExports(dialogRole_1);var directoryRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var directoryRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{module:'DAISY Guide'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','list']]};var _default=directoryRole;exports.default=_default;});unwrapExports(directoryRole_1);var documentRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var documentRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'Device Independence Delivery Unit'}},{concept:{name:'body'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure']]};var _default=documentRole;exports.default=_default;});unwrapExports(documentRole_1);var emphasisRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var emphasisRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=emphasisRole;exports.default=_default;});unwrapExports(emphasisRole_1);var feedRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var feedRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['article']],requiredProps:{},superClass:[['roletype','structure','section','list']]};var _default=feedRole;exports.default=_default;});unwrapExports(feedRole_1);var figureRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var figureRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'figure'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=figureRole;exports.default=_default;});unwrapExports(figureRole_1);var formRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var formRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:['set'],name:'aria-label'}],name:'form'},module:'HTML'},{concept:{attributes:[{constraints:['set'],name:'aria-labelledby'}],name:'form'},module:'HTML'},{concept:{attributes:[{constraints:['set'],name:'name'}],name:'form'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=formRole;exports.default=_default;});unwrapExports(formRole_1);var genericRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var genericRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[{concept:{name:'span'},module:'HTML'},{concept:{name:'div'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure']]};var _default=genericRole;exports.default=_default;});unwrapExports(genericRole_1);var gridRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var gridRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-multiselectable':null,'aria-readonly':null},relatedConcepts:[{concept:{attributes:[{name:'role',value:'grid'}],name:'table'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['row'],['row','rowgroup']],requiredProps:{},superClass:[['roletype','widget','composite'],['roletype','structure','section','table']]};var _default=gridRole;exports.default=_default;});unwrapExports(gridRole_1);var gridcellRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var gridcellRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null,'aria-readonly':null,'aria-required':null,'aria-selected':null},relatedConcepts:[{concept:{attributes:[{name:'role',value:'gridcell'}],name:'td'},module:'HTML'}],requireContextRole:['row'],requiredContextRole:['row'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','cell'],['roletype','widget']]};var _default=gridcellRole;exports.default=_default;});unwrapExports(gridcellRole_1);var groupRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var groupRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-activedescendant':null,'aria-disabled':null},relatedConcepts:[{concept:{name:'details'},module:'HTML'},{concept:{name:'fieldset'},module:'HTML'},{concept:{name:'optgroup'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=groupRole;exports.default=_default;});unwrapExports(groupRole_1);var headingRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var headingRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-level':'2'},relatedConcepts:[{concept:{name:'h1'},module:'HTML'},{concept:{name:'h2'},module:'HTML'},{concept:{name:'h3'},module:'HTML'},{concept:{name:'h4'},module:'HTML'},{concept:{name:'h5'},module:'HTML'},{concept:{name:'h6'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{'aria-level':'2'},superClass:[['roletype','structure','sectionhead']]};var _default=headingRole;exports.default=_default;});unwrapExports(headingRole_1);var imgRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var imgRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:['set'],name:'alt'}],name:'img'},module:'HTML'},{concept:{attributes:[{constraints:['undefined'],name:'alt'}],name:'img'},module:'HTML'},{concept:{name:'imggroup'},module:'DTB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=imgRole;exports.default=_default;});unwrapExports(imgRole_1);var insertionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var insertionRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=insertionRole;exports.default=_default;});unwrapExports(insertionRole_1);var linkRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var linkRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-disabled':null,'aria-expanded':null,'aria-haspopup':null},relatedConcepts:[{concept:{attributes:[{name:'href'}],name:'a'},module:'HTML'},{concept:{attributes:[{name:'href'}],name:'area'},module:'HTML'},{concept:{attributes:[{name:'href'}],name:'link'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','command']]};var _default=linkRole;exports.default=_default;});unwrapExports(linkRole_1);var listRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var listRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'menu'},module:'HTML'},{concept:{name:'ol'},module:'HTML'},{concept:{name:'ul'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['listitem']],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=listRole;exports.default=_default;});unwrapExports(listRole_1);var listboxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var listboxRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-expanded':null,'aria-invalid':null,'aria-multiselectable':null,'aria-readonly':null,'aria-required':null,'aria-orientation':'vertical'},relatedConcepts:[{concept:{attributes:[{constraints:['>1'],name:'size'},{name:'multiple'}],name:'select'},module:'HTML'},{concept:{attributes:[{constraints:['>1'],name:'size'}],name:'select'},module:'HTML'},{concept:{attributes:[{name:'multiple'}],name:'select'},module:'HTML'},{concept:{name:'datalist'},module:'HTML'},{concept:{name:'list'},module:'ARIA'},{concept:{name:'select'},module:'XForms'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['option','group'],['option']],requiredProps:{},superClass:[['roletype','widget','composite','select'],['roletype','structure','section','group','select']]};var _default=listboxRole;exports.default=_default;});unwrapExports(listboxRole_1);var listitemRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var listitemRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-level':null,'aria-posinset':null,'aria-setsize':null},relatedConcepts:[{concept:{constraints:['direct descendant of ol, ul or menu'],name:'li'},module:'HTML'},{concept:{name:'item'},module:'XForms'}],requireContextRole:['directory','list'],requiredContextRole:['directory','list'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=listitemRole;exports.default=_default;});unwrapExports(listitemRole_1);var logRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var logRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-live':'polite'},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=logRole;exports.default=_default;});unwrapExports(logRole_1);var mainRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var mainRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'main'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=mainRole;exports.default=_default;});unwrapExports(mainRole_1);var marqueeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var marqueeRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=marqueeRole;exports.default=_default;});unwrapExports(marqueeRole_1);var mathRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var mathRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'math'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=mathRole;exports.default=_default;});unwrapExports(mathRole_1);var menuRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var menuRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-orientation':'vertical'},relatedConcepts:[{concept:{name:'MENU'},module:'JAPI'},{concept:{name:'list'},module:'ARIA'},{concept:{name:'select'},module:'XForms'},{concept:{name:'sidebar'},module:'DTB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['menuitem','group'],['menuitemradio','group'],['menuitemcheckbox','group'],['menuitem'],['menuitemcheckbox'],['menuitemradio']],requiredProps:{},superClass:[['roletype','widget','composite','select'],['roletype','structure','section','group','select']]};var _default=menuRole;exports.default=_default;});unwrapExports(menuRole_1);var menubarRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var menubarRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-orientation':'horizontal'},relatedConcepts:[{concept:{name:'toolbar'},module:'ARIA'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['menuitem','group'],['menuitemradio','group'],['menuitemcheckbox','group'],['menuitem'],['menuitemcheckbox'],['menuitemradio']],requiredProps:{},superClass:[['roletype','widget','composite','select','menu'],['roletype','structure','section','group','select','menu']]};var _default=menubarRole;exports.default=_default;});unwrapExports(menubarRole_1);var menuitemRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var menuitemRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-disabled':null,'aria-expanded':null,'aria-haspopup':null,'aria-posinset':null,'aria-setsize':null},relatedConcepts:[{concept:{name:'MENU_ITEM'},module:'JAPI'},{concept:{name:'listitem'},module:'ARIA'},{concept:{name:'menuitem'},module:'HTML'},{concept:{name:'option'},module:'ARIA'}],requireContextRole:['group','menu','menubar'],requiredContextRole:['group','menu','menubar'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','command']]};var _default=menuitemRole;exports.default=_default;});unwrapExports(menuitemRole_1);var menuitemcheckboxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var menuitemcheckboxRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author','contents'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'menuitem'},module:'ARIA'}],requireContextRole:['group','menu','menubar'],requiredContextRole:['group','menu','menubar'],requiredOwnedElements:[],requiredProps:{'aria-checked':null},superClass:[['roletype','widget','input','checkbox'],['roletype','widget','command','menuitem']]};var _default=menuitemcheckboxRole;exports.default=_default;});unwrapExports(menuitemcheckboxRole_1);var menuitemradioRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var menuitemradioRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author','contents'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'menuitem'},module:'ARIA'}],requireContextRole:['group','menu','menubar'],requiredContextRole:['group','menu','menubar'],requiredOwnedElements:[],requiredProps:{'aria-checked':null},superClass:[['roletype','widget','input','checkbox','menuitemcheckbox'],['roletype','widget','command','menuitem','menuitemcheckbox'],['roletype','widget','input','radio']]};var _default=menuitemradioRole;exports.default=_default;});unwrapExports(menuitemradioRole_1);var meterRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var meterRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author'],prohibitedProps:[],props:{'aria-valuetext':null,'aria-valuemax':'100','aria-valuemin':'0'},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{'aria-valuenow':null},superClass:[['roletype','structure','range']]};var _default=meterRole;exports.default=_default;});unwrapExports(meterRole_1);var navigationRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var navigationRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'nav'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=navigationRole;exports.default=_default;});unwrapExports(navigationRole_1);var noneRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var noneRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]};var _default=noneRole;exports.default=_default;});unwrapExports(noneRole_1);var noteRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var noteRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=noteRole;exports.default=_default;});unwrapExports(noteRole_1);var optionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var optionRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-checked':null,'aria-posinset':null,'aria-setsize':null,'aria-selected':'false'},relatedConcepts:[{concept:{name:'item'},module:'XForms'},{concept:{name:'listitem'},module:'ARIA'},{concept:{name:'option'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{'aria-selected':'false'},superClass:[['roletype','widget','input']]};var _default=optionRole;exports.default=_default;});unwrapExports(optionRole_1);var paragraphRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var paragraphRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=paragraphRole;exports.default=_default;});unwrapExports(paragraphRole_1);var presentationRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var presentationRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure']]};var _default=presentationRole;exports.default=_default;});unwrapExports(presentationRole_1);var progressbarRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var progressbarRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author'],prohibitedProps:[],props:{'aria-valuetext':null},relatedConcepts:[{concept:{name:'progress'},module:'HTML'},{concept:{name:'status'},module:'ARIA'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','range'],['roletype','widget']]};var _default=progressbarRole;exports.default=_default;});unwrapExports(progressbarRole_1);var radioRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var radioRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-checked':null,'aria-posinset':null,'aria-setsize':null},relatedConcepts:[{concept:{attributes:[{name:'type',value:'radio'}],name:'input'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{'aria-checked':null},superClass:[['roletype','widget','input']]};var _default=radioRole;exports.default=_default;});unwrapExports(radioRole_1);var radiogroupRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var radiogroupRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-invalid':null,'aria-readonly':null,'aria-required':null},relatedConcepts:[{concept:{name:'list'},module:'ARIA'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['radio']],requiredProps:{},superClass:[['roletype','widget','composite','select'],['roletype','structure','section','group','select']]};var _default=radiogroupRole;exports.default=_default;});unwrapExports(radiogroupRole_1);var regionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var regionRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:['set'],name:'aria-label'}],name:'section'},module:'HTML'},{concept:{attributes:[{constraints:['set'],name:'aria-labelledby'}],name:'section'},module:'HTML'},{concept:{name:'Device Independence Glossart perceivable unit'}},{concept:{name:'frame'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=regionRole;exports.default=_default;});unwrapExports(regionRole_1);var rowRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var rowRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-colindex':null,'aria-expanded':null,'aria-level':null,'aria-posinset':null,'aria-rowindex':null,'aria-selected':null,'aria-setsize':null},relatedConcepts:[{concept:{name:'tr'},module:'HTML'}],requireContextRole:['grid','rowgroup','table','treegrid'],requiredContextRole:['grid','rowgroup','table','treegrid'],requiredOwnedElements:[['cell'],['columnheader'],['gridcell'],['rowheader']],requiredProps:{},superClass:[['roletype','structure','section','group'],['roletype','widget']]};var _default=rowRole;exports.default=_default;});unwrapExports(rowRole_1);var rowgroupRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var rowgroupRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'tbody'},module:'HTML'},{concept:{name:'tfoot'},module:'HTML'},{concept:{name:'thead'},module:'HTML'}],requireContextRole:['grid','table','treegrid'],requiredContextRole:['grid','table','treegrid'],requiredOwnedElements:[['row']],requiredProps:{},superClass:[['roletype','structure']]};var _default=rowgroupRole;exports.default=_default;});unwrapExports(rowgroupRole_1);var rowheaderRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var rowheaderRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-sort':null},relatedConcepts:[{concept:{attributes:[{name:'scope',value:'row'}],name:'th'},module:'HTML'}],requireContextRole:['row'],requiredContextRole:['row'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','cell'],['roletype','structure','section','cell','gridcell'],['roletype','widget','gridcell'],['roletype','structure','sectionhead']]};var _default=rowheaderRole;exports.default=_default;});unwrapExports(rowheaderRole_1);var scrollbarRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var scrollbarRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:true,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-valuetext':null,'aria-orientation':'vertical','aria-valuemax':'100','aria-valuemin':'0'},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{'aria-controls':null,'aria-valuenow':null},superClass:[['roletype','structure','range'],['roletype','widget']]};var _default=scrollbarRole;exports.default=_default;});unwrapExports(scrollbarRole_1);var searchRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var searchRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=searchRole;exports.default=_default;});unwrapExports(searchRole_1);var searchboxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var searchboxRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:['undefined'],name:'list'},{name:'type',value:'search'}],name:'input'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','input','textbox']]};var _default=searchboxRole;exports.default=_default;});unwrapExports(searchboxRole_1);var separatorRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var separatorRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:true,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-orientation':'horizontal','aria-valuemax':'100','aria-valuemin':'0','aria-valuenow':null,'aria-valuetext':null},relatedConcepts:[{concept:{name:'hr'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure']]};var _default=separatorRole;exports.default=_default;});unwrapExports(separatorRole_1);var sliderRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var sliderRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-haspopup':null,'aria-invalid':null,'aria-readonly':null,'aria-valuetext':null,'aria-orientation':'horizontal','aria-valuemax':'100','aria-valuemin':'0'},relatedConcepts:[{concept:{attributes:[{name:'type',value:'range'}],name:'input'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{'aria-valuenow':null},superClass:[['roletype','widget','input'],['roletype','structure','range']]};var _default=sliderRole;exports.default=_default;});unwrapExports(sliderRole_1);var spinbuttonRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var spinbuttonRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-invalid':null,'aria-readonly':null,'aria-required':null,'aria-valuetext':null,'aria-valuenow':'0'},relatedConcepts:[{concept:{attributes:[{name:'type',value:'number'}],name:'input'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','composite'],['roletype','widget','input'],['roletype','structure','range']]};var _default=spinbuttonRole;exports.default=_default;});unwrapExports(spinbuttonRole_1);var statusRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var statusRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-atomic':'true','aria-live':'polite'},relatedConcepts:[{concept:{name:'output'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=statusRole;exports.default=_default;});unwrapExports(statusRole_1);var strongRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var strongRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=strongRole;exports.default=_default;});unwrapExports(strongRole_1);var subscriptRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var subscriptRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=subscriptRole;exports.default=_default;});unwrapExports(subscriptRole_1);var superscriptRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var superscriptRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['prohibited'],prohibitedProps:['aria-label','aria-labelledby'],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=superscriptRole;exports.default=_default;});unwrapExports(superscriptRole_1);var switchRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var switchRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author','contents'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'button'},module:'ARIA'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{'aria-checked':null},superClass:[['roletype','widget','input','checkbox']]};var _default=switchRole;exports.default=_default;});unwrapExports(switchRole_1);var tabRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var tabRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:true,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-disabled':null,'aria-expanded':null,'aria-haspopup':null,'aria-posinset':null,'aria-setsize':null,'aria-selected':'false'},relatedConcepts:[],requireContextRole:['tablist'],requiredContextRole:['tablist'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','sectionhead'],['roletype','widget']]};var _default=tabRole;exports.default=_default;});unwrapExports(tabRole_1);var tableRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var tableRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-colcount':null,'aria-rowcount':null},relatedConcepts:[{concept:{name:'table'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['row'],['row','rowgroup']],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=tableRole;exports.default=_default;});unwrapExports(tableRole_1);var tablistRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var tablistRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-level':null,'aria-multiselectable':null,'aria-orientation':'horizontal'},relatedConcepts:[{module:'DAISY',concept:{name:'guide'}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['tab']],requiredProps:{},superClass:[['roletype','widget','composite']]};var _default=tablistRole;exports.default=_default;});unwrapExports(tablistRole_1);var tabpanelRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var tabpanelRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=tabpanelRole;exports.default=_default;});unwrapExports(tabpanelRole_1);var termRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var termRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'dfn'},module:'HTML'},{concept:{name:'dt'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=termRole;exports.default=_default;});unwrapExports(termRole_1);var textboxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var textboxRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-activedescendant':null,'aria-autocomplete':null,'aria-errormessage':null,'aria-haspopup':null,'aria-invalid':null,'aria-multiline':null,'aria-placeholder':null,'aria-readonly':null,'aria-required':null},relatedConcepts:[{concept:{attributes:[{constraints:['undefined'],name:'type'},{constraints:['undefined'],name:'list'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['undefined'],name:'list'},{name:'type',value:'email'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['undefined'],name:'list'},{name:'type',value:'tel'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['undefined'],name:'list'},{name:'type',value:'text'}],name:'input'},module:'HTML'},{concept:{attributes:[{constraints:['undefined'],name:'list'},{name:'type',value:'url'}],name:'input'},module:'HTML'},{concept:{name:'input'},module:'XForms'},{concept:{name:'textarea'},module:'HTML'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','input']]};var _default=textboxRole;exports.default=_default;});unwrapExports(textboxRole_1);var timeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var timeRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=timeRole;exports.default=_default;});unwrapExports(timeRole_1);var timerRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var timerRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','status']]};var _default=timerRole;exports.default=_default;});unwrapExports(timerRole_1);var toolbarRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var toolbarRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-orientation':'horizontal'},relatedConcepts:[{concept:{name:'menubar'},module:'ARIA'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','group']]};var _default=toolbarRole;exports.default=_default;});unwrapExports(toolbarRole_1);var tooltipRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var tooltipRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=tooltipRole;exports.default=_default;});unwrapExports(tooltipRole_1);var treeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var treeRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-invalid':null,'aria-multiselectable':null,'aria-required':null,'aria-orientation':'vertical'},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['treeitem','group'],['treeitem']],requiredProps:{},superClass:[['roletype','widget','composite','select'],['roletype','structure','section','group','select']]};var _default=treeRole;exports.default=_default;});unwrapExports(treeRole_1);var treegridRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var treegridRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['row'],['row','rowgroup']],requiredProps:{},superClass:[['roletype','widget','composite','grid'],['roletype','structure','section','table','grid'],['roletype','widget','composite','select','tree'],['roletype','structure','section','group','select','tree']]};var _default=treegridRole;exports.default=_default;});unwrapExports(treegridRole_1);var treeitemRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var treeitemRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-expanded':null,'aria-haspopup':null},relatedConcepts:[],requireContextRole:['group','tree'],requiredContextRole:['group','tree'],requiredOwnedElements:[],requiredProps:{'aria-selected':null},superClass:[['roletype','structure','section','listitem'],['roletype','widget','input','option']]};var _default=treeitemRole;exports.default=_default;});unwrapExports(treeitemRole_1);var ariaLiteralRoles_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _alertRole=_interopRequireDefault(alertRole_1);var _alertdialogRole=_interopRequireDefault(alertdialogRole_1);var _applicationRole=_interopRequireDefault(applicationRole_1);var _articleRole=_interopRequireDefault(articleRole_1);var _bannerRole=_interopRequireDefault(bannerRole_1);var _blockquoteRole=_interopRequireDefault(blockquoteRole_1);var _buttonRole=_interopRequireDefault(buttonRole_1);var _captionRole=_interopRequireDefault(captionRole_1);var _cellRole=_interopRequireDefault(cellRole_1);var _checkboxRole=_interopRequireDefault(checkboxRole_1);var _codeRole=_interopRequireDefault(codeRole_1);var _columnheaderRole=_interopRequireDefault(columnheaderRole_1);var _comboboxRole=_interopRequireDefault(comboboxRole_1);var _complementaryRole=_interopRequireDefault(complementaryRole_1);var _contentinfoRole=_interopRequireDefault(contentinfoRole_1);var _definitionRole=_interopRequireDefault(definitionRole_1);var _deletionRole=_interopRequireDefault(deletionRole_1);var _dialogRole=_interopRequireDefault(dialogRole_1);var _directoryRole=_interopRequireDefault(directoryRole_1);var _documentRole=_interopRequireDefault(documentRole_1);var _emphasisRole=_interopRequireDefault(emphasisRole_1);var _feedRole=_interopRequireDefault(feedRole_1);var _figureRole=_interopRequireDefault(figureRole_1);var _formRole=_interopRequireDefault(formRole_1);var _genericRole=_interopRequireDefault(genericRole_1);var _gridRole=_interopRequireDefault(gridRole_1);var _gridcellRole=_interopRequireDefault(gridcellRole_1);var _groupRole=_interopRequireDefault(groupRole_1);var _headingRole=_interopRequireDefault(headingRole_1);var _imgRole=_interopRequireDefault(imgRole_1);var _insertionRole=_interopRequireDefault(insertionRole_1);var _linkRole=_interopRequireDefault(linkRole_1);var _listRole=_interopRequireDefault(listRole_1);var _listboxRole=_interopRequireDefault(listboxRole_1);var _listitemRole=_interopRequireDefault(listitemRole_1);var _logRole=_interopRequireDefault(logRole_1);var _mainRole=_interopRequireDefault(mainRole_1);var _marqueeRole=_interopRequireDefault(marqueeRole_1);var _mathRole=_interopRequireDefault(mathRole_1);var _menuRole=_interopRequireDefault(menuRole_1);var _menubarRole=_interopRequireDefault(menubarRole_1);var _menuitemRole=_interopRequireDefault(menuitemRole_1);var _menuitemcheckboxRole=_interopRequireDefault(menuitemcheckboxRole_1);var _menuitemradioRole=_interopRequireDefault(menuitemradioRole_1);var _meterRole=_interopRequireDefault(meterRole_1);var _navigationRole=_interopRequireDefault(navigationRole_1);var _noneRole=_interopRequireDefault(noneRole_1);var _noteRole=_interopRequireDefault(noteRole_1);var _optionRole=_interopRequireDefault(optionRole_1);var _paragraphRole=_interopRequireDefault(paragraphRole_1);var _presentationRole=_interopRequireDefault(presentationRole_1);var _progressbarRole=_interopRequireDefault(progressbarRole_1);var _radioRole=_interopRequireDefault(radioRole_1);var _radiogroupRole=_interopRequireDefault(radiogroupRole_1);var _regionRole=_interopRequireDefault(regionRole_1);var _rowRole=_interopRequireDefault(rowRole_1);var _rowgroupRole=_interopRequireDefault(rowgroupRole_1);var _rowheaderRole=_interopRequireDefault(rowheaderRole_1);var _scrollbarRole=_interopRequireDefault(scrollbarRole_1);var _searchRole=_interopRequireDefault(searchRole_1);var _searchboxRole=_interopRequireDefault(searchboxRole_1);var _separatorRole=_interopRequireDefault(separatorRole_1);var _sliderRole=_interopRequireDefault(sliderRole_1);var _spinbuttonRole=_interopRequireDefault(spinbuttonRole_1);var _statusRole=_interopRequireDefault(statusRole_1);var _strongRole=_interopRequireDefault(strongRole_1);var _subscriptRole=_interopRequireDefault(subscriptRole_1);var _superscriptRole=_interopRequireDefault(superscriptRole_1);var _switchRole=_interopRequireDefault(switchRole_1);var _tabRole=_interopRequireDefault(tabRole_1);var _tableRole=_interopRequireDefault(tableRole_1);var _tablistRole=_interopRequireDefault(tablistRole_1);var _tabpanelRole=_interopRequireDefault(tabpanelRole_1);var _termRole=_interopRequireDefault(termRole_1);var _textboxRole=_interopRequireDefault(textboxRole_1);var _timeRole=_interopRequireDefault(timeRole_1);var _timerRole=_interopRequireDefault(timerRole_1);var _toolbarRole=_interopRequireDefault(toolbarRole_1);var _tooltipRole=_interopRequireDefault(tooltipRole_1);var _treeRole=_interopRequireDefault(treeRole_1);var _treegridRole=_interopRequireDefault(treegridRole_1);var _treeitemRole=_interopRequireDefault(treeitemRole_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var ariaLiteralRoles=[['alert',_alertRole.default],['alertdialog',_alertdialogRole.default],['application',_applicationRole.default],['article',_articleRole.default],['banner',_bannerRole.default],['blockquote',_blockquoteRole.default],['button',_buttonRole.default],['caption',_captionRole.default],['cell',_cellRole.default],['checkbox',_checkboxRole.default],['code',_codeRole.default],['columnheader',_columnheaderRole.default],['combobox',_comboboxRole.default],['complementary',_complementaryRole.default],['contentinfo',_contentinfoRole.default],['definition',_definitionRole.default],['deletion',_deletionRole.default],['dialog',_dialogRole.default],['directory',_directoryRole.default],['document',_documentRole.default],['emphasis',_emphasisRole.default],['feed',_feedRole.default],['figure',_figureRole.default],['form',_formRole.default],['generic',_genericRole.default],['grid',_gridRole.default],['gridcell',_gridcellRole.default],['group',_groupRole.default],['heading',_headingRole.default],['img',_imgRole.default],['insertion',_insertionRole.default],['link',_linkRole.default],['list',_listRole.default],['listbox',_listboxRole.default],['listitem',_listitemRole.default],['log',_logRole.default],['main',_mainRole.default],['marquee',_marqueeRole.default],['math',_mathRole.default],['menu',_menuRole.default],['menubar',_menubarRole.default],['menuitem',_menuitemRole.default],['menuitemcheckbox',_menuitemcheckboxRole.default],['menuitemradio',_menuitemradioRole.default],['meter',_meterRole.default],['navigation',_navigationRole.default],['none',_noneRole.default],['note',_noteRole.default],['option',_optionRole.default],['paragraph',_paragraphRole.default],['presentation',_presentationRole.default],['progressbar',_progressbarRole.default],['radio',_radioRole.default],['radiogroup',_radiogroupRole.default],['region',_regionRole.default],['row',_rowRole.default],['rowgroup',_rowgroupRole.default],['rowheader',_rowheaderRole.default],['scrollbar',_scrollbarRole.default],['search',_searchRole.default],['searchbox',_searchboxRole.default],['separator',_separatorRole.default],['slider',_sliderRole.default],['spinbutton',_spinbuttonRole.default],['status',_statusRole.default],['strong',_strongRole.default],['subscript',_subscriptRole.default],['superscript',_superscriptRole.default],['switch',_switchRole.default],['tab',_tabRole.default],['table',_tableRole.default],['tablist',_tablistRole.default],['tabpanel',_tabpanelRole.default],['term',_termRole.default],['textbox',_textboxRole.default],['time',_timeRole.default],['timer',_timerRole.default],['toolbar',_toolbarRole.default],['tooltip',_tooltipRole.default],['tree',_treeRole.default],['treegrid',_treegridRole.default],['treeitem',_treeitemRole.default]];var _default=ariaLiteralRoles;exports.default=_default;});unwrapExports(ariaLiteralRoles_1);var docAbstractRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docAbstractRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'abstract [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=docAbstractRole;exports.default=_default;});unwrapExports(docAbstractRole_1);var docAcknowledgmentsRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docAcknowledgmentsRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'acknowledgments [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docAcknowledgmentsRole;exports.default=_default;});unwrapExports(docAcknowledgmentsRole_1);var docAfterwordRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docAfterwordRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'afterword [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docAfterwordRole;exports.default=_default;});unwrapExports(docAfterwordRole_1);var docAppendixRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docAppendixRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'appendix [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docAppendixRole;exports.default=_default;});unwrapExports(docAppendixRole_1);var docBacklinkRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docBacklinkRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','content'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'referrer [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','command','link']]};var _default=docBacklinkRole;exports.default=_default;});unwrapExports(docBacklinkRole_1);var docBiblioentryRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docBiblioentryRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'EPUB biblioentry [EPUB-SSV]'},module:'EPUB'}],requireContextRole:['doc-bibliography'],requiredContextRole:['doc-bibliography'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','listitem']]};var _default=docBiblioentryRole;exports.default=_default;});unwrapExports(docBiblioentryRole_1);var docBibliographyRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docBibliographyRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'bibliography [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['doc-biblioentry']],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docBibliographyRole;exports.default=_default;});unwrapExports(docBibliographyRole_1);var docBibliorefRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docBibliorefRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'biblioref [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','command','link']]};var _default=docBibliorefRole;exports.default=_default;});unwrapExports(docBibliorefRole_1);var docChapterRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docChapterRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'chapter [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docChapterRole;exports.default=_default;});unwrapExports(docChapterRole_1);var docColophonRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docColophonRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'colophon [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=docColophonRole;exports.default=_default;});unwrapExports(docColophonRole_1);var docConclusionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docConclusionRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'conclusion [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docConclusionRole;exports.default=_default;});unwrapExports(docConclusionRole_1);var docCoverRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docCoverRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'cover [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','img']]};var _default=docCoverRole;exports.default=_default;});unwrapExports(docCoverRole_1);var docCreditRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docCreditRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'credit [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=docCreditRole;exports.default=_default;});unwrapExports(docCreditRole_1);var docCreditsRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docCreditsRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'credits [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docCreditsRole;exports.default=_default;});unwrapExports(docCreditsRole_1);var docDedicationRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docDedicationRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'dedication [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=docDedicationRole;exports.default=_default;});unwrapExports(docDedicationRole_1);var docEndnoteRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docEndnoteRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'rearnote [EPUB-SSV]'},module:'EPUB'}],requireContextRole:['doc-endnotes'],requiredContextRole:['doc-endnotes'],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','listitem']]};var _default=docEndnoteRole;exports.default=_default;});unwrapExports(docEndnoteRole_1);var docEndnotesRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docEndnotesRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'rearnotes [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['doc-endnote']],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docEndnotesRole;exports.default=_default;});unwrapExports(docEndnotesRole_1);var docEpigraphRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docEpigraphRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'epigraph [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=docEpigraphRole;exports.default=_default;});unwrapExports(docEpigraphRole_1);var docEpilogueRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docEpilogueRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'epilogue [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docEpilogueRole;exports.default=_default;});unwrapExports(docEpilogueRole_1);var docErrataRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docErrataRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'errata [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docErrataRole;exports.default=_default;});unwrapExports(docErrataRole_1);var docExampleRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docExampleRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=docExampleRole;exports.default=_default;});unwrapExports(docExampleRole_1);var docFootnoteRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docFootnoteRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'footnote [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=docFootnoteRole;exports.default=_default;});unwrapExports(docFootnoteRole_1);var docForewordRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docForewordRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'foreword [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docForewordRole;exports.default=_default;});unwrapExports(docForewordRole_1);var docGlossaryRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docGlossaryRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'glossary [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[['definition'],['term']],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docGlossaryRole;exports.default=_default;});unwrapExports(docGlossaryRole_1);var docGlossrefRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docGlossrefRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'glossref [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','command','link']]};var _default=docGlossrefRole;exports.default=_default;});unwrapExports(docGlossrefRole_1);var docIndexRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docIndexRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'index [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark','navigation']]};var _default=docIndexRole;exports.default=_default;});unwrapExports(docIndexRole_1);var docIntroductionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docIntroductionRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'introduction [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docIntroductionRole;exports.default=_default;});unwrapExports(docIntroductionRole_1);var docNoterefRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docNoterefRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author','contents'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'noteref [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','widget','command','link']]};var _default=docNoterefRole;exports.default=_default;});unwrapExports(docNoterefRole_1);var docNoticeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docNoticeRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'notice [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','note']]};var _default=docNoticeRole;exports.default=_default;});unwrapExports(docNoticeRole_1);var docPagebreakRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docPagebreakRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:true,nameFrom:['author'],prohibitedProps:[],props:{'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'pagebreak [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','separator']]};var _default=docPagebreakRole;exports.default=_default;});unwrapExports(docPagebreakRole_1);var docPagelistRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docPagelistRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'page-list [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark','navigation']]};var _default=docPagelistRole;exports.default=_default;});unwrapExports(docPagelistRole_1);var docPartRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docPartRole={abstract:false,accessibleNameRequired:true,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'part [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docPartRole;exports.default=_default;});unwrapExports(docPartRole_1);var docPrefaceRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docPrefaceRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'preface [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docPrefaceRole;exports.default=_default;});unwrapExports(docPrefaceRole_1);var docPrologueRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docPrologueRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'prologue [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark']]};var _default=docPrologueRole;exports.default=_default;});unwrapExports(docPrologueRole_1);var docPullquoteRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docPullquoteRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:'pullquote [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['none']]};var _default=docPullquoteRole;exports.default=_default;});unwrapExports(docPullquoteRole_1);var docQnaRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docQnaRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'qna [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section']]};var _default=docQnaRole;exports.default=_default;});unwrapExports(docQnaRole_1);var docSubtitleRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docSubtitleRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'subtitle [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','sectionhead']]};var _default=docSubtitleRole;exports.default=_default;});unwrapExports(docSubtitleRole_1);var docTipRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docTipRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'help [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','note']]};var _default=docTipRole;exports.default=_default;});unwrapExports(docTipRole_1);var docTocRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var docTocRole={abstract:false,accessibleNameRequired:false,baseConcepts:[],childrenPresentational:false,nameFrom:['author'],prohibitedProps:[],props:{'aria-disabled':null,'aria-errormessage':null,'aria-expanded':null,'aria-haspopup':null,'aria-invalid':null},relatedConcepts:[{concept:{name:'toc [EPUB-SSV]'},module:'EPUB'}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[['roletype','structure','section','landmark','navigation']]};var _default=docTocRole;exports.default=_default;});unwrapExports(docTocRole_1);var ariaDpubRoles_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _docAbstractRole=_interopRequireDefault(docAbstractRole_1);var _docAcknowledgmentsRole=_interopRequireDefault(docAcknowledgmentsRole_1);var _docAfterwordRole=_interopRequireDefault(docAfterwordRole_1);var _docAppendixRole=_interopRequireDefault(docAppendixRole_1);var _docBacklinkRole=_interopRequireDefault(docBacklinkRole_1);var _docBiblioentryRole=_interopRequireDefault(docBiblioentryRole_1);var _docBibliographyRole=_interopRequireDefault(docBibliographyRole_1);var _docBibliorefRole=_interopRequireDefault(docBibliorefRole_1);var _docChapterRole=_interopRequireDefault(docChapterRole_1);var _docColophonRole=_interopRequireDefault(docColophonRole_1);var _docConclusionRole=_interopRequireDefault(docConclusionRole_1);var _docCoverRole=_interopRequireDefault(docCoverRole_1);var _docCreditRole=_interopRequireDefault(docCreditRole_1);var _docCreditsRole=_interopRequireDefault(docCreditsRole_1);var _docDedicationRole=_interopRequireDefault(docDedicationRole_1);var _docEndnoteRole=_interopRequireDefault(docEndnoteRole_1);var _docEndnotesRole=_interopRequireDefault(docEndnotesRole_1);var _docEpigraphRole=_interopRequireDefault(docEpigraphRole_1);var _docEpilogueRole=_interopRequireDefault(docEpilogueRole_1);var _docErrataRole=_interopRequireDefault(docErrataRole_1);var _docExampleRole=_interopRequireDefault(docExampleRole_1);var _docFootnoteRole=_interopRequireDefault(docFootnoteRole_1);var _docForewordRole=_interopRequireDefault(docForewordRole_1);var _docGlossaryRole=_interopRequireDefault(docGlossaryRole_1);var _docGlossrefRole=_interopRequireDefault(docGlossrefRole_1);var _docIndexRole=_interopRequireDefault(docIndexRole_1);var _docIntroductionRole=_interopRequireDefault(docIntroductionRole_1);var _docNoterefRole=_interopRequireDefault(docNoterefRole_1);var _docNoticeRole=_interopRequireDefault(docNoticeRole_1);var _docPagebreakRole=_interopRequireDefault(docPagebreakRole_1);var _docPagelistRole=_interopRequireDefault(docPagelistRole_1);var _docPartRole=_interopRequireDefault(docPartRole_1);var _docPrefaceRole=_interopRequireDefault(docPrefaceRole_1);var _docPrologueRole=_interopRequireDefault(docPrologueRole_1);var _docPullquoteRole=_interopRequireDefault(docPullquoteRole_1);var _docQnaRole=_interopRequireDefault(docQnaRole_1);var _docSubtitleRole=_interopRequireDefault(docSubtitleRole_1);var _docTipRole=_interopRequireDefault(docTipRole_1);var _docTocRole=_interopRequireDefault(docTocRole_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var ariaDpubRoles=[['doc-abstract',_docAbstractRole.default],['doc-acknowledgments',_docAcknowledgmentsRole.default],['doc-afterword',_docAfterwordRole.default],['doc-appendix',_docAppendixRole.default],['doc-backlink',_docBacklinkRole.default],['doc-biblioentry',_docBiblioentryRole.default],['doc-bibliography',_docBibliographyRole.default],['doc-biblioref',_docBibliorefRole.default],['doc-chapter',_docChapterRole.default],['doc-colophon',_docColophonRole.default],['doc-conclusion',_docConclusionRole.default],['doc-cover',_docCoverRole.default],['doc-credit',_docCreditRole.default],['doc-credits',_docCreditsRole.default],['doc-dedication',_docDedicationRole.default],['doc-endnote',_docEndnoteRole.default],['doc-endnotes',_docEndnotesRole.default],['doc-epigraph',_docEpigraphRole.default],['doc-epilogue',_docEpilogueRole.default],['doc-errata',_docErrataRole.default],['doc-example',_docExampleRole.default],['doc-footnote',_docFootnoteRole.default],['doc-foreword',_docForewordRole.default],['doc-glossary',_docGlossaryRole.default],['doc-glossref',_docGlossrefRole.default],['doc-index',_docIndexRole.default],['doc-introduction',_docIntroductionRole.default],['doc-noteref',_docNoterefRole.default],['doc-notice',_docNoticeRole.default],['doc-pagebreak',_docPagebreakRole.default],['doc-pagelist',_docPagelistRole.default],['doc-part',_docPartRole.default],['doc-preface',_docPrefaceRole.default],['doc-prologue',_docPrologueRole.default],['doc-pullquote',_docPullquoteRole.default],['doc-qna',_docQnaRole.default],['doc-subtitle',_docSubtitleRole.default],['doc-tip',_docTipRole.default],['doc-toc',_docTocRole.default]];var _default=ariaDpubRoles;exports.default=_default;});unwrapExports(ariaDpubRoles_1);var rolesMap_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _ariaAbstractRoles=_interopRequireDefault(ariaAbstractRoles_1);var _ariaLiteralRoles=_interopRequireDefault(ariaLiteralRoles_1);var _ariaDpubRoles=_interopRequireDefault(ariaDpubRoles_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!==\"undefined\"&&o[Symbol.iterator]||o[\"@@iterator\"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e2){throw _e2;},f:F};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e3){didErr=true;err=_e3;},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return();}finally{if(didErr)throw err;}}};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==\"undefined\"&&arr[Symbol.iterator]||arr[\"@@iterator\"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i[\"return\"]!=null)_i[\"return\"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}var roles=[].concat(_ariaAbstractRoles.default,_ariaLiteralRoles.default,_ariaDpubRoles.default);roles.forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),roleDefinition=_ref2[1];// Conglomerate the properties\nvar _iterator=_createForOfIteratorHelper(roleDefinition.superClass),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var superClassIter=_step.value;var _iterator2=_createForOfIteratorHelper(superClassIter),_step2;try{var _loop=function _loop(){var superClassName=_step2.value;var superClassRoleTuple=roles.find(function(_ref3){var _ref4=_slicedToArray(_ref3,1),name=_ref4[0];return name===superClassName;});if(superClassRoleTuple){var superClassDefinition=superClassRoleTuple[1];for(var _i2=0,_Object$keys=Object.keys(superClassDefinition.props);_i2<_Object$keys.length;_i2++){var prop=_Object$keys[_i2];if(// $FlowIssue Accessing the hasOwnProperty on the Object prototype is fine.\n!Object.prototype.hasOwnProperty.call(roleDefinition.props,prop)){Object.assign(roleDefinition.props,_defineProperty({},prop,superClassDefinition.props[prop]));}}}};for(_iterator2.s();!(_step2=_iterator2.n()).done;){_loop();}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}}catch(err){_iterator.e(err);}finally{_iterator.f();}});var rolesMap={entries:function entries(){return roles;},get:function get(key){var item=roles.find(function(tuple){return tuple[0]===key?true:false;});return item&&item[1];},has:function has(key){return!!this.get(key);},keys:function keys(){return roles.map(function(_ref5){var _ref6=_slicedToArray(_ref5,1),key=_ref6[0];return key;});},values:function values(){return roles.map(function(_ref7){var _ref8=_slicedToArray(_ref7,2),values=_ref8[1];return values;});}};var _default=rolesMap;exports.default=_default;});unwrapExports(rolesMap_1);var elementRoleMap_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _rolesMap=_interopRequireDefault(rolesMap_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==\"undefined\"&&arr[Symbol.iterator]||arr[\"@@iterator\"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i[\"return\"]!=null)_i[\"return\"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}var elementRoles=[];var keys=_rolesMap.default.keys();for(var i=0;i<keys.length;i++){var _key=keys[i];var role=_rolesMap.default.get(_key);if(role){var concepts=[].concat(role.baseConcepts,role.relatedConcepts);for(var k=0;k<concepts.length;k++){var relation=concepts[k];if(relation.module==='HTML'){var concept=relation.concept;if(concept){(function(){var conceptStr=JSON.stringify(concept);var elementRoleRelation=elementRoles.find(function(relation){return JSON.stringify(relation[0])===conceptStr;});var roles=void 0;if(elementRoleRelation){roles=elementRoleRelation[1];}else{roles=[];}var isUnique=true;for(var _i=0;_i<roles.length;_i++){if(roles[_i]===_key){isUnique=false;break;}}if(isUnique){roles.push(_key);}elementRoles.push([concept,roles]);})();}}}}}var elementRoleMap={entries:function entries(){return elementRoles;},get:function get(key){var item=elementRoles.find(function(tuple){return JSON.stringify(tuple[0])===JSON.stringify(key)?true:false;});return item&&item[1];},has:function has(key){return!!this.get(key);},keys:function keys(){return elementRoles.map(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];return key;});},values:function values(){return elementRoles.map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),values=_ref4[1];return values;});}};var _default=elementRoleMap;exports.default=_default;});unwrapExports(elementRoleMap_1);var roleElementMap_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _rolesMap=_interopRequireDefault(rolesMap_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==\"undefined\"&&arr[Symbol.iterator]||arr[\"@@iterator\"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i[\"return\"]!=null)_i[\"return\"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}var roleElement=[];var keys=_rolesMap.default.keys();var _loop=function _loop(i){var key=keys[i];var role=_rolesMap.default.get(key);if(role){var concepts=[].concat(role.baseConcepts,role.relatedConcepts);for(var k=0;k<concepts.length;k++){var relation=concepts[k];if(relation.module==='HTML'){var concept=relation.concept;if(concept){var roleElementRelation=roleElement.find(function(item){return item[0]===key;});var relationConcepts=void 0;if(roleElementRelation){relationConcepts=roleElementRelation[1];}else{relationConcepts=[];}relationConcepts.push(concept);roleElement.push([key,relationConcepts]);}}}}};for(var i=0;i<keys.length;i++){_loop(i);}var roleElementMap={entries:function entries(){return roleElement;},get:function get(key){var item=roleElement.find(function(tuple){return tuple[0]===key?true:false;});return item&&item[1];},has:function has(key){return!!this.get(key);},keys:function keys(){return roleElement.map(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];return key;});},values:function values(){return roleElement.map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),values=_ref4[1];return values;});}};var _default=roleElementMap;exports.default=_default;});unwrapExports(roleElementMap_1);var lib=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.roleElements=exports.elementRoles=exports.roles=exports.dom=exports.aria=void 0;var _ariaPropsMap=_interopRequireDefault(ariaPropsMap_1);var _domMap=_interopRequireDefault(domMap_1);var _rolesMap=_interopRequireDefault(rolesMap_1);var _elementRoleMap=_interopRequireDefault(elementRoleMap_1);var _roleElementMap=_interopRequireDefault(roleElementMap_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var aria=_ariaPropsMap.default;exports.aria=aria;var dom=_domMap.default;exports.dom=dom;var roles=_rolesMap.default;exports.roles=roles;var elementRoles=_elementRoleMap.default;exports.elementRoles=elementRoles;var roleElements=_roleElementMap.default;exports.roleElements=roleElements;});unwrapExports(lib);var lib_1=lib.roleElements;var lib_2=lib.elementRoles;var lib_3=lib.roles;var lib_4=lib.dom;var lib_5=lib.aria;var AbbrRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var AbbrRole={relatedConcepts:[{module:'HTML',concept:{name:'abbr'}}],type:'structure'};var _default=AbbrRole;exports.default=_default;});unwrapExports(AbbrRole_1);var AlertDialogRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var AlertDialogRole={relatedConcepts:[{module:'ARIA',concept:{name:'alertdialog'}}],type:'window'};var _default=AlertDialogRole;exports.default=_default;});unwrapExports(AlertDialogRole_1);var AlertRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var AlertRole={relatedConcepts:[{module:'ARIA',concept:{name:'alert'}}],type:'structure'};var _default=AlertRole;exports.default=_default;});unwrapExports(AlertRole_1);var AnnotationRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var AnnotationRole={relatedConcepts:[],type:'structure'};var _default=AnnotationRole;exports.default=_default;});unwrapExports(AnnotationRole_1);var ApplicationRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ApplicationRole={relatedConcepts:[{module:'ARIA',concept:{name:'application'}}],type:'window'};var _default=ApplicationRole;exports.default=_default;});unwrapExports(ApplicationRole_1);var ArticleRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ArticleRole={relatedConcepts:[{module:'ARIA',concept:{name:'article'}},{module:'HTML',concept:{name:'article'}}],type:'structure'};var _default=ArticleRole;exports.default=_default;});unwrapExports(ArticleRole_1);var AudioRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var AudioRole={relatedConcepts:[{module:'HTML',concept:{name:'audio'}}],type:'widget'};var _default=AudioRole;exports.default=_default;});unwrapExports(AudioRole_1);var BannerRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var BannerRole={relatedConcepts:[{module:'ARIA',concept:{name:'banner'}}],type:'structure'};var _default=BannerRole;exports.default=_default;});unwrapExports(BannerRole_1);var BlockquoteRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var BlockquoteRole={relatedConcepts:[{module:'HTML',concept:{name:'blockquote'}}],type:'structure'};var _default=BlockquoteRole;exports.default=_default;});unwrapExports(BlockquoteRole_1);var BusyIndicatorRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var BusyIndicatorRole={relatedConcepts:[{module:'ARIA',concept:{attributes:[{name:'aria-busy',value:'true'}]}}],type:'widget'};var _default=BusyIndicatorRole;exports.default=_default;});unwrapExports(BusyIndicatorRole_1);var ButtonRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ButtonRole={relatedConcepts:[{module:'ARIA',concept:{name:'button'}},{module:'HTML',concept:{name:'button'}}],type:'widget'};var _default=ButtonRole;exports.default=_default;});unwrapExports(ButtonRole_1);var CanvasRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var CanvasRole={relatedConcepts:[{module:'HTML',concept:{name:'canvas'}}],type:'widget'};var _default=CanvasRole;exports.default=_default;});unwrapExports(CanvasRole_1);var CaptionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var CaptionRole={relatedConcepts:[{module:'HTML',concept:{name:'caption'}}],type:'structure'};var _default=CaptionRole;exports.default=_default;});unwrapExports(CaptionRole_1);var CellRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var CellRole={relatedConcepts:[{module:'ARIA',concept:{name:'cell'}},{module:'ARIA',concept:{name:'gridcell'}},{module:'HTML',concept:{name:'td'}}],type:'widget'};var _default=CellRole;exports.default=_default;});unwrapExports(CellRole_1);var CheckBoxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var CheckBoxRole={relatedConcepts:[{module:'ARIA',concept:{name:'checkbox'}},{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'checkbox'}]}}],type:'widget'};var _default=CheckBoxRole;exports.default=_default;});unwrapExports(CheckBoxRole_1);var ColorWellRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ColorWellRole={relatedConcepts:[{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'color'}]}}],type:'widget'};var _default=ColorWellRole;exports.default=_default;});unwrapExports(ColorWellRole_1);var ColumnHeaderRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ColumnHeaderRole={relatedConcepts:[{module:'ARIA',concept:{name:'columnheader'}},{module:'HTML',concept:{name:'th'}}],type:'widget'};var _default=ColumnHeaderRole;exports.default=_default;});unwrapExports(ColumnHeaderRole_1);var ColumnRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ColumnRole={relatedConcepts:[],type:'structure'};var _default=ColumnRole;exports.default=_default;});unwrapExports(ColumnRole_1);var ComboBoxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ComboBoxRole={relatedConcepts:[{module:'ARIA',concept:{name:'combobox'}},{module:'HTML',concept:{name:'select'}}],type:'widget'};var _default=ComboBoxRole;exports.default=_default;});unwrapExports(ComboBoxRole_1);var ComplementaryRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ComplementaryRole={relatedConcepts:[{module:'ARIA',concept:{name:'complementary'}}],type:'structure'};var _default=ComplementaryRole;exports.default=_default;});unwrapExports(ComplementaryRole_1);var ContentInfoRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ContentInfoRole={relatedConcepts:[{module:'ARIA',concept:{name:'structureinfo'}}],type:'structure'};var _default=ContentInfoRole;exports.default=_default;});unwrapExports(ContentInfoRole_1);var DateRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DateRole={relatedConcepts:[{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'date'}]}}],type:'widget'};var _default=DateRole;exports.default=_default;});unwrapExports(DateRole_1);var DateTimeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DateTimeRole={relatedConcepts:[{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'datetime'}]}}],type:'widget'};var _default=DateTimeRole;exports.default=_default;});unwrapExports(DateTimeRole_1);var DefinitionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DefinitionRole={relatedConcepts:[{module:'HTML',concept:{name:'dfn'}}],type:'structure'};var _default=DefinitionRole;exports.default=_default;});unwrapExports(DefinitionRole_1);var DescriptionListDetailRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DescriptionListDetailRole={relatedConcepts:[{module:'HTML',concept:{name:'dd'}}],type:'structure'};var _default=DescriptionListDetailRole;exports.default=_default;});unwrapExports(DescriptionListDetailRole_1);var DescriptionListRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DescriptionListRole={relatedConcepts:[{module:'HTML',concept:{name:'dl'}}],type:'structure'};var _default=DescriptionListRole;exports.default=_default;});unwrapExports(DescriptionListRole_1);var DescriptionListTermRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DescriptionListTermRole={relatedConcepts:[{module:'HTML',concept:{name:'dt'}}],type:'structure'};var _default=DescriptionListTermRole;exports.default=_default;});unwrapExports(DescriptionListTermRole_1);var DetailsRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DetailsRole={relatedConcepts:[{module:'HTML',concept:{name:'details'}}],type:'structure'};var _default=DetailsRole;exports.default=_default;});unwrapExports(DetailsRole_1);var DialogRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DialogRole={relatedConcepts:[{module:'ARIA',concept:{name:'dialog'}},{module:'HTML',concept:{name:'dialog'}}],type:'window'};var _default=DialogRole;exports.default=_default;});unwrapExports(DialogRole_1);var DirectoryRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DirectoryRole={relatedConcepts:[{module:'ARIA',concept:{name:'directory'}},{module:'HTML',concept:{name:'dir'}}],type:'structure'};var _default=DirectoryRole;exports.default=_default;});unwrapExports(DirectoryRole_1);var DisclosureTriangleRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DisclosureTriangleRole={relatedConcepts:[{module:'HTML',concept:{name:'summary'}}],type:'widget'};var _default=DisclosureTriangleRole;exports.default=_default;});unwrapExports(DisclosureTriangleRole_1);var DivRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DivRole={relatedConcepts:[{module:'HTML',concept:{name:'div'}}],type:'generic'};var _default=DivRole;exports.default=_default;});unwrapExports(DivRole_1);var DocumentRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var DocumentRole={relatedConcepts:[{module:'ARIA',concept:{name:'document'}}],type:'structure'};var _default=DocumentRole;exports.default=_default;});unwrapExports(DocumentRole_1);var EmbeddedObjectRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var EmbeddedObjectRole={relatedConcepts:[{module:'HTML',concept:{name:'embed'}}],type:'widget'};var _default=EmbeddedObjectRole;exports.default=_default;});unwrapExports(EmbeddedObjectRole_1);var FeedRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var FeedRole={relatedConcepts:[{module:'ARIA',concept:{name:'feed'}}],type:'structure'};var _default=FeedRole;exports.default=_default;});unwrapExports(FeedRole_1);var FigcaptionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var FigcaptionRole={relatedConcepts:[{module:'HTML',concept:{name:'figcaption'}}],type:'structure'};var _default=FigcaptionRole;exports.default=_default;});unwrapExports(FigcaptionRole_1);var FigureRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var FigureRole={relatedConcepts:[{module:'ARIA',concept:{name:'figure'}},{module:'HTML',concept:{name:'figure'}}],type:'structure'};var _default=FigureRole;exports.default=_default;});unwrapExports(FigureRole_1);var FooterRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var FooterRole={relatedConcepts:[{module:'HTML',concept:{name:'footer'}}],type:'structure'};var _default=FooterRole;exports.default=_default;});unwrapExports(FooterRole_1);var FormRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var FormRole={relatedConcepts:[{module:'ARIA',concept:{name:'form'}},{module:'HTML',concept:{name:'form'}}],type:'structure'};var _default=FormRole;exports.default=_default;});unwrapExports(FormRole_1);var GridRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var GridRole={relatedConcepts:[{module:'ARIA',concept:{name:'grid'}}],type:'widget'};var _default=GridRole;exports.default=_default;});unwrapExports(GridRole_1);var GroupRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var GroupRole={relatedConcepts:[{module:'ARIA',concept:{name:'group'}}],type:'structure'};var _default=GroupRole;exports.default=_default;});unwrapExports(GroupRole_1);var HeadingRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var HeadingRole={relatedConcepts:[{module:'ARIA',concept:{name:'heading'}},{module:'HTML',concept:{name:'h1'}},{module:'HTML',concept:{name:'h2'}},{module:'HTML',concept:{name:'h3'}},{module:'HTML',concept:{name:'h4'}},{module:'HTML',concept:{name:'h5'}},{module:'HTML',concept:{name:'h6'}}],type:'structure'};var _default=HeadingRole;exports.default=_default;});unwrapExports(HeadingRole_1);var IframePresentationalRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var IframePresentationalRole={relatedConcepts:[],type:'window'};var _default=IframePresentationalRole;exports.default=_default;});unwrapExports(IframePresentationalRole_1);var IframeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var IframeRole={relatedConcepts:[{module:'HTML',concept:{name:'iframe'}}],type:'window'};var _default=IframeRole;exports.default=_default;});unwrapExports(IframeRole_1);var IgnoredRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var IgnoredRole={relatedConcepts:[],type:'structure'};var _default=IgnoredRole;exports.default=_default;});unwrapExports(IgnoredRole_1);var ImageMapLinkRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ImageMapLinkRole={relatedConcepts:[],type:'widget'};var _default=ImageMapLinkRole;exports.default=_default;});unwrapExports(ImageMapLinkRole_1);var ImageMapRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ImageMapRole={relatedConcepts:[{module:'HTML',concept:{name:'img',attributes:[{name:'usemap'}]}}],type:'structure'};var _default=ImageMapRole;exports.default=_default;});unwrapExports(ImageMapRole_1);var ImageRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ImageRole={relatedConcepts:[{module:'ARIA',concept:{name:'img'}},{module:'HTML',concept:{name:'img'}}],type:'structure'};var _default=ImageRole;exports.default=_default;});unwrapExports(ImageRole_1);var InlineTextBoxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var InlineTextBoxRole={relatedConcepts:[{module:'HTML',concept:{name:'input'}}],type:'widget'};var _default=InlineTextBoxRole;exports.default=_default;});unwrapExports(InlineTextBoxRole_1);var InputTimeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var InputTimeRole={relatedConcepts:[{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'time'}]}}],type:'widget'};var _default=InputTimeRole;exports.default=_default;});unwrapExports(InputTimeRole_1);var LabelRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var LabelRole={relatedConcepts:[{module:'HTML',concept:{name:'label'}}],type:'structure'};var _default=LabelRole;exports.default=_default;});unwrapExports(LabelRole_1);var LegendRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var LegendRole={relatedConcepts:[{module:'HTML',concept:{name:'legend'}}],type:'structure'};var _default=LegendRole;exports.default=_default;});unwrapExports(LegendRole_1);var LineBreakRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var LineBreakRole={relatedConcepts:[{module:'HTML',concept:{name:'br'}}],type:'structure'};var _default=LineBreakRole;exports.default=_default;});unwrapExports(LineBreakRole_1);var LinkRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var LinkRole={relatedConcepts:[{module:'ARIA',concept:{name:'link'}},{module:'HTML',concept:{name:'a',attributes:[{name:'href'}]}}],type:'widget'};var _default=LinkRole;exports.default=_default;});unwrapExports(LinkRole_1);var ListBoxOptionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ListBoxOptionRole={relatedConcepts:[{module:'ARIA',concept:{name:'option'}},{module:'HTML',concept:{name:'option'}}],type:'widget'};var _default=ListBoxOptionRole;exports.default=_default;});unwrapExports(ListBoxOptionRole_1);var ListBoxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ListBoxRole={relatedConcepts:[{module:'ARIA',concept:{name:'listbox'}},{module:'HTML',concept:{name:'datalist'}},{module:'HTML',concept:{name:'select'}}],type:'widget'};var _default=ListBoxRole;exports.default=_default;});unwrapExports(ListBoxRole_1);var ListItemRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ListItemRole={relatedConcepts:[{module:'ARIA',concept:{name:'listitem'}},{module:'HTML',concept:{name:'li'}}],type:'structure'};var _default=ListItemRole;exports.default=_default;});unwrapExports(ListItemRole_1);var ListMarkerRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ListMarkerRole={relatedConcepts:[],type:'structure'};var _default=ListMarkerRole;exports.default=_default;});unwrapExports(ListMarkerRole_1);var ListRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ListRole={relatedConcepts:[{module:'ARIA',concept:{name:'list'}},{module:'HTML',concept:{name:'ul'}},{module:'HTML',concept:{name:'ol'}}],type:'structure'};var _default=ListRole;exports.default=_default;});unwrapExports(ListRole_1);var LogRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var LogRole={relatedConcepts:[{module:'ARIA',concept:{name:'log'}}],type:'structure'};var _default=LogRole;exports.default=_default;});unwrapExports(LogRole_1);var MainRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MainRole={relatedConcepts:[{module:'ARIA',concept:{name:'main'}},{module:'HTML',concept:{name:'main'}}],type:'structure'};var _default=MainRole;exports.default=_default;});unwrapExports(MainRole_1);var MarkRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MarkRole={relatedConcepts:[{module:'HTML',concept:{name:'mark'}}],type:'structure'};var _default=MarkRole;exports.default=_default;});unwrapExports(MarkRole_1);var MarqueeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MarqueeRole={relatedConcepts:[{module:'ARIA',concept:{name:'marquee'}},{module:'HTML',concept:{name:'marquee'}}],type:'structure'};var _default=MarqueeRole;exports.default=_default;});unwrapExports(MarqueeRole_1);var MathRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MathRole={relatedConcepts:[{module:'ARIA',concept:{name:'math'}}],type:'structure'};var _default=MathRole;exports.default=_default;});unwrapExports(MathRole_1);var MenuBarRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MenuBarRole={relatedConcepts:[{module:'ARIA',concept:{name:'menubar'}}],type:'structure'};var _default=MenuBarRole;exports.default=_default;});unwrapExports(MenuBarRole_1);var MenuButtonRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MenuButtonRole={relatedConcepts:[],type:'widget'};var _default=MenuButtonRole;exports.default=_default;});unwrapExports(MenuButtonRole_1);var MenuItemRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MenuItemRole={relatedConcepts:[{module:'ARIA',concept:{name:'menuitem'}},{module:'HTML',concept:{name:'menuitem'}}],type:'widget'};var _default=MenuItemRole;exports.default=_default;});unwrapExports(MenuItemRole_1);var MenuItemCheckBoxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MenuItemCheckBoxRole={relatedConcepts:[{module:'ARIA',concept:{name:'menuitemcheckbox'}}],type:'widget'};var _default=MenuItemCheckBoxRole;exports.default=_default;});unwrapExports(MenuItemCheckBoxRole_1);var MenuItemRadioRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MenuItemRadioRole={relatedConcepts:[{module:'ARIA',concept:{name:'menuitemradio'}}],type:'widget'};var _default=MenuItemRadioRole;exports.default=_default;});unwrapExports(MenuItemRadioRole_1);var MenuListOptionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MenuListOptionRole={relatedConcepts:[],type:'widget'};var _default=MenuListOptionRole;exports.default=_default;});unwrapExports(MenuListOptionRole_1);var MenuListPopupRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MenuListPopupRole={relatedConcepts:[],type:'widget'};var _default=MenuListPopupRole;exports.default=_default;});unwrapExports(MenuListPopupRole_1);var MenuRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MenuRole={relatedConcepts:[{module:'ARIA',concept:{name:'menu'}},{module:'HTML',concept:{name:'menu'}}],type:'structure'};var _default=MenuRole;exports.default=_default;});unwrapExports(MenuRole_1);var MeterRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var MeterRole={relatedConcepts:[{module:'HTML',concept:{name:'meter'}}],type:'structure'};var _default=MeterRole;exports.default=_default;});unwrapExports(MeterRole_1);var NavigationRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var NavigationRole={relatedConcepts:[{module:'ARIA',concept:{name:'navigation'}},{module:'HTML',concept:{name:'nav'}}],type:'structure'};var _default=NavigationRole;exports.default=_default;});unwrapExports(NavigationRole_1);var NoneRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var NoneRole={relatedConcepts:[{module:'ARIA',concept:{name:'none'}}],type:'structure'};var _default=NoneRole;exports.default=_default;});unwrapExports(NoneRole_1);var NoteRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var NoteRole={relatedConcepts:[{module:'ARIA',concept:{name:'note'}}],type:'structure'};var _default=NoteRole;exports.default=_default;});unwrapExports(NoteRole_1);var OutlineRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var OutlineRole={relatedConcepts:[],type:'structure'};var _default=OutlineRole;exports.default=_default;});unwrapExports(OutlineRole_1);var ParagraphRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ParagraphRole={relatedConcepts:[{module:'HTML',concept:{name:'p'}}],type:'structure'};var _default=ParagraphRole;exports.default=_default;});unwrapExports(ParagraphRole_1);var PopUpButtonRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var PopUpButtonRole={relatedConcepts:[],type:'widget'};var _default=PopUpButtonRole;exports.default=_default;});unwrapExports(PopUpButtonRole_1);var PreRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var PreRole={relatedConcepts:[{module:'HTML',concept:{name:'pre'}}],type:'structure'};var _default=PreRole;exports.default=_default;});unwrapExports(PreRole_1);var PresentationalRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var PresentationalRole={relatedConcepts:[{module:'ARIA',concept:{name:'presentation'}}],type:'structure'};var _default=PresentationalRole;exports.default=_default;});unwrapExports(PresentationalRole_1);var ProgressIndicatorRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ProgressIndicatorRole={relatedConcepts:[{module:'ARIA',concept:{name:'progressbar'}},{module:'HTML',concept:{name:'progress'}}],type:'structure'};var _default=ProgressIndicatorRole;exports.default=_default;});unwrapExports(ProgressIndicatorRole_1);var RadioButtonRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var RadioButtonRole={relatedConcepts:[{module:'ARIA',concept:{name:'radio'}},{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'radio'}]}}],type:'widget'};var _default=RadioButtonRole;exports.default=_default;});unwrapExports(RadioButtonRole_1);var RadioGroupRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var RadioGroupRole={relatedConcepts:[{module:'ARIA',concept:{name:'radiogroup'}}],type:'structure'};var _default=RadioGroupRole;exports.default=_default;});unwrapExports(RadioGroupRole_1);var RegionRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var RegionRole={relatedConcepts:[{module:'ARIA',concept:{name:'region'}}],type:'structure'};var _default=RegionRole;exports.default=_default;});unwrapExports(RegionRole_1);var RootWebAreaRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var RootWebAreaRole={relatedConcepts:[],type:'structure'};var _default=RootWebAreaRole;exports.default=_default;});unwrapExports(RootWebAreaRole_1);var RowHeaderRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var RowHeaderRole={relatedConcepts:[{module:'ARIA',concept:{name:'rowheader'}},{module:'HTML',concept:{name:'th',attributes:[{name:'scope',value:'row'}]}}],type:'widget'};var _default=RowHeaderRole;exports.default=_default;});unwrapExports(RowHeaderRole_1);var RowRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var RowRole={relatedConcepts:[{module:'ARIA',concept:{name:'row'}},{module:'HTML',concept:{name:'tr'}}],type:'structure'};var _default=RowRole;exports.default=_default;});unwrapExports(RowRole_1);var RubyRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var RubyRole={relatedConcepts:[{module:'HTML',concept:{name:'ruby'}}],type:'structure'};var _default=RubyRole;exports.default=_default;});unwrapExports(RubyRole_1);var RulerRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var RulerRole={relatedConcepts:[],type:'structure'};var _default=RulerRole;exports.default=_default;});unwrapExports(RulerRole_1);var ScrollAreaRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ScrollAreaRole={relatedConcepts:[],type:'structure'};var _default=ScrollAreaRole;exports.default=_default;});unwrapExports(ScrollAreaRole_1);var ScrollBarRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ScrollBarRole={relatedConcepts:[{module:'ARIA',concept:{name:'scrollbar'}}],type:'widget'};var _default=ScrollBarRole;exports.default=_default;});unwrapExports(ScrollBarRole_1);var SeamlessWebAreaRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SeamlessWebAreaRole={relatedConcepts:[],type:'structure'};var _default=SeamlessWebAreaRole;exports.default=_default;});unwrapExports(SeamlessWebAreaRole_1);var SearchRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SearchRole={relatedConcepts:[{module:'ARIA',concept:{name:'search'}}],type:'structure'};var _default=SearchRole;exports.default=_default;});unwrapExports(SearchRole_1);var SearchBoxRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SearchBoxRole={relatedConcepts:[{module:'ARIA',concept:{name:'searchbox'}},{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'search'}]}}],type:'widget'};var _default=SearchBoxRole;exports.default=_default;});unwrapExports(SearchBoxRole_1);var SliderRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SliderRole={relatedConcepts:[{module:'ARIA',concept:{name:'slider'}},{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'range'}]}}],type:'widget'};var _default=SliderRole;exports.default=_default;});unwrapExports(SliderRole_1);var SliderThumbRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SliderThumbRole={relatedConcepts:[],type:'structure'};var _default=SliderThumbRole;exports.default=_default;});unwrapExports(SliderThumbRole_1);var SpinButtonRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SpinButtonRole={relatedConcepts:[{module:'ARIA',concept:{name:'spinbutton'}},{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'number'}]}}],type:'widget'};var _default=SpinButtonRole;exports.default=_default;});unwrapExports(SpinButtonRole_1);var SpinButtonPartRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SpinButtonPartRole={relatedConcepts:[],type:'structure'};var _default=SpinButtonPartRole;exports.default=_default;});unwrapExports(SpinButtonPartRole_1);var SplitterRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SplitterRole={relatedConcepts:[{module:'ARIA',concept:{name:'separator'}}],type:'widget'};var _default=SplitterRole;exports.default=_default;});unwrapExports(SplitterRole_1);var StaticTextRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var StaticTextRole={relatedConcepts:[],type:'structure'};var _default=StaticTextRole;exports.default=_default;});unwrapExports(StaticTextRole_1);var StatusRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var StatusRole={relatedConcepts:[{module:'ARIA',concept:{name:'status'}}],type:'structure'};var _default=StatusRole;exports.default=_default;});unwrapExports(StatusRole_1);var SVGRootRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SVGRootRole={relatedConcepts:[],type:'structure'};var _default=SVGRootRole;exports.default=_default;});unwrapExports(SVGRootRole_1);var SwitchRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var SwitchRole={relatedConcepts:[{module:'ARIA',concept:{name:'switch'}},{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'checkbox'}]}}],type:'widget'};var _default=SwitchRole;exports.default=_default;});unwrapExports(SwitchRole_1);var TabGroupRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TabGroupRole={relatedConcepts:[{module:'ARIA',concept:{name:'tablist'}}],type:'structure'};var _default=TabGroupRole;exports.default=_default;});unwrapExports(TabGroupRole_1);var TabRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TabRole={relatedConcepts:[{module:'ARIA',concept:{name:'tab'}}],type:'widget'};var _default=TabRole;exports.default=_default;});unwrapExports(TabRole_1);var TableHeaderContainerRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TableHeaderContainerRole={relatedConcepts:[],type:'structure'};var _default=TableHeaderContainerRole;exports.default=_default;});unwrapExports(TableHeaderContainerRole_1);var TableRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TableRole={relatedConcepts:[{module:'ARIA',concept:{name:'table'}},{module:'HTML',concept:{name:'table'}}],type:'structure'};var _default=TableRole;exports.default=_default;});unwrapExports(TableRole_1);var TabListRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TabListRole={relatedConcepts:[{module:'ARIA',concept:{name:'tablist'}}],type:'structure'};var _default=TabListRole;exports.default=_default;});unwrapExports(TabListRole_1);var TabPanelRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TabPanelRole={relatedConcepts:[{module:'ARIA',concept:{name:'tabpanel'}}],type:'structure'};var _default=TabPanelRole;exports.default=_default;});unwrapExports(TabPanelRole_1);var TermRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TermRole={relatedConcepts:[{module:'ARIA',concept:{name:'term'}}],type:'structure'};var _default=TermRole;exports.default=_default;});unwrapExports(TermRole_1);var TextFieldRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TextFieldRole={relatedConcepts:[{module:'ARIA',concept:{name:'textbox'}},{module:'HTML',concept:{name:'input'}},{module:'HTML',concept:{name:'input',attributes:[{name:'type',value:'text'}]}}],type:'widget'};var _default=TextFieldRole;exports.default=_default;});unwrapExports(TextFieldRole_1);var TimeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TimeRole={relatedConcepts:[{module:'HTML',concept:{name:'time'}}],type:'structure'};var _default=TimeRole;exports.default=_default;});unwrapExports(TimeRole_1);var TimerRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TimerRole={relatedConcepts:[{module:'ARIA',concept:{name:'timer'}}],type:'structure'};var _default=TimerRole;exports.default=_default;});unwrapExports(TimerRole_1);var ToggleButtonRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ToggleButtonRole={relatedConcepts:[{module:'ARIA',concept:{attributes:[{name:'aria-pressed'}]}}],type:'widget'};var _default=ToggleButtonRole;exports.default=_default;});unwrapExports(ToggleButtonRole_1);var ToolbarRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var ToolbarRole={relatedConcepts:[{module:'ARIA',concept:{name:'toolbar'}}],type:'structure'};var _default=ToolbarRole;exports.default=_default;});unwrapExports(ToolbarRole_1);var TreeRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TreeRole={relatedConcepts:[{module:'ARIA',concept:{name:'tree'}}],type:'widget'};var _default=TreeRole;exports.default=_default;});unwrapExports(TreeRole_1);var TreeGridRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TreeGridRole={relatedConcepts:[{module:'ARIA',concept:{name:'treegrid'}}],type:'widget'};var _default=TreeGridRole;exports.default=_default;});unwrapExports(TreeGridRole_1);var TreeItemRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var TreeItemRole={relatedConcepts:[{module:'ARIA',concept:{name:'treeitem'}}],type:'widget'};var _default=TreeItemRole;exports.default=_default;});unwrapExports(TreeItemRole_1);var UserInterfaceTooltipRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var UserInterfaceTooltipRole={relatedConcepts:[{module:'ARIA',concept:{name:'tooltip'}}],type:'structure'};var _default=UserInterfaceTooltipRole;exports.default=_default;});unwrapExports(UserInterfaceTooltipRole_1);var VideoRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var VideoRole={relatedConcepts:[{module:'HTML',concept:{name:'video'}}],type:'widget'};var _default=VideoRole;exports.default=_default;});unwrapExports(VideoRole_1);var WebAreaRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var WebAreaRole={relatedConcepts:[],type:'structure'};var _default=WebAreaRole;exports.default=_default;});unwrapExports(WebAreaRole_1);var WindowRole_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var WindowRole={relatedConcepts:[],type:'window'};var _default=WindowRole;exports.default=_default;});unwrapExports(WindowRole_1);var AXObjectsMap_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _AbbrRole=_interopRequireDefault(AbbrRole_1);var _AlertDialogRole=_interopRequireDefault(AlertDialogRole_1);var _AlertRole=_interopRequireDefault(AlertRole_1);var _AnnotationRole=_interopRequireDefault(AnnotationRole_1);var _ApplicationRole=_interopRequireDefault(ApplicationRole_1);var _ArticleRole=_interopRequireDefault(ArticleRole_1);var _AudioRole=_interopRequireDefault(AudioRole_1);var _BannerRole=_interopRequireDefault(BannerRole_1);var _BlockquoteRole=_interopRequireDefault(BlockquoteRole_1);var _BusyIndicatorRole=_interopRequireDefault(BusyIndicatorRole_1);var _ButtonRole=_interopRequireDefault(ButtonRole_1);var _CanvasRole=_interopRequireDefault(CanvasRole_1);var _CaptionRole=_interopRequireDefault(CaptionRole_1);var _CellRole=_interopRequireDefault(CellRole_1);var _CheckBoxRole=_interopRequireDefault(CheckBoxRole_1);var _ColorWellRole=_interopRequireDefault(ColorWellRole_1);var _ColumnHeaderRole=_interopRequireDefault(ColumnHeaderRole_1);var _ColumnRole=_interopRequireDefault(ColumnRole_1);var _ComboBoxRole=_interopRequireDefault(ComboBoxRole_1);var _ComplementaryRole=_interopRequireDefault(ComplementaryRole_1);var _ContentInfoRole=_interopRequireDefault(ContentInfoRole_1);var _DateRole=_interopRequireDefault(DateRole_1);var _DateTimeRole=_interopRequireDefault(DateTimeRole_1);var _DefinitionRole=_interopRequireDefault(DefinitionRole_1);var _DescriptionListDetailRole=_interopRequireDefault(DescriptionListDetailRole_1);var _DescriptionListRole=_interopRequireDefault(DescriptionListRole_1);var _DescriptionListTermRole=_interopRequireDefault(DescriptionListTermRole_1);var _DetailsRole=_interopRequireDefault(DetailsRole_1);var _DialogRole=_interopRequireDefault(DialogRole_1);var _DirectoryRole=_interopRequireDefault(DirectoryRole_1);var _DisclosureTriangleRole=_interopRequireDefault(DisclosureTriangleRole_1);var _DivRole=_interopRequireDefault(DivRole_1);var _DocumentRole=_interopRequireDefault(DocumentRole_1);var _EmbeddedObjectRole=_interopRequireDefault(EmbeddedObjectRole_1);var _FeedRole=_interopRequireDefault(FeedRole_1);var _FigcaptionRole=_interopRequireDefault(FigcaptionRole_1);var _FigureRole=_interopRequireDefault(FigureRole_1);var _FooterRole=_interopRequireDefault(FooterRole_1);var _FormRole=_interopRequireDefault(FormRole_1);var _GridRole=_interopRequireDefault(GridRole_1);var _GroupRole=_interopRequireDefault(GroupRole_1);var _HeadingRole=_interopRequireDefault(HeadingRole_1);var _IframePresentationalRole=_interopRequireDefault(IframePresentationalRole_1);var _IframeRole=_interopRequireDefault(IframeRole_1);var _IgnoredRole=_interopRequireDefault(IgnoredRole_1);var _ImageMapLinkRole=_interopRequireDefault(ImageMapLinkRole_1);var _ImageMapRole=_interopRequireDefault(ImageMapRole_1);var _ImageRole=_interopRequireDefault(ImageRole_1);var _InlineTextBoxRole=_interopRequireDefault(InlineTextBoxRole_1);var _InputTimeRole=_interopRequireDefault(InputTimeRole_1);var _LabelRole=_interopRequireDefault(LabelRole_1);var _LegendRole=_interopRequireDefault(LegendRole_1);var _LineBreakRole=_interopRequireDefault(LineBreakRole_1);var _LinkRole=_interopRequireDefault(LinkRole_1);var _ListBoxOptionRole=_interopRequireDefault(ListBoxOptionRole_1);var _ListBoxRole=_interopRequireDefault(ListBoxRole_1);var _ListItemRole=_interopRequireDefault(ListItemRole_1);var _ListMarkerRole=_interopRequireDefault(ListMarkerRole_1);var _ListRole=_interopRequireDefault(ListRole_1);var _LogRole=_interopRequireDefault(LogRole_1);var _MainRole=_interopRequireDefault(MainRole_1);var _MarkRole=_interopRequireDefault(MarkRole_1);var _MarqueeRole=_interopRequireDefault(MarqueeRole_1);var _MathRole=_interopRequireDefault(MathRole_1);var _MenuBarRole=_interopRequireDefault(MenuBarRole_1);var _MenuButtonRole=_interopRequireDefault(MenuButtonRole_1);var _MenuItemRole=_interopRequireDefault(MenuItemRole_1);var _MenuItemCheckBoxRole=_interopRequireDefault(MenuItemCheckBoxRole_1);var _MenuItemRadioRole=_interopRequireDefault(MenuItemRadioRole_1);var _MenuListOptionRole=_interopRequireDefault(MenuListOptionRole_1);var _MenuListPopupRole=_interopRequireDefault(MenuListPopupRole_1);var _MenuRole=_interopRequireDefault(MenuRole_1);var _MeterRole=_interopRequireDefault(MeterRole_1);var _NavigationRole=_interopRequireDefault(NavigationRole_1);var _NoneRole=_interopRequireDefault(NoneRole_1);var _NoteRole=_interopRequireDefault(NoteRole_1);var _OutlineRole=_interopRequireDefault(OutlineRole_1);var _ParagraphRole=_interopRequireDefault(ParagraphRole_1);var _PopUpButtonRole=_interopRequireDefault(PopUpButtonRole_1);var _PreRole=_interopRequireDefault(PreRole_1);var _PresentationalRole=_interopRequireDefault(PresentationalRole_1);var _ProgressIndicatorRole=_interopRequireDefault(ProgressIndicatorRole_1);var _RadioButtonRole=_interopRequireDefault(RadioButtonRole_1);var _RadioGroupRole=_interopRequireDefault(RadioGroupRole_1);var _RegionRole=_interopRequireDefault(RegionRole_1);var _RootWebAreaRole=_interopRequireDefault(RootWebAreaRole_1);var _RowHeaderRole=_interopRequireDefault(RowHeaderRole_1);var _RowRole=_interopRequireDefault(RowRole_1);var _RubyRole=_interopRequireDefault(RubyRole_1);var _RulerRole=_interopRequireDefault(RulerRole_1);var _ScrollAreaRole=_interopRequireDefault(ScrollAreaRole_1);var _ScrollBarRole=_interopRequireDefault(ScrollBarRole_1);var _SeamlessWebAreaRole=_interopRequireDefault(SeamlessWebAreaRole_1);var _SearchRole=_interopRequireDefault(SearchRole_1);var _SearchBoxRole=_interopRequireDefault(SearchBoxRole_1);var _SliderRole=_interopRequireDefault(SliderRole_1);var _SliderThumbRole=_interopRequireDefault(SliderThumbRole_1);var _SpinButtonRole=_interopRequireDefault(SpinButtonRole_1);var _SpinButtonPartRole=_interopRequireDefault(SpinButtonPartRole_1);var _SplitterRole=_interopRequireDefault(SplitterRole_1);var _StaticTextRole=_interopRequireDefault(StaticTextRole_1);var _StatusRole=_interopRequireDefault(StatusRole_1);var _SVGRootRole=_interopRequireDefault(SVGRootRole_1);var _SwitchRole=_interopRequireDefault(SwitchRole_1);var _TabGroupRole=_interopRequireDefault(TabGroupRole_1);var _TabRole=_interopRequireDefault(TabRole_1);var _TableHeaderContainerRole=_interopRequireDefault(TableHeaderContainerRole_1);var _TableRole=_interopRequireDefault(TableRole_1);var _TabListRole=_interopRequireDefault(TabListRole_1);var _TabPanelRole=_interopRequireDefault(TabPanelRole_1);var _TermRole=_interopRequireDefault(TermRole_1);var _TextFieldRole=_interopRequireDefault(TextFieldRole_1);var _TimeRole=_interopRequireDefault(TimeRole_1);var _TimerRole=_interopRequireDefault(TimerRole_1);var _ToggleButtonRole=_interopRequireDefault(ToggleButtonRole_1);var _ToolbarRole=_interopRequireDefault(ToolbarRole_1);var _TreeRole=_interopRequireDefault(TreeRole_1);var _TreeGridRole=_interopRequireDefault(TreeGridRole_1);var _TreeItemRole=_interopRequireDefault(TreeItemRole_1);var _UserInterfaceTooltipRole=_interopRequireDefault(UserInterfaceTooltipRole_1);var _VideoRole=_interopRequireDefault(VideoRole_1);var _WebAreaRole=_interopRequireDefault(WebAreaRole_1);var _WindowRole=_interopRequireDefault(WindowRole_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==\"undefined\"&&arr[Symbol.iterator]||arr[\"@@iterator\"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i[\"return\"]!=null)_i[\"return\"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}var AXObjects=[['AbbrRole',_AbbrRole.default],['AlertDialogRole',_AlertDialogRole.default],['AlertRole',_AlertRole.default],['AnnotationRole',_AnnotationRole.default],['ApplicationRole',_ApplicationRole.default],['ArticleRole',_ArticleRole.default],['AudioRole',_AudioRole.default],['BannerRole',_BannerRole.default],['BlockquoteRole',_BlockquoteRole.default],['BusyIndicatorRole',_BusyIndicatorRole.default],['ButtonRole',_ButtonRole.default],['CanvasRole',_CanvasRole.default],['CaptionRole',_CaptionRole.default],['CellRole',_CellRole.default],['CheckBoxRole',_CheckBoxRole.default],['ColorWellRole',_ColorWellRole.default],['ColumnHeaderRole',_ColumnHeaderRole.default],['ColumnRole',_ColumnRole.default],['ComboBoxRole',_ComboBoxRole.default],['ComplementaryRole',_ComplementaryRole.default],['ContentInfoRole',_ContentInfoRole.default],['DateRole',_DateRole.default],['DateTimeRole',_DateTimeRole.default],['DefinitionRole',_DefinitionRole.default],['DescriptionListDetailRole',_DescriptionListDetailRole.default],['DescriptionListRole',_DescriptionListRole.default],['DescriptionListTermRole',_DescriptionListTermRole.default],['DetailsRole',_DetailsRole.default],['DialogRole',_DialogRole.default],['DirectoryRole',_DirectoryRole.default],['DisclosureTriangleRole',_DisclosureTriangleRole.default],['DivRole',_DivRole.default],['DocumentRole',_DocumentRole.default],['EmbeddedObjectRole',_EmbeddedObjectRole.default],['FeedRole',_FeedRole.default],['FigcaptionRole',_FigcaptionRole.default],['FigureRole',_FigureRole.default],['FooterRole',_FooterRole.default],['FormRole',_FormRole.default],['GridRole',_GridRole.default],['GroupRole',_GroupRole.default],['HeadingRole',_HeadingRole.default],['IframePresentationalRole',_IframePresentationalRole.default],['IframeRole',_IframeRole.default],['IgnoredRole',_IgnoredRole.default],['ImageMapLinkRole',_ImageMapLinkRole.default],['ImageMapRole',_ImageMapRole.default],['ImageRole',_ImageRole.default],['InlineTextBoxRole',_InlineTextBoxRole.default],['InputTimeRole',_InputTimeRole.default],['LabelRole',_LabelRole.default],['LegendRole',_LegendRole.default],['LineBreakRole',_LineBreakRole.default],['LinkRole',_LinkRole.default],['ListBoxOptionRole',_ListBoxOptionRole.default],['ListBoxRole',_ListBoxRole.default],['ListItemRole',_ListItemRole.default],['ListMarkerRole',_ListMarkerRole.default],['ListRole',_ListRole.default],['LogRole',_LogRole.default],['MainRole',_MainRole.default],['MarkRole',_MarkRole.default],['MarqueeRole',_MarqueeRole.default],['MathRole',_MathRole.default],['MenuBarRole',_MenuBarRole.default],['MenuButtonRole',_MenuButtonRole.default],['MenuItemRole',_MenuItemRole.default],['MenuItemCheckBoxRole',_MenuItemCheckBoxRole.default],['MenuItemRadioRole',_MenuItemRadioRole.default],['MenuListOptionRole',_MenuListOptionRole.default],['MenuListPopupRole',_MenuListPopupRole.default],['MenuRole',_MenuRole.default],['MeterRole',_MeterRole.default],['NavigationRole',_NavigationRole.default],['NoneRole',_NoneRole.default],['NoteRole',_NoteRole.default],['OutlineRole',_OutlineRole.default],['ParagraphRole',_ParagraphRole.default],['PopUpButtonRole',_PopUpButtonRole.default],['PreRole',_PreRole.default],['PresentationalRole',_PresentationalRole.default],['ProgressIndicatorRole',_ProgressIndicatorRole.default],['RadioButtonRole',_RadioButtonRole.default],['RadioGroupRole',_RadioGroupRole.default],['RegionRole',_RegionRole.default],['RootWebAreaRole',_RootWebAreaRole.default],['RowHeaderRole',_RowHeaderRole.default],['RowRole',_RowRole.default],['RubyRole',_RubyRole.default],['RulerRole',_RulerRole.default],['ScrollAreaRole',_ScrollAreaRole.default],['ScrollBarRole',_ScrollBarRole.default],['SeamlessWebAreaRole',_SeamlessWebAreaRole.default],['SearchRole',_SearchRole.default],['SearchBoxRole',_SearchBoxRole.default],['SliderRole',_SliderRole.default],['SliderThumbRole',_SliderThumbRole.default],['SpinButtonRole',_SpinButtonRole.default],['SpinButtonPartRole',_SpinButtonPartRole.default],['SplitterRole',_SplitterRole.default],['StaticTextRole',_StaticTextRole.default],['StatusRole',_StatusRole.default],['SVGRootRole',_SVGRootRole.default],['SwitchRole',_SwitchRole.default],['TabGroupRole',_TabGroupRole.default],['TabRole',_TabRole.default],['TableHeaderContainerRole',_TableHeaderContainerRole.default],['TableRole',_TableRole.default],['TabListRole',_TabListRole.default],['TabPanelRole',_TabPanelRole.default],['TermRole',_TermRole.default],['TextFieldRole',_TextFieldRole.default],['TimeRole',_TimeRole.default],['TimerRole',_TimerRole.default],['ToggleButtonRole',_ToggleButtonRole.default],['ToolbarRole',_ToolbarRole.default],['TreeRole',_TreeRole.default],['TreeGridRole',_TreeGridRole.default],['TreeItemRole',_TreeItemRole.default],['UserInterfaceTooltipRole',_UserInterfaceTooltipRole.default],['VideoRole',_VideoRole.default],['WebAreaRole',_WebAreaRole.default],['WindowRole',_WindowRole.default]];var AXObjectsMap={entries:function entries(){return AXObjects;},get:function get(key){var item=AXObjects.find(function(tuple){return tuple[0]===key?true:false;});return item&&item[1];},has:function has(key){return!!this.get(key);},keys:function keys(){return AXObjects.map(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];return key;});},values:function values(){return AXObjects.map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),values=_ref4[1];return values;});}};var _default=AXObjectsMap;exports.default=_default;});unwrapExports(AXObjectsMap_1);var AXObjectElementMap_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _AXObjectsMap=_interopRequireDefault(AXObjectsMap_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==\"undefined\"&&arr[Symbol.iterator]||arr[\"@@iterator\"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i[\"return\"]!=null)_i[\"return\"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!==\"undefined\"&&o[Symbol.iterator]||o[\"@@iterator\"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e2){throw _e2;},f:F};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e3){didErr=true;err=_e3;},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return();}finally{if(didErr)throw err;}}};}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}var AXObjectElements=[];var _iterator=_createForOfIteratorHelper(_AXObjectsMap.default.entries()),_step;try{var _loop=function _loop(){var _step$value=_slicedToArray(_step.value,2),name=_step$value[0],def=_step$value[1];var relatedConcepts=def.relatedConcepts;if(Array.isArray(relatedConcepts)){relatedConcepts.forEach(function(relation){if(relation.module==='HTML'){var concept=relation.concept;if(concept){var index=AXObjectElements.findIndex(function(_ref5){var _ref6=_slicedToArray(_ref5,1),key=_ref6[0];return key===name;});if(index===-1){AXObjectElements.push([name,[]]);index=AXObjectElements.length-1;}AXObjectElements[index][1].push(concept);}}});}};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}var AXObjectElementMap={entries:function entries(){return AXObjectElements;},get:function get(key){var item=AXObjectElements.find(function(tuple){return tuple[0]===key?true:false;});return item&&item[1];},has:function has(key){return!!this.get(key);},keys:function keys(){return AXObjectElements.map(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];return key;});},values:function values(){return AXObjectElements.map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),values=_ref4[1];return values;});}};var _default=AXObjectElementMap;exports.default=_default;});unwrapExports(AXObjectElementMap_1);var AXObjectRoleMap_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _AXObjectsMap=_interopRequireDefault(AXObjectsMap_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==\"undefined\"&&arr[Symbol.iterator]||arr[\"@@iterator\"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i[\"return\"]!=null)_i[\"return\"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!==\"undefined\"&&o[Symbol.iterator]||o[\"@@iterator\"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e2){throw _e2;},f:F};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e3){didErr=true;err=_e3;},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return();}finally{if(didErr)throw err;}}};}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}var AXObjectRoleElements=[];var _iterator=_createForOfIteratorHelper(_AXObjectsMap.default.entries()),_step;try{var _loop=function _loop(){var _step$value=_slicedToArray(_step.value,2),name=_step$value[0],def=_step$value[1];var relatedConcepts=def.relatedConcepts;if(Array.isArray(relatedConcepts)){relatedConcepts.forEach(function(relation){if(relation.module==='ARIA'){var concept=relation.concept;if(concept){var index=AXObjectRoleElements.findIndex(function(_ref5){var _ref6=_slicedToArray(_ref5,1),key=_ref6[0];return key===name;});if(index===-1){AXObjectRoleElements.push([name,[]]);index=AXObjectRoleElements.length-1;}AXObjectRoleElements[index][1].push(concept);}}});}};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}var AXObjectRoleMap={entries:function entries(){return AXObjectRoleElements;},get:function get(key){var item=AXObjectRoleElements.find(function(tuple){return tuple[0]===key?true:false;});return item&&item[1];},has:function has(key){return!!this.get(key);},keys:function keys(){return AXObjectRoleElements.map(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];return key;});},values:function values(){return AXObjectRoleElements.map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),values=_ref4[1];return values;});}};var _default=AXObjectRoleMap;exports.default=_default;});unwrapExports(AXObjectRoleMap_1);var elementAXObjectMap_1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _AXObjectsMap=_interopRequireDefault(AXObjectsMap_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==\"undefined\"&&arr[Symbol.iterator]||arr[\"@@iterator\"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i[\"return\"]!=null)_i[\"return\"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!==\"undefined\"&&o[Symbol.iterator]||o[\"@@iterator\"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e2){throw _e2;},f:F};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e3){didErr=true;err=_e3;},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return();}finally{if(didErr)throw err;}}};}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}var elementAXObjects=[];var _iterator=_createForOfIteratorHelper(_AXObjectsMap.default.entries()),_step;try{var _loop=function _loop(){var _step$value=_slicedToArray(_step.value,2),name=_step$value[0],def=_step$value[1];var relatedConcepts=def.relatedConcepts;if(Array.isArray(relatedConcepts)){relatedConcepts.forEach(function(relation){if(relation.module==='HTML'){var concept=relation.concept;if(concept){var conceptStr=JSON.stringify(concept);var axObjects;var index=0;for(;index<elementAXObjects.length;index++){var _key=elementAXObjects[index][0];if(JSON.stringify(_key)===conceptStr){axObjects=elementAXObjects[index][1];break;}}if(!axObjects){axObjects=[];}var loc=axObjects.findIndex(function(item){return item===name;});if(loc===-1){axObjects.push(name);}if(index<elementAXObjects.length){elementAXObjects.splice(index,1,[concept,axObjects]);}else{elementAXObjects.push([concept,axObjects]);}}}});}};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}var elementAXObjectMap={entries:function entries(){return elementAXObjects;},get:function get(key){var item=elementAXObjects.find(function(tuple){return tuple[0]===key?true:false;});return item&&item[1];},has:function has(key){return!!this.get(key);},keys:function keys(){return elementAXObjects.map(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];return key;});},values:function values(){return elementAXObjects.map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),values=_ref4[1];return values;});}};var _default=elementAXObjectMap;exports.default=_default;});unwrapExports(elementAXObjectMap_1);var lib$1=createCommonjsModule(function(module,exports){Object.defineProperty(exports,\"__esModule\",{value:true});exports.elementAXObjects=exports.AXObjects=exports.AXObjectRoles=exports.AXObjectElements=void 0;var _AXObjectElementMap=_interopRequireDefault(AXObjectElementMap_1);var _AXObjectRoleMap=_interopRequireDefault(AXObjectRoleMap_1);var _AXObjectsMap=_interopRequireDefault(AXObjectsMap_1);var _elementAXObjectMap=_interopRequireDefault(elementAXObjectMap_1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var AXObjectElements=_AXObjectElementMap.default;exports.AXObjectElements=AXObjectElements;var AXObjectRoles=_AXObjectRoleMap.default;exports.AXObjectRoles=AXObjectRoles;var AXObjects=_AXObjectsMap.default;exports.AXObjects=AXObjects;var elementAXObjects=_elementAXObjectMap.default;exports.elementAXObjects=elementAXObjects;});unwrapExports(lib$1);var lib_1$1=lib$1.elementAXObjects;var lib_2$1=lib$1.AXObjects;var lib_3$1=lib$1.AXObjectRoles;var lib_4$1=lib$1.AXObjectElements;const roles=[...lib_3.keys()];const non_interactive_roles=new Set(roles.filter(name=>{const role=lib_3.get(name);return!lib_3.get(name).abstract&&// 'toolbar' does not descend from widget, but it does support\n// aria-activedescendant, thus in practice we treat it as a widget.\nname!=='toolbar'&&!role.superClass.some(classes=>classes.includes('widget'));}).concat(// The `progressbar` is descended from `widget`, but in practice, its\n// value is always `readonly`, so we treat it as a non-interactive role.\n'progressbar'));const interactive_roles=new Set(roles.filter(name=>{const role=lib_3.get(name);return!role.abstract&&// The `progressbar` is descended from `widget`, but in practice, its\n// value is always `readonly`, so we treat it as a non-interactive role.\nname!=='progressbar'&&role.superClass.some(classes=>classes.includes('widget'));}).concat(// 'toolbar' does not descend from widget, but it does support\n// aria-activedescendant, thus in practice we treat it as a widget.\n'toolbar'));function is_non_interactive_roles(role){return non_interactive_roles.has(role);}function is_interactive_roles(role){return interactive_roles.has(role);}const presentation_roles=new Set(['presentation','none']);function is_presentation_role(role){return presentation_roles.has(role);}function is_hidden_from_screen_reader(tag_name,attribute_map){var _a;if(tag_name==='input'){const type=(_a=attribute_map.get('type'))===null||_a===void 0?void 0:_a.get_static_value();if(type&&type==='hidden'){return true;}}const aria_hidden=attribute_map.get('aria-hidden');if(!aria_hidden)return false;if(!aria_hidden.is_static)return true;const aria_hidden_value=aria_hidden.get_static_value();return aria_hidden_value===true||aria_hidden_value==='true';}const non_interactive_element_role_schemas=[];lib_2.entries().forEach(_ref14=>{let[schema,roles]=_ref14;if([...roles].every(role=>non_interactive_roles.has(role))){non_interactive_element_role_schemas.push(schema);}});const interactive_element_role_schemas=[];lib_2.entries().forEach(_ref15=>{let[schema,roles]=_ref15;if([...roles].every(role=>interactive_roles.has(role))){interactive_element_role_schemas.push(schema);}});const interactive_ax_objects=new Set([...lib_2$1.keys()].filter(name=>lib_2$1.get(name).type==='widget'));const interactive_element_ax_object_schemas=[];lib_1$1.entries().forEach(_ref16=>{let[schema,ax_object]=_ref16;if([...ax_object].every(role=>interactive_ax_objects.has(role))){interactive_element_ax_object_schemas.push(schema);}});function match_schema(schema,tag_name,attribute_map){if(schema.name!==tag_name)return false;if(!schema.attributes)return true;return schema.attributes.every(schema_attribute=>{const attribute=attribute_map.get(schema_attribute.name);if(!attribute)return false;if(schema_attribute.value&&schema_attribute.value!==attribute.get_static_value()){return false;}return true;});}function is_interactive_element(tag_name,attribute_map){if(interactive_element_role_schemas.some(schema=>match_schema(schema,tag_name,attribute_map))){return true;}if(non_interactive_element_role_schemas.some(schema=>match_schema(schema,tag_name,attribute_map))){return false;}if(interactive_element_ax_object_schemas.some(schema=>match_schema(schema,tag_name,attribute_map))){return true;}return false;}function is_semantic_role_element(role,tag_name,attribute_map){for(const[schema,ax_object]of lib_1$1.entries()){if(schema.name===tag_name&&(!schema.attributes||schema.attributes.every(attr=>attribute_map.has(attr.name)&&attribute_map.get(attr.name).get_static_value()===attr.value))){for(const name of ax_object){const roles=lib_3$1.get(name);if(roles){for(const{name}of roles){if(name===role){return true;}}}}}}return false;}const aria_attributes='activedescendant atomic autocomplete busy checked colcount colindex colspan controls current describedby description details disabled dropeffect errormessage expanded flowto grabbed haspopup hidden invalid keyshortcuts label labelledby level live modal multiline multiselectable orientation owns placeholder posinset pressed readonly relevant required roledescription rowcount rowindex rowspan selected setsize sort valuemax valuemin valuenow valuetext'.split(' ');const aria_attribute_set=new Set(aria_attributes);const aria_roles=lib_3.keys();const aria_role_set=new Set(aria_roles);const aria_role_abstract_set=new Set(lib_3.keys().filter(role=>lib_3.get(role).abstract));const a11y_required_attributes={a:['href'],area:['alt','aria-label','aria-labelledby'],// html-has-lang\nhtml:['lang'],// iframe-has-title\niframe:['title'],img:['alt'],object:['title','aria-label','aria-labelledby']};const a11y_distracting_elements=new Set(['blink','marquee']);const a11y_required_content=new Set([// anchor-has-content\n'a',// heading-has-content\n'h1','h2','h3','h4','h5','h6']);const a11y_labelable=new Set(['button','input','keygen','meter','output','progress','select','textarea']);const a11y_nested_implicit_semantics=new Map([['header','banner'],['footer','contentinfo']]);const a11y_implicit_semantics=new Map([['a','link'],['aside','complementary'],['body','document'],['datalist','listbox'],['dd','definition'],['dfn','term'],['details','group'],['dt','term'],['fieldset','group'],['form','form'],['h1','heading'],['h2','heading'],['h3','heading'],['h4','heading'],['h5','heading'],['h6','heading'],['hr','separator'],['li','listitem'],['menu','list'],['nav','navigation'],['ol','list'],['optgroup','group'],['output','status'],['progress','progressbar'],['section','region'],['summary','button'],['tbody','rowgroup'],['textarea','textbox'],['tfoot','rowgroup'],['thead','rowgroup'],['tr','row'],['ul','list']]);const invisible_elements=new Set(['meta','html','script','style']);const valid_modifiers$1=new Set(['preventDefault','stopPropagation','capture','once','passive','nonpassive','self','trusted']);const passive_events=new Set(['wheel','touchstart','touchmove','touchend','touchcancel']);const react_attributes=new Map([['className','class'],['htmlFor','for']]);const attributes_to_compact_whitespace=['class','style'];function is_parent(parent,elements){let check=false;while(parent){const parent_name=parent.name;if(elements.includes(parent_name)){check=true;break;}if(parent.type==='Element'){break;}parent=parent.parent;}return check;}function get_namespace(parent,element,explicit_namespace){const parent_element=parent.find_nearest(/^Element/);if(!parent_element){return explicit_namespace||(is_svg(element.name)?namespaces.svg:null);}if(parent_element.namespace!==namespaces.foreign){if(is_svg(element.name.toLowerCase()))return namespaces.svg;if(parent_element.name.toLowerCase()==='foreignobject')return null;}return parent_element.namespace;}function is_valid_aria_attribute_value(schema,value){switch(schema.type){case'boolean':return typeof value==='boolean';case'string':case'id':return typeof value==='string';case'tristate':return typeof value==='boolean'||value==='mixed';case'integer':case'number':return typeof value!=='boolean'&&isNaN(Number(value))===false;case'token':// single token\nreturn(schema.values||[]).indexOf(typeof value==='string'?value.toLowerCase():value)>-1;case'idlist':// if list of ids, split each\nreturn typeof value==='string'&&value.split(' ').every(id=>typeof id==='string');case'tokenlist':// if list of tokens, split each\nreturn typeof value==='string'&&value.split(' ').every(token=>(schema.values||[]).indexOf(token.toLowerCase())>-1);default:return false;}}const regex_any_repeated_whitespaces=/[\\s]+/g;const regex_heading_tags=/^h[1-6]$/;const regex_illegal_attribute_character=/(^[0-9-.])|[\\^$@%&#?!|()[\\]{}^*+~;]/;class Element extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.attributes=[];this.actions=[];this.bindings=[];this.classes=[];this.styles=[];this.handlers=[];this.lets=[];this.intro=null;this.outro=null;this.animation=null;this.name=info.name;if(info.name==='svelte:element'){if(typeof info.tag!=='string'){this.tag_expr=new Expression(component,this,scope,info.tag);}else{this.tag_expr=new Expression(component,this,scope,string_literal(info.tag));}}else{this.tag_expr=new Expression(component,this,scope,string_literal(this.name));}this.namespace=get_namespace(parent,this,component.namespace);if(this.namespace!==namespaces.foreign){if(this.name==='pre'||this.name==='textarea'){const first=info.children[0];if(first&&first.type==='Text'){// The leading newline character needs to be stripped because of a qirk,\n// it is ignored by browsers if the tag and its contents are set through\n// innerHTML (NOT if set through the innerHTML of the tag or dynamically).\n// Therefore strip it here but add it back in the appropriate\n// places if there's another newline afterwards.\n// see https://html.spec.whatwg.org/multipage/syntax.html#element-restrictions\n// see https://html.spec.whatwg.org/multipage/grouping-content.html#the-pre-element\nfirst.data=first.data.replace(regex_starts_with_newline,'');}}if(this.name==='textarea'){if(info.children.length>0){const value_attribute=info.attributes.find(node=>node.name==='value');if(value_attribute){component.error(value_attribute,compiler_errors.textarea_duplicate_value);return;}// this is an egregious hack, but it's the easiest way to get <textarea>\n// children treated the same way as a value attribute\ninfo.attributes.push({type:'Attribute',name:'value',value:info.children});info.children=[];}}if(this.name==='option'){// Special case — treat these the same way:\n//   <option>{foo}</option>\n//   <option value={foo}>{foo}</option>\nconst value_attribute=info.attributes.find(attribute=>attribute.name==='value');if(!value_attribute){info.attributes.push({type:'Attribute',name:'value',value:info.children,synthetic:true});}}}const has_let=info.attributes.some(node=>node.type==='Let');if(has_let){scope=scope.child();}// Binding relies on Attribute, defer its evaluation\nconst order=['Binding'];// everything else is -1\ninfo.attributes.sort((a,b)=>order.indexOf(a.type)-order.indexOf(b.type));info.attributes.forEach(node=>{switch(node.type){case'Action':this.actions.push(new Action(component,this,scope,node));break;case'Attribute':case'Spread':// special case\nif(node.name==='xmlns')this.namespace=node.value[0].data;this.attributes.push(new Attribute(component,this,scope,node));break;case'Binding':this.bindings.push(new Binding(component,this,scope,node));break;case'Class':this.classes.push(new Class(component,this,scope,node));break;case'StyleDirective':this.styles.push(new StyleDirective(component,this,scope,node));break;case'EventHandler':this.handlers.push(new EventHandler(component,this,scope,node));break;case'Let':{const l=new Let(component,this,scope,node);this.lets.push(l);const dependencies=new Set([l.name.name]);l.names.forEach(name=>{scope.add(name,dependencies,this);});break;}case'Transition':{const transition=new Transition(component,this,scope,node);if(node.intro)this.intro=transition;if(node.outro)this.outro=transition;break;}case'Animation':this.animation=new Animation(component,this,scope,node);break;default:throw new Error(`Not implemented: ${node.type}`);}});this.scope=scope;this.children=map_children(component,this,this.scope,info.children);this.validate();this.optimise();component.apply_stylesheet(this);}get is_dynamic_element(){return this.name==='svelte:element';}validate(){if(this.component.var_lookup.has(this.name)&&this.component.var_lookup.get(this.name).imported&&!is_svg(this.name)&&!is_html(this.name)){this.component.warn(this,compiler_warnings.component_name_lowercase(this.name));}this.validate_attributes();this.validate_event_handlers();if(this.namespace===namespaces.foreign){this.validate_bindings_foreign();}else{this.validate_attributes_a11y();this.validate_special_cases();this.validate_bindings();this.validate_content();}}validate_attributes(){const{component,parent}=this;this.attributes.forEach(attribute=>{if(attribute.is_spread)return;const name=attribute.name.toLowerCase();// Errors\nif(regex_illegal_attribute_character.test(name)){return component.error(attribute,compiler_errors.illegal_attribute(name));}if(name==='slot'){if(!attribute.is_static){return component.error(attribute,compiler_errors.invalid_slot_attribute);}if(component.slot_outlets.has(name)){return component.error(attribute,compiler_errors.duplicate_slot_attribute(name));// this code was unreachable. Still needed?\n// component.slot_outlets.add(name);\n}if(!(parent.type==='SlotTemplate'||within_custom_element(parent))){return component.error(attribute,compiler_errors.invalid_slotted_content);}}// Warnings\nif(this.namespace!==namespaces.foreign){if(name==='is'){component.warn(attribute,compiler_warnings.avoid_is);}if(react_attributes.has(attribute.name)){component.warn(attribute,compiler_warnings.invalid_html_attribute(attribute.name,react_attributes.get(attribute.name)));}}});}validate_attributes_a11y(){var _a;const{component,attributes,handlers}=this;const attribute_map=new Map();const handlers_map=new Map();attributes.forEach(attribute=>attribute_map.set(attribute.name,attribute));handlers.forEach(handler=>handlers_map.set(handler.name,handler));attributes.forEach(attribute=>{if(attribute.is_spread)return;const name=attribute.name.toLowerCase();// aria-props\nif(name.startsWith('aria-')){if(invisible_elements.has(this.name)){// aria-unsupported-elements\ncomponent.warn(attribute,compiler_warnings.a11y_aria_attributes(this.name));}const type=name.slice(5);if(!aria_attribute_set.has(type)){const match=fuzzymatch(type,aria_attributes);component.warn(attribute,compiler_warnings.a11y_unknown_aria_attribute(type,match));}if(name==='aria-hidden'&&regex_heading_tags.test(this.name)){component.warn(attribute,compiler_warnings.a11y_hidden(this.name));}// aria-proptypes\nlet value=attribute.get_static_value();if(value==='true')value=true;if(value==='false')value=false;if(value!==null&&value!==undefined&&lib_5.has(name)){const schema=lib_5.get(name);if(!is_valid_aria_attribute_value(schema,value)){component.warn(attribute,compiler_warnings.a11y_incorrect_attribute_type(schema,name));}}}// aria-role\nif(name==='role'){if(invisible_elements.has(this.name)){// aria-unsupported-elements\ncomponent.warn(attribute,compiler_warnings.a11y_misplaced_role(this.name));}const value=attribute.get_static_value();if(value&&aria_role_abstract_set.has(value)){component.warn(attribute,compiler_warnings.a11y_no_abstract_role(value));}else if(value&&!aria_role_set.has(value)){const match=fuzzymatch(value,aria_roles);component.warn(attribute,compiler_warnings.a11y_unknown_role(value,match));}// no-redundant-roles\nconst has_redundant_role=value===a11y_implicit_semantics.get(this.name);if(this.name===value||has_redundant_role){component.warn(attribute,compiler_warnings.a11y_no_redundant_roles(value));}// Footers and headers are special cases, and should not have redundant roles unless they are the children of sections or articles.\nconst is_parent_section_or_article=is_parent(this.parent,['section','article']);if(!is_parent_section_or_article){const has_nested_redundant_role=value===a11y_nested_implicit_semantics.get(this.name);if(has_nested_redundant_role){component.warn(attribute,compiler_warnings.a11y_no_redundant_roles(value));}}// role-has-required-aria-props\nif(!is_semantic_role_element(value,this.name,attribute_map)){const role=lib_3.get(value);if(role){const required_role_props=Object.keys(role.requiredProps);const has_missing_props=required_role_props.some(prop=>!attributes.find(a=>a.name===prop));if(has_missing_props){component.warn(attribute,compiler_warnings.a11y_role_has_required_aria_props(value,required_role_props));}}}// no-interactive-element-to-noninteractive-role\nif(is_interactive_element(this.name,attribute_map)&&(is_non_interactive_roles(value)||is_presentation_role(value))){component.warn(this,compiler_warnings.a11y_no_interactive_element_to_noninteractive_role(value,this.name));}}// no-access-key\nif(name==='accesskey'){component.warn(attribute,compiler_warnings.a11y_accesskey);}// no-autofocus\nif(name==='autofocus'){component.warn(attribute,compiler_warnings.a11y_autofocus);}// scope\nif(name==='scope'&&this.name!=='th'){component.warn(attribute,compiler_warnings.a11y_misplaced_scope);}// tabindex-no-positive\nif(name==='tabindex'){const value=attribute.get_static_value();// @ts-ignore todo is tabindex=true correct case?\nif(!isNaN(value)&&+value>0){component.warn(attribute,compiler_warnings.a11y_positive_tabindex);}}});// click-events-have-key-events\nif(handlers_map.has('click')){const role=attribute_map.get('role');const is_non_presentation_role=(role===null||role===void 0?void 0:role.is_static)&&!is_presentation_role(role.get_static_value());if(!is_hidden_from_screen_reader(this.name,attribute_map)&&(!role||is_non_presentation_role)&&!is_interactive_element(this.name,attribute_map)&&!this.attributes.find(attr=>attr.is_spread)){const has_key_event=handlers_map.has('keydown')||handlers_map.has('keyup')||handlers_map.has('keypress');if(!has_key_event){component.warn(this,compiler_warnings.a11y_click_events_have_key_events());}}}// no-noninteractive-tabindex\nif(!is_interactive_element(this.name,attribute_map)&&!is_interactive_roles((_a=attribute_map.get('role'))===null||_a===void 0?void 0:_a.get_static_value())){const tab_index=attribute_map.get('tabindex');if(tab_index&&(!tab_index.is_static||Number(tab_index.get_static_value())>=0)){component.warn(this,compiler_warnings.a11y_no_noninteractive_tabindex);}}}validate_special_cases(){const{component,attributes,handlers}=this;const attribute_map=new Map();const handlers_map=new Map();attributes.forEach(attribute=>attribute_map.set(attribute.name,attribute));handlers.forEach(handler=>handlers_map.set(handler.name,handler));if(this.name==='a'){const href_attribute=attribute_map.get('href')||attribute_map.get('xlink:href');const id_attribute=attribute_map.get('id');const name_attribute=attribute_map.get('name');const target_attribute=attribute_map.get('target');if(target_attribute&&target_attribute.get_static_value()==='_blank'&&href_attribute){const href_static_value=href_attribute.get_static_value()?href_attribute.get_static_value().toLowerCase():null;if(href_static_value===null||href_static_value.match(/^(https?:)?\\/\\//i)){const rel=attribute_map.get('rel');const rel_values=rel?rel.get_static_value().split(' '):[];const expected_values=['noreferrer'];expected_values.forEach(expected_value=>{if(!rel||rel&&rel_values.indexOf(expected_value)<0){component.warn(this,{code:`security-anchor-rel-${expected_value}`,message:`Security: Anchor with \"target=_blank\" should have rel attribute containing the value \"${expected_value}\"`});}});}}if(href_attribute){const href_value=href_attribute.get_static_value();if(href_value===''||href_value==='#'||/^\\W*javascript:/i.test(href_value)){component.warn(href_attribute,compiler_warnings.a11y_invalid_attribute(href_attribute.name,href_value));}}else{const id_attribute_valid=id_attribute&&id_attribute.get_static_value()!=='';const name_attribute_valid=name_attribute&&name_attribute.get_static_value()!=='';if(!id_attribute_valid&&!name_attribute_valid){component.warn(this,compiler_warnings.a11y_missing_attribute('a','an','href'));}}}else{const required_attributes=a11y_required_attributes[this.name];if(required_attributes){const has_attribute=required_attributes.some(name=>attribute_map.has(name));if(!has_attribute){should_have_attribute(this,required_attributes);}}}if(this.name==='input'){const type=attribute_map.get('type');if(type&&type.get_static_value()==='image'){const required_attributes=['alt','aria-label','aria-labelledby'];const has_attribute=required_attributes.some(name=>attribute_map.has(name));if(!has_attribute){should_have_attribute(this,required_attributes,'input type=\"image\"');}}}if(this.name==='img'){const alt_attribute=attribute_map.get('alt');const aria_hidden_attribute=attribute_map.get('aria-hidden');const aria_hidden_exist=aria_hidden_attribute&&aria_hidden_attribute.get_static_value();if(alt_attribute&&!aria_hidden_exist){const alt_value=alt_attribute.get_static_value();if(/\\b(image|picture|photo)\\b/i.test(alt_value)){component.warn(this,compiler_warnings.a11y_img_redundant_alt);}}}if(this.name==='label'){const has_input_child=children=>{if(children.some(child=>child instanceof Element&&(a11y_labelable.has(child.name)||child.name==='slot'))){return true;}for(const child of children){if(!('children'in child)||child.children.length===0){continue;}if(has_input_child(child.children)){return true;}}return false;};if(!attribute_map.has('for')&&!has_input_child(this.children)){component.warn(this,compiler_warnings.a11y_label_has_associated_control);}}if(this.name==='video'){if(attribute_map.has('muted')){return;}let has_caption;const track=this.children.find(i=>i.name==='track');if(track){has_caption=track.attributes.find(a=>a.name==='kind'&&a.get_static_value()==='captions');}if(!has_caption){component.warn(this,compiler_warnings.a11y_media_has_caption);}}if(a11y_distracting_elements.has(this.name)){// no-distracting-elements\ncomponent.warn(this,compiler_warnings.a11y_distracting_elements(this.name));}if(this.name==='figcaption'){let{parent}=this;let is_figure_parent=false;while(parent){if(parent.name==='figure'){is_figure_parent=true;break;}if(parent.type==='Element'){break;}parent=parent.parent;}if(!is_figure_parent){component.warn(this,compiler_warnings.a11y_structure_immediate);}}if(this.name==='figure'){const children=this.children.filter(node=>{if(node.type==='Comment')return false;if(node.type==='Text')return regex_non_whitespace_character.test(node.data);return true;});const index=children.findIndex(child=>child.name==='figcaption');if(index!==-1&&index!==0&&index!==children.length-1){component.warn(children[index],compiler_warnings.a11y_structure_first_or_last);}}if(handlers_map.has('mouseover')&&!handlers_map.has('focus')){component.warn(this,compiler_warnings.a11y_mouse_events_have_key_events('mouseover','focus'));}if(handlers_map.has('mouseout')&&!handlers_map.has('blur')){component.warn(this,compiler_warnings.a11y_mouse_events_have_key_events('mouseout','blur'));}}validate_bindings_foreign(){this.bindings.forEach(binding=>{if(binding.name!=='this'){return this.component.error(binding,compiler_errors.invalid_binding_foreign(binding.name));}});}validate_bindings(){const{component}=this;const check_type_attribute=()=>{const attribute=this.attributes.find(attribute=>attribute.name==='type');if(!attribute)return null;if(!attribute.is_static){return component.error(attribute,compiler_errors.invalid_type);}const value=attribute.get_static_value();if(value===true){return component.error(attribute,compiler_errors.missing_type);}return value;};this.bindings.forEach(binding=>{const{name}=binding;if(name==='value'){if(this.name!=='input'&&this.name!=='textarea'&&this.name!=='select'){return component.error(binding,compiler_errors.invalid_binding_elements(this.name,'value'));}if(this.name==='select'){const attribute=this.attributes.find(attribute=>attribute.name==='multiple');if(attribute&&!attribute.is_static){return component.error(attribute,compiler_errors.dynamic_multiple_attribute);}}else{check_type_attribute();}}else if(name==='checked'||name==='indeterminate'){if(this.name!=='input'){return component.error(binding,compiler_errors.invalid_binding_elements(this.name,name));}const type=check_type_attribute();if(type!=='checkbox'){return component.error(binding,compiler_errors.invalid_binding_no_checkbox(name,type==='radio'));}}else if(name==='group'){if(this.name!=='input'){return component.error(binding,compiler_errors.invalid_binding_elements(this.name,'group'));}const type=check_type_attribute();if(type!=='checkbox'&&type!=='radio'){return component.error(binding,compiler_errors.invalid_binding_element_with('<input type=\"checkbox\"> or <input type=\"radio\">','group'));}}else if(name==='files'){if(this.name!=='input'){return component.error(binding,compiler_errors.invalid_binding_elements(this.name,'files'));}const type=check_type_attribute();if(type!=='file'){return component.error(binding,compiler_errors.invalid_binding_element_with('<input type=\"file\">','files'));}}else if(name==='open'){if(this.name!=='details'){return component.error(binding,compiler_errors.invalid_binding_element_with('<details>',name));}}else if(name==='currentTime'||name==='duration'||name==='paused'||name==='buffered'||name==='seekable'||name==='played'||name==='volume'||name==='muted'||name==='playbackRate'||name==='seeking'||name==='ended'){if(this.name!=='audio'&&this.name!=='video'){return component.error(binding,compiler_errors.invalid_binding_element_with('audio> or <video>',name));}}else if(name==='videoHeight'||name==='videoWidth'){if(this.name!=='video'){return component.error(binding,compiler_errors.invalid_binding_element_with('<video>',name));}}else if(regex_dimensions.test(name)){if(this.name==='svg'&&(name==='offsetWidth'||name==='offsetHeight')){return component.error(binding,compiler_errors.invalid_binding_on(binding.name,`<svg>. Use '${name.replace('offset','client')}' instead`));}else if(is_svg(this.name)){return component.error(binding,compiler_errors.invalid_binding_on(binding.name,'SVG elements'));}else if(is_void(this.name)){return component.error(binding,compiler_errors.invalid_binding_on(binding.name,`void elements like <${this.name}>. Use a wrapper element instead`));}}else if(name==='textContent'||name==='innerHTML'){const contenteditable=this.attributes.find(attribute=>attribute.name==='contenteditable');if(!contenteditable){return component.error(binding,compiler_errors.missing_contenteditable_attribute);}else if(contenteditable&&!contenteditable.is_static){return component.error(contenteditable,compiler_errors.dynamic_contenteditable_attribute);}}else if(name!=='this'){return component.error(binding,compiler_errors.invalid_binding(binding.name));}});}validate_content(){if(!a11y_required_content.has(this.name))return;if(this.bindings.some(binding=>['textContent','innerHTML'].includes(binding.name)))return;if(this.children.length===0){this.component.warn(this,compiler_warnings.a11y_missing_content(this.name));}}validate_event_handlers(){const{component}=this;this.handlers.forEach(handler=>{if(handler.modifiers.has('passive')&&handler.modifiers.has('preventDefault')){return component.error(handler,compiler_errors.invalid_event_modifier_combination('passive','preventDefault'));}if(handler.modifiers.has('passive')&&handler.modifiers.has('nonpassive')){return component.error(handler,compiler_errors.invalid_event_modifier_combination('passive','nonpassive'));}handler.modifiers.forEach(modifier=>{if(!valid_modifiers$1.has(modifier)){return component.error(handler,compiler_errors.invalid_event_modifier(list$1(Array.from(valid_modifiers$1))));}if(modifier==='passive'){if(passive_events.has(handler.name)){if(handler.can_make_passive){component.warn(handler,compiler_warnings.redundant_event_modifier_for_touch);}}else{component.warn(handler,compiler_warnings.redundant_event_modifier_passive);}}if(component.compile_options.legacy&&(modifier==='once'||modifier==='passive')){// TODO this could be supported, but it would need a few changes to\n// how event listeners work\nreturn component.error(handler,compiler_errors.invalid_event_modifier_legacy(modifier));}});if(passive_events.has(handler.name)&&handler.can_make_passive&&!handler.modifiers.has('preventDefault')&&!handler.modifiers.has('nonpassive')){// touch/wheel events should be passive by default\nhandler.modifiers.add('passive');}});}is_media_node(){return this.name==='audio'||this.name==='video';}add_css_class(){if(this.attributes.some(attr=>attr.is_spread)){this.needs_manual_style_scoping=true;return;}const{id}=this.component.stylesheet;const class_attribute=this.attributes.find(a=>a.name==='class');if(class_attribute&&!class_attribute.is_true){if(class_attribute.chunks.length===1&&class_attribute.chunks[0].type==='Text'){class_attribute.chunks[0].data+=` ${id}`;}else{class_attribute.chunks.push(new Text(this.component,this,this.scope,{type:'Text',data:` ${id}`,synthetic:true}));}}else{this.attributes.push(new Attribute(this.component,this,this.scope,{type:'Attribute',name:'class',value:[{type:'Text',data:id,synthetic:true}]}));}}get slot_template_name(){return this.attributes.find(attribute=>attribute.name==='slot').get_static_value();}optimise(){attributes_to_compact_whitespace.forEach(attribute_name=>{const attribute=this.attributes.find(a=>a.name===attribute_name);if(attribute&&!attribute.is_true){attribute.chunks.forEach((chunk,index)=>{if(chunk.type==='Text'){let data=chunk.data.replace(regex_any_repeated_whitespaces,' ');if(index===0){data=data.trimLeft();}else if(index===attribute.chunks.length-1){data=data.trimRight();}chunk.data=data;}});}});}}const regex_starts_with_vovel=/^[aeiou]/;function should_have_attribute(node,attributes){let name=arguments.length>2&&arguments[2]!==undefined?arguments[2]:node.name;const article=regex_starts_with_vovel.test(attributes[0])?'an':'a';const sequence=attributes.length>1?attributes.slice(0,-1).join(', ')+` or ${attributes[attributes.length-1]}`:attributes[0];node.component.warn(node,compiler_warnings.a11y_missing_attribute(name,article,sequence));}const regex_minus_sign=/-/;function within_custom_element(parent){while(parent){if(parent.type==='InlineComponent')return false;if(parent.type==='Element'&&regex_minus_sign.test(parent.name))return true;parent=parent.parent;}return false;}// https://github.com/darkskyapp/string-hash/blob/master/index.js\nconst regex_return_characters=/\\r/g;function hash(str){str=str.replace(regex_return_characters,'');let hash=5381;let i=str.length;while(i--)hash=(hash<<5)-hash^str.charCodeAt(i);return(hash>>>0).toString(36);}class Head extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);if(info.attributes.length){component.error(info.attributes[0],compiler_errors.invalid_attribute_head);return;}this.children=map_children(component,parent,scope,info.children.filter(child=>{return child.type!=='Text'||regex_non_whitespace_character.test(child.data);}));if(this.children.length>0){this.id=`svelte-${hash(this.component.source.slice(this.start,this.end))}`;}}}class IfBlock extends AbstractBlock{constructor(component,parent,scope,info){super(component,parent,scope,info);this.scope=scope.child();this.expression=new Expression(component,this,this.scope,info.expression);[this.const_tags,this.children]=get_const_tags(info.children,component,this,this);this.else=info.else?new ElseBlock(component,this,scope,info.else):null;this.warn_if_empty_block();}}class InlineComponent extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.attributes=[];this.bindings=[];this.handlers=[];this.lets=[];this.css_custom_properties=[];if(info.name!=='svelte:component'&&info.name!=='svelte:self'){const name=info.name.split('.')[0];// accommodate namespaces\ncomponent.warn_if_undefined(name,info,scope);component.add_reference(this,name);}this.name=info.name;this.namespace=get_namespace$1(parent,component.namespace);this.expression=this.name==='svelte:component'?new Expression(component,this,scope,info.expression):null;info.attributes.forEach(node=>{/* eslint-disable no-fallthrough */switch(node.type){case'Action':return component.error(node,compiler_errors.invalid_action);case'Attribute':if(node.name.startsWith('--')){this.css_custom_properties.push(new Attribute(component,this,scope,node));break;}// fallthrough\ncase'Spread':this.attributes.push(new Attribute(component,this,scope,node));break;case'Binding':this.bindings.push(new Binding(component,this,scope,node));break;case'Class':return component.error(node,compiler_errors.invalid_class);case'EventHandler':this.handlers.push(new EventHandler(component,this,scope,node));break;case'Let':this.lets.push(new Let(component,this,scope,node));break;case'Transition':return component.error(node,compiler_errors.invalid_transition);case'StyleDirective':return component.error(node,compiler_errors.invalid_component_style_directive);default:throw new Error(`Not implemented: ${node.type}`);}/* eslint-enable no-fallthrough */});if(this.lets.length>0){this.scope=scope.child();this.lets.forEach(l=>{const dependencies=new Set([l.name.name]);l.names.forEach(name=>{this.scope.add(name,dependencies,this);});});}else{this.scope=scope;}this.handlers.forEach(handler=>{handler.modifiers.forEach(modifier=>{if(modifier!=='once'){return component.error(handler,compiler_errors.invalid_event_modifier_component);}});});const children=[];for(let i=info.children.length-1;i>=0;i--){const child=info.children[i];if(child.type==='SlotTemplate'){children.push(child);info.children.splice(i,1);}else if((child.type==='Element'||child.type==='InlineComponent'||child.type==='Slot')&&child.attributes.find(attribute=>attribute.name==='slot')){const slot_template={start:child.start,end:child.end,type:'SlotTemplate',name:'svelte:fragment',attributes:[],children:[child]};// transfer attributes\nfor(let i=child.attributes.length-1;i>=0;i--){const attribute=child.attributes[i];if(attribute.type==='Let'){slot_template.attributes.push(attribute);child.attributes.splice(i,1);}else if(attribute.type==='Attribute'&&attribute.name==='slot'){slot_template.attributes.push(attribute);}}// transfer const\nfor(let i=child.children.length-1;i>=0;i--){const child_child=child.children[i];if(child_child.type==='ConstTag'){slot_template.children.push(child_child);child.children.splice(i,1);}}children.push(slot_template);info.children.splice(i,1);}}if(info.children.some(node=>not_whitespace_text(node))){children.push({start:info.start,end:info.end,type:'SlotTemplate',name:'svelte:fragment',attributes:[],children:info.children});}this.children=map_children(component,this,this.scope,children);}get slot_template_name(){return this.attributes.find(attribute=>attribute.name==='slot').get_static_value();}}function not_whitespace_text(node){return!(node.type==='Text'&&regex_only_whitespaces.test(node.data));}function get_namespace$1(parent,explicit_namespace){const parent_element=parent.find_nearest(/^Element/);if(!parent_element){return explicit_namespace;}return parent_element.namespace;}class KeyBlock extends AbstractBlock{constructor(component,parent,scope,info){super(component,parent,scope,info);this.expression=new Expression(component,this,scope,info.expression);this.children=map_children(component,this,scope,info.children);this.warn_if_empty_block();}}class Tag extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.expression=new Expression(component,this,scope,info.expression);this.should_cache=info.expression.type!=='Identifier'||this.expression.dependencies.size&&scope.names.has(info.expression.name);}}class MustacheTag extends Tag{}class Options extends Node$1{}class RawMustacheTag extends Tag{}class DebugTag extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.expressions=info.identifiers.map(node=>{return new Expression(component,parent,scope,node);});}}class Slot extends Element{constructor(component,parent,scope,info){super(component,parent,scope,info);this.values=new Map();info.attributes.forEach(attr=>{if(attr.type!=='Attribute'&&attr.type!=='Spread'){return component.error(attr,compiler_errors.invalid_slot_directive);}if(attr.name==='name'){if(attr.value.length!==1||attr.value[0].type!=='Text'){return component.error(attr,compiler_errors.dynamic_slot_name);}this.slot_name=attr.value[0].data;if(this.slot_name==='default'){return component.error(attr,compiler_errors.invalid_slot_name);}}this.values.set(attr.name,new Attribute(component,this,scope,attr));});if(!this.slot_name)this.slot_name='default';if(this.slot_name==='default'){// if this is the default slot, add our dependencies to any\n// other slots (which inherit our slot values) that were\n// previously encountered\ncomponent.slots.forEach(slot=>{this.values.forEach((attribute,name)=>{if(!slot.values.has(name)){slot.values.set(name,attribute);}});});}else if(component.slots.has('default')){// otherwise, go the other way — inherit values from\n// a previously encountered default slot\nconst default_slot=component.slots.get('default');default_slot.values.forEach((attribute,name)=>{if(!this.values.has(name)){this.values.set(name,attribute);}});}component.slots.set(this.slot_name,this);}}class SlotTemplate extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.lets=[];this.slot_template_name='default';this.validate_slot_template_placement();scope=scope.child();info.attributes.forEach(node=>{switch(node.type){case'Let':{const l=new Let(component,this,scope,node);this.lets.push(l);const dependencies=new Set([l.name.name]);l.names.forEach(name=>{scope.add(name,dependencies,this);});break;}case'Attribute':{if(node.name==='slot'){this.slot_attribute=new Attribute(component,this,scope,node);if(!this.slot_attribute.is_static){return component.error(node,compiler_errors.invalid_slot_attribute);}const value=this.slot_attribute.get_static_value();if(typeof value==='boolean'){return component.error(node,compiler_errors.invalid_slot_attribute_value_missing);}this.slot_template_name=value;break;}throw new Error(`Invalid attribute '${node.name}' in <svelte:fragment>`);}default:throw new Error(`Not implemented: ${node.type}`);}});this.scope=scope;[this.const_tags,this.children]=get_const_tags(info.children,component,this,this);}validate_slot_template_placement(){if(this.parent.type!=='InlineComponent'){return this.component.error(this,compiler_errors.invalid_slotted_content_fragment);}}}class Title extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.children=map_children(component,parent,scope,info.children);if(info.attributes.length>0){component.error(info.attributes[0],compiler_errors.illegal_attribute_title);return;}info.children.forEach(child=>{if(child.type!=='Text'&&child.type!=='MustacheTag'){return component.error(child,compiler_errors.illegal_structure_title);}});this.should_cache=info.children.length===1?info.children[0].type!=='Identifier'||scope.names.has(info.children[0].name):true;}}const valid_bindings=['innerWidth','innerHeight','outerWidth','outerHeight','scrollX','scrollY','online'];class Window extends Node$1{constructor(component,parent,scope,info){super(component,parent,scope,info);this.handlers=[];this.bindings=[];this.actions=[];info.attributes.forEach(node=>{if(node.type==='EventHandler'){this.handlers.push(new EventHandler(component,this,scope,node));}else if(node.type==='Binding'){if(node.expression.type!=='Identifier'){const{parts}=flatten_reference(node.expression);// TODO is this constraint necessary?\nreturn component.error(node.expression,compiler_errors.invalid_binding_window(parts));}if(!~valid_bindings.indexOf(node.name)){const match=node.name==='width'?'innerWidth':node.name==='height'?'innerHeight':fuzzymatch(node.name,valid_bindings);if(match){return component.error(node,compiler_errors.invalid_binding_on(node.name,'<svelte:window>',` (did you mean '${match}'?)`));}else{return component.error(node,compiler_errors.invalid_binding_on(node.name,'<svelte:window>',` — valid bindings are ${list$1(valid_bindings)}`));}}this.bindings.push(new Binding(component,this,scope,node));}else if(node.type==='Action'){this.actions.push(new Action(component,this,scope,node));}});}}/**\n * Pushes all `items` into `array` using `push`, therefore mutating the array.\n * We do this for memory and perf reasons, and because `array.push(...items)` would\n * run into a \"max call stack size exceeded\" error with too many items (~65k).\n * @param array\n * @param items\n */function push_array$1(array,items){for(let i=0;i<items.length;i++){array.push(items[i]);}}function get_constructor(type){switch(type){case'AwaitBlock':return AwaitBlock;case'Body':return Body;case'Comment':return Comment$1;case'ConstTag':return ConstTag;case'EachBlock':return EachBlock;case'Element':return Element;case'Head':return Head;case'IfBlock':return IfBlock;case'InlineComponent':return InlineComponent;case'KeyBlock':return KeyBlock;case'MustacheTag':return MustacheTag;case'Options':return Options;case'RawMustacheTag':return RawMustacheTag;case'DebugTag':return DebugTag;case'Slot':return Slot;case'SlotTemplate':return SlotTemplate;case'Text':return Text;case'Title':return Title;case'Window':return Window;default:throw new Error(`Not implemented: ${type}`);}}function map_children(component,parent,scope,children){let last=null;let ignores=[];return children.map(child=>{const constructor=get_constructor(child.type);const use_ignores=child.type!=='Text'&&child.type!=='Comment'&&ignores.length;if(use_ignores)component.push_ignores(ignores);const node=new constructor(component,parent,scope,child);if(use_ignores)component.pop_ignores(),ignores=[];if(node.type==='Comment'&&node.ignores.length){push_array$1(ignores,node.ignores);}if(last)last.next=node;node.prev=last;last=node;return node;});}function check_graph_for_cycles(edges){const graph=edges.reduce((g,edge)=>{const[u,v]=edge;if(!g.has(u))g.set(u,[]);if(!g.has(v))g.set(v,[]);g.get(u).push(v);return g;},new Map());const visited=new Set();const on_stack=new Set();const cycles=[];function visit(v){visited.add(v);on_stack.add(v);graph.get(v).forEach(w=>{if(!visited.has(w)){visit(w);}else if(on_stack.has(w)){cycles.push([...on_stack,w]);}});on_stack.delete(v);}graph.forEach((_,v)=>{if(!visited.has(v)){visit(v);}});return cycles[0];}function get_const_tags(children,component,node,parent){const const_tags=[];const others=[];for(const child of children){if(child.type==='ConstTag'){const_tags.push(child);}else{others.push(child);}}const consts_nodes=const_tags.map(tag=>new ConstTag(component,node,node.scope,tag));const sorted_consts_nodes=sort_consts_nodes(consts_nodes,component);sorted_consts_nodes.forEach(node=>node.parse_expression());const children_nodes=map_children(component,parent,node.scope,others);return[sorted_consts_nodes,children_nodes];}function sort_consts_nodes(consts_nodes,component){const sorted_consts_nodes=[];const unsorted_consts_nodes=consts_nodes.map(node=>{return{assignees:node.assignees,dependencies:node.dependencies,node};});const lookup=new Map();unsorted_consts_nodes.forEach(node=>{node.assignees.forEach(name=>{if(!lookup.has(name)){lookup.set(name,[]);}lookup.get(name).push(node);});});const cycle=check_graph_for_cycles(unsorted_consts_nodes.reduce((acc,node)=>{node.assignees.forEach(v=>{node.dependencies.forEach(w=>{if(!node.assignees.has(w)){acc.push([v,w]);}});});return acc;},[]));if(cycle&&cycle.length){const nodeList=lookup.get(cycle[0]);const node=nodeList[0];component.error(node.node,compiler_errors.cyclical_const_tags(cycle));}const add_node=node=>{if(sorted_consts_nodes.includes(node))return;node.dependencies.forEach(name=>{if(node.assignees.has(name))return;const earlier_nodes=lookup.get(name);if(earlier_nodes){earlier_nodes.forEach(add_node);}});sorted_consts_nodes.push(node);};unsorted_consts_nodes.forEach(add_node);return sorted_consts_nodes.map(node=>node.node);}class ThenBlock extends AbstractBlock{constructor(component,parent,scope,info){super(component,parent,scope,info);this.scope=scope.child();if(parent.then_node){parent.then_contexts.forEach(context=>{this.scope.add(context.key.name,parent.expression.dependencies,this);});}[this.const_tags,this.children]=get_const_tags(info.children,component,this,parent);if(!info.skip){this.warn_if_empty_block();}}}function add_const_tags(block,const_tags,ctx){const const_tags_props=[];const_tags.forEach((const_tag,i)=>{const name=`#constants_${i}`;const_tags_props.push(b`const ${name} = ${const_tag.expression.manipulate(block,ctx)}`);const_tag.contexts.forEach(context=>{const_tags_props.push(b`${ctx}[${block.renderer.context_lookup.get(context.key.name).index}] = ${context.default_modifier(context.modifier({type:'Identifier',name}),name=>block.renderer.context_lookup.has(name)?x`${ctx}[${block.renderer.context_lookup.get(name).index}]`:{type:'Identifier',name})};`);});});return const_tags_props;}function add_const_tags_context(renderer,const_tags){const_tags.forEach(const_tag=>{const_tag.contexts.forEach(context=>{renderer.add_to_context(context.key.name,true);});});}class AwaitBlockBranch extends Wrapper{constructor(status,renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.var=null;this.status=status;this.block=block.child({comment:create_debugging_comment(node,this.renderer.component),name:this.renderer.component.get_unique_name(`create_${status}_block`),type:status});this.add_context(parent.node[status+'_node'],parent.node[status+'_contexts']);this.fragment=new FragmentWrapper(renderer,this.block,this.node.children,parent,strip_whitespace,next_sibling);this.is_dynamic=this.block.dependencies.size>0;}add_context(node,contexts){if(!node)return;if(node.type==='Identifier'){this.value=node.name;this.renderer.add_to_context(this.value,true);}else{contexts.forEach(context=>{this.renderer.add_to_context(context.key.name,true);});this.value=this.block.parent.get_unique_name('value').name;this.value_contexts=contexts;this.renderer.add_to_context(this.value,true);this.is_destructured=true;}this.value_index=this.renderer.context_lookup.get(this.value).index;if(this.has_consts(this.node)){add_const_tags_context(this.renderer,this.node.const_tags);}}has_consts(node){return node instanceof ThenBlock||node instanceof CatchBlock;}render(block,parent_node,parent_nodes){this.fragment.render(block,parent_node,parent_nodes);if(this.is_destructured||this.has_consts(this.node)&&this.node.const_tags.length>0){this.render_get_context();}}render_get_context(){const props=this.is_destructured?this.value_contexts.map(prop=>b`#ctx[${this.block.renderer.context_lookup.get(prop.key.name).index}] = ${prop.default_modifier(prop.modifier(x`#ctx[${this.value_index}]`),name=>this.renderer.reference(name))};`):null;const const_tags_props=this.has_consts(this.node)?add_const_tags(this.block,this.node.const_tags,'#ctx'):null;const get_context=this.block.renderer.component.get_unique_name(`get_${this.status}_context`);this.block.renderer.blocks.push(b`\n\t\t\tfunction ${get_context}(#ctx) {\n\t\t\t\t${props}\n\t\t\t\t${const_tags_props}\n\t\t\t}\n\t\t`);this.block.chunks.declarations.push(b`${get_context}(#ctx)`);if(this.block.has_update_method){this.block.chunks.update.unshift(b`${get_context}(#ctx)`);}}}class AwaitBlockWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.var={type:'Identifier',name:'await_block'};this.cannot_use_innerhtml();this.not_static_content();block.add_dependencies(this.node.expression.dependencies);let is_dynamic=false;let has_intros=false;let has_outros=false;['pending','then','catch'].forEach(status=>{const child=this.node[status];const branch=new AwaitBlockBranch(status,renderer,block,this,child,strip_whitespace,next_sibling);renderer.blocks.push(branch.block);if(branch.is_dynamic){is_dynamic=true;// TODO should blocks update their own parents?\nblock.add_dependencies(branch.block.dependencies);}if(branch.block.has_intros)has_intros=true;if(branch.block.has_outros)has_outros=true;this[status]=branch;});['pending','then','catch'].forEach(status=>{this[status].block.has_update_method=is_dynamic;this[status].block.has_intro_method=has_intros;this[status].block.has_outro_method=has_outros;});if(has_outros){block.add_outro();}}render(block,parent_node,parent_nodes){const anchor=this.get_or_create_anchor(block,parent_node,parent_nodes);const update_mount_node=this.get_update_mount_node(anchor);const snippet=this.node.expression.manipulate(block);const info=block.get_unique_name('info');const promise=block.get_unique_name('promise');block.add_variable(promise);block.maintain_context=true;const info_props=x`{\n\t\t\tctx: #ctx,\n\t\t\tcurrent: null,\n\t\t\ttoken: null,\n\t\t\thasCatch: ${this.catch.node.start!==null?'true':'false'},\n\t\t\tpending: ${this.pending.block.name},\n\t\t\tthen: ${this.then.block.name},\n\t\t\tcatch: ${this.catch.block.name},\n\t\t\tvalue: ${this.then.value_index},\n\t\t\terror: ${this.catch.value_index},\n\t\t\tblocks: ${this.pending.block.has_outro_method&&x`[,,,]`}\n\t\t}`;block.chunks.init.push(b`\n\t\t\tlet ${info} = ${info_props};\n\t\t`);block.chunks.init.push(b`\n\t\t\t@handle_promise(${promise} = ${snippet}, ${info});\n\t\t`);block.chunks.create.push(b`\n\t\t\t${info}.block.c();\n\t\t`);if(parent_nodes&&this.renderer.options.hydratable){block.chunks.claim.push(b`\n\t\t\t\t${info}.block.l(${parent_nodes});\n\t\t\t`);}const initial_mount_node=parent_node||'#target';const anchor_node=parent_node?'null':'#anchor';const has_transitions=this.pending.block.has_intro_method||this.pending.block.has_outro_method;block.chunks.mount.push(b`\n\t\t\t${info}.block.m(${initial_mount_node}, ${info}.anchor = ${anchor_node});\n\t\t\t${info}.mount = () => ${update_mount_node};\n\t\t\t${info}.anchor = ${anchor};\n\t\t`);if(has_transitions){block.chunks.intro.push(b`@transition_in(${info}.block);`);}const dependencies=this.node.expression.dynamic_dependencies();const update_await_block_branch=b`@update_await_block_branch(${info}, #ctx, #dirty)`;if(dependencies.length>0){const condition=x`\n\t\t\t\t${block.renderer.dirty(dependencies)} &&\n\t\t\t\t${promise} !== (${promise} = ${snippet}) &&\n\t\t\t\t@handle_promise(${promise}, ${info})`;block.chunks.update.push(b`${info}.ctx = #ctx;`);if(this.pending.block.has_update_method){block.chunks.update.push(b`\n\t\t\t\t\tif (${condition}) {\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t${update_await_block_branch}\n\t\t\t\t\t}\n\t\t\t\t`);}else{block.chunks.update.push(b`\n\t\t\t\t\t${condition}\n\t\t\t\t`);}}else{if(this.pending.block.has_update_method){block.chunks.update.push(b`\n\t\t\t\t\t${update_await_block_branch}\n\t\t\t\t`);}}if(this.pending.block.has_outro_method){block.chunks.outro.push(b`\n\t\t\t\tfor (let #i = 0; #i < 3; #i += 1) {\n\t\t\t\t\tconst block = ${info}.blocks[#i];\n\t\t\t\t\t@transition_out(block);\n\t\t\t\t}\n\t\t\t`);}block.chunks.destroy.push(b`\n\t\t\t${info}.block.d(${parent_node?null:'detaching'});\n\t\t\t${info}.token = null;\n\t\t\t${info} = null;\n\t\t`);[this.pending,this.then,this.catch].forEach(branch=>{branch.render(branch.block,null,x`#nodes`);});}}const TRUE=x`true`;const FALSE=x`false`;class EventHandlerWrapper{constructor(node,parent){this.node=node;this.parent=parent;if(!node.expression){this.parent.renderer.add_to_context(node.handler_name.name);this.parent.renderer.component.partly_hoisted.push(b`\n\t\t\t\tfunction ${node.handler_name.name}(event) {\n\t\t\t\t\t@bubble.call(this, $$self, event);\n\t\t\t\t}\n\t\t\t`);}}get_snippet(block){const snippet=this.node.expression?this.node.expression.manipulate(block):block.renderer.reference(this.node.handler_name);if(this.node.reassigned){block.maintain_context=true;return x`function () { if (@is_function(${snippet})) ${snippet}.apply(this, arguments); }`;}return snippet;}render(block,target){let snippet=this.get_snippet(block);if(this.node.modifiers.has('preventDefault'))snippet=x`@prevent_default(${snippet})`;if(this.node.modifiers.has('stopPropagation'))snippet=x`@stop_propagation(${snippet})`;if(this.node.modifiers.has('self'))snippet=x`@self(${snippet})`;if(this.node.modifiers.has('trusted'))snippet=x`@trusted(${snippet})`;const args=[];const opts=['nonpassive','passive','once','capture'].filter(mod=>this.node.modifiers.has(mod));if(opts.length){if(opts.length===1&&opts[0]==='capture'){args.push(TRUE);}else{args.push(x`{ ${opts.map(opt=>opt==='nonpassive'?p`passive: false`:p`${opt}: true`)} }`);}}else if(block.renderer.options.dev){args.push(FALSE);}if(block.renderer.options.dev){args.push(this.node.modifiers.has('preventDefault')?TRUE:FALSE);args.push(this.node.modifiers.has('stopPropagation')?TRUE:FALSE);}block.event_listeners.push(x`@listen(${target}, \"${this.node.name}\", ${snippet}, ${args})`);}}function add_event_handlers(block,target,handlers){handlers.forEach(handler=>add_event_handler(block,target,handler));}function add_event_handler(block,target,handler){handler.render(block,target);}function add_actions(block,target,actions){actions.forEach(action=>add_action(block,target,action));}const regex_invalid_variable_identifier_characters=/[^a-zA-Z0-9_$]/g;function add_action(block,target,action){const{expression,template_scope}=action;let snippet;let dependencies;if(expression){snippet=expression.manipulate(block);dependencies=expression.dynamic_dependencies();}const id=block.get_unique_name(`${action.name.replace(regex_invalid_variable_identifier_characters,'_')}_action`);block.add_variable(id);const[obj,...properties]=action.name.split('.');const fn=is_contextual(action.component,template_scope,obj)?block.renderer.reference(obj):obj;if(properties.length){const member_expression=properties.reduce((lhs,rhs)=>x`${lhs}.${rhs}`,fn);block.event_listeners.push(x`@action_destroyer(${id} = ${member_expression}(${target}, ${snippet}))`);}else{block.event_listeners.push(x`@action_destroyer(${id} = ${fn}.call(null, ${target}, ${snippet}))`);}if(dependencies&&dependencies.length>0){let condition=x`${id} && @is_function(${id}.update)`;if(dependencies.length>0){condition=x`${condition} && ${block.renderer.dirty(dependencies)}`;}block.chunks.update.push(b`if (${condition}) ${id}.update.call(null, ${snippet});`);}}class BodyWrapper extends Wrapper{constructor(renderer,block,parent,node){super(renderer,block,parent,node);this.handlers=this.node.handlers.map(handler=>new EventHandlerWrapper(handler,this));}render(block,_parent_node,_parent_nodes){add_event_handlers(block,x`@_document.body`,this.handlers);add_actions(block,x`@_document.body`,this.node.actions);}}class DebugTagWrapper extends Wrapper{constructor(renderer,block,parent,node,_strip_whitespace,_next_sibling){super(renderer,block,parent,node);}render(block,_parent_node,_parent_nodes){const{renderer}=this;const{component}=renderer;if(!renderer.options.dev)return;const{var_lookup}=component;const start=component.locate(this.node.start+1);const end={line:start.line,column:start.column+6};const loc={start,end};const debug={type:'DebuggerStatement',loc};if(this.node.expressions.length===0){// Debug all\nblock.chunks.create.push(debug);block.chunks.update.push(debug);}else{const log={type:'Identifier',name:'log',loc};const dependencies=new Set();this.node.expressions.forEach(expression=>{add_to_set(dependencies,expression.dependencies);});const contextual_identifiers=this.node.expressions.filter(e=>{const variable=var_lookup.get(e.node.name);return!(variable&&variable.hoistable);}).map(e=>e.node.name);const logged_identifiers=this.node.expressions.map(e=>p`${e.node.name}`);const debug_statements=b`\n\t\t\t\t${contextual_identifiers.map(name=>b`const ${name} = ${renderer.reference(name)};`)}\n\t\t\t\t@_console.${log}({ ${logged_identifiers} });\n\t\t\t\tdebugger;`;if(dependencies.size){const condition=renderer.dirty(Array.from(dependencies));block.chunks.update.push(b`\n\t\t\t\t\tif (${condition}) {\n\t\t\t\t\t\t${debug_statements}\n\t\t\t\t\t}\n\t\t\t\t`);}block.chunks.create.push(b`{\n\t\t\t\t${debug_statements}\n\t\t\t}`);}}}class ElseBlockWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.var=null;add_const_tags_context(renderer,this.node.const_tags);this.block=block.child({comment:create_debugging_comment(node,this.renderer.component),name:this.renderer.component.get_unique_name('create_else_block'),type:'else'});this.fragment=new FragmentWrapper(renderer,this.block,this.node.children,parent,strip_whitespace,next_sibling);this.is_dynamic=this.block.dependencies.size>0;}}class EachBlockWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.updates=[];this.var={type:'Identifier',name:'each'};this.cannot_use_innerhtml();this.not_static_content();const{dependencies}=node.expression;block.add_dependencies(dependencies);this.node.contexts.forEach(context=>{renderer.add_to_context(context.key.name,true);});add_const_tags_context(renderer,this.node.const_tags);this.block=block.child({comment:create_debugging_comment(this.node,this.renderer.component),name:renderer.component.get_unique_name('create_each_block'),type:'each',// @ts-ignore todo: probably error\nkey:node.key,bindings:new Map(block.bindings)});// TODO this seems messy\nthis.block.has_animation=this.node.has_animation;this.index_name=this.node.index?{type:'Identifier',name:this.node.index}:renderer.component.get_unique_name(`${this.node.context}_index`);const fixed_length=node.expression.node.type==='ArrayExpression'&&node.expression.node.elements.every(element=>element.type!=='SpreadElement')?node.expression.node.elements.length:null;// hack the sourcemap, so that if data is missing the bug\n// is easy to find\nlet c=this.node.start+2;while(renderer.component.source[c]!=='e')c+=1;const start=renderer.component.locate(c);const end={line:start.line,column:start.column+4};const length={type:'Identifier',name:'length',loc:{start,end}};const each_block_value=renderer.component.get_unique_name(`${this.var.name}_value`);const iterations=block.get_unique_name(`${this.var.name}_blocks`);renderer.add_to_context(each_block_value.name,true);renderer.add_to_context(this.index_name.name,true);this.vars={create_each_block:this.block.name,each_block_value,get_each_context:renderer.component.get_unique_name(`get_${this.var.name}_context`),iterations,// optimisation for array literal\nfixed_length,data_length:fixed_length===null?x`${each_block_value}.${length}`:fixed_length,view_length:fixed_length===null?x`${iterations}.length`:fixed_length};const object=get_object(node.expression.node);const store=object.type==='Identifier'&&object.name[0]==='$'?object.name.slice(1):null;node.contexts.forEach(prop=>{this.block.bindings.set(prop.key.name,{object:this.vars.each_block_value,property:this.index_name,modifier:prop.modifier,snippet:prop.modifier(x`${this.vars.each_block_value}[${this.index_name}]`),store});});if(this.node.index){this.block.get_unique_name(this.node.index);// this prevents name collisions (#1254)\n}renderer.blocks.push(this.block);this.fragment=new FragmentWrapper(renderer,this.block,node.children,this,strip_whitespace,next_sibling);if(this.node.else){this.else=new ElseBlockWrapper(renderer,block,this,this.node.else,strip_whitespace,next_sibling);renderer.blocks.push(this.else.block);if(this.else.is_dynamic){this.block.add_dependencies(this.else.block.dependencies);}}block.add_dependencies(this.block.dependencies);if(this.block.has_outros||this.else&&this.else.block.has_outros){block.add_outro();}}render(block,parent_node,parent_nodes){if(this.fragment.nodes.length===0)return;const{renderer}=this;const{component}=renderer;const needs_anchor=this.next?!this.next.is_dom_node():!parent_node||!this.parent.is_dom_node();const snippet=this.node.expression.manipulate(block);block.chunks.init.push(b`let ${this.vars.each_block_value} = ${snippet};`);if(this.renderer.options.dev){block.chunks.init.push(b`@validate_each_argument(${this.vars.each_block_value});`);}const initial_anchor_node={type:'Identifier',name:parent_node?'null':'#anchor'};const initial_mount_node=parent_node||{type:'Identifier',name:'#target'};const update_anchor_node=needs_anchor?block.get_unique_name(`${this.var.name}_anchor`):this.next&&this.next.var||{type:'Identifier',name:'null'};const update_mount_node=this.get_update_mount_node(update_anchor_node);const args={block,parent_node,parent_nodes,snippet,initial_anchor_node,initial_mount_node,update_anchor_node,update_mount_node};const all_dependencies=new Set(this.block.dependencies);// TODO should be dynamic deps only\nthis.node.expression.dynamic_dependencies().forEach(dependency=>{all_dependencies.add(dependency);});if(this.node.key){this.node.key.dynamic_dependencies().forEach(dependency=>{all_dependencies.add(dependency);});}this.dependencies=all_dependencies;if(this.node.key){this.render_keyed(args);}else{this.render_unkeyed(args);}if(this.block.has_intro_method||this.block.has_outro_method){block.chunks.intro.push(b`\n\t\t\t\tfor (let #i = 0; #i < ${this.vars.data_length}; #i += 1) {\n\t\t\t\t\t@transition_in(${this.vars.iterations}[#i]);\n\t\t\t\t}\n\t\t\t`);}if(needs_anchor){block.add_element(update_anchor_node,x`@empty()`,parent_nodes&&x`@empty()`,parent_node);}if(this.else){let else_ctx=x`#ctx`;if(this.else.node.const_tags.length>0){const get_ctx_name=this.renderer.component.get_unique_name('get_else_ctx');this.renderer.blocks.push(b`\n\t\t\t\t\tfunction ${get_ctx_name}(#ctx) {\n\t\t\t\t\t\tconst child_ctx = #ctx.slice();\n\t\t\t\t\t\t${add_const_tags(block,this.else.node.const_tags,'child_ctx')}\n\t\t\t\t\t\treturn child_ctx;\n\t\t\t\t\t}\n\t\t\t\t`);else_ctx=x`${get_ctx_name}(#ctx)`;}const each_block_else=component.get_unique_name(`${this.var.name}_else`);block.chunks.init.push(b`let ${each_block_else} = null;`);// TODO neaten this up... will end up with an empty line in the block\nblock.chunks.init.push(b`\n\t\t\t\tif (!${this.vars.data_length}) {\n\t\t\t\t\t${each_block_else} = ${this.else.block.name}(${else_ctx});\n\t\t\t\t}\n\t\t\t`);block.chunks.create.push(b`\n\t\t\t\tif (${each_block_else}) {\n\t\t\t\t\t${each_block_else}.c();\n\t\t\t\t}\n\t\t\t`);if(this.renderer.options.hydratable){block.chunks.claim.push(b`\n\t\t\t\t\tif (${each_block_else}) {\n\t\t\t\t\t\t${each_block_else}.l(${parent_nodes});\n\t\t\t\t\t}\n\t\t\t\t`);}block.chunks.mount.push(b`\n\t\t\t\tif (${each_block_else}) {\n\t\t\t\t\t${each_block_else}.m(${initial_mount_node}, ${initial_anchor_node});\n\t\t\t\t}\n\t\t\t`);const has_transitions=!!(this.else.block.has_intro_method||this.else.block.has_outro_method);const destroy_block_else=this.else.block.has_outro_method?b`\n\t\t\t\t\t@group_outros();\n\t\t\t\t\t@transition_out(${each_block_else}, 1, 1, () => {\n\t\t\t\t\t\t${each_block_else} = null;\n\t\t\t\t\t});\n\t\t\t\t\t@check_outros();`:b`\n\t\t\t\t\t${each_block_else}.d(1);\n\t\t\t\t\t${each_block_else} = null;`;if(this.else.block.has_update_method){this.updates.push(b`\n\t\t\t\t\tif (!${this.vars.data_length} && ${each_block_else}) {\n\t\t\t\t\t\t${each_block_else}.p(${else_ctx}, #dirty);\n\t\t\t\t\t} else if (!${this.vars.data_length}) {\n\t\t\t\t\t\t${each_block_else} = ${this.else.block.name}(${else_ctx});\n\t\t\t\t\t\t${each_block_else}.c();\n\t\t\t\t\t\t${has_transitions&&b`@transition_in(${each_block_else}, 1);`}\n\t\t\t\t\t\t${each_block_else}.m(${update_mount_node}, ${update_anchor_node});\n\t\t\t\t\t} else if (${each_block_else}) {\n\t\t\t\t\t\t${destroy_block_else};\n\t\t\t\t\t}\n\t\t\t\t`);}else{this.updates.push(b`\n\t\t\t\t\tif (${this.vars.data_length}) {\n\t\t\t\t\t\tif (${each_block_else}) {\n\t\t\t\t\t\t\t${destroy_block_else};\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (!${each_block_else}) {\n\t\t\t\t\t\t${each_block_else} = ${this.else.block.name}(${else_ctx});\n\t\t\t\t\t\t${each_block_else}.c();\n\t\t\t\t\t\t${has_transitions&&b`@transition_in(${each_block_else}, 1);`}\n\t\t\t\t\t\t${each_block_else}.m(${update_mount_node}, ${update_anchor_node});\n\t\t\t\t\t}\n\t\t\t\t`);}block.chunks.destroy.push(b`\n\t\t\t\tif (${each_block_else}) ${each_block_else}.d(${parent_node?'':'detaching'});\n\t\t\t`);}if(this.updates.length){block.chunks.update.push(b`\n\t\t\t\tif (${block.renderer.dirty(Array.from(all_dependencies))}) {\n\t\t\t\t\t${this.updates}\n\t\t\t\t}\n\t\t\t`);}this.fragment.render(this.block,null,x`#nodes`);if(this.else){this.else.fragment.render(this.else.block,null,x`#nodes`);}this.context_props=this.node.contexts.map(prop=>b`child_ctx[${renderer.context_lookup.get(prop.key.name).index}] = ${prop.default_modifier(prop.modifier(x`list[i]`),name=>renderer.context_lookup.has(name)?x`child_ctx[${renderer.context_lookup.get(name).index}]`:{type:'Identifier',name})};`);if(this.node.has_binding)this.context_props.push(b`child_ctx[${renderer.context_lookup.get(this.vars.each_block_value.name).index}] = list;`);if(this.node.has_binding||this.node.has_index_binding||this.node.index)this.context_props.push(b`child_ctx[${renderer.context_lookup.get(this.index_name.name).index}] = i;`);// TODO which is better — Object.create(array) or array.slice()?\nrenderer.blocks.push(b`\n\t\t\tfunction ${this.vars.get_each_context}(#ctx, list, i) {\n\t\t\t\tconst child_ctx = #ctx.slice();\n\t\t\t\t${this.context_props}\n\t\t\t\t${add_const_tags(this.block,this.node.const_tags,'child_ctx')}\n\t\t\t\treturn child_ctx;\n\t\t\t}\n\t\t`);}render_keyed(_ref17){let{block,parent_node,parent_nodes,snippet,initial_anchor_node,initial_mount_node,update_anchor_node,update_mount_node}=_ref17;const{create_each_block,iterations,data_length,view_length}=this.vars;const get_key=block.get_unique_name('get_key');const lookup=block.get_unique_name(`${this.var.name}_lookup`);block.add_variable(iterations,x`[]`);block.add_variable(lookup,x`new @_Map()`);if(this.fragment.nodes[0].is_dom_node()){this.block.first=this.fragment.nodes[0].var;}else{this.block.first=this.block.get_unique_name('first');this.block.add_element(this.block.first,x`@empty()`,parent_nodes&&x`@empty()`,null);}block.chunks.init.push(b`\n\t\t\tconst ${get_key} = #ctx => ${this.node.key.manipulate(block)};\n\n\t\t\t${this.renderer.options.dev&&b`@validate_each_keys(#ctx, ${this.vars.each_block_value}, ${this.vars.get_each_context}, ${get_key});`}\n\t\t\tfor (let #i = 0; #i < ${data_length}; #i += 1) {\n\t\t\t\tlet child_ctx = ${this.vars.get_each_context}(#ctx, ${this.vars.each_block_value}, #i);\n\t\t\t\tlet key = ${get_key}(child_ctx);\n\t\t\t\t${lookup}.set(key, ${iterations}[#i] = ${create_each_block}(key, child_ctx));\n\t\t\t}\n\t\t`);block.chunks.create.push(b`\n\t\t\tfor (let #i = 0; #i < ${view_length}; #i += 1) {\n\t\t\t\t${iterations}[#i].c();\n\t\t\t}\n\t\t`);if(parent_nodes&&this.renderer.options.hydratable){block.chunks.claim.push(b`\n\t\t\t\tfor (let #i = 0; #i < ${view_length}; #i += 1) {\n\t\t\t\t\t${iterations}[#i].l(${parent_nodes});\n\t\t\t\t}\n\t\t\t`);}block.chunks.mount.push(b`\n\t\t\tfor (let #i = 0; #i < ${view_length}; #i += 1) {\n\t\t\t\t${iterations}[#i].m(${initial_mount_node}, ${initial_anchor_node});\n\t\t\t}\n\t\t`);const dynamic=this.block.has_update_method;const destroy=this.node.has_animation?this.block.has_outros?'@fix_and_outro_and_destroy_block':'@fix_and_destroy_block':this.block.has_outros?'@outro_and_destroy_block':'@destroy_block';if(this.dependencies.size){this.block.maintain_context=true;this.updates.push(b`\n\t\t\t\t${this.vars.each_block_value} = ${snippet};\n\t\t\t\t${this.renderer.options.dev&&b`@validate_each_argument(${this.vars.each_block_value});`}\n\n\t\t\t\t${this.block.has_outros&&b`@group_outros();`}\n\t\t\t\t${this.node.has_animation&&b`for (let #i = 0; #i < ${view_length}; #i += 1) ${iterations}[#i].r();`}\n\t\t\t\t${this.renderer.options.dev&&b`@validate_each_keys(#ctx, ${this.vars.each_block_value}, ${this.vars.get_each_context}, ${get_key});`}\n\t\t\t\t${iterations} = @update_keyed_each(${iterations}, #dirty, ${get_key}, ${dynamic?1:0}, #ctx, ${this.vars.each_block_value}, ${lookup}, ${update_mount_node}, ${destroy}, ${create_each_block}, ${update_anchor_node}, ${this.vars.get_each_context});\n\t\t\t\t${this.node.has_animation&&b`for (let #i = 0; #i < ${view_length}; #i += 1) ${iterations}[#i].a();`}\n\t\t\t\t${this.block.has_outros&&b`@check_outros();`}\n\t\t\t`);}if(this.block.has_outros){block.chunks.outro.push(b`\n\t\t\t\tfor (let #i = 0; #i < ${view_length}; #i += 1) {\n\t\t\t\t\t@transition_out(${iterations}[#i]);\n\t\t\t\t}\n\t\t\t`);}block.chunks.destroy.push(b`\n\t\t\tfor (let #i = 0; #i < ${view_length}; #i += 1) {\n\t\t\t\t${iterations}[#i].d(${parent_node?null:'detaching'});\n\t\t\t}\n\t\t`);}render_unkeyed(_ref18){let{block,parent_nodes,snippet,initial_anchor_node,initial_mount_node,update_anchor_node,update_mount_node}=_ref18;const{create_each_block,iterations,fixed_length,data_length,view_length}=this.vars;block.chunks.init.push(b`\n\t\t\tlet ${iterations} = [];\n\n\t\t\tfor (let #i = 0; #i < ${data_length}; #i += 1) {\n\t\t\t\t${iterations}[#i] = ${create_each_block}(${this.vars.get_each_context}(#ctx, ${this.vars.each_block_value}, #i));\n\t\t\t}\n\t\t`);block.chunks.create.push(b`\n\t\t\tfor (let #i = 0; #i < ${view_length}; #i += 1) {\n\t\t\t\t${iterations}[#i].c();\n\t\t\t}\n\t\t`);if(parent_nodes&&this.renderer.options.hydratable){block.chunks.claim.push(b`\n\t\t\t\tfor (let #i = 0; #i < ${view_length}; #i += 1) {\n\t\t\t\t\t${iterations}[#i].l(${parent_nodes});\n\t\t\t\t}\n\t\t\t`);}block.chunks.mount.push(b`\n\t\t\tfor (let #i = 0; #i < ${view_length}; #i += 1) {\n\t\t\t\t${iterations}[#i].m(${initial_mount_node}, ${initial_anchor_node});\n\t\t\t}\n\t\t`);if(this.dependencies.size){const has_transitions=!!(this.block.has_intro_method||this.block.has_outro_method);const for_loop_body=this.block.has_update_method?b`\n\t\t\t\t\tif (${iterations}[#i]) {\n\t\t\t\t\t\t${iterations}[#i].p(child_ctx, #dirty);\n\t\t\t\t\t\t${has_transitions&&b`@transition_in(${this.vars.iterations}[#i], 1);`}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t${iterations}[#i] = ${create_each_block}(child_ctx);\n\t\t\t\t\t\t${iterations}[#i].c();\n\t\t\t\t\t\t${has_transitions&&b`@transition_in(${this.vars.iterations}[#i], 1);`}\n\t\t\t\t\t\t${iterations}[#i].m(${update_mount_node}, ${update_anchor_node});\n\t\t\t\t\t}\n\t\t\t\t`:has_transitions?b`\n\t\t\t\t\t\tif (${iterations}[#i]) {\n\t\t\t\t\t\t\t@transition_in(${this.vars.iterations}[#i], 1);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t${iterations}[#i] = ${create_each_block}(child_ctx);\n\t\t\t\t\t\t\t${iterations}[#i].c();\n\t\t\t\t\t\t\t@transition_in(${this.vars.iterations}[#i], 1);\n\t\t\t\t\t\t\t${iterations}[#i].m(${update_mount_node}, ${update_anchor_node});\n\t\t\t\t\t\t}\n\t\t\t\t\t`:b`\n\t\t\t\t\t\tif (!${iterations}[#i]) {\n\t\t\t\t\t\t\t${iterations}[#i] = ${create_each_block}(child_ctx);\n\t\t\t\t\t\t\t${iterations}[#i].c();\n\t\t\t\t\t\t\t${iterations}[#i].m(${update_mount_node}, ${update_anchor_node});\n\t\t\t\t\t\t}\n\t\t\t\t\t`;const start=this.block.has_update_method?0:'#old_length';let remove_old_blocks;if(this.block.has_outros){const out=block.get_unique_name('out');block.chunks.init.push(b`\n\t\t\t\t\tconst ${out} = i => @transition_out(${iterations}[i], 1, 1, () => {\n\t\t\t\t\t\t${iterations}[i] = null;\n\t\t\t\t\t});\n\t\t\t\t`);remove_old_blocks=b`\n\t\t\t\t\t@group_outros();\n\t\t\t\t\tfor (#i = ${data_length}; #i < ${view_length}; #i += 1) {\n\t\t\t\t\t\t${out}(#i);\n\t\t\t\t\t}\n\t\t\t\t\t@check_outros();\n\t\t\t\t`;}else{remove_old_blocks=b`\n\t\t\t\t\tfor (${this.block.has_update_method?null:x`#i = ${data_length}`}; #i < ${this.block.has_update_method?view_length:'#old_length'}; #i += 1) {\n\t\t\t\t\t\t${iterations}[#i].d(1);\n\t\t\t\t\t}\n\t\t\t\t\t${!fixed_length&&b`${view_length} = ${data_length};`}\n\t\t\t\t`;}// We declare `i` as block scoped here, as the `remove_old_blocks` code\n// may rely on continuing where this iteration stopped.\nconst update=b`\n\t\t\t\t${!this.block.has_update_method&&b`const #old_length = ${this.vars.each_block_value}.length;`}\n\t\t\t\t${this.vars.each_block_value} = ${snippet};\n\t\t\t\t${this.renderer.options.dev&&b`@validate_each_argument(${this.vars.each_block_value});`}\n\n\t\t\t\tlet #i;\n\t\t\t\tfor (#i = ${start}; #i < ${data_length}; #i += 1) {\n\t\t\t\t\tconst child_ctx = ${this.vars.get_each_context}(#ctx, ${this.vars.each_block_value}, #i);\n\n\t\t\t\t\t${for_loop_body}\n\t\t\t\t}\n\n\t\t\t\t${remove_old_blocks}\n\t\t\t`;this.updates.push(update);}if(this.block.has_outros){block.chunks.outro.push(b`\n\t\t\t\t${iterations} = ${iterations}.filter(@_Boolean);\n\t\t\t\tfor (let #i = 0; #i < ${view_length}; #i += 1) {\n\t\t\t\t\t@transition_out(${iterations}[#i]);\n\t\t\t\t}\n\t\t\t`);}block.chunks.destroy.push(b`@destroy_each(${iterations}, detaching);`);}}const regex_non_whitespace_characters$1=/[\\S\\u00A0]/;class TextWrapper extends Wrapper{constructor(renderer,block,parent,node,data){super(renderer,block,parent,node);this.skip=this.node.should_skip();this.data=data;this.var=this.skip?null:x`t`;}use_space(){if(this.renderer.component.component_options.preserveWhitespace)return false;if(regex_non_whitespace_characters$1.test(this.data))return false;return!this.node.within_pre();}render(block,parent_node,parent_nodes){if(this.skip)return;const use_space=this.use_space();const string_literal={type:'Literal',value:this.data,loc:{start:this.renderer.locate(this.node.start),end:this.renderer.locate(this.node.end)}};block.add_element(this.var,use_space?x`@space()`:x`@text(${string_literal})`,parent_nodes&&(use_space?x`@claim_space(${parent_nodes})`:x`@claim_text(${parent_nodes}, ${string_literal})`),parent_node);}}const svg_attributes='accent-height accumulate additive alignment-baseline allowReorder alphabetic amplitude arabic-form ascent attributeName attributeType autoReverse azimuth baseFrequency baseline-shift baseProfile bbox begin bias by calcMode cap-height class clip clipPathUnits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering contentScriptType contentStyleType cursor cx cy d decelerate descent diffuseConstant direction display divisor dominant-baseline dur dx dy edgeMode elevation enable-background end exponent externalResourcesRequired fill fill-opacity fill-rule filter filterRes filterUnits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight format from fr fx fy g1 g2 glyph-name glyph-orientation-horizontal glyph-orientation-vertical glyphRef gradientTransform gradientUnits hanging height href horiz-adv-x horiz-origin-x id ideographic image-rendering in in2 intercept k k1 k2 k3 k4 kernelMatrix kernelUnitLength kerning keyPoints keySplines keyTimes lang lengthAdjust letter-spacing lighting-color limitingConeAngle local marker-end marker-mid marker-start markerHeight markerUnits markerWidth mask maskContentUnits maskUnits mathematical max media method min mode name numOctaves offset onabort onactivate onbegin onclick onend onerror onfocusin onfocusout onload onmousedown onmousemove onmouseout onmouseover onmouseup onrepeat onresize onscroll onunload opacity operator order orient orientation origin overflow overline-position overline-thickness panose-1 paint-order pathLength patternContentUnits patternTransform patternUnits pointer-events points pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits r radius refX refY rendering-intent repeatCount repeatDur requiredExtensions requiredFeatures restart result rotate rx ry scale seed shape-rendering slope spacing specularConstant specularExponent speed spreadMethod startOffset stdDeviation stemh stemv stitchTiles stop-color stop-opacity strikethrough-position strikethrough-thickness string stroke stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width style surfaceScale systemLanguage tabindex tableValues target targetX targetY text-anchor text-decoration text-rendering textLength to transform type u1 u2 underline-position underline-thickness unicode unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical values version vert-adv-y vert-origin-x vert-origin-y viewBox viewTarget visibility width widths word-spacing writing-mode x x-height x1 x2 xChannelSelector xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type xml:base xml:lang xml:space y y1 y2 yChannelSelector z zoomAndPan'.split(' ');const svg_attribute_lookup=new Map();svg_attributes.forEach(name=>{svg_attribute_lookup.set(name.toLowerCase(),name);});function fix_attribute_casing(name){name=name.toLowerCase();return svg_attribute_lookup.get(name)||name;}function handle_select_value_binding(attr,dependencies){const{parent}=attr;if(parent.node.name==='select'){parent.select_binding_dependencies=dependencies;dependencies.forEach(prop=>{parent.renderer.component.indirect_dependencies.set(prop,new Set());});}}// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes=new Set(['allowfullscreen','allowpaymentrequest','async','autofocus','autoplay','checked','controls','default','defer','disabled','formnovalidate','hidden','inert','ismap','itemscope','loop','multiple','muted','nomodule','novalidate','open','playsinline','readonly','required','reversed','selected']);const non_textlike_input_types=new Set(['button','checkbox','color','date','datetime-local','file','hidden','image','radio','range','reset','submit']);class BaseAttributeWrapper{constructor(parent,block,node){this.node=node;this.parent=parent;if(node.dependencies.size>0){parent.cannot_use_innerhtml();parent.not_static_content();block.add_dependencies(node.dependencies);}}render(_block){}}const regex_minus_sign$1=/-/;const regex_invalid_variable_identifier_characters$1=/[^a-zA-Z_$]/g;class AttributeWrapper extends BaseAttributeWrapper{constructor(parent,block,node){super(parent,block,node);if(node.dependencies.size>0){// special case — <option value={foo}> — see below\nif(this.parent.node.name==='option'&&node.name==='value'){let select=this.parent;while(select&&(select.node.type!=='Element'||select.node.name!=='select')){// @ts-ignore todo: doublecheck this, but looks to be correct\nselect=select.parent;}if(select&&select.select_binding_dependencies){select.select_binding_dependencies.forEach(prop=>{this.node.dependencies.forEach(dependency=>{this.parent.renderer.component.indirect_dependencies.get(prop).add(dependency);});});}}if(node.name==='value'){handle_select_value_binding(this,node.dependencies);}}if(this.parent.node.namespace==namespaces.foreign){// leave attribute case alone for elements in the \"foreign\" namespace\nthis.name=this.node.name;this.metadata=this.get_metadata();this.is_indirectly_bound_value=false;this.property_name=null;this.is_select_value_attribute=false;this.is_input_value=false;}else{this.name=fix_attribute_casing(this.node.name);this.metadata=this.get_metadata();this.is_indirectly_bound_value=is_indirectly_bound_value(this);this.property_name=this.is_indirectly_bound_value?'__value':this.metadata&&this.metadata.property_name;this.is_select_value_attribute=this.name==='value'&&this.parent.node.name==='select';this.is_input_value=this.name==='value'&&this.parent.node.name==='input';}// TODO retire this exception in favour of https://github.com/sveltejs/svelte/issues/3750\nthis.is_src=this.name==='src'&&(!this.parent.node.namespace||this.parent.node.namespace===namespaces.html);this.should_cache=should_cache(this);}render(block){const element=this.parent;const{name,property_name,should_cache,is_indirectly_bound_value}=this;// xlink is a special case... we could maybe extend this to generic\n// namespaced attributes but I'm not sure that's applicable in\n// HTML5?\nconst method=regex_minus_sign$1.test(element.node.name)?'@set_custom_element_data':name.slice(0,6)==='xlink:'?'@xlink_attr':'@attr';const is_legacy_input_type=element.renderer.component.compile_options.legacy&&name==='type'&&this.parent.node.name==='input';const dependencies=this.get_dependencies();const value=this.get_value(block);let updater;const init=this.get_init(block,value);if(is_legacy_input_type){block.chunks.hydrate.push(b`@set_input_type(${element.var}, ${init});`);updater=b`@set_input_type(${element.var}, ${should_cache?this.last:value});`;}else if(this.is_select_value_attribute){// annoying special case\nconst is_multiple_select=element.node.get_static_attribute_value('multiple');if(is_multiple_select){updater=b`@select_options(${element.var}, ${value});`;}else{updater=b`@select_option(${element.var}, ${value});`;}block.chunks.mount.push(b`\n\t\t\t\t${updater}\n\t\t\t`);}else if(this.is_src){block.chunks.hydrate.push(b`if (!@src_url_equal(${element.var}.src, ${init})) ${method}(${element.var}, \"${name}\", ${this.last});`);updater=b`${method}(${element.var}, \"${name}\", ${should_cache?this.last:value});`;}else if(property_name){block.chunks.hydrate.push(b`${element.var}.${property_name} = ${init};`);updater=block.renderer.options.dev?b`@prop_dev(${element.var}, \"${property_name}\", ${should_cache?this.last:value});`:b`${element.var}.${property_name} = ${should_cache?this.last:value};`;}else{block.chunks.hydrate.push(b`${method}(${element.var}, \"${name}\", ${init});`);updater=b`${method}(${element.var}, \"${name}\", ${should_cache?this.last:value});`;}if(is_indirectly_bound_value){const update_value=b`${element.var}.value = ${element.var}.__value;`;block.chunks.hydrate.push(update_value);updater=b`\n\t\t\t\t${updater}\n\t\t\t\t${update_value};\n\t\t\t`;}if(dependencies.length>0){const condition=this.get_dom_update_conditions(block,block.renderer.dirty(dependencies));block.chunks.update.push(b`\n\t\t\t\tif (${condition}) {\n\t\t\t\t\t${updater}\n\t\t\t\t}`);}// special case – autofocus. has to be handled in a bit of a weird way\nif(name==='autofocus'){block.autofocus={element_var:element.var,condition_expression:this.node.is_true?undefined:value};}}get_init(block,value){this.last=this.should_cache&&block.get_unique_name(`${this.parent.var.name}_${this.name.replace(regex_invalid_variable_identifier_characters$1,'_')}_value`);if(this.should_cache)block.add_variable(this.last);return this.should_cache?x`${this.last} = ${value}`:value;}get_dom_update_conditions(block,dependency_condition){const{property_name,should_cache,last}=this;const element=this.parent;const value=this.get_value(block);let condition=dependency_condition;if(should_cache){condition=this.is_src?x`${condition} && (!@src_url_equal(${element.var}.src, (${last} = ${value})))`:x`${condition} && (${last} !== (${last} = ${value}))`;}if(this.is_input_value){const type=element.node.get_static_attribute_value('type');if(type!==true&&!non_textlike_input_types.has(type)){condition=x`${condition} && ${element.var}.${property_name} !== ${should_cache?last:value}`;}}if(block.has_outros){condition=x`!#current || ${condition}`;}return condition;}get_dependencies(){const node_dependencies=this.node.get_dependencies();const dependencies=new Set(node_dependencies);node_dependencies.forEach(prop=>{const indirect_dependencies=this.parent.renderer.component.indirect_dependencies.get(prop);if(indirect_dependencies){indirect_dependencies.forEach(indirect_dependency=>{dependencies.add(indirect_dependency);});}});return Array.from(dependencies);}get_metadata(){if(this.parent.node.namespace)return null;const metadata=attribute_lookup[this.name];if(metadata&&metadata.applies_to&&!metadata.applies_to.includes(this.parent.node.name))return null;return metadata;}get_value(block){if(this.node.is_true){if(this.metadata&&boolean_attributes.has(this.metadata.property_name.toLowerCase())){return x`true`;}return x`\"\"`;}if(this.node.chunks.length===0)return x`\"\"`;// TODO some of this code is repeated in Tag.ts — would be good to\n// DRY it out if that's possible without introducing crazy indirection\nif(this.node.chunks.length===1){return this.node.chunks[0].type==='Text'?string_literal(this.node.chunks[0].data):this.node.chunks[0].manipulate(block);}let value=this.node.name==='class'?this.get_class_name_text(block):this.render_chunks(block).reduce((lhs,rhs)=>x`${lhs} + ${rhs}`);// '{foo} {bar}' — treat as string concatenation\nif(this.node.chunks[0].type!=='Text'){value=x`\"\" + ${value}`;}return value;}get_class_name_text(block){const scoped_css=this.node.chunks.some(chunk=>chunk.synthetic);const rendered=this.render_chunks(block);if(scoped_css&&rendered.length===2){// we have a situation like class={possiblyUndefined}\nrendered[0]=x`@null_to_empty(${rendered[0]})`;}return rendered.reduce((lhs,rhs)=>x`${lhs} + ${rhs}`);}render_chunks(block){return this.node.chunks.map(chunk=>{if(chunk.type==='Text'){return string_literal(chunk.data);}return chunk.manipulate(block);});}stringify(){if(this.node.is_true)return'';const value=this.node.chunks;if(value.length===0)return'=\"\"';return`=\"${value.map(chunk=>{return chunk.type==='Text'?chunk.data.replace(regex_double_quotes,'\\\\\"'):`\\${${chunk.manipulate()}}`;}).join('')}\"`;}}// source: https://html.spec.whatwg.org/multipage/indices.html\nconst attribute_lookup={allowfullscreen:{property_name:'allowFullscreen',applies_to:['iframe']},allowpaymentrequest:{property_name:'allowPaymentRequest',applies_to:['iframe']},async:{applies_to:['script']},autofocus:{applies_to:['button','input','keygen','select','textarea']},autoplay:{applies_to:['audio','video']},checked:{applies_to:['input']},controls:{applies_to:['audio','video']},default:{applies_to:['track']},defer:{applies_to:['script']},disabled:{applies_to:['button','fieldset','input','keygen','optgroup','option','select','textarea']},formnovalidate:{property_name:'formNoValidate',applies_to:['button','input']},hidden:{},indeterminate:{applies_to:['input']},ismap:{property_name:'isMap',applies_to:['img']},loop:{applies_to:['audio','bgsound','video']},multiple:{applies_to:['input','select']},muted:{applies_to:['audio','video']},nomodule:{property_name:'noModule',applies_to:['script']},novalidate:{property_name:'noValidate',applies_to:['form']},open:{applies_to:['details','dialog']},playsinline:{property_name:'playsInline',applies_to:['video']},readonly:{property_name:'readOnly',applies_to:['input','textarea']},required:{applies_to:['input','select','textarea']},reversed:{applies_to:['ol']},selected:{applies_to:['option']},value:{applies_to:['button','option','input','li','meter','progress','param','select','textarea']}};Object.keys(attribute_lookup).forEach(name=>{const metadata=attribute_lookup[name];if(!metadata.property_name)metadata.property_name=name;});function should_cache(attribute){return attribute.is_src||attribute.node.should_cache();}const regex_contains_checked_or_group=/checked|group/;function is_indirectly_bound_value(attribute){const element=attribute.parent;return attribute.name==='value'&&(element.node.name==='option'||// TODO check it's actually bound\nelement.node.name==='input'&&element.node.bindings.some(binding=>regex_contains_checked_or_group.test(binding.name)));}class StyleAttributeWrapper extends AttributeWrapper{render(block){const style_props=optimize_style(this.node.chunks);if(!style_props)return super.render(block);style_props.forEach(prop=>{let value;if(is_dynamic$1(prop.value)){const prop_dependencies=new Set();value=prop.value.map(chunk=>{if(chunk.type==='Text'){return string_literal(chunk.data);}else{add_to_set(prop_dependencies,chunk.dynamic_dependencies());return chunk.manipulate(block);}}).reduce((lhs,rhs)=>x`${lhs} + ${rhs}`);// TODO is this necessary? style.setProperty always treats value as string, no?\n// if (prop.value.length === 1 || prop.value[0].type !== 'Text') {\n// \tvalue = x`\"\" + ${value}`;\n// }\nif(prop_dependencies.size){let condition=block.renderer.dirty(Array.from(prop_dependencies));if(block.has_outros){condition=x`!#current || ${condition}`;}const update=b`\n\t\t\t\t\t\tif (${condition}) {\n\t\t\t\t\t\t\t@set_style(${this.parent.var}, \"${prop.key}\", ${value}, ${prop.important?1:null});\n\t\t\t\t\t\t}`;block.chunks.update.push(update);}}else{value=string_literal(prop.value[0].data);}block.chunks.hydrate.push(b`@set_style(${this.parent.var}, \"${prop.key}\", ${value}, ${prop.important?1:null});`);});}}const regex_style_prop_key=/^\\s*([\\w-]+):\\s*/;function optimize_style(value){const props=[];let chunks=value.slice();while(chunks.length){const chunk=chunks[0];if(chunk.type!=='Text')return null;const key_match=regex_style_prop_key.exec(chunk.data);if(!key_match)return null;const key=key_match[1];const offset=key_match.index+key_match[0].length;const remaining_data=chunk.data.slice(offset);if(remaining_data){chunks[0]={start:chunk.start+offset,end:chunk.end,type:'Text',data:remaining_data};}else{chunks.shift();}const result=get_style_value(chunks);props.push({key,value:result.value,important:result.important});chunks=result.chunks;}return props;}const regex_important_flag=/\\s*!important\\s*$/;const regex_semicolon_or_whitespace=/[;\\s]/;function get_style_value(chunks){const value=[];let in_url=false;let quote_mark=null;let escaped=false;let closed=false;while(chunks.length&&!closed){const chunk=chunks.shift();if(chunk.type==='Text'){let c=0;while(c<chunk.data.length){const char=chunk.data[c];if(escaped){escaped=false;}else if(char==='\\\\'){escaped=true;}else if(char===quote_mark){quote_mark=null;}else if(char==='\"'||char===\"'\"){quote_mark=char;}else if(char===')'&&in_url){in_url=false;}else if(char==='u'&&chunk.data.slice(c,c+4)==='url('){in_url=true;}else if(char===';'&&!in_url&&!quote_mark){closed=true;break;}c+=1;}if(c>0){value.push({type:'Text',start:chunk.start,end:chunk.start+c,data:chunk.data.slice(0,c)});}while(regex_semicolon_or_whitespace.test(chunk.data[c]))c+=1;const remaining_data=chunk.data.slice(c);if(remaining_data){chunks.unshift({start:chunk.start+c,end:chunk.end,type:'Text',data:remaining_data});break;}}else{value.push(chunk);}}let important=false;const last_chunk=value[value.length-1];if(last_chunk&&last_chunk.type==='Text'&&regex_important_flag.test(last_chunk.data)){important=true;last_chunk.data=last_chunk.data.replace(regex_important_flag,'');if(!last_chunk.data)value.pop();}return{chunks,value,important};}function is_dynamic$1(value){return value.length>1||value[0].type!=='Text';}class SpreadAttributeWrapper extends BaseAttributeWrapper{}function mark_each_block_bindings(parent,binding){// we need to ensure that the each block creates a context including\n// the list and the index, if they're not otherwise referenced\nbinding.expression.references.forEach(name=>{const each_block=parent.node.scope.get_owner(name);if(each_block){each_block.has_binding=true;}});if(binding.name==='group'){const add_index_binding=name=>{const each_block=parent.node.scope.get_owner(name);if(each_block.type==='EachBlock'){each_block.has_index_binding=true;for(const dep of each_block.expression.contextual_dependencies){add_index_binding(dep);}}};// for `<input bind:group={} >`, we make sure that all the each blocks creates context with `index`\nfor(const name of binding.expression.contextual_dependencies){add_index_binding(name);}}}class BindingWrapper{constructor(block,node,parent){this.node=node;this.parent=parent;const{dependencies}=this.node.expression;block.add_dependencies(dependencies);// TODO does this also apply to e.g. `<input type='checkbox' bind:group='foo'>`?\nhandle_select_value_binding(this,dependencies);if(node.is_contextual){mark_each_block_bindings(this.parent,this.node);}this.object=get_object(this.node.expression.node).name;// view to model\nthis.handler=get_event_handler(this,parent.renderer,block,this.object,this.node.raw_expression);this.snippet=this.node.expression.manipulate(block);this.is_readonly=this.node.is_readonly;this.needs_lock=this.node.name==='currentTime';// TODO others?\n}get_dependencies(){const dependencies=new Set(this.node.expression.dependencies);this.node.expression.dependencies.forEach(prop=>{const indirect_dependencies=this.parent.renderer.component.indirect_dependencies.get(prop);if(indirect_dependencies){indirect_dependencies.forEach(indirect_dependency=>{dependencies.add(indirect_dependency);});}});return dependencies;}get_update_dependencies(){const object=this.object;const dependencies=new Set();if(this.node.expression.template_scope.names.has(object)){this.node.expression.template_scope.dependencies_for_name.get(object).forEach(name=>dependencies.add(name));}else{dependencies.add(object);}const result=new Set(dependencies);dependencies.forEach(dependency=>{const indirect_dependencies=this.parent.renderer.component.indirect_dependencies.get(dependency);if(indirect_dependencies){indirect_dependencies.forEach(indirect_dependency=>{result.add(indirect_dependency);});}});return result;}is_readonly_media_attribute(){return this.node.is_readonly_media_attribute();}render(block,lock){if(this.is_readonly)return;const{parent}=this;const update_conditions=this.needs_lock?[x`!${lock}`]:[];const mount_conditions=[];const dependency_array=Array.from(this.get_dependencies());if(dependency_array.length>0){update_conditions.push(block.renderer.dirty(dependency_array));}if(parent.node.name==='input'){const type=parent.node.get_static_attribute_value('type');if(type===null||type===''||type==='text'||type==='email'||type==='password'){update_conditions.push(x`${parent.var}.${this.node.name} !== ${this.snippet}`);}else if(type==='number'){update_conditions.push(x`@to_number(${parent.var}.${this.node.name}) !== ${this.snippet}`);}}// model to view\nlet update_dom=get_dom_updater(parent,this);let mount_dom=update_dom;// special cases\nswitch(this.node.name){case'group':{const{binding_group,is_context,contexts,index,keypath}=get_binding_group(parent.renderer,this.node,block);block.renderer.add_to_context('$$binding_groups');if(is_context&&!block.binding_group_initialised.has(keypath)){if(contexts.length>1){let binding_group=x`${block.renderer.reference('$$binding_groups')}[${index}]`;for(const name of contexts.slice(0,-1)){binding_group=x`${binding_group}[${block.renderer.reference(name)}]`;block.chunks.init.push(b`${binding_group} = ${binding_group} || [];`);}}block.chunks.init.push(b`${binding_group(true)} = [];`);block.binding_group_initialised.add(keypath);}block.chunks.hydrate.push(b`${binding_group(true)}.push(${parent.var});`);block.chunks.destroy.push(b`${binding_group(true)}.splice(${binding_group(true)}.indexOf(${parent.var}), 1);`);break;}case'textContent':update_conditions.push(x`${this.snippet} !== ${parent.var}.textContent`);mount_conditions.push(x`${this.snippet} !== void 0`);break;case'innerHTML':update_conditions.push(x`${this.snippet} !== ${parent.var}.innerHTML`);mount_conditions.push(x`${this.snippet} !== void 0`);break;case'currentTime':update_conditions.push(x`!@_isNaN(${this.snippet})`);mount_dom=null;break;case'playbackRate':case'volume':update_conditions.push(x`!@_isNaN(${this.snippet})`);mount_conditions.push(x`!@_isNaN(${this.snippet})`);break;case'paused':{// this is necessary to prevent audio restarting by itself\nconst last=block.get_unique_name(`${parent.var.name}_is_paused`);block.add_variable(last,x`true`);update_conditions.push(x`${last} !== (${last} = ${this.snippet})`);update_dom=b`${parent.var}[${last} ? \"pause\" : \"play\"]();`;mount_dom=null;break;}case'value':if(parent.node.get_static_attribute_value('type')==='file'){update_dom=null;mount_dom=null;}}if(update_dom){if(update_conditions.length>0){const condition=update_conditions.reduce((lhs,rhs)=>x`${lhs} && ${rhs}`);block.chunks.update.push(b`\n\t\t\t\t\tif (${condition}) {\n\t\t\t\t\t\t${update_dom}\n\t\t\t\t\t}\n\t\t\t\t`);}else{block.chunks.update.push(update_dom);}}if(mount_dom){if(mount_conditions.length>0){const condition=mount_conditions.reduce((lhs,rhs)=>x`${lhs} && ${rhs}`);block.chunks.mount.push(b`\n\t\t\t\t\tif (${condition}) {\n\t\t\t\t\t\t${mount_dom}\n\t\t\t\t\t}\n\t\t\t\t`);}else{block.chunks.mount.push(mount_dom);}}}}function get_dom_updater(element,binding){const{node}=element;if(binding.is_readonly_media_attribute()){return null;}if(binding.node.name==='this'){return null;}if(node.name==='select'){return node.get_static_attribute_value('multiple')===true?b`@select_options(${element.var}, ${binding.snippet})`:b`@select_option(${element.var}, ${binding.snippet})`;}if(binding.node.name==='group'){const type=node.get_static_attribute_value('type');const condition=type==='checkbox'?x`~${binding.snippet}.indexOf(${element.var}.__value)`:x`${element.var}.__value === ${binding.snippet}`;return b`${element.var}.checked = ${condition};`;}if(binding.node.name==='value'){return b`@set_input_value(${element.var}, ${binding.snippet});`;}return b`${element.var}.${binding.node.name} = ${binding.snippet};`;}function get_binding_group(renderer,value,block){const{parts}=flatten_reference(value.raw_expression);let keypath=parts.join('.');const contexts=[];const contextual_dependencies=new Set();const{template_scope}=value.expression;const add_contextual_dependency=dep=>{contextual_dependencies.add(dep);const owner=template_scope.get_owner(dep);if(owner.type==='EachBlock'){for(const dep of owner.expression.contextual_dependencies){add_contextual_dependency(dep);}}};for(const dep of value.expression.contextual_dependencies){add_contextual_dependency(dep);}for(const dep of contextual_dependencies){const context=block.bindings.get(dep);let key;let name;if(context){key=context.object.name;name=context.property.name;}else{key=dep;name=dep;}keypath=`${key}@${keypath}`;contexts.push(name);}if(!renderer.binding_groups.has(keypath)){const index=renderer.binding_groups.size;contexts.forEach(context=>{renderer.add_to_context(context,true);});renderer.binding_groups.set(keypath,{binding_group:function(){let to_reference=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;let binding_group='$$binding_groups';let _secondary_indexes=contexts;if(to_reference){binding_group=block.renderer.reference(binding_group);_secondary_indexes=_secondary_indexes.map(name=>block.renderer.reference(name));}if(_secondary_indexes.length>0){let obj=x`${binding_group}[${index}]`;_secondary_indexes.forEach(secondary_index=>{obj=x`${obj}[${secondary_index}]`;});return obj;}else{return x`${binding_group}[${index}]`;}},is_context:contexts.length>0,contexts,index,keypath});}return renderer.binding_groups.get(keypath);}function get_event_handler(binding,renderer,block,name,lhs){const contextual_dependencies=new Set(binding.node.expression.contextual_dependencies);const context=block.bindings.get(name);let set_store;if(context){const{object,property,store,snippet}=context;lhs=replace_object(lhs,snippet);contextual_dependencies.add(object.name);contextual_dependencies.add(property.name);contextual_dependencies.delete(name);if(store){set_store=b`${store}.set(${`$${store}`});`;}}else{const object=get_object(lhs);if(object.name[0]==='$'){const store=object.name.slice(1);set_store=b`${store}.set(${object.name});`;}}const value=get_value_from_dom(renderer,binding.parent,binding,block,contextual_dependencies);const mutation=b`\n\t\t${lhs} = ${value};\n\t\t${set_store}\n\t`;return{uses_context:binding.node.is_contextual||binding.node.expression.uses_context,mutation,contextual_dependencies,lhs};}function get_value_from_dom(renderer,element,binding,block,contextual_dependencies){const{node}=element;const{name}=binding.node;if(name==='this'){return x`$$value`;}// <select bind:value='selected>\nif(node.name==='select'){return node.get_static_attribute_value('multiple')===true?x`@select_multiple_value(this)`:x`@select_value(this)`;}const type=node.get_static_attribute_value('type');// <input type='checkbox' bind:group='foo'>\nif(name==='group'){if(type==='checkbox'){const{binding_group,contexts}=get_binding_group(renderer,binding.node,block);add_to_set(contextual_dependencies,contexts);return x`@get_binding_group_value(${binding_group()}, this.__value, this.checked)`;}return x`this.__value`;}// <input type='range|number' bind:value>\nif(type==='range'||type==='number'){return x`@to_number(this.${name})`;}if(name==='buffered'||name==='seekable'||name==='played'){return x`@time_ranges_to_array(this.${name})`;}// everything else\nreturn x`this.${name}`;}function compare_node(a,b){if(a===b)return true;if(!a||!b)return false;if(a.type!==b.type)return false;switch(a.type){case'Identifier':return a.name===b.name;case'MemberExpression':return compare_node(a.object,b.object)&&compare_node(a.property,b.property)&&a.computed===b.computed;case'Literal':return a.value===b.value;}}function bind_this(component,block,binding,variable){const fn=component.get_unique_name(`${variable.name}_binding`);block.renderer.add_to_context(fn.name);const callee=block.renderer.reference(fn.name);const{contextual_dependencies,mutation}=binding.handler;const dependencies=binding.get_update_dependencies();const body=b`\n\t\t${mutation}\n\t\t${Array.from(dependencies).filter(dep=>dep[0]!=='$').filter(dep=>!contextual_dependencies.has(dep)).map(dep=>b`${block.renderer.invalidate(dep)};`)}\n\t`;if(contextual_dependencies.size){const params=Array.from(contextual_dependencies).map(name=>({type:'Identifier',name}));component.partly_hoisted.push(b`\n\t\t\tfunction ${fn}($$value, ${params}) {\n\t\t\t\t@binding_callbacks[$$value ? 'unshift' : 'push'](() => {\n\t\t\t\t\t${body}\n\t\t\t\t});\n\t\t\t}\n\t\t`);const alias_map=new Map();const args=[];for(let id of params){const value=block.renderer.reference(id.name);let found=false;if(block.variables.has(id.name)){let alias=id.name;for(let i=1;block.variables.has(alias)&&!compare_node(block.variables.get(alias).init,value);alias=`${id.name}_${i++}`);alias_map.set(alias,id.name);id={type:'Identifier',name:alias};found=block.variables.has(alias);}args.push(id);if(!found){block.add_variable(id,value);}}const assign=block.get_unique_name(`assign_${variable.name}`);const unassign=block.get_unique_name(`unassign_${variable.name}`);block.chunks.init.push(b`\n\t\t\tconst ${assign} = () => ${callee}(${variable}, ${args});\n\t\t\tconst ${unassign} = () => ${callee}(null, ${args});\n\t\t`);const condition=Array.from(args).map(name=>x`${name} !== ${block.renderer.reference(alias_map.get(name.name)||name.name)}`).reduce((lhs,rhs)=>x`${lhs} || ${rhs}`);// we push unassign and unshift assign so that references are\n// nulled out before they're created, to avoid glitches\n// with shifting indices\nblock.chunks.update.push(b`\n\t\t\tif (${condition}) {\n\t\t\t\t${unassign}();\n\t\t\t\t${args.map(a=>b`${a} = ${block.renderer.reference(alias_map.get(a.name)||a.name)}`)};\n\t\t\t\t${assign}();\n\t\t\t}`);block.chunks.destroy.push(b`${unassign}();`);return b`${assign}();`;}component.partly_hoisted.push(b`\n\t\tfunction ${fn}($$value) {\n\t\t\t@binding_callbacks[$$value ? 'unshift' : 'push'](() => {\n\t\t\t\t${body}\n\t\t\t});\n\t\t}\n\t`);block.chunks.destroy.push(b`${callee}(null);`);return b`${callee}(${variable});`;}class Tag$1 extends Wrapper{constructor(renderer,block,parent,node){super(renderer,block,parent,node);this.cannot_use_innerhtml();if(!this.is_dependencies_static()){this.not_static_content();}block.add_dependencies(node.expression.dependencies);}is_dependencies_static(){return this.node.expression.contextual_dependencies.size===0&&this.node.expression.dynamic_dependencies().length===0;}rename_this_method(block,update){const dependencies=this.node.expression.dynamic_dependencies();let snippet=this.node.expression.manipulate(block);const value=this.node.should_cache&&block.get_unique_name(`${this.var.name}_value`);const content=this.node.should_cache?value:snippet;snippet=x`${snippet} + \"\"`;if(this.node.should_cache)block.add_variable(value,snippet);// TODO may need to coerce snippet to string\nif(dependencies.length>0){let condition=block.renderer.dirty(dependencies);if(block.has_outros){condition=x`!#current || ${condition}`;}const update_cached_value=x`${value} !== (${value} = ${snippet})`;if(this.node.should_cache){condition=x`${condition} && ${update_cached_value}`;}block.chunks.update.push(b`if (${condition}) ${update(content)}`);}return{init:content};}}class MustacheTagWrapper extends Tag$1{constructor(renderer,block,parent,node){super(renderer,block,parent,node);this.var={type:'Identifier',name:'t'};}render(block,parent_node,parent_nodes){const{init}=this.rename_this_method(block,value=>x`@set_data(${this.var}, ${value})`);block.add_element(this.var,x`@text(${init})`,parent_nodes&&x`@claim_text(${parent_nodes}, ${init})`,parent_node);}}class RawMustacheTagWrapper extends Tag$1{constructor(renderer,block,parent,node){super(renderer,block,parent,node);this.var={type:'Identifier',name:'raw'};this.cannot_use_innerhtml();this.not_static_content();}render(block,parent_node,_parent_nodes){const in_head=is_head(parent_node);const can_use_innerhtml=!in_head&&parent_node&&!this.prev&&!this.next;if(can_use_innerhtml){const insert=content=>b`${parent_node}.innerHTML = ${content};`[0];const{init}=this.rename_this_method(block,content=>insert(content));block.chunks.mount.push(insert(init));}else{const needs_anchor=in_head||(this.next?!this.next.is_dom_node():!this.parent||!this.parent.is_dom_node());const html_tag=block.get_unique_name('html_tag');const html_anchor=needs_anchor&&block.get_unique_name('html_anchor');block.add_variable(html_tag);const{init}=this.rename_this_method(block,content=>x`${html_tag}.p(${content})`);const update_anchor=needs_anchor?html_anchor:this.next?this.next.var:'null';const parent_element=this.node.find_nearest(/^Element/);const is_svg=parent_element&&parent_element.namespace===namespaces.svg;block.chunks.create.push(b`${html_tag} = new @HtmlTag(${is_svg?'true':'false'});`);if(this.renderer.options.hydratable){block.chunks.claim.push(b`${html_tag} = @claim_html_tag(${_parent_nodes}, ${is_svg?'true':'false'});`);}block.chunks.hydrate.push(b`${html_tag}.a = ${update_anchor};`);block.chunks.mount.push(b`${html_tag}.m(${init}, ${parent_node||'#target'}, ${parent_node?null:'#anchor'});`);if(needs_anchor){block.add_element(html_anchor,x`@empty()`,x`@empty()`,parent_node);}if(!parent_node||in_head){block.chunks.destroy.push(b`if (detaching) ${html_tag}.d();`);}}}}const regex_contains_radio_or_checkbox_or_file=/radio|checkbox|file/;const regex_contains_radio_or_checkbox_or_range_or_file=/radio|checkbox|range|file/;const events=[{event_names:['input'],filter:(node,_name)=>node.name==='textarea'||node.name==='input'&&!regex_contains_radio_or_checkbox_or_range_or_file.test(node.get_static_attribute_value('type'))},{event_names:['input'],filter:(node,name)=>(name==='textContent'||name==='innerHTML')&&node.attributes.some(attribute=>attribute.name==='contenteditable')},{event_names:['change'],filter:(node,_name)=>node.name==='select'||node.name==='input'&&regex_contains_radio_or_checkbox_or_file.test(node.get_static_attribute_value('type'))},{event_names:['change','input'],filter:(node,_name)=>node.name==='input'&&node.get_static_attribute_value('type')==='range'},{event_names:['elementresize'],filter:(_node,name)=>regex_dimensions.test(name)},// media events\n{event_names:['timeupdate'],filter:(node,name)=>node.is_media_node()&&(name==='currentTime'||name==='played'||name==='ended')},{event_names:['durationchange'],filter:(node,name)=>node.is_media_node()&&name==='duration'},{event_names:['play','pause'],filter:(node,name)=>node.is_media_node()&&name==='paused'},{event_names:['progress'],filter:(node,name)=>node.is_media_node()&&name==='buffered'},{event_names:['loadedmetadata'],filter:(node,name)=>node.is_media_node()&&(name==='buffered'||name==='seekable')},{event_names:['volumechange'],filter:(node,name)=>node.is_media_node()&&(name==='volume'||name==='muted')},{event_names:['ratechange'],filter:(node,name)=>node.is_media_node()&&name==='playbackRate'},{event_names:['seeking','seeked'],filter:(node,name)=>node.is_media_node()&&name==='seeking'},{event_names:['ended'],filter:(node,name)=>node.is_media_node()&&name==='ended'},{event_names:['resize'],filter:(node,name)=>node.is_media_node()&&(name==='videoHeight'||name==='videoWidth')},// details event\n{event_names:['toggle'],filter:(node,_name)=>node.name==='details'}];const CHILD_DYNAMIC_ELEMENT_BLOCK='child_dynamic_element';const regex_invalid_variable_identifier_characters$2=/[^a-zA-Z0-9_$]/g;const regex_minus_signs=/-/g;class ElementWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.child_dynamic_element_block=null;this.child_dynamic_element=null;if(node.is_dynamic_element&&block.type!==CHILD_DYNAMIC_ELEMENT_BLOCK){this.child_dynamic_element_block=block.child({comment:create_debugging_comment(node,renderer.component),name:renderer.component.get_unique_name('create_dynamic_element'),type:CHILD_DYNAMIC_ELEMENT_BLOCK});renderer.blocks.push(this.child_dynamic_element_block);this.child_dynamic_element=new ElementWrapper(renderer,this.child_dynamic_element_block,parent,node,strip_whitespace,next_sibling);}this.var={type:'Identifier',name:node.name.replace(regex_invalid_variable_identifier_characters$2,'_')};this.void=is_void(node.name);this.class_dependencies=[];if(this.node.children.length){this.node.lets.forEach(l=>{extract_names(l.value||l.name).forEach(name=>{renderer.add_to_context(name,true);});});}this.attributes=this.node.attributes.map(attribute=>{if(attribute.name==='style'){return new StyleAttributeWrapper(this,block,attribute);}if(attribute.type==='Spread'){return new SpreadAttributeWrapper(this,block,attribute);}return new AttributeWrapper(this,block,attribute);});// ordinarily, there'll only be one... but we need to handle\n// the rare case where an element can have multiple bindings,\n// e.g. <audio bind:paused bind:currentTime>\nthis.bindings=this.node.bindings.map(binding=>new BindingWrapper(block,binding,this));this.event_handlers=this.node.handlers.map(event_handler=>new EventHandlerWrapper(event_handler,this));if(node.intro||node.outro){if(node.intro)block.add_intro(node.intro.is_local);if(node.outro)block.add_outro(node.outro.is_local);}if(node.animation){block.add_animation();}block.add_dependencies(node.tag_expr.dependencies);// add directive and handler dependencies\n[node.animation,node.outro,...node.actions,...node.classes,...node.styles].forEach(directive=>{if(directive&&directive.expression){block.add_dependencies(directive.expression.dependencies);}});node.handlers.forEach(handler=>{if(handler.expression){block.add_dependencies(handler.expression.dependencies);}});if(this.parent){if(node.actions.length>0||node.animation||node.bindings.length>0||node.classes.length>0||node.intro||node.outro||node.handlers.length>0||node.styles.length>0||this.node.name==='option'||node.tag_expr.dynamic_dependencies().length||renderer.options.dev){this.parent.cannot_use_innerhtml();// need to use add_location\nthis.parent.not_static_content();}}this.fragment=new FragmentWrapper(renderer,block,node.children,this,strip_whitespace,next_sibling);}render(block,parent_node,parent_nodes){if(this.child_dynamic_element){this.render_dynamic_element(block,parent_node,parent_nodes);}else{this.render_element(block,parent_node,parent_nodes);}}render_dynamic_element(block,parent_node,parent_nodes){this.child_dynamic_element.render(this.child_dynamic_element_block,null,x`#nodes`);const previous_tag=block.get_unique_name('previous_tag');const tag=this.node.tag_expr.manipulate(block);block.add_variable(previous_tag,tag);block.chunks.init.push(b`\n\t\t\t${this.renderer.options.dev&&b`@validate_dynamic_element(${tag});`}\n\t\t\t${this.renderer.options.dev&&this.node.children.length>0&&b`@validate_void_dynamic_element(${tag});`}\n\t\t\tlet ${this.var} = ${tag} && ${this.child_dynamic_element_block.name}(#ctx);\n\t\t`);block.chunks.create.push(b`\n\t\t\tif (${this.var}) ${this.var}.c();\n\t\t`);if(this.renderer.options.hydratable){block.chunks.claim.push(b`\n\t\t\t\tif (${this.var}) ${this.var}.l(${parent_nodes});\n\t\t\t`);}block.chunks.mount.push(b`\n\t\t\tif (${this.var}) ${this.var}.m(${parent_node||'#target'}, ${parent_node?'null':'#anchor'});\n\t\t`);const anchor=this.get_or_create_anchor(block,parent_node,parent_nodes);const has_transitions=!!(this.node.intro||this.node.outro);const not_equal=this.renderer.component.component_options.immutable?x`@not_equal`:x`@safe_not_equal`;block.chunks.update.push(b`\n\t\t\tif (${tag}) {\n\t\t\t\tif (!${previous_tag}) {\n\t\t\t\t\t${this.var} = ${this.child_dynamic_element_block.name}(#ctx);\n\t\t\t\t\t${this.var}.c();\n\t\t\t\t\t${has_transitions&&b`@transition_in(${this.var})`}\n\t\t\t\t\t${this.var}.m(${this.get_update_mount_node(anchor)}, ${anchor});\n\t\t\t\t} else if (${not_equal}(${previous_tag}, ${tag})) {\n\t\t\t\t\t${this.var}.d(1);\n\t\t\t\t\t${this.renderer.options.dev&&b`@validate_dynamic_element(${tag});`}\n\t\t\t\t\t${this.renderer.options.dev&&this.node.children.length>0&&b`@validate_void_dynamic_element(${tag});`}\n\t\t\t\t\t${this.var} = ${this.child_dynamic_element_block.name}(#ctx);\n\t\t\t\t\t${this.var}.c();\n\t\t\t\t\t${this.var}.m(${this.get_update_mount_node(anchor)}, ${anchor});\n\t\t\t\t} else {\n\t\t\t\t\t${this.var}.p(#ctx, #dirty);\n\t\t\t\t}\n\t\t\t} else if (${previous_tag}) {\n\t\t\t\t${has_transitions?b`\n\t\t\t\t\t\t\t@group_outros();\n\t\t\t\t\t\t\t@transition_out(${this.var}, 1, 1, () => {\n\t\t\t\t\t\t\t\t${this.var} = null;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t@check_outros();\n\t\t\t\t\t\t`:b`\n\t\t\t\t\t\t\t${this.var}.d(1);\n\t\t\t\t\t\t\t${this.var} = null;\n\t\t\t\t\t\t`}\n\t\t\t}\n\t\t\t${previous_tag} = ${tag};\n\t\t`);if(this.child_dynamic_element_block.has_intros){block.chunks.intro.push(b`@transition_in(${this.var});`);}if(this.child_dynamic_element_block.has_outros){block.chunks.outro.push(b`@transition_out(${this.var});`);}block.chunks.destroy.push(b`if (${this.var}) ${this.var}.d(detaching)`);if(this.node.animation){const measurements=block.get_unique_name('measurements');block.add_variable(measurements);block.chunks.measure.push(b`${measurements} = ${this.var}.r()`);block.chunks.fix.push(b`${this.var}.f();`);block.chunks.animate.push(b`\n\t\t\t\t${this.var}.s(${measurements});\n\t\t\t\t${this.var}.a()\n\t\t\t`);}}is_dom_node(){return super.is_dom_node()&&!this.child_dynamic_element;}render_element(block,parent_node,parent_nodes){const{renderer}=this;if(this.node.name==='noscript')return;const node=this.var;const nodes=parent_nodes&&block.get_unique_name(`${this.var.name}_nodes`);// if we're in unclaimable territory, i.e. <head>, parent_nodes is null\nconst children=x`@children(${this.node.name==='template'?x`${node}.content`:node})`;block.add_variable(node);const render_statement=this.get_render_statement(block);block.chunks.create.push(b`${node} = ${render_statement};`);if(renderer.options.hydratable){if(parent_nodes){block.chunks.claim.push(b`\n\t\t\t\t\t${node} = ${this.get_claim_statement(block,parent_nodes)};\n\t\t\t\t`);if(!this.void&&this.node.children.length>0){block.chunks.claim.push(b`\n\t\t\t\t\t\tvar ${nodes} = ${children};\n\t\t\t\t\t`);}}else{block.chunks.claim.push(b`${node} = ${render_statement};`);}}if(parent_node){const append=b`@append(${parent_node}, ${node});`;append[0].expression.callee.loc={start:this.renderer.locate(this.node.start),end:this.renderer.locate(this.node.end)};block.chunks.mount.push(append);if(is_head(parent_node)){block.chunks.destroy.push(b`@detach(${node});`);}}else{const insert=b`@insert(#target, ${node}, #anchor);`;insert[0].expression.callee.loc={start:this.renderer.locate(this.node.start),end:this.renderer.locate(this.node.end)};block.chunks.mount.push(insert);// TODO we eventually need to consider what happens to elements\n// that belong to the same outgroup as an outroing element...\nblock.chunks.destroy.push(b`if (detaching) @detach(${node});`);}// insert static children with textContent or innerHTML\n// skip textcontent for <template>.  append nodes to TemplateElement.content instead\nconst can_use_textcontent=this.can_use_textcontent();const is_template=this.node.name==='template';const is_template_with_text_content=is_template&&can_use_textcontent;if(!is_template_with_text_content&&!this.node.namespace&&(this.can_use_innerhtml||can_use_textcontent)&&this.fragment.nodes.length>0){if(this.fragment.nodes.length===1&&this.fragment.nodes[0].node.type==='Text'){block.chunks.create.push(b`${node}.textContent = ${string_literal(this.fragment.nodes[0].data)};`);}else{const state={quasi:{type:'TemplateElement',value:{raw:''}}};const literal={type:'TemplateLiteral',expressions:[],quasis:[]};const can_use_raw_text=!this.can_use_innerhtml&&can_use_textcontent;to_html(this.fragment.nodes,block,literal,state,can_use_raw_text);literal.quasis.push(state.quasi);block.chunks.create.push(b`${node}.${this.can_use_innerhtml?'innerHTML':'textContent'} = ${literal};`);}}else{this.fragment.nodes.forEach(child=>{child.render(block,is_template?x`${node}.content`:node,nodes);});}const event_handler_or_binding_uses_context=this.bindings.some(binding=>binding.handler.uses_context)||this.node.handlers.some(handler=>handler.uses_context)||this.node.actions.some(action=>action.uses_context);if(event_handler_or_binding_uses_context){block.maintain_context=true;}this.add_attributes(block);this.add_directives_in_order(block);this.add_transitions(block);this.add_animation(block);this.add_classes(block);this.add_styles(block);this.add_manual_style_scoping(block);if(nodes&&this.renderer.options.hydratable&&!this.void){block.chunks.claim.push(b`${this.node.children.length>0?nodes:children}.forEach(@detach);`);}if(renderer.options.dev){const loc=renderer.locate(this.node.start);block.chunks.hydrate.push(b`@add_location(${this.var}, ${renderer.file_var}, ${loc.line-1}, ${loc.column}, ${this.node.start});`);}block.renderer.dirty(this.node.tag_expr.dynamic_dependencies());}can_use_textcontent(){return this.is_static_content&&this.fragment.nodes.every(node=>node.node.type==='Text'||node.node.type==='MustacheTag');}get_render_statement(block){const{name,namespace,tag_expr}=this.node;const reference=tag_expr.manipulate(block);if(namespace===namespaces.svg){return x`@svg_element(${reference})`;}if(namespace){return x`@_document.createElementNS(\"${namespace}\", \"${name}\")`;}const is=this.attributes.find(attr=>attr.node.name==='is');if(is){return x`@element_is(\"${name}\", ${is.render_chunks(block).reduce((lhs,rhs)=>x`${lhs} + ${rhs}`)})`;}return x`@element(${reference})`;}get_claim_statement(block,nodes){const attributes=this.attributes.filter(attr=>!(attr instanceof SpreadAttributeWrapper)&&!attr.property_name).map(attr=>p`${attr.name}: true`);let reference;if(this.node.tag_expr.node.type==='Literal'){if(this.node.namespace){reference=`\"${this.node.tag_expr.node.value}\"`;}else{reference=`\"${(this.node.tag_expr.node.value||'').toUpperCase()}\"`;}}else if(this.node.namespace){reference=x`${this.node.tag_expr.manipulate(block)}`;}else{reference=x`(${this.node.tag_expr.manipulate(block)} || 'null').toUpperCase()`;}if(this.node.namespace===namespaces.svg){return x`@claim_svg_element(${nodes}, ${reference}, { ${attributes} })`;}else{return x`@claim_element(${nodes}, ${reference}, { ${attributes} })`;}}add_directives_in_order(block){const binding_groups=events.map(event=>({events:event.event_names,bindings:this.bindings.filter(binding=>binding.node.name!=='this').filter(binding=>event.filter(this.node,binding.node.name))})).filter(group=>group.bindings.length);const this_binding=this.bindings.find(b=>b.node.name==='this');function getOrder(item){if(item instanceof EventHandlerWrapper){return item.node.start;}else if(item instanceof BindingWrapper){return item.node.start;}else if(item instanceof Action){return item.start;}else{return item.bindings[0].node.start;}}[...binding_groups,...this.event_handlers,this_binding,...this.node.actions].filter(Boolean).sort((a,b)=>getOrder(a)-getOrder(b)).forEach(item=>{if(item instanceof EventHandlerWrapper){add_event_handler(block,this.var,item);}else if(item instanceof BindingWrapper){this.add_this_binding(block,item);}else if(item instanceof Action){add_action(block,this.var,item);}else{this.add_bindings(block,item);}});}add_bindings(block,binding_group){const{renderer}=this;if(binding_group.bindings.length===0)return;renderer.component.has_reactive_assignments=true;const lock=binding_group.bindings.some(binding=>binding.needs_lock)?block.get_unique_name(`${this.var.name}_updating`):null;if(lock)block.add_variable(lock,x`false`);const handler=renderer.component.get_unique_name(`${this.var.name}_${binding_group.events.join('_')}_handler`);renderer.add_to_context(handler.name);// TODO figure out how to handle locks\nconst needs_lock=binding_group.bindings.some(binding=>binding.needs_lock);const dependencies=new Set();const contextual_dependencies=new Set();binding_group.bindings.forEach(binding=>{// TODO this is a mess\nadd_to_set(dependencies,binding.get_update_dependencies());add_to_set(contextual_dependencies,binding.handler.contextual_dependencies);binding.render(block,lock);});// media bindings — awkward special case. The native timeupdate events\n// fire too infrequently, so we need to take matters into our\n// own hands\nlet animation_frame;if(binding_group.events[0]==='timeupdate'){animation_frame=block.get_unique_name(`${this.var.name}_animationframe`);block.add_variable(animation_frame);}const has_local_function=contextual_dependencies.size>0||needs_lock||animation_frame;let callee=renderer.reference(handler);// TODO dry this out — similar code for event handlers and component bindings\nif(has_local_function){const args=Array.from(contextual_dependencies).map(name=>renderer.reference(name));// need to create a block-local function that calls an instance-level function\nif(animation_frame){block.chunks.init.push(b`\n\t\t\t\t\tfunction ${handler}() {\n\t\t\t\t\t\t@_cancelAnimationFrame(${animation_frame});\n\t\t\t\t\t\tif (!${this.var}.paused) {\n\t\t\t\t\t\t\t${animation_frame} = @raf(${handler});\n\t\t\t\t\t\t\t${needs_lock&&b`${lock} = true;`}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t${callee}.call(${this.var}, ${args});\n\t\t\t\t\t}\n\t\t\t\t`);}else{block.chunks.init.push(b`\n\t\t\t\t\tfunction ${handler}() {\n\t\t\t\t\t\t${needs_lock&&b`${lock} = true;`}\n\t\t\t\t\t\t${callee}.call(${this.var}, ${args});\n\t\t\t\t\t}\n\t\t\t\t`);}callee=handler;}const params=Array.from(contextual_dependencies).map(name=>({type:'Identifier',name}));this.renderer.component.partly_hoisted.push(b`\n\t\t\tfunction ${handler}(${params}) {\n\t\t\t\t${binding_group.bindings.map(b=>b.handler.mutation)}\n\t\t\t\t${Array.from(dependencies).filter(dep=>dep[0]!=='$').filter(dep=>!contextual_dependencies.has(dep)).map(dep=>b`${this.renderer.invalidate(dep)};`)}\n\t\t\t}\n\t\t`);binding_group.events.forEach(name=>{if(name==='elementresize'){// special case\nconst resize_listener=block.get_unique_name(`${this.var.name}_resize_listener`);block.add_variable(resize_listener);block.chunks.mount.push(b`${resize_listener} = @add_resize_listener(${this.var}, ${callee}.bind(${this.var}));`);block.chunks.destroy.push(b`${resize_listener}();`);}else{block.event_listeners.push(x`@listen(${this.var}, \"${name}\", ${callee})`);}});const some_initial_state_is_undefined=binding_group.bindings.map(binding=>x`${binding.snippet} === void 0`).reduce((lhs,rhs)=>x`${lhs} || ${rhs}`);const should_initialise=this.node.name==='select'||binding_group.bindings.find(binding=>{return binding.node.name==='indeterminate'||binding.node.name==='textContent'||binding.node.name==='innerHTML'||binding.is_readonly_media_attribute();});if(should_initialise){const callback=has_local_function?handler:x`() => ${callee}.call(${this.var})`;block.chunks.hydrate.push(b`if (${some_initial_state_is_undefined}) @add_render_callback(${callback});`);}if(binding_group.events[0]==='elementresize'){block.chunks.hydrate.push(b`@add_render_callback(() => ${callee}.call(${this.var}));`);}if(lock){block.chunks.update.push(b`${lock} = false;`);}}add_this_binding(block,this_binding){const{renderer}=this;renderer.component.has_reactive_assignments=true;const binding_callback=bind_this(renderer.component,block,this_binding,this.var);block.chunks.mount.push(binding_callback);}add_attributes(block){// Get all the class dependencies first\nthis.attributes.forEach(attribute=>{if(attribute.node.name==='class'){const dependencies=attribute.node.get_dependencies();push_array$1(this.class_dependencies,dependencies);}});if(this.node.attributes.some(attr=>attr.is_spread)||this.node.is_dynamic_element){this.add_spread_attributes(block);return;}this.attributes.forEach(attribute=>{attribute.render(block);});}add_spread_attributes(block){const levels=block.get_unique_name(`${this.var.name}_levels`);const data=block.get_unique_name(`${this.var.name}_data`);const initial_props=[];const updates=[];this.attributes.forEach(attr=>{const dependencies=attr.node.get_dependencies();const condition=dependencies.length>0?block.renderer.dirty(dependencies):null;if(attr instanceof SpreadAttributeWrapper){const snippet=attr.node.expression.manipulate(block);initial_props.push(snippet);updates.push(condition?x`${condition} && ${snippet}`:snippet);}else{const name=attr.property_name||attr.name;initial_props.push(x`{ ${name}: ${attr.get_init(block,attr.get_value(block))} }`);const snippet=x`{ ${name}: ${attr.should_cache?attr.last:attr.get_value(block)} }`;updates.push(condition?x`${attr.get_dom_update_conditions(block,condition)} && ${snippet}`:snippet);}});block.chunks.init.push(b`\n\t\t\tlet ${levels} = [${initial_props}];\n\n\t\t\tlet ${data} = {};\n\t\t\tfor (let #i = 0; #i < ${levels}.length; #i += 1) {\n\t\t\t\t${data} = @assign(${data}, ${levels}[#i]);\n\t\t\t}\n\t\t`);const fn=this.node.namespace===namespaces.svg?x`@set_svg_attributes`:x`@set_attributes`;if(this.node.is_dynamic_element){// call attribute bindings for custom element if tag is custom element\nconst tag=this.node.tag_expr.manipulate(block);const attr_update=this.node.namespace===namespaces.svg?b`${fn}(${this.var}, ${data});`:b`\n\t\t\t\t\tif (/-/.test(${tag})) {\n\t\t\t\t\t\t@set_custom_element_data_map(${this.var}, ${data});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t${fn}(${this.var}, ${data});\n\t\t\t\t\t}`;block.chunks.hydrate.push(attr_update);block.chunks.update.push(b`\n\t\t\t\t${data} = @get_spread_update(${levels}, [${updates}]);\n\t\t\t\t${attr_update}`);}else{block.chunks.hydrate.push(b`${fn}(${this.var}, ${data});`);block.chunks.update.push(b`\n\t\t\t\t${fn}(${this.var}, ${data} = @get_spread_update(${levels}, [\n\t\t\t\t\t${updates}\n\t\t\t\t]));\n\t\t\t`);}// handle edge cases for elements\nif(this.node.name==='select'){const dependencies=new Set();for(const attr of this.attributes){for(const dep of attr.node.dependencies){dependencies.add(dep);}}block.chunks.mount.push(b`\n\t\t\t\t(${data}.multiple ? @select_options : @select_option)(${this.var}, ${data}.value);\n\t\t\t`);block.chunks.update.push(b`\n\t\t\t\tif (${block.renderer.dirty(Array.from(dependencies))} && 'value' in ${data}) (${data}.multiple ? @select_options : @select_option)(${this.var}, ${data}.value);\n\t\t\t`);}else if(this.node.name==='input'&&this.attributes.find(attr=>attr.node.name==='value')){const type=this.node.get_static_attribute_value('type');if(type===null||type===''||type==='text'||type==='email'||type==='password'){block.chunks.mount.push(b`\n\t\t\t\t\t${this.var}.value = ${data}.value;\n\t\t\t\t`);block.chunks.update.push(b`\n\t\t\t\t\tif ('value' in ${data}) {\n\t\t\t\t\t\t${this.var}.value = ${data}.value;\n\t\t\t\t\t}\n\t\t\t\t`);}}if(['button','input','keygen','select','textarea'].includes(this.node.name)){block.chunks.mount.push(b`\n\t\t\t\tif (${this.var}.autofocus) ${this.var}.focus();\n\t\t\t`);}}add_transitions(block){const{intro,outro}=this.node;if(!intro&&!outro)return;if(intro===outro){// bidirectional transition\nconst name=block.get_unique_name(`${this.var.name}_transition`);const snippet=intro.expression?intro.expression.manipulate(block):x`{}`;block.add_variable(name);const fn=this.renderer.reference(intro.name);const intro_block=b`\n\t\t\t\t@add_render_callback(() => {\n\t\t\t\t\tif (!${name}) ${name} = @create_bidirectional_transition(${this.var}, ${fn}, ${snippet}, true);\n\t\t\t\t\t${name}.run(1);\n\t\t\t\t});\n\t\t\t`;const outro_block=b`\n\t\t\t\tif (!${name}) ${name} = @create_bidirectional_transition(${this.var}, ${fn}, ${snippet}, false);\n\t\t\t\t${name}.run(0);\n\t\t\t`;if(intro.is_local){block.chunks.intro.push(b`\n\t\t\t\t\tif (#local) {\n\t\t\t\t\t\t${intro_block}\n\t\t\t\t\t}\n\t\t\t\t`);block.chunks.outro.push(b`\n\t\t\t\t\tif (#local) {\n\t\t\t\t\t\t${outro_block}\n\t\t\t\t\t}\n\t\t\t\t`);}else{block.chunks.intro.push(intro_block);block.chunks.outro.push(outro_block);}block.chunks.destroy.push(b`if (detaching && ${name}) ${name}.end();`);}else{const intro_name=intro&&block.get_unique_name(`${this.var.name}_intro`);const outro_name=outro&&block.get_unique_name(`${this.var.name}_outro`);if(intro){block.add_variable(intro_name);const snippet=intro.expression?intro.expression.manipulate(block):x`{}`;const fn=this.renderer.reference(intro.name);let intro_block;if(outro){intro_block=b`\n\t\t\t\t\t\t@add_render_callback(() => {\n\t\t\t\t\t\t\tif (${outro_name}) ${outro_name}.end(1);\n\t\t\t\t\t\t\t${intro_name} = @create_in_transition(${this.var}, ${fn}, ${snippet});\n\t\t\t\t\t\t\t${intro_name}.start();\n\t\t\t\t\t\t});\n\t\t\t\t\t`;block.chunks.outro.push(b`if (${intro_name}) ${intro_name}.invalidate();`);}else{intro_block=b`\n\t\t\t\t\t\tif (!${intro_name}) {\n\t\t\t\t\t\t\t@add_render_callback(() => {\n\t\t\t\t\t\t\t\t${intro_name} = @create_in_transition(${this.var}, ${fn}, ${snippet});\n\t\t\t\t\t\t\t\t${intro_name}.start();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t`;}if(intro.is_local){intro_block=b`\n\t\t\t\t\t\tif (#local) {\n\t\t\t\t\t\t\t${intro_block}\n\t\t\t\t\t\t}\n\t\t\t\t\t`;}block.chunks.intro.push(intro_block);}if(outro){block.add_variable(outro_name);const snippet=outro.expression?outro.expression.manipulate(block):x`{}`;const fn=this.renderer.reference(outro.name);if(!intro){block.chunks.intro.push(b`\n\t\t\t\t\t\tif (${outro_name}) ${outro_name}.end(1);\n\t\t\t\t\t`);}// TODO hide elements that have outro'd (unless they belong to a still-outroing\n// group) prior to their removal from the DOM\nlet outro_block=b`\n\t\t\t\t\t${outro_name} = @create_out_transition(${this.var}, ${fn}, ${snippet});\n\t\t\t\t`;if(outro.is_local){outro_block=b`\n\t\t\t\t\t\tif (#local) {\n\t\t\t\t\t\t\t${outro_block}\n\t\t\t\t\t\t}\n\t\t\t\t\t`;}block.chunks.outro.push(outro_block);block.chunks.destroy.push(b`if (detaching && ${outro_name}) ${outro_name}.end();`);}}if(intro&&intro.expression&&intro.expression.dependencies.size||outro&&outro.expression&&outro.expression.dependencies.size){block.maintain_context=true;}}add_animation(block){if(!this.node.animation)return;const{outro}=this.node;const rect=block.get_unique_name('rect');const stop_animation=block.get_unique_name('stop_animation');block.add_variable(rect);block.add_variable(stop_animation,x`@noop`);block.chunks.measure.push(b`\n\t\t\t${rect} = ${this.var}.getBoundingClientRect();\n\t\t`);if(block.type===CHILD_DYNAMIC_ELEMENT_BLOCK){block.chunks.measure.push(b`return ${rect}`);block.chunks.restore_measurements.push(b`${rect} = #measurement;`);}block.chunks.fix.push(b`\n\t\t\t@fix_position(${this.var});\n\t\t\t${stop_animation}();\n\t\t\t${outro&&b`@add_transform(${this.var}, ${rect});`}\n\t\t`);let params;if(this.node.animation.expression){params=this.node.animation.expression.manipulate(block);if(this.node.animation.expression.dynamic_dependencies().length){// if `params` is dynamic, calculate params ahead of time in the `.r()` method\nconst params_var=block.get_unique_name('params');block.add_variable(params_var);block.chunks.measure.push(b`${params_var} = ${params};`);params=params_var;}}else{params=x`{}`;}const name=this.renderer.reference(this.node.animation.name);block.chunks.animate.push(b`\n\t\t\t${stop_animation}();\n\t\t\t${stop_animation} = @create_animation(${this.var}, ${rect}, ${name}, ${params});\n\t\t`);}add_classes(block){const has_spread=this.node.attributes.some(attr=>attr.is_spread);this.node.classes.forEach(class_directive=>{const{expression,name}=class_directive;let snippet;let dependencies;if(expression){snippet=expression.manipulate(block);dependencies=expression.dependencies;}else{snippet=name;dependencies=new Set([name]);}const updater=b`@toggle_class(${this.var}, \"${name}\", ${snippet});`;block.chunks.hydrate.push(updater);if(has_spread||this.node.is_dynamic_element){block.chunks.update.push(updater);}else if(dependencies&&dependencies.size>0||this.class_dependencies.length){const all_dependencies=this.class_dependencies.concat(...dependencies);let condition=block.renderer.dirty(all_dependencies);if(block.has_outros){condition=x`!#current || ${condition}`;}// If all of the dependencies are non-dynamic (don't get updated) then there is no reason\n// to add an updater for this.\nconst any_dynamic_dependencies=all_dependencies.some(dep=>{const variable=this.renderer.component.var_lookup.get(dep);return!variable||is_dynamic(variable);});if(any_dynamic_dependencies){block.chunks.update.push(b`\n\t\t\t\t\t\tif (${condition}) {\n\t\t\t\t\t\t\t${updater}\n\t\t\t\t\t\t}\n\t\t\t\t\t`);}}});}add_styles(block){const has_spread=this.node.attributes.some(attr=>attr.is_spread);this.node.styles.forEach(style_directive=>{const{name,expression,should_cache,important}=style_directive;const snippet=expression.manipulate(block);let cached_snippet;if(should_cache){cached_snippet=block.get_unique_name(`style_${name.replace(regex_minus_signs,'_')}`);block.add_variable(cached_snippet,snippet);}const updater=b`@set_style(${this.var}, \"${name}\", ${should_cache?cached_snippet:snippet}, ${important?1:null})`;block.chunks.hydrate.push(updater);const dependencies=expression.dynamic_dependencies();if(has_spread){block.chunks.update.push(updater);}else if(dependencies.length>0){if(should_cache){block.chunks.update.push(b`\n\t\t\t\t\t\t\tif (${block.renderer.dirty(dependencies)} && (${cached_snippet} !== (${cached_snippet} = ${snippet}))) {\n\t\t\t\t\t\t\t\t${updater}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t`);}else{block.chunks.update.push(b`\n\t\t\t\t\t\tif (${block.renderer.dirty(dependencies)}) {\n\t\t\t\t\t\t\t${updater}\n\t\t\t\t\t\t}\n\t\t\t\t\t`);}}});}add_manual_style_scoping(block){if(this.node.needs_manual_style_scoping){const updater=b`@toggle_class(${this.var}, \"${this.node.component.stylesheet.id}\", true);`;block.chunks.hydrate.push(updater);block.chunks.update.push(updater);}}}const regex_backticks=/`/g;const regex_dollar_signs=/\\$/g;function to_html(wrappers,block,literal,state,can_use_raw_text){wrappers.forEach(wrapper=>{if(wrapper instanceof TextWrapper){// Don't add the <pre>/<textarea> newline logic here because pre/textarea.innerHTML\n// would keep the leading newline, too, only someParent.innerHTML = '..<pre/textarea>..' won't\nif(wrapper.use_space())state.quasi.value.raw+=' ';const parent=wrapper.node.parent;const raw=parent&&(parent.name==='script'||parent.name==='style'||can_use_raw_text);state.quasi.value.raw+=(raw?wrapper.data:escape_html(wrapper.data)).replace(regex_backslashes,'\\\\\\\\').replace(regex_backticks,'\\\\`').replace(regex_dollar_signs,'\\\\$');}else if(wrapper instanceof MustacheTagWrapper||wrapper instanceof RawMustacheTagWrapper){literal.quasis.push(state.quasi);literal.expressions.push(wrapper.node.expression.manipulate(block));state.quasi={type:'TemplateElement',value:{raw:''}};}else if(wrapper.node.name==='noscript');else{// element\nstate.quasi.value.raw+=`<${wrapper.node.name}`;const is_empty_textarea=wrapper.node.name==='textarea'&&wrapper.fragment.nodes.length===0;wrapper.attributes.forEach(attr=>{if(is_empty_textarea&&attr.node.name==='value'){// The value attribute of <textarea> renders as content.\nreturn;}state.quasi.value.raw+=` ${fix_attribute_casing(attr.node.name)}=\"`;to_html_for_attr_value(attr,block,literal,state);state.quasi.value.raw+='\"';});if(!wrapper.void){state.quasi.value.raw+='>';if(wrapper.node.name==='pre'){// Two or more leading newlines are required to restore the leading newline immediately after `<pre>`.\n// see https://html.spec.whatwg.org/multipage/grouping-content.html#the-pre-element\nconst first=wrapper.fragment.nodes[0];if(first&&first.node.type==='Text'&&regex_starts_with_newline.test(first.node.data)){state.quasi.value.raw+='\\n';}}if(is_empty_textarea){// The <textarea> renders the value attribute as content because the content is stored in the value attribute.\nconst value_attribute=wrapper.attributes.find(attr=>attr.node.name==='value');if(value_attribute){// Two or more leading newlines are required to restore the leading newline immediately after `<textarea>`.\n// see https://html.spec.whatwg.org/multipage/syntax.html#element-restrictions\nconst first=value_attribute.node.chunks[0];if(first&&first.type==='Text'&&regex_starts_with_newline.test(first.data)){state.quasi.value.raw+='\\n';}to_html_for_attr_value(value_attribute,block,literal,state);}}to_html(wrapper.fragment.nodes,block,literal,state);state.quasi.value.raw+=`</${wrapper.node.name}>`;}else{state.quasi.value.raw+='/>';}}});}function to_html_for_attr_value(attr,block,literal,state){attr.node.chunks.forEach(chunk=>{if(chunk.type==='Text'){state.quasi.value.raw+=escape_html(chunk.data);}else{literal.quasis.push(state.quasi);literal.expressions.push(chunk.manipulate(block));state.quasi={type:'TemplateElement',value:{raw:''}};}});}class HeadWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.can_use_innerhtml=false;this.fragment=new FragmentWrapper(renderer,block,node.children,this,strip_whitespace,next_sibling);}render(block,_parent_node,_parent_nodes){let nodes;if(this.renderer.options.hydratable&&this.fragment.nodes.length){nodes=block.get_unique_name('head_nodes');block.chunks.claim.push(b`const ${nodes} = @head_selector('${this.node.id}', @_document.head);`);}this.fragment.render(block,x`@_document.head`,nodes);if(nodes&&this.renderer.options.hydratable){block.chunks.claim.push(b`${nodes}.forEach(@detach);`);}}}function is_else_if(node){return node&&node.children.length===1&&node.children[0].type==='IfBlock';}class IfBlockBranch extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.var=null;const{expression}=node;const is_else=!expression;if(expression){this.dependencies=expression.dynamic_dependencies();// TODO is this the right rule? or should any non-reference count?\n// const should_cache = !is_reference(expression.node, null) && dependencies.length > 0;\nlet should_cache=false;walk(expression.node,{enter(node){if(node.type==='CallExpression'||node.type==='NewExpression'){should_cache=true;}}});if(should_cache){this.condition=block.get_unique_name('show_if');this.snippet=expression.manipulate(block);}else{this.condition=expression.manipulate(block);}}add_const_tags_context(renderer,this.node.const_tags);this.block=block.child({comment:create_debugging_comment(node,parent.renderer.component),name:parent.renderer.component.get_unique_name(is_else?'create_else_block':'create_if_block'),type:node.expression?'if':'else'});this.fragment=new FragmentWrapper(renderer,this.block,node.children,parent,strip_whitespace,next_sibling);this.is_dynamic=this.block.dependencies.size>0;if(node.const_tags.length>0){this.get_ctx_name=parent.renderer.component.get_unique_name(is_else?'get_else_ctx':'get_if_ctx');}}}class IfBlockWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.needs_update=false;this.var={type:'Identifier',name:'if_block'};this.cannot_use_innerhtml();this.not_static_content();this.branches=[];const blocks=[];let is_dynamic=false;let has_intros=false;let has_outros=false;const create_branches=node=>{const branch=new IfBlockBranch(renderer,block,this,node,strip_whitespace,next_sibling);this.branches.push(branch);blocks.push(branch.block);block.add_dependencies(node.expression.dependencies);if(branch.block.dependencies.size>0){// the condition, or its contents, is dynamic\nis_dynamic=true;block.add_dependencies(branch.block.dependencies);}if(branch.dependencies&&branch.dependencies.length>0){// the condition itself is dynamic\nthis.needs_update=true;}if(branch.block.has_intros)has_intros=true;if(branch.block.has_outros)has_outros=true;if(is_else_if(node.else)){create_branches(node.else.children[0]);}else if(node.else){const branch=new IfBlockBranch(renderer,block,this,node.else,strip_whitespace,next_sibling);this.branches.push(branch);blocks.push(branch.block);if(branch.block.dependencies.size>0){is_dynamic=true;block.add_dependencies(branch.block.dependencies);}if(branch.block.has_intros)has_intros=true;if(branch.block.has_outros)has_outros=true;}};create_branches(this.node);blocks.forEach(block=>{block.has_update_method=is_dynamic;block.has_intro_method=has_intros;block.has_outro_method=has_outros;});push_array$1(renderer.blocks,blocks);}render(block,parent_node,parent_nodes){const name=this.var;const needs_anchor=this.next?!this.next.is_dom_node():!parent_node||!this.parent.is_dom_node();const anchor=needs_anchor?block.get_unique_name(`${this.var.name}_anchor`):this.next&&this.next.var||'null';const has_else=!this.branches[this.branches.length-1].condition;const if_exists_condition=has_else?null:name;const dynamic=this.branches[0].block.has_update_method;// can use [0] as proxy for all, since they necessarily have the same value\nconst has_intros=this.branches[0].block.has_intro_method;const has_outros=this.branches[0].block.has_outro_method;const has_transitions=has_intros||has_outros;this.branches.forEach(branch=>{if(branch.get_ctx_name){this.renderer.blocks.push(b`\n\t\t\t\tfunction ${branch.get_ctx_name}(#ctx) {\n\t\t\t\t\tconst child_ctx = #ctx.slice();\n\t\t\t\t\t${add_const_tags(block,branch.node.const_tags,'child_ctx')}\n\t\t\t\t\treturn child_ctx;\n\t\t\t\t}\n\t\t\t\t`);}});const vars={name,anchor,if_exists_condition,has_else,has_transitions};const detaching=parent_node&&!is_head(parent_node)?null:'detaching';if(this.node.else){this.branches.forEach(branch=>{if(branch.snippet)block.add_variable(branch.condition);});if(has_outros){this.render_compound_with_outros(block,parent_node,parent_nodes,dynamic,vars,detaching);block.chunks.outro.push(b`@transition_out(${name});`);}else{this.render_compound(block,parent_node,parent_nodes,dynamic,vars,detaching);}}else{this.render_simple(block,parent_node,parent_nodes,dynamic,vars,detaching);if(has_outros){block.chunks.outro.push(b`@transition_out(${name});`);}}if(if_exists_condition){block.chunks.create.push(b`if (${if_exists_condition}) ${name}.c();`);}else{block.chunks.create.push(b`${name}.c();`);}if(parent_nodes&&this.renderer.options.hydratable){if(if_exists_condition){block.chunks.claim.push(b`if (${if_exists_condition}) ${name}.l(${parent_nodes});`);}else{block.chunks.claim.push(b`${name}.l(${parent_nodes});`);}}if(has_intros||has_outros){block.chunks.intro.push(b`@transition_in(${name});`);}if(needs_anchor){block.add_element(anchor,x`@empty()`,parent_nodes&&x`@empty()`,parent_node);}this.branches.forEach(branch=>{branch.fragment.render(branch.block,null,x`#nodes`);});}render_compound(block,parent_node,_parent_nodes,dynamic,_ref19,detaching){let{name,anchor,has_else,if_exists_condition,has_transitions}=_ref19;const select_block_type=this.renderer.component.get_unique_name('select_block_type');const current_block_type=block.get_unique_name('current_block_type');const need_select_block_ctx=this.branches.some(branch=>branch.get_ctx_name);const select_block_ctx=need_select_block_ctx?block.get_unique_name('select_block_ctx'):null;const if_ctx=select_block_ctx?x`${select_block_ctx}(#ctx, ${current_block_type})`:x`#ctx`;const get_block=has_else?x`${current_block_type}(${if_ctx})`:x`${current_block_type} && ${current_block_type}(${if_ctx})`;if(this.needs_update){block.chunks.init.push(b`\n\t\t\t\tfunction ${select_block_type}(#ctx, #dirty) {\n\t\t\t\t\t${this.branches.map(_ref20=>{let{dependencies,condition,snippet}=_ref20;return b`${snippet&&dependencies.length>0?b`if (${block.renderer.dirty(dependencies)}) ${condition} = null;`:null}`;})}\n\t\t\t\t\t${this.branches.map(_ref21=>{let{condition,snippet,block}=_ref21;return condition?b`\n\t\t\t\t\t\t\t\t${snippet&&b`if (${condition} == null) ${condition} = !!${snippet}`}\n\t\t\t\t\t\t\t\tif (${condition}) return ${block.name};`:b`return ${block.name};`;})}\n\t\t\t\t}\n\t\t\t`);}else{block.chunks.init.push(b`\n\t\t\t\tfunction ${select_block_type}(#ctx, #dirty) {\n\t\t\t\t\t${this.branches.map(_ref22=>{let{condition,snippet,block}=_ref22;return condition?b`if (${snippet||condition}) return ${block.name};`:b`return ${block.name};`;})}\n\t\t\t\t}\n\t\t\t`);}if(need_select_block_ctx){// if all branches needs create a context\nif(this.branches.every(branch=>branch.get_ctx_name)){block.chunks.init.push(b`\n\t\t\t\t\tfunction ${select_block_ctx}(#ctx, #type) {\n\t\t\t\t\t\t${this.branches.map(_ref23=>{let{condition,get_ctx_name,block}=_ref23;return condition?b`if (#type === ${block.name}) return ${get_ctx_name}(#ctx);`:b`return ${get_ctx_name}(#ctx);`;}).filter(Boolean)}\n\t\t\t\t\t}\n\t\t\t\t`);}else{// when not all branches need to create a new context,\n// this code is simpler\nblock.chunks.init.push(b`\n\t\t\t\t\tfunction ${select_block_ctx}(#ctx, #type) {\n\t\t\t\t\t\t${this.branches.map(_ref24=>{let{get_ctx_name,block}=_ref24;return get_ctx_name?b`if (#type === ${block.name}) return ${get_ctx_name}(#ctx);`:null;}).filter(Boolean)}\n\t\t\t\t\t\treturn #ctx;\n\t\t\t\t\t}\n\t\t\t\t`);}}block.chunks.init.push(b`\n\t\t\tlet ${current_block_type} = ${select_block_type}(#ctx, ${this.renderer.get_initial_dirty()});\n\t\t\tlet ${name} = ${get_block};\n\t\t`);const initial_mount_node=parent_node||'#target';const anchor_node=parent_node?'null':'#anchor';if(if_exists_condition){block.chunks.mount.push(b`if (${if_exists_condition}) ${name}.m(${initial_mount_node}, ${anchor_node});`);}else{block.chunks.mount.push(b`${name}.m(${initial_mount_node}, ${anchor_node});`);}if(this.needs_update){const update_mount_node=this.get_update_mount_node(anchor);const change_block=b`\n\t\t\t\t${if_exists_condition?b`if (${if_exists_condition}) ${name}.d(1)`:b`${name}.d(1)`};\n\t\t\t\t${name} = ${get_block};\n\t\t\t\tif (${name}) {\n\t\t\t\t\t${name}.c();\n\t\t\t\t\t${has_transitions&&b`@transition_in(${name}, 1);`}\n\t\t\t\t\t${name}.m(${update_mount_node}, ${anchor});\n\t\t\t\t}\n\t\t\t`;if(dynamic){block.chunks.update.push(b`\n\t\t\t\t\tif (${current_block_type} === (${current_block_type} = ${select_block_type}(#ctx, #dirty)) && ${name}) {\n\t\t\t\t\t\t${name}.p(${if_ctx}, #dirty);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t${change_block}\n\t\t\t\t\t}\n\t\t\t\t`);}else{block.chunks.update.push(b`\n\t\t\t\t\tif (${current_block_type} !== (${current_block_type} = ${select_block_type}(#ctx, #dirty))) {\n\t\t\t\t\t\t${change_block}\n\t\t\t\t\t}\n\t\t\t\t`);}}else if(dynamic){if(if_exists_condition){block.chunks.update.push(b`if (${if_exists_condition}) ${name}.p(${if_ctx}, #dirty);`);}else{block.chunks.update.push(b`${name}.p(${if_ctx}, #dirty);`);}}if(if_exists_condition){block.chunks.destroy.push(b`\n\t\t\t\tif (${if_exists_condition}) {\n\t\t\t\t\t${name}.d(${detaching});\n\t\t\t\t}\n\t\t\t`);}else{block.chunks.destroy.push(b`\n\t\t\t\t${name}.d(${detaching});\n\t\t\t`);}}// if any of the siblings have outros, we need to keep references to the blocks\n// (TODO does this only apply to bidi transitions?)\nrender_compound_with_outros(block,parent_node,_parent_nodes,dynamic,_ref25,detaching){let{name,anchor,has_else,has_transitions,if_exists_condition}=_ref25;const select_block_type=this.renderer.component.get_unique_name('select_block_type');const current_block_type_index=block.get_unique_name('current_block_type_index');const previous_block_index=block.get_unique_name('previous_block_index');const if_block_creators=block.get_unique_name('if_block_creators');const if_blocks=block.get_unique_name('if_blocks');const need_select_block_ctx=this.branches.some(branch=>branch.get_ctx_name);const select_block_ctx=need_select_block_ctx?block.get_unique_name('select_block_ctx'):null;const if_ctx=select_block_ctx?x`${select_block_ctx}(#ctx, ${current_block_type_index})`:x`#ctx`;const if_current_block_type_index=has_else?nodes=>nodes:nodes=>b`if (~${current_block_type_index}) { ${nodes} }`;block.add_variable(current_block_type_index);block.add_variable(name);block.chunks.init.push(b`\n\t\t\tconst ${if_block_creators} = [\n\t\t\t\t${this.branches.map(branch=>branch.block.name)}\n\t\t\t];\n\n\t\t\tconst ${if_blocks} = [];\n\n\t\t\t${this.needs_update?b`\n\t\t\t\t\tfunction ${select_block_type}(#ctx, #dirty) {\n\t\t\t\t\t\t${this.branches.map(_ref26=>{let{dependencies,condition,snippet}=_ref26;return b`${snippet&&dependencies.length>0?b`if (${block.renderer.dirty(dependencies)}) ${condition} = null;`:null}`;})}\n\t\t\t\t\t\t${this.branches.map((_ref27,i)=>{let{condition,snippet}=_ref27;return condition?b`\n\t\t\t\t\t\t\t\t${snippet&&b`if (${condition} == null) ${condition} = !!${snippet}`}\n\t\t\t\t\t\t\t\tif (${condition}) return ${i};`:b`return ${i};`;})}\n\t\t\t\t\t\t\t\t${!has_else&&b`return -1;`}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t`:b`\n\t\t\t\t\tfunction ${select_block_type}(#ctx, #dirty) {\n\t\t\t\t\t\t${this.branches.map((_ref28,i)=>{let{condition,snippet}=_ref28;return condition?b`if (${snippet||condition}) return ${i};`:b`return ${i};`;})}\n\t\t\t\t\t\t${!has_else&&b`return -1;`}\n\t\t\t\t\t}\n\t\t\t\t`}\n\t\t`);if(need_select_block_ctx){// if all branches needs create a context\nif(this.branches.every(branch=>branch.get_ctx_name)){block.chunks.init.push(b`\n\t\t\t\t\tfunction ${select_block_ctx}(#ctx, #index) {\n\t\t\t\t\t\t${this.branches.map((_ref29,i)=>{let{condition,get_ctx_name}=_ref29;return condition?b`if (#index === ${i}) return ${get_ctx_name}(#ctx);`:b`return ${get_ctx_name}(#ctx);`;}).filter(Boolean)}\n\t\t\t\t\t}\n\t\t\t\t`);}else{// when not all branches need to create a new context,\n// this code is simpler\nblock.chunks.init.push(b`\n\t\t\t\t\tfunction ${select_block_ctx}(#ctx, #index) {\n\t\t\t\t\t\t${this.branches.map((_ref30,i)=>{let{get_ctx_name}=_ref30;return get_ctx_name?b`if (#index === ${i}) return ${get_ctx_name}(#ctx);`:null;}).filter(Boolean)}\n\t\t\t\t\t\treturn #ctx;\n\t\t\t\t\t}\n\t\t\t\t`);}}if(has_else){block.chunks.init.push(b`\n\t\t\t\t${current_block_type_index} = ${select_block_type}(#ctx, ${this.renderer.get_initial_dirty()});\n\t\t\t\t${name} = ${if_blocks}[${current_block_type_index}] = ${if_block_creators}[${current_block_type_index}](${if_ctx});\n\t\t\t`);}else{block.chunks.init.push(b`\n\t\t\t\tif (~(${current_block_type_index} = ${select_block_type}(#ctx, ${this.renderer.get_initial_dirty()}))) {\n\t\t\t\t\t${name} = ${if_blocks}[${current_block_type_index}] = ${if_block_creators}[${current_block_type_index}](${if_ctx});\n\t\t\t\t}\n\t\t\t`);}const initial_mount_node=parent_node||'#target';const anchor_node=parent_node?'null':'#anchor';block.chunks.mount.push(if_current_block_type_index(b`${if_blocks}[${current_block_type_index}].m(${initial_mount_node}, ${anchor_node});`));if(this.needs_update){const update_mount_node=this.get_update_mount_node(anchor);const destroy_old_block=b`\n\t\t\t\t@group_outros();\n\t\t\t\t@transition_out(${if_blocks}[${previous_block_index}], 1, 1, () => {\n\t\t\t\t\t${if_blocks}[${previous_block_index}] = null;\n\t\t\t\t});\n\t\t\t\t@check_outros();\n\t\t\t`;const create_new_block=b`\n\t\t\t\t${name} = ${if_blocks}[${current_block_type_index}];\n\t\t\t\tif (!${name}) {\n\t\t\t\t\t${name} = ${if_blocks}[${current_block_type_index}] = ${if_block_creators}[${current_block_type_index}](${if_ctx});\n\t\t\t\t\t${name}.c();\n\t\t\t\t} else {\n\t\t\t\t\t${dynamic&&b`${name}.p(${if_ctx}, #dirty);`}\n\t\t\t\t}\n\t\t\t\t${has_transitions&&b`@transition_in(${name}, 1);`}\n\t\t\t\t${name}.m(${update_mount_node}, ${anchor});\n\t\t\t`;const change_block=has_else?b`\n\t\t\t\t\t${destroy_old_block}\n\n\t\t\t\t\t${create_new_block}\n\t\t\t\t`:b`\n\t\t\t\t\tif (${name}) {\n\t\t\t\t\t\t${destroy_old_block}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (~${current_block_type_index}) {\n\t\t\t\t\t\t${create_new_block}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t${name} = null;\n\t\t\t\t\t}\n\t\t\t\t`;block.chunks.update.push(b`\n\t\t\t\tlet ${previous_block_index} = ${current_block_type_index};\n\t\t\t\t${current_block_type_index} = ${select_block_type}(#ctx, #dirty);\n\t\t\t`);if(dynamic){block.chunks.update.push(b`\n\t\t\t\t\tif (${current_block_type_index} === ${previous_block_index}) {\n\t\t\t\t\t\t${if_current_block_type_index(b`${if_blocks}[${current_block_type_index}].p(${if_ctx}, #dirty);`)}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t${change_block}\n\t\t\t\t\t}\n\t\t\t\t`);}else{block.chunks.update.push(b`\n\t\t\t\t\tif (${current_block_type_index} !== ${previous_block_index}) {\n\t\t\t\t\t\t${change_block}\n\t\t\t\t\t}\n\t\t\t\t`);}}else if(dynamic){if(if_exists_condition){block.chunks.update.push(b`if (${if_exists_condition}) ${name}.p(${if_ctx}, #dirty);`);}else{block.chunks.update.push(b`${name}.p(${if_ctx}, #dirty);`);}}block.chunks.destroy.push(if_current_block_type_index(b`${if_blocks}[${current_block_type_index}].d(${detaching});`));}render_simple(block,parent_node,_parent_nodes,dynamic,_ref31,detaching){let{name,anchor,if_exists_condition,has_transitions}=_ref31;const branch=this.branches[0];const if_ctx=branch.get_ctx_name?x`${branch.get_ctx_name}(#ctx)`:x`#ctx`;if(branch.snippet)block.add_variable(branch.condition,branch.snippet);block.chunks.init.push(b`\n\t\t\tlet ${name} = ${branch.condition} && ${branch.block.name}(${if_ctx});\n\t\t`);const initial_mount_node=parent_node||'#target';const anchor_node=parent_node?'null':'#anchor';block.chunks.mount.push(b`if (${name}) ${name}.m(${initial_mount_node}, ${anchor_node});`);if(branch.dependencies.length>0){const update_mount_node=this.get_update_mount_node(anchor);const enter=b`\n\t\t\t\tif (${name}) {\n\t\t\t\t\t${dynamic&&b`${name}.p(${if_ctx}, #dirty);`}\n\t\t\t\t\t${has_transitions&&b`if (${block.renderer.dirty(branch.dependencies)}) {\n\t\t\t\t\t\t\t\t\t@transition_in(${name}, 1);\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t} else {\n\t\t\t\t\t${name} = ${branch.block.name}(${if_ctx});\n\t\t\t\t\t${name}.c();\n\t\t\t\t\t${has_transitions&&b`@transition_in(${name}, 1);`}\n\t\t\t\t\t${name}.m(${update_mount_node}, ${anchor});\n\t\t\t\t}\n\t\t\t`;if(branch.snippet){block.chunks.update.push(b`if (${block.renderer.dirty(branch.dependencies)}) ${branch.condition} = ${branch.snippet}`);}// no `p()` here — we don't want to update outroing nodes,\n// as that will typically result in glitching\nif(branch.block.has_outro_method){block.chunks.update.push(b`\n\t\t\t\t\tif (${branch.condition}) {\n\t\t\t\t\t\t${enter}\n\t\t\t\t\t} else if (${name}) {\n\t\t\t\t\t\t@group_outros();\n\t\t\t\t\t\t@transition_out(${name}, 1, 1, () => {\n\t\t\t\t\t\t\t${name} = null;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t@check_outros();\n\t\t\t\t\t}\n\t\t\t\t`);}else{block.chunks.update.push(b`\n\t\t\t\t\tif (${branch.condition}) {\n\t\t\t\t\t\t${enter}\n\t\t\t\t\t} else if (${name}) {\n\t\t\t\t\t\t${name}.d(1);\n\t\t\t\t\t\t${name} = null;\n\t\t\t\t\t}\n\t\t\t\t`);}}else if(dynamic){block.chunks.update.push(b`\n\t\t\t\tif (${branch.condition}) ${name}.p(${if_ctx}, #dirty);\n\t\t\t`);}if(if_exists_condition){block.chunks.destroy.push(b`\n\t\t\t\tif (${if_exists_condition}) ${name}.d(${detaching});\n\t\t\t`);}else{block.chunks.destroy.push(b`\n\t\t\t\t${name}.d(${detaching});\n\t\t\t`);}}}class KeyBlockWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.var={type:'Identifier',name:'key_block'};this.cannot_use_innerhtml();this.not_static_content();this.dependencies=node.expression.dynamic_dependencies();if(this.dependencies.length){block=block.child({comment:create_debugging_comment(node,renderer.component),name:renderer.component.get_unique_name('create_key_block'),type:'key'});block.add_dependencies(node.expression.dependencies);renderer.blocks.push(block);}this.block=block;this.fragment=new FragmentWrapper(renderer,this.block,node.children,this,strip_whitespace,next_sibling);}render(block,parent_node,parent_nodes){if(this.dependencies.length===0){this.render_static_key(block,parent_node,parent_nodes);}else{this.render_dynamic_key(block,parent_node,parent_nodes);}}render_static_key(_block,parent_node,parent_nodes){this.fragment.render(this.block,parent_node,parent_nodes);}render_dynamic_key(block,parent_node,parent_nodes){this.fragment.render(this.block,null,x`#nodes`);const has_transitions=!!(this.block.has_intro_method||this.block.has_outro_method);const dynamic=this.block.has_update_method;const previous_key=block.get_unique_name('previous_key');const snippet=this.node.expression.manipulate(block);block.add_variable(previous_key,snippet);const not_equal=this.renderer.component.component_options.immutable?x`@not_equal`:x`@safe_not_equal`;const condition=x`${this.renderer.dirty(this.dependencies)} && ${not_equal}(${previous_key}, ${previous_key} = ${snippet})`;block.chunks.init.push(b`\n\t\t\tlet ${this.var} = ${this.block.name}(#ctx);\n\t\t`);block.chunks.create.push(b`${this.var}.c();`);if(this.renderer.options.hydratable){block.chunks.claim.push(b`${this.var}.l(${parent_nodes});`);}block.chunks.mount.push(b`${this.var}.m(${parent_node||'#target'}, ${parent_node?'null':'#anchor'});`);const anchor=this.get_or_create_anchor(block,parent_node,parent_nodes);const body=b`\n\t\t\t${has_transitions?b`\n\t\t\t\t\t\t@group_outros();\n\t\t\t\t\t\t@transition_out(${this.var}, 1, 1, @noop);\n\t\t\t\t\t\t@check_outros();\n\t\t\t\t\t`:b`${this.var}.d(1);`}\n\t\t\t${this.var} = ${this.block.name}(#ctx);\n\t\t\t${this.var}.c();\n\t\t\t${has_transitions&&b`@transition_in(${this.var}, 1)`}\n\t\t\t${this.var}.m(${this.get_update_mount_node(anchor)}, ${anchor});\n\t\t`;if(dynamic){block.chunks.update.push(b`\n\t\t\t\tif (${condition}) {\n\t\t\t\t\t${body}\n\t\t\t\t} else {\n\t\t\t\t\t${this.var}.p(#ctx, #dirty);\n\t\t\t\t}\n\t\t\t`);}else{block.chunks.update.push(b`\n\t\t\t\tif (${condition}) {\n\t\t\t\t\t${body}\n\t\t\t\t}\n\t\t\t`);}if(has_transitions){block.chunks.intro.push(b`@transition_in(${this.var})`);block.chunks.outro.push(b`@transition_out(${this.var})`);}block.chunks.destroy.push(b`${this.var}.d(detaching)`);}}function get_slot_definition(block,scope,lets){if(lets.length===0)return{block,scope};const context_input={type:'ObjectPattern',properties:lets.map(l=>({type:'Property',kind:'init',key:l.name,value:l.value||l.name}))};const properties=[];const value_map=new Map();lets.forEach(l=>{let value;if(l.names.length>1){// more than one, probably destructuring\nconst unique_name=block.get_unique_name(l.names.join('_')).name;value_map.set(l.value,unique_name);value={type:'Identifier',name:unique_name};}else{value=l.value||l.name;}properties.push({type:'Property',kind:'init',key:l.name,value});});const changes_input={type:'ObjectPattern',properties};const names=new Set();const names_lookup=new Map();lets.forEach(l=>{l.names.forEach(name=>{names.add(name);if(value_map.has(l.value)){names_lookup.set(name,value_map.get(l.value));}});});const context={type:'ObjectExpression',properties:Array.from(names).map(name=>p`${block.renderer.context_lookup.get(name).index}: ${name}`)};const{context_lookup}=block.renderer;// i am well aware that this code is gross\n// TODO: context-overflow make it less gross\nconst changes={type:'ParenthesizedExpression',get expression(){if(block.renderer.context_overflow){const grouped=[];Array.from(names).forEach(name=>{const i=context_lookup.get(name).index.value;const g=Math.floor(i/31);const lookup_name=names_lookup.has(name)?names_lookup.get(name):name;if(!grouped[g])grouped[g]=[];grouped[g].push({name:lookup_name,n:i%31});});const elements=[];for(let g=0;g<grouped.length;g+=1){elements[g]=grouped[g]?grouped[g].map(_ref32=>{let{name,n}=_ref32;return x`${name} ? ${1<<n} : 0`;}).reduce((lhs,rhs)=>x`${lhs} | ${rhs}`):x`0`;}return{type:'ArrayExpression',elements};}return Array.from(names).map(name=>{const lookup_name=names_lookup.has(name)?names_lookup.get(name):name;const i=context_lookup.get(name).index.value;return x`${lookup_name} ? ${1<<i} : 0`;}).reduce((lhs,rhs)=>x`${lhs} | ${rhs}`);}};return{block,scope,get_context:x`${context_input} => ${context}`,get_changes:x`${changes_input} => ${changes}`};}class SlotTemplateWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);const{scope,lets,const_tags,slot_template_name}=this.node;lets.forEach(l=>{extract_names(l.value||l.name).forEach(name=>{renderer.add_to_context(name,true);});});add_const_tags_context(renderer,const_tags);this.block=block.child({comment:create_debugging_comment(this.node,this.renderer.component),name:this.renderer.component.get_unique_name(`create_${sanitize(slot_template_name)}_slot`),type:'slot'});this.renderer.blocks.push(this.block);const seen=new Set(lets.map(l=>l.name.name));this.parent.node.lets.forEach(l=>{if(!seen.has(l.name.name))lets.push(l);});this.parent.set_slot(slot_template_name,get_slot_definition(this.block,scope,lets));this.fragment=new FragmentWrapper(renderer,this.block,node.type==='SlotTemplate'?node.children:[node],this,strip_whitespace,next_sibling);this.block.parent.add_dependencies(this.block.dependencies);}render(){this.fragment.render(this.block,null,x`#nodes`);if(this.node.const_tags.length>0){this.render_get_context();}}render_get_context(){const get_context=this.block.renderer.component.get_unique_name('get_context');this.block.renderer.blocks.push(b`\n\t\t\tfunction ${get_context}(#ctx) {\n\t\t\t\t${add_const_tags(this.block,this.node.const_tags,'#ctx')}\n\t\t\t}\n\t\t`);this.block.chunks.declarations.push(b`${get_context}(#ctx)`);if(this.block.has_update_method){this.block.chunks.update.unshift(b`${get_context}(#ctx)`);}}}function string_to_member_expression(name){const parts=name.split('.');let node={type:'Identifier',name:parts[0]};for(let i=1;i<parts.length;i++){node={type:'MemberExpression',object:node,property:{type:'Identifier',name:parts[i]}};}return node;}const regex_invalid_variable_identifier_characters$3=/[^a-zA-Z_$]/g;class InlineComponentWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.slots=new Map();this.children=[];this.cannot_use_innerhtml();this.not_static_content();if(this.node.expression){block.add_dependencies(this.node.expression.dependencies);}this.node.attributes.forEach(attr=>{block.add_dependencies(attr.dependencies);});this.node.bindings.forEach(binding=>{if(binding.is_contextual){mark_each_block_bindings(this,binding);}block.add_dependencies(binding.expression.dependencies);});this.node.handlers.forEach(handler=>{if(handler.expression){block.add_dependencies(handler.expression.dependencies);}});this.node.css_custom_properties.forEach(attr=>{block.add_dependencies(attr.dependencies);});this.var={type:'Identifier',name:(this.node.name==='svelte:self'?renderer.component.name.name:this.node.name==='svelte:component'?'switch_instance':sanitize(this.node.name)).toLowerCase()};if(this.node.children.length){this.node.lets.forEach(l=>{extract_names(l.value||l.name).forEach(name=>{renderer.add_to_context(name,true);});});this.children=this.node.children.map(child=>new SlotTemplateWrapper(renderer,block,this,child,strip_whitespace,next_sibling));}block.add_outro();}set_slot(name,slot_definition){if(this.slots.has(name)){if(name==='default'){throw new Error('Found elements without slot attribute when using slot=\"default\"');}throw new Error(`Duplicate slot name \"${name}\" in <${this.node.name}>`);}this.slots.set(name,slot_definition);}warn_if_reactive(){const{name}=this.node;const variable=this.renderer.component.var_lookup.get(name);if(!variable){return;}if(variable.reassigned||variable.export_name||variable.is_reactive_dependency){this.renderer.component.warn(this.node,compiler_warnings.reactive_component(name));}}render(block,parent_node,parent_nodes){this.warn_if_reactive();const{renderer}=this;const{component}=renderer;const name=this.var;block.add_variable(name);const component_opts=x`{}`;const statements=[];const updates=[];this.children.forEach(child=>{this.renderer.add_to_context('$$scope',true);child.render(block,null,x`#nodes`);});let props;const name_changes=block.get_unique_name(`${name.name}_changes`);const uses_spread=!!this.node.attributes.find(a=>a.is_spread);// removing empty slot\nfor(const slot of this.slots.keys()){if(!this.slots.get(slot).block.has_content()){this.renderer.remove_block(this.slots.get(slot).block);this.slots.delete(slot);}}const has_css_custom_properties=this.node.css_custom_properties.length>0;const is_svg_namespace=this.node.namespace===namespaces.svg;const css_custom_properties_wrapper_element=is_svg_namespace?'g':'div';const css_custom_properties_wrapper=has_css_custom_properties?block.get_unique_name(css_custom_properties_wrapper_element):null;if(has_css_custom_properties){block.add_variable(css_custom_properties_wrapper);}const initial_props=this.slots.size>0?[p`$$slots: {\n\t\t\t\t\t${Array.from(this.slots).map(_ref33=>{let[name,slot]=_ref33;return p`${name}: [${slot.block.name}, ${slot.get_context||null}, ${slot.get_changes||null}]`;})}\n\t\t\t\t}`,p`$$scope: {\n\t\t\t\t\tctx: #ctx\n\t\t\t\t}`]:[];const attribute_object=uses_spread?x`{ ${initial_props} }`:x`{\n\t\t\t\t${this.node.attributes.map(attr=>p`${attr.name}: ${attr.get_value(block)}`)},\n\t\t\t\t${initial_props}\n\t\t\t}`;if(this.node.attributes.length||this.node.bindings.length||initial_props.length){if(!uses_spread&&this.node.bindings.length===0){component_opts.properties.push(p`props: ${attribute_object}`);}else{props=block.get_unique_name(`${name.name}_props`);component_opts.properties.push(p`props: ${props}`);}}if(component.compile_options.dev){// TODO this is a terrible hack, but without it the component\n// will complain that options.target is missing. This would\n// work better if components had separate public and private\n// APIs\ncomponent_opts.properties.push(p`$$inline: true`);}const fragment_dependencies=new Set(this.slots.size?['$$scope']:[]);this.slots.forEach(slot=>{slot.block.dependencies.forEach(name=>{const is_let=slot.scope.is_let(name);const variable=renderer.component.var_lookup.get(name);if(is_let||is_dynamic(variable))fragment_dependencies.add(name);});});const dynamic_attributes=this.node.attributes.filter(a=>a.get_dependencies().length>0);if(!uses_spread&&(dynamic_attributes.length>0||this.node.bindings.length>0||fragment_dependencies.size>0)){updates.push(b`const ${name_changes} = {};`);}if(this.node.attributes.length){if(uses_spread){const levels=block.get_unique_name(`${this.var.name}_spread_levels`);const initial_props=[];const changes=[];const all_dependencies=new Set();this.node.attributes.forEach(attr=>{add_to_set(all_dependencies,attr.dependencies);});this.node.attributes.forEach((attr,i)=>{const{name,dependencies}=attr;const condition=dependencies.size>0&&dependencies.size!==all_dependencies.size?renderer.dirty(Array.from(dependencies)):null;const unchanged=dependencies.size===0;let change_object;if(attr.is_spread){const value=attr.expression.manipulate(block);initial_props.push(value);let value_object=value;if(attr.expression.node.type!=='ObjectExpression'){value_object=x`@get_spread_object(${value})`;}change_object=value_object;}else{const obj=x`{ ${name}: ${attr.get_value(block)} }`;initial_props.push(obj);change_object=obj;}changes.push(unchanged?x`${levels}[${i}]`:condition?x`${condition} && ${change_object}`:change_object);});block.chunks.init.push(b`\n\t\t\t\t\tconst ${levels} = [\n\t\t\t\t\t\t${initial_props}\n\t\t\t\t\t];\n\t\t\t\t`);statements.push(b`\n\t\t\t\t\tfor (let #i = 0; #i < ${levels}.length; #i += 1) {\n\t\t\t\t\t\t${props} = @assign(${props}, ${levels}[#i]);\n\t\t\t\t\t}\n\t\t\t\t`);if(all_dependencies.size){const condition=renderer.dirty(Array.from(all_dependencies));updates.push(b`\n\t\t\t\t\t\tconst ${name_changes} = ${condition} ? @get_spread_update(${levels}, [\n\t\t\t\t\t\t\t${changes}\n\t\t\t\t\t\t]) : {}\n\t\t\t\t\t`);}else{updates.push(b`\n\t\t\t\t\t\tconst ${name_changes} = {};\n\t\t\t\t\t`);}}else{dynamic_attributes.forEach(attribute=>{const dependencies=attribute.get_dependencies();if(dependencies.length>0){const condition=renderer.dirty(dependencies);updates.push(b`\n\t\t\t\t\t\t\tif (${condition}) ${name_changes}.${attribute.name} = ${attribute.get_value(block)};\n\t\t\t\t\t\t`);}});}}if(fragment_dependencies.size>0){updates.push(b`\n\t\t\t\tif (${renderer.dirty(Array.from(fragment_dependencies))}) {\n\t\t\t\t\t${name_changes}.$$scope = { dirty: #dirty, ctx: #ctx };\n\t\t\t\t}`);}const munged_bindings=this.node.bindings.map(binding=>{component.has_reactive_assignments=true;if(binding.name==='this'){return bind_this(component,block,new BindingWrapper(block,binding,this),this.var);}const id=component.get_unique_name(`${this.var.name}_${binding.name}_binding`);renderer.add_to_context(id.name);const callee=renderer.reference(id);const updating=block.get_unique_name(`updating_${binding.name}`);block.add_variable(updating);const snippet=binding.expression.manipulate(block);statements.push(b`\n\t\t\t\tif (${snippet} !== void 0) {\n\t\t\t\t\t${props}.${binding.name} = ${snippet};\n\t\t\t\t}`);updates.push(b`\n\t\t\t\tif (!${updating} && ${renderer.dirty(Array.from(binding.expression.dependencies))}) {\n\t\t\t\t\t${updating} = true;\n\t\t\t\t\t${name_changes}.${binding.name} = ${snippet};\n\t\t\t\t\t@add_flush_callback(() => ${updating} = false);\n\t\t\t\t}\n\t\t\t`);const contextual_dependencies=Array.from(binding.expression.contextual_dependencies);const dependencies=Array.from(binding.expression.dependencies);let lhs=binding.raw_expression;if(binding.is_contextual&&binding.expression.node.type==='Identifier'){// bind:x={y} — we can't just do `y = x`, we need to\n// to `array[index] = x;\nconst{name}=binding.expression.node;const{object,property,snippet}=block.bindings.get(name);lhs=snippet;contextual_dependencies.push(object.name,property.name);}const params=[x`#value`];const args=[x`#value`];if(contextual_dependencies.length>0){contextual_dependencies.forEach(name=>{params.push({type:'Identifier',name});renderer.add_to_context(name,true);args.push(renderer.reference(name));});block.maintain_context=true;// TODO put this somewhere more logical\n}block.chunks.init.push(b`\n\t\t\t\tfunction ${id}(#value) {\n\t\t\t\t\t${callee}(${args});\n\t\t\t\t}\n\t\t\t`);let invalidate_binding=b`\n\t\t\t\t${lhs} = #value;\n\t\t\t\t${renderer.invalidate(dependencies[0])};\n\t\t\t`;if(binding.expression.node.type==='MemberExpression'){invalidate_binding=b`\n\t\t\t\t\tif ($$self.$$.not_equal(${lhs}, #value)) {\n\t\t\t\t\t\t${invalidate_binding}\n\t\t\t\t\t}\n\t\t\t\t`;}const body=b`\n\t\t\t\tfunction ${id}(${params}) {\n\t\t\t\t\t${invalidate_binding}\n\t\t\t\t}\n\t\t\t`;component.partly_hoisted.push(body);return b`@binding_callbacks.push(() => @bind(${this.var}, '${binding.name}', ${id}));`;});const munged_handlers=this.node.handlers.map(handler=>{const event_handler=new EventHandlerWrapper(handler,this);let snippet=event_handler.get_snippet(block);if(handler.modifiers.has('once'))snippet=x`@once(${snippet})`;return b`${name}.$on(\"${handler.name}\", ${snippet});`;});const mount_target=has_css_custom_properties?css_custom_properties_wrapper:parent_node||'#target';const mount_anchor=has_css_custom_properties?'null':parent_node?'null':'#anchor';const to_claim=parent_nodes&&this.renderer.options.hydratable;let claim_nodes=parent_nodes;if(this.node.name==='svelte:component'){const switch_value=block.get_unique_name('switch_value');const switch_props=block.get_unique_name('switch_props');const snippet=this.node.expression.manipulate(block);if(has_css_custom_properties){this.set_css_custom_properties(block,css_custom_properties_wrapper,css_custom_properties_wrapper_element,is_svg_namespace);}block.chunks.init.push(b`\n\t\t\t\tvar ${switch_value} = ${snippet};\n\n\t\t\t\tfunction ${switch_props}(#ctx) {\n\t\t\t\t\t${(this.node.attributes.length>0||this.node.bindings.length>0)&&b`\n\t\t\t\t\t${props&&b`let ${props} = ${attribute_object};`}`}\n\t\t\t\t\t${statements}\n\t\t\t\t\treturn ${component_opts};\n\t\t\t\t}\n\n\t\t\t\tif (${switch_value}) {\n\t\t\t\t\t${name} = @construct_svelte_component(${switch_value}, ${switch_props}(#ctx));\n\n\t\t\t\t\t${munged_bindings}\n\t\t\t\t\t${munged_handlers}\n\t\t\t\t}\n\t\t\t`);block.chunks.create.push(b`if (${name}) @create_component(${name}.$$.fragment);`);if(css_custom_properties_wrapper)this.create_css_custom_properties_wrapper_mount_chunk(block,parent_node,css_custom_properties_wrapper);block.chunks.mount.push(b`if (${name}) @mount_component(${name}, ${mount_target}, ${mount_anchor});`);if(to_claim){if(css_custom_properties_wrapper)claim_nodes=this.create_css_custom_properties_wrapper_claim_chunk(block,claim_nodes,css_custom_properties_wrapper,css_custom_properties_wrapper_element,is_svg_namespace);block.chunks.claim.push(b`if (${name}) @claim_component(${name}.$$.fragment, ${claim_nodes});`);}if(updates.length){block.chunks.update.push(b`\n\t\t\t\t\t${updates}\n\t\t\t\t`);}const tmp_anchor=this.get_or_create_anchor(block,parent_node,parent_nodes);const anchor=has_css_custom_properties?'null':tmp_anchor;const update_mount_node=has_css_custom_properties?css_custom_properties_wrapper:this.get_update_mount_node(tmp_anchor);const update_insert=css_custom_properties_wrapper&&(tmp_anchor.name!=='null'?b`@insert(${tmp_anchor}.parentNode, ${css_custom_properties_wrapper}, ${tmp_anchor});`:b`@insert(${parent_node}, ${css_custom_properties_wrapper}, ${tmp_anchor});`);block.chunks.update.push(b`\n\t\t\t\tif (${switch_value} !== (${switch_value} = ${snippet})) {\n\t\t\t\t\tif (${name}) {\n\t\t\t\t\t\t@group_outros();\n\t\t\t\t\t\tconst old_component = ${name};\n\t\t\t\t\t\t@transition_out(old_component.$$.fragment, 1, 0, () => {\n\t\t\t\t\t\t\t@destroy_component(old_component, 1);\n\t\t\t\t\t\t\t${has_css_custom_properties?b`@detach(${update_mount_node})`:null}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t@check_outros();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (${switch_value}) {\n\t\t\t\t\t\t${update_insert}\n\t\t\t\t\t\t${name} = @construct_svelte_component(${switch_value}, ${switch_props}(#ctx));\n\n\t\t\t\t\t\t${munged_bindings}\n\t\t\t\t\t\t${munged_handlers}\n\n\t\t\t\t\t\t@create_component(${name}.$$.fragment);\n\t\t\t\t\t\t@transition_in(${name}.$$.fragment, 1);\n\t\t\t\t\t\t@mount_component(${name}, ${update_mount_node}, ${anchor});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t${name} = null;\n\t\t\t\t\t}\n\t\t\t\t} else if (${switch_value}) {\n\t\t\t\t\t${updates.length>0&&b`${name}.$set(${name_changes});`}\n\t\t\t\t}\n\t\t\t`);block.chunks.intro.push(b`\n\t\t\t\tif (${name}) @transition_in(${name}.$$.fragment, #local);\n\t\t\t`);block.chunks.outro.push(b`if (${name}) @transition_out(${name}.$$.fragment, #local);`);block.chunks.destroy.push(b`if (${name}) @destroy_component(${name}, ${parent_node?null:'detaching'});`);}else{const expression=this.node.name==='svelte:self'?component.name:this.renderer.reference(string_to_member_expression(this.node.name));block.chunks.init.push(b`\n\t\t\t\t${(this.node.attributes.length>0||this.node.bindings.length>0)&&b`\n\t\t\t\t${props&&b`let ${props} = ${attribute_object};`}`}\n\t\t\t\t${statements}\n\t\t\t\t${name} = new ${expression}(${component_opts});\n\n\t\t\t\t${munged_bindings}\n\t\t\t\t${munged_handlers}\n\t\t\t`);if(has_css_custom_properties){this.set_css_custom_properties(block,css_custom_properties_wrapper,css_custom_properties_wrapper_element,is_svg_namespace);}block.chunks.create.push(b`@create_component(${name}.$$.fragment);`);if(css_custom_properties_wrapper)this.create_css_custom_properties_wrapper_mount_chunk(block,parent_node,css_custom_properties_wrapper);block.chunks.mount.push(b`@mount_component(${name}, ${mount_target}, ${mount_anchor});`);if(to_claim){if(css_custom_properties_wrapper)claim_nodes=this.create_css_custom_properties_wrapper_claim_chunk(block,claim_nodes,css_custom_properties_wrapper,css_custom_properties_wrapper_element,is_svg_namespace);block.chunks.claim.push(b`@claim_component(${name}.$$.fragment, ${claim_nodes});`);}block.chunks.intro.push(b`\n\t\t\t\t@transition_in(${name}.$$.fragment, #local);\n\t\t\t`);if(updates.length){block.chunks.update.push(b`\n\t\t\t\t\t${updates}\n\t\t\t\t\t${name}.$set(${name_changes});\n\t\t\t\t`);}block.chunks.destroy.push(b`\n\t\t\t\t@destroy_component(${name}, ${parent_node?null:'detaching'});\n\t\t\t`);block.chunks.outro.push(b`@transition_out(${name}.$$.fragment, #local);`);}}create_css_custom_properties_wrapper_mount_chunk(block,parent_node,css_custom_properties_wrapper){if(parent_node){block.chunks.mount.push(b`@append(${parent_node}, ${css_custom_properties_wrapper})`);if(is_head(parent_node)){block.chunks.destroy.push(b`@detach(${css_custom_properties_wrapper});`);}}else{block.chunks.mount.push(b`@insert(#target, ${css_custom_properties_wrapper}, #anchor);`);// TODO we eventually need to consider what happens to elements\n// that belong to the same outgroup as an outroing element...\nblock.chunks.destroy.push(b`if (detaching && ${this.var}) @detach(${css_custom_properties_wrapper});`);}}create_css_custom_properties_wrapper_claim_chunk(block,parent_nodes,css_custom_properties_wrapper,css_custom_properties_wrapper_element,is_svg_namespace){const nodes=block.get_unique_name(`${css_custom_properties_wrapper.name}_nodes`);const claim_element=is_svg_namespace?x`@claim_svg_element`:x`@claim_element`;block.chunks.claim.push(b`\n\t\t\t${css_custom_properties_wrapper} = ${claim_element}(${parent_nodes}, \"${css_custom_properties_wrapper_element.toUpperCase()}\", { style: true })\n\t\t\tvar ${nodes} = @children(${css_custom_properties_wrapper});\n\t\t`);return nodes;}set_css_custom_properties(block,css_custom_properties_wrapper,css_custom_properties_wrapper_element,is_svg_namespace){const element=is_svg_namespace?x`@svg_element`:x`@element`;block.chunks.create.push(b`${css_custom_properties_wrapper} = ${element}(\"${css_custom_properties_wrapper_element}\");`);if(!is_svg_namespace)block.chunks.hydrate.push(b`@set_style(${css_custom_properties_wrapper}, \"display\", \"contents\");`);this.node.css_custom_properties.forEach(attr=>{const dependencies=attr.get_dependencies();const should_cache=attr.should_cache();const last=should_cache&&block.get_unique_name(`${attr.name.replace(regex_invalid_variable_identifier_characters$3,'_')}_last`);if(should_cache)block.add_variable(last);const value=attr.get_value(block);const init=should_cache?x`${last} = ${value}`:value;block.chunks.hydrate.push(b`@set_style(${css_custom_properties_wrapper}, \"${attr.name}\", ${init});`);if(dependencies.length>0){let condition=block.renderer.dirty(dependencies);if(should_cache)condition=x`${condition} && (${last} !== (${last} = ${value}))`;block.chunks.update.push(b`\n\t\t\t\t\tif (${condition}) {\n\t\t\t\t\t\t@set_style(${css_custom_properties_wrapper}, \"${attr.name}\", ${should_cache?last:value});\n\t\t\t\t\t}\n\t\t\t\t`);}});}}function get_slot_data(values){let block=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return{type:'ObjectExpression',properties:Array.from(values.values()).filter(attribute=>attribute.name!=='name').map(attribute=>{if(attribute.is_spread){const argument=get_spread_value(block,attribute);return{type:'SpreadElement',argument};}const value=get_value(block,attribute);return p`${attribute.name}: ${value}`;})};}function get_value(block,attribute){if(attribute.is_true)return x`true`;if(attribute.chunks.length===0)return x`\"\"`;let value=attribute.chunks.map(chunk=>chunk.type==='Text'?string_literal(chunk.data):block?chunk.manipulate(block):chunk.node).reduce((lhs,rhs)=>x`${lhs} + ${rhs}`);if(attribute.chunks.length>1&&attribute.chunks[0].type!=='Text'){value=x`\"\" + ${value}`;}return value;}function get_spread_value(block,attribute){return block?attribute.expression.manipulate(block):attribute.expression.node;}class SlotWrapper extends Wrapper{constructor(renderer,block,parent,node,strip_whitespace,next_sibling){super(renderer,block,parent,node);this.fallback=null;this.var={type:'Identifier',name:'slot'};this.dependencies=new Set(['$$scope']);this.cannot_use_innerhtml();this.not_static_content();if(this.node.children.length){this.fallback=block.child({comment:create_debugging_comment(this.node.children[0],this.renderer.component),name:this.renderer.component.get_unique_name('fallback_block'),type:'fallback'});renderer.blocks.push(this.fallback);}this.fragment=new FragmentWrapper(renderer,this.fallback,node.children,this,strip_whitespace,next_sibling);this.node.values.forEach(attribute=>{add_to_set(this.dependencies,attribute.dependencies);});block.add_dependencies(this.dependencies);// we have to do this, just in case\nblock.add_intro();block.add_outro();}render(block,parent_node,parent_nodes){const{renderer}=this;const{slot_name}=this.node;if(this.slot_block){block=this.slot_block;}let get_slot_changes_fn;let get_slot_spread_changes_fn;let get_slot_context_fn;if(this.node.values.size>0){get_slot_changes_fn=renderer.component.get_unique_name(`get_${sanitize(slot_name)}_slot_changes`);get_slot_context_fn=renderer.component.get_unique_name(`get_${sanitize(slot_name)}_slot_context`);const changes=x`{}`;const spread_dynamic_dependencies=new Set();this.node.values.forEach(attribute=>{if(attribute.type==='Spread'){add_to_set(spread_dynamic_dependencies,Array.from(attribute.dependencies).filter(name=>this.is_dependency_dynamic(name)));}else{const dynamic_dependencies=Array.from(attribute.dependencies).filter(name=>this.is_dependency_dynamic(name));if(dynamic_dependencies.length>0){changes.properties.push(p`${attribute.name}: ${renderer.dirty(dynamic_dependencies)}`);}}});renderer.blocks.push(b`\n\t\t\t\tconst ${get_slot_changes_fn} = #dirty => ${changes};\n\t\t\t\tconst ${get_slot_context_fn} = #ctx => ${get_slot_data(this.node.values,block)};\n\t\t\t`);if(spread_dynamic_dependencies.size){get_slot_spread_changes_fn=renderer.component.get_unique_name(`get_${sanitize(slot_name)}_slot_spread_changes`);renderer.blocks.push(b`\n\t\t\t\t\tconst ${get_slot_spread_changes_fn} = #dirty => ${renderer.dirty(Array.from(spread_dynamic_dependencies))};\n\t\t\t\t`);}}else{get_slot_changes_fn='null';get_slot_context_fn='null';}let has_fallback=!!this.fallback;if(this.fallback){this.fragment.render(this.fallback,null,x`#nodes`);has_fallback=this.fallback.has_content();if(!has_fallback){renderer.remove_block(this.fallback);}}const slot=block.get_unique_name(`${sanitize(slot_name)}_slot`);const slot_definition=block.get_unique_name(`${sanitize(slot_name)}_slot_template`);const slot_or_fallback=has_fallback?block.get_unique_name(`${sanitize(slot_name)}_slot_or_fallback`):slot;block.chunks.init.push(b`\n\t\t\tconst ${slot_definition} = ${renderer.reference('#slots')}.${slot_name};\n\t\t\tconst ${slot} = @create_slot(${slot_definition}, #ctx, ${renderer.reference('$$scope')}, ${get_slot_context_fn});\n\t\t\t${has_fallback?b`const ${slot_or_fallback} = ${slot} || ${this.fallback.name}(#ctx);`:null}\n\t\t`);block.chunks.create.push(b`if (${slot_or_fallback}) ${slot_or_fallback}.c();`);if(renderer.options.hydratable){block.chunks.claim.push(b`if (${slot_or_fallback}) ${slot_or_fallback}.l(${parent_nodes});`);}block.chunks.mount.push(b`\n\t\t\tif (${slot_or_fallback}) {\n\t\t\t\t${slot_or_fallback}.m(${parent_node||'#target'}, ${parent_node?'null':'#anchor'});\n\t\t\t}\n\t\t`);block.chunks.intro.push(b`@transition_in(${slot_or_fallback}, #local);`);block.chunks.outro.push(b`@transition_out(${slot_or_fallback}, #local);`);const dynamic_dependencies=Array.from(this.dependencies).filter(name=>this.is_dependency_dynamic(name));const fallback_dynamic_dependencies=has_fallback?Array.from(this.fallback.dependencies).filter(name=>this.is_dependency_dynamic(name)):[];let condition=renderer.dirty(dynamic_dependencies);if(block.has_outros){condition=x`!#current || ${condition}`;}// conditions to treat everything as dirty\nconst all_dirty_conditions=[get_slot_spread_changes_fn?x`${get_slot_spread_changes_fn}(#dirty)`:null,block.has_outros?x`!#current`:null].filter(Boolean);const all_dirty_condition=all_dirty_conditions.length?all_dirty_conditions.reduce((condition1,condition2)=>x`${condition1} || ${condition2}`):null;let slot_update;if(all_dirty_condition){const dirty=x`${all_dirty_condition} ? @get_all_dirty_from_scope(${renderer.reference('$$scope')}) : @get_slot_changes(${slot_definition}, ${renderer.reference('$$scope')}, #dirty, ${get_slot_changes_fn})`;slot_update=b`\n\t\t\t\tif (${slot}.p && ${condition}) {\n\t\t\t\t\t@update_slot_base(${slot}, ${slot_definition}, #ctx, ${renderer.reference('$$scope')}, ${dirty}, ${get_slot_context_fn});\n\t\t\t\t}\n\t\t\t`;}else{slot_update=b`\n\t\t\t\tif (${slot}.p && ${condition}) {\n\t\t\t\t\t@update_slot(${slot}, ${slot_definition}, #ctx, ${renderer.reference('$$scope')}, #dirty, ${get_slot_changes_fn}, ${get_slot_context_fn});\n\t\t\t\t}\n\t\t\t`;}let fallback_condition=renderer.dirty(fallback_dynamic_dependencies);let fallback_dirty=x`#dirty`;if(block.has_outros){fallback_condition=x`!#current || ${fallback_condition}`;fallback_dirty=x`!#current ? ${renderer.get_initial_dirty()} : ${fallback_dirty}`;}const fallback_update=has_fallback&&fallback_dynamic_dependencies.length>0&&b`\n\t\t\tif (${slot_or_fallback} && ${slot_or_fallback}.p && ${fallback_condition}) {\n\t\t\t\t${slot_or_fallback}.p(#ctx, ${fallback_dirty});\n\t\t\t}\n\t\t`;if(fallback_update){block.chunks.update.push(b`\n\t\t\t\tif (${slot}) {\n\t\t\t\t\t${slot_update}\n\t\t\t\t} else {\n\t\t\t\t\t${fallback_update}\n\t\t\t\t}\n\t\t\t`);}else{block.chunks.update.push(b`\n\t\t\t\tif (${slot}) {\n\t\t\t\t\t${slot_update}\n\t\t\t\t}\n\t\t\t`);}block.chunks.destroy.push(b`if (${slot_or_fallback}) ${slot_or_fallback}.d(detaching);`);}is_dependency_dynamic(name){if(name==='$$scope')return true;if(this.node.scope.is_let(name))return true;if(is_reserved_keyword(name))return true;const variable=this.renderer.component.var_lookup.get(name);return is_dynamic(variable);}}class TitleWrapper extends Wrapper{constructor(renderer,block,parent,node,_strip_whitespace,_next_sibling){super(renderer,block,parent,node);}render(block,_parent_node,_parent_nodes){const is_dynamic=!!this.node.children.find(node=>node.type!=='Text');if(is_dynamic){let value;const all_dependencies=new Set();// TODO some of this code is repeated in Tag.ts — would be good to\n// DRY it out if that's possible without introducing crazy indirection\nif(this.node.children.length===1){// single {tag} — may be a non-string\n// @ts-ignore todo: check this\nconst{expression}=this.node.children[0];value=expression.manipulate(block);add_to_set(all_dependencies,expression.dependencies);}else{// '{foo} {bar}' — treat as string concatenation\nvalue=this.node.children.map(chunk=>{if(chunk.type==='Text')return string_literal(chunk.data);chunk.expression.dependencies.forEach(d=>{all_dependencies.add(d);});return chunk.expression.manipulate(block);}).reduce((lhs,rhs)=>x`${lhs} + ${rhs}`);if(this.node.children[0].type!=='Text'){value=x`\"\" + ${value}`;}}const last=this.node.should_cache&&block.get_unique_name('title_value');if(this.node.should_cache)block.add_variable(last);const init=this.node.should_cache?x`${last} = ${value}`:value;block.chunks.init.push(b`@_document.title = ${init};`);const updater=b`@_document.title = ${this.node.should_cache?last:value};`;if(all_dependencies.size){const dependencies=Array.from(all_dependencies);let condition=block.renderer.dirty(dependencies);if(block.has_outros){condition=x`!#current || ${condition}`;}if(this.node.should_cache){condition=x`${condition} && (${last} !== (${last} = ${value}))`;}block.chunks.update.push(b`\n\t\t\t\t\tif (${condition}) {\n\t\t\t\t\t\t${updater}\n\t\t\t\t\t}`);}}else{const value=this.node.children.length>0?string_literal(this.node.children[0].data):x`\"\"`;block.chunks.hydrate.push(b`@_document.title = ${value};`);}}}const associated_events={innerWidth:'resize',innerHeight:'resize',outerWidth:'resize',outerHeight:'resize',scrollX:'scroll',scrollY:'scroll'};const properties$1={scrollX:'pageXOffset',scrollY:'pageYOffset'};const readonly=new Set(['innerWidth','innerHeight','outerWidth','outerHeight','online']);class WindowWrapper extends Wrapper{constructor(renderer,block,parent,node){super(renderer,block,parent,node);this.handlers=this.node.handlers.map(handler=>new EventHandlerWrapper(handler,this));}render(block,_parent_node,_parent_nodes){const{renderer}=this;const{component}=renderer;const events={};const bindings={};add_actions(block,'@_window',this.node.actions);add_event_handlers(block,'@_window',this.handlers);this.node.bindings.forEach(binding=>{// TODO: what if it's a MemberExpression?\nconst binding_name=binding.expression.node.name;// in dev mode, throw if read-only values are written to\nif(readonly.has(binding.name)){renderer.readonly.add(binding_name);}bindings[binding.name]=binding_name;// bind:online is a special case, we need to listen for two separate events\nif(binding.name==='online')return;const associated_event=associated_events[binding.name];const property=properties$1[binding.name]||binding.name;if(!events[associated_event])events[associated_event]=[];events[associated_event].push({name:binding_name,value:property});});const scrolling=block.get_unique_name('scrolling');const clear_scrolling=block.get_unique_name('clear_scrolling');const scrolling_timeout=block.get_unique_name('scrolling_timeout');Object.keys(events).forEach(event=>{const id=block.get_unique_name(`onwindow${event}`);const props=events[event];renderer.add_to_context(id.name);const fn=renderer.reference(id.name);if(event==='scroll'){// TODO other bidirectional bindings...\nblock.add_variable(scrolling,x`false`);block.add_variable(clear_scrolling,x`() => { ${scrolling} = false }`);block.add_variable(scrolling_timeout);const condition=bindings.scrollX&&bindings.scrollY?x`\"${bindings.scrollX}\" in this._state || \"${bindings.scrollY}\" in this._state`:x`\"${bindings.scrollX||bindings.scrollY}\" in this._state`;const scrollX=bindings.scrollX&&x`this._state.${bindings.scrollX}`;const scrollY=bindings.scrollY&&x`this._state.${bindings.scrollY}`;renderer.meta_bindings.push(b`\n\t\t\t\t\tif (${condition}) {\n\t\t\t\t\t\t@_scrollTo(${scrollX||'@_window.pageXOffset'}, ${scrollY||'@_window.pageYOffset'});\n\t\t\t\t\t}\n\t\t\t\t\t${scrollX&&`${scrollX} = @_window.pageXOffset;`}\n\t\t\t\t\t${scrollY&&`${scrollY} = @_window.pageYOffset;`}\n\t\t\t\t`);block.event_listeners.push(x`\n\t\t\t\t\t@listen(@_window, \"${event}\", () => {\n\t\t\t\t\t\t${scrolling} = true;\n\t\t\t\t\t\t@_clearTimeout(${scrolling_timeout});\n\t\t\t\t\t\t${scrolling_timeout} = @_setTimeout(${clear_scrolling}, 100);\n\t\t\t\t\t\t${fn}();\n\t\t\t\t\t})\n\t\t\t\t`);}else{props.forEach(prop=>{renderer.meta_bindings.push(b`this._state.${prop.name} = @_window.${prop.value};`);});block.event_listeners.push(x`\n\t\t\t\t\t@listen(@_window, \"${event}\", ${fn})\n\t\t\t\t`);}component.partly_hoisted.push(b`\n\t\t\t\tfunction ${id}() {\n\t\t\t\t\t${props.map(prop=>renderer.invalidate(prop.name,x`${prop.name} = @_window.${prop.value}`))}\n\t\t\t\t}\n\t\t\t`);block.chunks.init.push(b`\n\t\t\t\t@add_render_callback(${fn});\n\t\t\t`);component.has_reactive_assignments=true;});// special case... might need to abstract this out if we add more special cases\nif(bindings.scrollX||bindings.scrollY){const condition=renderer.dirty([bindings.scrollX,bindings.scrollY].filter(Boolean));const scrollX=bindings.scrollX?renderer.reference(bindings.scrollX):x`@_window.pageXOffset`;const scrollY=bindings.scrollY?renderer.reference(bindings.scrollY):x`@_window.pageYOffset`;block.chunks.update.push(b`\n\t\t\t\tif (${condition} && !${scrolling}) {\n\t\t\t\t\t${scrolling} = true;\n\t\t\t\t\t@_clearTimeout(${scrolling_timeout});\n\t\t\t\t\t@_scrollTo(${scrollX}, ${scrollY});\n\t\t\t\t\t${scrolling_timeout} = @_setTimeout(${clear_scrolling}, 100);\n\t\t\t\t}\n\t\t\t`);}// another special case. (I'm starting to think these are all special cases.)\nif(bindings.online){const id=block.get_unique_name('onlinestatuschanged');const name=bindings.online;renderer.add_to_context(id.name);const reference=renderer.reference(id.name);component.partly_hoisted.push(b`\n\t\t\t\tfunction ${id}() {\n\t\t\t\t\t${renderer.invalidate(name,x`${name} = @_navigator.onLine`)}\n\t\t\t\t}\n\t\t\t`);block.chunks.init.push(b`\n\t\t\t\t@add_render_callback(${reference});\n\t\t\t`);block.event_listeners.push(x`@listen(@_window, \"online\", ${reference})`,x`@listen(@_window, \"offline\", ${reference})`);component.has_reactive_assignments=true;}}}function link(next,prev){prev.next=next;if(next)next.prev=prev;}const wrappers={AwaitBlock:AwaitBlockWrapper,Body:BodyWrapper,Comment:null,DebugTag:DebugTagWrapper,EachBlock:EachBlockWrapper,Element:ElementWrapper,Head:HeadWrapper,IfBlock:IfBlockWrapper,InlineComponent:InlineComponentWrapper,KeyBlock:KeyBlockWrapper,MustacheTag:MustacheTagWrapper,Options:null,RawMustacheTag:RawMustacheTagWrapper,Slot:SlotWrapper,SlotTemplate:SlotTemplateWrapper,Text:TextWrapper,Title:TitleWrapper,Window:WindowWrapper};function trimmable_at(child,next_sibling){// Whitespace is trimmable if one of the following is true:\n// The child and its sibling share a common nearest each block (not at an each block boundary)\n// The next sibling's previous node is an each block\nreturn next_sibling.node.find_nearest(/EachBlock/)===child.find_nearest(/EachBlock/)||next_sibling.node.prev.type==='EachBlock';}class FragmentWrapper{constructor(renderer,block,nodes,parent,strip_whitespace,next_sibling){this.nodes=[];let last_child;let window_wrapper;let i=nodes.length;while(i--){const child=nodes[i];if(!child.type){throw new Error('missing type');}if(!(child.type in wrappers)){throw new Error(`TODO implement ${child.type}`);}// special case — this is an easy way to remove whitespace surrounding\n// <svelte:window/>. lil hacky but it works\nif(child.type==='Window'){window_wrapper=new WindowWrapper(renderer,block,parent,child);continue;}if(child.type==='Text'){let{data}=child;// We want to remove trailing whitespace inside an element/component/block,\n// *unless* there is no whitespace between this node and its next sibling\nif(this.nodes.length===0){const should_trim=next_sibling?next_sibling.node.type==='Text'&&regex_starts_with_whitespace.test(next_sibling.node.data)&&trimmable_at(child,next_sibling):!child.has_ancestor('EachBlock');if(should_trim&&!child.keep_space()){data=trim_end(data);if(!data)continue;}}// glue text nodes (which could e.g. be separated by comments) together\nif(last_child&&last_child.node.type==='Text'){last_child.data=data+last_child.data;continue;}const wrapper=new TextWrapper(renderer,block,parent,child,data);if(wrapper.skip)continue;this.nodes.unshift(wrapper);link(last_child,last_child=wrapper);}else{const Wrapper=wrappers[child.type];if(!Wrapper)continue;const wrapper=new Wrapper(renderer,block,parent,child,strip_whitespace,last_child||next_sibling);this.nodes.unshift(wrapper);link(last_child,last_child=wrapper);}}if(strip_whitespace){const first=this.nodes[0];if(first&&first.node.type==='Text'&&!first.node.keep_space()){first.data=trim_start(first.data);if(!first.data){first.var=null;this.nodes.shift();if(this.nodes[0]){this.nodes[0].prev=null;}}}}if(window_wrapper){this.nodes.unshift(window_wrapper);link(last_child,window_wrapper);}}render(block,parent_node,parent_nodes){for(let i=0;i<this.nodes.length;i+=1){this.nodes[i].render(block,parent_node,parent_nodes);}}}class Renderer{constructor(component,options){this.context=[];this.initial_context=[];this.context_lookup=new Map();this.blocks=[];this.readonly=new Set();this.meta_bindings=[];// initial values for e.g. window.innerWidth, if there's a <svelte:window> meta tag\nthis.binding_groups=new Map();this.component=component;this.options=options;this.locate=component.locate;// TODO messy\nthis.file_var=options.dev&&this.component.get_unique_name('file');component.vars.filter(v=>!v.hoistable||v.export_name&&!v.module).forEach(v=>this.add_to_context(v.name));// ensure store values are included in context\ncomponent.vars.filter(v=>v.subscribable).forEach(v=>this.add_to_context(`$${v.name}`));reserved_keywords.forEach(keyword=>{if(component.var_lookup.has(keyword)){this.add_to_context(keyword);}});if(component.slots.size>0){this.add_to_context('$$scope');this.add_to_context('#slots');}if(this.binding_groups.size>0){this.add_to_context('$$binding_groups');}// main block\nthis.block=new Block$1({renderer:this,name:null,type:'component',key:null,bindings:new Map(),dependencies:new Set()});this.block.has_update_method=true;this.fragment=new FragmentWrapper(this,this.block,component.fragment.children,null,true,null);// TODO messy\nthis.blocks.forEach(block=>{if(block instanceof Block$1){block.assign_variable_names();}});this.block.assign_variable_names();this.fragment.render(this.block,null,x`#nodes`);this.context_overflow=this.context.length>31;this.context.forEach(member=>{const{variable}=member;if(variable){member.priority+=2;if(variable.mutated||variable.reassigned)member.priority+=4;// these determine whether variable is included in initial context\n// array, so must have the highest priority\nif(variable.is_reactive_dependency&&(variable.mutated||variable.reassigned))member.priority+=16;if(variable.export_name)member.priority+=32;if(variable.referenced)member.priority+=64;}else if(member.is_non_contextual){// determine whether variable is included in initial context\n// array, so must have the highest priority\nmember.priority+=8;}if(!member.is_contextual){member.priority+=1;}});this.context.sort((a,b)=>b.priority-a.priority||a.index.value-b.index.value);this.context.forEach((member,i)=>member.index.value=i);let i=this.context.length;while(i--){const member=this.context[i];if(member.variable){if(member.variable.referenced||member.variable.export_name||member.variable.is_reactive_dependency&&(member.variable.mutated||member.variable.reassigned))break;}else if(member.is_non_contextual){break;}}this.initial_context=this.context.slice(0,i+1);}add_to_context(name){let contextual=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!this.context_lookup.has(name)){const member={name,index:{type:'Literal',value:this.context.length},is_contextual:false,is_non_contextual:false,variable:null,priority:0};this.context_lookup.set(name,member);this.context.push(member);}const member=this.context_lookup.get(name);if(contextual){member.is_contextual=true;}else{member.is_non_contextual=true;member.variable=this.component.var_lookup.get(name);}return member;}invalidate(name,value){let main_execution_context=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return renderer_invalidate(this,name,value,main_execution_context);}dirty(names){let is_reactive_declaration=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;const renderer=this;const dirty=is_reactive_declaration?x`$$self.$$.dirty`:x`#dirty`;const get_bitmask=()=>{const bitmask=[];names.forEach(name=>{const member=renderer.context_lookup.get(name);if(!member)return;if(member.index.value===-1){throw new Error('unset index');}const value=member.index.value;const i=value/31|0;const n=1<<value%31;if(!bitmask[i])bitmask[i]={n:0,names:[]};bitmask[i].n|=n;bitmask[i].names.push(name);});return bitmask;};// TODO: context-overflow make it less gross\nreturn{// Using a ParenthesizedExpression allows us to create\n// the expression lazily. TODO would be better if\n// context was determined before rendering, so that\n// this indirection was unnecessary\ntype:'ParenthesizedExpression',get expression(){const bitmask=get_bitmask();if(!bitmask.length){return x`${dirty} & /*${names.join(', ')}*/ 0`;}if(renderer.context_overflow){return bitmask.map((b,i)=>({b,i})).filter(_ref34=>{let{b}=_ref34;return b;}).map(_ref35=>{let{b,i}=_ref35;return x`${dirty}[${i}] & /*${b.names.join(', ')}*/ ${b.n}`;}).reduce((lhs,rhs)=>x`${lhs} | ${rhs}`);}return x`${dirty} & /*${names.join(', ')}*/ ${bitmask[0].n}`;}};}// NOTE: this method may be called before this.context_overflow / this.context is fully defined\n// therefore, they can only be evaluated later in a getter function\nget_initial_dirty(){const _this=this;// TODO: context-overflow make it less gross\nconst val=x`-1`;return{get type(){return _this.context_overflow?'ArrayExpression':'UnaryExpression';},// as [-1]\nget elements(){const elements=[];for(let i=0;i<_this.context.length;i+=31){elements.push(val);}return elements;},// as -1\noperator:val.operator,prefix:val.prefix,argument:val.argument};}reference(node){let ctx=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'#ctx';if(typeof node==='string'){node={type:'Identifier',name:node};}const{name,nodes}=flatten_reference(node);const member=this.context_lookup.get(name);// TODO is this correct?\nif(this.component.var_lookup.get(name)){this.component.add_reference(node,name);}if(member!==undefined){const replacement=x`/*${member.name}*/ ${ctx}[${member.index}]`;if(nodes[0].loc)replacement.object.loc=nodes[0].loc;nodes[0]=replacement;return nodes.reduce((lhs,rhs)=>x`${lhs}.${rhs}`);}return node;}remove_block(block){this.blocks.splice(this.blocks.indexOf(block),1);}}var charToInteger$1={};var chars$1='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';for(var i$3=0;i$3<chars$1.length;i$3++){charToInteger$1[chars$1.charCodeAt(i$3)]=i$3;}function decode$1(mappings){var decoded=[];var line=[];var segment=[0,0,0,0,0];var j=0;for(var i=0,shift=0,value=0;i<mappings.length;i++){var c=mappings.charCodeAt(i);if(c===44){// \",\"\nsegmentify$1(line,segment,j);j=0;}else if(c===59){// \";\"\nsegmentify$1(line,segment,j);j=0;decoded.push(line);line=[];segment[0]=0;}else{var integer=charToInteger$1[c];if(integer===undefined){throw new Error('Invalid character ('+String.fromCharCode(c)+')');}var hasContinuationBit=integer&32;integer&=31;value+=integer<<shift;if(hasContinuationBit){shift+=5;}else{var shouldNegate=value&1;value>>>=1;if(shouldNegate){value=value===0?-0x80000000:-value;}segment[j]+=value;j++;value=shift=0;// reset\n}}}segmentify$1(line,segment,j);decoded.push(line);return decoded;}function segmentify$1(line,segment,j){// This looks ugly, but we're creating specialized arrays with a specific\n// length. This is much faster than creating a new array (which v8 expands to\n// a capacity of 17 after pushing the first item), or slicing out a subarray\n// (which is slow). Length 4 is assumed to be the most frequent, followed by\n// length 5 (since not everything will have an associated name), followed by\n// length 1 (it's probably rare for a source substring to not have an\n// associated segment data).\nif(j===4)line.push([segment[0],segment[1],segment[2],segment[3]]);else if(j===5)line.push([segment[0],segment[1],segment[2],segment[3],segment[4]]);else if(j===1)line.push([segment[0]]);}function encode$1(decoded){var sourceFileIndex=0;// second field\nvar sourceCodeLine=0;// third field\nvar sourceCodeColumn=0;// fourth field\nvar nameIndex=0;// fifth field\nvar mappings='';for(var i=0;i<decoded.length;i++){var line=decoded[i];if(i>0)mappings+=';';if(line.length===0)continue;var generatedCodeColumn=0;// first field\nvar lineMappings=[];for(var _i=0,line_1=line;_i<line_1.length;_i++){var segment=line_1[_i];var segmentMappings=encodeInteger$1(segment[0]-generatedCodeColumn);generatedCodeColumn=segment[0];if(segment.length>1){segmentMappings+=encodeInteger$1(segment[1]-sourceFileIndex)+encodeInteger$1(segment[2]-sourceCodeLine)+encodeInteger$1(segment[3]-sourceCodeColumn);sourceFileIndex=segment[1];sourceCodeLine=segment[2];sourceCodeColumn=segment[3];}if(segment.length===5){segmentMappings+=encodeInteger$1(segment[4]-nameIndex);nameIndex=segment[4];}lineMappings.push(segmentMappings);}mappings+=lineMappings.join(',');}return mappings;}function encodeInteger$1(num){var result='';num=num<0?-num<<1|1:num<<1;do{var clamped=num&31;num>>>=5;if(num>0){clamped|=32;}result+=chars$1[clamped];}while(num>0);return result;}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ /**\n * Creates a brand new (prototype-less) object with the enumerable-own\n * properties of `target`. Any enumerable-own properties from `source` which\n * are not present on `target` will be copied as well.\n */function defaults(target,source){return Object.assign(Object.create(null),source,target);}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ /**\n * Decodes an input sourcemap into a `DecodedSourceMap` sourcemap object.\n *\n * Valid input maps include a `DecodedSourceMap`, a `RawSourceMap`, or JSON\n * representations of either type.\n */function decodeSourceMap(map){if(typeof map==='string'){map=JSON.parse(map);}let{mappings}=map;if(typeof mappings==='string'){mappings=decode$1(mappings);}else{// Clone the Line so that we can sort it. We don't want to mutate an array\n// that we don't own directly.\nmappings=mappings.map(cloneSegmentLine);}// Sort each Line's segments. There's no guarantee that segments are sorted for us,\n// and even Chrome's implementation sorts:\n// https://cs.chromium.org/chromium/src/third_party/devtools-frontend/src/front_end/sdk/SourceMap.js?l=507-508&rcl=109232bcf479c8f4ef8ead3cf56c49eb25f8c2f0\nmappings.forEach(sortSegments);return defaults({mappings},map);}function cloneSegmentLine(segments){return segments.slice();}function sortSegments(segments){segments.sort(segmentComparator);}function segmentComparator(a,b){return a[0]-b[0];}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ /**\n * A \"leaf\" node in the sourcemap tree, representing an original, unmodified\n * source file. Recursive segment tracing ends at the `OriginalSource`.\n */class OriginalSource{constructor(filename,content){this.filename=filename;this.content=content;}/**\n     * Tracing a `SourceMapSegment` ends when we get to an `OriginalSource`,\n     * meaning this line/column location originated from this source file.\n     */traceSegment(line,column,name){return{column,line,name,source:this};}}/* istanbul ignore next */const Url$1=typeof URL!=='undefined'?URL:__webpack_require__(/*! url */ \"./node_modules/url/url.js\").URL;// Matches \"..\", which must be preceeded by \"/\" or the start of the string, and\n// must be followed by a \"/\". We do not eat the following \"/\", so that the next\n// iteration can match on it.\nconst parentRegex=/(^|\\/)\\.\\.(?=\\/|$)/g;function isAbsoluteUrl(url){try{return!!new Url$1(url);}catch(e){return false;}}/**\n * Creates a directory name that is guaranteed to not be in `str`.\n */function uniqInStr(str){let uniq=String(Math.random()).slice(2);while(str.indexOf(uniq)>-1){/* istanbul ignore next */uniq+=uniq;}return uniq;}/**\n * Removes the filename from the path (everything trailing the last \"/\"). This\n * is only safe to call on a path, never call with an absolute or protocol\n * relative URL.\n */function stripPathFilename(path){path=normalizePath(path);const index=path.lastIndexOf('/');return path.slice(0,index+1);}/**\n * Normalizes a protocol-relative URL, but keeps it protocol relative by\n * stripping out the protocl before returning it.\n */function normalizeProtocolRelative(input,absoluteBase){const{href,protocol}=new Url$1(input,absoluteBase);return href.slice(protocol.length);}/**\n * Normalizes a simple path (one that has no \"..\"s, or is absolute so \"..\"s can\n * be normalized absolutely).\n */function normalizeSimplePath(input){const{href}=new Url$1(input,'https://foo.com/');return href.slice('https://foo.com/'.length);}/**\n * Normalizes a path, ensuring that excess \"..\"s are preserved for relative\n * paths in the output.\n *\n * If the input is absolute, this will return an absolutey normalized path, but\n * it will not have a leading \"/\".\n *\n * If the input has a leading \"..\", the output will have a leading \"..\".\n *\n * If the input has a leading \".\", the output will not have a leading \".\"\n * unless there are too many \"..\"s, in which case there will be a leading \"..\".\n */function normalizePath(input){// If there are no \"..\"s, we can treat this as if it were an absolute path.\n// The return won't be an absolute path, so it's easy.\nif(!parentRegex.test(input))return normalizeSimplePath(input);// We already found one \"..\". Let's see how many there are.\nlet total=1;while(parentRegex.test(input))total++;// If there are \"..\"s, we need to prefix the the path with the same number of\n// unique directories. This is to ensure that we \"remember\" how many parent\n// directories we are accessing. Eg, \"../../..\" must keep 3, and \"foo/../..\"\n// must keep 1.\nconst uniqDirectory=`z${uniqInStr(input)}/`;// uniqDirectory is just a \"z\", followed by numbers, followed by a \"/\". So\n// generating a runtime regex from it is safe. We'll use this search regex to\n// strip out our uniq directory names and insert any needed \"..\"s.\nconst search=new RegExp(`^(?:${uniqDirectory})*`);// Now we can resolve the total path. If there are excess \"..\"s, they will\n// eliminate one or more of the unique directories we prefix with.\nconst relative=normalizeSimplePath(uniqDirectory.repeat(total)+input);// We can now count the number of unique directories that were eliminated. If\n// there were 3, and 1 was eliminated, we know we only need to add 1 \"..\". If\n// 2 were eliminated, we need to insert 2 \"..\"s. If all 3 were eliminated,\n// then we need 3, etc. This replace is guranteed to match (it may match 0 or\n// more times), and we can count the total match to see how many were eliminated.\nreturn relative.replace(search,all=>{const leftover=all.length/uniqDirectory.length;return'../'.repeat(total-leftover);});}/**\n * Attempts to resolve `input` URL relative to `base`.\n */function resolve(input,base){if(!base)base='';// Absolute URLs are very easy to resolve right.\nif(isAbsoluteUrl(input))return new Url$1(input).href;if(base){// Absolute URLs are easy...\nif(isAbsoluteUrl(base))return new Url$1(input,base).href;// If base is protocol relative, we'll resolve with it but keep the result\n// protocol relative.\nif(base.startsWith('//'))return normalizeProtocolRelative(input,`https:${base}`);}// Normalize input, but keep it protocol relative. We know base doesn't supply\n// a protocol, because that would have been handled above.\nif(input.startsWith('//'))return normalizeProtocolRelative(input,'https://foo.com/');// We now know that base (if there is one) and input are paths. We've handled\n// both absolute and protocol-relative variations above.\n// Absolute paths don't need any special handling, because they cannot have\n// extra \".\" or \"..\"s. That'll all be stripped away. Input takes priority here,\n// because if input is an absolute path, base path won't affect it in any way.\nif(input.startsWith('/'))return'/'+normalizeSimplePath(input);// Since input and base are paths, we need to join them to do any further\n// processing. Paths are joined at the directory level, so we need to remove\n// the base's filename before joining. We also know that input does not have a\n// leading slash, and that the stripped base will have a trailing slash if\n// there are any directories (or it'll be empty).\nconst joined=stripPathFilename(base)+input;// If base is an absolute path, then input will be relative to it.\nif(base.startsWith('/'))return'/'+normalizeSimplePath(joined);// We now know both base (if there is one) and input are relative paths.\nconst relative=normalizePath(joined);// If base started with a leading \".\", or there is no base and input started\n// with a \".\", then we need to ensure that the relative path starts with a\n// \".\". We don't know if relative starts with a \"..\", though, so check before\n// prepending.\nif((base||input).startsWith('.')&&!relative.startsWith('.')){return'./'+relative;}return relative;}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function resolve$1(input,base){// The base is always treated as a directory, if it's not empty.\n// https://github.com/mozilla/source-map/blob/8cb3ee57/lib/util.js#L327\n// https://github.com/chromium/chromium/blob/da4adbb3/third_party/blink/renderer/devtools/front_end/sdk/SourceMap.js#L400-L401\nif(base&&!base.endsWith('/'))base+='/';return resolve(input,base);}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ /**\n * A binary search implementation that returns the index if a match is found,\n * or the negated index of where the `needle` should be inserted.\n *\n * The `comparator` callback receives both the `item` under comparison and the\n * needle we are searching for. It must return `0` if the `item` is a match,\n * any negative number if `item` is too small (and we must search after it), or\n * any positive number if the `item` is too large (and we must search before\n * it).\n *\n * If no match is found, a negated index of where to insert the `needle` is\n * returned. This negated index is guaranteed to be less than 0. To insert an\n * item, negate it (again) and splice:\n *\n * ```js\n * const array = [1, 3];\n * const needle = 2;\n * const index = binarySearch(array, needle, (item, needle) => item - needle);\n *\n * assert.equal(index, -2);\n * assert.equal(~index, 1);\n * array.splice(~index, 0, needle);\n * assert.deepEqual(array, [1, 2, 3]);\n * ```\n */function binarySearch(haystack,needle,comparator){let low=0;let high=haystack.length-1;while(low<=high){const mid=low+(high-low>>1);const cmp=comparator(haystack[mid],needle);if(cmp===0){return mid;}if(cmp<0){low=mid+1;}else{high=mid-1;}}return~low;}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ /**\n * FastStringArray acts like a `Set` (allowing only one occurrence of a string\n * `key`), but provides the index of the `key` in the backing array.\n *\n * This is designed to allow synchronizing a second array with the contents of\n * the backing array, like how `sourcesContent[i]` is the source content\n * associated with `source[i]`, and there are never duplicates.\n */class FastStringArray{constructor(){this.indexes=Object.create(null);this.array=[];}/**\n     * Puts `key` into the backing array, if it is not already present. Returns\n     * the index of the `key` in the backing array.\n     */put(key){const{array,indexes}=this;// The key may or may not be present. If it is present, it's a number.\nlet index=indexes[key];// If it's not yet present, we need to insert it and track the index in the\n// indexes.\nif(index===undefined){index=indexes[key]=array.length;array.push(key);}return index;}}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ /**\n * SourceMapTree represents a single sourcemap, with the ability to trace\n * mappings into its child nodes (which may themselves be SourceMapTrees).\n */class SourceMapTree{constructor(map,sources){this.map=map;this.sources=sources;}/**\n     * traceMappings is only called on the root level SourceMapTree, and begins\n     * the process of resolving each mapping in terms of the original source\n     * files.\n     */traceMappings(){const mappings=[];const names=new FastStringArray();const sources=new FastStringArray();const sourcesContent=[];const{mappings:rootMappings,names:rootNames}=this.map;for(let i=0;i<rootMappings.length;i++){const segments=rootMappings[i];const tracedSegments=[];for(let j=0;j<segments.length;j++){const segment=segments[j];// 1-length segments only move the current generated column, there's no\n// source information to gather from it.\nif(segment.length===1)continue;const source=this.sources[segment[1]];const traced=source.traceSegment(segment[2],segment[3],segment.length===5?rootNames[segment[4]]:'');if(!traced)continue;// So we traced a segment down into its original source file. Now push a\n// new segment pointing to this location.\nconst{column,line,name}=traced;const{content,filename}=traced.source;// Store the source location, and ensure we keep sourcesContent up to\n// date with the sources array.\nconst sourceIndex=sources.put(filename);sourcesContent[sourceIndex]=content;// This looks like unnecessary duplication, but it noticeably increases\n// performance. If we were to push the nameIndex onto length-4 array, v8\n// would internally allocate 22 slots! That's 68 wasted bytes! Array\n// literals have the same capacity as their length, saving memory.\nif(name){tracedSegments.push([segment[0],sourceIndex,line,column,names.put(name)]);}else{tracedSegments.push([segment[0],sourceIndex,line,column]);}}mappings.push(tracedSegments);}// TODO: Make all sources relative to the sourceRoot.\nreturn defaults({mappings,names:names.array,sources:sources.array,sourcesContent},this.map);}/**\n     * traceSegment is only called on children SourceMapTrees. It recurses down\n     * into its own child SourceMapTrees, until we find the original source map.\n     */traceSegment(line,column,name){const{mappings,names}=this.map;// It's common for parent sourcemaps to have pointers to lines that have no\n// mapping (like a \"//# sourceMappingURL=\") at the end of the child file.\nif(line>=mappings.length)return null;const segments=mappings[line];if(segments.length===0)return null;let index=binarySearch(segments,column,segmentComparator$1);if(index===-1)return null;// we come before any mapped segment\n// If we can't find a segment that lines up to this column, we use the\n// segment before.\nif(index<0){index=~index-1;}const segment=segments[index];// 1-length segments only move the current generated column, there's no\n// source information to gather from it.\nif(segment.length===1)return null;const source=this.sources[segment[1]];// So now we can recurse down, until we hit the original source file.\nreturn source.traceSegment(segment[2],segment[3],// A child map's recorded name for this segment takes precedence over the\n// parent's mapped name. Imagine a mangler changing the name over, etc.\nsegment.length===5?names[segment[4]]:name);}}function segmentComparator$1(segment,column){return segment[0]-column;}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ /**\n * Removes the filename from a path.\n */function stripFilename(path){if(!path)return'';const index=path.lastIndexOf('/');return path.slice(0,index+1);}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function asArray(value){if(Array.isArray(value))return value;return[value];}/**\n * Recursively builds a tree structure out of sourcemap files, with each node\n * being either an `OriginalSource` \"leaf\" or a `SourceMapTree` composed of\n * `OriginalSource`s and `SourceMapTree`s.\n *\n * Every sourcemap is composed of a collection of source files and mappings\n * into locations of those source files. When we generate a `SourceMapTree` for\n * the sourcemap, we attempt to load each source file's own sourcemap. If it\n * does not have an associated sourcemap, it is considered an original,\n * unmodified source file.\n */function buildSourceMapTree(input,loader,relativeRoot){const maps=asArray(input).map(decodeSourceMap);const map=maps.pop();for(let i=0;i<maps.length;i++){if(maps[i].sources.length!==1){throw new Error(`Transformation map ${i} must have exactly one source file.\\n`+'Did you specify these with the most recent transformation maps first?');}}const{sourceRoot,sources,sourcesContent}=map;const children=sources.map((sourceFile,i)=>{// Each source file is loaded relative to the sourcemap's own sourceRoot,\n// which is itself relative to the sourcemap's parent.\nconst uri=resolve$1(sourceFile||'',resolve$1(sourceRoot||'',stripFilename(relativeRoot)));// Use the provided loader callback to retrieve the file's sourcemap.\n// TODO: We should eventually support async loading of sourcemap files.\nconst sourceMap=loader(uri);// If there is no sourcemap, then it is an unmodified source file.\nif(!sourceMap){// The source file's actual contents must be included in the sourcemap\n// (done when generating the sourcemap) for it to be included as a\n// sourceContent in the output sourcemap.\nconst sourceContent=sourcesContent?sourcesContent[i]:null;return new OriginalSource(uri,sourceContent);}// Else, it's a real sourcemap, and we need to recurse into it to load its\n// source files.\nreturn buildSourceMapTree(decodeSourceMap(sourceMap),loader,uri);});let tree=new SourceMapTree(map,children);for(let i=maps.length-1;i>=0;i--){tree=new SourceMapTree(maps[i],[tree]);}return tree;}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ /**\n * A SourceMap v3 compatible sourcemap, which only includes fields that were\n * provided to it.\n */class SourceMap{constructor(map,excludeContent){this.version=3;// SourceMap spec says this should be first.\nif('file'in map)this.file=map.file;this.mappings=encode$1(map.mappings);this.names=map.names;// TODO: We first need to make all source URIs relative to the sourceRoot\n// before we can support a sourceRoot.\n// if ('sourceRoot' in map) this.sourceRoot = map.sourceRoot;\nthis.sources=map.sources;if(!excludeContent&&'sourcesContent'in map)this.sourcesContent=map.sourcesContent;}toString(){return JSON.stringify(this);}}/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ /**\n * Traces through all the mappings in the root sourcemap, through the sources\n * (and their sourcemaps), all the way back to the original source location.\n *\n * `loader` will be called every time we encounter a source file. If it returns\n * a sourcemap, we will recurse into that sourcemap to continue the trace. If\n * it returns a falsey value, that source file is treated as an original,\n * unmodified source file.\n *\n * Pass `excludeContent` content to exclude any self-containing source file\n * content from the output sourcemap.\n */function remapping(input,loader,excludeContent){const graph=buildSourceMapTree(input,loader);return new SourceMap(graph.traceMappings(),!!excludeContent);}function last_line_length(s){return s.length-s.lastIndexOf('\\n')-1;}// mutate map in-place\nfunction sourcemap_add_offset(map,offset,source_index){if(map.mappings.length==0)return;for(let line=0;line<map.mappings.length;line++){const segment_list=map.mappings[line];for(let segment=0;segment<segment_list.length;segment++){const seg=segment_list[segment];// shift only segments that belong to component source file\nif(seg[1]===source_index){// also ensures that seg.length >= 4\n// shift column if it points at the first line\nif(seg[2]===0){seg[3]+=offset.column;}// shift line\nseg[2]+=offset.line;}}}}function merge_tables(this_table,other_table){const new_table=this_table.slice();const idx_map=[];other_table=other_table||[];let val_changed=false;for(const[other_idx,other_val]of other_table.entries()){const this_idx=this_table.indexOf(other_val);if(this_idx>=0){idx_map[other_idx]=this_idx;}else{const new_idx=new_table.length;new_table[new_idx]=other_val;idx_map[other_idx]=new_idx;val_changed=true;}}let idx_changed=val_changed;if(val_changed){if(idx_map.find((val,idx)=>val!=idx)===undefined){// idx_map is identity map [0, 1, 2, 3, 4, ....]\nidx_changed=false;}}return[new_table,idx_map,val_changed,idx_changed];}const regex_line_token=/([^\\d\\w\\s]|\\s+)/g;class MappedCode{constructor(){let string=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';let map=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.string=string;if(map){this.map=map;}else{this.map={version:3,mappings:[],sources:[],names:[]};}}/**\n     * concat in-place (mutable), return this (chainable)\n     * will also mutate the `other` object\n     */concat(other){// noop: if one is empty, return the other\nif(other.string=='')return this;if(this.string==''){this.string=other.string;this.map=other.map;return this;}// compute last line length before mutating\nconst column_offset=last_line_length(this.string);this.string+=other.string;const m1=this.map;const m2=other.map;if(m2.mappings.length==0)return this;// combine sources and names\nconst[sources,new_source_idx,sources_changed,sources_idx_changed]=merge_tables(m1.sources,m2.sources);const[names,new_name_idx,names_changed,names_idx_changed]=merge_tables(m1.names,m2.names);if(sources_changed)m1.sources=sources;if(names_changed)m1.names=names;// unswitched loops are faster\nif(sources_idx_changed&&names_idx_changed){for(let line=0;line<m2.mappings.length;line++){const segment_list=m2.mappings[line];for(let segment=0;segment<segment_list.length;segment++){const seg=segment_list[segment];if(seg[1]>=0)seg[1]=new_source_idx[seg[1]];if(seg[4]>=0)seg[4]=new_name_idx[seg[4]];}}}else if(sources_idx_changed){for(let line=0;line<m2.mappings.length;line++){const segment_list=m2.mappings[line];for(let segment=0;segment<segment_list.length;segment++){const seg=segment_list[segment];if(seg[1]>=0)seg[1]=new_source_idx[seg[1]];}}}else if(names_idx_changed){for(let line=0;line<m2.mappings.length;line++){const segment_list=m2.mappings[line];for(let segment=0;segment<segment_list.length;segment++){const seg=segment_list[segment];if(seg[4]>=0)seg[4]=new_name_idx[seg[4]];}}}// combine the mappings\n// combine\n// 1. last line of first map\n// 2. first line of second map\n// columns of 2 must be shifted\nif(m2.mappings.length>0&&column_offset>0){const first_line=m2.mappings[0];for(let i=0;i<first_line.length;i++){first_line[i][0]+=column_offset;}}// combine last line + first line\npush_array$1(m1.mappings[m1.mappings.length-1],m2.mappings.shift());// append other lines\npush_array$1(m1.mappings,m2.mappings);return this;}static from_processed(string,map){const line_count=string.split('\\n').length;if(map){// ensure that count of source map mappings lines\n// is equal to count of generated code lines\n// (some tools may produce less)\nconst missing_lines=line_count-map.mappings.length;for(let i=0;i<missing_lines;i++){map.mappings.push([]);}return new MappedCode(string,map);}if(string=='')return new MappedCode();map={version:3,names:[],sources:[],mappings:[]};// add empty SourceMapSegment[] for every line\nfor(let i=0;i<line_count;i++)map.mappings.push([]);return new MappedCode(string,map);}static from_source(_ref36){let{source,file_basename,get_location}=_ref36;let offset=get_location(0);if(!offset)offset={line:0,column:0};const map={version:3,names:[],sources:[file_basename],mappings:[]};if(source=='')return new MappedCode(source,map);// we create a high resolution identity map here,\n// we know that it will eventually be merged with svelte's map,\n// at which stage the resolution will decrease.\nconst line_list=source.split('\\n');for(let line=0;line<line_list.length;line++){map.mappings.push([]);const token_list=line_list[line].split(regex_line_token);for(let token=0,column=0;token<token_list.length;token++){if(token_list[token]=='')continue;map.mappings[line].push([column,0,offset.line+line,column]);column+=token_list[token].length;}}// shift columns in first line\nconst segment_list=map.mappings[0];for(let segment=0;segment<segment_list.length;segment++){segment_list[segment][3]+=offset.column;}return new MappedCode(source,map);}}function combine_sourcemaps(filename,sourcemap_list){if(sourcemap_list.length==0)return null;let map_idx=1;const map=sourcemap_list.slice(0,-1).find(m=>m.sources.length!==1)===undefined?remapping(// use array interface\n// only the oldest sourcemap can have multiple sources\nsourcemap_list,()=>null,true// skip optional field `sourcesContent`\n):remapping(// use loader interface\nsourcemap_list[0],// last map\nfunction loader(sourcefile){if(sourcefile===filename&&sourcemap_list[map_idx]){return sourcemap_list[map_idx++];// idx 1, 2, ...\n// bundle file = branch node\n}else{return null;// source file = leaf node\n}},true);if(!map.file)delete map.file;// skip optional field `file`\n// When source maps are combined and the leading map is empty, sources is not set.\n// Add the filename to the empty array in this case.\n// Further improvements to remapping may help address this as well https://github.com/ampproject/remapping/issues/116\nif(!map.sources.length)map.sources=[filename];return map;}// browser vs node.js\nconst b64enc=typeof btoa=='function'?btoa:b=>Buffer.from(b).toString('base64');const b64dec=typeof atob=='function'?atob:a=>Buffer.from(a,'base64').toString();function apply_preprocessor_sourcemap(filename,svelte_map,preprocessor_map_input){if(!svelte_map||!preprocessor_map_input)return svelte_map;const preprocessor_map=typeof preprocessor_map_input==='string'?JSON.parse(preprocessor_map_input):preprocessor_map_input;const result_map=combine_sourcemaps(filename,[svelte_map,preprocessor_map]);// Svelte expects a SourceMap which includes toUrl and toString. Instead of wrapping our output in a class,\n// we just tack on the extra properties.\nObject.defineProperties(result_map,{toString:{enumerable:false,value:function toString(){return JSON.stringify(this);}},toUrl:{enumerable:false,value:function toUrl(){return'data:application/json;charset=utf-8;base64,'+b64enc(this.toString());}}});return result_map;}const regex_data_uri=/data:(?:application|text)\\/json;(?:charset[:=]\\S+?;)?base64,(\\S*)/;// parse attached sourcemap in processed.code\nfunction parse_attached_sourcemap(processed,tag_name){const r_in='[#@]\\\\s*sourceMappingURL\\\\s*=\\\\s*(\\\\S*)';const regex=tag_name=='script'?new RegExp('(?://'+r_in+')|(?:/\\\\*'+r_in+'\\\\s*\\\\*/)$'):new RegExp('/\\\\*'+r_in+'\\\\s*\\\\*/$');function log_warning(message){// code_start: help to find preprocessor\nconst code_start=processed.code.length<100?processed.code:processed.code.slice(0,100)+' [...]';console.warn(`warning: ${message}. processed.code = ${JSON.stringify(code_start)}`);}processed.code=processed.code.replace(regex,(_,match1,match2)=>{const map_url=tag_name=='script'?match1||match2:match1;const map_data=(map_url.match(regex_data_uri)||[])[1];if(map_data){// sourceMappingURL is data URL\nif(processed.map){log_warning('Not implemented. '+'Found sourcemap in both processed.code and processed.map. '+'Please update your preprocessor to return only one sourcemap.');// ignore attached sourcemap\nreturn'';}processed.map=b64dec(map_data);// use attached sourcemap\nreturn'';// remove from processed.code\n}// sourceMappingURL is path or URL\nif(!processed.map){log_warning(`Found sourcemap path ${JSON.stringify(map_url)} in processed.code, but no sourcemap data. `+'Please update your preprocessor to return sourcemap data directly.');}// ignore sourcemap path\nreturn'';// remove from processed.code\n});}function check_enable_sourcemap(enable_sourcemap,namespace){return typeof enable_sourcemap==='boolean'?enable_sourcemap:enable_sourcemap[namespace];}function dom(component,options){const{name}=component;const renderer=new Renderer(component,options);const{block}=renderer;block.has_outro_method=true;// prevent fragment being created twice (#1063)\nif(options.customElement)block.chunks.create.push(b`this.c = @noop;`);const body=[];if(renderer.file_var){const file=component.file?x`\"${component.file}\"`:x`undefined`;body.push(b`const ${renderer.file_var} = ${file};`);}const css=component.stylesheet.render(options.filename,!options.customElement);const css_sourcemap_enabled=check_enable_sourcemap(options.enableSourcemap,'css');if(css_sourcemap_enabled){css.map=apply_preprocessor_sourcemap(options.filename,css.map,options.sourcemap);}else{css.map=null;}const styles=css_sourcemap_enabled&&component.stylesheet.has_styles&&options.dev?`${css.code}\\n/*# sourceMappingURL=${css.map.toUrl()} */`:css.code;const add_css=component.get_unique_name('add_css');const should_add_css=!options.customElement&&!!styles&&options.css!==false;if(should_add_css){body.push(b`\n\t\t\tfunction ${add_css}(target) {\n\t\t\t\t@append_styles(target, \"${component.stylesheet.id}\", \"${styles}\");\n\t\t\t}\n\t\t`);}// fix order\n// TODO the deconflicted names of blocks are reversed... should set them here\nconst blocks=renderer.blocks.slice().reverse();push_array$1(body,blocks.map(block=>{// TODO this is a horrible mess — renderer.blocks\n// contains a mixture of Blocks and Nodes\nif(block.render)return block.render();return block;}));if(options.dev&&!options.hydratable){block.chunks.claim.push(b`throw new @_Error(\"options.hydrate only works if the component was compiled with the \\`hydratable: true\\` option\");`);}const uses_slots=component.var_lookup.has('$$slots');let compute_slots;if(uses_slots){compute_slots=b`\n\t\t\tconst $$slots = @compute_slots(#slots);\n\t\t`;}const uses_props=component.var_lookup.has('$$props');const uses_rest=component.var_lookup.has('$$restProps');const $$props=uses_props||uses_rest?'$$new_props':'$$props';const props=component.vars.filter(variable=>!variable.module&&variable.export_name);const writable_props=props.filter(variable=>variable.writable);const omit_props_names=component.get_unique_name('omit_props_names');const compute_rest=x`@compute_rest_props($$props, ${omit_props_names.name})`;const rest=uses_rest?b`\n\t\tconst ${omit_props_names.name} = [${props.map(prop=>`\"${prop.export_name}\"`).join(',')}];\n\t\tlet $$restProps = ${compute_rest};\n\t`:null;const set=uses_props||uses_rest||writable_props.length>0||component.slots.size>0?x`\n\t\t\t${$$props} => {\n\t\t\t\t${uses_props&&renderer.invalidate('$$props',x`$$props = @assign(@assign({}, $$props), @exclude_internal_props($$new_props))`)}\n\t\t\t\t${uses_rest&&!uses_props&&x`$$props = @assign(@assign({}, $$props), @exclude_internal_props($$new_props))`}\n\t\t\t\t${uses_rest&&renderer.invalidate('$$restProps',x`$$restProps = ${compute_rest}`)}\n\t\t\t\t${writable_props.map(prop=>b`if ('${prop.export_name}' in ${$$props}) ${renderer.invalidate(prop.name,x`${prop.name} = ${$$props}.${prop.export_name}`)};`)}\n\t\t\t\t${component.slots.size>0&&b`if ('$$scope' in ${$$props}) ${renderer.invalidate('$$scope',x`$$scope = ${$$props}.$$scope`)};`}\n\t\t\t}\n\t\t`:null;const accessors=[];const not_equal=component.component_options.immutable?x`@not_equal`:x`@safe_not_equal`;let missing_props_check;let inject_state;let capture_state;let props_inject;props.forEach(prop=>{const variable=component.var_lookup.get(prop.name);if(!variable.writable||component.component_options.accessors){accessors.push({type:'MethodDefinition',kind:'get',key:{type:'Identifier',name:prop.export_name},value:x`function() {\n\t\t\t\t\treturn ${prop.hoistable?prop.name:x`this.$$.ctx[${renderer.context_lookup.get(prop.name).index}]`}\n\t\t\t\t}`});}else if(component.compile_options.dev){accessors.push({type:'MethodDefinition',kind:'get',key:{type:'Identifier',name:prop.export_name},value:x`function() {\n\t\t\t\t\tthrow new @_Error(\"<${component.tag}>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'\");\n\t\t\t\t}`});}if(component.component_options.accessors){if(variable.writable&&!renderer.readonly.has(prop.name)){accessors.push({type:'MethodDefinition',kind:'set',key:{type:'Identifier',name:prop.export_name},value:x`function(${prop.name}) {\n\t\t\t\t\t\tthis.$$set({ ${prop.export_name}: ${prop.name} });\n\t\t\t\t\t\t@flush();\n\t\t\t\t\t}`});}else if(component.compile_options.dev){accessors.push({type:'MethodDefinition',kind:'set',key:{type:'Identifier',name:prop.export_name},value:x`function(value) {\n\t\t\t\t\t\tthrow new @_Error(\"<${component.tag}>: Cannot set read-only property '${prop.export_name}'\");\n\t\t\t\t\t}`});}}else if(component.compile_options.dev){accessors.push({type:'MethodDefinition',kind:'set',key:{type:'Identifier',name:prop.export_name},value:x`function(value) {\n\t\t\t\t\tthrow new @_Error(\"<${component.tag}>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'\");\n\t\t\t\t}`});}});component.instance_exports_from.forEach(exports_from=>{const import_declaration=Object.assign(Object.assign({},exports_from),{type:'ImportDeclaration',specifiers:[],source:exports_from.source});component.imports.push(import_declaration);exports_from.specifiers.forEach(specifier=>{if(component.component_options.accessors){const name=component.get_unique_name(specifier.exported.name);import_declaration.specifiers.push(Object.assign(Object.assign({},specifier),{type:'ImportSpecifier',imported:specifier.local,local:name}));accessors.push({type:'MethodDefinition',kind:'get',key:{type:'Identifier',name:specifier.exported.name},value:x`function() {\n\t\t\t\t\t\treturn ${name}\n\t\t\t\t\t}`});}else if(component.compile_options.dev){accessors.push({type:'MethodDefinition',kind:'get',key:{type:'Identifier',name:specifier.exported.name},value:x`function() {\n\t\t\t\t\t\tthrow new @_Error(\"<${component.tag}>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'\");\n\t\t\t\t\t}`});}});});if(component.compile_options.dev){// checking that expected ones were passed\nconst expected=props.filter(prop=>prop.writable&&!prop.initialised);if(expected.length){missing_props_check=b`\n\t\t\t\t$$self.$$.on_mount.push(function () {\n\t\t\t\t\t${expected.map(prop=>b`\n\t\t\t\t\tif (${prop.name} === undefined && !(('${prop.export_name}' in $$props) || $$self.$$.bound[$$self.$$.props['${prop.export_name}']])) {\n\t\t\t\t\t\t@_console.warn(\"<${component.tag}> was created without expected prop '${prop.export_name}'\");\n\t\t\t\t\t}`)}\n\t\t\t\t});\n\t\t\t`;}const capturable_vars=component.vars.filter(v=>!v.internal&&!v.global&&!v.name.startsWith('$$'));if(capturable_vars.length>0){capture_state=x`() => ({ ${capturable_vars.map(prop=>p`${prop.name}`)} })`;}const injectable_vars=capturable_vars.filter(v=>!v.module&&v.writable&&v.name[0]!=='$');if(uses_props||injectable_vars.length>0){inject_state=x`\n\t\t\t\t${$$props} => {\n\t\t\t\t\t${uses_props&&renderer.invalidate('$$props',x`$$props = @assign(@assign({}, $$props), $$new_props)`)}\n\t\t\t\t\t${injectable_vars.map(v=>b`if ('${v.name}' in $$props) ${renderer.invalidate(v.name,x`${v.name} = ${$$props}.${v.name}`)};`)}\n\t\t\t\t}\n\t\t\t`;props_inject=b`\n\t\t\t\tif ($$props && \"$$inject\" in $$props) {\n\t\t\t\t\t$$self.$inject_state($$props.$$inject);\n\t\t\t\t}\n\t\t\t`;}}// instrument assignments\nif(component.ast.instance){let scope=component.instance_scope;const map=component.instance_scope_map;let execution_context=null;walk(component.ast.instance.content,{enter(node){if(map.has(node)){scope=map.get(node);if(!execution_context&&!scope.block){execution_context=node;}}else if(!execution_context&&node.type==='LabeledStatement'&&node.label.name==='$'){execution_context=node;}},leave(node){if(map.has(node)){scope=scope.parent;}if(execution_context===node){execution_context=null;}if(node.type==='AssignmentExpression'||node.type==='UpdateExpression'){const assignee=node.type==='AssignmentExpression'?node.left:node.argument;// normally (`a = 1`, `b.c = 2`), there'll be a single name\n// (a or b). In destructuring cases (`[d, e] = [e, d]`) there\n// may be more, in which case we need to tack the extra ones\n// onto the initial function call\nconst names=new Set(extract_names(assignee));this.replace(invalidate(renderer,scope,node,names,execution_context===null));}}});component.rewrite_props(_ref37=>{let{name,reassigned,export_name}=_ref37;const value=`$${name}`;const i=renderer.context_lookup.get(`$${name}`).index;const insert=reassigned||export_name?b`${`$$subscribe_${name}`}()`:b`@component_subscribe($$self, ${name}, #value => $$invalidate(${i}, ${value} = #value))`;if(component.compile_options.dev){return b`@validate_store(${name}, '${name}'); ${insert}`;}return insert;});}const args=[x`$$self`];const has_invalidate=props.length>0||component.has_reactive_assignments||component.slots.size>0||capture_state||inject_state;if(has_invalidate){args.push(x`$$props`,x`$$invalidate`);}else if(component.compile_options.dev){// $$props arg is still needed for unknown prop check\nargs.push(x`$$props`);}// has_create_fragment is intentionally to be true in dev mode.\nconst has_create_fragment=component.compile_options.dev||block.has_content();if(has_create_fragment){body.push(b`\n\t\t\tfunction create_fragment(#ctx) {\n\t\t\t\t${block.get_contents()}\n\t\t\t}\n\t\t`);}body.push(b`\n\t\t${component.extract_javascript(component.ast.module)}\n\n\t\t${component.fully_hoisted}\n\t`);const filtered_props=props.filter(prop=>{const variable=component.var_lookup.get(prop.name);if(variable.hoistable)return false;return prop.name[0]!=='$';});const reactive_stores=component.vars.filter(variable=>variable.name[0]==='$'&&variable.name[1]!=='$');const instance_javascript=component.extract_javascript(component.ast.instance);const has_definition=component.compile_options.dev||instance_javascript&&instance_javascript.length>0||filtered_props.length>0||uses_props||component.partly_hoisted.length>0||renderer.initial_context.length>0||component.reactive_declarations.length>0||capture_state||inject_state;const definition=has_definition?component.alias('instance'):{type:'Literal',value:null};const reactive_store_subscriptions=reactive_stores.filter(store=>{const variable=component.var_lookup.get(store.name.slice(1));return!variable||variable.hoistable;}).map(_ref38=>{let{name}=_ref38;return b`\n\t\t\t${component.compile_options.dev&&b`@validate_store(${name.slice(1)}, '${name.slice(1)}');`}\n\t\t\t@component_subscribe($$self, ${name.slice(1)}, $$value => $$invalidate(${renderer.context_lookup.get(name).index}, ${name} = $$value));\n\t\t`;});const resubscribable_reactive_store_unsubscribers=reactive_stores.filter(store=>{const variable=component.var_lookup.get(store.name.slice(1));return variable&&(variable.reassigned||variable.export_name);}).map(_ref39=>{let{name}=_ref39;return b`$$self.$$.on_destroy.push(() => ${`$$unsubscribe_${name.slice(1)}`}());`;});if(has_definition){const reactive_declarations=[];const fixed_reactive_declarations=[];// not really 'reactive' but whatever\ncomponent.reactive_declarations.forEach(d=>{const dependencies=Array.from(d.dependencies);const uses_rest_or_props=!!dependencies.find(n=>n==='$$props'||n==='$$restProps');const writable=dependencies.filter(n=>{const variable=component.var_lookup.get(n);return variable&&(variable.export_name||variable.mutated||variable.reassigned);});const condition=!uses_rest_or_props&&writable.length>0&&renderer.dirty(writable,true);let statement=d.node;// TODO remove label (use d.node.body) if it's not referenced\nif(condition)statement=b`if (${condition}) { ${statement} }`[0];if(condition||uses_rest_or_props){reactive_declarations.push(statement);}else{fixed_reactive_declarations.push(statement);}});const injected=Array.from(component.injected_reactive_declaration_vars).filter(name=>{const variable=component.var_lookup.get(name);return variable.injected&&variable.name[0]!=='$';});const reactive_store_declarations=reactive_stores.map(variable=>{const $name=variable.name;const name=$name.slice(1);const store=component.var_lookup.get(name);if(store&&(store.reassigned||store.export_name)){const unsubscribe=`$$unsubscribe_${name}`;const subscribe=`$$subscribe_${name}`;const i=renderer.context_lookup.get($name).index;return b`let ${$name}, ${unsubscribe} = @noop, ${subscribe} = () => (${unsubscribe}(), ${unsubscribe} = @subscribe(${name}, $$value => $$invalidate(${i}, ${$name} = $$value)), ${name})`;}return b`let ${$name};`;});let unknown_props_check;if(component.compile_options.dev&&!(uses_props||uses_rest)){unknown_props_check=b`\n\t\t\t\tconst writable_props = [${writable_props.map(prop=>x`'${prop.export_name}'`)}];\n\t\t\t\t@_Object.keys($$props).forEach(key => {\n\t\t\t\t\tif (!~writable_props.indexOf(key) && key.slice(0, 2) !== '$$' && key !== 'slot') @_console.warn(\\`<${component.tag}> was created with unknown prop '\\${key}'\\`);\n\t\t\t\t});\n\t\t\t`;}const return_value={type:'ArrayExpression',elements:renderer.initial_context.map(member=>({type:'Identifier',name:member.name}))};body.push(b`\n\t\t\tfunction ${definition}(${args}) {\n\t\t\t\t${injected.map(name=>b`let ${name};`)}\n\n\t\t\t\t${rest}\n\n\t\t\t\t${reactive_store_declarations}\n\n\t\t\t\t${reactive_store_subscriptions}\n\n\t\t\t\t${resubscribable_reactive_store_unsubscribers}\n\n\t\t\t\t${component.slots.size||component.compile_options.dev||uses_slots?b`let { $$slots: #slots = {}, $$scope } = $$props;`:null}\n\t\t\t\t${component.compile_options.dev&&b`@validate_slots('${component.tag}', #slots, [${[...component.slots.keys()].map(key=>`'${key}'`).join(',')}]);`}\n\t\t\t\t${compute_slots}\n\n\t\t\t\t${instance_javascript}\n\n\t\t\t\t${missing_props_check}\n\t\t\t\t${unknown_props_check}\n\n\t\t\t\t${renderer.binding_groups.size>0&&b`const $$binding_groups = [${[...renderer.binding_groups.keys()].map(_=>x`[]`)}];`}\n\n\t\t\t\t${component.partly_hoisted}\n\n\t\t\t\t${set&&b`$$self.$$set = ${set};`}\n\n\t\t\t\t${capture_state&&b`$$self.$capture_state = ${capture_state};`}\n\n\t\t\t\t${inject_state&&b`$$self.$inject_state = ${inject_state};`}\n\n\t\t\t\t${/* before reactive declarations */props_inject}\n\n\t\t\t\t${reactive_declarations.length>0&&b`\n\t\t\t\t$$self.$$.update = () => {\n\t\t\t\t\t${reactive_declarations}\n\t\t\t\t};\n\t\t\t\t`}\n\n\t\t\t\t${fixed_reactive_declarations}\n\n\t\t\t\t${uses_props&&b`$$props = @exclude_internal_props($$props);`}\n\n\t\t\t\treturn ${return_value};\n\t\t\t}\n\t\t`);}const prop_indexes=x`{\n\t\t${props.filter(v=>v.export_name&&!v.module).map(v=>p`${v.export_name}: ${renderer.context_lookup.get(v.name).index}`)}\n\t}`;let dirty;if(renderer.context_overflow){dirty=x`[]`;for(let i=0;i<renderer.context.length;i+=31){dirty.elements.push(x`-1`);}}if(options.customElement){let init_props=x`@attribute_to_object(this.attributes)`;if(uses_slots){init_props=x`{ ...${init_props}, $$slots: @get_custom_elements_slots(this) }`;}const declaration=b`\n\t\t\tclass ${name} extends @SvelteElement {\n\t\t\t\tconstructor(options) {\n\t\t\t\t\tsuper();\n\n\t\t\t\t\t${css.code&&b`this.shadowRoot.innerHTML = \\`<style>${css.code.replace(regex_backslashes,'\\\\\\\\')}${css_sourcemap_enabled&&options.dev?`\\n/*# sourceMappingURL=${css.map.toUrl()} */`:''}</style>\\`;`}\n\n\t\t\t\t\t@init(this, { target: this.shadowRoot, props: ${init_props}, customElement: true }, ${definition}, ${has_create_fragment?'create_fragment':'null'}, ${not_equal}, ${prop_indexes}, null, ${dirty});\n\n\t\t\t\t\tif (options) {\n\t\t\t\t\t\tif (options.target) {\n\t\t\t\t\t\t\t@insert(options.target, this, options.anchor);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t${(props.length>0||uses_props||uses_rest)&&b`\n\t\t\t\t\t\tif (options.props) {\n\t\t\t\t\t\t\tthis.$set(options.props);\n\t\t\t\t\t\t\t@flush();\n\t\t\t\t\t\t}`}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t`[0];if(props.length>0){declaration.body.body.push({type:'MethodDefinition',kind:'get',static:true,computed:false,key:{type:'Identifier',name:'observedAttributes'},value:x`function() {\n\t\t\t\t\treturn [${props.map(prop=>x`\"${prop.export_name}\"`)}];\n\t\t\t\t}`});}push_array$1(declaration.body.body,accessors);body.push(declaration);if(component.tag!=null){body.push(b`\n\t\t\t\t@_customElements.define(\"${component.tag}\", ${name});\n\t\t\t`);}}else{const superclass={type:'Identifier',name:options.dev?'@SvelteComponentDev':'@SvelteComponent'};const optional_parameters=[];if(should_add_css){optional_parameters.push(add_css);}else if(dirty){optional_parameters.push(x`null`);}if(dirty){optional_parameters.push(dirty);}const declaration=b`\n\t\t\tclass ${name} extends ${superclass} {\n\t\t\t\tconstructor(options) {\n\t\t\t\t\tsuper(${options.dev&&'options'});\n\t\t\t\t\t@init(this, options, ${definition}, ${has_create_fragment?'create_fragment':'null'}, ${not_equal}, ${prop_indexes}, ${optional_parameters});\n\t\t\t\t\t${options.dev&&b`@dispatch_dev(\"SvelteRegisterComponent\", { component: this, tagName: \"${name.name}\", options, id: create_fragment.name });`}\n\t\t\t\t}\n\t\t\t}\n\t\t`[0];push_array$1(declaration.body.body,accessors);body.push(declaration);}return{js:flatten(body),css};}function get_const_tags$1(const_tags){if(const_tags.length===0)return null;return{type:'VariableDeclaration',kind:'let',declarations:const_tags.map(const_tag=>{const assignment=const_tag.node.expression;return{type:'VariableDeclarator',id:assignment.left,init:assignment.right};})};}function AwaitBlock$1(node,renderer,options){renderer.push();renderer.render(node.pending.children,options);const pending=renderer.pop();renderer.push();renderer.render(node.then.children,options);const then=renderer.pop();renderer.add_expression(x`\n\t\tfunction(__value) {\n\t\t\tif (@is_promise(__value)) {\n\t\t\t\t__value.then(null, @noop);\n\t\t\t\treturn ${pending};\n\t\t\t}\n\t\t\treturn (function(${node.then_node?node.then_node:''}) { ${get_const_tags$1(node.then.const_tags)}; return ${then}; }(__value));\n\t\t}(${node.expression.node})\n\t`);}function Comment$2(node,renderer,options){if(options.preserveComments){renderer.add_string(`<!--${node.data}-->`);}}function DebugTag$1(node,renderer,options){if(!options.dev)return;const filename=options.filename||null;const{line,column}=options.locate(node.start+1);const obj=x`{\n\t\t${node.expressions.map(e=>p`${e.node.name}`)}\n\t}`;renderer.add_expression(x`@debug(${filename?x`\"${filename}\"`:x`null`}, ${line-1}, ${column}, ${obj})`);}function EachBlock$1(node,renderer,options){const args=[node.context_node];if(node.index)args.push({type:'Identifier',name:node.index});renderer.push();renderer.render(node.children,options);const result=renderer.pop();const consequent=x`@each(${node.expression.node}, (${args}) => { ${get_const_tags$1(node.const_tags)}; return ${result} })`;if(node.else){renderer.push();renderer.render(node.else.children,options);let alternate=renderer.pop();if(node.else.const_tags.length>0)alternate=x`(() => { ${get_const_tags$1(node.else.const_tags)}; return ${alternate} })()`;renderer.add_expression(x`${node.expression.node}.length ? ${consequent} : ${alternate}`);}else{renderer.add_expression(consequent);}}function get_class_attribute_value(attribute){// handle special case — `class={possiblyUndefined}` with scoped CSS\nif(attribute.chunks.length===2&&attribute.chunks[1].synthetic){const value=attribute.chunks[0].node;return x`@escape(@null_to_empty(${value}), true) + \"${attribute.chunks[1].data}\"`;}return get_attribute_value(attribute);}function get_attribute_value(attribute){if(attribute.chunks.length===0)return x`\"\"`;return attribute.chunks.map(chunk=>{return chunk.type==='Text'?string_literal(chunk.data.replace(regex_double_quotes,'&quot;')):x`@escape(${chunk.node}, true)`;}).reduce((lhs,rhs)=>x`${lhs} + ${rhs}`);}function get_attribute_expression(attribute){if(attribute.chunks.length===1&&attribute.chunks[0].type==='Expression'){return attribute.chunks[0].node;}return get_attribute_value(attribute);}// similar logic from `compile/render_dom/wrappers/Fragment`\n// We want to remove trailing whitespace inside an element/component/block,\n// *unless* there is no whitespace between this node and its next sibling\nfunction remove_whitespace_children(children,next){const nodes=[];let last_child;let i=children.length;while(i--){const child=children[i];if(child.type==='Text'){if(child.should_skip()){continue;}let{data}=child;if(nodes.length===0){const should_trim=next?next.type==='Text'&&regex_starts_with_whitespace.test(next.data)&&trimmable_at$1(child,next):!child.has_ancestor('EachBlock');if(should_trim&&!child.keep_space()){data=trim_end(data);if(!data)continue;}}// glue text nodes (which could e.g. be separated by comments) together\nif(last_child&&last_child.type==='Text'){last_child.data=data+last_child.data;continue;}nodes.unshift(child);link(last_child,last_child=child);}else{nodes.unshift(child);link(last_child,last_child=child);}}const first=nodes[0];if(first&&first.type==='Text'&&!first.keep_space()){first.data=trim_start(first.data);if(!first.data){first.var=null;nodes.shift();if(nodes[0]){nodes[0].prev=null;}}}return nodes;}function trimmable_at$1(child,next_sibling){// Whitespace is trimmable if one of the following is true:\n// The child and its sibling share a common nearest each block (not at an each block boundary)\n// The next sibling's previous node is an each block\nreturn next_sibling.find_nearest(/EachBlock/)===child.find_nearest(/EachBlock/)||next_sibling.prev.type==='EachBlock';}function Element$1(node,renderer,options){const children=remove_whitespace_children(node.children,node.next);// awkward special case\nlet node_contents;const contenteditable=node.name!=='textarea'&&node.name!=='input'&&node.attributes.some(attribute=>attribute.name==='contenteditable');if(node.is_dynamic_element){renderer.push();}renderer.add_string('<');add_tag_name();const class_expression_list=node.classes.map(class_directive=>{const{expression,name}=class_directive;const snippet=expression?expression.node:x`#ctx.${name}`;// TODO is this right?\nreturn x`${snippet} ? \"${name}\" : \"\"`;});if(node.needs_manual_style_scoping){class_expression_list.push(x`\"${node.component.stylesheet.id}\"`);}const class_expression=class_expression_list.length>0&&class_expression_list.reduce((lhs,rhs)=>x`${lhs} + ' ' + ${rhs}`);const style_expression_list=node.styles.map(style_directive=>{let{name,important,expression:{node:expression}}=style_directive;if(important){expression=x`${expression} + ' !important'`;}return p`\"${name}\": ${expression}`;});const style_expression=style_expression_list.length>0&&x`{ ${style_expression_list} }`;if(node.attributes.some(attr=>attr.is_spread)){// TODO dry this out\nconst args=[];node.attributes.forEach(attribute=>{if(attribute.is_spread){args.push(x`@escape_object(${attribute.expression.node})`);}else{const attr_name=node.namespace===namespaces.foreign?attribute.name:fix_attribute_casing(attribute.name);const name=attribute.name.toLowerCase();if(name==='value'&&node.name.toLowerCase()==='textarea'){node_contents=get_attribute_value(attribute);}else if(attribute.is_true){args.push(x`{ ${attr_name}: true }`);}else if(boolean_attributes.has(name)&&attribute.chunks.length===1&&attribute.chunks[0].type!=='Text'){// a boolean attribute with one non-Text chunk\nargs.push(x`{ ${attr_name}: ${attribute.chunks[0].node} || null }`);}else if(attribute.chunks.length===1&&attribute.chunks[0].type!=='Text'){const snippet=attribute.chunks[0].node;args.push(x`{ ${attr_name}: @escape_attribute_value(${snippet}) }`);}else{args.push(x`{ ${attr_name}: ${get_attribute_value(attribute)} }`);}}});renderer.add_expression(x`@spread([${args}], { classes: ${class_expression}, styles: ${style_expression} })`);}else{let add_class_attribute=!!class_expression;let add_style_attribute=!!style_expression;node.attributes.forEach(attribute=>{const name=attribute.name.toLowerCase();const attr_name=node.namespace===namespaces.foreign?attribute.name:fix_attribute_casing(attribute.name);if(name==='value'&&node.name.toLowerCase()==='textarea'){node_contents=get_attribute_value(attribute);}else if(attribute.is_true){renderer.add_string(` ${attr_name}`);}else if(boolean_attributes.has(name)&&attribute.chunks.length===1&&attribute.chunks[0].type!=='Text'){// a boolean attribute with one non-Text chunk\nrenderer.add_string(' ');renderer.add_expression(x`${attribute.chunks[0].node} ? \"${attr_name}\" : \"\"`);}else if(name==='class'&&class_expression){add_class_attribute=false;renderer.add_string(` ${attr_name}=\"`);renderer.add_expression(x`[${get_class_attribute_value(attribute)}, ${class_expression}].join(' ').trim()`);renderer.add_string('\"');}else if(name==='style'&&style_expression){add_style_attribute=false;renderer.add_expression(x`@add_styles(@merge_ssr_styles(${get_attribute_value(attribute)}, ${style_expression}))`);}else if(attribute.chunks.length===1&&attribute.chunks[0].type!=='Text'){const snippet=attribute.chunks[0].node;renderer.add_expression(x`@add_attribute(\"${attr_name}\", ${snippet}, ${boolean_attributes.has(name)?1:0})`);}else{renderer.add_string(` ${attr_name}=\"`);renderer.add_expression((name==='class'?get_class_attribute_value:get_attribute_value)(attribute));renderer.add_string('\"');}});if(add_class_attribute){renderer.add_expression(x`@add_classes((${class_expression}).trim())`);}if(add_style_attribute){renderer.add_expression(x`@add_styles(${style_expression})`);}}node.bindings.forEach(binding=>{const{name,expression}=binding;if(binding.is_readonly){return;}if(name==='group'){const value_attribute=node.attributes.find(_ref40=>{let{name}=_ref40;return name==='value';});if(value_attribute){const value=get_attribute_expression(value_attribute);const type=node.get_static_attribute_value('type');const bound=expression.node;const condition=type==='checkbox'?x`~${bound}.indexOf(${value})`:x`${value} === ${bound}`;renderer.add_expression(x`${condition} ? @add_attribute(\"checked\", true, 1) : \"\"`);}}else if(contenteditable&&(name==='textContent'||name==='innerHTML')){node_contents=expression.node;// TODO where was this used?\n// value = name === 'textContent' ? x`@escape($$value)` : x`$$value`;\n}else if(binding.name==='value'&&node.name==='textarea'){const snippet=expression.node;node_contents=x`${snippet} || \"\"`;}else if(binding.name==='value'&&node.name==='select');else{const snippet=expression.node;renderer.add_expression(x`@add_attribute(\"${name}\", ${snippet}, ${boolean_attributes.has(name)?1:0})`);}});renderer.add_string('>');if(node_contents!==undefined){if(contenteditable){renderer.push();renderer.render(children,options);const result=renderer.pop();renderer.add_expression(x`($$value => $$value === void 0 ? ${result} : $$value)(${node_contents})`);}else{if(node.name==='textarea'){// Two or more leading newlines are required to restore the leading newline immediately after `<textarea>`.\n// see https://html.spec.whatwg.org/multipage/syntax.html#element-restrictions\nconst value_attribute=node.attributes.find(_ref41=>{let{name}=_ref41;return name==='value';});if(value_attribute){const first=value_attribute.chunks[0];if(first&&first.type==='Text'&&regex_starts_with_newline.test(first.data)){renderer.add_string('\\n');}}}renderer.add_expression(node_contents);}add_close_tag();}else{if(node.name==='pre'){// Two or more leading newlines are required to restore the leading newline immediately after `<pre>`.\n// see https://html.spec.whatwg.org/multipage/grouping-content.html#the-pre-element\n// see https://html.spec.whatwg.org/multipage/syntax.html#element-restrictions\nconst first=children[0];if(first&&first.type==='Text'&&regex_starts_with_newline.test(first.data)){renderer.add_string('\\n');}}if(node.is_dynamic_element)renderer.push();renderer.render(children,options);if(node.is_dynamic_element){const children=renderer.pop();renderer.add_expression(x`@is_void(#tag) ? '' : ${children}`);}add_close_tag();}if(node.is_dynamic_element){let content=renderer.pop();if(options.dev&&node.children.length>0)content=x`(() => { @validate_void_dynamic_element(#tag); return ${content}; })()`;renderer.add_expression(x`((#tag) => {\n\t\t\t${options.dev&&x`@validate_dynamic_element(#tag)`}\n\t\t\treturn #tag ? ${content} : '';\n\t\t})(${node.tag_expr.node})`);}function add_close_tag(){if(node.tag_expr.node.type==='Literal'){if(!is_void(node.tag_expr.node.value)){renderer.add_string('</');add_tag_name();renderer.add_string('>');}return;}renderer.add_expression(x`@is_void(#tag) ? '' : \\`</\\${#tag}>\\``);}function add_tag_name(){if(node.tag_expr.node.type==='Literal'){renderer.add_string(node.tag_expr.node.value);}else{renderer.add_expression(node.tag_expr.node);}}}function Head$1(node,renderer,options){const head_options=Object.assign(Object.assign({},options),{head_id:node.id});renderer.push();renderer.render(node.children,head_options);const result=renderer.pop();let expression=result;if(options.hydratable){const start_comment=`HEAD_${node.id}_START`;const end_comment=`HEAD_${node.id}_END`;expression=x`'<!-- ${start_comment} -->' + ${expression} + '<!-- ${end_comment} -->'`;}renderer.add_expression(x`$$result.head += ${expression}, \"\"`);}function HtmlTag(node,renderer,options){if(options.hydratable)renderer.add_string('<!-- HTML_TAG_START -->');renderer.add_expression(node.expression.node);if(options.hydratable)renderer.add_string('<!-- HTML_TAG_END -->');}function IfBlock$1(node,renderer,options){const condition=node.expression.node;renderer.push();renderer.render(node.children,options);let consequent=renderer.pop();if(node.const_tags.length>0)consequent=x`(() => { ${get_const_tags$1(node.const_tags)}; return ${consequent} })()`;renderer.push();if(node.else)renderer.render(node.else.children,options);let alternate=renderer.pop();if(node.else&&node.else.const_tags.length>0)alternate=x`(() => { ${get_const_tags$1(node.else.const_tags)}; return ${alternate} })()`;renderer.add_expression(x`${condition} ? ${consequent} : ${alternate}`);}function get_prop_value(attribute){if(attribute.is_true)return x`true`;if(attribute.chunks.length===0)return x`''`;return attribute.chunks.map(chunk=>{if(chunk.type==='Text')return string_literal(chunk.data);return chunk.node;}).reduce((lhs,rhs)=>x`${lhs} + ${rhs}`);}function InlineComponent$1(node,renderer,options){const binding_props=[];const binding_fns=[];node.bindings.forEach(binding=>{renderer.has_bindings=true;// TODO this probably won't work for contextual bindings\nconst snippet=binding.expression.node;binding_props.push(p`${binding.name}: ${snippet}`);binding_fns.push(p`${binding.name}: $$value => { ${snippet} = $$value; $$settled = false }`);});const uses_spread=node.attributes.find(attr=>attr.is_spread);let props;if(uses_spread){props=x`@_Object.assign(${node.attributes.map(attribute=>{if(attribute.is_spread){return attribute.expression.node;}else{return x`{ ${attribute.name}: ${get_prop_value(attribute)} }`;}}).concat(binding_props.map(p=>x`{ ${p} }`))})`;}else{props=x`{\n\t\t\t${node.attributes.map(attribute=>p`${attribute.name}: ${get_prop_value(attribute)}`)},\n\t\t\t${binding_props}\n\t\t}`;}const bindings=x`{\n\t\t${binding_fns}\n\t}`;const expression=node.name==='svelte:self'?renderer.name:node.name==='svelte:component'?x`(${node.expression.node}) || @missing_component`:node.name.split('.').reduce((lhs,rhs)=>x`${lhs}.${rhs}`);const slot_fns=[];const children=node.children;if(children.length){const slot_scopes=new Map();renderer.render(children,Object.assign({},options,{slot_scopes}));slot_scopes.forEach((_ref42,name)=>{let{input,output,statements}=_ref42;slot_fns.push(p`${name}: (${input}) => { ${statements}; return ${output}; }`);});}const slots=x`{\n\t\t${slot_fns}\n\t}`;if(node.css_custom_properties.length>0){if(node.namespace===namespaces.svg){renderer.add_string('<g style=\"');}else{renderer.add_string('<div style=\"display: contents; ');}node.css_custom_properties.forEach((attr,index)=>{renderer.add_string(`${attr.name}:`);renderer.add_expression(get_attribute_value(attr));renderer.add_string(';');if(index<node.css_custom_properties.length-1)renderer.add_string(' ');});renderer.add_string('\">');}renderer.add_expression(x`@validate_component(${expression}, \"${node.name}\").$$render($$result, ${props}, ${bindings}, ${slots})`);if(node.css_custom_properties.length>0){if(node.namespace===namespaces.svg){renderer.add_string('</g>');}else{renderer.add_string('</div>');}}}function KeyBlock$1(node,renderer,options){renderer.render(node.children,options);}function get_slot_scope(lets){if(lets.length===0)return null;return{type:'ObjectPattern',properties:lets.map(l=>{return{type:'Property',kind:'init',method:false,shorthand:false,computed:false,key:l.name,value:l.value||l.name};})};}function Slot$1(node,renderer,options){const slot_data=get_slot_data(node.values);const slot=node.get_static_attribute_value('slot');const nearest_inline_component=node.find_nearest(/InlineComponent/);if(slot&&nearest_inline_component){renderer.push();}renderer.push();renderer.render(node.children,options);const result=renderer.pop();renderer.add_expression(x`\n\t\t#slots.${node.slot_name}\n\t\t\t? #slots.${node.slot_name}(${slot_data})\n\t\t\t: ${result}\n\t`);if(slot&&nearest_inline_component){const lets=node.lets;const seen=new Set(lets.map(l=>l.name.name));nearest_inline_component.lets.forEach(l=>{if(!seen.has(l.name.name))lets.push(l);});options.slot_scopes.set(slot,{input:get_slot_scope(node.lets),output:renderer.pop()});}}function SlotTemplate$1(node,renderer,options){const parent_inline_component=node.parent;const children=remove_whitespace_children(node instanceof SlotTemplate?node.children:[node],node.next);renderer.push();renderer.render(children,options);const lets=node.lets;const seen=new Set(lets.map(l=>l.name.name));parent_inline_component.lets.forEach(l=>{if(!seen.has(l.name.name))lets.push(l);});const slot_fragment_content=renderer.pop();if(!is_empty_template_literal(slot_fragment_content)){if(options.slot_scopes.has(node.slot_template_name)){if(node.slot_template_name==='default'){throw new Error('Found elements without slot attribute when using slot=\"default\"');}throw new Error(`Duplicate slot name \"${node.slot_template_name}\" in <${parent_inline_component.name}>`);}options.slot_scopes.set(node.slot_template_name,{input:get_slot_scope(node.lets),output:slot_fragment_content,statements:get_const_tags$1(node.const_tags)});}}function is_empty_template_literal(template_literal){return template_literal.expressions.length===0&&template_literal.quasis.length===1&&template_literal.quasis[0].value.raw==='';}function Tag$2(node,renderer,_options){const snippet=node.expression.node;renderer.add_expression(node.parent&&node.parent.type==='Element'&&node.parent.name==='style'?snippet:x`@escape(${snippet})`);}function Text$1(node,renderer,_options){let text=node.data;if(!node.parent||node.parent.type!=='Element'||node.parent.name!=='script'&&node.parent.name!=='style'){// unless this Text node is inside a <script> or <style> element, escape &,<,>\ntext=escape_html(text);}renderer.add_string(text);}function Title$1(node,renderer,options){renderer.push();renderer.add_string('<title>');renderer.render(node.children,options);renderer.add_string('</title>');const result=renderer.pop();renderer.add_expression(x`$$result.title = ${result}, \"\"`);}function noop$1(){}const handlers$1={AwaitBlock:AwaitBlock$1,Body:noop$1,Comment:Comment$2,DebugTag:DebugTag$1,EachBlock:EachBlock$1,Element:Element$1,Head:Head$1,IfBlock:IfBlock$1,InlineComponent:InlineComponent$1,KeyBlock:KeyBlock$1,MustacheTag:Tag$2,Options:noop$1,RawMustacheTag:HtmlTag,Slot:Slot$1,SlotTemplate:SlotTemplate$1,Text:Text$1,Title:Title$1,Window:noop$1};class Renderer$1{constructor(_ref43){let{name}=_ref43;this.has_bindings=false;this.stack=[];this.targets=[];this.name=name;this.push();}add_string(str){this.current.value+=escape_template(str);}add_expression(node){this.literal.quasis.push({type:'TemplateElement',value:{raw:this.current.value,cooked:null},tail:false});this.literal.expressions.push(node);this.current.value='';}push(){const current=this.current={value:''};const literal=this.literal={type:'TemplateLiteral',expressions:[],quasis:[]};this.stack.push({current,literal});}pop(){this.literal.quasis.push({type:'TemplateElement',value:{raw:this.current.value,cooked:null},tail:true});const popped=this.stack.pop();const last=this.stack[this.stack.length-1];if(last){this.literal=last.literal;this.current=last.current;}return popped.literal;}render(nodes,options){nodes.forEach(node=>{const handler=handlers$1[node.type];if(!handler){throw new Error(`No handler for '${node.type}' nodes`);}handler(node,this,options);});}}function ssr(component,options){const renderer=new Renderer$1({name:component.name});const{name}=component;// create $$render function\nrenderer.render(trim(component.fragment.children),Object.assign({locate:component.locate},options));// TODO put this inside the Renderer class\nconst literal=renderer.pop();// TODO concatenate CSS maps\nconst css=options.customElement?{code:null,map:null}:component.stylesheet.render(options.filename,true);const uses_rest=component.var_lookup.has('$$restProps');const props=component.vars.filter(variable=>!variable.module&&variable.export_name);const rest=uses_rest?b`let $$restProps = @compute_rest_props($$props, [${props.map(prop=>`\"${prop.export_name}\"`).join(',')}]);`:null;const uses_slots=component.var_lookup.has('$$slots');const slots=uses_slots?b`let $$slots = @compute_slots(#slots);`:null;const reactive_stores=component.vars.filter(variable=>variable.name[0]==='$'&&variable.name[1]!=='$');const reactive_store_subscriptions=reactive_stores.filter(store=>{const variable=component.var_lookup.get(store.name.slice(1));return!variable||variable.hoistable;}).map(_ref44=>{let{name}=_ref44;const store_name=name.slice(1);return b`\n\t\t\t\t${component.compile_options.dev&&b`@validate_store(${store_name}, '${store_name}');`}\n\t\t\t\t${`$$unsubscribe_${store_name}`} = @subscribe(${store_name}, #value => ${name} = #value)\n\t\t\t`;});const reactive_store_unsubscriptions=reactive_stores.map(_ref45=>{let{name}=_ref45;return b`${`$$unsubscribe_${name.slice(1)}`}()`;});const reactive_store_declarations=reactive_stores.map(_ref46=>{let{name}=_ref46;const store_name=name.slice(1);const store=component.var_lookup.get(store_name);if(store&&store.reassigned){const unsubscribe=`$$unsubscribe_${store_name}`;const subscribe=`$$subscribe_${store_name}`;return b`let ${name}, ${unsubscribe} = @noop, ${subscribe} = () => (${unsubscribe}(), ${unsubscribe} = @subscribe(${store_name}, $$value => ${name} = $$value), ${store_name})`;}return b`let ${name}, ${`$$unsubscribe_${store_name}`};`;});// instrument get/set store value\nif(component.ast.instance){let scope=component.instance_scope;const map=component.instance_scope_map;walk(component.ast.instance.content,{enter(node){if(map.has(node)){scope=map.get(node);}},leave(node){if(map.has(node)){scope=scope.parent;}if(node.type==='AssignmentExpression'||node.type==='UpdateExpression'){const assignee=node.type==='AssignmentExpression'?node.left:node.argument;const names=new Set(extract_names(assignee));const to_invalidate=new Set();for(const name of names){const variable=component.var_lookup.get(name);if(variable&&!variable.hoistable&&!variable.global&&!variable.module&&(variable.subscribable||variable.name[0]==='$')){to_invalidate.add(variable.name);}}if(to_invalidate.size){this.replace(invalidate({component},scope,node,to_invalidate,true));}}}});}component.rewrite_props(_ref47=>{let{name,reassigned}=_ref47;const value=`$${name}`;let insert=reassigned?b`${`$$subscribe_${name}`}()`:b`${`$$unsubscribe_${name}`} = @subscribe(${name}, #value => $${value} = #value)`;if(component.compile_options.dev){insert=b`@validate_store(${name}, '${name}'); ${insert}`;}return insert;});const instance_javascript=component.extract_javascript(component.ast.instance);// TODO only do this for props with a default value\nconst parent_bindings=instance_javascript?component.vars.filter(variable=>!variable.module&&variable.export_name).map(prop=>{return b`if ($$props.${prop.export_name} === void 0 && $$bindings.${prop.export_name} && ${prop.name} !== void 0) $$bindings.${prop.export_name}(${prop.name});`;}):[];const injected=Array.from(component.injected_reactive_declaration_vars).filter(name=>{const variable=component.var_lookup.get(name);return variable.injected;});const reactive_declarations=component.reactive_declarations.map(d=>{const body=d.node.body;let statement=b`${body}`;if(!d.declaration){// TODO do not add label if it's not referenced\nstatement=b`$: { ${statement} }`;}return statement;});const main=renderer.has_bindings?b`\n\t\t\tlet $$settled;\n\t\t\tlet $$rendered;\n\n\t\t\tdo {\n\t\t\t\t$$settled = true;\n\n\t\t\t\t${reactive_declarations}\n\n\t\t\t\t$$rendered = ${literal};\n\t\t\t} while (!$$settled);\n\n\t\t\t${reactive_store_unsubscriptions}\n\n\t\t\treturn $$rendered;\n\t\t`:b`\n\t\t\t${reactive_declarations}\n\n\t\t\t${reactive_store_unsubscriptions}\n\n\t\t\treturn ${literal};`;const blocks=[...injected.map(name=>b`let ${name};`),rest,slots,...reactive_store_declarations,...reactive_store_subscriptions,instance_javascript,...parent_bindings,css.code&&b`$$result.css.add(#css);`,main].filter(Boolean);const css_sourcemap_enabled=check_enable_sourcemap(options.enableSourcemap,'css');const js=b`\n\t\t${css.code?b`\n\t\tconst #css = {\n\t\t\tcode: \"${css.code}\",\n\t\t\tmap: ${css_sourcemap_enabled&&css.map?string_literal(css.map.toString()):'null'}\n\t\t};`:null}\n\n\t\t${component.extract_javascript(component.ast.module)}\n\n\t\t${component.fully_hoisted}\n\n\t\tconst ${name} = @create_ssr_component(($$result, $$props, $$bindings, #slots) => {\n\t\t\t${blocks}\n\t\t});\n\t`;return{js,css};}function trim(nodes){let start=0;for(;start<nodes.length;start+=1){const node=nodes[start];if(node.type!=='Text')break;node.data=node.data.replace(/^\\s+/,'');if(node.data)break;}let end=nodes.length;for(;end>start;end-=1){const node=nodes[end-1];if(node.type!=='Text')break;node.data=node.data.trimRight();if(node.data)break;}return nodes.slice(start,end);}/** ----------------------------------------------------------------------\nThis file is automatically generated by `scripts/globals-extractor.mjs`.\nGenerated At: 2022-09-03T15:22:37.415Z\n---------------------------------------------------------------------- */var globals=new Set(['AbortController','AbortSignal','AbstractRange','ActiveXObject','AggregateError','AnalyserNode','Animation','AnimationEffect','AnimationEvent','AnimationPlaybackEvent','AnimationTimeline','Array','ArrayBuffer','Atomics','Attr','Audio','AudioBuffer','AudioBufferSourceNode','AudioContext','AudioDestinationNode','AudioListener','AudioNode','AudioParam','AudioParamMap','AudioProcessingEvent','AudioScheduledSourceNode','AudioWorklet','AudioWorkletNode','AuthenticatorAssertionResponse','AuthenticatorAttestationResponse','AuthenticatorResponse','BarProp','BaseAudioContext','BeforeUnloadEvent','BigInt','BigInt64Array','BigUint64Array','BiquadFilterNode','Blob','BlobEvent','Boolean','BroadcastChannel','ByteLengthQueuingStrategy','CDATASection','CSS','CSSAnimation','CSSConditionRule','CSSCounterStyleRule','CSSFontFaceRule','CSSGroupingRule','CSSImportRule','CSSKeyframeRule','CSSKeyframesRule','CSSMediaRule','CSSNamespaceRule','CSSPageRule','CSSRule','CSSRuleList','CSSStyleDeclaration','CSSStyleRule','CSSStyleSheet','CSSSupportsRule','CSSTransition','Cache','CacheStorage','CanvasCaptureMediaStreamTrack','CanvasGradient','CanvasPattern','CanvasRenderingContext2D','ChannelMergerNode','ChannelSplitterNode','CharacterData','ClientRect','Clipboard','ClipboardEvent','ClipboardItem','CloseEvent','Comment','CompositionEvent','ConstantSourceNode','ConvolverNode','CountQueuingStrategy','Credential','CredentialsContainer','Crypto','CryptoKey','CustomElementRegistry','CustomEvent','DOMException','DOMImplementation','DOMMatrix','DOMMatrixReadOnly','DOMParser','DOMPoint','DOMPointReadOnly','DOMQuad','DOMRect','DOMRectList','DOMRectReadOnly','DOMStringList','DOMStringMap','DOMTokenList','DataTransfer','DataTransferItem','DataTransferItemList','DataView','Date','DelayNode','DeviceMotionEvent','DeviceOrientationEvent','Document','DocumentFragment','DocumentTimeline','DocumentType','DragEvent','DynamicsCompressorNode','Element','ElementInternals','Enumerator','Error','ErrorEvent','EvalError','Event','EventCounts','EventSource','EventTarget','External','File','FileList','FileReader','FileSystem','FileSystemDirectoryEntry','FileSystemDirectoryHandle','FileSystemDirectoryReader','FileSystemEntry','FileSystemFileEntry','FileSystemFileHandle','FileSystemHandle','FinalizationRegistry','Float32Array','Float64Array','FocusEvent','FontFace','FontFaceSet','FontFaceSetLoadEvent','FormData','FormDataEvent','Function','GainNode','Gamepad','GamepadButton','GamepadEvent','GamepadHapticActuator','Geolocation','GeolocationCoordinates','GeolocationPosition','GeolocationPositionError','HTMLAllCollection','HTMLAnchorElement','HTMLAreaElement','HTMLAudioElement','HTMLBRElement','HTMLBaseElement','HTMLBodyElement','HTMLButtonElement','HTMLCanvasElement','HTMLCollection','HTMLDListElement','HTMLDataElement','HTMLDataListElement','HTMLDetailsElement','HTMLDialogElement','HTMLDirectoryElement','HTMLDivElement','HTMLDocument','HTMLElement','HTMLEmbedElement','HTMLFieldSetElement','HTMLFontElement','HTMLFormControlsCollection','HTMLFormElement','HTMLFrameElement','HTMLFrameSetElement','HTMLHRElement','HTMLHeadElement','HTMLHeadingElement','HTMLHtmlElement','HTMLIFrameElement','HTMLImageElement','HTMLInputElement','HTMLLIElement','HTMLLabelElement','HTMLLegendElement','HTMLLinkElement','HTMLMapElement','HTMLMarqueeElement','HTMLMediaElement','HTMLMenuElement','HTMLMetaElement','HTMLMeterElement','HTMLModElement','HTMLOListElement','HTMLObjectElement','HTMLOptGroupElement','HTMLOptionElement','HTMLOptionsCollection','HTMLOutputElement','HTMLParagraphElement','HTMLParamElement','HTMLPictureElement','HTMLPreElement','HTMLProgressElement','HTMLQuoteElement','HTMLScriptElement','HTMLSelectElement','HTMLSlotElement','HTMLSourceElement','HTMLSpanElement','HTMLStyleElement','HTMLTableCaptionElement','HTMLTableCellElement','HTMLTableColElement','HTMLTableElement','HTMLTableRowElement','HTMLTableSectionElement','HTMLTemplateElement','HTMLTextAreaElement','HTMLTimeElement','HTMLTitleElement','HTMLTrackElement','HTMLUListElement','HTMLUnknownElement','HTMLVideoElement','HashChangeEvent','Headers','History','IDBCursor','IDBCursorWithValue','IDBDatabase','IDBFactory','IDBIndex','IDBKeyRange','IDBObjectStore','IDBOpenDBRequest','IDBRequest','IDBTransaction','IDBVersionChangeEvent','IIRFilterNode','IdleDeadline','Image','ImageBitmap','ImageBitmapRenderingContext','ImageData','Infinity','InputDeviceInfo','InputEvent','Int16Array','Int32Array','Int8Array','InternalError','IntersectionObserver','IntersectionObserverEntry','Intl','JSON','KeyboardEvent','KeyframeEffect','Location','Lock','LockManager','Map','Math','MathMLElement','MediaCapabilities','MediaDeviceInfo','MediaDevices','MediaElementAudioSourceNode','MediaEncryptedEvent','MediaError','MediaKeyMessageEvent','MediaKeySession','MediaKeyStatusMap','MediaKeySystemAccess','MediaKeys','MediaList','MediaMetadata','MediaQueryList','MediaQueryListEvent','MediaRecorder','MediaRecorderErrorEvent','MediaSession','MediaSource','MediaStream','MediaStreamAudioDestinationNode','MediaStreamAudioSourceNode','MediaStreamTrack','MediaStreamTrackEvent','MessageChannel','MessageEvent','MessagePort','MimeType','MimeTypeArray','MouseEvent','MutationEvent','MutationObserver','MutationRecord','NaN','NamedNodeMap','NavigationPreloadManager','Navigator','NetworkInformation','Node','NodeFilter','NodeIterator','NodeList','Notification','Number','Object','OfflineAudioCompletionEvent','OfflineAudioContext','Option','OscillatorNode','OverconstrainedError','PageTransitionEvent','PannerNode','Path2D','PaymentAddress','PaymentMethodChangeEvent','PaymentRequest','PaymentRequestUpdateEvent','PaymentResponse','Performance','PerformanceEntry','PerformanceEventTiming','PerformanceMark','PerformanceMeasure','PerformanceNavigation','PerformanceNavigationTiming','PerformanceObserver','PerformanceObserverEntryList','PerformancePaintTiming','PerformanceResourceTiming','PerformanceServerTiming','PerformanceTiming','PeriodicWave','PermissionStatus','Permissions','PictureInPictureWindow','Plugin','PluginArray','PointerEvent','PopStateEvent','ProcessingInstruction','ProgressEvent','Promise','PromiseRejectionEvent','Proxy','PublicKeyCredential','PushManager','PushSubscription','PushSubscriptionOptions','RTCCertificate','RTCDTMFSender','RTCDTMFToneChangeEvent','RTCDataChannel','RTCDataChannelEvent','RTCDtlsTransport','RTCEncodedAudioFrame','RTCEncodedVideoFrame','RTCError','RTCErrorEvent','RTCIceCandidate','RTCIceTransport','RTCPeerConnection','RTCPeerConnectionIceErrorEvent','RTCPeerConnectionIceEvent','RTCRtpReceiver','RTCRtpSender','RTCRtpTransceiver','RTCSctpTransport','RTCSessionDescription','RTCStatsReport','RTCTrackEvent','RadioNodeList','Range','RangeError','ReadableByteStreamController','ReadableStream','ReadableStreamBYOBReader','ReadableStreamBYOBRequest','ReadableStreamDefaultController','ReadableStreamDefaultReader','ReferenceError','Reflect','RegExp','RemotePlayback','Request','ResizeObserver','ResizeObserverEntry','ResizeObserverSize','Response','SVGAElement','SVGAngle','SVGAnimateElement','SVGAnimateMotionElement','SVGAnimateTransformElement','SVGAnimatedAngle','SVGAnimatedBoolean','SVGAnimatedEnumeration','SVGAnimatedInteger','SVGAnimatedLength','SVGAnimatedLengthList','SVGAnimatedNumber','SVGAnimatedNumberList','SVGAnimatedPreserveAspectRatio','SVGAnimatedRect','SVGAnimatedString','SVGAnimatedTransformList','SVGAnimationElement','SVGCircleElement','SVGClipPathElement','SVGComponentTransferFunctionElement','SVGCursorElement','SVGDefsElement','SVGDescElement','SVGElement','SVGEllipseElement','SVGFEBlendElement','SVGFEColorMatrixElement','SVGFEComponentTransferElement','SVGFECompositeElement','SVGFEConvolveMatrixElement','SVGFEDiffuseLightingElement','SVGFEDisplacementMapElement','SVGFEDistantLightElement','SVGFEDropShadowElement','SVGFEFloodElement','SVGFEFuncAElement','SVGFEFuncBElement','SVGFEFuncGElement','SVGFEFuncRElement','SVGFEGaussianBlurElement','SVGFEImageElement','SVGFEMergeElement','SVGFEMergeNodeElement','SVGFEMorphologyElement','SVGFEOffsetElement','SVGFEPointLightElement','SVGFESpecularLightingElement','SVGFESpotLightElement','SVGFETileElement','SVGFETurbulenceElement','SVGFilterElement','SVGForeignObjectElement','SVGGElement','SVGGeometryElement','SVGGradientElement','SVGGraphicsElement','SVGImageElement','SVGLength','SVGLengthList','SVGLineElement','SVGLinearGradientElement','SVGMPathElement','SVGMarkerElement','SVGMaskElement','SVGMatrix','SVGMetadataElement','SVGNumber','SVGNumberList','SVGPathElement','SVGPatternElement','SVGPoint','SVGPointList','SVGPolygonElement','SVGPolylineElement','SVGPreserveAspectRatio','SVGRadialGradientElement','SVGRect','SVGRectElement','SVGSVGElement','SVGScriptElement','SVGSetElement','SVGStopElement','SVGStringList','SVGStyleElement','SVGSwitchElement','SVGSymbolElement','SVGTSpanElement','SVGTextContentElement','SVGTextElement','SVGTextPathElement','SVGTextPositioningElement','SVGTitleElement','SVGTransform','SVGTransformList','SVGUnitTypes','SVGUseElement','SVGViewElement','SafeArray','Screen','ScreenOrientation','ScriptProcessorNode','SecurityPolicyViolationEvent','Selection','ServiceWorker','ServiceWorkerContainer','ServiceWorkerRegistration','Set','ShadowRoot','SharedArrayBuffer','SharedWorker','SourceBuffer','SourceBufferList','SpeechRecognitionAlternative','SpeechRecognitionErrorEvent','SpeechRecognitionResult','SpeechRecognitionResultList','SpeechSynthesis','SpeechSynthesisErrorEvent','SpeechSynthesisEvent','SpeechSynthesisUtterance','SpeechSynthesisVoice','StaticRange','StereoPannerNode','Storage','StorageEvent','StorageManager','String','StyleMedia','StyleSheet','StyleSheetList','SubmitEvent','SubtleCrypto','Symbol','SyntaxError','Text','TextDecoder','TextDecoderStream','TextEncoder','TextEncoderStream','TextMetrics','TextTrack','TextTrackCue','TextTrackCueList','TextTrackList','TimeRanges','Touch','TouchEvent','TouchList','TrackEvent','TransformStream','TransformStreamDefaultController','TransitionEvent','TreeWalker','TypeError','UIEvent','URIError','URL','URLSearchParams','Uint16Array','Uint32Array','Uint8Array','Uint8ClampedArray','VBArray','VTTCue','VTTRegion','ValidityState','VarDate','VideoColorSpace','VideoPlaybackQuality','VisualViewport','WSH','WScript','WaveShaperNode','WeakMap','WeakRef','WeakSet','WebAssembly','WebGL2RenderingContext','WebGLActiveInfo','WebGLBuffer','WebGLContextEvent','WebGLFramebuffer','WebGLProgram','WebGLQuery','WebGLRenderbuffer','WebGLRenderingContext','WebGLSampler','WebGLShader','WebGLShaderPrecisionFormat','WebGLSync','WebGLTexture','WebGLTransformFeedback','WebGLUniformLocation','WebGLVertexArrayObject','WebKitCSSMatrix','WebSocket','WheelEvent','Window','Worker','Worklet','WritableStream','WritableStreamDefaultController','WritableStreamDefaultWriter','XMLDocument','XMLHttpRequest','XMLHttpRequestEventTarget','XMLHttpRequestUpload','XMLSerializer','XPathEvaluator','XPathExpression','XPathResult','XSLTProcessor','addEventListener','alert','atob','blur','btoa','caches','cancelAnimationFrame','cancelIdleCallback','captureEvents','clearInterval','clearTimeout','clientInformation','close','closed','confirm','console','createImageBitmap','crossOriginIsolated','crypto','customElements','decodeURI','decodeURIComponent','devicePixelRatio','dispatchEvent','document','encodeURI','encodeURIComponent','escape','eval','event','external','fetch','focus','frameElement','frames','getComputedStyle','getSelection','global','globalThis','history','importScripts','indexedDB','innerHeight','innerWidth','isFinite','isNaN','isSecureContext','length','localStorage','location','locationbar','matchMedia','menubar','moveBy','moveTo','name','navigator','onabort','onafterprint','onanimationcancel','onanimationend','onanimationiteration','onanimationstart','onauxclick','onbeforeprint','onbeforeunload','onblur','oncanplay','oncanplaythrough','onchange','onclick','onclose','oncontextmenu','oncuechange','ondblclick','ondevicemotion','ondeviceorientation','ondrag','ondragend','ondragenter','ondragleave','ondragover','ondragstart','ondrop','ondurationchange','onemptied','onended','onerror','onfocus','onformdata','ongamepadconnected','ongamepaddisconnected','ongotpointercapture','onhashchange','oninput','oninvalid','onkeydown','onkeypress','onkeyup','onlanguagechange','onload','onloadeddata','onloadedmetadata','onloadstart','onlostpointercapture','onmessage','onmessageerror','onmousedown','onmouseenter','onmouseleave','onmousemove','onmouseout','onmouseover','onmouseup','onoffline','ononline','onorientationchange','onpagehide','onpageshow','onpause','onplay','onplaying','onpointercancel','onpointerdown','onpointerenter','onpointerleave','onpointermove','onpointerout','onpointerover','onpointerup','onpopstate','onprogress','onratechange','onrejectionhandled','onreset','onresize','onscroll','onsecuritypolicyviolation','onseeked','onseeking','onselect','onselectionchange','onselectstart','onslotchange','onstalled','onstorage','onsubmit','onsuspend','ontimeupdate','ontoggle','ontouchcancel','ontouchend','ontouchmove','ontouchstart','ontransitioncancel','ontransitionend','ontransitionrun','ontransitionstart','onunhandledrejection','onunload','onvolumechange','onwaiting','onwebkitanimationend','onwebkitanimationiteration','onwebkitanimationstart','onwebkittransitionend','onwheel','open','opener','orientation','origin','outerHeight','outerWidth','pageXOffset','pageYOffset','parent','parseFloat','parseInt','performance','personalbar','postMessage','print','process','prompt','queueMicrotask','releaseEvents','removeEventListener','reportError','requestAnimationFrame','requestIdleCallback','resizeBy','resizeTo','screen','screenLeft','screenTop','screenX','screenY','scroll','scrollBy','scrollTo','scrollX','scrollY','scrollbars','self','sessionStorage','setInterval','setTimeout','speechSynthesis','status','statusbar','stop','structuredClone','toString','toolbar','top','undefined','unescape','visualViewport','webkitURL','window']);const wrappers$1={esm,cjs};function create_module(program,format,name,banner){let sveltePath=arguments.length>4&&arguments[4]!==undefined?arguments[4]:'svelte';let helpers=arguments.length>5?arguments[5]:undefined;let globals=arguments.length>6?arguments[6]:undefined;let imports=arguments.length>7?arguments[7]:undefined;let module_exports=arguments.length>8?arguments[8]:undefined;let exports_from=arguments.length>9?arguments[9]:undefined;const internal_path=`${sveltePath}/internal`;helpers.sort((a,b)=>a.name<b.name?-1:1);globals.sort((a,b)=>a.name<b.name?-1:1);const formatter=wrappers$1[format];if(!formatter){throw new Error(`options.format is invalid (must be ${list$1(Object.keys(wrappers$1))})`);}return formatter(program,name,banner,sveltePath,internal_path,helpers,globals,imports,module_exports,exports_from);}function edit_source(source,sveltePath){return source==='svelte'||source.startsWith('svelte/')?source.replace('svelte',sveltePath):source;}function get_internal_globals(globals,helpers){return globals.length>0&&{type:'VariableDeclaration',kind:'const',declarations:[{type:'VariableDeclarator',id:{type:'ObjectPattern',properties:globals.map(g=>({type:'Property',method:false,shorthand:false,computed:false,key:{type:'Identifier',name:g.name},value:g.alias,kind:'init'}))},init:helpers.find(_ref48=>{let{name}=_ref48;return name==='globals';}).alias}]};}function esm(program,name,banner,sveltePath,internal_path,helpers,globals,imports,module_exports,exports_from){const import_declaration={type:'ImportDeclaration',specifiers:helpers.map(h=>({type:'ImportSpecifier',local:h.alias,imported:{type:'Identifier',name:h.name}})),source:{type:'Literal',value:internal_path}};const internal_globals=get_internal_globals(globals,helpers);// edit user imports\nfunction rewrite_import(node){const value=edit_source(node.source.value,sveltePath);if(node.source.value!==value){node.source.value=value;node.source.raw=null;}}imports.forEach(rewrite_import);exports_from.forEach(rewrite_import);const exports=module_exports.length>0&&{type:'ExportNamedDeclaration',specifiers:module_exports.map(x=>({type:'Specifier',local:{type:'Identifier',name:x.name},exported:{type:'Identifier',name:x.as}}))};program.body=b`\n\t\t/* ${banner} */\n\n\t\t${import_declaration}\n\t\t${internal_globals}\n\t\t${imports}\n\t\t${exports_from}\n\n\t\t${program.body}\n\n\t\texport default ${name};\n\t\t${exports}\n\t`;}function cjs(program,name,banner,sveltePath,internal_path,helpers,globals,imports,module_exports,exports_from){const internal_requires={type:'VariableDeclaration',kind:'const',declarations:[{type:'VariableDeclarator',id:{type:'ObjectPattern',properties:helpers.map(h=>({type:'Property',method:false,shorthand:false,computed:false,key:{type:'Identifier',name:h.name},value:h.alias,kind:'init'}))},init:x`require(\"${internal_path}\")`}]};const internal_globals=get_internal_globals(globals,helpers);const user_requires=imports.map(node=>{const init=x`require(\"${edit_source(node.source.value,sveltePath)}\")`;if(node.specifiers.length===0){return b`${init};`;}return{type:'VariableDeclaration',kind:'const',declarations:[{type:'VariableDeclarator',id:node.specifiers[0].type==='ImportNamespaceSpecifier'?{type:'Identifier',name:node.specifiers[0].local.name}:{type:'ObjectPattern',properties:node.specifiers.map(s=>({type:'Property',method:false,shorthand:false,computed:false,key:s.type==='ImportSpecifier'?s.imported:{type:'Identifier',name:'default'},value:s.local,kind:'init'}))},init}]};});const exports=module_exports.map(x=>b`exports.${{type:'Identifier',name:x.as}} = ${{type:'Identifier',name:x.name}};`);const user_exports_from=exports_from.map(node=>{const init=x`require(\"${edit_source(node.source.value,sveltePath)}\")`;return node.specifiers.map(specifier=>{return b`exports.${specifier.exported} = ${init}.${specifier.local};`;});});program.body=b`\n\t\t/* ${banner} */\n\n\t\t\"use strict\";\n\t\t${internal_requires}\n\t\t${internal_globals}\n\t\t${user_requires}\n\t\t${user_exports_from}\n\n\t\t${program.body}\n\n\t\texports.default = ${name};\n\t\t${exports}\n\t`;}var Chunk=function Chunk(start,end,content){this.start=start;this.end=end;this.original=content;this.intro='';this.outro='';this.content=content;this.storeName=false;this.edited=false;// we make these non-enumerable, for sanity while debugging\nObject.defineProperties(this,{previous:{writable:true,value:null},next:{writable:true,value:null}});};Chunk.prototype.appendLeft=function appendLeft(content){this.outro+=content;};Chunk.prototype.appendRight=function appendRight(content){this.intro=this.intro+content;};Chunk.prototype.clone=function clone(){var chunk=new Chunk(this.start,this.end,this.original);chunk.intro=this.intro;chunk.outro=this.outro;chunk.content=this.content;chunk.storeName=this.storeName;chunk.edited=this.edited;return chunk;};Chunk.prototype.contains=function contains(index){return this.start<index&&index<this.end;};Chunk.prototype.eachNext=function eachNext(fn){var chunk=this;while(chunk){fn(chunk);chunk=chunk.next;}};Chunk.prototype.eachPrevious=function eachPrevious(fn){var chunk=this;while(chunk){fn(chunk);chunk=chunk.previous;}};Chunk.prototype.edit=function edit(content,storeName,contentOnly){this.content=content;if(!contentOnly){this.intro='';this.outro='';}this.storeName=storeName;this.edited=true;return this;};Chunk.prototype.prependLeft=function prependLeft(content){this.outro=content+this.outro;};Chunk.prototype.prependRight=function prependRight(content){this.intro=content+this.intro;};Chunk.prototype.split=function split(index){var sliceIndex=index-this.start;var originalBefore=this.original.slice(0,sliceIndex);var originalAfter=this.original.slice(sliceIndex);this.original=originalBefore;var newChunk=new Chunk(index,this.end,originalAfter);newChunk.outro=this.outro;this.outro='';this.end=index;if(this.edited){// TODO is this block necessary?...\nnewChunk.edit('',false);this.content='';}else{this.content=originalBefore;}newChunk.next=this.next;if(newChunk.next){newChunk.next.previous=newChunk;}newChunk.previous=this;this.next=newChunk;return newChunk;};Chunk.prototype.toString=function toString(){return this.intro+this.content+this.outro;};Chunk.prototype.trimEnd=function trimEnd(rx){this.outro=this.outro.replace(rx,'');if(this.outro.length){return true;}var trimmed=this.content.replace(rx,'');if(trimmed.length){if(trimmed!==this.content){this.split(this.start+trimmed.length).edit('',undefined,true);}return true;}else{this.edit('',undefined,true);this.intro=this.intro.replace(rx,'');if(this.intro.length){return true;}}};Chunk.prototype.trimStart=function trimStart(rx){this.intro=this.intro.replace(rx,'');if(this.intro.length){return true;}var trimmed=this.content.replace(rx,'');if(trimmed.length){if(trimmed!==this.content){this.split(this.end-trimmed.length);this.edit('',undefined,true);}return true;}else{this.edit('',undefined,true);this.outro=this.outro.replace(rx,'');if(this.outro.length){return true;}}};var btoa$2=function(){throw new Error('Unsupported environment: `window.btoa` or `Buffer` should be supported.');};if(typeof window!=='undefined'&&typeof window.btoa==='function'){btoa$2=function(str){return window.btoa(unescape(encodeURIComponent(str)));};}else if(typeof Buffer==='function'){btoa$2=function(str){return Buffer.from(str,'utf-8').toString('base64');};}var SourceMap$1=function SourceMap(properties){this.version=3;this.file=properties.file;this.sources=properties.sources;this.sourcesContent=properties.sourcesContent;this.names=properties.names;this.mappings=encode(properties.mappings);};SourceMap$1.prototype.toString=function toString(){return JSON.stringify(this);};SourceMap$1.prototype.toUrl=function toUrl(){return'data:application/json;charset=utf-8;base64,'+btoa$2(this.toString());};function guessIndent(code){var lines=code.split('\\n');var tabbed=lines.filter(function(line){return /^\\t+/.test(line);});var spaced=lines.filter(function(line){return /^ {2,}/.test(line);});if(tabbed.length===0&&spaced.length===0){return null;}// More lines tabbed than spaced? Assume tabs, and\n// default to tabs in the case of a tie (or nothing\n// to go on)\nif(tabbed.length>=spaced.length){return'\\t';}// Otherwise, we need to guess the multiple\nvar min=spaced.reduce(function(previous,current){var numSpaces=/^ +/.exec(current)[0].length;return Math.min(numSpaces,previous);},Infinity);return new Array(min+1).join(' ');}function getRelativePath(from,to){var fromParts=from.split(/[/\\\\]/);var toParts=to.split(/[/\\\\]/);fromParts.pop();// get dirname\nwhile(fromParts[0]===toParts[0]){fromParts.shift();toParts.shift();}if(fromParts.length){var i=fromParts.length;while(i--){fromParts[i]='..';}}return fromParts.concat(toParts).join('/');}var toString$1=Object.prototype.toString;function isObject(thing){return toString$1.call(thing)==='[object Object]';}function getLocator$1(source){var originalLines=source.split('\\n');var lineOffsets=[];for(var i=0,pos=0;i<originalLines.length;i++){lineOffsets.push(pos);pos+=originalLines[i].length+1;}return function locate(index){var i=0;var j=lineOffsets.length;while(i<j){var m=i+j>>1;if(index<lineOffsets[m]){j=m;}else{i=m+1;}}var line=i-1;var column=index-lineOffsets[line];return{line:line,column:column};};}var Mappings=function Mappings(hires){this.hires=hires;this.generatedCodeLine=0;this.generatedCodeColumn=0;this.raw=[];this.rawSegments=this.raw[this.generatedCodeLine]=[];this.pending=null;};Mappings.prototype.addEdit=function addEdit(sourceIndex,content,loc,nameIndex){if(content.length){var segment=[this.generatedCodeColumn,sourceIndex,loc.line,loc.column];if(nameIndex>=0){segment.push(nameIndex);}this.rawSegments.push(segment);}else if(this.pending){this.rawSegments.push(this.pending);}this.advance(content);this.pending=null;};Mappings.prototype.addUneditedChunk=function addUneditedChunk(sourceIndex,chunk,original,loc,sourcemapLocations){var originalCharIndex=chunk.start;var first=true;while(originalCharIndex<chunk.end){if(this.hires||first||sourcemapLocations[originalCharIndex]){this.rawSegments.push([this.generatedCodeColumn,sourceIndex,loc.line,loc.column]);}if(original[originalCharIndex]==='\\n'){loc.line+=1;loc.column=0;this.generatedCodeLine+=1;this.raw[this.generatedCodeLine]=this.rawSegments=[];this.generatedCodeColumn=0;}else{loc.column+=1;this.generatedCodeColumn+=1;}originalCharIndex+=1;first=false;}this.pending=[this.generatedCodeColumn,sourceIndex,loc.line,loc.column];};Mappings.prototype.advance=function advance(str){if(!str){return;}var lines=str.split('\\n');if(lines.length>1){for(var i=0;i<lines.length-1;i++){this.generatedCodeLine++;this.raw[this.generatedCodeLine]=this.rawSegments=[];}this.generatedCodeColumn=0;}this.generatedCodeColumn+=lines[lines.length-1].length;};var n='\\n';var warned={insertLeft:false,insertRight:false,storeName:false};var MagicString=function MagicString(string,options){if(options===void 0)options={};var chunk=new Chunk(0,string.length,string);Object.defineProperties(this,{original:{writable:true,value:string},outro:{writable:true,value:''},intro:{writable:true,value:''},firstChunk:{writable:true,value:chunk},lastChunk:{writable:true,value:chunk},lastSearchedChunk:{writable:true,value:chunk},byStart:{writable:true,value:{}},byEnd:{writable:true,value:{}},filename:{writable:true,value:options.filename},indentExclusionRanges:{writable:true,value:options.indentExclusionRanges},sourcemapLocations:{writable:true,value:{}},storedNames:{writable:true,value:{}},indentStr:{writable:true,value:guessIndent(string)}});this.byStart[0]=chunk;this.byEnd[string.length]=chunk;};MagicString.prototype.addSourcemapLocation=function addSourcemapLocation(char){this.sourcemapLocations[char]=true;};MagicString.prototype.append=function append(content){if(typeof content!=='string'){throw new TypeError('outro content must be a string');}this.outro+=content;return this;};MagicString.prototype.appendLeft=function appendLeft(index,content){if(typeof content!=='string'){throw new TypeError('inserted content must be a string');}this._split(index);var chunk=this.byEnd[index];if(chunk){chunk.appendLeft(content);}else{this.intro+=content;}return this;};MagicString.prototype.appendRight=function appendRight(index,content){if(typeof content!=='string'){throw new TypeError('inserted content must be a string');}this._split(index);var chunk=this.byStart[index];if(chunk){chunk.appendRight(content);}else{this.outro+=content;}return this;};MagicString.prototype.clone=function clone(){var cloned=new MagicString(this.original,{filename:this.filename});var originalChunk=this.firstChunk;var clonedChunk=cloned.firstChunk=cloned.lastSearchedChunk=originalChunk.clone();while(originalChunk){cloned.byStart[clonedChunk.start]=clonedChunk;cloned.byEnd[clonedChunk.end]=clonedChunk;var nextOriginalChunk=originalChunk.next;var nextClonedChunk=nextOriginalChunk&&nextOriginalChunk.clone();if(nextClonedChunk){clonedChunk.next=nextClonedChunk;nextClonedChunk.previous=clonedChunk;clonedChunk=nextClonedChunk;}originalChunk=nextOriginalChunk;}cloned.lastChunk=clonedChunk;if(this.indentExclusionRanges){cloned.indentExclusionRanges=this.indentExclusionRanges.slice();}Object.keys(this.sourcemapLocations).forEach(function(loc){cloned.sourcemapLocations[loc]=true;});return cloned;};MagicString.prototype.generateDecodedMap=function generateDecodedMap(options){var this$1=this;options=options||{};var sourceIndex=0;var names=Object.keys(this.storedNames);var mappings=new Mappings(options.hires);var locate=getLocator$1(this.original);if(this.intro){mappings.advance(this.intro);}this.firstChunk.eachNext(function(chunk){var loc=locate(chunk.start);if(chunk.intro.length){mappings.advance(chunk.intro);}if(chunk.edited){mappings.addEdit(sourceIndex,chunk.content,loc,chunk.storeName?names.indexOf(chunk.original):-1);}else{mappings.addUneditedChunk(sourceIndex,chunk,this$1.original,loc,this$1.sourcemapLocations);}if(chunk.outro.length){mappings.advance(chunk.outro);}});return{file:options.file?options.file.split(/[/\\\\]/).pop():null,sources:[options.source?getRelativePath(options.file||'',options.source):null],sourcesContent:options.includeContent?[this.original]:[null],names:names,mappings:mappings.raw};};MagicString.prototype.generateMap=function generateMap(options){return new SourceMap$1(this.generateDecodedMap(options));};MagicString.prototype.getIndentString=function getIndentString(){return this.indentStr===null?'\\t':this.indentStr;};MagicString.prototype.indent=function indent(indentStr,options){var pattern=/^[^\\r\\n]/gm;if(isObject(indentStr)){options=indentStr;indentStr=undefined;}indentStr=indentStr!==undefined?indentStr:this.indentStr||'\\t';if(indentStr===''){return this;}// noop\noptions=options||{};// Process exclusion ranges\nvar isExcluded={};if(options.exclude){var exclusions=typeof options.exclude[0]==='number'?[options.exclude]:options.exclude;exclusions.forEach(function(exclusion){for(var i=exclusion[0];i<exclusion[1];i+=1){isExcluded[i]=true;}});}var shouldIndentNextCharacter=options.indentStart!==false;var replacer=function(match){if(shouldIndentNextCharacter){return\"\"+indentStr+match;}shouldIndentNextCharacter=true;return match;};this.intro=this.intro.replace(pattern,replacer);var charIndex=0;var chunk=this.firstChunk;while(chunk){var end=chunk.end;if(chunk.edited){if(!isExcluded[charIndex]){chunk.content=chunk.content.replace(pattern,replacer);if(chunk.content.length){shouldIndentNextCharacter=chunk.content[chunk.content.length-1]==='\\n';}}}else{charIndex=chunk.start;while(charIndex<end){if(!isExcluded[charIndex]){var char=this.original[charIndex];if(char==='\\n'){shouldIndentNextCharacter=true;}else if(char!=='\\r'&&shouldIndentNextCharacter){shouldIndentNextCharacter=false;if(charIndex===chunk.start){chunk.prependRight(indentStr);}else{this._splitChunk(chunk,charIndex);chunk=chunk.next;chunk.prependRight(indentStr);}}}charIndex+=1;}}charIndex=chunk.end;chunk=chunk.next;}this.outro=this.outro.replace(pattern,replacer);return this;};MagicString.prototype.insert=function insert(){throw new Error('magicString.insert(...) is deprecated. Use prependRight(...) or appendLeft(...)');};MagicString.prototype.insertLeft=function insertLeft(index,content){if(!warned.insertLeft){console.warn('magicString.insertLeft(...) is deprecated. Use magicString.appendLeft(...) instead');// eslint-disable-line no-console\nwarned.insertLeft=true;}return this.appendLeft(index,content);};MagicString.prototype.insertRight=function insertRight(index,content){if(!warned.insertRight){console.warn('magicString.insertRight(...) is deprecated. Use magicString.prependRight(...) instead');// eslint-disable-line no-console\nwarned.insertRight=true;}return this.prependRight(index,content);};MagicString.prototype.move=function move(start,end,index){if(index>=start&&index<=end){throw new Error('Cannot move a selection inside itself');}this._split(start);this._split(end);this._split(index);var first=this.byStart[start];var last=this.byEnd[end];var oldLeft=first.previous;var oldRight=last.next;var newRight=this.byStart[index];if(!newRight&&last===this.lastChunk){return this;}var newLeft=newRight?newRight.previous:this.lastChunk;if(oldLeft){oldLeft.next=oldRight;}if(oldRight){oldRight.previous=oldLeft;}if(newLeft){newLeft.next=first;}if(newRight){newRight.previous=last;}if(!first.previous){this.firstChunk=last.next;}if(!last.next){this.lastChunk=first.previous;this.lastChunk.next=null;}first.previous=newLeft;last.next=newRight||null;if(!newLeft){this.firstChunk=first;}if(!newRight){this.lastChunk=last;}return this;};MagicString.prototype.overwrite=function overwrite(start,end,content,options){if(typeof content!=='string'){throw new TypeError('replacement content must be a string');}while(start<0){start+=this.original.length;}while(end<0){end+=this.original.length;}if(end>this.original.length){throw new Error('end is out of bounds');}if(start===end){throw new Error('Cannot overwrite a zero-length range – use appendLeft or prependRight instead');}this._split(start);this._split(end);if(options===true){if(!warned.storeName){console.warn('The final argument to magicString.overwrite(...) should be an options object. See https://github.com/rich-harris/magic-string');// eslint-disable-line no-console\nwarned.storeName=true;}options={storeName:true};}var storeName=options!==undefined?options.storeName:false;var contentOnly=options!==undefined?options.contentOnly:false;if(storeName){var original=this.original.slice(start,end);this.storedNames[original]=true;}var first=this.byStart[start];var last=this.byEnd[end];if(first){if(end>first.end&&first.next!==this.byStart[first.end]){throw new Error('Cannot overwrite across a split point');}first.edit(content,storeName,contentOnly);if(first!==last){var chunk=first.next;while(chunk!==last){chunk.edit('',false);chunk=chunk.next;}chunk.edit('',false);}}else{// must be inserting at the end\nvar newChunk=new Chunk(start,end,'').edit(content,storeName);// TODO last chunk in the array may not be the last chunk, if it's moved...\nlast.next=newChunk;newChunk.previous=last;}return this;};MagicString.prototype.prepend=function prepend(content){if(typeof content!=='string'){throw new TypeError('outro content must be a string');}this.intro=content+this.intro;return this;};MagicString.prototype.prependLeft=function prependLeft(index,content){if(typeof content!=='string'){throw new TypeError('inserted content must be a string');}this._split(index);var chunk=this.byEnd[index];if(chunk){chunk.prependLeft(content);}else{this.intro=content+this.intro;}return this;};MagicString.prototype.prependRight=function prependRight(index,content){if(typeof content!=='string'){throw new TypeError('inserted content must be a string');}this._split(index);var chunk=this.byStart[index];if(chunk){chunk.prependRight(content);}else{this.outro=content+this.outro;}return this;};MagicString.prototype.remove=function remove(start,end){while(start<0){start+=this.original.length;}while(end<0){end+=this.original.length;}if(start===end){return this;}if(start<0||end>this.original.length){throw new Error('Character is out of bounds');}if(start>end){throw new Error('end must be greater than start');}this._split(start);this._split(end);var chunk=this.byStart[start];while(chunk){chunk.intro='';chunk.outro='';chunk.edit('');chunk=end>chunk.end?this.byStart[chunk.end]:null;}return this;};MagicString.prototype.lastChar=function lastChar(){if(this.outro.length){return this.outro[this.outro.length-1];}var chunk=this.lastChunk;do{if(chunk.outro.length){return chunk.outro[chunk.outro.length-1];}if(chunk.content.length){return chunk.content[chunk.content.length-1];}if(chunk.intro.length){return chunk.intro[chunk.intro.length-1];}}while(chunk=chunk.previous);if(this.intro.length){return this.intro[this.intro.length-1];}return'';};MagicString.prototype.lastLine=function lastLine(){var lineIndex=this.outro.lastIndexOf(n);if(lineIndex!==-1){return this.outro.substr(lineIndex+1);}var lineStr=this.outro;var chunk=this.lastChunk;do{if(chunk.outro.length>0){lineIndex=chunk.outro.lastIndexOf(n);if(lineIndex!==-1){return chunk.outro.substr(lineIndex+1)+lineStr;}lineStr=chunk.outro+lineStr;}if(chunk.content.length>0){lineIndex=chunk.content.lastIndexOf(n);if(lineIndex!==-1){return chunk.content.substr(lineIndex+1)+lineStr;}lineStr=chunk.content+lineStr;}if(chunk.intro.length>0){lineIndex=chunk.intro.lastIndexOf(n);if(lineIndex!==-1){return chunk.intro.substr(lineIndex+1)+lineStr;}lineStr=chunk.intro+lineStr;}}while(chunk=chunk.previous);lineIndex=this.intro.lastIndexOf(n);if(lineIndex!==-1){return this.intro.substr(lineIndex+1)+lineStr;}return this.intro+lineStr;};MagicString.prototype.slice=function slice(start,end){if(start===void 0)start=0;if(end===void 0)end=this.original.length;while(start<0){start+=this.original.length;}while(end<0){end+=this.original.length;}var result='';// find start chunk\nvar chunk=this.firstChunk;while(chunk&&(chunk.start>start||chunk.end<=start)){// found end chunk before start\nif(chunk.start<end&&chunk.end>=end){return result;}chunk=chunk.next;}if(chunk&&chunk.edited&&chunk.start!==start){throw new Error(\"Cannot use replaced character \"+start+\" as slice start anchor.\");}var startChunk=chunk;while(chunk){if(chunk.intro&&(startChunk!==chunk||chunk.start===start)){result+=chunk.intro;}var containsEnd=chunk.start<end&&chunk.end>=end;if(containsEnd&&chunk.edited&&chunk.end!==end){throw new Error(\"Cannot use replaced character \"+end+\" as slice end anchor.\");}var sliceStart=startChunk===chunk?start-chunk.start:0;var sliceEnd=containsEnd?chunk.content.length+end-chunk.end:chunk.content.length;result+=chunk.content.slice(sliceStart,sliceEnd);if(chunk.outro&&(!containsEnd||chunk.end===end)){result+=chunk.outro;}if(containsEnd){break;}chunk=chunk.next;}return result;};// TODO deprecate this? not really very useful\nMagicString.prototype.snip=function snip(start,end){var clone=this.clone();clone.remove(0,start);clone.remove(end,clone.original.length);return clone;};MagicString.prototype._split=function _split(index){if(this.byStart[index]||this.byEnd[index]){return;}var chunk=this.lastSearchedChunk;var searchForward=index>chunk.end;while(chunk){if(chunk.contains(index)){return this._splitChunk(chunk,index);}chunk=searchForward?this.byStart[chunk.end]:this.byEnd[chunk.start];}};MagicString.prototype._splitChunk=function _splitChunk(chunk,index){if(chunk.edited&&chunk.content.length){// zero-length edited chunks are a special case (overlapping replacements)\nvar loc=getLocator$1(this.original)(index);throw new Error(\"Cannot split a chunk that has already been edited (\"+loc.line+\":\"+loc.column+\" – \\\"\"+chunk.original+\"\\\")\");}var newChunk=chunk.split(index);this.byEnd[index]=chunk;this.byStart[index]=newChunk;this.byEnd[newChunk.end]=newChunk;if(chunk===this.lastChunk){this.lastChunk=newChunk;}this.lastSearchedChunk=chunk;return true;};MagicString.prototype.toString=function toString(){var str=this.intro;var chunk=this.firstChunk;while(chunk){str+=chunk.toString();chunk=chunk.next;}return str+this.outro;};MagicString.prototype.isEmpty=function isEmpty(){var chunk=this.firstChunk;do{if(chunk.intro.length&&chunk.intro.trim()||chunk.content.length&&chunk.content.trim()||chunk.outro.length&&chunk.outro.trim()){return false;}}while(chunk=chunk.next);return true;};MagicString.prototype.length=function length(){var chunk=this.firstChunk;var length=0;do{length+=chunk.intro.length+chunk.content.length+chunk.outro.length;}while(chunk=chunk.next);return length;};MagicString.prototype.trimLines=function trimLines(){return this.trim('[\\\\r\\\\n]');};MagicString.prototype.trim=function trim(charType){return this.trimStart(charType).trimEnd(charType);};MagicString.prototype.trimEndAborted=function trimEndAborted(charType){var rx=new RegExp((charType||'\\\\s')+'+$');this.outro=this.outro.replace(rx,'');if(this.outro.length){return true;}var chunk=this.lastChunk;do{var end=chunk.end;var aborted=chunk.trimEnd(rx);// if chunk was trimmed, we have a new lastChunk\nif(chunk.end!==end){if(this.lastChunk===chunk){this.lastChunk=chunk.next;}this.byEnd[chunk.end]=chunk;this.byStart[chunk.next.start]=chunk.next;this.byEnd[chunk.next.end]=chunk.next;}if(aborted){return true;}chunk=chunk.previous;}while(chunk);return false;};MagicString.prototype.trimEnd=function trimEnd(charType){this.trimEndAborted(charType);return this;};MagicString.prototype.trimStartAborted=function trimStartAborted(charType){var rx=new RegExp('^'+(charType||'\\\\s')+'+');this.intro=this.intro.replace(rx,'');if(this.intro.length){return true;}var chunk=this.firstChunk;do{var end=chunk.end;var aborted=chunk.trimStart(rx);if(chunk.end!==end){// special case...\nif(chunk===this.lastChunk){this.lastChunk=chunk.next;}this.byEnd[chunk.end]=chunk;this.byStart[chunk.next.start]=chunk.next;this.byEnd[chunk.next.end]=chunk.next;}if(aborted){return true;}chunk=chunk.next;}while(chunk);return false;};MagicString.prototype.trimStart=function trimStart(charType){this.trimStartAborted(charType);return this;};const UNKNOWN={};function gather_possible_values(node,set){if(node.type==='Literal'){set.add(node.value);}else if(node.type==='ConditionalExpression'){gather_possible_values(node.consequent,set);gather_possible_values(node.alternate,set);}else{set.add(UNKNOWN);}}var BlockAppliesToNode;(function(BlockAppliesToNode){BlockAppliesToNode[BlockAppliesToNode[\"NotPossible\"]=0]=\"NotPossible\";BlockAppliesToNode[BlockAppliesToNode[\"Possible\"]=1]=\"Possible\";BlockAppliesToNode[BlockAppliesToNode[\"UnknownSelectorType\"]=2]=\"UnknownSelectorType\";})(BlockAppliesToNode||(BlockAppliesToNode={}));var NodeExist;(function(NodeExist){NodeExist[NodeExist[\"Probably\"]=1]=\"Probably\";NodeExist[NodeExist[\"Definitely\"]=2]=\"Definitely\";})(NodeExist||(NodeExist={}));const whitelist_attribute_selector=new Map([['details',new Set(['open'])],['dialog',new Set(['open'])]]);const regex_is_single_css_selector=/[^\\\\],(?!([^([]+[^\\\\]|[^([\\\\])[)\\]])/;class Selector$1{constructor(node,stylesheet){this.node=node;this.stylesheet=stylesheet;this.blocks=group_selectors(node);// take trailing :global(...) selectors out of consideration\nlet i=this.blocks.length;while(i>0){if(!this.blocks[i-1].global)break;i-=1;}this.local_blocks=this.blocks.slice(0,i);const host_only=this.blocks.length===1&&this.blocks[0].host;const root_only=this.blocks.length===1&&this.blocks[0].root;this.used=this.local_blocks.length===0||host_only||root_only;}apply(node){const to_encapsulate=[];apply_selector(this.local_blocks.slice(),node,to_encapsulate);if(to_encapsulate.length>0){to_encapsulate.forEach(_ref49=>{let{node,block}=_ref49;this.stylesheet.nodes_with_css_class.add(node);block.should_encapsulate=true;});this.used=true;}}minify(code){let c=null;this.blocks.forEach((block,i)=>{if(i>0){if(block.start-c>1){code.overwrite(c,block.start,block.combinator.name||' ');}}c=block.end;});}transform(code,attr,max_amount_class_specificity_increased){const amount_class_specificity_to_increase=max_amount_class_specificity_increased-this.blocks.filter(block=>block.should_encapsulate).length;function remove_global_pseudo_class(selector){const first=selector.children[0];const last=selector.children[selector.children.length-1];code.remove(selector.start,first.start).remove(last.end,selector.end);}function encapsulate_block(block,attr){for(const selector of block.selectors){if(selector.type==='PseudoClassSelector'&&selector.name==='global'){remove_global_pseudo_class(selector);}}let i=block.selectors.length;while(i--){const selector=block.selectors[i];if(selector.type==='PseudoElementSelector'||selector.type==='PseudoClassSelector'){if(selector.name!=='root'&&selector.name!=='host'){if(i===0)code.prependRight(selector.start,attr);}continue;}if(selector.type==='TypeSelector'&&selector.name==='*'){code.overwrite(selector.start,selector.end,attr);}else{code.appendLeft(selector.end,attr);}break;}}this.blocks.forEach((block,index)=>{if(block.global){remove_global_pseudo_class(block.selectors[0]);}if(block.should_encapsulate)encapsulate_block(block,index===this.blocks.length-1?attr.repeat(amount_class_specificity_to_increase+1):attr);});}validate(component){let start=0;let end=this.blocks.length;for(;start<end;start+=1){if(!this.blocks[start].global)break;}for(;end>start;end-=1){if(!this.blocks[end-1].global)break;}for(let i=start;i<end;i+=1){if(this.blocks[i].global){return component.error(this.blocks[i].selectors[0],compiler_errors.css_invalid_global);}}this.validate_global_with_multiple_selectors(component);this.validate_invalid_combinator_without_selector(component);}validate_global_with_multiple_selectors(component){if(this.blocks.length===1&&this.blocks[0].selectors.length===1){// standalone :global() with multiple selectors is OK\nreturn;}for(const block of this.blocks){for(const selector of block.selectors){if(selector.type==='PseudoClassSelector'&&selector.name==='global'){if(regex_is_single_css_selector.test(selector.children[0].value)){component.error(selector,compiler_errors.css_invalid_global_selector);}}}}}validate_invalid_combinator_without_selector(component){for(let i=0;i<this.blocks.length;i++){const block=this.blocks[i];if(block.combinator&&block.selectors.length===0){component.error(this.node,compiler_errors.css_invalid_selector(component.source.slice(this.node.start,this.node.end)));}if(!block.combinator&&block.selectors.length===0){component.error(this.node,compiler_errors.css_invalid_selector(component.source.slice(this.node.start,this.node.end)));}}}get_amount_class_specificity_increased(){let count=0;for(const block of this.blocks){if(block.should_encapsulate){count++;}}return count;}}function apply_selector(blocks,node,to_encapsulate){const block=blocks.pop();if(!block)return false;if(!node){return block.global&&blocks.every(block=>block.global)||block.host&&blocks.length===0;}switch(block_might_apply_to_node(block,node)){case BlockAppliesToNode.NotPossible:return false;case BlockAppliesToNode.UnknownSelectorType:// bail. TODO figure out what these could be\nto_encapsulate.push({node,block});return true;}if(block.combinator){if(block.combinator.type==='WhiteSpace'){for(const ancestor_block of blocks){if(ancestor_block.global){continue;}if(ancestor_block.host){to_encapsulate.push({node,block});return true;}let parent=node;while(parent=get_element_parent(parent)){if(block_might_apply_to_node(ancestor_block,parent)!==BlockAppliesToNode.NotPossible){to_encapsulate.push({node:parent,block:ancestor_block});}}if(to_encapsulate.length){to_encapsulate.push({node,block});return true;}}if(blocks.every(block=>block.global)){to_encapsulate.push({node,block});return true;}return false;}else if(block.combinator.name==='>'){const has_global_parent=blocks.every(block=>block.global);if(has_global_parent||apply_selector(blocks,get_element_parent(node),to_encapsulate)){to_encapsulate.push({node,block});return true;}return false;}else if(block.combinator.name==='+'||block.combinator.name==='~'){const siblings=get_possible_element_siblings(node,block.combinator.name==='+');let has_match=false;// NOTE: if we have :global(), we couldn't figure out what is selected within `:global` due to the\n// css-tree limitation that does not parse the inner selector of :global\n// so unless we are sure there will be no sibling to match, we will consider it as matched\nconst has_global=blocks.some(block=>block.global);if(has_global){if(siblings.size===0&&get_element_parent(node)!==null){return false;}to_encapsulate.push({node,block});return true;}for(const possible_sibling of siblings.keys()){if(apply_selector(blocks.slice(),possible_sibling,to_encapsulate)){to_encapsulate.push({node,block});has_match=true;}}return has_match;}// TODO other combinators\nto_encapsulate.push({node,block});return true;}to_encapsulate.push({node,block});return true;}const regex_backslash_and_following_character=/\\\\(.)/g;function block_might_apply_to_node(block,node){let i=block.selectors.length;while(i--){const selector=block.selectors[i];const name=typeof selector.name==='string'&&selector.name.replace(regex_backslash_and_following_character,'$1');if(selector.type==='PseudoClassSelector'&&(name==='host'||name==='root')){return BlockAppliesToNode.NotPossible;}if(block.selectors.length===1&&selector.type==='PseudoClassSelector'&&name==='global'){return BlockAppliesToNode.NotPossible;}if(selector.type==='PseudoClassSelector'||selector.type==='PseudoElementSelector'){continue;}if(selector.type==='ClassSelector'){if(!attribute_matches(node,'class',name,'~=',false)&&!node.classes.some(c=>c.name===name))return BlockAppliesToNode.NotPossible;}else if(selector.type==='IdSelector'){if(!attribute_matches(node,'id',name,'=',false))return BlockAppliesToNode.NotPossible;}else if(selector.type==='AttributeSelector'){if(!(whitelist_attribute_selector.has(node.name.toLowerCase())&&whitelist_attribute_selector.get(node.name.toLowerCase()).has(selector.name.name.toLowerCase()))&&!attribute_matches(node,selector.name.name,selector.value&&unquote(selector.value),selector.matcher,selector.flags)){return BlockAppliesToNode.NotPossible;}}else if(selector.type==='TypeSelector'){if(node.name.toLowerCase()!==name.toLowerCase()&&name!=='*'&&!node.is_dynamic_element)return BlockAppliesToNode.NotPossible;}else{return BlockAppliesToNode.UnknownSelectorType;}}return BlockAppliesToNode.Possible;}function test_attribute(operator,expected_value,case_insensitive,value){if(case_insensitive){expected_value=expected_value.toLowerCase();value=value.toLowerCase();}switch(operator){case'=':return value===expected_value;case'~=':return value.split(/\\s/).includes(expected_value);case'|=':return`${value}-`.startsWith(`${expected_value}-`);case'^=':return value.startsWith(expected_value);case'$=':return value.endsWith(expected_value);case'*=':return value.includes(expected_value);default:throw new Error(\"this shouldn't happen\");}}function attribute_matches(node,name,expected_value,operator,case_insensitive){const spread=node.attributes.find(attr=>attr.type==='Spread');if(spread)return true;if(node.bindings.some(binding=>binding.name===name))return true;const attr=node.attributes.find(attr=>attr.name===name);if(!attr)return false;if(attr.is_true)return operator===null;if(!expected_value)return true;if(attr.chunks.length===1){const value=attr.chunks[0];if(!value)return false;if(value.type==='Text')return test_attribute(operator,expected_value,case_insensitive,value.data);}const possible_values=new Set();let prev_values=[];for(const chunk of attr.chunks){const current_possible_values=new Set();if(chunk.type==='Text'){current_possible_values.add(chunk.data);}else{gather_possible_values(chunk.node,current_possible_values);}// impossible to find out all combinations\nif(current_possible_values.has(UNKNOWN))return true;if(prev_values.length>0){const start_with_space=[];const remaining=[];current_possible_values.forEach(current_possible_value=>{if(regex_starts_with_whitespace.test(current_possible_value)){start_with_space.push(current_possible_value);}else{remaining.push(current_possible_value);}});if(remaining.length>0){if(start_with_space.length>0){prev_values.forEach(prev_value=>possible_values.add(prev_value));}const combined=[];prev_values.forEach(prev_value=>{remaining.forEach(value=>{combined.push(prev_value+value);});});prev_values=combined;start_with_space.forEach(value=>{if(regex_ends_with_whitespace.test(value)){possible_values.add(value);}else{prev_values.push(value);}});continue;}else{prev_values.forEach(prev_value=>possible_values.add(prev_value));prev_values=[];}}current_possible_values.forEach(current_possible_value=>{if(regex_ends_with_whitespace.test(current_possible_value)){possible_values.add(current_possible_value);}else{prev_values.push(current_possible_value);}});if(prev_values.length<current_possible_values.size){prev_values.push(' ');}if(prev_values.length>20){// might grow exponentially, bail out\nreturn true;}}prev_values.forEach(prev_value=>possible_values.add(prev_value));if(possible_values.has(UNKNOWN))return true;for(const value of possible_values){if(test_attribute(operator,expected_value,case_insensitive,value))return true;}return false;}function unquote(value){if(value.type==='Identifier')return value.name;const str=value.value;if(str[0]===str[str.length-1]&&str[0]===\"'\"||str[0]==='\"'){return str.slice(1,str.length-1);}return str;}function get_element_parent(node){let parent=node;while((parent=parent.parent)&&parent.type!=='Element');return parent;}function get_possible_element_siblings(node,adjacent_only){const result=new Map();let prev=node;while(prev=prev.prev){if(prev.type==='Element'){if(!prev.attributes.find(attr=>attr.type==='Attribute'&&attr.name.toLowerCase()==='slot')){result.set(prev,NodeExist.Definitely);}if(adjacent_only){break;}}else if(prev.type==='EachBlock'||prev.type==='IfBlock'||prev.type==='AwaitBlock'){const possible_last_child=get_possible_last_child(prev,adjacent_only);add_to_map(possible_last_child,result);if(adjacent_only&&has_definite_elements(possible_last_child)){return result;}}}if(!prev||!adjacent_only){let parent=node;let skip_each_for_last_child=node.type==='ElseBlock';while((parent=parent.parent)&&(parent.type==='EachBlock'||parent.type==='IfBlock'||parent.type==='ElseBlock'||parent.type==='AwaitBlock')){const possible_siblings=get_possible_element_siblings(parent,adjacent_only);add_to_map(possible_siblings,result);if(parent.type==='EachBlock'){// first child of each block can select the last child of each block as previous sibling\nif(skip_each_for_last_child){skip_each_for_last_child=false;}else{add_to_map(get_possible_last_child(parent,adjacent_only),result);}}else if(parent.type==='ElseBlock'){skip_each_for_last_child=true;parent=parent.parent;}if(adjacent_only&&has_definite_elements(possible_siblings)){break;}}}return result;}function get_possible_last_child(block,adjacent_only){const result=new Map();if(block.type==='EachBlock'){const each_result=loop_child(block.children,adjacent_only);const else_result=block.else?loop_child(block.else.children,adjacent_only):new Map();const not_exhaustive=!has_definite_elements(else_result);if(not_exhaustive){mark_as_probably(each_result);mark_as_probably(else_result);}add_to_map(each_result,result);add_to_map(else_result,result);}else if(block.type==='IfBlock'){const if_result=loop_child(block.children,adjacent_only);const else_result=block.else?loop_child(block.else.children,adjacent_only):new Map();const not_exhaustive=!has_definite_elements(if_result)||!has_definite_elements(else_result);if(not_exhaustive){mark_as_probably(if_result);mark_as_probably(else_result);}add_to_map(if_result,result);add_to_map(else_result,result);}else if(block.type==='AwaitBlock'){const pending_result=block.pending?loop_child(block.pending.children,adjacent_only):new Map();const then_result=block.then?loop_child(block.then.children,adjacent_only):new Map();const catch_result=block.catch?loop_child(block.catch.children,adjacent_only):new Map();const not_exhaustive=!has_definite_elements(pending_result)||!has_definite_elements(then_result)||!has_definite_elements(catch_result);if(not_exhaustive){mark_as_probably(pending_result);mark_as_probably(then_result);mark_as_probably(catch_result);}add_to_map(pending_result,result);add_to_map(then_result,result);add_to_map(catch_result,result);}return result;}function has_definite_elements(result){if(result.size===0)return false;for(const exist of result.values()){if(exist===NodeExist.Definitely){return true;}}return false;}function add_to_map(from,to){from.forEach((exist,element)=>{to.set(element,higher_existence(exist,to.get(element)));});}function higher_existence(exist1,exist2){if(exist1===undefined||exist2===undefined)return exist1||exist2;return exist1>exist2?exist1:exist2;}function mark_as_probably(result){for(const key of result.keys()){result.set(key,NodeExist.Probably);}}function loop_child(children,adjacent_only){const result=new Map();for(let i=children.length-1;i>=0;i--){const child=children[i];if(child.type==='Element'){result.set(child,NodeExist.Definitely);if(adjacent_only){break;}}else if(child.type==='EachBlock'||child.type==='IfBlock'||child.type==='AwaitBlock'){const child_result=get_possible_last_child(child,adjacent_only);add_to_map(child_result,result);if(adjacent_only&&has_definite_elements(child_result)){break;}}}return result;}class Block$2{constructor(combinator){this.combinator=combinator;this.host=false;this.root=false;this.selectors=[];this.start=null;this.end=null;this.should_encapsulate=false;}add(selector){if(this.selectors.length===0){this.start=selector.start;this.host=selector.type==='PseudoClassSelector'&&selector.name==='host';}this.root=this.root||selector.type==='PseudoClassSelector'&&selector.name==='root';this.selectors.push(selector);this.end=selector.end;}get global(){return this.selectors.length>=1&&this.selectors[0].type==='PseudoClassSelector'&&this.selectors[0].name==='global'&&this.selectors.every(selector=>selector.type==='PseudoClassSelector'||selector.type==='PseudoElementSelector');}}function group_selectors(selector){let block=new Block$2(null);const blocks=[block];selector.children.forEach(child=>{if(child.type==='WhiteSpace'||child.type==='Combinator'){block=new Block$2(child);blocks.push(block);}else{block.add(child);}});return blocks;}const regex_css_browser_prefix=/^-((webkit)|(moz)|(o)|(ms))-/;function remove_css_prefix(name){return name.replace(regex_css_browser_prefix,'');}const is_keyframes_node=node=>remove_css_prefix(node.name)==='keyframes';const at_rule_has_declaration=_ref50=>{let{block}=_ref50;return block&&block.children&&block.children.find(node=>node.type==='Declaration');};function minify_declarations(code,start,declarations){let c=start;declarations.forEach((declaration,i)=>{const separator=i>0?';':'';if(declaration.node.start-c>separator.length){code.overwrite(c,declaration.node.start,separator);}declaration.minify(code);c=declaration.node.end;});return c;}class Rule$1{constructor(node,stylesheet,parent){this.node=node;this.parent=parent;this.selectors=node.prelude.children.map(node=>new Selector$1(node,stylesheet));this.declarations=node.block.children.map(node=>new Declaration$1(node));}apply(node){this.selectors.forEach(selector=>selector.apply(node));// TODO move the logic in here?\n}is_used(dev){if(this.parent&&this.parent.node.type==='Atrule'&&is_keyframes_node(this.parent.node))return true;if(this.declarations.length===0)return dev;return this.selectors.some(s=>s.used);}minify(code,_dev){let c=this.node.start;let started=false;this.selectors.forEach(selector=>{if(selector.used){const separator=started?',':'';if(selector.node.start-c>separator.length){code.overwrite(c,selector.node.start,separator);}selector.minify(code);c=selector.node.end;started=true;}});code.remove(c,this.node.block.start);c=this.node.block.start+1;c=minify_declarations(code,c,this.declarations);code.remove(c,this.node.block.end-1);}transform(code,id,keyframes,max_amount_class_specificity_increased){if(this.parent&&this.parent.node.type==='Atrule'&&is_keyframes_node(this.parent.node))return true;const attr=`.${id}`;this.selectors.forEach(selector=>selector.transform(code,attr,max_amount_class_specificity_increased));this.declarations.forEach(declaration=>declaration.transform(code,keyframes));}validate(component){this.selectors.forEach(selector=>{selector.validate(component);});}warn_on_unused_selector(handler){this.selectors.forEach(selector=>{if(!selector.used)handler(selector);});}get_max_amount_class_specificity_increased(){return Math.max(...this.selectors.map(selector=>selector.get_amount_class_specificity_increased()));}}class Declaration$1{constructor(node){this.node=node;}transform(code,keyframes){const property=this.node.property&&remove_css_prefix(this.node.property.toLowerCase());if(property==='animation'||property==='animation-name'){this.node.value.children.forEach(block=>{if(block.type==='Identifier'){const name=block.name;if(keyframes.has(name)){code.overwrite(block.start,block.end,keyframes.get(name));}}});}}minify(code){if(!this.node.property)return;// @apply, and possibly other weird cases?\nconst c=this.node.start+this.node.property.length;const first=this.node.value.children?this.node.value.children[0]:this.node.value;// Don't minify whitespace in custom properties, since some browsers (Chromium < 99)\n// treat --foo: ; and --foo:; differently\nif(first.type==='Raw'&&regex_only_whitespaces.test(first.value))return;let start=first.start;while(regex_whitespace.test(code.original[start]))start+=1;if(start-c>1){code.overwrite(c,start,':');}}}class Atrule$1{constructor(node){this.node=node;this.children=[];this.declarations=[];}apply(node){if(this.node.name==='media'||this.node.name==='supports'||this.node.name==='layer'){this.children.forEach(child=>{child.apply(node);});}else if(is_keyframes_node(this.node)){this.children.forEach(rule=>{rule.selectors.forEach(selector=>{selector.used=true;});});}}is_used(_dev){return true;// TODO\n}minify(code,dev){if(this.node.name==='media'){const expression_char=code.original[this.node.prelude.start];let c=this.node.start+(expression_char==='('?6:7);if(this.node.prelude.start>c)code.remove(c,this.node.prelude.start);this.node.prelude.children.forEach(query=>{// TODO minify queries\nc=query.end;});code.remove(c,this.node.block.start);}else if(this.node.name==='supports'){let c=this.node.start+9;if(this.node.prelude.start-c>1)code.overwrite(c,this.node.prelude.start,' ');this.node.prelude.children.forEach(query=>{// TODO minify queries\nc=query.end;});code.remove(c,this.node.block.start);}else{let c=this.node.start+this.node.name.length+1;if(this.node.prelude){if(this.node.prelude.start-c>1)code.overwrite(c,this.node.prelude.start,' ');c=this.node.prelude.end;}if(this.node.block&&this.node.block.start-c>0){code.remove(c,this.node.block.start);}}// TODO other atrules\nif(this.node.block){let c=this.node.block.start+1;if(this.declarations.length){c=minify_declarations(code,c,this.declarations);// if the atrule has children, leave the last declaration semicolon alone\nif(this.children.length)c++;}this.children.forEach(child=>{if(child.is_used(dev)){code.remove(c,child.node.start);child.minify(code,dev);c=child.node.end;}});code.remove(c,this.node.block.end-1);}}transform(code,id,keyframes,max_amount_class_specificity_increased){if(is_keyframes_node(this.node)){this.node.prelude.children.forEach(_ref51=>{let{type,name,start,end}=_ref51;if(type==='Identifier'){if(name.startsWith('-global-')){code.remove(start,start+8);this.children.forEach(rule=>{rule.selectors.forEach(selector=>{selector.used=true;});});}else{code.overwrite(start,end,keyframes.get(name));}}});}this.children.forEach(child=>{child.transform(code,id,keyframes,max_amount_class_specificity_increased);});}validate(component){this.children.forEach(child=>{child.validate(component);});}warn_on_unused_selector(handler){if(this.node.name!=='media')return;this.children.forEach(child=>{child.warn_on_unused_selector(handler);});}get_max_amount_class_specificity_increased(){return Math.max(...this.children.map(rule=>rule.get_max_amount_class_specificity_increased()));}}const get_default_css_hash=_ref52=>{let{css,hash}=_ref52;return`svelte-${hash(css)}`;};class Stylesheet{constructor(_ref53){let{source,ast,component_name,filename,dev,get_css_hash=get_default_css_hash}=_ref53;this.children=[];this.keyframes=new Map();this.nodes_with_css_class=new Set();this.source=source;this.ast=ast;this.filename=filename;this.dev=dev;if(ast.css&&ast.css.children.length){this.id=get_css_hash({filename,name:component_name,css:ast.css.content.styles,hash});this.has_styles=true;const stack=[];let depth=0;let current_atrule=null;walk(ast.css,{enter:node=>{if(node.type==='Atrule'){const atrule=new Atrule$1(node);stack.push(atrule);if(current_atrule){current_atrule.children.push(atrule);}else if(depth<=1){this.children.push(atrule);}if(is_keyframes_node(node)){node.prelude.children.forEach(expression=>{if(expression.type==='Identifier'&&!expression.name.startsWith('-global-')){this.keyframes.set(expression.name,`${this.id}-${expression.name}`);}});}else if(at_rule_has_declaration(node)){const at_rule_declarations=node.block.children.filter(node=>node.type==='Declaration').map(node=>new Declaration$1(node));push_array$1(atrule.declarations,at_rule_declarations);}current_atrule=atrule;}if(node.type==='Rule'){const rule=new Rule$1(node,this,current_atrule);if(current_atrule){current_atrule.children.push(rule);}else if(depth<=1){this.children.push(rule);}}depth+=1;},leave:node=>{if(node.type==='Atrule'){stack.pop();current_atrule=stack[stack.length-1];}depth-=1;}});}else{this.has_styles=false;}}apply(node){if(!this.has_styles)return;for(let i=0;i<this.children.length;i+=1){const child=this.children[i];child.apply(node);}}reify(){this.nodes_with_css_class.forEach(node=>{node.add_css_class();});}render(file,should_transform_selectors){if(!this.has_styles){return{code:null,map:null};}const code=new MagicString(this.source);walk(this.ast.css,{enter:node=>{code.addSourcemapLocation(node.start);code.addSourcemapLocation(node.end);}});if(should_transform_selectors){const max=Math.max(...this.children.map(rule=>rule.get_max_amount_class_specificity_increased()));this.children.forEach(child=>{child.transform(code,this.id,this.keyframes,max);});}let c=0;this.children.forEach(child=>{if(child.is_used(this.dev)){code.remove(c,child.node.start);child.minify(code,this.dev);c=child.node.end;}});code.remove(c,this.source.length);return{code:code.toString(),map:code.generateMap({includeContent:true,source:this.filename,file})};}validate(component){this.children.forEach(child=>{child.validate(component);});}warn_on_unused_selectors(component){const ignores=!this.ast.css?[]:extract_ignores_above_position(this.ast.css.start,this.ast.html.children);component.push_ignores(ignores);this.children.forEach(child=>{child.warn_on_unused_selector(selector=>{component.warn(selector.node,compiler_warnings.css_unused_selector(this.source.slice(selector.node.start,selector.node.end)));});});component.pop_ignores();}}const test=typeof process!=='undefined'&&process.env.TEST;class TemplateScope{constructor(parent){this.owners=new Map();this.parent=parent;this.names=new Set(parent?parent.names:[]);this.dependencies_for_name=new Map(parent?parent.dependencies_for_name:[]);}add(name,dependencies,owner){this.names.add(name);this.dependencies_for_name.set(name,dependencies);this.owners.set(name,owner);return this;}child(){const child=new TemplateScope(this);return child;}is_top_level(name){return!this.parent||!this.names.has(name)&&this.parent.is_top_level(name);}get_owner(name){return this.owners.get(name)||this.parent&&this.parent.get_owner(name);}is_let(name){const owner=this.get_owner(name);return owner&&(owner.type==='Element'||owner.type==='InlineComponent'||owner.type==='SlotTemplate');}is_await(name){const owner=this.get_owner(name);return owner&&(owner.type==='ThenBlock'||owner.type==='CatchBlock');}is_const(name){const owner=this.get_owner(name);return owner&&owner.type==='ConstTag';}}class Fragment extends Node$1{constructor(component,info){const scope=new TemplateScope();super(component,null,scope,info);this.scope=scope;this.children=map_children(component,this,scope,info.children);}}// This file is automatically generated\nvar internal_exports=new Set([\"HtmlTag\",\"HtmlTagHydration\",\"SvelteComponent\",\"SvelteComponentDev\",\"SvelteComponentTyped\",\"SvelteElement\",\"action_destroyer\",\"add_attribute\",\"add_classes\",\"add_flush_callback\",\"add_location\",\"add_render_callback\",\"add_resize_listener\",\"add_styles\",\"add_transform\",\"afterUpdate\",\"append\",\"append_dev\",\"append_empty_stylesheet\",\"append_hydration\",\"append_hydration_dev\",\"append_styles\",\"assign\",\"attr\",\"attr_dev\",\"attribute_to_object\",\"beforeUpdate\",\"bind\",\"binding_callbacks\",\"blank_object\",\"bubble\",\"check_outros\",\"children\",\"claim_component\",\"claim_element\",\"claim_html_tag\",\"claim_space\",\"claim_svg_element\",\"claim_text\",\"clear_loops\",\"component_subscribe\",\"compute_rest_props\",\"compute_slots\",\"construct_svelte_component\",\"construct_svelte_component_dev\",\"createEventDispatcher\",\"create_animation\",\"create_bidirectional_transition\",\"create_component\",\"create_in_transition\",\"create_out_transition\",\"create_slot\",\"create_ssr_component\",\"current_component\",\"custom_event\",\"dataset_dev\",\"debug\",\"destroy_block\",\"destroy_component\",\"destroy_each\",\"detach\",\"detach_after_dev\",\"detach_before_dev\",\"detach_between_dev\",\"detach_dev\",\"dirty_components\",\"dispatch_dev\",\"each\",\"element\",\"element_is\",\"empty\",\"end_hydrating\",\"escape\",\"escape_attribute_value\",\"escape_object\",\"exclude_internal_props\",\"fix_and_destroy_block\",\"fix_and_outro_and_destroy_block\",\"fix_position\",\"flush\",\"getAllContexts\",\"getContext\",\"get_all_dirty_from_scope\",\"get_binding_group_value\",\"get_current_component\",\"get_custom_elements_slots\",\"get_root_for_style\",\"get_slot_changes\",\"get_spread_object\",\"get_spread_update\",\"get_store_value\",\"globals\",\"group_outros\",\"handle_promise\",\"hasContext\",\"has_prop\",\"head_selector\",\"identity\",\"init\",\"insert\",\"insert_dev\",\"insert_hydration\",\"insert_hydration_dev\",\"intros\",\"invalid_attribute_name_character\",\"is_client\",\"is_crossorigin\",\"is_empty\",\"is_function\",\"is_promise\",\"is_void\",\"listen\",\"listen_dev\",\"loop\",\"loop_guard\",\"merge_ssr_styles\",\"missing_component\",\"mount_component\",\"noop\",\"not_equal\",\"now\",\"null_to_empty\",\"object_without_properties\",\"onDestroy\",\"onMount\",\"once\",\"outro_and_destroy_block\",\"prevent_default\",\"prop_dev\",\"query_selector_all\",\"raf\",\"run\",\"run_all\",\"safe_not_equal\",\"schedule_update\",\"select_multiple_value\",\"select_option\",\"select_options\",\"select_value\",\"self\",\"setContext\",\"set_attributes\",\"set_current_component\",\"set_custom_element_data\",\"set_custom_element_data_map\",\"set_data\",\"set_data_dev\",\"set_input_type\",\"set_input_value\",\"set_now\",\"set_raf\",\"set_store_value\",\"set_style\",\"set_svg_attributes\",\"space\",\"spread\",\"src_url_equal\",\"start_hydrating\",\"stop_propagation\",\"subscribe\",\"svg_element\",\"text\",\"tick\",\"time_ranges_to_array\",\"to_number\",\"toggle_class\",\"transition_in\",\"transition_out\",\"trusted\",\"update_await_block_branch\",\"update_keyed_each\",\"update_slot\",\"update_slot_base\",\"validate_component\",\"validate_dynamic_element\",\"validate_each_argument\",\"validate_each_keys\",\"validate_slots\",\"validate_store\",\"validate_void_dynamic_element\",\"xlink_attr\"]);function is_used_as_reference(node,parent){if(!is_reference(node,parent)){return false;}if(!parent){return true;}/* eslint-disable no-fallthrough */switch(parent.type){// disregard the `foo` in `const foo = bar`\ncase'VariableDeclarator':return node!==parent.id;// disregard the `foo`, `bar` in `function foo(bar){}`\ncase'FunctionDeclaration':// disregard the `foo` in `import { foo } from 'foo'`\ncase'ImportSpecifier':// disregard the `foo` in `import foo from 'foo'`\ncase'ImportDefaultSpecifier':// disregard the `foo` in `import * as foo from 'foo'`\ncase'ImportNamespaceSpecifier':// disregard the `foo` in `export { foo }`\ncase'ExportSpecifier':return false;default:return true;}}const regex_leading_directory_separator=/^[/\\\\]/;const regex_starts_with_term_export=/^Export/;const regex_contains_term_function=/Function/;class Component{constructor(ast,source,name,compile_options,stats,warnings){this.ignore_stack=[];this.vars=[];this.var_lookup=new Map();this.imports=[];this.exports_from=[];this.instance_exports_from=[];this.hoistable_nodes=new Set();this.node_for_declaration=new Map();this.partly_hoisted=[];this.fully_hoisted=[];this.reactive_declarations=[];this.reactive_declaration_nodes=new Set();this.has_reactive_assignments=false;this.injected_reactive_declaration_vars=new Set();this.helpers=new Map();this.globals=new Map();this.indirect_dependencies=new Map();this.elements=[];this.aliases=new Map();this.used_names=new Set();this.globally_used_names=new Set();this.slots=new Map();this.slot_outlets=new Set();this.name={type:'Identifier',name};this.stats=stats;this.warnings=warnings;this.ast=ast;this.source=source;this.compile_options=compile_options;// the instance JS gets mutated, so we park\n// a copy here for later. TODO this feels gross\nthis.original_ast=clone({html:ast.html,css:ast.css,instance:ast.instance,module:ast.module});this.file=compile_options.filename&&(typeof process!=='undefined'?compile_options.filename.replace(process.cwd(),'').replace(regex_leading_directory_separator,''):compile_options.filename);this.locate=getLocator(this.source,{offsetLine:1});// styles\nthis.stylesheet=new Stylesheet({source,ast,filename:compile_options.filename,component_name:name,dev:compile_options.dev,get_css_hash:compile_options.cssHash});this.stylesheet.validate(this);this.component_options=process_component_options(this,this.ast.html.children);this.namespace=namespaces[this.component_options.namespace]||this.component_options.namespace;if(compile_options.customElement){if(this.component_options.tag===undefined&&compile_options.tag===undefined){const svelteOptions=ast.html.children.find(child=>child.name==='svelte:options')||{start:0,end:0};this.warn(svelteOptions,compiler_warnings.custom_element_no_tag);}this.tag=this.component_options.tag||compile_options.tag;}else{this.tag=this.name.name;}this.walk_module_js();this.push_ignores(this.ast.instance?extract_ignores_above_position(this.ast.instance.start,this.ast.html.children):[]);this.walk_instance_js_pre_template();this.pop_ignores();this.fragment=new Fragment(this,ast.html);this.name=this.get_unique_name(name);this.push_ignores(this.ast.instance?extract_ignores_above_position(this.ast.instance.start,this.ast.html.children):[]);this.walk_instance_js_post_template();this.pop_ignores();this.elements.forEach(element=>this.stylesheet.apply(element));if(!compile_options.customElement)this.stylesheet.reify();this.stylesheet.warn_on_unused_selectors(this);}add_var(node,variable){let add_to_lookup=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;this.vars.push(variable);if(add_to_lookup){if(this.var_lookup.has(variable.name)){const exists_var=this.var_lookup.get(variable.name);if(exists_var.module&&exists_var.imported){this.error(node,compiler_errors.illegal_variable_declaration);}}this.var_lookup.set(variable.name,variable);}}add_reference(node,name){const variable=this.var_lookup.get(name);if(variable){variable.referenced=true;}else if(is_reserved_keyword(name)){this.add_var(node,{name,injected:true,referenced:true});}else if(name[0]==='$'){this.add_var(node,{name,injected:true,referenced:true,mutated:true,writable:true});const subscribable_name=name.slice(1);const variable=this.var_lookup.get(subscribable_name);if(variable){variable.referenced=true;variable.subscribable=true;}}else{if(this.compile_options.varsReport==='full'){this.add_var(node,{name,referenced:true},false);}this.used_names.add(name);}}alias(name){if(!this.aliases.has(name)){this.aliases.set(name,this.get_unique_name(name));}return this.aliases.get(name);}apply_stylesheet(element){this.elements.push(element);}global(name){const alias=this.alias(name);this.globals.set(name,alias);return alias;}generate(result){let js=null;let css=null;if(result){const{compile_options,name}=this;const{format='esm'}=compile_options;const banner=`${this.file?`${this.file} `:''}generated by Svelte v${'3.52.0'}`;const program={type:'Program',body:result.js};walk(program,{enter:(node,parent,key)=>{if(node.type==='Identifier'){if(node.name[0]==='@'){if(node.name[1]==='_'){const alias=this.global(node.name.slice(2));node.name=alias.name;}else{let name=node.name.slice(1);if(compile_options.hydratable){if(internal_exports.has(`${name}_hydration`)){name+='_hydration';}else if(internal_exports.has(`${name}Hydration`)){name+='Hydration';}}if(compile_options.dev){if(internal_exports.has(`${name}_dev`)){name+='_dev';}else if(internal_exports.has(`${name}Dev`)){name+='Dev';}}const alias=this.alias(name);this.helpers.set(name,alias);node.name=alias.name;}}else if(node.name[0]!=='#'&&!is_valid(node.name)){// this hack allows x`foo.${bar}` where bar could be invalid\nconst literal={type:'Literal',value:node.name};if(parent.type==='Property'&&key==='key'){parent.key=literal;}else if(parent.type==='MemberExpression'&&key==='property'){parent.property=literal;parent.computed=true;}}}}});const referenced_globals=Array.from(this.globals,_ref54=>{let[name,alias]=_ref54;return name!==alias.name&&{name,alias};}).filter(Boolean);if(referenced_globals.length){this.helpers.set('globals',this.alias('globals'));}const imported_helpers=Array.from(this.helpers,_ref55=>{let[name,alias]=_ref55;return{name,alias};});create_module(program,format,name,banner,compile_options.sveltePath,imported_helpers,referenced_globals,this.imports,this.vars.filter(variable=>variable.module&&variable.export_name).map(variable=>({name:variable.name,as:variable.export_name})),this.exports_from);css=compile_options.customElement?{code:null,map:null}:result.css;const js_sourcemap_enabled=check_enable_sourcemap(compile_options.enableSourcemap,'js');if(!js_sourcemap_enabled){js=print(program);js.map=null;}else{const sourcemap_source_filename=get_sourcemap_source_filename(compile_options);js=print(program,{sourceMapSource:sourcemap_source_filename});js.map.sources=[sourcemap_source_filename];js.map.sourcesContent=[this.source];js.map=apply_preprocessor_sourcemap(sourcemap_source_filename,js.map,compile_options.sourcemap);}}return{js,css,ast:this.original_ast,warnings:this.warnings,vars:this.get_vars_report(),stats:this.stats.render()};}get_unique_name(name,scope){if(test)name=`${name}$`;let alias=name;for(let i=1;reserved.has(alias)||this.var_lookup.has(alias)||this.used_names.has(alias)||this.globally_used_names.has(alias)||scope&&scope.has(alias);alias=`${name}_${i++}`);this.used_names.add(alias);return{type:'Identifier',name:alias};}get_unique_name_maker(){const local_used_names=new Set();function add(name){local_used_names.add(name);}reserved.forEach(add);internal_exports.forEach(add);this.var_lookup.forEach((_value,key)=>add(key));return name=>{if(test)name=`${name}$`;let alias=name;for(let i=1;this.used_names.has(alias)||local_used_names.has(alias);alias=`${name}_${i++}`);local_used_names.add(alias);this.globally_used_names.add(alias);return{type:'Identifier',name:alias};};}get_vars_report(){const{compile_options,vars}=this;const vars_report=compile_options.varsReport===false?[]:compile_options.varsReport==='full'?vars:vars.filter(v=>!v.global&&!v.internal);return vars_report.map(v=>({name:v.name,export_name:v.export_name||null,injected:v.injected||false,module:v.module||false,mutated:v.mutated||false,reassigned:v.reassigned||false,referenced:v.referenced||false,writable:v.writable||false,referenced_from_script:v.referenced_from_script||false}));}error(pos,e){if(this.compile_options.errorMode==='warn'){this.warn(pos,e);}else{error(e.message,{name:'ValidationError',code:e.code,source:this.source,start:pos.start,end:pos.end,filename:this.compile_options.filename});}}warn(pos,warning){if(this.ignores&&this.ignores.has(warning.code)){return;}const start=this.locate(pos.start);const end=this.locate(pos.end);const frame=get_code_frame(this.source,start.line-1,start.column);this.warnings.push({code:warning.code,message:warning.message,frame,start,end,pos:pos.start,filename:this.compile_options.filename,toString:()=>`${warning.message} (${start.line}:${start.column})\\n${frame}`});}extract_imports(node){this.imports.push(node);}extract_exports(node){let module_script=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;const ignores=extract_svelte_ignore_from_comments(node);if(ignores.length)this.push_ignores(ignores);const result=this._extract_exports(node,module_script);if(ignores.length)this.pop_ignores();return result;}_extract_exports(node,module_script){if(node.type==='ExportDefaultDeclaration'){return this.error(node,compiler_errors.default_export);}if(node.type==='ExportNamedDeclaration'){if(node.source){if(module_script){this.exports_from.push(node);}else{this.instance_exports_from.push(node);}return null;}if(node.declaration){if(node.declaration.type==='VariableDeclaration'){node.declaration.declarations.forEach(declarator=>{extract_names(declarator.id).forEach(name=>{const variable=this.var_lookup.get(name);variable.export_name=name;if(!module_script&&variable.writable&&!(variable.referenced||variable.referenced_from_script||variable.subscribable)){this.warn(declarator,compiler_warnings.unused_export_let(this.name.name,name));}});});}else{const{name}=node.declaration.id;const variable=this.var_lookup.get(name);variable.export_name=name;}return node.declaration;}else{node.specifiers.forEach(specifier=>{const variable=this.var_lookup.get(specifier.local.name);if(variable){variable.export_name=specifier.exported.name;if(!module_script&&variable.writable&&!(variable.referenced||variable.referenced_from_script||variable.subscribable)){this.warn(specifier,compiler_warnings.unused_export_let(this.name.name,specifier.exported.name));}}});return null;}}}extract_javascript(script){if(!script)return null;return script.content.body.filter(node=>{if(!node)return false;if(this.hoistable_nodes.has(node))return false;if(this.reactive_declaration_nodes.has(node))return false;if(node.type==='ImportDeclaration')return false;if(node.type==='ExportDeclaration'&&node.specifiers.length>0)return false;return true;});}walk_module_js(){const component=this;const script=this.ast.module;if(!script)return;walk(script.content,{enter(node){if(node.type==='LabeledStatement'&&node.label.name==='$'){component.warn(node,compiler_warnings.module_script_reactive_declaration);}}});const{scope,globals}=create_scopes(script.content);this.module_scope=scope;scope.declarations.forEach((node,name)=>{if(name[0]==='$'){return this.error(node,compiler_errors.illegal_declaration);}const writable=node.type==='VariableDeclaration'&&(node.kind==='var'||node.kind==='let');const imported=node.type.startsWith('Import');this.add_var(node,{name,module:true,hoistable:true,writable,imported});});globals.forEach((node,name)=>{if(name[0]==='$'){return this.error(node,compiler_errors.illegal_subscription);}else{this.add_var(node,{name,global:true,hoistable:true});}});const{body}=script.content;let i=body.length;while(--i>=0){const node=body[i];if(node.type==='ImportDeclaration'){this.extract_imports(node);body.splice(i,1);}if(regex_starts_with_term_export.test(node.type)){const replacement=this.extract_exports(node,true);if(replacement){body[i]=replacement;}else{body.splice(i,1);}}}}walk_instance_js_pre_template(){const script=this.ast.instance;if(!script)return;// inject vars for reactive declarations\nscript.content.body.forEach(node=>{if(node.type!=='LabeledStatement')return;if(node.body.type!=='ExpressionStatement')return;const{expression}=node.body;if(expression.type!=='AssignmentExpression')return;if(expression.left.type==='MemberExpression')return;extract_names(expression.left).forEach(name=>{if(!this.var_lookup.has(name)&&name[0]!=='$'){this.injected_reactive_declaration_vars.add(name);}});});const{scope:instance_scope,map,globals}=create_scopes(script.content);this.instance_scope=instance_scope;this.instance_scope_map=map;instance_scope.declarations.forEach((node,name)=>{if(name[0]==='$'){return this.error(node,compiler_errors.illegal_declaration);}const writable=node.type==='VariableDeclaration'&&(node.kind==='var'||node.kind==='let');const imported=node.type.startsWith('Import');this.add_var(node,{name,initialised:instance_scope.initialised_declarations.has(name),writable,imported});this.node_for_declaration.set(name,node);});// NOTE: add store variable first, then only $store value\n// as `$store` will mark `store` variable as referenced and subscribable\nconst global_keys=Array.from(globals.keys());const sorted_globals=[...global_keys.filter(key=>key[0]!=='$'),...global_keys.filter(key=>key[0]==='$')];sorted_globals.forEach(name=>{if(this.var_lookup.has(name))return;const node=globals.get(name);if(this.injected_reactive_declaration_vars.has(name)){this.add_var(node,{name,injected:true,writable:true,reassigned:true,initialised:true});}else if(is_reserved_keyword(name)){this.add_var(node,{name,injected:true});}else if(name[0]==='$'){if(name==='$'||name[1]==='$'){return this.error(node,compiler_errors.illegal_global(name));}this.add_var(node,{name,injected:true,mutated:true,writable:true});this.add_reference(node,name.slice(1));const variable=this.var_lookup.get(name.slice(1));if(variable){variable.subscribable=true;variable.referenced_from_script=true;}}else{this.add_var(node,{name,global:true,hoistable:true});}});this.track_references_and_mutations();}walk_instance_js_post_template(){const script=this.ast.instance;if(!script)return;this.post_template_walk();this.hoist_instance_declarations();this.extract_reactive_declarations();}post_template_walk(){const script=this.ast.instance;if(!script)return;const component=this;const{content}=script;const{instance_scope,instance_scope_map:map}=this;let scope=instance_scope;const to_remove=[];const remove=(parent,prop,index)=>{to_remove.unshift([parent,prop,index]);};let scope_updated=false;const current_function_stack=[];let current_function=null;walk(content,{enter(node,parent,prop,index){if(node.type==='FunctionDeclaration'||node.type==='FunctionExpression'){current_function_stack.push(current_function=node);}if(map.has(node)){scope=map.get(node);}let deep=false;let names;if(node.type==='AssignmentExpression'){deep=node.left.type==='MemberExpression';names=deep?[get_object(node.left).name]:extract_names(node.left);}else if(node.type==='UpdateExpression'){deep=node.argument.type==='MemberExpression';const{name}=get_object(node.argument);names=[name];}if(names){names.forEach(name=>{let current_scope=scope;let declaration;while(current_scope){if(current_scope.declarations.has(name)){declaration=current_scope.declarations.get(name);break;}current_scope=current_scope.parent;}if(declaration&&declaration.kind==='const'&&!deep){component.error(node,{code:'assignment-to-const',message:'You are assigning to a const'});}});}if(node.type==='ImportDeclaration'){component.extract_imports(node);// TODO: to use actual remove\nremove(parent,prop,index);return this.skip();}if(regex_starts_with_term_export.test(node.type)){const replacement=component.extract_exports(node);if(replacement){this.replace(replacement);}else{// TODO: to use actual remove\nremove(parent,prop,index);}return this.skip();}component.warn_on_undefined_store_value_references(node,parent,prop,scope);},leave(node){if(node.type==='FunctionDeclaration'||node.type==='FunctionExpression'){current_function_stack.pop();current_function=current_function_stack[current_function_stack.length-1];}// do it on leave, to prevent infinite loop\nif(component.compile_options.dev&&component.compile_options.loopGuardTimeout>0&&(!current_function||!current_function.generator&&!current_function.async)){const to_replace_for_loop_protect=component.loop_protect(node,scope,component.compile_options.loopGuardTimeout);if(to_replace_for_loop_protect){this.replace(to_replace_for_loop_protect);scope_updated=true;}}if(map.has(node)){scope=scope.parent;}}});for(const[parent,prop,index]of to_remove){if(parent){if(index!==null){parent[prop].splice(index,1);}else{delete parent[prop];}}}if(scope_updated){const{scope,map}=create_scopes(script.content);this.instance_scope=scope;this.instance_scope_map=map;}}track_references_and_mutations(){const script=this.ast.instance;if(!script)return;const component=this;const{content}=script;const{instance_scope,module_scope,instance_scope_map:map}=this;let scope=instance_scope;walk(content,{enter(node,parent){if(map.has(node)){scope=map.get(node);}if(node.type==='AssignmentExpression'||node.type==='UpdateExpression'){const assignee=node.type==='AssignmentExpression'?node.left:node.argument;const names=extract_names(assignee);const deep=assignee.type==='MemberExpression';names.forEach(name=>{const scope_owner=scope.find_owner(name);if(scope_owner!==null?scope_owner===instance_scope:module_scope&&module_scope.has(name)){const variable=component.var_lookup.get(name);variable[deep?'mutated':'reassigned']=true;}});}if(is_used_as_reference(node,parent)){const object=get_object(node);if(scope.find_owner(object.name)===instance_scope){const variable=component.var_lookup.get(object.name);variable.referenced_from_script=true;}}},leave(node){if(map.has(node)){scope=scope.parent;}}});}warn_on_undefined_store_value_references(node,parent,prop,scope){if(node.type==='LabeledStatement'&&node.label.name==='$'&&parent.type!=='Program'){this.warn(node,compiler_warnings.non_top_level_reactive_declaration);}if(is_reference(node,parent)){const object=get_object(node);const{name}=object;if(name[0]==='$'){if(!scope.has(name)){this.warn_if_undefined(name,object,null);}if(name[1]!=='$'&&scope.has(name.slice(1))&&scope.find_owner(name.slice(1))!==this.instance_scope){if(!(regex_contains_term_function.test(parent.type)&&prop==='params'||parent.type==='VariableDeclarator'&&prop==='id')){return this.error(node,compiler_errors.contextual_store);}}}}}loop_protect(node,scope,timeout){if(node.type==='WhileStatement'||node.type==='ForStatement'||node.type==='DoWhileStatement'){const guard=this.get_unique_name('guard',scope);this.used_names.add(guard.name);const before=b`const ${guard} = @loop_guard(${timeout})`;const inside=b`${guard}();`;// wrap expression statement with BlockStatement\nif(node.body.type!=='BlockStatement'){node.body={type:'BlockStatement',body:[node.body]};}node.body.body.push(inside[0]);return{type:'BlockStatement',body:[before[0],node]};}return null;}rewrite_props(get_insert){if(!this.ast.instance)return;const component=this;const{instance_scope,instance_scope_map:map}=this;let scope=instance_scope;walk(this.ast.instance.content,{enter(node){if(regex_contains_term_function.test(node.type)){return this.skip();}if(map.has(node)){scope=map.get(node);}if(node.type==='ExportNamedDeclaration'&&node.declaration){return this.replace(node.declaration);}if(node.type==='VariableDeclaration'){// NOTE: `var` does not follow block scoping\nif(node.kind==='var'||scope===instance_scope){const inserts=[];const props=[];function add_new_props(exported,local,default_value){props.push({type:'Property',method:false,shorthand:false,computed:false,kind:'init',key:exported,value:default_value?{type:'AssignmentPattern',left:local,right:default_value}:local});}// transform\n// ```\n// export let { x, y = 123 } = OBJ, z = 456\n// ```\n// into\n// ```\n// let { x: x$, y: y$ = 123 } = OBJ;\n// let { x = x$, y = y$, z = 456 } = $$props;\n// ```\nfor(let index=0;index<node.declarations.length;index++){const declarator=node.declarations[index];if(declarator.id.type!=='Identifier'){function get_new_name(local){const variable=component.var_lookup.get(local.name);if(variable.subscribable){inserts.push(get_insert(variable));}if(variable.export_name&&variable.writable){const alias_name=component.get_unique_name(local.name);add_new_props({type:'Identifier',name:variable.export_name},local,alias_name);return alias_name;}return local;}function rename_identifiers(param){switch(param.type){case'ObjectPattern':{const handle_prop=prop=>{if(prop.type==='RestElement'){rename_identifiers(prop);}else if(prop.value.type==='Identifier'){prop.value=get_new_name(prop.value);}else{rename_identifiers(prop.value);}};param.properties.forEach(handle_prop);break;}case'ArrayPattern':{const handle_element=(element,index,array)=>{if(element){if(element.type==='Identifier'){array[index]=get_new_name(element);}else{rename_identifiers(element);}}};param.elements.forEach(handle_element);break;}case'RestElement':param.argument=get_new_name(param.argument);break;case'AssignmentPattern':if(param.left.type==='Identifier'){param.left=get_new_name(param.left);}else{rename_identifiers(param.left);}break;}}rename_identifiers(declarator.id);}else{const{name}=declarator.id;const variable=component.var_lookup.get(name);const is_props=variable.export_name&&variable.writable;if(is_props){add_new_props({type:'Identifier',name:variable.export_name},declarator.id,declarator.init);node.declarations.splice(index--,1);}if(variable.subscribable&&(is_props||declarator.init)){inserts.push(get_insert(variable));}}}this.replace(b`\n\t\t\t\t\t\t\t${node.declarations.length?node:null}\n\t\t\t\t\t\t\t${props.length>0&&b`let { ${props} } = $$props;`}\n\t\t\t\t\t\t\t${inserts}\n\t\t\t\t\t\t`);return this.skip();}}},leave(node){if(map.has(node)){scope=scope.parent;}}});}hoist_instance_declarations(){// we can safely hoist variable declarations that are\n// initialised to literals, and functions that don't\n// reference instance variables other than other\n// hoistable functions. TODO others?\nconst{hoistable_nodes,var_lookup,injected_reactive_declaration_vars,imports}=this;const top_level_function_declarations=new Map();const{body}=this.ast.instance.content;for(let i=0;i<body.length;i+=1){const node=body[i];if(node.type==='VariableDeclaration'){const all_hoistable=node.declarations.every(d=>{if(!d.init)return false;if(d.init.type!=='Literal')return false;// everything except const values can be changed by e.g. svelte devtools\n// which means we can't hoist it\nif(node.kind!=='const'&&this.compile_options.dev)return false;const{name}=d.id;const v=this.var_lookup.get(name);if(v.reassigned)return false;if(v.export_name)return false;if(this.var_lookup.get(name).reassigned)return false;if(this.vars.find(variable=>variable.name===name&&variable.module)){return false;}return true;});if(all_hoistable){node.declarations.forEach(d=>{const variable=this.var_lookup.get(d.id.name);variable.hoistable=true;});hoistable_nodes.add(node);body.splice(i--,1);this.fully_hoisted.push(node);}}if(node.type==='ExportNamedDeclaration'&&node.declaration&&node.declaration.type==='FunctionDeclaration'){top_level_function_declarations.set(node.declaration.id.name,node);}if(node.type==='FunctionDeclaration'){top_level_function_declarations.set(node.id.name,node);}}const checked=new Set();const walking=new Set();const is_hoistable=fn_declaration=>{if(fn_declaration.type==='ExportNamedDeclaration'){fn_declaration=fn_declaration.declaration;}const instance_scope=this.instance_scope;let scope=this.instance_scope;const map=this.instance_scope_map;let hoistable=true;// handle cycles\nwalking.add(fn_declaration);walk(fn_declaration,{enter(node,parent){if(!hoistable)return this.skip();if(map.has(node)){scope=map.get(node);}if(is_reference(node,parent)){const{name}=flatten_reference(node);const owner=scope.find_owner(name);if(injected_reactive_declaration_vars.has(name)){hoistable=false;}else if(name[0]==='$'&&!owner){hoistable=false;}else if(owner===instance_scope){const variable=var_lookup.get(name);if(variable.reassigned||variable.mutated)hoistable=false;if(name===fn_declaration.id.name)return;if(variable.hoistable)return;if(top_level_function_declarations.has(name)){const other_declaration=top_level_function_declarations.get(name);if(walking.has(other_declaration)){hoistable=false;}else if(other_declaration.type==='ExportNamedDeclaration'&&walking.has(other_declaration.declaration)){hoistable=false;}else if(!is_hoistable(other_declaration)){hoistable=false;}}else{hoistable=false;}}this.skip();}},leave(node){if(map.has(node)){scope=scope.parent;}}});checked.add(fn_declaration);walking.delete(fn_declaration);return hoistable;};for(const[name,node]of top_level_function_declarations){if(is_hoistable(node)){const variable=this.var_lookup.get(name);variable.hoistable=true;hoistable_nodes.add(node);const i=body.indexOf(node);body.splice(i,1);this.fully_hoisted.push(node);}}for(const{specifiers}of imports){for(const specifier of specifiers){const variable=var_lookup.get(specifier.local.name);if(!variable.mutated||variable.subscribable){variable.hoistable=true;}}}}extract_reactive_declarations(){const component=this;const unsorted_reactive_declarations=[];this.ast.instance.content.body.forEach(node=>{const ignores=extract_svelte_ignore_from_comments(node);if(ignores.length)this.push_ignores(ignores);if(node.type==='LabeledStatement'&&node.label.name==='$'){this.reactive_declaration_nodes.add(node);const assignees=new Set();const assignee_nodes=new Set();const dependencies=new Set();const module_dependencies=new Set();let scope=this.instance_scope;const map=this.instance_scope_map;walk(node.body,{enter(node,parent){if(map.has(node)){scope=map.get(node);}if(node.type==='AssignmentExpression'){const left=get_object(node.left);extract_identifiers(left).forEach(node=>{assignee_nodes.add(node);assignees.add(node.name);});if(node.operator!=='='){dependencies.add(left.name);}}else if(node.type==='UpdateExpression'){const identifier=get_object(node.argument);assignees.add(identifier.name);}else if(is_reference(node,parent)){const identifier=get_object(node);if(!assignee_nodes.has(identifier)){const{name}=identifier;const owner=scope.find_owner(name);const variable=component.var_lookup.get(name);let should_add_as_dependency=true;if(variable){variable.is_reactive_dependency=true;if(variable.module&&variable.writable){should_add_as_dependency=false;module_dependencies.add(name);}}const is_writable_or_mutated=variable&&(variable.writable||variable.mutated);if(should_add_as_dependency&&(!owner||owner===component.instance_scope)&&(name[0]==='$'||is_writable_or_mutated)){dependencies.add(name);}}this.skip();}},leave(node){if(map.has(node)){scope=scope.parent;}}});if(module_dependencies.size>0&&dependencies.size===0){component.warn(node.body,compiler_warnings.module_script_variable_reactive_declaration(Array.from(module_dependencies)));}const{expression}=node.body;const declaration=expression&&expression.left;unsorted_reactive_declarations.push({assignees,dependencies,node,declaration});}if(ignores.length)this.pop_ignores();});const lookup=new Map();unsorted_reactive_declarations.forEach(declaration=>{declaration.assignees.forEach(name=>{if(!lookup.has(name)){lookup.set(name,[]);}// TODO warn or error if a name is assigned to in\n// multiple reactive declarations?\nlookup.get(name).push(declaration);});});const cycle=check_graph_for_cycles(unsorted_reactive_declarations.reduce((acc,declaration)=>{declaration.assignees.forEach(v=>{declaration.dependencies.forEach(w=>{if(!declaration.assignees.has(w)){acc.push([v,w]);}});});return acc;},[]));if(cycle&&cycle.length){const declarationList=lookup.get(cycle[0]);const declaration=declarationList[0];return this.error(declaration.node,compiler_errors.cyclical_reactive_declaration(cycle));}const add_declaration=declaration=>{if(this.reactive_declarations.includes(declaration))return;declaration.dependencies.forEach(name=>{if(declaration.assignees.has(name))return;const earlier_declarations=lookup.get(name);if(earlier_declarations){earlier_declarations.forEach(add_declaration);}});this.reactive_declarations.push(declaration);};unsorted_reactive_declarations.forEach(add_declaration);}warn_if_undefined(name,node,template_scope){if(name[0]==='$'){if(name==='$'||name[1]==='$'&&!is_reserved_keyword(name)){return this.error(node,compiler_errors.illegal_global(name));}this.has_reactive_assignments=true;// TODO does this belong here?\nif(is_reserved_keyword(name))return;name=name.slice(1);}if(this.var_lookup.has(name)&&!this.var_lookup.get(name).global)return;if(template_scope&&template_scope.names.has(name))return;if(globals.has(name)&&node.type!=='InlineComponent')return;this.warn(node,compiler_warnings.missing_declaration(name,!!this.ast.instance));}push_ignores(ignores){this.ignores=new Set(this.ignores||[]);add_to_set(this.ignores,ignores);this.ignore_stack.push(this.ignores);}pop_ignores(){this.ignore_stack.pop();this.ignores=this.ignore_stack[this.ignore_stack.length-1];}}const regex_valid_tag_name=/^[a-zA-Z][a-zA-Z0-9]*-[a-zA-Z0-9-]+$/;function process_component_options(component,nodes){const component_options={immutable:component.compile_options.immutable||false,accessors:'accessors'in component.compile_options?component.compile_options.accessors:!!component.compile_options.customElement,preserveWhitespace:!!component.compile_options.preserveWhitespace,namespace:component.compile_options.namespace};const node=nodes.find(node=>node.name==='svelte:options');function get_value(attribute,_ref56){let{code,message}=_ref56;const{value}=attribute;const chunk=value[0];if(!chunk)return true;if(value.length>1){return component.error(attribute,{code,message});}if(chunk.type==='Text')return chunk.data;if(chunk.expression.type!=='Literal'){return component.error(attribute,{code,message});}return chunk.expression.value;}if(node){node.attributes.forEach(attribute=>{if(attribute.type==='Attribute'){const{name}=attribute;switch(name){case'tag':{const tag=get_value(attribute,compiler_errors.invalid_tag_attribute);if(typeof tag!=='string'&&tag!==null){return component.error(attribute,compiler_errors.invalid_tag_attribute);}if(tag&&!regex_valid_tag_name.test(tag)){return component.error(attribute,compiler_errors.invalid_tag_property);}if(tag&&!component.compile_options.customElement){component.warn(attribute,compiler_warnings.missing_custom_element_compile_options);}component_options.tag=tag;break;}case'namespace':{const ns=get_value(attribute,compiler_errors.invalid_namespace_attribute);if(typeof ns!=='string'){return component.error(attribute,compiler_errors.invalid_namespace_attribute);}if(valid_namespaces.indexOf(ns)===-1){const match=fuzzymatch(ns,valid_namespaces);return component.error(attribute,compiler_errors.invalid_namespace_property(ns,match));}component_options.namespace=ns;break;}case'accessors':case'immutable':case'preserveWhitespace':{const value=get_value(attribute,compiler_errors.invalid_attribute_value(name));if(typeof value!=='boolean'){return component.error(attribute,compiler_errors.invalid_attribute_value(name));}component_options[name]=value;break;}default:return component.error(attribute,compiler_errors.invalid_options_attribute_unknown);}}else{return component.error(attribute,compiler_errors.invalid_options_attribute);}});}return component_options;}function get_relative_path(from,to){const from_parts=from.split(/[/\\\\]/);const to_parts=to.split(/[/\\\\]/);from_parts.pop();// get dirname\nwhile(from_parts[0]===to_parts[0]){from_parts.shift();to_parts.shift();}if(from_parts.length){let i=from_parts.length;while(i--)from_parts[i]='..';}return from_parts.concat(to_parts).join('/');}function get_basename(filename){return filename.split(/[/\\\\]/).pop();}function get_sourcemap_source_filename(compile_options){if(!compile_options.filename)return null;return compile_options.outputFilename?get_relative_path(compile_options.outputFilename,compile_options.filename):get_basename(compile_options.filename);}const regex_percentage_characters=/%/g;const regex_file_ending=/\\.[^.]+$/;const regex_repeated_invalid_variable_identifier_characters=/[^a-zA-Z_$0-9]+/g;const regex_starts_with_digit=/^(\\d)/;function get_name_from_filename(filename){if(!filename)return null;const parts=filename.split(/[/\\\\]/).map(encodeURI);if(parts.length>1){const index_match=parts[parts.length-1].match(/^index(\\.\\w+)/);if(index_match){parts.pop();parts[parts.length-1]+=index_match[1];}}const base=parts.pop().replace(regex_percentage_characters,'u').replace(regex_file_ending,'').replace(regex_repeated_invalid_variable_identifier_characters,'_').replace(regex_starts_with_underscore,'').replace(regex_ends_with_underscore,'').replace(regex_starts_with_digit,'_$1');if(!base){throw new Error(`Could not derive component name from file ${filename}`);}return base[0].toUpperCase()+base.slice(1);}const valid_options=['format','name','filename','sourcemap','enableSourcemap','generate','errorMode','varsReport','outputFilename','cssOutputFilename','sveltePath','dev','accessors','immutable','hydratable','legacy','customElement','namespace','tag','css','loopGuardTimeout','preserveComments','preserveWhitespace','cssHash'];const regex_valid_identifier=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;const regex_starts_with_lowercase_character=/^[a-z]/;function validate_options(options,warnings){const{name,filename,loopGuardTimeout,dev,namespace}=options;Object.keys(options).forEach(key=>{if(!valid_options.includes(key)){const match=fuzzymatch(key,valid_options);let message=`Unrecognized option '${key}'`;if(match)message+=` (did you mean '${match}'?)`;throw new Error(message);}});if(name&&!regex_valid_identifier.test(name)){throw new Error(`options.name must be a valid identifier (got '${name}')`);}if(name&&regex_starts_with_lowercase_character.test(name)){const message='options.name should be capitalised';warnings.push({code:'options-lowercase-name',message,filename,toString:()=>message});}if(loopGuardTimeout&&!dev){const message='options.loopGuardTimeout is for options.dev = true only';warnings.push({code:'options-loop-guard-timeout',message,filename,toString:()=>message});}if(namespace&&valid_namespaces.indexOf(namespace)===-1){const match=fuzzymatch(namespace,valid_namespaces);if(match){throw new Error(`Invalid namespace '${namespace}' (did you mean '${match}'?)`);}else{throw new Error(`Invalid namespace '${namespace}'`);}}}function compile(source){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};options=Object.assign({generate:'dom',dev:false,enableSourcemap:true},options);const stats=new Stats();const warnings=[];validate_options(options,warnings);stats.start('parse');const ast=parse$3(source,options);stats.stop('parse');stats.start('create component');const component=new Component(ast,source,options.name||get_name_from_filename(options.filename)||'Component',options,stats,warnings);stats.stop('create component');const result=options.generate===false?null:options.generate==='ssr'?ssr(component,options):dom(component,options);return component.generate(result);}/**\n * Import decoded sourcemap from mozilla/source-map/SourceMapGenerator\n * Forked from source-map/lib/source-map-generator.js\n * from methods _serializeMappings and toJSON.\n * We cannot use source-map.d.ts types, because we access hidden properties.\n */function decoded_sourcemap_from_generator(generator){let previous_generated_line=1;const converted_mappings=[[]];let result_line;let result_segment;let mapping;const source_idx=generator._sources.toArray().reduce((acc,val,idx)=>(acc[val]=idx,acc),{});const name_idx=generator._names.toArray().reduce((acc,val,idx)=>(acc[val]=idx,acc),{});const mappings=generator._mappings.toArray();result_line=converted_mappings[0];for(let i=0,len=mappings.length;i<len;i++){mapping=mappings[i];if(mapping.generatedLine>previous_generated_line){while(mapping.generatedLine>previous_generated_line){converted_mappings.push([]);previous_generated_line++;}result_line=converted_mappings[mapping.generatedLine-1];// line is one-based\n}else if(i>0){const previous_mapping=mappings[i-1];if(// sorted by selectivity\nmapping.generatedColumn===previous_mapping.generatedColumn&&mapping.originalColumn===previous_mapping.originalColumn&&mapping.name===previous_mapping.name&&mapping.generatedLine===previous_mapping.generatedLine&&mapping.originalLine===previous_mapping.originalLine&&mapping.source===previous_mapping.source){continue;}}result_line.push([mapping.generatedColumn]);result_segment=result_line[result_line.length-1];if(mapping.source!=null){result_segment.push(...[source_idx[mapping.source],mapping.originalLine-1,mapping.originalColumn]);if(mapping.name!=null){result_segment.push(name_idx[mapping.name]);}}}const map={version:generator._version,sources:generator._sources.toArray(),names:generator._names.toArray(),mappings:converted_mappings};if(generator._file!=null){map.file=generator._file;}// not needed: map.sourcesContent and map.sourceRoot\nreturn map;}function decode_map(processed){let decoded_map=typeof processed.map==='string'?JSON.parse(processed.map):processed.map;if(typeof decoded_map.mappings==='string'){decoded_map.mappings=decode(decoded_map.mappings);}if(decoded_map._mappings&&decoded_map.constructor.name==='SourceMapGenerator'){// import decoded sourcemap from mozilla/source-map/SourceMapGenerator\ndecoded_map=decoded_sourcemap_from_generator(decoded_map);}return decoded_map;}function slice_source(code_slice,offset,_ref57){let{file_basename,filename,get_location}=_ref57;return{source:code_slice,get_location:index=>get_location(index+offset),file_basename,filename};}function calculate_replacements(re,get_replacement,source){const replacements=[];source.replace(re,function(){for(var _len4=arguments.length,match=new Array(_len4),_key5=0;_key5<_len4;_key5++){match[_key5]=arguments[_key5];}replacements.push(get_replacement(...match).then(replacement=>{const matched_string=match[0];const offset=match[match.length-2];return{offset,length:matched_string.length,replacement};}));return'';});return Promise.all(replacements);}function perform_replacements(replacements,source){const out=new MappedCode();let last_end=0;for(const{offset,length,replacement}of replacements){const unchanged_prefix=MappedCode.from_source(slice_source(source.source.slice(last_end,offset),last_end,source));out.concat(unchanged_prefix).concat(replacement);last_end=offset+length;}const unchanged_suffix=MappedCode.from_source(slice_source(source.source.slice(last_end),last_end,source));return out.concat(unchanged_suffix);}async function replace_in_code(regex,get_replacement,location){const replacements=await calculate_replacements(regex,get_replacement,location.source);return perform_replacements(replacements,location);}const regex_filepath_separator=/[/\\\\]/;function get_file_basename(filename){return filename.split(regex_filepath_separator).pop();}/**\n * Represents intermediate states of the preprocessing.\n */class PreprocessResult{constructor(source,filename){this.source=source;this.filename=filename;// sourcemap_list is sorted in reverse order from last map (index 0) to first map (index -1)\n// so we use sourcemap_list.unshift() to add new maps\n// https://github.com/ampproject/remapping#multiple-transformations-of-a-file\nthis.sourcemap_list=[];this.dependencies=[];this.update_source({string:source});// preprocess source must be relative to itself or equal null\nthis.file_basename=filename==null?null:get_file_basename(filename);}update_source(_ref58){let{string:source,map,dependencies}=_ref58;if(source!=null){this.source=source;this.get_location=getLocator(source);}if(map){this.sourcemap_list.unshift(map);}if(dependencies){this.dependencies.push(...dependencies);}}to_processed(){// Combine all the source maps for each preprocessor function into one\nconst map=combine_sourcemaps(this.file_basename,this.sourcemap_list);return{// TODO return separated output, in future version where svelte.compile supports it:\n// style: { code: styleCode, map: styleMap },\n// script { code: scriptCode, map: scriptMap },\n// markup { code: markupCode, map: markupMap },\ncode:this.source,dependencies:[...new Set(this.dependencies)],map:map,toString:()=>this.source};}}/**\n * Convert preprocessor output for the tag content into MappedCode\n */function processed_content_to_code(processed,location,file_basename){// Convert the preprocessed code and its sourcemap to a MappedCode\nlet decoded_map;if(processed.map){decoded_map=decode_map(processed);// decoded map may not have sources for empty maps like `{ mappings: '' }`\nif(decoded_map.sources){// offset only segments pointing at original component source\nconst source_index=decoded_map.sources.indexOf(file_basename);if(source_index!==-1){sourcemap_add_offset(decoded_map,location,source_index);}}}return MappedCode.from_processed(processed.code,decoded_map);}/**\n * Given the whole tag including content, return a `MappedCode`\n * representing the tag content replaced with `processed`.\n */function processed_tag_to_code(processed,tag_name,attributes,source){const{file_basename,get_location}=source;const build_mapped_code=(code,offset)=>MappedCode.from_source(slice_source(code,offset,source));const tag_open=`<${tag_name}${attributes||''}>`;const tag_close=`</${tag_name}>`;const tag_open_code=build_mapped_code(tag_open,0);const tag_close_code=build_mapped_code(tag_close,tag_open.length+source.source.length);parse_attached_sourcemap(processed,tag_name);const content_code=processed_content_to_code(processed,get_location(tag_open.length),file_basename);return tag_open_code.concat(content_code).concat(tag_close_code);}const regex_quoted_value=/^['\"](.*)['\"]$/;function parse_tag_attributes(str){// note: won't work with attribute values containing spaces.\nreturn str.split(regex_whitespaces).filter(Boolean).reduce((attrs,attr)=>{var _a;const i=attr.indexOf('=');const[key,value]=i>0?[attr.slice(0,i),attr.slice(i+1)]:[attr];const[,unquoted]=value&&value.match(regex_quoted_value)||[];return Object.assign(Object.assign({},attrs),{[key]:(_a=unquoted!==null&&unquoted!==void 0?unquoted:value)!==null&&_a!==void 0?_a:true});},{});}const regex_style_tags=/<!--[^]*?-->|<style(\\s[^]*?)?(?:>([^]*?)<\\/style>|\\/>)/gi;const regex_script_tags=/<!--[^]*?-->|<script(\\s[^]*?)?(?:>([^]*?)<\\/script>|\\/>)/gi;/**\n * Calculate the updates required to process all instances of the specified tag.\n */async function process_tag(tag_name,preprocessor,source){const{filename,source:markup}=source;const tag_regex=tag_name==='style'?regex_style_tags:regex_script_tags;const dependencies=[];async function process_single_tag(tag_with_content){let attributes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';let content=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';let tag_offset=arguments.length>3?arguments[3]:undefined;const no_change=()=>MappedCode.from_source(slice_source(tag_with_content,tag_offset,source));if(!attributes&&!content)return no_change();const processed=await preprocessor({content:content||'',attributes:parse_tag_attributes(attributes||''),markup,filename});if(!processed)return no_change();if(processed.dependencies)dependencies.push(...processed.dependencies);if(!processed.map&&processed.code===content)return no_change();return processed_tag_to_code(processed,tag_name,attributes,slice_source(content,tag_offset,source));}const{string,map}=await replace_in_code(tag_regex,process_single_tag,source);return{string,map,dependencies};}async function process_markup(process,source){const processed=await process({content:source.source,filename:source.filename});if(processed){return{string:processed.code,map:processed.map?// TODO: can we use decode_sourcemap?\ntypeof processed.map==='string'?JSON.parse(processed.map):processed.map:undefined,dependencies:processed.dependencies};}else{return{};}}async function preprocess(source,preprocessor,options){const filename=options&&options.filename||preprocessor.filename;// legacy\nconst preprocessors=preprocessor?Array.isArray(preprocessor)?preprocessor:[preprocessor]:[];const markup=preprocessors.map(p=>p.markup).filter(Boolean);const script=preprocessors.map(p=>p.script).filter(Boolean);const style=preprocessors.map(p=>p.style).filter(Boolean);const result=new PreprocessResult(source,filename);// TODO keep track: what preprocessor generated what sourcemap?\n// to make debugging easier = detect low-resolution sourcemaps in fn combine_mappings\nfor(const process of markup){result.update_source(await process_markup(process,result));}for(const process of script){result.update_source(await process_tag('script',process,result));}for(const preprocess of style){result.update_source(await process_tag('style',preprocess,result));}return result.to_processed();}const VERSION='3.52.0';// additional exports added through generate-type-definitions.js\nexports.VERSION=VERSION;\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../process/browser.js */ \"./node_modules/process/browser.js\"), __webpack_require__(/*! ./../buffer/index.js */ \"./node_modules/buffer/index.js\").Buffer))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvc3ZlbHRlL2NvbXBpbGVyLm1qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9zdmVsdGUvY29tcGlsZXIubWpzP2FlMTgiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgbm93ID0gKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmhydGltZSlcbiAgICA/ICgpID0+IHtcbiAgICAgICAgY29uc3QgdCA9IHByb2Nlc3MuaHJ0aW1lKCk7XG4gICAgICAgIHJldHVybiB0WzBdICogMWUzICsgdFsxXSAvIDFlNjtcbiAgICB9XG4gICAgOiAoKSA9PiBzZWxmLnBlcmZvcm1hbmNlLm5vdygpO1xuZnVuY3Rpb24gY29sbGFwc2VfdGltaW5ncyh0aW1pbmdzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgdGltaW5ncy5mb3JFYWNoKHRpbWluZyA9PiB7XG4gICAgICAgIHJlc3VsdFt0aW1pbmcubGFiZWxdID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICB0b3RhbDogdGltaW5nLmVuZCAtIHRpbWluZy5zdGFydFxuICAgICAgICB9LCB0aW1pbmcuY2hpbGRyZW4gJiYgY29sbGFwc2VfdGltaW5ncyh0aW1pbmcuY2hpbGRyZW4pKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuY2xhc3MgU3RhdHMge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnN0YXJ0X3RpbWUgPSBub3coKTtcbiAgICAgICAgdGhpcy5zdGFjayA9IFtdO1xuICAgICAgICB0aGlzLmN1cnJlbnRfY2hpbGRyZW4gPSB0aGlzLnRpbWluZ3MgPSBbXTtcbiAgICB9XG4gICAgc3RhcnQobGFiZWwpIHtcbiAgICAgICAgY29uc3QgdGltaW5nID0ge1xuICAgICAgICAgICAgbGFiZWwsXG4gICAgICAgICAgICBzdGFydDogbm93KCksXG4gICAgICAgICAgICBlbmQ6IG51bGwsXG4gICAgICAgICAgICBjaGlsZHJlbjogW11cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5jdXJyZW50X2NoaWxkcmVuLnB1c2godGltaW5nKTtcbiAgICAgICAgdGhpcy5zdGFjay5wdXNoKHRpbWluZyk7XG4gICAgICAgIHRoaXMuY3VycmVudF90aW1pbmcgPSB0aW1pbmc7XG4gICAgICAgIHRoaXMuY3VycmVudF9jaGlsZHJlbiA9IHRpbWluZy5jaGlsZHJlbjtcbiAgICB9XG4gICAgc3RvcChsYWJlbCkge1xuICAgICAgICBpZiAobGFiZWwgIT09IHRoaXMuY3VycmVudF90aW1pbmcubGFiZWwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzbWF0Y2hlZCB0aW1pbmcgbGFiZWxzIChleHBlY3RlZCAke3RoaXMuY3VycmVudF90aW1pbmcubGFiZWx9LCBnb3QgJHtsYWJlbH0pYCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jdXJyZW50X3RpbWluZy5lbmQgPSBub3coKTtcbiAgICAgICAgdGhpcy5zdGFjay5wb3AoKTtcbiAgICAgICAgdGhpcy5jdXJyZW50X3RpbWluZyA9IHRoaXMuc3RhY2tbdGhpcy5zdGFjay5sZW5ndGggLSAxXTtcbiAgICAgICAgdGhpcy5jdXJyZW50X2NoaWxkcmVuID0gdGhpcy5jdXJyZW50X3RpbWluZyA/IHRoaXMuY3VycmVudF90aW1pbmcuY2hpbGRyZW4gOiB0aGlzLnRpbWluZ3M7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgdGltaW5ncyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgdG90YWw6IG5vdygpIC0gdGhpcy5zdGFydF90aW1lXG4gICAgICAgIH0sIGNvbGxhcHNlX3RpbWluZ3ModGhpcy50aW1pbmdzKSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0aW1pbmdzXG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vLyBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZC4gRG8gbm90IG1vZGlmeSBtYW51YWxseSFcbnZhciBhc3RyYWxJZGVudGlmaWVyQ29kZXMgPSBbNTA5LCAwLCAyMjcsIDAsIDE1MCwgNCwgMjk0LCA5LCAxMzY4LCAyLCAyLCAxLCA2LCAzLCA0MSwgMiwgNSwgMCwgMTY2LCAxLCA1NzQsIDMsIDksIDksIDM3MCwgMSwgMTU0LCAxMCwgNTAsIDMsIDEyMywgMiwgNTQsIDE0LCAzMiwgMTAsIDMsIDEsIDExLCAzLCA0NiwgMTAsIDgsIDAsIDQ2LCA5LCA3LCAyLCAzNywgMTMsIDIsIDksIDYsIDEsIDQ1LCAwLCAxMywgMiwgNDksIDEzLCA5LCAzLCAyLCAxMSwgODMsIDExLCA3LCAwLCAxNjEsIDExLCA2LCA5LCA3LCAzLCA1NiwgMSwgMiwgNiwgMywgMSwgMywgMiwgMTAsIDAsIDExLCAxLCAzLCA2LCA0LCA0LCAxOTMsIDE3LCAxMCwgOSwgNSwgMCwgODIsIDE5LCAxMywgOSwgMjE0LCA2LCAzLCA4LCAyOCwgMSwgODMsIDE2LCAxNiwgOSwgODIsIDEyLCA5LCA5LCA4NCwgMTQsIDUsIDksIDI0MywgMTQsIDE2NiwgOSwgNzEsIDUsIDIsIDEsIDMsIDMsIDIsIDAsIDIsIDEsIDEzLCA5LCAxMjAsIDYsIDMsIDYsIDQsIDAsIDI5LCA5LCA0MSwgNiwgMiwgMywgOSwgMCwgMTAsIDEwLCA0NywgMTUsIDQwNiwgNywgMiwgNywgMTcsIDksIDU3LCAyMSwgMiwgMTMsIDEyMywgNSwgNCwgMCwgMiwgMSwgMiwgNiwgMiwgMCwgOSwgOSwgNDksIDQsIDIsIDEsIDIsIDQsIDksIDksIDMzMCwgMywgMTkzMDYsIDksIDg3LCA5LCAzOSwgNCwgNjAsIDYsIDI2LCA5LCAxMDE0LCAwLCAyLCA1NCwgOCwgMywgODIsIDAsIDEyLCAxLCAxOTYyOCwgMSwgNDcwNiwgNDUsIDMsIDIyLCA1NDMsIDQsIDQsIDUsIDksIDcsIDMsIDYsIDMxLCAzLCAxNDksIDIsIDE0MTgsIDQ5LCA1MTMsIDU0LCA1LCA0OSwgOSwgMCwgMTUsIDAsIDIzLCA0LCAyLCAxNCwgMTM2MSwgNiwgMiwgMTYsIDMsIDYsIDIsIDEsIDIsIDQsIDI2MiwgNiwgMTAsIDksIDM1NywgMCwgNjIsIDEzLCAxNDk1LCA2LCAxMTAsIDYsIDYsIDksIDQ3NTksIDksIDc4NzcxOSwgMjM5XTtcblxuLy8gVGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQuIERvIG5vdCBtb2RpZnkgbWFudWFsbHkhXG52YXIgYXN0cmFsSWRlbnRpZmllclN0YXJ0Q29kZXMgPSBbMCwgMTEsIDIsIDI1LCAyLCAxOCwgMiwgMSwgMiwgMTQsIDMsIDEzLCAzNSwgMTIyLCA3MCwgNTIsIDI2OCwgMjgsIDQsIDQ4LCA0OCwgMzEsIDE0LCAyOSwgNiwgMzcsIDExLCAyOSwgMywgMzUsIDUsIDcsIDIsIDQsIDQzLCAxNTcsIDE5LCAzNSwgNSwgMzUsIDUsIDM5LCA5LCA1MSwgMTMsIDEwLCAyLCAxNCwgMiwgNiwgMiwgMSwgMiwgMTAsIDIsIDE0LCAyLCA2LCAyLCAxLCA2OCwgMzEwLCAxMCwgMjEsIDExLCA3LCAyNSwgNSwgMiwgNDEsIDIsIDgsIDcwLCA1LCAzLCAwLCAyLCA0MywgMiwgMSwgNCwgMCwgMywgMjIsIDExLCAyMiwgMTAsIDMwLCA2NiwgMTgsIDIsIDEsIDExLCAyMSwgMTEsIDI1LCA3MSwgNTUsIDcsIDEsIDY1LCAwLCAxNiwgMywgMiwgMiwgMiwgMjgsIDQzLCAyOCwgNCwgMjgsIDM2LCA3LCAyLCAyNywgMjgsIDUzLCAxMSwgMjEsIDExLCAxOCwgMTQsIDE3LCAxMTEsIDcyLCA1NiwgNTAsIDE0LCA1MCwgMTQsIDM1LCAzNDksIDQxLCA3LCAxLCA3OSwgMjgsIDExLCAwLCA5LCAyMSwgNDMsIDE3LCA0NywgMjAsIDI4LCAyMiwgMTMsIDUyLCA1OCwgMSwgMywgMCwgMTQsIDQ0LCAzMywgMjQsIDI3LCAzNSwgMzAsIDAsIDMsIDAsIDksIDM0LCA0LCAwLCAxMywgNDcsIDE1LCAzLCAyMiwgMCwgMiwgMCwgMzYsIDE3LCAyLCAyNCwgODUsIDYsIDIsIDAsIDIsIDMsIDIsIDE0LCAyLCA5LCA4LCA0NiwgMzksIDcsIDMsIDEsIDMsIDIxLCAyLCA2LCAyLCAxLCAyLCA0LCA0LCAwLCAxOSwgMCwgMTMsIDQsIDE1OSwgNTIsIDE5LCAzLCAyMSwgMiwgMzEsIDQ3LCAyMSwgMSwgMiwgMCwgMTg1LCA0NiwgNDIsIDMsIDM3LCA0NywgMjEsIDAsIDYwLCA0MiwgMTQsIDAsIDcyLCAyNiwgMzgsIDYsIDE4NiwgNDMsIDExNywgNjMsIDMyLCA3LCAzLCAwLCAzLCA3LCAyLCAxLCAyLCAyMywgMTYsIDAsIDIsIDAsIDk1LCA3LCAzLCAzOCwgMTcsIDAsIDIsIDAsIDI5LCAwLCAxMSwgMzksIDgsIDAsIDIyLCAwLCAxMiwgNDUsIDIwLCAwLCAxOSwgNzIsIDI2NCwgOCwgMiwgMzYsIDE4LCAwLCA1MCwgMjksIDExMywgNiwgMiwgMSwgMiwgMzcsIDIyLCAwLCAyNiwgNSwgMiwgMSwgMiwgMzEsIDE1LCAwLCAzMjgsIDE4LCAxOTAsIDAsIDgwLCA5MjEsIDEwMywgMTEwLCAxOCwgMTk1LCAyNjM3LCA5NiwgMTYsIDEwNzAsIDQwNTAsIDU4MiwgODYzNCwgNTY4LCA4LCAzMCwgMTgsIDc4LCAxOCwgMjksIDE5LCA0NywgMTcsIDMsIDMyLCAyMCwgNiwgMTgsIDY4OSwgNjMsIDEyOSwgNzQsIDYsIDAsIDY3LCAxMiwgNjUsIDEsIDIsIDAsIDI5LCA2MTM1LCA5LCAxMjM3LCA0MywgOCwgODkzNiwgMywgMiwgNiwgMiwgMSwgMiwgMjkwLCA0NiwgMiwgMTgsIDMsIDksIDM5NSwgMjMwOSwgMTA2LCA2LCAxMiwgNCwgOCwgOCwgOSwgNTk5MSwgODQsIDIsIDcwLCAyLCAxLCAzLCAwLCAzLCAxLCAzLCAzLCAyLCAxMSwgMiwgMCwgMiwgNiwgMiwgNjQsIDIsIDMsIDMsIDcsIDIsIDYsIDIsIDI3LCAyLCAzLCAyLCA0LCAyLCAwLCA0LCA2LCAyLCAzMzksIDMsIDI0LCAyLCAyNCwgMiwgMzAsIDIsIDI0LCAyLCAzMCwgMiwgMjQsIDIsIDMwLCAyLCAyNCwgMiwgMzAsIDIsIDI0LCAyLCA3LCAxODQ1LCAzMCwgNDgyLCA0NCwgMTEsIDYsIDE3LCAwLCAzMjIsIDI5LCAxOSwgNDMsIDEyNjksIDYsIDIsIDMsIDIsIDEsIDIsIDE0LCAyLCAxOTYsIDYwLCA2NywgOCwgMCwgMTIwNSwgMywgMiwgMjYsIDIsIDEsIDIsIDAsIDMsIDAsIDIsIDksIDIsIDMsIDIsIDAsIDIsIDAsIDcsIDAsIDUsIDAsIDIsIDAsIDIsIDAsIDIsIDIsIDIsIDEsIDIsIDAsIDMsIDAsIDIsIDAsIDIsIDAsIDIsIDAsIDIsIDAsIDIsIDEsIDIsIDAsIDMsIDMsIDIsIDYsIDIsIDMsIDIsIDMsIDIsIDAsIDIsIDksIDIsIDE2LCA2LCAyLCAyLCA0LCAyLCAxNiwgNDQyMSwgNDI3MTksIDMzLCA0MTUyLCA4LCAyMjEsIDMsIDU3NjEsIDE1LCA3NDcyLCAzMTA0LCA1NDEsIDE1MDcsIDQ5MzhdO1xuXG4vLyBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZC4gRG8gbm90IG1vZGlmeSBtYW51YWxseSFcbnZhciBub25BU0NJSWlkZW50aWZpZXJDaGFycyA9IFwiXFx1MjAwY1xcdTIwMGRcXHhiN1xcdTAzMDAtXFx1MDM2ZlxcdTAzODdcXHUwNDgzLVxcdTA0ODdcXHUwNTkxLVxcdTA1YmRcXHUwNWJmXFx1MDVjMVxcdTA1YzJcXHUwNWM0XFx1MDVjNVxcdTA1YzdcXHUwNjEwLVxcdTA2MWFcXHUwNjRiLVxcdTA2NjlcXHUwNjcwXFx1MDZkNi1cXHUwNmRjXFx1MDZkZi1cXHUwNmU0XFx1MDZlN1xcdTA2ZThcXHUwNmVhLVxcdTA2ZWRcXHUwNmYwLVxcdTA2ZjlcXHUwNzExXFx1MDczMC1cXHUwNzRhXFx1MDdhNi1cXHUwN2IwXFx1MDdjMC1cXHUwN2M5XFx1MDdlYi1cXHUwN2YzXFx1MDdmZFxcdTA4MTYtXFx1MDgxOVxcdTA4MWItXFx1MDgyM1xcdTA4MjUtXFx1MDgyN1xcdTA4MjktXFx1MDgyZFxcdTA4NTktXFx1MDg1YlxcdTA4OTgtXFx1MDg5ZlxcdTA4Y2EtXFx1MDhlMVxcdTA4ZTMtXFx1MDkwM1xcdTA5M2EtXFx1MDkzY1xcdTA5M2UtXFx1MDk0ZlxcdTA5NTEtXFx1MDk1N1xcdTA5NjJcXHUwOTYzXFx1MDk2Ni1cXHUwOTZmXFx1MDk4MS1cXHUwOTgzXFx1MDliY1xcdTA5YmUtXFx1MDljNFxcdTA5YzdcXHUwOWM4XFx1MDljYi1cXHUwOWNkXFx1MDlkN1xcdTA5ZTJcXHUwOWUzXFx1MDllNi1cXHUwOWVmXFx1MDlmZVxcdTBhMDEtXFx1MGEwM1xcdTBhM2NcXHUwYTNlLVxcdTBhNDJcXHUwYTQ3XFx1MGE0OFxcdTBhNGItXFx1MGE0ZFxcdTBhNTFcXHUwYTY2LVxcdTBhNzFcXHUwYTc1XFx1MGE4MS1cXHUwYTgzXFx1MGFiY1xcdTBhYmUtXFx1MGFjNVxcdTBhYzctXFx1MGFjOVxcdTBhY2ItXFx1MGFjZFxcdTBhZTJcXHUwYWUzXFx1MGFlNi1cXHUwYWVmXFx1MGFmYS1cXHUwYWZmXFx1MGIwMS1cXHUwYjAzXFx1MGIzY1xcdTBiM2UtXFx1MGI0NFxcdTBiNDdcXHUwYjQ4XFx1MGI0Yi1cXHUwYjRkXFx1MGI1NS1cXHUwYjU3XFx1MGI2MlxcdTBiNjNcXHUwYjY2LVxcdTBiNmZcXHUwYjgyXFx1MGJiZS1cXHUwYmMyXFx1MGJjNi1cXHUwYmM4XFx1MGJjYS1cXHUwYmNkXFx1MGJkN1xcdTBiZTYtXFx1MGJlZlxcdTBjMDAtXFx1MGMwNFxcdTBjM2NcXHUwYzNlLVxcdTBjNDRcXHUwYzQ2LVxcdTBjNDhcXHUwYzRhLVxcdTBjNGRcXHUwYzU1XFx1MGM1NlxcdTBjNjJcXHUwYzYzXFx1MGM2Ni1cXHUwYzZmXFx1MGM4MS1cXHUwYzgzXFx1MGNiY1xcdTBjYmUtXFx1MGNjNFxcdTBjYzYtXFx1MGNjOFxcdTBjY2EtXFx1MGNjZFxcdTBjZDVcXHUwY2Q2XFx1MGNlMlxcdTBjZTNcXHUwY2U2LVxcdTBjZWZcXHUwZDAwLVxcdTBkMDNcXHUwZDNiXFx1MGQzY1xcdTBkM2UtXFx1MGQ0NFxcdTBkNDYtXFx1MGQ0OFxcdTBkNGEtXFx1MGQ0ZFxcdTBkNTdcXHUwZDYyXFx1MGQ2M1xcdTBkNjYtXFx1MGQ2ZlxcdTBkODEtXFx1MGQ4M1xcdTBkY2FcXHUwZGNmLVxcdTBkZDRcXHUwZGQ2XFx1MGRkOC1cXHUwZGRmXFx1MGRlNi1cXHUwZGVmXFx1MGRmMlxcdTBkZjNcXHUwZTMxXFx1MGUzNC1cXHUwZTNhXFx1MGU0Ny1cXHUwZTRlXFx1MGU1MC1cXHUwZTU5XFx1MGViMVxcdTBlYjQtXFx1MGViY1xcdTBlYzgtXFx1MGVjZFxcdTBlZDAtXFx1MGVkOVxcdTBmMThcXHUwZjE5XFx1MGYyMC1cXHUwZjI5XFx1MGYzNVxcdTBmMzdcXHUwZjM5XFx1MGYzZVxcdTBmM2ZcXHUwZjcxLVxcdTBmODRcXHUwZjg2XFx1MGY4N1xcdTBmOGQtXFx1MGY5N1xcdTBmOTktXFx1MGZiY1xcdTBmYzZcXHUxMDJiLVxcdTEwM2VcXHUxMDQwLVxcdTEwNDlcXHUxMDU2LVxcdTEwNTlcXHUxMDVlLVxcdTEwNjBcXHUxMDYyLVxcdTEwNjRcXHUxMDY3LVxcdTEwNmRcXHUxMDcxLVxcdTEwNzRcXHUxMDgyLVxcdTEwOGRcXHUxMDhmLVxcdTEwOWRcXHUxMzVkLVxcdTEzNWZcXHUxMzY5LVxcdTEzNzFcXHUxNzEyLVxcdTE3MTVcXHUxNzMyLVxcdTE3MzRcXHUxNzUyXFx1MTc1M1xcdTE3NzJcXHUxNzczXFx1MTdiNC1cXHUxN2QzXFx1MTdkZFxcdTE3ZTAtXFx1MTdlOVxcdTE4MGItXFx1MTgwZFxcdTE4MGYtXFx1MTgxOVxcdTE4YTlcXHUxOTIwLVxcdTE5MmJcXHUxOTMwLVxcdTE5M2JcXHUxOTQ2LVxcdTE5NGZcXHUxOWQwLVxcdTE5ZGFcXHUxYTE3LVxcdTFhMWJcXHUxYTU1LVxcdTFhNWVcXHUxYTYwLVxcdTFhN2NcXHUxYTdmLVxcdTFhODlcXHUxYTkwLVxcdTFhOTlcXHUxYWIwLVxcdTFhYmRcXHUxYWJmLVxcdTFhY2VcXHUxYjAwLVxcdTFiMDRcXHUxYjM0LVxcdTFiNDRcXHUxYjUwLVxcdTFiNTlcXHUxYjZiLVxcdTFiNzNcXHUxYjgwLVxcdTFiODJcXHUxYmExLVxcdTFiYWRcXHUxYmIwLVxcdTFiYjlcXHUxYmU2LVxcdTFiZjNcXHUxYzI0LVxcdTFjMzdcXHUxYzQwLVxcdTFjNDlcXHUxYzUwLVxcdTFjNTlcXHUxY2QwLVxcdTFjZDJcXHUxY2Q0LVxcdTFjZThcXHUxY2VkXFx1MWNmNFxcdTFjZjctXFx1MWNmOVxcdTFkYzAtXFx1MWRmZlxcdTIwM2ZcXHUyMDQwXFx1MjA1NFxcdTIwZDAtXFx1MjBkY1xcdTIwZTFcXHUyMGU1LVxcdTIwZjBcXHUyY2VmLVxcdTJjZjFcXHUyZDdmXFx1MmRlMC1cXHUyZGZmXFx1MzAyYS1cXHUzMDJmXFx1MzA5OVxcdTMwOWFcXHVhNjIwLVxcdWE2MjlcXHVhNjZmXFx1YTY3NC1cXHVhNjdkXFx1YTY5ZVxcdWE2OWZcXHVhNmYwXFx1YTZmMVxcdWE4MDJcXHVhODA2XFx1YTgwYlxcdWE4MjMtXFx1YTgyN1xcdWE4MmNcXHVhODgwXFx1YTg4MVxcdWE4YjQtXFx1YThjNVxcdWE4ZDAtXFx1YThkOVxcdWE4ZTAtXFx1YThmMVxcdWE4ZmYtXFx1YTkwOVxcdWE5MjYtXFx1YTkyZFxcdWE5NDctXFx1YTk1M1xcdWE5ODAtXFx1YTk4M1xcdWE5YjMtXFx1YTljMFxcdWE5ZDAtXFx1YTlkOVxcdWE5ZTVcXHVhOWYwLVxcdWE5ZjlcXHVhYTI5LVxcdWFhMzZcXHVhYTQzXFx1YWE0Y1xcdWFhNGRcXHVhYTUwLVxcdWFhNTlcXHVhYTdiLVxcdWFhN2RcXHVhYWIwXFx1YWFiMi1cXHVhYWI0XFx1YWFiN1xcdWFhYjhcXHVhYWJlXFx1YWFiZlxcdWFhYzFcXHVhYWViLVxcdWFhZWZcXHVhYWY1XFx1YWFmNlxcdWFiZTMtXFx1YWJlYVxcdWFiZWNcXHVhYmVkXFx1YWJmMC1cXHVhYmY5XFx1ZmIxZVxcdWZlMDAtXFx1ZmUwZlxcdWZlMjAtXFx1ZmUyZlxcdWZlMzNcXHVmZTM0XFx1ZmU0ZC1cXHVmZTRmXFx1ZmYxMC1cXHVmZjE5XFx1ZmYzZlwiO1xuXG4vLyBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZC4gRG8gbm90IG1vZGlmeSBtYW51YWxseSFcbnZhciBub25BU0NJSWlkZW50aWZpZXJTdGFydENoYXJzID0gXCJcXHhhYVxceGI1XFx4YmFcXHhjMC1cXHhkNlxceGQ4LVxceGY2XFx4ZjgtXFx1MDJjMVxcdTAyYzYtXFx1MDJkMVxcdTAyZTAtXFx1MDJlNFxcdTAyZWNcXHUwMmVlXFx1MDM3MC1cXHUwMzc0XFx1MDM3NlxcdTAzNzdcXHUwMzdhLVxcdTAzN2RcXHUwMzdmXFx1MDM4NlxcdTAzODgtXFx1MDM4YVxcdTAzOGNcXHUwMzhlLVxcdTAzYTFcXHUwM2EzLVxcdTAzZjVcXHUwM2Y3LVxcdTA0ODFcXHUwNDhhLVxcdTA1MmZcXHUwNTMxLVxcdTA1NTZcXHUwNTU5XFx1MDU2MC1cXHUwNTg4XFx1MDVkMC1cXHUwNWVhXFx1MDVlZi1cXHUwNWYyXFx1MDYyMC1cXHUwNjRhXFx1MDY2ZVxcdTA2NmZcXHUwNjcxLVxcdTA2ZDNcXHUwNmQ1XFx1MDZlNVxcdTA2ZTZcXHUwNmVlXFx1MDZlZlxcdTA2ZmEtXFx1MDZmY1xcdTA2ZmZcXHUwNzEwXFx1MDcxMi1cXHUwNzJmXFx1MDc0ZC1cXHUwN2E1XFx1MDdiMVxcdTA3Y2EtXFx1MDdlYVxcdTA3ZjRcXHUwN2Y1XFx1MDdmYVxcdTA4MDAtXFx1MDgxNVxcdTA4MWFcXHUwODI0XFx1MDgyOFxcdTA4NDAtXFx1MDg1OFxcdTA4NjAtXFx1MDg2YVxcdTA4NzAtXFx1MDg4N1xcdTA4ODktXFx1MDg4ZVxcdTA4YTAtXFx1MDhjOVxcdTA5MDQtXFx1MDkzOVxcdTA5M2RcXHUwOTUwXFx1MDk1OC1cXHUwOTYxXFx1MDk3MS1cXHUwOTgwXFx1MDk4NS1cXHUwOThjXFx1MDk4ZlxcdTA5OTBcXHUwOTkzLVxcdTA5YThcXHUwOWFhLVxcdTA5YjBcXHUwOWIyXFx1MDliNi1cXHUwOWI5XFx1MDliZFxcdTA5Y2VcXHUwOWRjXFx1MDlkZFxcdTA5ZGYtXFx1MDllMVxcdTA5ZjBcXHUwOWYxXFx1MDlmY1xcdTBhMDUtXFx1MGEwYVxcdTBhMGZcXHUwYTEwXFx1MGExMy1cXHUwYTI4XFx1MGEyYS1cXHUwYTMwXFx1MGEzMlxcdTBhMzNcXHUwYTM1XFx1MGEzNlxcdTBhMzhcXHUwYTM5XFx1MGE1OS1cXHUwYTVjXFx1MGE1ZVxcdTBhNzItXFx1MGE3NFxcdTBhODUtXFx1MGE4ZFxcdTBhOGYtXFx1MGE5MVxcdTBhOTMtXFx1MGFhOFxcdTBhYWEtXFx1MGFiMFxcdTBhYjJcXHUwYWIzXFx1MGFiNS1cXHUwYWI5XFx1MGFiZFxcdTBhZDBcXHUwYWUwXFx1MGFlMVxcdTBhZjlcXHUwYjA1LVxcdTBiMGNcXHUwYjBmXFx1MGIxMFxcdTBiMTMtXFx1MGIyOFxcdTBiMmEtXFx1MGIzMFxcdTBiMzJcXHUwYjMzXFx1MGIzNS1cXHUwYjM5XFx1MGIzZFxcdTBiNWNcXHUwYjVkXFx1MGI1Zi1cXHUwYjYxXFx1MGI3MVxcdTBiODNcXHUwYjg1LVxcdTBiOGFcXHUwYjhlLVxcdTBiOTBcXHUwYjkyLVxcdTBiOTVcXHUwYjk5XFx1MGI5YVxcdTBiOWNcXHUwYjllXFx1MGI5ZlxcdTBiYTNcXHUwYmE0XFx1MGJhOC1cXHUwYmFhXFx1MGJhZS1cXHUwYmI5XFx1MGJkMFxcdTBjMDUtXFx1MGMwY1xcdTBjMGUtXFx1MGMxMFxcdTBjMTItXFx1MGMyOFxcdTBjMmEtXFx1MGMzOVxcdTBjM2RcXHUwYzU4LVxcdTBjNWFcXHUwYzVkXFx1MGM2MFxcdTBjNjFcXHUwYzgwXFx1MGM4NS1cXHUwYzhjXFx1MGM4ZS1cXHUwYzkwXFx1MGM5Mi1cXHUwY2E4XFx1MGNhYS1cXHUwY2IzXFx1MGNiNS1cXHUwY2I5XFx1MGNiZFxcdTBjZGRcXHUwY2RlXFx1MGNlMFxcdTBjZTFcXHUwY2YxXFx1MGNmMlxcdTBkMDQtXFx1MGQwY1xcdTBkMGUtXFx1MGQxMFxcdTBkMTItXFx1MGQzYVxcdTBkM2RcXHUwZDRlXFx1MGQ1NC1cXHUwZDU2XFx1MGQ1Zi1cXHUwZDYxXFx1MGQ3YS1cXHUwZDdmXFx1MGQ4NS1cXHUwZDk2XFx1MGQ5YS1cXHUwZGIxXFx1MGRiMy1cXHUwZGJiXFx1MGRiZFxcdTBkYzAtXFx1MGRjNlxcdTBlMDEtXFx1MGUzMFxcdTBlMzJcXHUwZTMzXFx1MGU0MC1cXHUwZTQ2XFx1MGU4MVxcdTBlODJcXHUwZTg0XFx1MGU4Ni1cXHUwZThhXFx1MGU4Yy1cXHUwZWEzXFx1MGVhNVxcdTBlYTctXFx1MGViMFxcdTBlYjJcXHUwZWIzXFx1MGViZFxcdTBlYzAtXFx1MGVjNFxcdTBlYzZcXHUwZWRjLVxcdTBlZGZcXHUwZjAwXFx1MGY0MC1cXHUwZjQ3XFx1MGY0OS1cXHUwZjZjXFx1MGY4OC1cXHUwZjhjXFx1MTAwMC1cXHUxMDJhXFx1MTAzZlxcdTEwNTAtXFx1MTA1NVxcdTEwNWEtXFx1MTA1ZFxcdTEwNjFcXHUxMDY1XFx1MTA2NlxcdTEwNmUtXFx1MTA3MFxcdTEwNzUtXFx1MTA4MVxcdTEwOGVcXHUxMGEwLVxcdTEwYzVcXHUxMGM3XFx1MTBjZFxcdTEwZDAtXFx1MTBmYVxcdTEwZmMtXFx1MTI0OFxcdTEyNGEtXFx1MTI0ZFxcdTEyNTAtXFx1MTI1NlxcdTEyNThcXHUxMjVhLVxcdTEyNWRcXHUxMjYwLVxcdTEyODhcXHUxMjhhLVxcdTEyOGRcXHUxMjkwLVxcdTEyYjBcXHUxMmIyLVxcdTEyYjVcXHUxMmI4LVxcdTEyYmVcXHUxMmMwXFx1MTJjMi1cXHUxMmM1XFx1MTJjOC1cXHUxMmQ2XFx1MTJkOC1cXHUxMzEwXFx1MTMxMi1cXHUxMzE1XFx1MTMxOC1cXHUxMzVhXFx1MTM4MC1cXHUxMzhmXFx1MTNhMC1cXHUxM2Y1XFx1MTNmOC1cXHUxM2ZkXFx1MTQwMS1cXHUxNjZjXFx1MTY2Zi1cXHUxNjdmXFx1MTY4MS1cXHUxNjlhXFx1MTZhMC1cXHUxNmVhXFx1MTZlZS1cXHUxNmY4XFx1MTcwMC1cXHUxNzExXFx1MTcxZi1cXHUxNzMxXFx1MTc0MC1cXHUxNzUxXFx1MTc2MC1cXHUxNzZjXFx1MTc2ZS1cXHUxNzcwXFx1MTc4MC1cXHUxN2IzXFx1MTdkN1xcdTE3ZGNcXHUxODIwLVxcdTE4NzhcXHUxODgwLVxcdTE4YThcXHUxOGFhXFx1MThiMC1cXHUxOGY1XFx1MTkwMC1cXHUxOTFlXFx1MTk1MC1cXHUxOTZkXFx1MTk3MC1cXHUxOTc0XFx1MTk4MC1cXHUxOWFiXFx1MTliMC1cXHUxOWM5XFx1MWEwMC1cXHUxYTE2XFx1MWEyMC1cXHUxYTU0XFx1MWFhN1xcdTFiMDUtXFx1MWIzM1xcdTFiNDUtXFx1MWI0Y1xcdTFiODMtXFx1MWJhMFxcdTFiYWVcXHUxYmFmXFx1MWJiYS1cXHUxYmU1XFx1MWMwMC1cXHUxYzIzXFx1MWM0ZC1cXHUxYzRmXFx1MWM1YS1cXHUxYzdkXFx1MWM4MC1cXHUxYzg4XFx1MWM5MC1cXHUxY2JhXFx1MWNiZC1cXHUxY2JmXFx1MWNlOS1cXHUxY2VjXFx1MWNlZS1cXHUxY2YzXFx1MWNmNVxcdTFjZjZcXHUxY2ZhXFx1MWQwMC1cXHUxZGJmXFx1MWUwMC1cXHUxZjE1XFx1MWYxOC1cXHUxZjFkXFx1MWYyMC1cXHUxZjQ1XFx1MWY0OC1cXHUxZjRkXFx1MWY1MC1cXHUxZjU3XFx1MWY1OVxcdTFmNWJcXHUxZjVkXFx1MWY1Zi1cXHUxZjdkXFx1MWY4MC1cXHUxZmI0XFx1MWZiNi1cXHUxZmJjXFx1MWZiZVxcdTFmYzItXFx1MWZjNFxcdTFmYzYtXFx1MWZjY1xcdTFmZDAtXFx1MWZkM1xcdTFmZDYtXFx1MWZkYlxcdTFmZTAtXFx1MWZlY1xcdTFmZjItXFx1MWZmNFxcdTFmZjYtXFx1MWZmY1xcdTIwNzFcXHUyMDdmXFx1MjA5MC1cXHUyMDljXFx1MjEwMlxcdTIxMDdcXHUyMTBhLVxcdTIxMTNcXHUyMTE1XFx1MjExOC1cXHUyMTFkXFx1MjEyNFxcdTIxMjZcXHUyMTI4XFx1MjEyYS1cXHUyMTM5XFx1MjEzYy1cXHUyMTNmXFx1MjE0NS1cXHUyMTQ5XFx1MjE0ZVxcdTIxNjAtXFx1MjE4OFxcdTJjMDAtXFx1MmNlNFxcdTJjZWItXFx1MmNlZVxcdTJjZjJcXHUyY2YzXFx1MmQwMC1cXHUyZDI1XFx1MmQyN1xcdTJkMmRcXHUyZDMwLVxcdTJkNjdcXHUyZDZmXFx1MmQ4MC1cXHUyZDk2XFx1MmRhMC1cXHUyZGE2XFx1MmRhOC1cXHUyZGFlXFx1MmRiMC1cXHUyZGI2XFx1MmRiOC1cXHUyZGJlXFx1MmRjMC1cXHUyZGM2XFx1MmRjOC1cXHUyZGNlXFx1MmRkMC1cXHUyZGQ2XFx1MmRkOC1cXHUyZGRlXFx1MzAwNS1cXHUzMDA3XFx1MzAyMS1cXHUzMDI5XFx1MzAzMS1cXHUzMDM1XFx1MzAzOC1cXHUzMDNjXFx1MzA0MS1cXHUzMDk2XFx1MzA5Yi1cXHUzMDlmXFx1MzBhMS1cXHUzMGZhXFx1MzBmYy1cXHUzMGZmXFx1MzEwNS1cXHUzMTJmXFx1MzEzMS1cXHUzMThlXFx1MzFhMC1cXHUzMWJmXFx1MzFmMC1cXHUzMWZmXFx1MzQwMC1cXHU0ZGJmXFx1NGUwMC1cXHVhNDhjXFx1YTRkMC1cXHVhNGZkXFx1YTUwMC1cXHVhNjBjXFx1YTYxMC1cXHVhNjFmXFx1YTYyYVxcdWE2MmJcXHVhNjQwLVxcdWE2NmVcXHVhNjdmLVxcdWE2OWRcXHVhNmEwLVxcdWE2ZWZcXHVhNzE3LVxcdWE3MWZcXHVhNzIyLVxcdWE3ODhcXHVhNzhiLVxcdWE3Y2FcXHVhN2QwXFx1YTdkMVxcdWE3ZDNcXHVhN2Q1LVxcdWE3ZDlcXHVhN2YyLVxcdWE4MDFcXHVhODAzLVxcdWE4MDVcXHVhODA3LVxcdWE4MGFcXHVhODBjLVxcdWE4MjJcXHVhODQwLVxcdWE4NzNcXHVhODgyLVxcdWE4YjNcXHVhOGYyLVxcdWE4ZjdcXHVhOGZiXFx1YThmZFxcdWE4ZmVcXHVhOTBhLVxcdWE5MjVcXHVhOTMwLVxcdWE5NDZcXHVhOTYwLVxcdWE5N2NcXHVhOTg0LVxcdWE5YjJcXHVhOWNmXFx1YTllMC1cXHVhOWU0XFx1YTllNi1cXHVhOWVmXFx1YTlmYS1cXHVhOWZlXFx1YWEwMC1cXHVhYTI4XFx1YWE0MC1cXHVhYTQyXFx1YWE0NC1cXHVhYTRiXFx1YWE2MC1cXHVhYTc2XFx1YWE3YVxcdWFhN2UtXFx1YWFhZlxcdWFhYjFcXHVhYWI1XFx1YWFiNlxcdWFhYjktXFx1YWFiZFxcdWFhYzBcXHVhYWMyXFx1YWFkYi1cXHVhYWRkXFx1YWFlMC1cXHVhYWVhXFx1YWFmMi1cXHVhYWY0XFx1YWIwMS1cXHVhYjA2XFx1YWIwOS1cXHVhYjBlXFx1YWIxMS1cXHVhYjE2XFx1YWIyMC1cXHVhYjI2XFx1YWIyOC1cXHVhYjJlXFx1YWIzMC1cXHVhYjVhXFx1YWI1Yy1cXHVhYjY5XFx1YWI3MC1cXHVhYmUyXFx1YWMwMC1cXHVkN2EzXFx1ZDdiMC1cXHVkN2M2XFx1ZDdjYi1cXHVkN2ZiXFx1ZjkwMC1cXHVmYTZkXFx1ZmE3MC1cXHVmYWQ5XFx1ZmIwMC1cXHVmYjA2XFx1ZmIxMy1cXHVmYjE3XFx1ZmIxZFxcdWZiMWYtXFx1ZmIyOFxcdWZiMmEtXFx1ZmIzNlxcdWZiMzgtXFx1ZmIzY1xcdWZiM2VcXHVmYjQwXFx1ZmI0MVxcdWZiNDNcXHVmYjQ0XFx1ZmI0Ni1cXHVmYmIxXFx1ZmJkMy1cXHVmZDNkXFx1ZmQ1MC1cXHVmZDhmXFx1ZmQ5Mi1cXHVmZGM3XFx1ZmRmMC1cXHVmZGZiXFx1ZmU3MC1cXHVmZTc0XFx1ZmU3Ni1cXHVmZWZjXFx1ZmYyMS1cXHVmZjNhXFx1ZmY0MS1cXHVmZjVhXFx1ZmY2Ni1cXHVmZmJlXFx1ZmZjMi1cXHVmZmM3XFx1ZmZjYS1cXHVmZmNmXFx1ZmZkMi1cXHVmZmQ3XFx1ZmZkYS1cXHVmZmRjXCI7XG5cbi8vIFRoZXNlIGFyZSBhIHJ1bi1sZW5ndGggYW5kIG9mZnNldCBlbmNvZGVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZVxuXG4vLyBSZXNlcnZlZCB3b3JkIGxpc3RzIGZvciB2YXJpb3VzIGRpYWxlY3RzIG9mIHRoZSBsYW5ndWFnZVxuXG52YXIgcmVzZXJ2ZWRXb3JkcyA9IHtcbiAgMzogXCJhYnN0cmFjdCBib29sZWFuIGJ5dGUgY2hhciBjbGFzcyBkb3VibGUgZW51bSBleHBvcnQgZXh0ZW5kcyBmaW5hbCBmbG9hdCBnb3RvIGltcGxlbWVudHMgaW1wb3J0IGludCBpbnRlcmZhY2UgbG9uZyBuYXRpdmUgcGFja2FnZSBwcml2YXRlIHByb3RlY3RlZCBwdWJsaWMgc2hvcnQgc3RhdGljIHN1cGVyIHN5bmNocm9uaXplZCB0aHJvd3MgdHJhbnNpZW50IHZvbGF0aWxlXCIsXG4gIDU6IFwiY2xhc3MgZW51bSBleHRlbmRzIHN1cGVyIGNvbnN0IGV4cG9ydCBpbXBvcnRcIixcbiAgNjogXCJlbnVtXCIsXG4gIHN0cmljdDogXCJpbXBsZW1lbnRzIGludGVyZmFjZSBsZXQgcGFja2FnZSBwcml2YXRlIHByb3RlY3RlZCBwdWJsaWMgc3RhdGljIHlpZWxkXCIsXG4gIHN0cmljdEJpbmQ6IFwiZXZhbCBhcmd1bWVudHNcIlxufTtcblxuLy8gQW5kIHRoZSBrZXl3b3Jkc1xuXG52YXIgZWNtYTVBbmRMZXNzS2V5d29yZHMgPSBcImJyZWFrIGNhc2UgY2F0Y2ggY29udGludWUgZGVidWdnZXIgZGVmYXVsdCBkbyBlbHNlIGZpbmFsbHkgZm9yIGZ1bmN0aW9uIGlmIHJldHVybiBzd2l0Y2ggdGhyb3cgdHJ5IHZhciB3aGlsZSB3aXRoIG51bGwgdHJ1ZSBmYWxzZSBpbnN0YW5jZW9mIHR5cGVvZiB2b2lkIGRlbGV0ZSBuZXcgaW4gdGhpc1wiO1xuXG52YXIga2V5d29yZHMkMSA9IHtcbiAgNTogZWNtYTVBbmRMZXNzS2V5d29yZHMsXG4gIFwiNW1vZHVsZVwiOiBlY21hNUFuZExlc3NLZXl3b3JkcyArIFwiIGV4cG9ydCBpbXBvcnRcIixcbiAgNjogZWNtYTVBbmRMZXNzS2V5d29yZHMgKyBcIiBjb25zdCBjbGFzcyBleHRlbmRzIGV4cG9ydCBpbXBvcnQgc3VwZXJcIlxufTtcblxudmFyIGtleXdvcmRSZWxhdGlvbmFsT3BlcmF0b3IgPSAvXmluKHN0YW5jZW9mKT8kLztcblxuLy8gIyMgQ2hhcmFjdGVyIGNhdGVnb3JpZXNcblxudmFyIG5vbkFTQ0lJaWRlbnRpZmllclN0YXJ0ID0gbmV3IFJlZ0V4cChcIltcIiArIG5vbkFTQ0lJaWRlbnRpZmllclN0YXJ0Q2hhcnMgKyBcIl1cIik7XG52YXIgbm9uQVNDSUlpZGVudGlmaWVyID0gbmV3IFJlZ0V4cChcIltcIiArIG5vbkFTQ0lJaWRlbnRpZmllclN0YXJ0Q2hhcnMgKyBub25BU0NJSWlkZW50aWZpZXJDaGFycyArIFwiXVwiKTtcblxuLy8gVGhpcyBoYXMgYSBjb21wbGV4aXR5IGxpbmVhciB0byB0aGUgdmFsdWUgb2YgdGhlIGNvZGUuIFRoZVxuLy8gYXNzdW1wdGlvbiBpcyB0aGF0IGxvb2tpbmcgdXAgYXN0cmFsIGlkZW50aWZpZXIgY2hhcmFjdGVycyBpc1xuLy8gcmFyZS5cbmZ1bmN0aW9uIGlzSW5Bc3RyYWxTZXQoY29kZSwgc2V0KSB7XG4gIHZhciBwb3MgPSAweDEwMDAwO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHNldC5sZW5ndGg7IGkgKz0gMikge1xuICAgIHBvcyArPSBzZXRbaV07XG4gICAgaWYgKHBvcyA+IGNvZGUpIHsgcmV0dXJuIGZhbHNlIH1cbiAgICBwb3MgKz0gc2V0W2kgKyAxXTtcbiAgICBpZiAocG9zID49IGNvZGUpIHsgcmV0dXJuIHRydWUgfVxuICB9XG59XG5cbi8vIFRlc3Qgd2hldGhlciBhIGdpdmVuIGNoYXJhY3RlciBjb2RlIHN0YXJ0cyBhbiBpZGVudGlmaWVyLlxuXG5mdW5jdGlvbiBpc0lkZW50aWZpZXJTdGFydChjb2RlLCBhc3RyYWwpIHtcbiAgaWYgKGNvZGUgPCA2NSkgeyByZXR1cm4gY29kZSA9PT0gMzYgfVxuICBpZiAoY29kZSA8IDkxKSB7IHJldHVybiB0cnVlIH1cbiAgaWYgKGNvZGUgPCA5NykgeyByZXR1cm4gY29kZSA9PT0gOTUgfVxuICBpZiAoY29kZSA8IDEyMykgeyByZXR1cm4gdHJ1ZSB9XG4gIGlmIChjb2RlIDw9IDB4ZmZmZikgeyByZXR1cm4gY29kZSA+PSAweGFhICYmIG5vbkFTQ0lJaWRlbnRpZmllclN0YXJ0LnRlc3QoU3RyaW5nLmZyb21DaGFyQ29kZShjb2RlKSkgfVxuICBpZiAoYXN0cmFsID09PSBmYWxzZSkgeyByZXR1cm4gZmFsc2UgfVxuICByZXR1cm4gaXNJbkFzdHJhbFNldChjb2RlLCBhc3RyYWxJZGVudGlmaWVyU3RhcnRDb2Rlcylcbn1cblxuLy8gVGVzdCB3aGV0aGVyIGEgZ2l2ZW4gY2hhcmFjdGVyIGlzIHBhcnQgb2YgYW4gaWRlbnRpZmllci5cblxuZnVuY3Rpb24gaXNJZGVudGlmaWVyQ2hhcihjb2RlLCBhc3RyYWwpIHtcbiAgaWYgKGNvZGUgPCA0OCkgeyByZXR1cm4gY29kZSA9PT0gMzYgfVxuICBpZiAoY29kZSA8IDU4KSB7IHJldHVybiB0cnVlIH1cbiAgaWYgKGNvZGUgPCA2NSkgeyByZXR1cm4gZmFsc2UgfVxuICBpZiAoY29kZSA8IDkxKSB7IHJldHVybiB0cnVlIH1cbiAgaWYgKGNvZGUgPCA5NykgeyByZXR1cm4gY29kZSA9PT0gOTUgfVxuICBpZiAoY29kZSA8IDEyMykgeyByZXR1cm4gdHJ1ZSB9XG4gIGlmIChjb2RlIDw9IDB4ZmZmZikgeyByZXR1cm4gY29kZSA+PSAweGFhICYmIG5vbkFTQ0lJaWRlbnRpZmllci50ZXN0KFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSkpIH1cbiAgaWYgKGFzdHJhbCA9PT0gZmFsc2UpIHsgcmV0dXJuIGZhbHNlIH1cbiAgcmV0dXJuIGlzSW5Bc3RyYWxTZXQoY29kZSwgYXN0cmFsSWRlbnRpZmllclN0YXJ0Q29kZXMpIHx8IGlzSW5Bc3RyYWxTZXQoY29kZSwgYXN0cmFsSWRlbnRpZmllckNvZGVzKVxufVxuXG4vLyAjIyBUb2tlbiB0eXBlc1xuXG4vLyBUaGUgYXNzaWdubWVudCBvZiBmaW5lLWdyYWluZWQsIGluZm9ybWF0aW9uLWNhcnJ5aW5nIHR5cGUgb2JqZWN0c1xuLy8gYWxsb3dzIHRoZSB0b2tlbml6ZXIgdG8gc3RvcmUgdGhlIGluZm9ybWF0aW9uIGl0IGhhcyBhYm91dCBhXG4vLyB0b2tlbiBpbiBhIHdheSB0aGF0IGlzIHZlcnkgY2hlYXAgZm9yIHRoZSBwYXJzZXIgdG8gbG9vayB1cC5cblxuLy8gQWxsIHRva2VuIHR5cGUgdmFyaWFibGVzIHN0YXJ0IHdpdGggYW4gdW5kZXJzY29yZSwgdG8gbWFrZSB0aGVtXG4vLyBlYXN5IHRvIHJlY29nbml6ZS5cblxuLy8gVGhlIGBiZWZvcmVFeHByYCBwcm9wZXJ0eSBpcyB1c2VkIHRvIGRpc2FtYmlndWF0ZSBiZXR3ZWVuIHJlZ3VsYXJcbi8vIGV4cHJlc3Npb25zIGFuZCBkaXZpc2lvbnMuIEl0IGlzIHNldCBvbiBhbGwgdG9rZW4gdHlwZXMgdGhhdCBjYW5cbi8vIGJlIGZvbGxvd2VkIGJ5IGFuIGV4cHJlc3Npb24gKHRodXMsIGEgc2xhc2ggYWZ0ZXIgdGhlbSB3b3VsZCBiZSBhXG4vLyByZWd1bGFyIGV4cHJlc3Npb24pLlxuLy9cbi8vIFRoZSBgc3RhcnRzRXhwcmAgcHJvcGVydHkgaXMgdXNlZCB0byBjaGVjayBpZiB0aGUgdG9rZW4gZW5kcyBhXG4vLyBgeWllbGRgIGV4cHJlc3Npb24uIEl0IGlzIHNldCBvbiBhbGwgdG9rZW4gdHlwZXMgdGhhdCBlaXRoZXIgY2FuXG4vLyBkaXJlY3RseSBzdGFydCBhbiBleHByZXNzaW9uIChsaWtlIGEgcXVvdGF0aW9uIG1hcmspIG9yIGNhblxuLy8gY29udGludWUgYW4gZXhwcmVzc2lvbiAobGlrZSB0aGUgYm9keSBvZiBhIHN0cmluZykuXG4vL1xuLy8gYGlzTG9vcGAgbWFya3MgYSBrZXl3b3JkIGFzIHN0YXJ0aW5nIGEgbG9vcCwgd2hpY2ggaXMgaW1wb3J0YW50XG4vLyB0byBrbm93IHdoZW4gcGFyc2luZyBhIGxhYmVsLCBpbiBvcmRlciB0byBhbGxvdyBvciBkaXNhbGxvd1xuLy8gY29udGludWUganVtcHMgdG8gdGhhdCBsYWJlbC5cblxudmFyIFRva2VuVHlwZSA9IGZ1bmN0aW9uIFRva2VuVHlwZShsYWJlbCwgY29uZikge1xuICBpZiAoIGNvbmYgPT09IHZvaWQgMCApIGNvbmYgPSB7fTtcblxuICB0aGlzLmxhYmVsID0gbGFiZWw7XG4gIHRoaXMua2V5d29yZCA9IGNvbmYua2V5d29yZDtcbiAgdGhpcy5iZWZvcmVFeHByID0gISFjb25mLmJlZm9yZUV4cHI7XG4gIHRoaXMuc3RhcnRzRXhwciA9ICEhY29uZi5zdGFydHNFeHByO1xuICB0aGlzLmlzTG9vcCA9ICEhY29uZi5pc0xvb3A7XG4gIHRoaXMuaXNBc3NpZ24gPSAhIWNvbmYuaXNBc3NpZ247XG4gIHRoaXMucHJlZml4ID0gISFjb25mLnByZWZpeDtcbiAgdGhpcy5wb3N0Zml4ID0gISFjb25mLnBvc3RmaXg7XG4gIHRoaXMuYmlub3AgPSBjb25mLmJpbm9wIHx8IG51bGw7XG4gIHRoaXMudXBkYXRlQ29udGV4dCA9IG51bGw7XG59O1xuXG5mdW5jdGlvbiBiaW5vcChuYW1lLCBwcmVjKSB7XG4gIHJldHVybiBuZXcgVG9rZW5UeXBlKG5hbWUsIHtiZWZvcmVFeHByOiB0cnVlLCBiaW5vcDogcHJlY30pXG59XG52YXIgYmVmb3JlRXhwciA9IHtiZWZvcmVFeHByOiB0cnVlfSwgc3RhcnRzRXhwciA9IHtzdGFydHNFeHByOiB0cnVlfTtcblxuLy8gTWFwIGtleXdvcmQgbmFtZXMgdG8gdG9rZW4gdHlwZXMuXG5cbnZhciBrZXl3b3JkcyA9IHt9O1xuXG4vLyBTdWNjaW5jdCBkZWZpbml0aW9ucyBvZiBrZXl3b3JkIHRva2VuIHR5cGVzXG5mdW5jdGlvbiBrdyhuYW1lLCBvcHRpb25zKSB7XG4gIGlmICggb3B0aW9ucyA9PT0gdm9pZCAwICkgb3B0aW9ucyA9IHt9O1xuXG4gIG9wdGlvbnMua2V5d29yZCA9IG5hbWU7XG4gIHJldHVybiBrZXl3b3Jkc1tuYW1lXSA9IG5ldyBUb2tlblR5cGUobmFtZSwgb3B0aW9ucylcbn1cblxudmFyIHR5cGVzJDEgPSB7XG4gIG51bTogbmV3IFRva2VuVHlwZShcIm51bVwiLCBzdGFydHNFeHByKSxcbiAgcmVnZXhwOiBuZXcgVG9rZW5UeXBlKFwicmVnZXhwXCIsIHN0YXJ0c0V4cHIpLFxuICBzdHJpbmc6IG5ldyBUb2tlblR5cGUoXCJzdHJpbmdcIiwgc3RhcnRzRXhwciksXG4gIG5hbWU6IG5ldyBUb2tlblR5cGUoXCJuYW1lXCIsIHN0YXJ0c0V4cHIpLFxuICBwcml2YXRlSWQ6IG5ldyBUb2tlblR5cGUoXCJwcml2YXRlSWRcIiwgc3RhcnRzRXhwciksXG4gIGVvZjogbmV3IFRva2VuVHlwZShcImVvZlwiKSxcblxuICAvLyBQdW5jdHVhdGlvbiB0b2tlbiB0eXBlcy5cbiAgYnJhY2tldEw6IG5ldyBUb2tlblR5cGUoXCJbXCIsIHtiZWZvcmVFeHByOiB0cnVlLCBzdGFydHNFeHByOiB0cnVlfSksXG4gIGJyYWNrZXRSOiBuZXcgVG9rZW5UeXBlKFwiXVwiKSxcbiAgYnJhY2VMOiBuZXcgVG9rZW5UeXBlKFwie1wiLCB7YmVmb3JlRXhwcjogdHJ1ZSwgc3RhcnRzRXhwcjogdHJ1ZX0pLFxuICBicmFjZVI6IG5ldyBUb2tlblR5cGUoXCJ9XCIpLFxuICBwYXJlbkw6IG5ldyBUb2tlblR5cGUoXCIoXCIsIHtiZWZvcmVFeHByOiB0cnVlLCBzdGFydHNFeHByOiB0cnVlfSksXG4gIHBhcmVuUjogbmV3IFRva2VuVHlwZShcIilcIiksXG4gIGNvbW1hOiBuZXcgVG9rZW5UeXBlKFwiLFwiLCBiZWZvcmVFeHByKSxcbiAgc2VtaTogbmV3IFRva2VuVHlwZShcIjtcIiwgYmVmb3JlRXhwciksXG4gIGNvbG9uOiBuZXcgVG9rZW5UeXBlKFwiOlwiLCBiZWZvcmVFeHByKSxcbiAgZG90OiBuZXcgVG9rZW5UeXBlKFwiLlwiKSxcbiAgcXVlc3Rpb246IG5ldyBUb2tlblR5cGUoXCI/XCIsIGJlZm9yZUV4cHIpLFxuICBxdWVzdGlvbkRvdDogbmV3IFRva2VuVHlwZShcIj8uXCIpLFxuICBhcnJvdzogbmV3IFRva2VuVHlwZShcIj0+XCIsIGJlZm9yZUV4cHIpLFxuICB0ZW1wbGF0ZTogbmV3IFRva2VuVHlwZShcInRlbXBsYXRlXCIpLFxuICBpbnZhbGlkVGVtcGxhdGU6IG5ldyBUb2tlblR5cGUoXCJpbnZhbGlkVGVtcGxhdGVcIiksXG4gIGVsbGlwc2lzOiBuZXcgVG9rZW5UeXBlKFwiLi4uXCIsIGJlZm9yZUV4cHIpLFxuICBiYWNrUXVvdGU6IG5ldyBUb2tlblR5cGUoXCJgXCIsIHN0YXJ0c0V4cHIpLFxuICBkb2xsYXJCcmFjZUw6IG5ldyBUb2tlblR5cGUoXCIke1wiLCB7YmVmb3JlRXhwcjogdHJ1ZSwgc3RhcnRzRXhwcjogdHJ1ZX0pLFxuXG4gIC8vIE9wZXJhdG9ycy4gVGhlc2UgY2Fycnkgc2V2ZXJhbCBraW5kcyBvZiBwcm9wZXJ0aWVzIHRvIGhlbHAgdGhlXG4gIC8vIHBhcnNlciB1c2UgdGhlbSBwcm9wZXJseSAodGhlIHByZXNlbmNlIG9mIHRoZXNlIHByb3BlcnRpZXMgaXNcbiAgLy8gd2hhdCBjYXRlZ29yaXplcyB0aGVtIGFzIG9wZXJhdG9ycykuXG4gIC8vXG4gIC8vIGBiaW5vcGAsIHdoZW4gcHJlc2VudCwgc3BlY2lmaWVzIHRoYXQgdGhpcyBvcGVyYXRvciBpcyBhIGJpbmFyeVxuICAvLyBvcGVyYXRvciwgYW5kIHdpbGwgcmVmZXIgdG8gaXRzIHByZWNlZGVuY2UuXG4gIC8vXG4gIC8vIGBwcmVmaXhgIGFuZCBgcG9zdGZpeGAgbWFyayB0aGUgb3BlcmF0b3IgYXMgYSBwcmVmaXggb3IgcG9zdGZpeFxuICAvLyB1bmFyeSBvcGVyYXRvci5cbiAgLy9cbiAgLy8gYGlzQXNzaWduYCBtYXJrcyBhbGwgb2YgYD1gLCBgKz1gLCBgLT1gIGV0Y2V0ZXJhLCB3aGljaCBhY3QgYXNcbiAgLy8gYmluYXJ5IG9wZXJhdG9ycyB3aXRoIGEgdmVyeSBsb3cgcHJlY2VkZW5jZSwgdGhhdCBzaG91bGQgcmVzdWx0XG4gIC8vIGluIEFzc2lnbm1lbnRFeHByZXNzaW9uIG5vZGVzLlxuXG4gIGVxOiBuZXcgVG9rZW5UeXBlKFwiPVwiLCB7YmVmb3JlRXhwcjogdHJ1ZSwgaXNBc3NpZ246IHRydWV9KSxcbiAgYXNzaWduOiBuZXcgVG9rZW5UeXBlKFwiXz1cIiwge2JlZm9yZUV4cHI6IHRydWUsIGlzQXNzaWduOiB0cnVlfSksXG4gIGluY0RlYzogbmV3IFRva2VuVHlwZShcIisrLy0tXCIsIHtwcmVmaXg6IHRydWUsIHBvc3RmaXg6IHRydWUsIHN0YXJ0c0V4cHI6IHRydWV9KSxcbiAgcHJlZml4OiBuZXcgVG9rZW5UeXBlKFwiIS9+XCIsIHtiZWZvcmVFeHByOiB0cnVlLCBwcmVmaXg6IHRydWUsIHN0YXJ0c0V4cHI6IHRydWV9KSxcbiAgbG9naWNhbE9SOiBiaW5vcChcInx8XCIsIDEpLFxuICBsb2dpY2FsQU5EOiBiaW5vcChcIiYmXCIsIDIpLFxuICBiaXR3aXNlT1I6IGJpbm9wKFwifFwiLCAzKSxcbiAgYml0d2lzZVhPUjogYmlub3AoXCJeXCIsIDQpLFxuICBiaXR3aXNlQU5EOiBiaW5vcChcIiZcIiwgNSksXG4gIGVxdWFsaXR5OiBiaW5vcChcIj09LyE9Lz09PS8hPT1cIiwgNiksXG4gIHJlbGF0aW9uYWw6IGJpbm9wKFwiPC8+Lzw9Lz49XCIsIDcpLFxuICBiaXRTaGlmdDogYmlub3AoXCI8PC8+Pi8+Pj5cIiwgOCksXG4gIHBsdXNNaW46IG5ldyBUb2tlblR5cGUoXCIrLy1cIiwge2JlZm9yZUV4cHI6IHRydWUsIGJpbm9wOiA5LCBwcmVmaXg6IHRydWUsIHN0YXJ0c0V4cHI6IHRydWV9KSxcbiAgbW9kdWxvOiBiaW5vcChcIiVcIiwgMTApLFxuICBzdGFyOiBiaW5vcChcIipcIiwgMTApLFxuICBzbGFzaDogYmlub3AoXCIvXCIsIDEwKSxcbiAgc3RhcnN0YXI6IG5ldyBUb2tlblR5cGUoXCIqKlwiLCB7YmVmb3JlRXhwcjogdHJ1ZX0pLFxuICBjb2FsZXNjZTogYmlub3AoXCI/P1wiLCAxKSxcblxuICAvLyBLZXl3b3JkIHRva2VuIHR5cGVzLlxuICBfYnJlYWs6IGt3KFwiYnJlYWtcIiksXG4gIF9jYXNlOiBrdyhcImNhc2VcIiwgYmVmb3JlRXhwciksXG4gIF9jYXRjaDoga3coXCJjYXRjaFwiKSxcbiAgX2NvbnRpbnVlOiBrdyhcImNvbnRpbnVlXCIpLFxuICBfZGVidWdnZXI6IGt3KFwiZGVidWdnZXJcIiksXG4gIF9kZWZhdWx0OiBrdyhcImRlZmF1bHRcIiwgYmVmb3JlRXhwciksXG4gIF9kbzoga3coXCJkb1wiLCB7aXNMb29wOiB0cnVlLCBiZWZvcmVFeHByOiB0cnVlfSksXG4gIF9lbHNlOiBrdyhcImVsc2VcIiwgYmVmb3JlRXhwciksXG4gIF9maW5hbGx5OiBrdyhcImZpbmFsbHlcIiksXG4gIF9mb3I6IGt3KFwiZm9yXCIsIHtpc0xvb3A6IHRydWV9KSxcbiAgX2Z1bmN0aW9uOiBrdyhcImZ1bmN0aW9uXCIsIHN0YXJ0c0V4cHIpLFxuICBfaWY6IGt3KFwiaWZcIiksXG4gIF9yZXR1cm46IGt3KFwicmV0dXJuXCIsIGJlZm9yZUV4cHIpLFxuICBfc3dpdGNoOiBrdyhcInN3aXRjaFwiKSxcbiAgX3Rocm93OiBrdyhcInRocm93XCIsIGJlZm9yZUV4cHIpLFxuICBfdHJ5OiBrdyhcInRyeVwiKSxcbiAgX3Zhcjoga3coXCJ2YXJcIiksXG4gIF9jb25zdDoga3coXCJjb25zdFwiKSxcbiAgX3doaWxlOiBrdyhcIndoaWxlXCIsIHtpc0xvb3A6IHRydWV9KSxcbiAgX3dpdGg6IGt3KFwid2l0aFwiKSxcbiAgX25ldzoga3coXCJuZXdcIiwge2JlZm9yZUV4cHI6IHRydWUsIHN0YXJ0c0V4cHI6IHRydWV9KSxcbiAgX3RoaXM6IGt3KFwidGhpc1wiLCBzdGFydHNFeHByKSxcbiAgX3N1cGVyOiBrdyhcInN1cGVyXCIsIHN0YXJ0c0V4cHIpLFxuICBfY2xhc3M6IGt3KFwiY2xhc3NcIiwgc3RhcnRzRXhwciksXG4gIF9leHRlbmRzOiBrdyhcImV4dGVuZHNcIiwgYmVmb3JlRXhwciksXG4gIF9leHBvcnQ6IGt3KFwiZXhwb3J0XCIpLFxuICBfaW1wb3J0OiBrdyhcImltcG9ydFwiLCBzdGFydHNFeHByKSxcbiAgX251bGw6IGt3KFwibnVsbFwiLCBzdGFydHNFeHByKSxcbiAgX3RydWU6IGt3KFwidHJ1ZVwiLCBzdGFydHNFeHByKSxcbiAgX2ZhbHNlOiBrdyhcImZhbHNlXCIsIHN0YXJ0c0V4cHIpLFxuICBfaW46IGt3KFwiaW5cIiwge2JlZm9yZUV4cHI6IHRydWUsIGJpbm9wOiA3fSksXG4gIF9pbnN0YW5jZW9mOiBrdyhcImluc3RhbmNlb2ZcIiwge2JlZm9yZUV4cHI6IHRydWUsIGJpbm9wOiA3fSksXG4gIF90eXBlb2Y6IGt3KFwidHlwZW9mXCIsIHtiZWZvcmVFeHByOiB0cnVlLCBwcmVmaXg6IHRydWUsIHN0YXJ0c0V4cHI6IHRydWV9KSxcbiAgX3ZvaWQ6IGt3KFwidm9pZFwiLCB7YmVmb3JlRXhwcjogdHJ1ZSwgcHJlZml4OiB0cnVlLCBzdGFydHNFeHByOiB0cnVlfSksXG4gIF9kZWxldGU6IGt3KFwiZGVsZXRlXCIsIHtiZWZvcmVFeHByOiB0cnVlLCBwcmVmaXg6IHRydWUsIHN0YXJ0c0V4cHI6IHRydWV9KVxufTtcblxuLy8gTWF0Y2hlcyBhIHdob2xlIGxpbmUgYnJlYWsgKHdoZXJlIENSTEYgaXMgY29uc2lkZXJlZCBhIHNpbmdsZVxuLy8gbGluZSBicmVhaykuIFVzZWQgdG8gY291bnQgbGluZXMuXG5cbnZhciBsaW5lQnJlYWsgPSAvXFxyXFxuP3xcXG58XFx1MjAyOHxcXHUyMDI5LztcbnZhciBsaW5lQnJlYWtHID0gbmV3IFJlZ0V4cChsaW5lQnJlYWsuc291cmNlLCBcImdcIik7XG5cbmZ1bmN0aW9uIGlzTmV3TGluZShjb2RlKSB7XG4gIHJldHVybiBjb2RlID09PSAxMCB8fCBjb2RlID09PSAxMyB8fCBjb2RlID09PSAweDIwMjggfHwgY29kZSA9PT0gMHgyMDI5XG59XG5cbmZ1bmN0aW9uIG5leHRMaW5lQnJlYWsoY29kZSwgZnJvbSwgZW5kKSB7XG4gIGlmICggZW5kID09PSB2b2lkIDAgKSBlbmQgPSBjb2RlLmxlbmd0aDtcblxuICBmb3IgKHZhciBpID0gZnJvbTsgaSA8IGVuZDsgaSsrKSB7XG4gICAgdmFyIG5leHQgPSBjb2RlLmNoYXJDb2RlQXQoaSk7XG4gICAgaWYgKGlzTmV3TGluZShuZXh0KSlcbiAgICAgIHsgcmV0dXJuIGkgPCBlbmQgLSAxICYmIG5leHQgPT09IDEzICYmIGNvZGUuY2hhckNvZGVBdChpICsgMSkgPT09IDEwID8gaSArIDIgOiBpICsgMSB9XG4gIH1cbiAgcmV0dXJuIC0xXG59XG5cbnZhciBub25BU0NJSXdoaXRlc3BhY2UgPSAvW1xcdTE2ODBcXHUyMDAwLVxcdTIwMGFcXHUyMDJmXFx1MjA1ZlxcdTMwMDBcXHVmZWZmXS87XG5cbnZhciBza2lwV2hpdGVTcGFjZSA9IC8oPzpcXHN8XFwvXFwvLip8XFwvXFwqW15dKj9cXCpcXC8pKi9nO1xuXG52YXIgcmVmID0gT2JqZWN0LnByb3RvdHlwZTtcbnZhciBoYXNPd25Qcm9wZXJ0eSA9IHJlZi5oYXNPd25Qcm9wZXJ0eTtcbnZhciB0b1N0cmluZyA9IHJlZi50b1N0cmluZztcblxudmFyIGhhc093biA9IE9iamVjdC5oYXNPd24gfHwgKGZ1bmN0aW9uIChvYmosIHByb3BOYW1lKSB7IHJldHVybiAoXG4gIGhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wTmFtZSlcbik7IH0pO1xuXG52YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgKGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIChcbiAgdG9TdHJpbmcuY2FsbChvYmopID09PSBcIltvYmplY3QgQXJyYXldXCJcbik7IH0pO1xuXG5mdW5jdGlvbiB3b3Jkc1JlZ2V4cCh3b3Jkcykge1xuICByZXR1cm4gbmV3IFJlZ0V4cChcIl4oPzpcIiArIHdvcmRzLnJlcGxhY2UoLyAvZywgXCJ8XCIpICsgXCIpJFwiKVxufVxuXG5mdW5jdGlvbiBjb2RlUG9pbnRUb1N0cmluZyhjb2RlKSB7XG4gIC8vIFVURi0xNiBEZWNvZGluZ1xuICBpZiAoY29kZSA8PSAweEZGRkYpIHsgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSkgfVxuICBjb2RlIC09IDB4MTAwMDA7XG4gIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKChjb2RlID4+IDEwKSArIDB4RDgwMCwgKGNvZGUgJiAxMDIzKSArIDB4REMwMClcbn1cblxudmFyIGxvbmVTdXJyb2dhdGUgPSAvKD86W1xcdUQ4MDAtXFx1REJGRl0oPyFbXFx1REMwMC1cXHVERkZGXSl8KD86W15cXHVEODAwLVxcdURCRkZdfF4pW1xcdURDMDAtXFx1REZGRl0pLztcblxuLy8gVGhlc2UgYXJlIHVzZWQgd2hlbiBgb3B0aW9ucy5sb2NhdGlvbnNgIGlzIG9uLCBmb3IgdGhlXG4vLyBgc3RhcnRMb2NgIGFuZCBgZW5kTG9jYCBwcm9wZXJ0aWVzLlxuXG52YXIgUG9zaXRpb24gPSBmdW5jdGlvbiBQb3NpdGlvbihsaW5lLCBjb2wpIHtcbiAgdGhpcy5saW5lID0gbGluZTtcbiAgdGhpcy5jb2x1bW4gPSBjb2w7XG59O1xuXG5Qb3NpdGlvbi5wcm90b3R5cGUub2Zmc2V0ID0gZnVuY3Rpb24gb2Zmc2V0IChuKSB7XG4gIHJldHVybiBuZXcgUG9zaXRpb24odGhpcy5saW5lLCB0aGlzLmNvbHVtbiArIG4pXG59O1xuXG52YXIgU291cmNlTG9jYXRpb24gPSBmdW5jdGlvbiBTb3VyY2VMb2NhdGlvbihwLCBzdGFydCwgZW5kKSB7XG4gIHRoaXMuc3RhcnQgPSBzdGFydDtcbiAgdGhpcy5lbmQgPSBlbmQ7XG4gIGlmIChwLnNvdXJjZUZpbGUgIT09IG51bGwpIHsgdGhpcy5zb3VyY2UgPSBwLnNvdXJjZUZpbGU7IH1cbn07XG5cbi8vIFRoZSBgZ2V0TGluZUluZm9gIGZ1bmN0aW9uIGlzIG1vc3RseSB1c2VmdWwgd2hlbiB0aGVcbi8vIGBsb2NhdGlvbnNgIG9wdGlvbiBpcyBvZmYgKGZvciBwZXJmb3JtYW5jZSByZWFzb25zKSBhbmQgeW91XG4vLyB3YW50IHRvIGZpbmQgdGhlIGxpbmUvY29sdW1uIHBvc2l0aW9uIGZvciBhIGdpdmVuIGNoYXJhY3RlclxuLy8gb2Zmc2V0LiBgaW5wdXRgIHNob3VsZCBiZSB0aGUgY29kZSBzdHJpbmcgdGhhdCB0aGUgb2Zmc2V0IHJlZmVyc1xuLy8gaW50by5cblxuZnVuY3Rpb24gZ2V0TGluZUluZm8oaW5wdXQsIG9mZnNldCkge1xuICBmb3IgKHZhciBsaW5lID0gMSwgY3VyID0gMDs7KSB7XG4gICAgdmFyIG5leHRCcmVhayA9IG5leHRMaW5lQnJlYWsoaW5wdXQsIGN1ciwgb2Zmc2V0KTtcbiAgICBpZiAobmV4dEJyZWFrIDwgMCkgeyByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmUsIG9mZnNldCAtIGN1cikgfVxuICAgICsrbGluZTtcbiAgICBjdXIgPSBuZXh0QnJlYWs7XG4gIH1cbn1cblxuLy8gQSBzZWNvbmQgYXJndW1lbnQgbXVzdCBiZSBnaXZlbiB0byBjb25maWd1cmUgdGhlIHBhcnNlciBwcm9jZXNzLlxuLy8gVGhlc2Ugb3B0aW9ucyBhcmUgcmVjb2duaXplZCAob25seSBgZWNtYVZlcnNpb25gIGlzIHJlcXVpcmVkKTpcblxudmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAvLyBgZWNtYVZlcnNpb25gIGluZGljYXRlcyB0aGUgRUNNQVNjcmlwdCB2ZXJzaW9uIHRvIHBhcnNlLiBNdXN0IGJlXG4gIC8vIGVpdGhlciAzLCA1LCA2IChvciAyMDE1KSwgNyAoMjAxNiksIDggKDIwMTcpLCA5ICgyMDE4KSwgMTBcbiAgLy8gKDIwMTkpLCAxMSAoMjAyMCksIDEyICgyMDIxKSwgMTMgKDIwMjIpLCBvciBgXCJsYXRlc3RcImAgKHRoZVxuICAvLyBsYXRlc3QgdmVyc2lvbiB0aGUgbGlicmFyeSBzdXBwb3J0cykuIFRoaXMgaW5mbHVlbmNlcyBzdXBwb3J0XG4gIC8vIGZvciBzdHJpY3QgbW9kZSwgdGhlIHNldCBvZiByZXNlcnZlZCB3b3JkcywgYW5kIHN1cHBvcnQgZm9yXG4gIC8vIG5ldyBzeW50YXggZmVhdHVyZXMuXG4gIGVjbWFWZXJzaW9uOiBudWxsLFxuICAvLyBgc291cmNlVHlwZWAgaW5kaWNhdGVzIHRoZSBtb2RlIHRoZSBjb2RlIHNob3VsZCBiZSBwYXJzZWQgaW4uXG4gIC8vIENhbiBiZSBlaXRoZXIgYFwic2NyaXB0XCJgIG9yIGBcIm1vZHVsZVwiYC4gVGhpcyBpbmZsdWVuY2VzIGdsb2JhbFxuICAvLyBzdHJpY3QgbW9kZSBhbmQgcGFyc2luZyBvZiBgaW1wb3J0YCBhbmQgYGV4cG9ydGAgZGVjbGFyYXRpb25zLlxuICBzb3VyY2VUeXBlOiBcInNjcmlwdFwiLFxuICAvLyBgb25JbnNlcnRlZFNlbWljb2xvbmAgY2FuIGJlIGEgY2FsbGJhY2sgdGhhdCB3aWxsIGJlIGNhbGxlZFxuICAvLyB3aGVuIGEgc2VtaWNvbG9uIGlzIGF1dG9tYXRpY2FsbHkgaW5zZXJ0ZWQuIEl0IHdpbGwgYmUgcGFzc2VkXG4gIC8vIHRoZSBwb3NpdGlvbiBvZiB0aGUgY29tbWEgYXMgYW4gb2Zmc2V0LCBhbmQgaWYgYGxvY2F0aW9uc2AgaXNcbiAgLy8gZW5hYmxlZCwgaXQgaXMgZ2l2ZW4gdGhlIGxvY2F0aW9uIGFzIGEgYHtsaW5lLCBjb2x1bW59YCBvYmplY3RcbiAgLy8gYXMgc2Vjb25kIGFyZ3VtZW50LlxuICBvbkluc2VydGVkU2VtaWNvbG9uOiBudWxsLFxuICAvLyBgb25UcmFpbGluZ0NvbW1hYCBpcyBzaW1pbGFyIHRvIGBvbkluc2VydGVkU2VtaWNvbG9uYCwgYnV0IGZvclxuICAvLyB0cmFpbGluZyBjb21tYXMuXG4gIG9uVHJhaWxpbmdDb21tYTogbnVsbCxcbiAgLy8gQnkgZGVmYXVsdCwgcmVzZXJ2ZWQgd29yZHMgYXJlIG9ubHkgZW5mb3JjZWQgaWYgZWNtYVZlcnNpb24gPj0gNS5cbiAgLy8gU2V0IGBhbGxvd1Jlc2VydmVkYCB0byBhIGJvb2xlYW4gdmFsdWUgdG8gZXhwbGljaXRseSB0dXJuIHRoaXMgb25cbiAgLy8gYW4gb2ZmLiBXaGVuIHRoaXMgb3B0aW9uIGhhcyB0aGUgdmFsdWUgXCJuZXZlclwiLCByZXNlcnZlZCB3b3Jkc1xuICAvLyBhbmQga2V5d29yZHMgY2FuIGFsc28gbm90IGJlIHVzZWQgYXMgcHJvcGVydHkgbmFtZXMuXG4gIGFsbG93UmVzZXJ2ZWQ6IG51bGwsXG4gIC8vIFdoZW4gZW5hYmxlZCwgYSByZXR1cm4gYXQgdGhlIHRvcCBsZXZlbCBpcyBub3QgY29uc2lkZXJlZCBhblxuICAvLyBlcnJvci5cbiAgYWxsb3dSZXR1cm5PdXRzaWRlRnVuY3Rpb246IGZhbHNlLFxuICAvLyBXaGVuIGVuYWJsZWQsIGltcG9ydC9leHBvcnQgc3RhdGVtZW50cyBhcmUgbm90IGNvbnN0cmFpbmVkIHRvXG4gIC8vIGFwcGVhcmluZyBhdCB0aGUgdG9wIG9mIHRoZSBwcm9ncmFtLCBhbmQgYW4gaW1wb3J0Lm1ldGEgZXhwcmVzc2lvblxuICAvLyBpbiBhIHNjcmlwdCBpc24ndCBjb25zaWRlcmVkIGFuIGVycm9yLlxuICBhbGxvd0ltcG9ydEV4cG9ydEV2ZXJ5d2hlcmU6IGZhbHNlLFxuICAvLyBCeSBkZWZhdWx0LCBhd2FpdCBpZGVudGlmaWVycyBhcmUgYWxsb3dlZCB0byBhcHBlYXIgYXQgdGhlIHRvcC1sZXZlbCBzY29wZSBvbmx5IGlmIGVjbWFWZXJzaW9uID49IDIwMjIuXG4gIC8vIFdoZW4gZW5hYmxlZCwgYXdhaXQgaWRlbnRpZmllcnMgYXJlIGFsbG93ZWQgdG8gYXBwZWFyIGF0IHRoZSB0b3AtbGV2ZWwgc2NvcGUsXG4gIC8vIGJ1dCB0aGV5IGFyZSBzdGlsbCBub3QgYWxsb3dlZCBpbiBub24tYXN5bmMgZnVuY3Rpb25zLlxuICBhbGxvd0F3YWl0T3V0c2lkZUZ1bmN0aW9uOiBudWxsLFxuICAvLyBXaGVuIGVuYWJsZWQsIHN1cGVyIGlkZW50aWZpZXJzIGFyZSBub3QgY29uc3RyYWluZWQgdG9cbiAgLy8gYXBwZWFyaW5nIGluIG1ldGhvZHMgYW5kIGRvIG5vdCByYWlzZSBhbiBlcnJvciB3aGVuIHRoZXkgYXBwZWFyIGVsc2V3aGVyZS5cbiAgYWxsb3dTdXBlck91dHNpZGVNZXRob2Q6IG51bGwsXG4gIC8vIFdoZW4gZW5hYmxlZCwgaGFzaGJhbmcgZGlyZWN0aXZlIGluIHRoZSBiZWdpbm5pbmcgb2YgZmlsZVxuICAvLyBpcyBhbGxvd2VkIGFuZCB0cmVhdGVkIGFzIGEgbGluZSBjb21tZW50LlxuICBhbGxvd0hhc2hCYW5nOiBmYWxzZSxcbiAgLy8gV2hlbiBgbG9jYXRpb25zYCBpcyBvbiwgYGxvY2AgcHJvcGVydGllcyBob2xkaW5nIG9iamVjdHMgd2l0aFxuICAvLyBgc3RhcnRgIGFuZCBgZW5kYCBwcm9wZXJ0aWVzIGluIGB7bGluZSwgY29sdW1ufWAgZm9ybSAod2l0aFxuICAvLyBsaW5lIGJlaW5nIDEtYmFzZWQgYW5kIGNvbHVtbiAwLWJhc2VkKSB3aWxsIGJlIGF0dGFjaGVkIHRvIHRoZVxuICAvLyBub2Rlcy5cbiAgbG9jYXRpb25zOiBmYWxzZSxcbiAgLy8gQSBmdW5jdGlvbiBjYW4gYmUgcGFzc2VkIGFzIGBvblRva2VuYCBvcHRpb24sIHdoaWNoIHdpbGxcbiAgLy8gY2F1c2UgQWNvcm4gdG8gY2FsbCB0aGF0IGZ1bmN0aW9uIHdpdGggb2JqZWN0IGluIHRoZSBzYW1lXG4gIC8vIGZvcm1hdCBhcyB0b2tlbnMgcmV0dXJuZWQgZnJvbSBgdG9rZW5pemVyKCkuZ2V0VG9rZW4oKWAuIE5vdGVcbiAgLy8gdGhhdCB5b3UgYXJlIG5vdCBhbGxvd2VkIHRvIGNhbGwgdGhlIHBhcnNlciBmcm9tIHRoZVxuICAvLyBjYWxsYmFja+KAlHRoYXQgd2lsbCBjb3JydXB0IGl0cyBpbnRlcm5hbCBzdGF0ZS5cbiAgb25Ub2tlbjogbnVsbCxcbiAgLy8gQSBmdW5jdGlvbiBjYW4gYmUgcGFzc2VkIGFzIGBvbkNvbW1lbnRgIG9wdGlvbiwgd2hpY2ggd2lsbFxuICAvLyBjYXVzZSBBY29ybiB0byBjYWxsIHRoYXQgZnVuY3Rpb24gd2l0aCBgKGJsb2NrLCB0ZXh0LCBzdGFydCxcbiAgLy8gZW5kKWAgcGFyYW1ldGVycyB3aGVuZXZlciBhIGNvbW1lbnQgaXMgc2tpcHBlZC4gYGJsb2NrYCBpcyBhXG4gIC8vIGJvb2xlYW4gaW5kaWNhdGluZyB3aGV0aGVyIHRoaXMgaXMgYSBibG9jayAoYC8qICovYCkgY29tbWVudCxcbiAgLy8gYHRleHRgIGlzIHRoZSBjb250ZW50IG9mIHRoZSBjb21tZW50LCBhbmQgYHN0YXJ0YCBhbmQgYGVuZGAgYXJlXG4gIC8vIGNoYXJhY3RlciBvZmZzZXRzIHRoYXQgZGVub3RlIHRoZSBzdGFydCBhbmQgZW5kIG9mIHRoZSBjb21tZW50LlxuICAvLyBXaGVuIHRoZSBgbG9jYXRpb25zYCBvcHRpb24gaXMgb24sIHR3byBtb3JlIHBhcmFtZXRlcnMgYXJlXG4gIC8vIHBhc3NlZCwgdGhlIGZ1bGwgYHtsaW5lLCBjb2x1bW59YCBsb2NhdGlvbnMgb2YgdGhlIHN0YXJ0IGFuZFxuICAvLyBlbmQgb2YgdGhlIGNvbW1lbnRzLiBOb3RlIHRoYXQgeW91IGFyZSBub3QgYWxsb3dlZCB0byBjYWxsIHRoZVxuICAvLyBwYXJzZXIgZnJvbSB0aGUgY2FsbGJhY2vigJR0aGF0IHdpbGwgY29ycnVwdCBpdHMgaW50ZXJuYWwgc3RhdGUuXG4gIG9uQ29tbWVudDogbnVsbCxcbiAgLy8gTm9kZXMgaGF2ZSB0aGVpciBzdGFydCBhbmQgZW5kIGNoYXJhY3RlcnMgb2Zmc2V0cyByZWNvcmRlZCBpblxuICAvLyBgc3RhcnRgIGFuZCBgZW5kYCBwcm9wZXJ0aWVzIChkaXJlY3RseSBvbiB0aGUgbm9kZSwgcmF0aGVyIHRoYW5cbiAgLy8gdGhlIGBsb2NgIG9iamVjdCwgd2hpY2ggaG9sZHMgbGluZS9jb2x1bW4gZGF0YS4gVG8gYWxzbyBhZGQgYVxuICAvLyBbc2VtaS1zdGFuZGFyZGl6ZWRdW3JhbmdlXSBgcmFuZ2VgIHByb3BlcnR5IGhvbGRpbmcgYSBgW3N0YXJ0LFxuICAvLyBlbmRdYCBhcnJheSB3aXRoIHRoZSBzYW1lIG51bWJlcnMsIHNldCB0aGUgYHJhbmdlc2Agb3B0aW9uIHRvXG4gIC8vIGB0cnVlYC5cbiAgLy9cbiAgLy8gW3JhbmdlXTogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NzQ1Njc4XG4gIHJhbmdlczogZmFsc2UsXG4gIC8vIEl0IGlzIHBvc3NpYmxlIHRvIHBhcnNlIG11bHRpcGxlIGZpbGVzIGludG8gYSBzaW5nbGUgQVNUIGJ5XG4gIC8vIHBhc3NpbmcgdGhlIHRyZWUgcHJvZHVjZWQgYnkgcGFyc2luZyB0aGUgZmlyc3QgZmlsZSBhc1xuICAvLyBgcHJvZ3JhbWAgb3B0aW9uIGluIHN1YnNlcXVlbnQgcGFyc2VzLiBUaGlzIHdpbGwgYWRkIHRoZVxuICAvLyB0b3BsZXZlbCBmb3JtcyBvZiB0aGUgcGFyc2VkIGZpbGUgdG8gdGhlIGBQcm9ncmFtYCAodG9wKSBub2RlXG4gIC8vIG9mIGFuIGV4aXN0aW5nIHBhcnNlIHRyZWUuXG4gIHByb2dyYW06IG51bGwsXG4gIC8vIFdoZW4gYGxvY2F0aW9uc2AgaXMgb24sIHlvdSBjYW4gcGFzcyB0aGlzIHRvIHJlY29yZCB0aGUgc291cmNlXG4gIC8vIGZpbGUgaW4gZXZlcnkgbm9kZSdzIGBsb2NgIG9iamVjdC5cbiAgc291cmNlRmlsZTogbnVsbCxcbiAgLy8gVGhpcyB2YWx1ZSwgaWYgZ2l2ZW4sIGlzIHN0b3JlZCBpbiBldmVyeSBub2RlLCB3aGV0aGVyXG4gIC8vIGBsb2NhdGlvbnNgIGlzIG9uIG9yIG9mZi5cbiAgZGlyZWN0U291cmNlRmlsZTogbnVsbCxcbiAgLy8gV2hlbiBlbmFibGVkLCBwYXJlbnRoZXNpemVkIGV4cHJlc3Npb25zIGFyZSByZXByZXNlbnRlZCBieVxuICAvLyAobm9uLXN0YW5kYXJkKSBQYXJlbnRoZXNpemVkRXhwcmVzc2lvbiBub2Rlc1xuICBwcmVzZXJ2ZVBhcmVuczogZmFsc2Vcbn07XG5cbi8vIEludGVycHJldCBhbmQgZGVmYXVsdCBhbiBvcHRpb25zIG9iamVjdFxuXG52YXIgd2FybmVkQWJvdXRFY21hVmVyc2lvbiA9IGZhbHNlO1xuXG5mdW5jdGlvbiBnZXRPcHRpb25zKG9wdHMpIHtcbiAgdmFyIG9wdGlvbnMgPSB7fTtcblxuICBmb3IgKHZhciBvcHQgaW4gZGVmYXVsdE9wdGlvbnMpXG4gICAgeyBvcHRpb25zW29wdF0gPSBvcHRzICYmIGhhc093bihvcHRzLCBvcHQpID8gb3B0c1tvcHRdIDogZGVmYXVsdE9wdGlvbnNbb3B0XTsgfVxuXG4gIGlmIChvcHRpb25zLmVjbWFWZXJzaW9uID09PSBcImxhdGVzdFwiKSB7XG4gICAgb3B0aW9ucy5lY21hVmVyc2lvbiA9IDFlODtcbiAgfSBlbHNlIGlmIChvcHRpb25zLmVjbWFWZXJzaW9uID09IG51bGwpIHtcbiAgICBpZiAoIXdhcm5lZEFib3V0RWNtYVZlcnNpb24gJiYgdHlwZW9mIGNvbnNvbGUgPT09IFwib2JqZWN0XCIgJiYgY29uc29sZS53YXJuKSB7XG4gICAgICB3YXJuZWRBYm91dEVjbWFWZXJzaW9uID0gdHJ1ZTtcbiAgICAgIGNvbnNvbGUud2FybihcIlNpbmNlIEFjb3JuIDguMC4wLCBvcHRpb25zLmVjbWFWZXJzaW9uIGlzIHJlcXVpcmVkLlxcbkRlZmF1bHRpbmcgdG8gMjAyMCwgYnV0IHRoaXMgd2lsbCBzdG9wIHdvcmtpbmcgaW4gdGhlIGZ1dHVyZS5cIik7XG4gICAgfVxuICAgIG9wdGlvbnMuZWNtYVZlcnNpb24gPSAxMTtcbiAgfSBlbHNlIGlmIChvcHRpb25zLmVjbWFWZXJzaW9uID49IDIwMTUpIHtcbiAgICBvcHRpb25zLmVjbWFWZXJzaW9uIC09IDIwMDk7XG4gIH1cblxuICBpZiAob3B0aW9ucy5hbGxvd1Jlc2VydmVkID09IG51bGwpXG4gICAgeyBvcHRpb25zLmFsbG93UmVzZXJ2ZWQgPSBvcHRpb25zLmVjbWFWZXJzaW9uIDwgNTsgfVxuXG4gIGlmIChpc0FycmF5KG9wdGlvbnMub25Ub2tlbikpIHtcbiAgICB2YXIgdG9rZW5zID0gb3B0aW9ucy5vblRva2VuO1xuICAgIG9wdGlvbnMub25Ub2tlbiA9IGZ1bmN0aW9uICh0b2tlbikgeyByZXR1cm4gdG9rZW5zLnB1c2godG9rZW4pOyB9O1xuICB9XG4gIGlmIChpc0FycmF5KG9wdGlvbnMub25Db21tZW50KSlcbiAgICB7IG9wdGlvbnMub25Db21tZW50ID0gcHVzaENvbW1lbnQob3B0aW9ucywgb3B0aW9ucy5vbkNvbW1lbnQpOyB9XG5cbiAgcmV0dXJuIG9wdGlvbnNcbn1cblxuZnVuY3Rpb24gcHVzaENvbW1lbnQob3B0aW9ucywgYXJyYXkpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGJsb2NrLCB0ZXh0LCBzdGFydCwgZW5kLCBzdGFydExvYywgZW5kTG9jKSB7XG4gICAgdmFyIGNvbW1lbnQgPSB7XG4gICAgICB0eXBlOiBibG9jayA/IFwiQmxvY2tcIiA6IFwiTGluZVwiLFxuICAgICAgdmFsdWU6IHRleHQsXG4gICAgICBzdGFydDogc3RhcnQsXG4gICAgICBlbmQ6IGVuZFxuICAgIH07XG4gICAgaWYgKG9wdGlvbnMubG9jYXRpb25zKVxuICAgICAgeyBjb21tZW50LmxvYyA9IG5ldyBTb3VyY2VMb2NhdGlvbih0aGlzLCBzdGFydExvYywgZW5kTG9jKTsgfVxuICAgIGlmIChvcHRpb25zLnJhbmdlcylcbiAgICAgIHsgY29tbWVudC5yYW5nZSA9IFtzdGFydCwgZW5kXTsgfVxuICAgIGFycmF5LnB1c2goY29tbWVudCk7XG4gIH1cbn1cblxuLy8gRWFjaCBzY29wZSBnZXRzIGEgYml0c2V0IHRoYXQgbWF5IGNvbnRhaW4gdGhlc2UgZmxhZ3NcbnZhclxuICAgIFNDT1BFX1RPUCA9IDEsXG4gICAgU0NPUEVfRlVOQ1RJT04gPSAyLFxuICAgIFNDT1BFX0FTWU5DID0gNCxcbiAgICBTQ09QRV9HRU5FUkFUT1IgPSA4LFxuICAgIFNDT1BFX0FSUk9XID0gMTYsXG4gICAgU0NPUEVfU0lNUExFX0NBVENIID0gMzIsXG4gICAgU0NPUEVfU1VQRVIgPSA2NCxcbiAgICBTQ09QRV9ESVJFQ1RfU1VQRVIgPSAxMjgsXG4gICAgU0NPUEVfQ0xBU1NfU1RBVElDX0JMT0NLID0gMjU2LFxuICAgIFNDT1BFX1ZBUiA9IFNDT1BFX1RPUCB8IFNDT1BFX0ZVTkNUSU9OIHwgU0NPUEVfQ0xBU1NfU1RBVElDX0JMT0NLO1xuXG5mdW5jdGlvbiBmdW5jdGlvbkZsYWdzKGFzeW5jLCBnZW5lcmF0b3IpIHtcbiAgcmV0dXJuIFNDT1BFX0ZVTkNUSU9OIHwgKGFzeW5jID8gU0NPUEVfQVNZTkMgOiAwKSB8IChnZW5lcmF0b3IgPyBTQ09QRV9HRU5FUkFUT1IgOiAwKVxufVxuXG4vLyBVc2VkIGluIGNoZWNrTFZhbCogYW5kIGRlY2xhcmVOYW1lIHRvIGRldGVybWluZSB0aGUgdHlwZSBvZiBhIGJpbmRpbmdcbnZhclxuICAgIEJJTkRfTk9ORSA9IDAsIC8vIE5vdCBhIGJpbmRpbmdcbiAgICBCSU5EX1ZBUiA9IDEsIC8vIFZhci1zdHlsZSBiaW5kaW5nXG4gICAgQklORF9MRVhJQ0FMID0gMiwgLy8gTGV0LSBvciBjb25zdC1zdHlsZSBiaW5kaW5nXG4gICAgQklORF9GVU5DVElPTiA9IDMsIC8vIEZ1bmN0aW9uIGRlY2xhcmF0aW9uXG4gICAgQklORF9TSU1QTEVfQ0FUQ0ggPSA0LCAvLyBTaW1wbGUgKGlkZW50aWZpZXIgcGF0dGVybikgY2F0Y2ggYmluZGluZ1xuICAgIEJJTkRfT1VUU0lERSA9IDU7IC8vIFNwZWNpYWwgY2FzZSBmb3IgZnVuY3Rpb24gbmFtZXMgYXMgYm91bmQgaW5zaWRlIHRoZSBmdW5jdGlvblxuXG52YXIgUGFyc2VyID0gZnVuY3Rpb24gUGFyc2VyKG9wdGlvbnMsIGlucHV0LCBzdGFydFBvcykge1xuICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zID0gZ2V0T3B0aW9ucyhvcHRpb25zKTtcbiAgdGhpcy5zb3VyY2VGaWxlID0gb3B0aW9ucy5zb3VyY2VGaWxlO1xuICB0aGlzLmtleXdvcmRzID0gd29yZHNSZWdleHAoa2V5d29yZHMkMVtvcHRpb25zLmVjbWFWZXJzaW9uID49IDYgPyA2IDogb3B0aW9ucy5zb3VyY2VUeXBlID09PSBcIm1vZHVsZVwiID8gXCI1bW9kdWxlXCIgOiA1XSk7XG4gIHZhciByZXNlcnZlZCA9IFwiXCI7XG4gIGlmIChvcHRpb25zLmFsbG93UmVzZXJ2ZWQgIT09IHRydWUpIHtcbiAgICByZXNlcnZlZCA9IHJlc2VydmVkV29yZHNbb3B0aW9ucy5lY21hVmVyc2lvbiA+PSA2ID8gNiA6IG9wdGlvbnMuZWNtYVZlcnNpb24gPT09IDUgPyA1IDogM107XG4gICAgaWYgKG9wdGlvbnMuc291cmNlVHlwZSA9PT0gXCJtb2R1bGVcIikgeyByZXNlcnZlZCArPSBcIiBhd2FpdFwiOyB9XG4gIH1cbiAgdGhpcy5yZXNlcnZlZFdvcmRzID0gd29yZHNSZWdleHAocmVzZXJ2ZWQpO1xuICB2YXIgcmVzZXJ2ZWRTdHJpY3QgPSAocmVzZXJ2ZWQgPyByZXNlcnZlZCArIFwiIFwiIDogXCJcIikgKyByZXNlcnZlZFdvcmRzLnN0cmljdDtcbiAgdGhpcy5yZXNlcnZlZFdvcmRzU3RyaWN0ID0gd29yZHNSZWdleHAocmVzZXJ2ZWRTdHJpY3QpO1xuICB0aGlzLnJlc2VydmVkV29yZHNTdHJpY3RCaW5kID0gd29yZHNSZWdleHAocmVzZXJ2ZWRTdHJpY3QgKyBcIiBcIiArIHJlc2VydmVkV29yZHMuc3RyaWN0QmluZCk7XG4gIHRoaXMuaW5wdXQgPSBTdHJpbmcoaW5wdXQpO1xuXG4gIC8vIFVzZWQgdG8gc2lnbmFsIHRvIGNhbGxlcnMgb2YgYHJlYWRXb3JkMWAgd2hldGhlciB0aGUgd29yZFxuICAvLyBjb250YWluZWQgYW55IGVzY2FwZSBzZXF1ZW5jZXMuIFRoaXMgaXMgbmVlZGVkIGJlY2F1c2Ugd29yZHMgd2l0aFxuICAvLyBlc2NhcGUgc2VxdWVuY2VzIG11c3Qgbm90IGJlIGludGVycHJldGVkIGFzIGtleXdvcmRzLlxuICB0aGlzLmNvbnRhaW5zRXNjID0gZmFsc2U7XG5cbiAgLy8gU2V0IHVwIHRva2VuIHN0YXRlXG5cbiAgLy8gVGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlIHRva2VuaXplciBpbiB0aGUgaW5wdXQuXG4gIGlmIChzdGFydFBvcykge1xuICAgIHRoaXMucG9zID0gc3RhcnRQb3M7XG4gICAgdGhpcy5saW5lU3RhcnQgPSB0aGlzLmlucHV0Lmxhc3RJbmRleE9mKFwiXFxuXCIsIHN0YXJ0UG9zIC0gMSkgKyAxO1xuICAgIHRoaXMuY3VyTGluZSA9IHRoaXMuaW5wdXQuc2xpY2UoMCwgdGhpcy5saW5lU3RhcnQpLnNwbGl0KGxpbmVCcmVhaykubGVuZ3RoO1xuICB9IGVsc2Uge1xuICAgIHRoaXMucG9zID0gdGhpcy5saW5lU3RhcnQgPSAwO1xuICAgIHRoaXMuY3VyTGluZSA9IDE7XG4gIH1cblxuICAvLyBQcm9wZXJ0aWVzIG9mIHRoZSBjdXJyZW50IHRva2VuOlxuICAvLyBJdHMgdHlwZVxuICB0aGlzLnR5cGUgPSB0eXBlcyQxLmVvZjtcbiAgLy8gRm9yIHRva2VucyB0aGF0IGluY2x1ZGUgbW9yZSBpbmZvcm1hdGlvbiB0aGFuIHRoZWlyIHR5cGUsIHRoZSB2YWx1ZVxuICB0aGlzLnZhbHVlID0gbnVsbDtcbiAgLy8gSXRzIHN0YXJ0IGFuZCBlbmQgb2Zmc2V0XG4gIHRoaXMuc3RhcnQgPSB0aGlzLmVuZCA9IHRoaXMucG9zO1xuICAvLyBBbmQsIGlmIGxvY2F0aW9ucyBhcmUgdXNlZCwgdGhlIHtsaW5lLCBjb2x1bW59IG9iamVjdFxuICAvLyBjb3JyZXNwb25kaW5nIHRvIHRob3NlIG9mZnNldHNcbiAgdGhpcy5zdGFydExvYyA9IHRoaXMuZW5kTG9jID0gdGhpcy5jdXJQb3NpdGlvbigpO1xuXG4gIC8vIFBvc2l0aW9uIGluZm9ybWF0aW9uIGZvciB0aGUgcHJldmlvdXMgdG9rZW5cbiAgdGhpcy5sYXN0VG9rRW5kTG9jID0gdGhpcy5sYXN0VG9rU3RhcnRMb2MgPSBudWxsO1xuICB0aGlzLmxhc3RUb2tTdGFydCA9IHRoaXMubGFzdFRva0VuZCA9IHRoaXMucG9zO1xuXG4gIC8vIFRoZSBjb250ZXh0IHN0YWNrIGlzIHVzZWQgdG8gc3VwZXJmaWNpYWxseSB0cmFjayBzeW50YWN0aWNcbiAgLy8gY29udGV4dCB0byBwcmVkaWN0IHdoZXRoZXIgYSByZWd1bGFyIGV4cHJlc3Npb24gaXMgYWxsb3dlZCBpbiBhXG4gIC8vIGdpdmVuIHBvc2l0aW9uLlxuICB0aGlzLmNvbnRleHQgPSB0aGlzLmluaXRpYWxDb250ZXh0KCk7XG4gIHRoaXMuZXhwckFsbG93ZWQgPSB0cnVlO1xuXG4gIC8vIEZpZ3VyZSBvdXQgaWYgaXQncyBhIG1vZHVsZSBjb2RlLlxuICB0aGlzLmluTW9kdWxlID0gb3B0aW9ucy5zb3VyY2VUeXBlID09PSBcIm1vZHVsZVwiO1xuICB0aGlzLnN0cmljdCA9IHRoaXMuaW5Nb2R1bGUgfHwgdGhpcy5zdHJpY3REaXJlY3RpdmUodGhpcy5wb3MpO1xuXG4gIC8vIFVzZWQgdG8gc2lnbmlmeSB0aGUgc3RhcnQgb2YgYSBwb3RlbnRpYWwgYXJyb3cgZnVuY3Rpb25cbiAgdGhpcy5wb3RlbnRpYWxBcnJvd0F0ID0gLTE7XG4gIHRoaXMucG90ZW50aWFsQXJyb3dJbkZvckF3YWl0ID0gZmFsc2U7XG5cbiAgLy8gUG9zaXRpb25zIHRvIGRlbGF5ZWQtY2hlY2sgdGhhdCB5aWVsZC9hd2FpdCBkb2VzIG5vdCBleGlzdCBpbiBkZWZhdWx0IHBhcmFtZXRlcnMuXG4gIHRoaXMueWllbGRQb3MgPSB0aGlzLmF3YWl0UG9zID0gdGhpcy5hd2FpdElkZW50UG9zID0gMDtcbiAgLy8gTGFiZWxzIGluIHNjb3BlLlxuICB0aGlzLmxhYmVscyA9IFtdO1xuICAvLyBUaHVzLWZhciB1bmRlZmluZWQgZXhwb3J0cy5cbiAgdGhpcy51bmRlZmluZWRFeHBvcnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuICAvLyBJZiBlbmFibGVkLCBza2lwIGxlYWRpbmcgaGFzaGJhbmcgbGluZS5cbiAgaWYgKHRoaXMucG9zID09PSAwICYmIG9wdGlvbnMuYWxsb3dIYXNoQmFuZyAmJiB0aGlzLmlucHV0LnNsaWNlKDAsIDIpID09PSBcIiMhXCIpXG4gICAgeyB0aGlzLnNraXBMaW5lQ29tbWVudCgyKTsgfVxuXG4gIC8vIFNjb3BlIHRyYWNraW5nIGZvciBkdXBsaWNhdGUgdmFyaWFibGUgbmFtZXMgKHNlZSBzY29wZS5qcylcbiAgdGhpcy5zY29wZVN0YWNrID0gW107XG4gIHRoaXMuZW50ZXJTY29wZShTQ09QRV9UT1ApO1xuXG4gIC8vIEZvciBSZWdFeHAgdmFsaWRhdGlvblxuICB0aGlzLnJlZ2V4cFN0YXRlID0gbnVsbDtcblxuICAvLyBUaGUgc3RhY2sgb2YgcHJpdmF0ZSBuYW1lcy5cbiAgLy8gRWFjaCBlbGVtZW50IGhhcyB0d28gcHJvcGVydGllczogJ2RlY2xhcmVkJyBhbmQgJ3VzZWQnLlxuICAvLyBXaGVuIGl0IGV4aXRlZCBmcm9tIHRoZSBvdXRlcm1vc3QgY2xhc3MgZGVmaW5pdGlvbiwgYWxsIHVzZWQgcHJpdmF0ZSBuYW1lcyBtdXN0IGJlIGRlY2xhcmVkLlxuICB0aGlzLnByaXZhdGVOYW1lU3RhY2sgPSBbXTtcbn07XG5cbnZhciBwcm90b3R5cGVBY2Nlc3NvcnMgPSB7IGluRnVuY3Rpb246IHsgY29uZmlndXJhYmxlOiB0cnVlIH0saW5HZW5lcmF0b3I6IHsgY29uZmlndXJhYmxlOiB0cnVlIH0saW5Bc3luYzogeyBjb25maWd1cmFibGU6IHRydWUgfSxjYW5Bd2FpdDogeyBjb25maWd1cmFibGU6IHRydWUgfSxhbGxvd1N1cGVyOiB7IGNvbmZpZ3VyYWJsZTogdHJ1ZSB9LGFsbG93RGlyZWN0U3VwZXI6IHsgY29uZmlndXJhYmxlOiB0cnVlIH0sdHJlYXRGdW5jdGlvbnNBc1ZhcjogeyBjb25maWd1cmFibGU6IHRydWUgfSxhbGxvd05ld0RvdFRhcmdldDogeyBjb25maWd1cmFibGU6IHRydWUgfSxpbkNsYXNzU3RhdGljQmxvY2s6IHsgY29uZmlndXJhYmxlOiB0cnVlIH0gfTtcblxuUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlICgpIHtcbiAgdmFyIG5vZGUgPSB0aGlzLm9wdGlvbnMucHJvZ3JhbSB8fCB0aGlzLnN0YXJ0Tm9kZSgpO1xuICB0aGlzLm5leHRUb2tlbigpO1xuICByZXR1cm4gdGhpcy5wYXJzZVRvcExldmVsKG5vZGUpXG59O1xuXG5wcm90b3R5cGVBY2Nlc3NvcnMuaW5GdW5jdGlvbi5nZXQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5jdXJyZW50VmFyU2NvcGUoKS5mbGFncyAmIFNDT1BFX0ZVTkNUSU9OKSA+IDAgfTtcblxucHJvdG90eXBlQWNjZXNzb3JzLmluR2VuZXJhdG9yLmdldCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLmN1cnJlbnRWYXJTY29wZSgpLmZsYWdzICYgU0NPUEVfR0VORVJBVE9SKSA+IDAgJiYgIXRoaXMuY3VycmVudFZhclNjb3BlKCkuaW5DbGFzc0ZpZWxkSW5pdCB9O1xuXG5wcm90b3R5cGVBY2Nlc3NvcnMuaW5Bc3luYy5nZXQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5jdXJyZW50VmFyU2NvcGUoKS5mbGFncyAmIFNDT1BFX0FTWU5DKSA+IDAgJiYgIXRoaXMuY3VycmVudFZhclNjb3BlKCkuaW5DbGFzc0ZpZWxkSW5pdCB9O1xuXG5wcm90b3R5cGVBY2Nlc3NvcnMuY2FuQXdhaXQuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICBmb3IgKHZhciBpID0gdGhpcy5zY29wZVN0YWNrLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgdmFyIHNjb3BlID0gdGhpcy5zY29wZVN0YWNrW2ldO1xuICAgIGlmIChzY29wZS5pbkNsYXNzRmllbGRJbml0IHx8IHNjb3BlLmZsYWdzICYgU0NPUEVfQ0xBU1NfU1RBVElDX0JMT0NLKSB7IHJldHVybiBmYWxzZSB9XG4gICAgaWYgKHNjb3BlLmZsYWdzICYgU0NPUEVfRlVOQ1RJT04pIHsgcmV0dXJuIChzY29wZS5mbGFncyAmIFNDT1BFX0FTWU5DKSA+IDAgfVxuICB9XG4gIHJldHVybiAodGhpcy5pbk1vZHVsZSAmJiB0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gMTMpIHx8IHRoaXMub3B0aW9ucy5hbGxvd0F3YWl0T3V0c2lkZUZ1bmN0aW9uXG59O1xuXG5wcm90b3R5cGVBY2Nlc3NvcnMuYWxsb3dTdXBlci5nZXQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciByZWYgPSB0aGlzLmN1cnJlbnRUaGlzU2NvcGUoKTtcbiAgICB2YXIgZmxhZ3MgPSByZWYuZmxhZ3M7XG4gICAgdmFyIGluQ2xhc3NGaWVsZEluaXQgPSByZWYuaW5DbGFzc0ZpZWxkSW5pdDtcbiAgcmV0dXJuIChmbGFncyAmIFNDT1BFX1NVUEVSKSA+IDAgfHwgaW5DbGFzc0ZpZWxkSW5pdCB8fCB0aGlzLm9wdGlvbnMuYWxsb3dTdXBlck91dHNpZGVNZXRob2Rcbn07XG5cbnByb3RvdHlwZUFjY2Vzc29ycy5hbGxvd0RpcmVjdFN1cGVyLmdldCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLmN1cnJlbnRUaGlzU2NvcGUoKS5mbGFncyAmIFNDT1BFX0RJUkVDVF9TVVBFUikgPiAwIH07XG5cbnByb3RvdHlwZUFjY2Vzc29ycy50cmVhdEZ1bmN0aW9uc0FzVmFyLmdldCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMudHJlYXRGdW5jdGlvbnNBc1ZhckluU2NvcGUodGhpcy5jdXJyZW50U2NvcGUoKSkgfTtcblxucHJvdG90eXBlQWNjZXNzb3JzLmFsbG93TmV3RG90VGFyZ2V0LmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJlZiA9IHRoaXMuY3VycmVudFRoaXNTY29wZSgpO1xuICAgIHZhciBmbGFncyA9IHJlZi5mbGFncztcbiAgICB2YXIgaW5DbGFzc0ZpZWxkSW5pdCA9IHJlZi5pbkNsYXNzRmllbGRJbml0O1xuICByZXR1cm4gKGZsYWdzICYgKFNDT1BFX0ZVTkNUSU9OIHwgU0NPUEVfQ0xBU1NfU1RBVElDX0JMT0NLKSkgPiAwIHx8IGluQ2xhc3NGaWVsZEluaXRcbn07XG5cbnByb3RvdHlwZUFjY2Vzc29ycy5pbkNsYXNzU3RhdGljQmxvY2suZ2V0ID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gKHRoaXMuY3VycmVudFZhclNjb3BlKCkuZmxhZ3MgJiBTQ09QRV9DTEFTU19TVEFUSUNfQkxPQ0spID4gMFxufTtcblxuUGFyc2VyLmV4dGVuZCA9IGZ1bmN0aW9uIGV4dGVuZCAoKSB7XG4gICAgdmFyIHBsdWdpbnMgPSBbXSwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICB3aGlsZSAoIGxlbi0tICkgcGx1Z2luc1sgbGVuIF0gPSBhcmd1bWVudHNbIGxlbiBdO1xuXG4gIHZhciBjbHMgPSB0aGlzO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHBsdWdpbnMubGVuZ3RoOyBpKyspIHsgY2xzID0gcGx1Z2luc1tpXShjbHMpOyB9XG4gIHJldHVybiBjbHNcbn07XG5cblBhcnNlci5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlIChpbnB1dCwgb3B0aW9ucykge1xuICByZXR1cm4gbmV3IHRoaXMob3B0aW9ucywgaW5wdXQpLnBhcnNlKClcbn07XG5cblBhcnNlci5wYXJzZUV4cHJlc3Npb25BdCA9IGZ1bmN0aW9uIHBhcnNlRXhwcmVzc2lvbkF0IChpbnB1dCwgcG9zLCBvcHRpb25zKSB7XG4gIHZhciBwYXJzZXIgPSBuZXcgdGhpcyhvcHRpb25zLCBpbnB1dCwgcG9zKTtcbiAgcGFyc2VyLm5leHRUb2tlbigpO1xuICByZXR1cm4gcGFyc2VyLnBhcnNlRXhwcmVzc2lvbigpXG59O1xuXG5QYXJzZXIudG9rZW5pemVyID0gZnVuY3Rpb24gdG9rZW5pemVyIChpbnB1dCwgb3B0aW9ucykge1xuICByZXR1cm4gbmV3IHRoaXMob3B0aW9ucywgaW5wdXQpXG59O1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyggUGFyc2VyLnByb3RvdHlwZSwgcHJvdG90eXBlQWNjZXNzb3JzICk7XG5cbnZhciBwcCQ5ID0gUGFyc2VyLnByb3RvdHlwZTtcblxuLy8gIyMgUGFyc2VyIHV0aWxpdGllc1xuXG52YXIgbGl0ZXJhbCA9IC9eKD86JygoPzpcXFxcLnxbXidcXFxcXSkqPyknfFwiKCg/OlxcXFwufFteXCJcXFxcXSkqPylcIikvO1xucHAkOS5zdHJpY3REaXJlY3RpdmUgPSBmdW5jdGlvbihzdGFydCkge1xuICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uIDwgNSkgeyByZXR1cm4gZmFsc2UgfVxuICBmb3IgKDs7KSB7XG4gICAgLy8gVHJ5IHRvIGZpbmQgc3RyaW5nIGxpdGVyYWwuXG4gICAgc2tpcFdoaXRlU3BhY2UubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgc3RhcnQgKz0gc2tpcFdoaXRlU3BhY2UuZXhlYyh0aGlzLmlucHV0KVswXS5sZW5ndGg7XG4gICAgdmFyIG1hdGNoID0gbGl0ZXJhbC5leGVjKHRoaXMuaW5wdXQuc2xpY2Uoc3RhcnQpKTtcbiAgICBpZiAoIW1hdGNoKSB7IHJldHVybiBmYWxzZSB9XG4gICAgaWYgKChtYXRjaFsxXSB8fCBtYXRjaFsyXSkgPT09IFwidXNlIHN0cmljdFwiKSB7XG4gICAgICBza2lwV2hpdGVTcGFjZS5sYXN0SW5kZXggPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcbiAgICAgIHZhciBzcGFjZUFmdGVyID0gc2tpcFdoaXRlU3BhY2UuZXhlYyh0aGlzLmlucHV0KSwgZW5kID0gc3BhY2VBZnRlci5pbmRleCArIHNwYWNlQWZ0ZXJbMF0ubGVuZ3RoO1xuICAgICAgdmFyIG5leHQgPSB0aGlzLmlucHV0LmNoYXJBdChlbmQpO1xuICAgICAgcmV0dXJuIG5leHQgPT09IFwiO1wiIHx8IG5leHQgPT09IFwifVwiIHx8XG4gICAgICAgIChsaW5lQnJlYWsudGVzdChzcGFjZUFmdGVyWzBdKSAmJlxuICAgICAgICAgISgvWyhgLlsrXFwtLyolPD49LD9eJl0vLnRlc3QobmV4dCkgfHwgbmV4dCA9PT0gXCIhXCIgJiYgdGhpcy5pbnB1dC5jaGFyQXQoZW5kICsgMSkgPT09IFwiPVwiKSlcbiAgICB9XG4gICAgc3RhcnQgKz0gbWF0Y2hbMF0ubGVuZ3RoO1xuXG4gICAgLy8gU2tpcCBzZW1pY29sb24sIGlmIGFueS5cbiAgICBza2lwV2hpdGVTcGFjZS5sYXN0SW5kZXggPSBzdGFydDtcbiAgICBzdGFydCArPSBza2lwV2hpdGVTcGFjZS5leGVjKHRoaXMuaW5wdXQpWzBdLmxlbmd0aDtcbiAgICBpZiAodGhpcy5pbnB1dFtzdGFydF0gPT09IFwiO1wiKVxuICAgICAgeyBzdGFydCsrOyB9XG4gIH1cbn07XG5cbi8vIFByZWRpY2F0ZSB0aGF0IHRlc3RzIHdoZXRoZXIgdGhlIG5leHQgdG9rZW4gaXMgb2YgdGhlIGdpdmVuXG4vLyB0eXBlLCBhbmQgaWYgeWVzLCBjb25zdW1lcyBpdCBhcyBhIHNpZGUgZWZmZWN0LlxuXG5wcCQ5LmVhdCA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgaWYgKHRoaXMudHlwZSA9PT0gdHlwZSkge1xuICAgIHRoaXMubmV4dCgpO1xuICAgIHJldHVybiB0cnVlXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn07XG5cbi8vIFRlc3RzIHdoZXRoZXIgcGFyc2VkIHRva2VuIGlzIGEgY29udGV4dHVhbCBrZXl3b3JkLlxuXG5wcCQ5LmlzQ29udGV4dHVhbCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgcmV0dXJuIHRoaXMudHlwZSA9PT0gdHlwZXMkMS5uYW1lICYmIHRoaXMudmFsdWUgPT09IG5hbWUgJiYgIXRoaXMuY29udGFpbnNFc2Ncbn07XG5cbi8vIENvbnN1bWVzIGNvbnRleHR1YWwga2V5d29yZCBpZiBwb3NzaWJsZS5cblxucHAkOS5lYXRDb250ZXh0dWFsID0gZnVuY3Rpb24obmFtZSkge1xuICBpZiAoIXRoaXMuaXNDb250ZXh0dWFsKG5hbWUpKSB7IHJldHVybiBmYWxzZSB9XG4gIHRoaXMubmV4dCgpO1xuICByZXR1cm4gdHJ1ZVxufTtcblxuLy8gQXNzZXJ0cyB0aGF0IGZvbGxvd2luZyB0b2tlbiBpcyBnaXZlbiBjb250ZXh0dWFsIGtleXdvcmQuXG5cbnBwJDkuZXhwZWN0Q29udGV4dHVhbCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgaWYgKCF0aGlzLmVhdENvbnRleHR1YWwobmFtZSkpIHsgdGhpcy51bmV4cGVjdGVkKCk7IH1cbn07XG5cbi8vIFRlc3Qgd2hldGhlciBhIHNlbWljb2xvbiBjYW4gYmUgaW5zZXJ0ZWQgYXQgdGhlIGN1cnJlbnQgcG9zaXRpb24uXG5cbnBwJDkuY2FuSW5zZXJ0U2VtaWNvbG9uID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnR5cGUgPT09IHR5cGVzJDEuZW9mIHx8XG4gICAgdGhpcy50eXBlID09PSB0eXBlcyQxLmJyYWNlUiB8fFxuICAgIGxpbmVCcmVhay50ZXN0KHRoaXMuaW5wdXQuc2xpY2UodGhpcy5sYXN0VG9rRW5kLCB0aGlzLnN0YXJ0KSlcbn07XG5cbnBwJDkuaW5zZXJ0U2VtaWNvbG9uID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLmNhbkluc2VydFNlbWljb2xvbigpKSB7XG4gICAgaWYgKHRoaXMub3B0aW9ucy5vbkluc2VydGVkU2VtaWNvbG9uKVxuICAgICAgeyB0aGlzLm9wdGlvbnMub25JbnNlcnRlZFNlbWljb2xvbih0aGlzLmxhc3RUb2tFbmQsIHRoaXMubGFzdFRva0VuZExvYyk7IH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG59O1xuXG4vLyBDb25zdW1lIGEgc2VtaWNvbG9uLCBvciwgZmFpbGluZyB0aGF0LCBzZWUgaWYgd2UgYXJlIGFsbG93ZWQgdG9cbi8vIHByZXRlbmQgdGhhdCB0aGVyZSBpcyBhIHNlbWljb2xvbiBhdCB0aGlzIHBvc2l0aW9uLlxuXG5wcCQ5LnNlbWljb2xvbiA9IGZ1bmN0aW9uKCkge1xuICBpZiAoIXRoaXMuZWF0KHR5cGVzJDEuc2VtaSkgJiYgIXRoaXMuaW5zZXJ0U2VtaWNvbG9uKCkpIHsgdGhpcy51bmV4cGVjdGVkKCk7IH1cbn07XG5cbnBwJDkuYWZ0ZXJUcmFpbGluZ0NvbW1hID0gZnVuY3Rpb24odG9rVHlwZSwgbm90TmV4dCkge1xuICBpZiAodGhpcy50eXBlID09PSB0b2tUeXBlKSB7XG4gICAgaWYgKHRoaXMub3B0aW9ucy5vblRyYWlsaW5nQ29tbWEpXG4gICAgICB7IHRoaXMub3B0aW9ucy5vblRyYWlsaW5nQ29tbWEodGhpcy5sYXN0VG9rU3RhcnQsIHRoaXMubGFzdFRva1N0YXJ0TG9jKTsgfVxuICAgIGlmICghbm90TmV4dClcbiAgICAgIHsgdGhpcy5uZXh0KCk7IH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG59O1xuXG4vLyBFeHBlY3QgYSB0b2tlbiBvZiBhIGdpdmVuIHR5cGUuIElmIGZvdW5kLCBjb25zdW1lIGl0LCBvdGhlcndpc2UsXG4vLyByYWlzZSBhbiB1bmV4cGVjdGVkIHRva2VuIGVycm9yLlxuXG5wcCQ5LmV4cGVjdCA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgdGhpcy5lYXQodHlwZSkgfHwgdGhpcy51bmV4cGVjdGVkKCk7XG59O1xuXG4vLyBSYWlzZSBhbiB1bmV4cGVjdGVkIHRva2VuIGVycm9yLlxuXG5wcCQ5LnVuZXhwZWN0ZWQgPSBmdW5jdGlvbihwb3MpIHtcbiAgdGhpcy5yYWlzZShwb3MgIT0gbnVsbCA/IHBvcyA6IHRoaXMuc3RhcnQsIFwiVW5leHBlY3RlZCB0b2tlblwiKTtcbn07XG5cbnZhciBEZXN0cnVjdHVyaW5nRXJyb3JzID0gZnVuY3Rpb24gRGVzdHJ1Y3R1cmluZ0Vycm9ycygpIHtcbiAgdGhpcy5zaG9ydGhhbmRBc3NpZ24gPVxuICB0aGlzLnRyYWlsaW5nQ29tbWEgPVxuICB0aGlzLnBhcmVudGhlc2l6ZWRBc3NpZ24gPVxuICB0aGlzLnBhcmVudGhlc2l6ZWRCaW5kID1cbiAgdGhpcy5kb3VibGVQcm90byA9XG4gICAgLTE7XG59O1xuXG5wcCQ5LmNoZWNrUGF0dGVybkVycm9ycyA9IGZ1bmN0aW9uKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMsIGlzQXNzaWduKSB7XG4gIGlmICghcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykgeyByZXR1cm4gfVxuICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy50cmFpbGluZ0NvbW1hID4gLTEpXG4gICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy50cmFpbGluZ0NvbW1hLCBcIkNvbW1hIGlzIG5vdCBwZXJtaXR0ZWQgYWZ0ZXIgdGhlIHJlc3QgZWxlbWVudFwiKTsgfVxuICB2YXIgcGFyZW5zID0gaXNBc3NpZ24gPyByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnBhcmVudGhlc2l6ZWRBc3NpZ24gOiByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnBhcmVudGhlc2l6ZWRCaW5kO1xuICBpZiAocGFyZW5zID4gLTEpIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKHBhcmVucywgXCJQYXJlbnRoZXNpemVkIHBhdHRlcm5cIik7IH1cbn07XG5cbnBwJDkuY2hlY2tFeHByZXNzaW9uRXJyb3JzID0gZnVuY3Rpb24ocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycywgYW5kVGhyb3cpIHtcbiAgaWYgKCFyZWZEZXN0cnVjdHVyaW5nRXJyb3JzKSB7IHJldHVybiBmYWxzZSB9XG4gIHZhciBzaG9ydGhhbmRBc3NpZ24gPSByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnNob3J0aGFuZEFzc2lnbjtcbiAgdmFyIGRvdWJsZVByb3RvID0gcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy5kb3VibGVQcm90bztcbiAgaWYgKCFhbmRUaHJvdykgeyByZXR1cm4gc2hvcnRoYW5kQXNzaWduID49IDAgfHwgZG91YmxlUHJvdG8gPj0gMCB9XG4gIGlmIChzaG9ydGhhbmRBc3NpZ24gPj0gMClcbiAgICB7IHRoaXMucmFpc2Uoc2hvcnRoYW5kQXNzaWduLCBcIlNob3J0aGFuZCBwcm9wZXJ0eSBhc3NpZ25tZW50cyBhcmUgdmFsaWQgb25seSBpbiBkZXN0cnVjdHVyaW5nIHBhdHRlcm5zXCIpOyB9XG4gIGlmIChkb3VibGVQcm90byA+PSAwKVxuICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKGRvdWJsZVByb3RvLCBcIlJlZGVmaW5pdGlvbiBvZiBfX3Byb3RvX18gcHJvcGVydHlcIik7IH1cbn07XG5cbnBwJDkuY2hlY2tZaWVsZEF3YWl0SW5EZWZhdWx0UGFyYW1zID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLnlpZWxkUG9zICYmICghdGhpcy5hd2FpdFBvcyB8fCB0aGlzLnlpZWxkUG9zIDwgdGhpcy5hd2FpdFBvcykpXG4gICAgeyB0aGlzLnJhaXNlKHRoaXMueWllbGRQb3MsIFwiWWllbGQgZXhwcmVzc2lvbiBjYW5ub3QgYmUgYSBkZWZhdWx0IHZhbHVlXCIpOyB9XG4gIGlmICh0aGlzLmF3YWl0UG9zKVxuICAgIHsgdGhpcy5yYWlzZSh0aGlzLmF3YWl0UG9zLCBcIkF3YWl0IGV4cHJlc3Npb24gY2Fubm90IGJlIGEgZGVmYXVsdCB2YWx1ZVwiKTsgfVxufTtcblxucHAkOS5pc1NpbXBsZUFzc2lnblRhcmdldCA9IGZ1bmN0aW9uKGV4cHIpIHtcbiAgaWYgKGV4cHIudHlwZSA9PT0gXCJQYXJlbnRoZXNpemVkRXhwcmVzc2lvblwiKVxuICAgIHsgcmV0dXJuIHRoaXMuaXNTaW1wbGVBc3NpZ25UYXJnZXQoZXhwci5leHByZXNzaW9uKSB9XG4gIHJldHVybiBleHByLnR5cGUgPT09IFwiSWRlbnRpZmllclwiIHx8IGV4cHIudHlwZSA9PT0gXCJNZW1iZXJFeHByZXNzaW9uXCJcbn07XG5cbnZhciBwcCQ4ID0gUGFyc2VyLnByb3RvdHlwZTtcblxuLy8gIyMjIFN0YXRlbWVudCBwYXJzaW5nXG5cbi8vIFBhcnNlIGEgcHJvZ3JhbS4gSW5pdGlhbGl6ZXMgdGhlIHBhcnNlciwgcmVhZHMgYW55IG51bWJlciBvZlxuLy8gc3RhdGVtZW50cywgYW5kIHdyYXBzIHRoZW0gaW4gYSBQcm9ncmFtIG5vZGUuICBPcHRpb25hbGx5IHRha2VzIGFcbi8vIGBwcm9ncmFtYCBhcmd1bWVudC4gIElmIHByZXNlbnQsIHRoZSBzdGF0ZW1lbnRzIHdpbGwgYmUgYXBwZW5kZWRcbi8vIHRvIGl0cyBib2R5IGluc3RlYWQgb2YgY3JlYXRpbmcgYSBuZXcgbm9kZS5cblxucHAkOC5wYXJzZVRvcExldmVsID0gZnVuY3Rpb24obm9kZSkge1xuICB2YXIgZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIGlmICghbm9kZS5ib2R5KSB7IG5vZGUuYm9keSA9IFtdOyB9XG4gIHdoaWxlICh0aGlzLnR5cGUgIT09IHR5cGVzJDEuZW9mKSB7XG4gICAgdmFyIHN0bXQgPSB0aGlzLnBhcnNlU3RhdGVtZW50KG51bGwsIHRydWUsIGV4cG9ydHMpO1xuICAgIG5vZGUuYm9keS5wdXNoKHN0bXQpO1xuICB9XG4gIGlmICh0aGlzLmluTW9kdWxlKVxuICAgIHsgZm9yICh2YXIgaSA9IDAsIGxpc3QgPSBPYmplY3Qua2V5cyh0aGlzLnVuZGVmaW5lZEV4cG9ydHMpOyBpIDwgbGlzdC5sZW5ndGg7IGkgKz0gMSlcbiAgICAgIHtcbiAgICAgICAgdmFyIG5hbWUgPSBsaXN0W2ldO1xuXG4gICAgICAgIHRoaXMucmFpc2VSZWNvdmVyYWJsZSh0aGlzLnVuZGVmaW5lZEV4cG9ydHNbbmFtZV0uc3RhcnQsIChcIkV4cG9ydCAnXCIgKyBuYW1lICsgXCInIGlzIG5vdCBkZWZpbmVkXCIpKTtcbiAgICAgIH0gfVxuICB0aGlzLmFkYXB0RGlyZWN0aXZlUHJvbG9ndWUobm9kZS5ib2R5KTtcbiAgdGhpcy5uZXh0KCk7XG4gIG5vZGUuc291cmNlVHlwZSA9IHRoaXMub3B0aW9ucy5zb3VyY2VUeXBlO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiUHJvZ3JhbVwiKVxufTtcblxudmFyIGxvb3BMYWJlbCA9IHtraW5kOiBcImxvb3BcIn0sIHN3aXRjaExhYmVsID0ge2tpbmQ6IFwic3dpdGNoXCJ9O1xuXG5wcCQ4LmlzTGV0ID0gZnVuY3Rpb24oY29udGV4dCkge1xuICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uIDwgNiB8fCAhdGhpcy5pc0NvbnRleHR1YWwoXCJsZXRcIikpIHsgcmV0dXJuIGZhbHNlIH1cbiAgc2tpcFdoaXRlU3BhY2UubGFzdEluZGV4ID0gdGhpcy5wb3M7XG4gIHZhciBza2lwID0gc2tpcFdoaXRlU3BhY2UuZXhlYyh0aGlzLmlucHV0KTtcbiAgdmFyIG5leHQgPSB0aGlzLnBvcyArIHNraXBbMF0ubGVuZ3RoLCBuZXh0Q2ggPSB0aGlzLmlucHV0LmNoYXJDb2RlQXQobmV4dCk7XG4gIC8vIEZvciBhbWJpZ3VvdXMgY2FzZXMsIGRldGVybWluZSBpZiBhIExleGljYWxEZWNsYXJhdGlvbiAob3Igb25seSBhXG4gIC8vIFN0YXRlbWVudCkgaXMgYWxsb3dlZCBoZXJlLiBJZiBjb250ZXh0IGlzIG5vdCBlbXB0eSB0aGVuIG9ubHkgYSBTdGF0ZW1lbnRcbiAgLy8gaXMgYWxsb3dlZC4gSG93ZXZlciwgYGxldCBbYCBpcyBhbiBleHBsaWNpdCBuZWdhdGl2ZSBsb29rYWhlYWQgZm9yXG4gIC8vIEV4cHJlc3Npb25TdGF0ZW1lbnQsIHNvIHNwZWNpYWwtY2FzZSBpdCBmaXJzdC5cbiAgaWYgKG5leHRDaCA9PT0gOTEgfHwgbmV4dENoID09PSA5MiB8fCBuZXh0Q2ggPiAweGQ3ZmYgJiYgbmV4dENoIDwgMHhkYzAwKSB7IHJldHVybiB0cnVlIH0gLy8gJ1snLCAnLycsIGFzdHJhbFxuICBpZiAoY29udGV4dCkgeyByZXR1cm4gZmFsc2UgfVxuXG4gIGlmIChuZXh0Q2ggPT09IDEyMykgeyByZXR1cm4gdHJ1ZSB9IC8vICd7J1xuICBpZiAoaXNJZGVudGlmaWVyU3RhcnQobmV4dENoLCB0cnVlKSkge1xuICAgIHZhciBwb3MgPSBuZXh0ICsgMTtcbiAgICB3aGlsZSAoaXNJZGVudGlmaWVyQ2hhcihuZXh0Q2ggPSB0aGlzLmlucHV0LmNoYXJDb2RlQXQocG9zKSwgdHJ1ZSkpIHsgKytwb3M7IH1cbiAgICBpZiAobmV4dENoID09PSA5MiB8fCBuZXh0Q2ggPiAweGQ3ZmYgJiYgbmV4dENoIDwgMHhkYzAwKSB7IHJldHVybiB0cnVlIH1cbiAgICB2YXIgaWRlbnQgPSB0aGlzLmlucHV0LnNsaWNlKG5leHQsIHBvcyk7XG4gICAgaWYgKCFrZXl3b3JkUmVsYXRpb25hbE9wZXJhdG9yLnRlc3QoaWRlbnQpKSB7IHJldHVybiB0cnVlIH1cbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5cbi8vIGNoZWNrICdhc3luYyBbbm8gTGluZVRlcm1pbmF0b3IgaGVyZV0gZnVuY3Rpb24nXG4vLyAtICdhc3luYyAvKmZvbyovIGZ1bmN0aW9uJyBpcyBPSy5cbi8vIC0gJ2FzeW5jIC8qXFxuKi8gZnVuY3Rpb24nIGlzIGludmFsaWQuXG5wcCQ4LmlzQXN5bmNGdW5jdGlvbiA9IGZ1bmN0aW9uKCkge1xuICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uIDwgOCB8fCAhdGhpcy5pc0NvbnRleHR1YWwoXCJhc3luY1wiKSlcbiAgICB7IHJldHVybiBmYWxzZSB9XG5cbiAgc2tpcFdoaXRlU3BhY2UubGFzdEluZGV4ID0gdGhpcy5wb3M7XG4gIHZhciBza2lwID0gc2tpcFdoaXRlU3BhY2UuZXhlYyh0aGlzLmlucHV0KTtcbiAgdmFyIG5leHQgPSB0aGlzLnBvcyArIHNraXBbMF0ubGVuZ3RoLCBhZnRlcjtcbiAgcmV0dXJuICFsaW5lQnJlYWsudGVzdCh0aGlzLmlucHV0LnNsaWNlKHRoaXMucG9zLCBuZXh0KSkgJiZcbiAgICB0aGlzLmlucHV0LnNsaWNlKG5leHQsIG5leHQgKyA4KSA9PT0gXCJmdW5jdGlvblwiICYmXG4gICAgKG5leHQgKyA4ID09PSB0aGlzLmlucHV0Lmxlbmd0aCB8fFxuICAgICAhKGlzSWRlbnRpZmllckNoYXIoYWZ0ZXIgPSB0aGlzLmlucHV0LmNoYXJDb2RlQXQobmV4dCArIDgpKSB8fCBhZnRlciA+IDB4ZDdmZiAmJiBhZnRlciA8IDB4ZGMwMCkpXG59O1xuXG4vLyBQYXJzZSBhIHNpbmdsZSBzdGF0ZW1lbnQuXG4vL1xuLy8gSWYgZXhwZWN0aW5nIGEgc3RhdGVtZW50IGFuZCBmaW5kaW5nIGEgc2xhc2ggb3BlcmF0b3IsIHBhcnNlIGFcbi8vIHJlZ3VsYXIgZXhwcmVzc2lvbiBsaXRlcmFsLiBUaGlzIGlzIHRvIGhhbmRsZSBjYXNlcyBsaWtlXG4vLyBgaWYgKGZvbykgL2JsYWgvLmV4ZWMoZm9vKWAsIHdoZXJlIGxvb2tpbmcgYXQgdGhlIHByZXZpb3VzIHRva2VuXG4vLyBkb2VzIG5vdCBoZWxwLlxuXG5wcCQ4LnBhcnNlU3RhdGVtZW50ID0gZnVuY3Rpb24oY29udGV4dCwgdG9wTGV2ZWwsIGV4cG9ydHMpIHtcbiAgdmFyIHN0YXJ0dHlwZSA9IHRoaXMudHlwZSwgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCksIGtpbmQ7XG5cbiAgaWYgKHRoaXMuaXNMZXQoY29udGV4dCkpIHtcbiAgICBzdGFydHR5cGUgPSB0eXBlcyQxLl92YXI7XG4gICAga2luZCA9IFwibGV0XCI7XG4gIH1cblxuICAvLyBNb3N0IHR5cGVzIG9mIHN0YXRlbWVudHMgYXJlIHJlY29nbml6ZWQgYnkgdGhlIGtleXdvcmQgdGhleVxuICAvLyBzdGFydCB3aXRoLiBNYW55IGFyZSB0cml2aWFsIHRvIHBhcnNlLCBzb21lIHJlcXVpcmUgYSBiaXQgb2ZcbiAgLy8gY29tcGxleGl0eS5cblxuICBzd2l0Y2ggKHN0YXJ0dHlwZSkge1xuICBjYXNlIHR5cGVzJDEuX2JyZWFrOiBjYXNlIHR5cGVzJDEuX2NvbnRpbnVlOiByZXR1cm4gdGhpcy5wYXJzZUJyZWFrQ29udGludWVTdGF0ZW1lbnQobm9kZSwgc3RhcnR0eXBlLmtleXdvcmQpXG4gIGNhc2UgdHlwZXMkMS5fZGVidWdnZXI6IHJldHVybiB0aGlzLnBhcnNlRGVidWdnZXJTdGF0ZW1lbnQobm9kZSlcbiAgY2FzZSB0eXBlcyQxLl9kbzogcmV0dXJuIHRoaXMucGFyc2VEb1N0YXRlbWVudChub2RlKVxuICBjYXNlIHR5cGVzJDEuX2ZvcjogcmV0dXJuIHRoaXMucGFyc2VGb3JTdGF0ZW1lbnQobm9kZSlcbiAgY2FzZSB0eXBlcyQxLl9mdW5jdGlvbjpcbiAgICAvLyBGdW5jdGlvbiBhcyBzb2xlIGJvZHkgb2YgZWl0aGVyIGFuIGlmIHN0YXRlbWVudCBvciBhIGxhYmVsZWQgc3RhdGVtZW50XG4gICAgLy8gd29ya3MsIGJ1dCBub3Qgd2hlbiBpdCBpcyBwYXJ0IG9mIGEgbGFiZWxlZCBzdGF0ZW1lbnQgdGhhdCBpcyB0aGUgc29sZVxuICAgIC8vIGJvZHkgb2YgYW4gaWYgc3RhdGVtZW50LlxuICAgIGlmICgoY29udGV4dCAmJiAodGhpcy5zdHJpY3QgfHwgY29udGV4dCAhPT0gXCJpZlwiICYmIGNvbnRleHQgIT09IFwibGFiZWxcIikpICYmIHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA2KSB7IHRoaXMudW5leHBlY3RlZCgpOyB9XG4gICAgcmV0dXJuIHRoaXMucGFyc2VGdW5jdGlvblN0YXRlbWVudChub2RlLCBmYWxzZSwgIWNvbnRleHQpXG4gIGNhc2UgdHlwZXMkMS5fY2xhc3M6XG4gICAgaWYgKGNvbnRleHQpIHsgdGhpcy51bmV4cGVjdGVkKCk7IH1cbiAgICByZXR1cm4gdGhpcy5wYXJzZUNsYXNzKG5vZGUsIHRydWUpXG4gIGNhc2UgdHlwZXMkMS5faWY6IHJldHVybiB0aGlzLnBhcnNlSWZTdGF0ZW1lbnQobm9kZSlcbiAgY2FzZSB0eXBlcyQxLl9yZXR1cm46IHJldHVybiB0aGlzLnBhcnNlUmV0dXJuU3RhdGVtZW50KG5vZGUpXG4gIGNhc2UgdHlwZXMkMS5fc3dpdGNoOiByZXR1cm4gdGhpcy5wYXJzZVN3aXRjaFN0YXRlbWVudChub2RlKVxuICBjYXNlIHR5cGVzJDEuX3Rocm93OiByZXR1cm4gdGhpcy5wYXJzZVRocm93U3RhdGVtZW50KG5vZGUpXG4gIGNhc2UgdHlwZXMkMS5fdHJ5OiByZXR1cm4gdGhpcy5wYXJzZVRyeVN0YXRlbWVudChub2RlKVxuICBjYXNlIHR5cGVzJDEuX2NvbnN0OiBjYXNlIHR5cGVzJDEuX3ZhcjpcbiAgICBraW5kID0ga2luZCB8fCB0aGlzLnZhbHVlO1xuICAgIGlmIChjb250ZXh0ICYmIGtpbmQgIT09IFwidmFyXCIpIHsgdGhpcy51bmV4cGVjdGVkKCk7IH1cbiAgICByZXR1cm4gdGhpcy5wYXJzZVZhclN0YXRlbWVudChub2RlLCBraW5kKVxuICBjYXNlIHR5cGVzJDEuX3doaWxlOiByZXR1cm4gdGhpcy5wYXJzZVdoaWxlU3RhdGVtZW50KG5vZGUpXG4gIGNhc2UgdHlwZXMkMS5fd2l0aDogcmV0dXJuIHRoaXMucGFyc2VXaXRoU3RhdGVtZW50KG5vZGUpXG4gIGNhc2UgdHlwZXMkMS5icmFjZUw6IHJldHVybiB0aGlzLnBhcnNlQmxvY2sodHJ1ZSwgbm9kZSlcbiAgY2FzZSB0eXBlcyQxLnNlbWk6IHJldHVybiB0aGlzLnBhcnNlRW1wdHlTdGF0ZW1lbnQobm9kZSlcbiAgY2FzZSB0eXBlcyQxLl9leHBvcnQ6XG4gIGNhc2UgdHlwZXMkMS5faW1wb3J0OlxuICAgIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPiAxMCAmJiBzdGFydHR5cGUgPT09IHR5cGVzJDEuX2ltcG9ydCkge1xuICAgICAgc2tpcFdoaXRlU3BhY2UubGFzdEluZGV4ID0gdGhpcy5wb3M7XG4gICAgICB2YXIgc2tpcCA9IHNraXBXaGl0ZVNwYWNlLmV4ZWModGhpcy5pbnB1dCk7XG4gICAgICB2YXIgbmV4dCA9IHRoaXMucG9zICsgc2tpcFswXS5sZW5ndGgsIG5leHRDaCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdChuZXh0KTtcbiAgICAgIGlmIChuZXh0Q2ggPT09IDQwIHx8IG5leHRDaCA9PT0gNDYpIC8vICcoJyBvciAnLidcbiAgICAgICAgeyByZXR1cm4gdGhpcy5wYXJzZUV4cHJlc3Npb25TdGF0ZW1lbnQobm9kZSwgdGhpcy5wYXJzZUV4cHJlc3Npb24oKSkgfVxuICAgIH1cblxuICAgIGlmICghdGhpcy5vcHRpb25zLmFsbG93SW1wb3J0RXhwb3J0RXZlcnl3aGVyZSkge1xuICAgICAgaWYgKCF0b3BMZXZlbClcbiAgICAgICAgeyB0aGlzLnJhaXNlKHRoaXMuc3RhcnQsIFwiJ2ltcG9ydCcgYW5kICdleHBvcnQnIG1heSBvbmx5IGFwcGVhciBhdCB0aGUgdG9wIGxldmVsXCIpOyB9XG4gICAgICBpZiAoIXRoaXMuaW5Nb2R1bGUpXG4gICAgICAgIHsgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIidpbXBvcnQnIGFuZCAnZXhwb3J0JyBtYXkgYXBwZWFyIG9ubHkgd2l0aCAnc291cmNlVHlwZTogbW9kdWxlJ1wiKTsgfVxuICAgIH1cbiAgICByZXR1cm4gc3RhcnR0eXBlID09PSB0eXBlcyQxLl9pbXBvcnQgPyB0aGlzLnBhcnNlSW1wb3J0KG5vZGUpIDogdGhpcy5wYXJzZUV4cG9ydChub2RlLCBleHBvcnRzKVxuXG4gICAgLy8gSWYgdGhlIHN0YXRlbWVudCBkb2VzIG5vdCBzdGFydCB3aXRoIGEgc3RhdGVtZW50IGtleXdvcmQgb3IgYVxuICAgIC8vIGJyYWNlLCBpdCdzIGFuIEV4cHJlc3Npb25TdGF0ZW1lbnQgb3IgTGFiZWxlZFN0YXRlbWVudC4gV2VcbiAgICAvLyBzaW1wbHkgc3RhcnQgcGFyc2luZyBhbiBleHByZXNzaW9uLCBhbmQgYWZ0ZXJ3YXJkcywgaWYgdGhlXG4gICAgLy8gbmV4dCB0b2tlbiBpcyBhIGNvbG9uIGFuZCB0aGUgZXhwcmVzc2lvbiB3YXMgYSBzaW1wbGVcbiAgICAvLyBJZGVudGlmaWVyIG5vZGUsIHdlIHN3aXRjaCB0byBpbnRlcnByZXRpbmcgaXQgYXMgYSBsYWJlbC5cbiAgZGVmYXVsdDpcbiAgICBpZiAodGhpcy5pc0FzeW5jRnVuY3Rpb24oKSkge1xuICAgICAgaWYgKGNvbnRleHQpIHsgdGhpcy51bmV4cGVjdGVkKCk7IH1cbiAgICAgIHRoaXMubmV4dCgpO1xuICAgICAgcmV0dXJuIHRoaXMucGFyc2VGdW5jdGlvblN0YXRlbWVudChub2RlLCB0cnVlLCAhY29udGV4dClcbiAgICB9XG5cbiAgICB2YXIgbWF5YmVOYW1lID0gdGhpcy52YWx1ZSwgZXhwciA9IHRoaXMucGFyc2VFeHByZXNzaW9uKCk7XG4gICAgaWYgKHN0YXJ0dHlwZSA9PT0gdHlwZXMkMS5uYW1lICYmIGV4cHIudHlwZSA9PT0gXCJJZGVudGlmaWVyXCIgJiYgdGhpcy5lYXQodHlwZXMkMS5jb2xvbikpXG4gICAgICB7IHJldHVybiB0aGlzLnBhcnNlTGFiZWxlZFN0YXRlbWVudChub2RlLCBtYXliZU5hbWUsIGV4cHIsIGNvbnRleHQpIH1cbiAgICBlbHNlIHsgcmV0dXJuIHRoaXMucGFyc2VFeHByZXNzaW9uU3RhdGVtZW50KG5vZGUsIGV4cHIpIH1cbiAgfVxufTtcblxucHAkOC5wYXJzZUJyZWFrQ29udGludWVTdGF0ZW1lbnQgPSBmdW5jdGlvbihub2RlLCBrZXl3b3JkKSB7XG4gIHZhciBpc0JyZWFrID0ga2V5d29yZCA9PT0gXCJicmVha1wiO1xuICB0aGlzLm5leHQoKTtcbiAgaWYgKHRoaXMuZWF0KHR5cGVzJDEuc2VtaSkgfHwgdGhpcy5pbnNlcnRTZW1pY29sb24oKSkgeyBub2RlLmxhYmVsID0gbnVsbDsgfVxuICBlbHNlIGlmICh0aGlzLnR5cGUgIT09IHR5cGVzJDEubmFtZSkgeyB0aGlzLnVuZXhwZWN0ZWQoKTsgfVxuICBlbHNlIHtcbiAgICBub2RlLmxhYmVsID0gdGhpcy5wYXJzZUlkZW50KCk7XG4gICAgdGhpcy5zZW1pY29sb24oKTtcbiAgfVxuXG4gIC8vIFZlcmlmeSB0aGF0IHRoZXJlIGlzIGFuIGFjdHVhbCBkZXN0aW5hdGlvbiB0byBicmVhayBvclxuICAvLyBjb250aW51ZSB0by5cbiAgdmFyIGkgPSAwO1xuICBmb3IgKDsgaSA8IHRoaXMubGFiZWxzLmxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGxhYiA9IHRoaXMubGFiZWxzW2ldO1xuICAgIGlmIChub2RlLmxhYmVsID09IG51bGwgfHwgbGFiLm5hbWUgPT09IG5vZGUubGFiZWwubmFtZSkge1xuICAgICAgaWYgKGxhYi5raW5kICE9IG51bGwgJiYgKGlzQnJlYWsgfHwgbGFiLmtpbmQgPT09IFwibG9vcFwiKSkgeyBicmVhayB9XG4gICAgICBpZiAobm9kZS5sYWJlbCAmJiBpc0JyZWFrKSB7IGJyZWFrIH1cbiAgICB9XG4gIH1cbiAgaWYgKGkgPT09IHRoaXMubGFiZWxzLmxlbmd0aCkgeyB0aGlzLnJhaXNlKG5vZGUuc3RhcnQsIFwiVW5zeW50YWN0aWMgXCIgKyBrZXl3b3JkKTsgfVxuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIGlzQnJlYWsgPyBcIkJyZWFrU3RhdGVtZW50XCIgOiBcIkNvbnRpbnVlU3RhdGVtZW50XCIpXG59O1xuXG5wcCQ4LnBhcnNlRGVidWdnZXJTdGF0ZW1lbnQgPSBmdW5jdGlvbihub2RlKSB7XG4gIHRoaXMubmV4dCgpO1xuICB0aGlzLnNlbWljb2xvbigpO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiRGVidWdnZXJTdGF0ZW1lbnRcIilcbn07XG5cbnBwJDgucGFyc2VEb1N0YXRlbWVudCA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgdGhpcy5uZXh0KCk7XG4gIHRoaXMubGFiZWxzLnB1c2gobG9vcExhYmVsKTtcbiAgbm9kZS5ib2R5ID0gdGhpcy5wYXJzZVN0YXRlbWVudChcImRvXCIpO1xuICB0aGlzLmxhYmVscy5wb3AoKTtcbiAgdGhpcy5leHBlY3QodHlwZXMkMS5fd2hpbGUpO1xuICBub2RlLnRlc3QgPSB0aGlzLnBhcnNlUGFyZW5FeHByZXNzaW9uKCk7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gNilcbiAgICB7IHRoaXMuZWF0KHR5cGVzJDEuc2VtaSk7IH1cbiAgZWxzZVxuICAgIHsgdGhpcy5zZW1pY29sb24oKTsgfVxuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiRG9XaGlsZVN0YXRlbWVudFwiKVxufTtcblxuLy8gRGlzYW1iaWd1YXRpbmcgYmV0d2VlbiBhIGBmb3JgIGFuZCBhIGBmb3JgL2BpbmAgb3IgYGZvcmAvYG9mYFxuLy8gbG9vcCBpcyBub24tdHJpdmlhbC4gQmFzaWNhbGx5LCB3ZSBoYXZlIHRvIHBhcnNlIHRoZSBpbml0IGB2YXJgXG4vLyBzdGF0ZW1lbnQgb3IgZXhwcmVzc2lvbiwgZGlzYWxsb3dpbmcgdGhlIGBpbmAgb3BlcmF0b3IgKHNlZVxuLy8gdGhlIHNlY29uZCBwYXJhbWV0ZXIgdG8gYHBhcnNlRXhwcmVzc2lvbmApLCBhbmQgdGhlbiBjaGVja1xuLy8gd2hldGhlciB0aGUgbmV4dCB0b2tlbiBpcyBgaW5gIG9yIGBvZmAuIFdoZW4gdGhlcmUgaXMgbm8gaW5pdFxuLy8gcGFydCAoc2VtaWNvbG9uIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSBvcGVuaW5nIHBhcmVudGhlc2lzKSwgaXRcbi8vIGlzIGEgcmVndWxhciBgZm9yYCBsb29wLlxuXG5wcCQ4LnBhcnNlRm9yU3RhdGVtZW50ID0gZnVuY3Rpb24obm9kZSkge1xuICB0aGlzLm5leHQoKTtcbiAgdmFyIGF3YWl0QXQgPSAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDkgJiYgdGhpcy5jYW5Bd2FpdCAmJiB0aGlzLmVhdENvbnRleHR1YWwoXCJhd2FpdFwiKSkgPyB0aGlzLmxhc3RUb2tTdGFydCA6IC0xO1xuICB0aGlzLmxhYmVscy5wdXNoKGxvb3BMYWJlbCk7XG4gIHRoaXMuZW50ZXJTY29wZSgwKTtcbiAgdGhpcy5leHBlY3QodHlwZXMkMS5wYXJlbkwpO1xuICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLnNlbWkpIHtcbiAgICBpZiAoYXdhaXRBdCA+IC0xKSB7IHRoaXMudW5leHBlY3RlZChhd2FpdEF0KTsgfVxuICAgIHJldHVybiB0aGlzLnBhcnNlRm9yKG5vZGUsIG51bGwpXG4gIH1cbiAgdmFyIGlzTGV0ID0gdGhpcy5pc0xldCgpO1xuICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLl92YXIgfHwgdGhpcy50eXBlID09PSB0eXBlcyQxLl9jb25zdCB8fCBpc0xldCkge1xuICAgIHZhciBpbml0JDEgPSB0aGlzLnN0YXJ0Tm9kZSgpLCBraW5kID0gaXNMZXQgPyBcImxldFwiIDogdGhpcy52YWx1ZTtcbiAgICB0aGlzLm5leHQoKTtcbiAgICB0aGlzLnBhcnNlVmFyKGluaXQkMSwgdHJ1ZSwga2luZCk7XG4gICAgdGhpcy5maW5pc2hOb2RlKGluaXQkMSwgXCJWYXJpYWJsZURlY2xhcmF0aW9uXCIpO1xuICAgIGlmICgodGhpcy50eXBlID09PSB0eXBlcyQxLl9pbiB8fCAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDYgJiYgdGhpcy5pc0NvbnRleHR1YWwoXCJvZlwiKSkpICYmIGluaXQkMS5kZWNsYXJhdGlvbnMubGVuZ3RoID09PSAxKSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDkpIHtcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gdHlwZXMkMS5faW4pIHtcbiAgICAgICAgICBpZiAoYXdhaXRBdCA+IC0xKSB7IHRoaXMudW5leHBlY3RlZChhd2FpdEF0KTsgfVxuICAgICAgICB9IGVsc2UgeyBub2RlLmF3YWl0ID0gYXdhaXRBdCA+IC0xOyB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5wYXJzZUZvckluKG5vZGUsIGluaXQkMSlcbiAgICB9XG4gICAgaWYgKGF3YWl0QXQgPiAtMSkgeyB0aGlzLnVuZXhwZWN0ZWQoYXdhaXRBdCk7IH1cbiAgICByZXR1cm4gdGhpcy5wYXJzZUZvcihub2RlLCBpbml0JDEpXG4gIH1cbiAgdmFyIHN0YXJ0c1dpdGhMZXQgPSB0aGlzLmlzQ29udGV4dHVhbChcImxldFwiKSwgaXNGb3JPZiA9IGZhbHNlO1xuICB2YXIgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycyA9IG5ldyBEZXN0cnVjdHVyaW5nRXJyb3JzO1xuICB2YXIgaW5pdCA9IHRoaXMucGFyc2VFeHByZXNzaW9uKGF3YWl0QXQgPiAtMSA/IFwiYXdhaXRcIiA6IHRydWUsIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpO1xuICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLl9pbiB8fCAoaXNGb3JPZiA9IHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA2ICYmIHRoaXMuaXNDb250ZXh0dWFsKFwib2ZcIikpKSB7XG4gICAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA5KSB7XG4gICAgICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLl9pbikge1xuICAgICAgICBpZiAoYXdhaXRBdCA+IC0xKSB7IHRoaXMudW5leHBlY3RlZChhd2FpdEF0KTsgfVxuICAgICAgfSBlbHNlIHsgbm9kZS5hd2FpdCA9IGF3YWl0QXQgPiAtMTsgfVxuICAgIH1cbiAgICBpZiAoc3RhcnRzV2l0aExldCAmJiBpc0Zvck9mKSB7IHRoaXMucmFpc2UoaW5pdC5zdGFydCwgXCJUaGUgbGVmdC1oYW5kIHNpZGUgb2YgYSBmb3Itb2YgbG9vcCBtYXkgbm90IHN0YXJ0IHdpdGggJ2xldCcuXCIpOyB9XG4gICAgdGhpcy50b0Fzc2lnbmFibGUoaW5pdCwgZmFsc2UsIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpO1xuICAgIHRoaXMuY2hlY2tMVmFsUGF0dGVybihpbml0KTtcbiAgICByZXR1cm4gdGhpcy5wYXJzZUZvckluKG5vZGUsIGluaXQpXG4gIH0gZWxzZSB7XG4gICAgdGhpcy5jaGVja0V4cHJlc3Npb25FcnJvcnMocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycywgdHJ1ZSk7XG4gIH1cbiAgaWYgKGF3YWl0QXQgPiAtMSkgeyB0aGlzLnVuZXhwZWN0ZWQoYXdhaXRBdCk7IH1cbiAgcmV0dXJuIHRoaXMucGFyc2VGb3Iobm9kZSwgaW5pdClcbn07XG5cbnBwJDgucGFyc2VGdW5jdGlvblN0YXRlbWVudCA9IGZ1bmN0aW9uKG5vZGUsIGlzQXN5bmMsIGRlY2xhcmF0aW9uUG9zaXRpb24pIHtcbiAgdGhpcy5uZXh0KCk7XG4gIHJldHVybiB0aGlzLnBhcnNlRnVuY3Rpb24obm9kZSwgRlVOQ19TVEFURU1FTlQgfCAoZGVjbGFyYXRpb25Qb3NpdGlvbiA/IDAgOiBGVU5DX0hBTkdJTkdfU1RBVEVNRU5UKSwgZmFsc2UsIGlzQXN5bmMpXG59O1xuXG5wcCQ4LnBhcnNlSWZTdGF0ZW1lbnQgPSBmdW5jdGlvbihub2RlKSB7XG4gIHRoaXMubmV4dCgpO1xuICBub2RlLnRlc3QgPSB0aGlzLnBhcnNlUGFyZW5FeHByZXNzaW9uKCk7XG4gIC8vIGFsbG93IGZ1bmN0aW9uIGRlY2xhcmF0aW9ucyBpbiBicmFuY2hlcywgYnV0IG9ubHkgaW4gbm9uLXN0cmljdCBtb2RlXG4gIG5vZGUuY29uc2VxdWVudCA9IHRoaXMucGFyc2VTdGF0ZW1lbnQoXCJpZlwiKTtcbiAgbm9kZS5hbHRlcm5hdGUgPSB0aGlzLmVhdCh0eXBlcyQxLl9lbHNlKSA/IHRoaXMucGFyc2VTdGF0ZW1lbnQoXCJpZlwiKSA6IG51bGw7XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJJZlN0YXRlbWVudFwiKVxufTtcblxucHAkOC5wYXJzZVJldHVyblN0YXRlbWVudCA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgaWYgKCF0aGlzLmluRnVuY3Rpb24gJiYgIXRoaXMub3B0aW9ucy5hbGxvd1JldHVybk91dHNpZGVGdW5jdGlvbilcbiAgICB7IHRoaXMucmFpc2UodGhpcy5zdGFydCwgXCIncmV0dXJuJyBvdXRzaWRlIG9mIGZ1bmN0aW9uXCIpOyB9XG4gIHRoaXMubmV4dCgpO1xuXG4gIC8vIEluIGByZXR1cm5gIChhbmQgYGJyZWFrYC9gY29udGludWVgKSwgdGhlIGtleXdvcmRzIHdpdGhcbiAgLy8gb3B0aW9uYWwgYXJndW1lbnRzLCB3ZSBlYWdlcmx5IGxvb2sgZm9yIGEgc2VtaWNvbG9uIG9yIHRoZVxuICAvLyBwb3NzaWJpbGl0eSB0byBpbnNlcnQgb25lLlxuXG4gIGlmICh0aGlzLmVhdCh0eXBlcyQxLnNlbWkpIHx8IHRoaXMuaW5zZXJ0U2VtaWNvbG9uKCkpIHsgbm9kZS5hcmd1bWVudCA9IG51bGw7IH1cbiAgZWxzZSB7IG5vZGUuYXJndW1lbnQgPSB0aGlzLnBhcnNlRXhwcmVzc2lvbigpOyB0aGlzLnNlbWljb2xvbigpOyB9XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJSZXR1cm5TdGF0ZW1lbnRcIilcbn07XG5cbnBwJDgucGFyc2VTd2l0Y2hTdGF0ZW1lbnQgPSBmdW5jdGlvbihub2RlKSB7XG4gIHRoaXMubmV4dCgpO1xuICBub2RlLmRpc2NyaW1pbmFudCA9IHRoaXMucGFyc2VQYXJlbkV4cHJlc3Npb24oKTtcbiAgbm9kZS5jYXNlcyA9IFtdO1xuICB0aGlzLmV4cGVjdCh0eXBlcyQxLmJyYWNlTCk7XG4gIHRoaXMubGFiZWxzLnB1c2goc3dpdGNoTGFiZWwpO1xuICB0aGlzLmVudGVyU2NvcGUoMCk7XG5cbiAgLy8gU3RhdGVtZW50cyB1bmRlciBtdXN0IGJlIGdyb3VwZWQgKGJ5IGxhYmVsKSBpbiBTd2l0Y2hDYXNlXG4gIC8vIG5vZGVzLiBgY3VyYCBpcyB1c2VkIHRvIGtlZXAgdGhlIG5vZGUgdGhhdCB3ZSBhcmUgY3VycmVudGx5XG4gIC8vIGFkZGluZyBzdGF0ZW1lbnRzIHRvLlxuXG4gIHZhciBjdXI7XG4gIGZvciAodmFyIHNhd0RlZmF1bHQgPSBmYWxzZTsgdGhpcy50eXBlICE9PSB0eXBlcyQxLmJyYWNlUjspIHtcbiAgICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLl9jYXNlIHx8IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5fZGVmYXVsdCkge1xuICAgICAgdmFyIGlzQ2FzZSA9IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5fY2FzZTtcbiAgICAgIGlmIChjdXIpIHsgdGhpcy5maW5pc2hOb2RlKGN1ciwgXCJTd2l0Y2hDYXNlXCIpOyB9XG4gICAgICBub2RlLmNhc2VzLnB1c2goY3VyID0gdGhpcy5zdGFydE5vZGUoKSk7XG4gICAgICBjdXIuY29uc2VxdWVudCA9IFtdO1xuICAgICAgdGhpcy5uZXh0KCk7XG4gICAgICBpZiAoaXNDYXNlKSB7XG4gICAgICAgIGN1ci50ZXN0ID0gdGhpcy5wYXJzZUV4cHJlc3Npb24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChzYXdEZWZhdWx0KSB7IHRoaXMucmFpc2VSZWNvdmVyYWJsZSh0aGlzLmxhc3RUb2tTdGFydCwgXCJNdWx0aXBsZSBkZWZhdWx0IGNsYXVzZXNcIik7IH1cbiAgICAgICAgc2F3RGVmYXVsdCA9IHRydWU7XG4gICAgICAgIGN1ci50ZXN0ID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIHRoaXMuZXhwZWN0KHR5cGVzJDEuY29sb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIWN1cikgeyB0aGlzLnVuZXhwZWN0ZWQoKTsgfVxuICAgICAgY3VyLmNvbnNlcXVlbnQucHVzaCh0aGlzLnBhcnNlU3RhdGVtZW50KG51bGwpKTtcbiAgICB9XG4gIH1cbiAgdGhpcy5leGl0U2NvcGUoKTtcbiAgaWYgKGN1cikgeyB0aGlzLmZpbmlzaE5vZGUoY3VyLCBcIlN3aXRjaENhc2VcIik7IH1cbiAgdGhpcy5uZXh0KCk7IC8vIENsb3NpbmcgYnJhY2VcbiAgdGhpcy5sYWJlbHMucG9wKCk7XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJTd2l0Y2hTdGF0ZW1lbnRcIilcbn07XG5cbnBwJDgucGFyc2VUaHJvd1N0YXRlbWVudCA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgdGhpcy5uZXh0KCk7XG4gIGlmIChsaW5lQnJlYWsudGVzdCh0aGlzLmlucHV0LnNsaWNlKHRoaXMubGFzdFRva0VuZCwgdGhpcy5zdGFydCkpKVxuICAgIHsgdGhpcy5yYWlzZSh0aGlzLmxhc3RUb2tFbmQsIFwiSWxsZWdhbCBuZXdsaW5lIGFmdGVyIHRocm93XCIpOyB9XG4gIG5vZGUuYXJndW1lbnQgPSB0aGlzLnBhcnNlRXhwcmVzc2lvbigpO1xuICB0aGlzLnNlbWljb2xvbigpO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiVGhyb3dTdGF0ZW1lbnRcIilcbn07XG5cbi8vIFJldXNlZCBlbXB0eSBhcnJheSBhZGRlZCBmb3Igbm9kZSBmaWVsZHMgdGhhdCBhcmUgYWx3YXlzIGVtcHR5LlxuXG52YXIgZW1wdHkkMSA9IFtdO1xuXG5wcCQ4LnBhcnNlVHJ5U3RhdGVtZW50ID0gZnVuY3Rpb24obm9kZSkge1xuICB0aGlzLm5leHQoKTtcbiAgbm9kZS5ibG9jayA9IHRoaXMucGFyc2VCbG9jaygpO1xuICBub2RlLmhhbmRsZXIgPSBudWxsO1xuICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLl9jYXRjaCkge1xuICAgIHZhciBjbGF1c2UgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICAgIHRoaXMubmV4dCgpO1xuICAgIGlmICh0aGlzLmVhdCh0eXBlcyQxLnBhcmVuTCkpIHtcbiAgICAgIGNsYXVzZS5wYXJhbSA9IHRoaXMucGFyc2VCaW5kaW5nQXRvbSgpO1xuICAgICAgdmFyIHNpbXBsZSA9IGNsYXVzZS5wYXJhbS50eXBlID09PSBcIklkZW50aWZpZXJcIjtcbiAgICAgIHRoaXMuZW50ZXJTY29wZShzaW1wbGUgPyBTQ09QRV9TSU1QTEVfQ0FUQ0ggOiAwKTtcbiAgICAgIHRoaXMuY2hlY2tMVmFsUGF0dGVybihjbGF1c2UucGFyYW0sIHNpbXBsZSA/IEJJTkRfU0lNUExFX0NBVENIIDogQklORF9MRVhJQ0FMKTtcbiAgICAgIHRoaXMuZXhwZWN0KHR5cGVzJDEucGFyZW5SKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA8IDEwKSB7IHRoaXMudW5leHBlY3RlZCgpOyB9XG4gICAgICBjbGF1c2UucGFyYW0gPSBudWxsO1xuICAgICAgdGhpcy5lbnRlclNjb3BlKDApO1xuICAgIH1cbiAgICBjbGF1c2UuYm9keSA9IHRoaXMucGFyc2VCbG9jayhmYWxzZSk7XG4gICAgdGhpcy5leGl0U2NvcGUoKTtcbiAgICBub2RlLmhhbmRsZXIgPSB0aGlzLmZpbmlzaE5vZGUoY2xhdXNlLCBcIkNhdGNoQ2xhdXNlXCIpO1xuICB9XG4gIG5vZGUuZmluYWxpemVyID0gdGhpcy5lYXQodHlwZXMkMS5fZmluYWxseSkgPyB0aGlzLnBhcnNlQmxvY2soKSA6IG51bGw7XG4gIGlmICghbm9kZS5oYW5kbGVyICYmICFub2RlLmZpbmFsaXplcilcbiAgICB7IHRoaXMucmFpc2Uobm9kZS5zdGFydCwgXCJNaXNzaW5nIGNhdGNoIG9yIGZpbmFsbHkgY2xhdXNlXCIpOyB9XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJUcnlTdGF0ZW1lbnRcIilcbn07XG5cbnBwJDgucGFyc2VWYXJTdGF0ZW1lbnQgPSBmdW5jdGlvbihub2RlLCBraW5kKSB7XG4gIHRoaXMubmV4dCgpO1xuICB0aGlzLnBhcnNlVmFyKG5vZGUsIGZhbHNlLCBraW5kKTtcbiAgdGhpcy5zZW1pY29sb24oKTtcbiAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCBcIlZhcmlhYmxlRGVjbGFyYXRpb25cIilcbn07XG5cbnBwJDgucGFyc2VXaGlsZVN0YXRlbWVudCA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgdGhpcy5uZXh0KCk7XG4gIG5vZGUudGVzdCA9IHRoaXMucGFyc2VQYXJlbkV4cHJlc3Npb24oKTtcbiAgdGhpcy5sYWJlbHMucHVzaChsb29wTGFiZWwpO1xuICBub2RlLmJvZHkgPSB0aGlzLnBhcnNlU3RhdGVtZW50KFwid2hpbGVcIik7XG4gIHRoaXMubGFiZWxzLnBvcCgpO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiV2hpbGVTdGF0ZW1lbnRcIilcbn07XG5cbnBwJDgucGFyc2VXaXRoU3RhdGVtZW50ID0gZnVuY3Rpb24obm9kZSkge1xuICBpZiAodGhpcy5zdHJpY3QpIHsgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIid3aXRoJyBpbiBzdHJpY3QgbW9kZVwiKTsgfVxuICB0aGlzLm5leHQoKTtcbiAgbm9kZS5vYmplY3QgPSB0aGlzLnBhcnNlUGFyZW5FeHByZXNzaW9uKCk7XG4gIG5vZGUuYm9keSA9IHRoaXMucGFyc2VTdGF0ZW1lbnQoXCJ3aXRoXCIpO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiV2l0aFN0YXRlbWVudFwiKVxufTtcblxucHAkOC5wYXJzZUVtcHR5U3RhdGVtZW50ID0gZnVuY3Rpb24obm9kZSkge1xuICB0aGlzLm5leHQoKTtcbiAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCBcIkVtcHR5U3RhdGVtZW50XCIpXG59O1xuXG5wcCQ4LnBhcnNlTGFiZWxlZFN0YXRlbWVudCA9IGZ1bmN0aW9uKG5vZGUsIG1heWJlTmFtZSwgZXhwciwgY29udGV4dCkge1xuICBmb3IgKHZhciBpJDEgPSAwLCBsaXN0ID0gdGhpcy5sYWJlbHM7IGkkMSA8IGxpc3QubGVuZ3RoOyBpJDEgKz0gMSlcbiAgICB7XG4gICAgdmFyIGxhYmVsID0gbGlzdFtpJDFdO1xuXG4gICAgaWYgKGxhYmVsLm5hbWUgPT09IG1heWJlTmFtZSlcbiAgICAgIHsgdGhpcy5yYWlzZShleHByLnN0YXJ0LCBcIkxhYmVsICdcIiArIG1heWJlTmFtZSArIFwiJyBpcyBhbHJlYWR5IGRlY2xhcmVkXCIpO1xuICB9IH1cbiAgdmFyIGtpbmQgPSB0aGlzLnR5cGUuaXNMb29wID8gXCJsb29wXCIgOiB0aGlzLnR5cGUgPT09IHR5cGVzJDEuX3N3aXRjaCA/IFwic3dpdGNoXCIgOiBudWxsO1xuICBmb3IgKHZhciBpID0gdGhpcy5sYWJlbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICB2YXIgbGFiZWwkMSA9IHRoaXMubGFiZWxzW2ldO1xuICAgIGlmIChsYWJlbCQxLnN0YXRlbWVudFN0YXJ0ID09PSBub2RlLnN0YXJ0KSB7XG4gICAgICAvLyBVcGRhdGUgaW5mb3JtYXRpb24gYWJvdXQgcHJldmlvdXMgbGFiZWxzIG9uIHRoaXMgbm9kZVxuICAgICAgbGFiZWwkMS5zdGF0ZW1lbnRTdGFydCA9IHRoaXMuc3RhcnQ7XG4gICAgICBsYWJlbCQxLmtpbmQgPSBraW5kO1xuICAgIH0gZWxzZSB7IGJyZWFrIH1cbiAgfVxuICB0aGlzLmxhYmVscy5wdXNoKHtuYW1lOiBtYXliZU5hbWUsIGtpbmQ6IGtpbmQsIHN0YXRlbWVudFN0YXJ0OiB0aGlzLnN0YXJ0fSk7XG4gIG5vZGUuYm9keSA9IHRoaXMucGFyc2VTdGF0ZW1lbnQoY29udGV4dCA/IGNvbnRleHQuaW5kZXhPZihcImxhYmVsXCIpID09PSAtMSA/IGNvbnRleHQgKyBcImxhYmVsXCIgOiBjb250ZXh0IDogXCJsYWJlbFwiKTtcbiAgdGhpcy5sYWJlbHMucG9wKCk7XG4gIG5vZGUubGFiZWwgPSBleHByO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiTGFiZWxlZFN0YXRlbWVudFwiKVxufTtcblxucHAkOC5wYXJzZUV4cHJlc3Npb25TdGF0ZW1lbnQgPSBmdW5jdGlvbihub2RlLCBleHByKSB7XG4gIG5vZGUuZXhwcmVzc2lvbiA9IGV4cHI7XG4gIHRoaXMuc2VtaWNvbG9uKCk7XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJFeHByZXNzaW9uU3RhdGVtZW50XCIpXG59O1xuXG4vLyBQYXJzZSBhIHNlbWljb2xvbi1lbmNsb3NlZCBibG9jayBvZiBzdGF0ZW1lbnRzLCBoYW5kbGluZyBgXCJ1c2Vcbi8vIHN0cmljdFwiYCBkZWNsYXJhdGlvbnMgd2hlbiBgYWxsb3dTdHJpY3RgIGlzIHRydWUgKHVzZWQgZm9yXG4vLyBmdW5jdGlvbiBib2RpZXMpLlxuXG5wcCQ4LnBhcnNlQmxvY2sgPSBmdW5jdGlvbihjcmVhdGVOZXdMZXhpY2FsU2NvcGUsIG5vZGUsIGV4aXRTdHJpY3QpIHtcbiAgaWYgKCBjcmVhdGVOZXdMZXhpY2FsU2NvcGUgPT09IHZvaWQgMCApIGNyZWF0ZU5ld0xleGljYWxTY29wZSA9IHRydWU7XG4gIGlmICggbm9kZSA9PT0gdm9pZCAwICkgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG5cbiAgbm9kZS5ib2R5ID0gW107XG4gIHRoaXMuZXhwZWN0KHR5cGVzJDEuYnJhY2VMKTtcbiAgaWYgKGNyZWF0ZU5ld0xleGljYWxTY29wZSkgeyB0aGlzLmVudGVyU2NvcGUoMCk7IH1cbiAgd2hpbGUgKHRoaXMudHlwZSAhPT0gdHlwZXMkMS5icmFjZVIpIHtcbiAgICB2YXIgc3RtdCA9IHRoaXMucGFyc2VTdGF0ZW1lbnQobnVsbCk7XG4gICAgbm9kZS5ib2R5LnB1c2goc3RtdCk7XG4gIH1cbiAgaWYgKGV4aXRTdHJpY3QpIHsgdGhpcy5zdHJpY3QgPSBmYWxzZTsgfVxuICB0aGlzLm5leHQoKTtcbiAgaWYgKGNyZWF0ZU5ld0xleGljYWxTY29wZSkgeyB0aGlzLmV4aXRTY29wZSgpOyB9XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJCbG9ja1N0YXRlbWVudFwiKVxufTtcblxuLy8gUGFyc2UgYSByZWd1bGFyIGBmb3JgIGxvb3AuIFRoZSBkaXNhbWJpZ3VhdGlvbiBjb2RlIGluXG4vLyBgcGFyc2VTdGF0ZW1lbnRgIHdpbGwgYWxyZWFkeSBoYXZlIHBhcnNlZCB0aGUgaW5pdCBzdGF0ZW1lbnQgb3Jcbi8vIGV4cHJlc3Npb24uXG5cbnBwJDgucGFyc2VGb3IgPSBmdW5jdGlvbihub2RlLCBpbml0KSB7XG4gIG5vZGUuaW5pdCA9IGluaXQ7XG4gIHRoaXMuZXhwZWN0KHR5cGVzJDEuc2VtaSk7XG4gIG5vZGUudGVzdCA9IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5zZW1pID8gbnVsbCA6IHRoaXMucGFyc2VFeHByZXNzaW9uKCk7XG4gIHRoaXMuZXhwZWN0KHR5cGVzJDEuc2VtaSk7XG4gIG5vZGUudXBkYXRlID0gdGhpcy50eXBlID09PSB0eXBlcyQxLnBhcmVuUiA/IG51bGwgOiB0aGlzLnBhcnNlRXhwcmVzc2lvbigpO1xuICB0aGlzLmV4cGVjdCh0eXBlcyQxLnBhcmVuUik7XG4gIG5vZGUuYm9keSA9IHRoaXMucGFyc2VTdGF0ZW1lbnQoXCJmb3JcIik7XG4gIHRoaXMuZXhpdFNjb3BlKCk7XG4gIHRoaXMubGFiZWxzLnBvcCgpO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiRm9yU3RhdGVtZW50XCIpXG59O1xuXG4vLyBQYXJzZSBhIGBmb3JgL2BpbmAgYW5kIGBmb3JgL2BvZmAgbG9vcCwgd2hpY2ggYXJlIGFsbW9zdFxuLy8gc2FtZSBmcm9tIHBhcnNlcidzIHBlcnNwZWN0aXZlLlxuXG5wcCQ4LnBhcnNlRm9ySW4gPSBmdW5jdGlvbihub2RlLCBpbml0KSB7XG4gIHZhciBpc0ZvckluID0gdGhpcy50eXBlID09PSB0eXBlcyQxLl9pbjtcbiAgdGhpcy5uZXh0KCk7XG5cbiAgaWYgKFxuICAgIGluaXQudHlwZSA9PT0gXCJWYXJpYWJsZURlY2xhcmF0aW9uXCIgJiZcbiAgICBpbml0LmRlY2xhcmF0aW9uc1swXS5pbml0ICE9IG51bGwgJiZcbiAgICAoXG4gICAgICAhaXNGb3JJbiB8fFxuICAgICAgdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uIDwgOCB8fFxuICAgICAgdGhpcy5zdHJpY3QgfHxcbiAgICAgIGluaXQua2luZCAhPT0gXCJ2YXJcIiB8fFxuICAgICAgaW5pdC5kZWNsYXJhdGlvbnNbMF0uaWQudHlwZSAhPT0gXCJJZGVudGlmaWVyXCJcbiAgICApXG4gICkge1xuICAgIHRoaXMucmFpc2UoXG4gICAgICBpbml0LnN0YXJ0LFxuICAgICAgKChpc0ZvckluID8gXCJmb3ItaW5cIiA6IFwiZm9yLW9mXCIpICsgXCIgbG9vcCB2YXJpYWJsZSBkZWNsYXJhdGlvbiBtYXkgbm90IGhhdmUgYW4gaW5pdGlhbGl6ZXJcIilcbiAgICApO1xuICB9XG4gIG5vZGUubGVmdCA9IGluaXQ7XG4gIG5vZGUucmlnaHQgPSBpc0ZvckluID8gdGhpcy5wYXJzZUV4cHJlc3Npb24oKSA6IHRoaXMucGFyc2VNYXliZUFzc2lnbigpO1xuICB0aGlzLmV4cGVjdCh0eXBlcyQxLnBhcmVuUik7XG4gIG5vZGUuYm9keSA9IHRoaXMucGFyc2VTdGF0ZW1lbnQoXCJmb3JcIik7XG4gIHRoaXMuZXhpdFNjb3BlKCk7XG4gIHRoaXMubGFiZWxzLnBvcCgpO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIGlzRm9ySW4gPyBcIkZvckluU3RhdGVtZW50XCIgOiBcIkZvck9mU3RhdGVtZW50XCIpXG59O1xuXG4vLyBQYXJzZSBhIGxpc3Qgb2YgdmFyaWFibGUgZGVjbGFyYXRpb25zLlxuXG5wcCQ4LnBhcnNlVmFyID0gZnVuY3Rpb24obm9kZSwgaXNGb3IsIGtpbmQpIHtcbiAgbm9kZS5kZWNsYXJhdGlvbnMgPSBbXTtcbiAgbm9kZS5raW5kID0ga2luZDtcbiAgZm9yICg7Oykge1xuICAgIHZhciBkZWNsID0gdGhpcy5zdGFydE5vZGUoKTtcbiAgICB0aGlzLnBhcnNlVmFySWQoZGVjbCwga2luZCk7XG4gICAgaWYgKHRoaXMuZWF0KHR5cGVzJDEuZXEpKSB7XG4gICAgICBkZWNsLmluaXQgPSB0aGlzLnBhcnNlTWF5YmVBc3NpZ24oaXNGb3IpO1xuICAgIH0gZWxzZSBpZiAoa2luZCA9PT0gXCJjb25zdFwiICYmICEodGhpcy50eXBlID09PSB0eXBlcyQxLl9pbiB8fCAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDYgJiYgdGhpcy5pc0NvbnRleHR1YWwoXCJvZlwiKSkpKSB7XG4gICAgICB0aGlzLnVuZXhwZWN0ZWQoKTtcbiAgICB9IGVsc2UgaWYgKGRlY2wuaWQudHlwZSAhPT0gXCJJZGVudGlmaWVyXCIgJiYgIShpc0ZvciAmJiAodGhpcy50eXBlID09PSB0eXBlcyQxLl9pbiB8fCB0aGlzLmlzQ29udGV4dHVhbChcIm9mXCIpKSkpIHtcbiAgICAgIHRoaXMucmFpc2UodGhpcy5sYXN0VG9rRW5kLCBcIkNvbXBsZXggYmluZGluZyBwYXR0ZXJucyByZXF1aXJlIGFuIGluaXRpYWxpemF0aW9uIHZhbHVlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWNsLmluaXQgPSBudWxsO1xuICAgIH1cbiAgICBub2RlLmRlY2xhcmF0aW9ucy5wdXNoKHRoaXMuZmluaXNoTm9kZShkZWNsLCBcIlZhcmlhYmxlRGVjbGFyYXRvclwiKSk7XG4gICAgaWYgKCF0aGlzLmVhdCh0eXBlcyQxLmNvbW1hKSkgeyBicmVhayB9XG4gIH1cbiAgcmV0dXJuIG5vZGVcbn07XG5cbnBwJDgucGFyc2VWYXJJZCA9IGZ1bmN0aW9uKGRlY2wsIGtpbmQpIHtcbiAgZGVjbC5pZCA9IHRoaXMucGFyc2VCaW5kaW5nQXRvbSgpO1xuICB0aGlzLmNoZWNrTFZhbFBhdHRlcm4oZGVjbC5pZCwga2luZCA9PT0gXCJ2YXJcIiA/IEJJTkRfVkFSIDogQklORF9MRVhJQ0FMLCBmYWxzZSk7XG59O1xuXG52YXIgRlVOQ19TVEFURU1FTlQgPSAxLCBGVU5DX0hBTkdJTkdfU1RBVEVNRU5UID0gMiwgRlVOQ19OVUxMQUJMRV9JRCA9IDQ7XG5cbi8vIFBhcnNlIGEgZnVuY3Rpb24gZGVjbGFyYXRpb24gb3IgbGl0ZXJhbCAoZGVwZW5kaW5nIG9uIHRoZVxuLy8gYHN0YXRlbWVudCAmIEZVTkNfU1RBVEVNRU5UYCkuXG5cbi8vIFJlbW92ZSBgYWxsb3dFeHByZXNzaW9uQm9keWAgZm9yIDcuMC4wLCBhcyBpdCBpcyBvbmx5IGNhbGxlZCB3aXRoIGZhbHNlXG5wcCQ4LnBhcnNlRnVuY3Rpb24gPSBmdW5jdGlvbihub2RlLCBzdGF0ZW1lbnQsIGFsbG93RXhwcmVzc2lvbkJvZHksIGlzQXN5bmMsIGZvckluaXQpIHtcbiAgdGhpcy5pbml0RnVuY3Rpb24obm9kZSk7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOSB8fCB0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gNiAmJiAhaXNBc3luYykge1xuICAgIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEuc3RhciAmJiAoc3RhdGVtZW50ICYgRlVOQ19IQU5HSU5HX1NUQVRFTUVOVCkpXG4gICAgICB7IHRoaXMudW5leHBlY3RlZCgpOyB9XG4gICAgbm9kZS5nZW5lcmF0b3IgPSB0aGlzLmVhdCh0eXBlcyQxLnN0YXIpO1xuICB9XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOClcbiAgICB7IG5vZGUuYXN5bmMgPSAhIWlzQXN5bmM7IH1cblxuICBpZiAoc3RhdGVtZW50ICYgRlVOQ19TVEFURU1FTlQpIHtcbiAgICBub2RlLmlkID0gKHN0YXRlbWVudCAmIEZVTkNfTlVMTEFCTEVfSUQpICYmIHRoaXMudHlwZSAhPT0gdHlwZXMkMS5uYW1lID8gbnVsbCA6IHRoaXMucGFyc2VJZGVudCgpO1xuICAgIGlmIChub2RlLmlkICYmICEoc3RhdGVtZW50ICYgRlVOQ19IQU5HSU5HX1NUQVRFTUVOVCkpXG4gICAgICAvLyBJZiBpdCBpcyBhIHJlZ3VsYXIgZnVuY3Rpb24gZGVjbGFyYXRpb24gaW4gc2xvcHB5IG1vZGUsIHRoZW4gaXQgaXNcbiAgICAgIC8vIHN1YmplY3QgdG8gQW5uZXggQiBzZW1hbnRpY3MgKEJJTkRfRlVOQ1RJT04pLiBPdGhlcndpc2UsIHRoZSBiaW5kaW5nXG4gICAgICAvLyBtb2RlIGRlcGVuZHMgb24gcHJvcGVydGllcyBvZiB0aGUgY3VycmVudCBzY29wZSAoc2VlXG4gICAgICAvLyB0cmVhdEZ1bmN0aW9uc0FzVmFyKS5cbiAgICAgIHsgdGhpcy5jaGVja0xWYWxTaW1wbGUobm9kZS5pZCwgKHRoaXMuc3RyaWN0IHx8IG5vZGUuZ2VuZXJhdG9yIHx8IG5vZGUuYXN5bmMpID8gdGhpcy50cmVhdEZ1bmN0aW9uc0FzVmFyID8gQklORF9WQVIgOiBCSU5EX0xFWElDQUwgOiBCSU5EX0ZVTkNUSU9OKTsgfVxuICB9XG5cbiAgdmFyIG9sZFlpZWxkUG9zID0gdGhpcy55aWVsZFBvcywgb2xkQXdhaXRQb3MgPSB0aGlzLmF3YWl0UG9zLCBvbGRBd2FpdElkZW50UG9zID0gdGhpcy5hd2FpdElkZW50UG9zO1xuICB0aGlzLnlpZWxkUG9zID0gMDtcbiAgdGhpcy5hd2FpdFBvcyA9IDA7XG4gIHRoaXMuYXdhaXRJZGVudFBvcyA9IDA7XG4gIHRoaXMuZW50ZXJTY29wZShmdW5jdGlvbkZsYWdzKG5vZGUuYXN5bmMsIG5vZGUuZ2VuZXJhdG9yKSk7XG5cbiAgaWYgKCEoc3RhdGVtZW50ICYgRlVOQ19TVEFURU1FTlQpKVxuICAgIHsgbm9kZS5pZCA9IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5uYW1lID8gdGhpcy5wYXJzZUlkZW50KCkgOiBudWxsOyB9XG5cbiAgdGhpcy5wYXJzZUZ1bmN0aW9uUGFyYW1zKG5vZGUpO1xuICB0aGlzLnBhcnNlRnVuY3Rpb25Cb2R5KG5vZGUsIGFsbG93RXhwcmVzc2lvbkJvZHksIGZhbHNlLCBmb3JJbml0KTtcblxuICB0aGlzLnlpZWxkUG9zID0gb2xkWWllbGRQb3M7XG4gIHRoaXMuYXdhaXRQb3MgPSBvbGRBd2FpdFBvcztcbiAgdGhpcy5hd2FpdElkZW50UG9zID0gb2xkQXdhaXRJZGVudFBvcztcbiAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCAoc3RhdGVtZW50ICYgRlVOQ19TVEFURU1FTlQpID8gXCJGdW5jdGlvbkRlY2xhcmF0aW9uXCIgOiBcIkZ1bmN0aW9uRXhwcmVzc2lvblwiKVxufTtcblxucHAkOC5wYXJzZUZ1bmN0aW9uUGFyYW1zID0gZnVuY3Rpb24obm9kZSkge1xuICB0aGlzLmV4cGVjdCh0eXBlcyQxLnBhcmVuTCk7XG4gIG5vZGUucGFyYW1zID0gdGhpcy5wYXJzZUJpbmRpbmdMaXN0KHR5cGVzJDEucGFyZW5SLCBmYWxzZSwgdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDgpO1xuICB0aGlzLmNoZWNrWWllbGRBd2FpdEluRGVmYXVsdFBhcmFtcygpO1xufTtcblxuLy8gUGFyc2UgYSBjbGFzcyBkZWNsYXJhdGlvbiBvciBsaXRlcmFsIChkZXBlbmRpbmcgb24gdGhlXG4vLyBgaXNTdGF0ZW1lbnRgIHBhcmFtZXRlcikuXG5cbnBwJDgucGFyc2VDbGFzcyA9IGZ1bmN0aW9uKG5vZGUsIGlzU3RhdGVtZW50KSB7XG4gIHRoaXMubmV4dCgpO1xuXG4gIC8vIGVjbWEtMjYyIDE0LjYgQ2xhc3MgRGVmaW5pdGlvbnNcbiAgLy8gQSBjbGFzcyBkZWZpbml0aW9uIGlzIGFsd2F5cyBzdHJpY3QgbW9kZSBjb2RlLlxuICB2YXIgb2xkU3RyaWN0ID0gdGhpcy5zdHJpY3Q7XG4gIHRoaXMuc3RyaWN0ID0gdHJ1ZTtcblxuICB0aGlzLnBhcnNlQ2xhc3NJZChub2RlLCBpc1N0YXRlbWVudCk7XG4gIHRoaXMucGFyc2VDbGFzc1N1cGVyKG5vZGUpO1xuICB2YXIgcHJpdmF0ZU5hbWVNYXAgPSB0aGlzLmVudGVyQ2xhc3NCb2R5KCk7XG4gIHZhciBjbGFzc0JvZHkgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICB2YXIgaGFkQ29uc3RydWN0b3IgPSBmYWxzZTtcbiAgY2xhc3NCb2R5LmJvZHkgPSBbXTtcbiAgdGhpcy5leHBlY3QodHlwZXMkMS5icmFjZUwpO1xuICB3aGlsZSAodGhpcy50eXBlICE9PSB0eXBlcyQxLmJyYWNlUikge1xuICAgIHZhciBlbGVtZW50ID0gdGhpcy5wYXJzZUNsYXNzRWxlbWVudChub2RlLnN1cGVyQ2xhc3MgIT09IG51bGwpO1xuICAgIGlmIChlbGVtZW50KSB7XG4gICAgICBjbGFzc0JvZHkuYm9keS5wdXNoKGVsZW1lbnQpO1xuICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PT0gXCJNZXRob2REZWZpbml0aW9uXCIgJiYgZWxlbWVudC5raW5kID09PSBcImNvbnN0cnVjdG9yXCIpIHtcbiAgICAgICAgaWYgKGhhZENvbnN0cnVjdG9yKSB7IHRoaXMucmFpc2UoZWxlbWVudC5zdGFydCwgXCJEdXBsaWNhdGUgY29uc3RydWN0b3IgaW4gdGhlIHNhbWUgY2xhc3NcIik7IH1cbiAgICAgICAgaGFkQ29uc3RydWN0b3IgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmIChlbGVtZW50LmtleSAmJiBlbGVtZW50LmtleS50eXBlID09PSBcIlByaXZhdGVJZGVudGlmaWVyXCIgJiYgaXNQcml2YXRlTmFtZUNvbmZsaWN0ZWQocHJpdmF0ZU5hbWVNYXAsIGVsZW1lbnQpKSB7XG4gICAgICAgIHRoaXMucmFpc2VSZWNvdmVyYWJsZShlbGVtZW50LmtleS5zdGFydCwgKFwiSWRlbnRpZmllciAnI1wiICsgKGVsZW1lbnQua2V5Lm5hbWUpICsgXCInIGhhcyBhbHJlYWR5IGJlZW4gZGVjbGFyZWRcIikpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICB0aGlzLnN0cmljdCA9IG9sZFN0cmljdDtcbiAgdGhpcy5uZXh0KCk7XG4gIG5vZGUuYm9keSA9IHRoaXMuZmluaXNoTm9kZShjbGFzc0JvZHksIFwiQ2xhc3NCb2R5XCIpO1xuICB0aGlzLmV4aXRDbGFzc0JvZHkoKTtcbiAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCBpc1N0YXRlbWVudCA/IFwiQ2xhc3NEZWNsYXJhdGlvblwiIDogXCJDbGFzc0V4cHJlc3Npb25cIilcbn07XG5cbnBwJDgucGFyc2VDbGFzc0VsZW1lbnQgPSBmdW5jdGlvbihjb25zdHJ1Y3RvckFsbG93c1N1cGVyKSB7XG4gIGlmICh0aGlzLmVhdCh0eXBlcyQxLnNlbWkpKSB7IHJldHVybiBudWxsIH1cblxuICB2YXIgZWNtYVZlcnNpb24gPSB0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb247XG4gIHZhciBub2RlID0gdGhpcy5zdGFydE5vZGUoKTtcbiAgdmFyIGtleU5hbWUgPSBcIlwiO1xuICB2YXIgaXNHZW5lcmF0b3IgPSBmYWxzZTtcbiAgdmFyIGlzQXN5bmMgPSBmYWxzZTtcbiAgdmFyIGtpbmQgPSBcIm1ldGhvZFwiO1xuICB2YXIgaXNTdGF0aWMgPSBmYWxzZTtcblxuICBpZiAodGhpcy5lYXRDb250ZXh0dWFsKFwic3RhdGljXCIpKSB7XG4gICAgLy8gUGFyc2Ugc3RhdGljIGluaXQgYmxvY2tcbiAgICBpZiAoZWNtYVZlcnNpb24gPj0gMTMgJiYgdGhpcy5lYXQodHlwZXMkMS5icmFjZUwpKSB7XG4gICAgICB0aGlzLnBhcnNlQ2xhc3NTdGF0aWNCbG9jayhub2RlKTtcbiAgICAgIHJldHVybiBub2RlXG4gICAgfVxuICAgIGlmICh0aGlzLmlzQ2xhc3NFbGVtZW50TmFtZVN0YXJ0KCkgfHwgdGhpcy50eXBlID09PSB0eXBlcyQxLnN0YXIpIHtcbiAgICAgIGlzU3RhdGljID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAga2V5TmFtZSA9IFwic3RhdGljXCI7XG4gICAgfVxuICB9XG4gIG5vZGUuc3RhdGljID0gaXNTdGF0aWM7XG4gIGlmICgha2V5TmFtZSAmJiBlY21hVmVyc2lvbiA+PSA4ICYmIHRoaXMuZWF0Q29udGV4dHVhbChcImFzeW5jXCIpKSB7XG4gICAgaWYgKCh0aGlzLmlzQ2xhc3NFbGVtZW50TmFtZVN0YXJ0KCkgfHwgdGhpcy50eXBlID09PSB0eXBlcyQxLnN0YXIpICYmICF0aGlzLmNhbkluc2VydFNlbWljb2xvbigpKSB7XG4gICAgICBpc0FzeW5jID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAga2V5TmFtZSA9IFwiYXN5bmNcIjtcbiAgICB9XG4gIH1cbiAgaWYgKCFrZXlOYW1lICYmIChlY21hVmVyc2lvbiA+PSA5IHx8ICFpc0FzeW5jKSAmJiB0aGlzLmVhdCh0eXBlcyQxLnN0YXIpKSB7XG4gICAgaXNHZW5lcmF0b3IgPSB0cnVlO1xuICB9XG4gIGlmICgha2V5TmFtZSAmJiAhaXNBc3luYyAmJiAhaXNHZW5lcmF0b3IpIHtcbiAgICB2YXIgbGFzdFZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICBpZiAodGhpcy5lYXRDb250ZXh0dWFsKFwiZ2V0XCIpIHx8IHRoaXMuZWF0Q29udGV4dHVhbChcInNldFwiKSkge1xuICAgICAgaWYgKHRoaXMuaXNDbGFzc0VsZW1lbnROYW1lU3RhcnQoKSkge1xuICAgICAgICBraW5kID0gbGFzdFZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAga2V5TmFtZSA9IGxhc3RWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBQYXJzZSBlbGVtZW50IG5hbWVcbiAgaWYgKGtleU5hbWUpIHtcbiAgICAvLyAnYXN5bmMnLCAnZ2V0JywgJ3NldCcsIG9yICdzdGF0aWMnIHdlcmUgbm90IGEga2V5d29yZCBjb250ZXh0dWFsbHkuXG4gICAgLy8gVGhlIGxhc3QgdG9rZW4gaXMgYW55IG9mIHRob3NlLiBNYWtlIGl0IHRoZSBlbGVtZW50IG5hbWUuXG4gICAgbm9kZS5jb21wdXRlZCA9IGZhbHNlO1xuICAgIG5vZGUua2V5ID0gdGhpcy5zdGFydE5vZGVBdCh0aGlzLmxhc3RUb2tTdGFydCwgdGhpcy5sYXN0VG9rU3RhcnRMb2MpO1xuICAgIG5vZGUua2V5Lm5hbWUgPSBrZXlOYW1lO1xuICAgIHRoaXMuZmluaXNoTm9kZShub2RlLmtleSwgXCJJZGVudGlmaWVyXCIpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMucGFyc2VDbGFzc0VsZW1lbnROYW1lKG5vZGUpO1xuICB9XG5cbiAgLy8gUGFyc2UgZWxlbWVudCB2YWx1ZVxuICBpZiAoZWNtYVZlcnNpb24gPCAxMyB8fCB0aGlzLnR5cGUgPT09IHR5cGVzJDEucGFyZW5MIHx8IGtpbmQgIT09IFwibWV0aG9kXCIgfHwgaXNHZW5lcmF0b3IgfHwgaXNBc3luYykge1xuICAgIHZhciBpc0NvbnN0cnVjdG9yID0gIW5vZGUuc3RhdGljICYmIGNoZWNrS2V5TmFtZShub2RlLCBcImNvbnN0cnVjdG9yXCIpO1xuICAgIHZhciBhbGxvd3NEaXJlY3RTdXBlciA9IGlzQ29uc3RydWN0b3IgJiYgY29uc3RydWN0b3JBbGxvd3NTdXBlcjtcbiAgICAvLyBDb3VsZG4ndCBtb3ZlIHRoaXMgY2hlY2sgaW50byB0aGUgJ3BhcnNlQ2xhc3NNZXRob2QnIG1ldGhvZCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eS5cbiAgICBpZiAoaXNDb25zdHJ1Y3RvciAmJiBraW5kICE9PSBcIm1ldGhvZFwiKSB7IHRoaXMucmFpc2Uobm9kZS5rZXkuc3RhcnQsIFwiQ29uc3RydWN0b3IgY2FuJ3QgaGF2ZSBnZXQvc2V0IG1vZGlmaWVyXCIpOyB9XG4gICAgbm9kZS5raW5kID0gaXNDb25zdHJ1Y3RvciA/IFwiY29uc3RydWN0b3JcIiA6IGtpbmQ7XG4gICAgdGhpcy5wYXJzZUNsYXNzTWV0aG9kKG5vZGUsIGlzR2VuZXJhdG9yLCBpc0FzeW5jLCBhbGxvd3NEaXJlY3RTdXBlcik7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5wYXJzZUNsYXNzRmllbGQobm9kZSk7XG4gIH1cblxuICByZXR1cm4gbm9kZVxufTtcblxucHAkOC5pc0NsYXNzRWxlbWVudE5hbWVTdGFydCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gKFxuICAgIHRoaXMudHlwZSA9PT0gdHlwZXMkMS5uYW1lIHx8XG4gICAgdGhpcy50eXBlID09PSB0eXBlcyQxLnByaXZhdGVJZCB8fFxuICAgIHRoaXMudHlwZSA9PT0gdHlwZXMkMS5udW0gfHxcbiAgICB0aGlzLnR5cGUgPT09IHR5cGVzJDEuc3RyaW5nIHx8XG4gICAgdGhpcy50eXBlID09PSB0eXBlcyQxLmJyYWNrZXRMIHx8XG4gICAgdGhpcy50eXBlLmtleXdvcmRcbiAgKVxufTtcblxucHAkOC5wYXJzZUNsYXNzRWxlbWVudE5hbWUgPSBmdW5jdGlvbihlbGVtZW50KSB7XG4gIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEucHJpdmF0ZUlkKSB7XG4gICAgaWYgKHRoaXMudmFsdWUgPT09IFwiY29uc3RydWN0b3JcIikge1xuICAgICAgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIkNsYXNzZXMgY2FuJ3QgaGF2ZSBhbiBlbGVtZW50IG5hbWVkICcjY29uc3RydWN0b3InXCIpO1xuICAgIH1cbiAgICBlbGVtZW50LmNvbXB1dGVkID0gZmFsc2U7XG4gICAgZWxlbWVudC5rZXkgPSB0aGlzLnBhcnNlUHJpdmF0ZUlkZW50KCk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5wYXJzZVByb3BlcnR5TmFtZShlbGVtZW50KTtcbiAgfVxufTtcblxucHAkOC5wYXJzZUNsYXNzTWV0aG9kID0gZnVuY3Rpb24obWV0aG9kLCBpc0dlbmVyYXRvciwgaXNBc3luYywgYWxsb3dzRGlyZWN0U3VwZXIpIHtcbiAgLy8gQ2hlY2sga2V5IGFuZCBmbGFnc1xuICB2YXIga2V5ID0gbWV0aG9kLmtleTtcbiAgaWYgKG1ldGhvZC5raW5kID09PSBcImNvbnN0cnVjdG9yXCIpIHtcbiAgICBpZiAoaXNHZW5lcmF0b3IpIHsgdGhpcy5yYWlzZShrZXkuc3RhcnQsIFwiQ29uc3RydWN0b3IgY2FuJ3QgYmUgYSBnZW5lcmF0b3JcIik7IH1cbiAgICBpZiAoaXNBc3luYykgeyB0aGlzLnJhaXNlKGtleS5zdGFydCwgXCJDb25zdHJ1Y3RvciBjYW4ndCBiZSBhbiBhc3luYyBtZXRob2RcIik7IH1cbiAgfSBlbHNlIGlmIChtZXRob2Quc3RhdGljICYmIGNoZWNrS2V5TmFtZShtZXRob2QsIFwicHJvdG90eXBlXCIpKSB7XG4gICAgdGhpcy5yYWlzZShrZXkuc3RhcnQsIFwiQ2xhc3NlcyBtYXkgbm90IGhhdmUgYSBzdGF0aWMgcHJvcGVydHkgbmFtZWQgcHJvdG90eXBlXCIpO1xuICB9XG5cbiAgLy8gUGFyc2UgdmFsdWVcbiAgdmFyIHZhbHVlID0gbWV0aG9kLnZhbHVlID0gdGhpcy5wYXJzZU1ldGhvZChpc0dlbmVyYXRvciwgaXNBc3luYywgYWxsb3dzRGlyZWN0U3VwZXIpO1xuXG4gIC8vIENoZWNrIHZhbHVlXG4gIGlmIChtZXRob2Qua2luZCA9PT0gXCJnZXRcIiAmJiB2YWx1ZS5wYXJhbXMubGVuZ3RoICE9PSAwKVxuICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKHZhbHVlLnN0YXJ0LCBcImdldHRlciBzaG91bGQgaGF2ZSBubyBwYXJhbXNcIik7IH1cbiAgaWYgKG1ldGhvZC5raW5kID09PSBcInNldFwiICYmIHZhbHVlLnBhcmFtcy5sZW5ndGggIT09IDEpXG4gICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUodmFsdWUuc3RhcnQsIFwic2V0dGVyIHNob3VsZCBoYXZlIGV4YWN0bHkgb25lIHBhcmFtXCIpOyB9XG4gIGlmIChtZXRob2Qua2luZCA9PT0gXCJzZXRcIiAmJiB2YWx1ZS5wYXJhbXNbMF0udHlwZSA9PT0gXCJSZXN0RWxlbWVudFwiKVxuICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKHZhbHVlLnBhcmFtc1swXS5zdGFydCwgXCJTZXR0ZXIgY2Fubm90IHVzZSByZXN0IHBhcmFtc1wiKTsgfVxuXG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobWV0aG9kLCBcIk1ldGhvZERlZmluaXRpb25cIilcbn07XG5cbnBwJDgucGFyc2VDbGFzc0ZpZWxkID0gZnVuY3Rpb24oZmllbGQpIHtcbiAgaWYgKGNoZWNrS2V5TmFtZShmaWVsZCwgXCJjb25zdHJ1Y3RvclwiKSkge1xuICAgIHRoaXMucmFpc2UoZmllbGQua2V5LnN0YXJ0LCBcIkNsYXNzZXMgY2FuJ3QgaGF2ZSBhIGZpZWxkIG5hbWVkICdjb25zdHJ1Y3RvcidcIik7XG4gIH0gZWxzZSBpZiAoZmllbGQuc3RhdGljICYmIGNoZWNrS2V5TmFtZShmaWVsZCwgXCJwcm90b3R5cGVcIikpIHtcbiAgICB0aGlzLnJhaXNlKGZpZWxkLmtleS5zdGFydCwgXCJDbGFzc2VzIGNhbid0IGhhdmUgYSBzdGF0aWMgZmllbGQgbmFtZWQgJ3Byb3RvdHlwZSdcIik7XG4gIH1cblxuICBpZiAodGhpcy5lYXQodHlwZXMkMS5lcSkpIHtcbiAgICAvLyBUbyByYWlzZSBTeW50YXhFcnJvciBpZiAnYXJndW1lbnRzJyBleGlzdHMgaW4gdGhlIGluaXRpYWxpemVyLlxuICAgIHZhciBzY29wZSA9IHRoaXMuY3VycmVudFRoaXNTY29wZSgpO1xuICAgIHZhciBpbkNsYXNzRmllbGRJbml0ID0gc2NvcGUuaW5DbGFzc0ZpZWxkSW5pdDtcbiAgICBzY29wZS5pbkNsYXNzRmllbGRJbml0ID0gdHJ1ZTtcbiAgICBmaWVsZC52YWx1ZSA9IHRoaXMucGFyc2VNYXliZUFzc2lnbigpO1xuICAgIHNjb3BlLmluQ2xhc3NGaWVsZEluaXQgPSBpbkNsYXNzRmllbGRJbml0O1xuICB9IGVsc2Uge1xuICAgIGZpZWxkLnZhbHVlID0gbnVsbDtcbiAgfVxuICB0aGlzLnNlbWljb2xvbigpO1xuXG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUoZmllbGQsIFwiUHJvcGVydHlEZWZpbml0aW9uXCIpXG59O1xuXG5wcCQ4LnBhcnNlQ2xhc3NTdGF0aWNCbG9jayA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgbm9kZS5ib2R5ID0gW107XG5cbiAgdmFyIG9sZExhYmVscyA9IHRoaXMubGFiZWxzO1xuICB0aGlzLmxhYmVscyA9IFtdO1xuICB0aGlzLmVudGVyU2NvcGUoU0NPUEVfQ0xBU1NfU1RBVElDX0JMT0NLIHwgU0NPUEVfU1VQRVIpO1xuICB3aGlsZSAodGhpcy50eXBlICE9PSB0eXBlcyQxLmJyYWNlUikge1xuICAgIHZhciBzdG10ID0gdGhpcy5wYXJzZVN0YXRlbWVudChudWxsKTtcbiAgICBub2RlLmJvZHkucHVzaChzdG10KTtcbiAgfVxuICB0aGlzLm5leHQoKTtcbiAgdGhpcy5leGl0U2NvcGUoKTtcbiAgdGhpcy5sYWJlbHMgPSBvbGRMYWJlbHM7XG5cbiAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCBcIlN0YXRpY0Jsb2NrXCIpXG59O1xuXG5wcCQ4LnBhcnNlQ2xhc3NJZCA9IGZ1bmN0aW9uKG5vZGUsIGlzU3RhdGVtZW50KSB7XG4gIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEubmFtZSkge1xuICAgIG5vZGUuaWQgPSB0aGlzLnBhcnNlSWRlbnQoKTtcbiAgICBpZiAoaXNTdGF0ZW1lbnQpXG4gICAgICB7IHRoaXMuY2hlY2tMVmFsU2ltcGxlKG5vZGUuaWQsIEJJTkRfTEVYSUNBTCwgZmFsc2UpOyB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGlzU3RhdGVtZW50ID09PSB0cnVlKVxuICAgICAgeyB0aGlzLnVuZXhwZWN0ZWQoKTsgfVxuICAgIG5vZGUuaWQgPSBudWxsO1xuICB9XG59O1xuXG5wcCQ4LnBhcnNlQ2xhc3NTdXBlciA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgbm9kZS5zdXBlckNsYXNzID0gdGhpcy5lYXQodHlwZXMkMS5fZXh0ZW5kcykgPyB0aGlzLnBhcnNlRXhwclN1YnNjcmlwdHMoZmFsc2UpIDogbnVsbDtcbn07XG5cbnBwJDguZW50ZXJDbGFzc0JvZHkgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGVsZW1lbnQgPSB7ZGVjbGFyZWQ6IE9iamVjdC5jcmVhdGUobnVsbCksIHVzZWQ6IFtdfTtcbiAgdGhpcy5wcml2YXRlTmFtZVN0YWNrLnB1c2goZWxlbWVudCk7XG4gIHJldHVybiBlbGVtZW50LmRlY2xhcmVkXG59O1xuXG5wcCQ4LmV4aXRDbGFzc0JvZHkgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHJlZiA9IHRoaXMucHJpdmF0ZU5hbWVTdGFjay5wb3AoKTtcbiAgdmFyIGRlY2xhcmVkID0gcmVmLmRlY2xhcmVkO1xuICB2YXIgdXNlZCA9IHJlZi51c2VkO1xuICB2YXIgbGVuID0gdGhpcy5wcml2YXRlTmFtZVN0YWNrLmxlbmd0aDtcbiAgdmFyIHBhcmVudCA9IGxlbiA9PT0gMCA/IG51bGwgOiB0aGlzLnByaXZhdGVOYW1lU3RhY2tbbGVuIC0gMV07XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdXNlZC5sZW5ndGg7ICsraSkge1xuICAgIHZhciBpZCA9IHVzZWRbaV07XG4gICAgaWYgKCFoYXNPd24oZGVjbGFyZWQsIGlkLm5hbWUpKSB7XG4gICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgIHBhcmVudC51c2VkLnB1c2goaWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yYWlzZVJlY292ZXJhYmxlKGlkLnN0YXJ0LCAoXCJQcml2YXRlIGZpZWxkICcjXCIgKyAoaWQubmFtZSkgKyBcIicgbXVzdCBiZSBkZWNsYXJlZCBpbiBhbiBlbmNsb3NpbmcgY2xhc3NcIikpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gaXNQcml2YXRlTmFtZUNvbmZsaWN0ZWQocHJpdmF0ZU5hbWVNYXAsIGVsZW1lbnQpIHtcbiAgdmFyIG5hbWUgPSBlbGVtZW50LmtleS5uYW1lO1xuICB2YXIgY3VyciA9IHByaXZhdGVOYW1lTWFwW25hbWVdO1xuXG4gIHZhciBuZXh0ID0gXCJ0cnVlXCI7XG4gIGlmIChlbGVtZW50LnR5cGUgPT09IFwiTWV0aG9kRGVmaW5pdGlvblwiICYmIChlbGVtZW50LmtpbmQgPT09IFwiZ2V0XCIgfHwgZWxlbWVudC5raW5kID09PSBcInNldFwiKSkge1xuICAgIG5leHQgPSAoZWxlbWVudC5zdGF0aWMgPyBcInNcIiA6IFwiaVwiKSArIGVsZW1lbnQua2luZDtcbiAgfVxuXG4gIC8vIGBjbGFzcyB7IGdldCAjYSgpe307IHN0YXRpYyBzZXQgI2EoXyl7fSB9YCBpcyBhbHNvIGNvbmZsaWN0LlxuICBpZiAoXG4gICAgY3VyciA9PT0gXCJpZ2V0XCIgJiYgbmV4dCA9PT0gXCJpc2V0XCIgfHxcbiAgICBjdXJyID09PSBcImlzZXRcIiAmJiBuZXh0ID09PSBcImlnZXRcIiB8fFxuICAgIGN1cnIgPT09IFwic2dldFwiICYmIG5leHQgPT09IFwic3NldFwiIHx8XG4gICAgY3VyciA9PT0gXCJzc2V0XCIgJiYgbmV4dCA9PT0gXCJzZ2V0XCJcbiAgKSB7XG4gICAgcHJpdmF0ZU5hbWVNYXBbbmFtZV0gPSBcInRydWVcIjtcbiAgICByZXR1cm4gZmFsc2VcbiAgfSBlbHNlIGlmICghY3Vycikge1xuICAgIHByaXZhdGVOYW1lTWFwW25hbWVdID0gbmV4dDtcbiAgICByZXR1cm4gZmFsc2VcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrS2V5TmFtZShub2RlLCBuYW1lKSB7XG4gIHZhciBjb21wdXRlZCA9IG5vZGUuY29tcHV0ZWQ7XG4gIHZhciBrZXkgPSBub2RlLmtleTtcbiAgcmV0dXJuICFjb21wdXRlZCAmJiAoXG4gICAga2V5LnR5cGUgPT09IFwiSWRlbnRpZmllclwiICYmIGtleS5uYW1lID09PSBuYW1lIHx8XG4gICAga2V5LnR5cGUgPT09IFwiTGl0ZXJhbFwiICYmIGtleS52YWx1ZSA9PT0gbmFtZVxuICApXG59XG5cbi8vIFBhcnNlcyBtb2R1bGUgZXhwb3J0IGRlY2xhcmF0aW9uLlxuXG5wcCQ4LnBhcnNlRXhwb3J0ID0gZnVuY3Rpb24obm9kZSwgZXhwb3J0cykge1xuICB0aGlzLm5leHQoKTtcbiAgLy8gZXhwb3J0ICogZnJvbSAnLi4uJ1xuICBpZiAodGhpcy5lYXQodHlwZXMkMS5zdGFyKSkge1xuICAgIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gMTEpIHtcbiAgICAgIGlmICh0aGlzLmVhdENvbnRleHR1YWwoXCJhc1wiKSkge1xuICAgICAgICBub2RlLmV4cG9ydGVkID0gdGhpcy5wYXJzZU1vZHVsZUV4cG9ydE5hbWUoKTtcbiAgICAgICAgdGhpcy5jaGVja0V4cG9ydChleHBvcnRzLCBub2RlLmV4cG9ydGVkLCB0aGlzLmxhc3RUb2tTdGFydCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlLmV4cG9ydGVkID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5leHBlY3RDb250ZXh0dWFsKFwiZnJvbVwiKTtcbiAgICBpZiAodGhpcy50eXBlICE9PSB0eXBlcyQxLnN0cmluZykgeyB0aGlzLnVuZXhwZWN0ZWQoKTsgfVxuICAgIG5vZGUuc291cmNlID0gdGhpcy5wYXJzZUV4cHJBdG9tKCk7XG4gICAgdGhpcy5zZW1pY29sb24oKTtcbiAgICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiRXhwb3J0QWxsRGVjbGFyYXRpb25cIilcbiAgfVxuICBpZiAodGhpcy5lYXQodHlwZXMkMS5fZGVmYXVsdCkpIHsgLy8gZXhwb3J0IGRlZmF1bHQgLi4uXG4gICAgdGhpcy5jaGVja0V4cG9ydChleHBvcnRzLCBcImRlZmF1bHRcIiwgdGhpcy5sYXN0VG9rU3RhcnQpO1xuICAgIHZhciBpc0FzeW5jO1xuICAgIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEuX2Z1bmN0aW9uIHx8IChpc0FzeW5jID0gdGhpcy5pc0FzeW5jRnVuY3Rpb24oKSkpIHtcbiAgICAgIHZhciBmTm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gICAgICB0aGlzLm5leHQoKTtcbiAgICAgIGlmIChpc0FzeW5jKSB7IHRoaXMubmV4dCgpOyB9XG4gICAgICBub2RlLmRlY2xhcmF0aW9uID0gdGhpcy5wYXJzZUZ1bmN0aW9uKGZOb2RlLCBGVU5DX1NUQVRFTUVOVCB8IEZVTkNfTlVMTEFCTEVfSUQsIGZhbHNlLCBpc0FzeW5jKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMudHlwZSA9PT0gdHlwZXMkMS5fY2xhc3MpIHtcbiAgICAgIHZhciBjTm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gICAgICBub2RlLmRlY2xhcmF0aW9uID0gdGhpcy5wYXJzZUNsYXNzKGNOb2RlLCBcIm51bGxhYmxlSURcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5vZGUuZGVjbGFyYXRpb24gPSB0aGlzLnBhcnNlTWF5YmVBc3NpZ24oKTtcbiAgICAgIHRoaXMuc2VtaWNvbG9uKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJFeHBvcnREZWZhdWx0RGVjbGFyYXRpb25cIilcbiAgfVxuICAvLyBleHBvcnQgdmFyfGNvbnN0fGxldHxmdW5jdGlvbnxjbGFzcyAuLi5cbiAgaWYgKHRoaXMuc2hvdWxkUGFyc2VFeHBvcnRTdGF0ZW1lbnQoKSkge1xuICAgIG5vZGUuZGVjbGFyYXRpb24gPSB0aGlzLnBhcnNlU3RhdGVtZW50KG51bGwpO1xuICAgIGlmIChub2RlLmRlY2xhcmF0aW9uLnR5cGUgPT09IFwiVmFyaWFibGVEZWNsYXJhdGlvblwiKVxuICAgICAgeyB0aGlzLmNoZWNrVmFyaWFibGVFeHBvcnQoZXhwb3J0cywgbm9kZS5kZWNsYXJhdGlvbi5kZWNsYXJhdGlvbnMpOyB9XG4gICAgZWxzZVxuICAgICAgeyB0aGlzLmNoZWNrRXhwb3J0KGV4cG9ydHMsIG5vZGUuZGVjbGFyYXRpb24uaWQsIG5vZGUuZGVjbGFyYXRpb24uaWQuc3RhcnQpOyB9XG4gICAgbm9kZS5zcGVjaWZpZXJzID0gW107XG4gICAgbm9kZS5zb3VyY2UgPSBudWxsO1xuICB9IGVsc2UgeyAvLyBleHBvcnQgeyB4LCB5IGFzIHogfSBbZnJvbSAnLi4uJ11cbiAgICBub2RlLmRlY2xhcmF0aW9uID0gbnVsbDtcbiAgICBub2RlLnNwZWNpZmllcnMgPSB0aGlzLnBhcnNlRXhwb3J0U3BlY2lmaWVycyhleHBvcnRzKTtcbiAgICBpZiAodGhpcy5lYXRDb250ZXh0dWFsKFwiZnJvbVwiKSkge1xuICAgICAgaWYgKHRoaXMudHlwZSAhPT0gdHlwZXMkMS5zdHJpbmcpIHsgdGhpcy51bmV4cGVjdGVkKCk7IH1cbiAgICAgIG5vZGUuc291cmNlID0gdGhpcy5wYXJzZUV4cHJBdG9tKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsaXN0ID0gbm9kZS5zcGVjaWZpZXJzOyBpIDwgbGlzdC5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAvLyBjaGVjayBmb3Iga2V5d29yZHMgdXNlZCBhcyBsb2NhbCBuYW1lc1xuICAgICAgICB2YXIgc3BlYyA9IGxpc3RbaV07XG5cbiAgICAgICAgdGhpcy5jaGVja1VucmVzZXJ2ZWQoc3BlYy5sb2NhbCk7XG4gICAgICAgIC8vIGNoZWNrIGlmIGV4cG9ydCBpcyBkZWZpbmVkXG4gICAgICAgIHRoaXMuY2hlY2tMb2NhbEV4cG9ydChzcGVjLmxvY2FsKTtcblxuICAgICAgICBpZiAoc3BlYy5sb2NhbC50eXBlID09PSBcIkxpdGVyYWxcIikge1xuICAgICAgICAgIHRoaXMucmFpc2Uoc3BlYy5sb2NhbC5zdGFydCwgXCJBIHN0cmluZyBsaXRlcmFsIGNhbm5vdCBiZSB1c2VkIGFzIGFuIGV4cG9ydGVkIGJpbmRpbmcgd2l0aG91dCBgZnJvbWAuXCIpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIG5vZGUuc291cmNlID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy5zZW1pY29sb24oKTtcbiAgfVxuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiRXhwb3J0TmFtZWREZWNsYXJhdGlvblwiKVxufTtcblxucHAkOC5jaGVja0V4cG9ydCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIHBvcykge1xuICBpZiAoIWV4cG9ydHMpIHsgcmV0dXJuIH1cbiAgaWYgKHR5cGVvZiBuYW1lICE9PSBcInN0cmluZ1wiKVxuICAgIHsgbmFtZSA9IG5hbWUudHlwZSA9PT0gXCJJZGVudGlmaWVyXCIgPyBuYW1lLm5hbWUgOiBuYW1lLnZhbHVlOyB9XG4gIGlmIChoYXNPd24oZXhwb3J0cywgbmFtZSkpXG4gICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUocG9zLCBcIkR1cGxpY2F0ZSBleHBvcnQgJ1wiICsgbmFtZSArIFwiJ1wiKTsgfVxuICBleHBvcnRzW25hbWVdID0gdHJ1ZTtcbn07XG5cbnBwJDguY2hlY2tQYXR0ZXJuRXhwb3J0ID0gZnVuY3Rpb24oZXhwb3J0cywgcGF0KSB7XG4gIHZhciB0eXBlID0gcGF0LnR5cGU7XG4gIGlmICh0eXBlID09PSBcIklkZW50aWZpZXJcIilcbiAgICB7IHRoaXMuY2hlY2tFeHBvcnQoZXhwb3J0cywgcGF0LCBwYXQuc3RhcnQpOyB9XG4gIGVsc2UgaWYgKHR5cGUgPT09IFwiT2JqZWN0UGF0dGVyblwiKVxuICAgIHsgZm9yICh2YXIgaSA9IDAsIGxpc3QgPSBwYXQucHJvcGVydGllczsgaSA8IGxpc3QubGVuZ3RoOyBpICs9IDEpXG4gICAgICB7XG4gICAgICAgIHZhciBwcm9wID0gbGlzdFtpXTtcblxuICAgICAgICB0aGlzLmNoZWNrUGF0dGVybkV4cG9ydChleHBvcnRzLCBwcm9wKTtcbiAgICAgIH0gfVxuICBlbHNlIGlmICh0eXBlID09PSBcIkFycmF5UGF0dGVyblwiKVxuICAgIHsgZm9yICh2YXIgaSQxID0gMCwgbGlzdCQxID0gcGF0LmVsZW1lbnRzOyBpJDEgPCBsaXN0JDEubGVuZ3RoOyBpJDEgKz0gMSkge1xuICAgICAgdmFyIGVsdCA9IGxpc3QkMVtpJDFdO1xuXG4gICAgICAgIGlmIChlbHQpIHsgdGhpcy5jaGVja1BhdHRlcm5FeHBvcnQoZXhwb3J0cywgZWx0KTsgfVxuICAgIH0gfVxuICBlbHNlIGlmICh0eXBlID09PSBcIlByb3BlcnR5XCIpXG4gICAgeyB0aGlzLmNoZWNrUGF0dGVybkV4cG9ydChleHBvcnRzLCBwYXQudmFsdWUpOyB9XG4gIGVsc2UgaWYgKHR5cGUgPT09IFwiQXNzaWdubWVudFBhdHRlcm5cIilcbiAgICB7IHRoaXMuY2hlY2tQYXR0ZXJuRXhwb3J0KGV4cG9ydHMsIHBhdC5sZWZ0KTsgfVxuICBlbHNlIGlmICh0eXBlID09PSBcIlJlc3RFbGVtZW50XCIpXG4gICAgeyB0aGlzLmNoZWNrUGF0dGVybkV4cG9ydChleHBvcnRzLCBwYXQuYXJndW1lbnQpOyB9XG4gIGVsc2UgaWYgKHR5cGUgPT09IFwiUGFyZW50aGVzaXplZEV4cHJlc3Npb25cIilcbiAgICB7IHRoaXMuY2hlY2tQYXR0ZXJuRXhwb3J0KGV4cG9ydHMsIHBhdC5leHByZXNzaW9uKTsgfVxufTtcblxucHAkOC5jaGVja1ZhcmlhYmxlRXhwb3J0ID0gZnVuY3Rpb24oZXhwb3J0cywgZGVjbHMpIHtcbiAgaWYgKCFleHBvcnRzKSB7IHJldHVybiB9XG4gIGZvciAodmFyIGkgPSAwLCBsaXN0ID0gZGVjbHM7IGkgPCBsaXN0Lmxlbmd0aDsgaSArPSAxKVxuICAgIHtcbiAgICB2YXIgZGVjbCA9IGxpc3RbaV07XG5cbiAgICB0aGlzLmNoZWNrUGF0dGVybkV4cG9ydChleHBvcnRzLCBkZWNsLmlkKTtcbiAgfVxufTtcblxucHAkOC5zaG91bGRQYXJzZUV4cG9ydFN0YXRlbWVudCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy50eXBlLmtleXdvcmQgPT09IFwidmFyXCIgfHxcbiAgICB0aGlzLnR5cGUua2V5d29yZCA9PT0gXCJjb25zdFwiIHx8XG4gICAgdGhpcy50eXBlLmtleXdvcmQgPT09IFwiY2xhc3NcIiB8fFxuICAgIHRoaXMudHlwZS5rZXl3b3JkID09PSBcImZ1bmN0aW9uXCIgfHxcbiAgICB0aGlzLmlzTGV0KCkgfHxcbiAgICB0aGlzLmlzQXN5bmNGdW5jdGlvbigpXG59O1xuXG4vLyBQYXJzZXMgYSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBtb2R1bGUgZXhwb3J0cy5cblxucHAkOC5wYXJzZUV4cG9ydFNwZWNpZmllcnMgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gIHZhciBub2RlcyA9IFtdLCBmaXJzdCA9IHRydWU7XG4gIC8vIGV4cG9ydCB7IHgsIHkgYXMgeiB9IFtmcm9tICcuLi4nXVxuICB0aGlzLmV4cGVjdCh0eXBlcyQxLmJyYWNlTCk7XG4gIHdoaWxlICghdGhpcy5lYXQodHlwZXMkMS5icmFjZVIpKSB7XG4gICAgaWYgKCFmaXJzdCkge1xuICAgICAgdGhpcy5leHBlY3QodHlwZXMkMS5jb21tYSk7XG4gICAgICBpZiAodGhpcy5hZnRlclRyYWlsaW5nQ29tbWEodHlwZXMkMS5icmFjZVIpKSB7IGJyZWFrIH1cbiAgICB9IGVsc2UgeyBmaXJzdCA9IGZhbHNlOyB9XG5cbiAgICB2YXIgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gICAgbm9kZS5sb2NhbCA9IHRoaXMucGFyc2VNb2R1bGVFeHBvcnROYW1lKCk7XG4gICAgbm9kZS5leHBvcnRlZCA9IHRoaXMuZWF0Q29udGV4dHVhbChcImFzXCIpID8gdGhpcy5wYXJzZU1vZHVsZUV4cG9ydE5hbWUoKSA6IG5vZGUubG9jYWw7XG4gICAgdGhpcy5jaGVja0V4cG9ydChcbiAgICAgIGV4cG9ydHMsXG4gICAgICBub2RlLmV4cG9ydGVkLFxuICAgICAgbm9kZS5leHBvcnRlZC5zdGFydFxuICAgICk7XG4gICAgbm9kZXMucHVzaCh0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJFeHBvcnRTcGVjaWZpZXJcIikpO1xuICB9XG4gIHJldHVybiBub2Rlc1xufTtcblxuLy8gUGFyc2VzIGltcG9ydCBkZWNsYXJhdGlvbi5cblxucHAkOC5wYXJzZUltcG9ydCA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgdGhpcy5uZXh0KCk7XG4gIC8vIGltcG9ydCAnLi4uJ1xuICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLnN0cmluZykge1xuICAgIG5vZGUuc3BlY2lmaWVycyA9IGVtcHR5JDE7XG4gICAgbm9kZS5zb3VyY2UgPSB0aGlzLnBhcnNlRXhwckF0b20oKTtcbiAgfSBlbHNlIHtcbiAgICBub2RlLnNwZWNpZmllcnMgPSB0aGlzLnBhcnNlSW1wb3J0U3BlY2lmaWVycygpO1xuICAgIHRoaXMuZXhwZWN0Q29udGV4dHVhbChcImZyb21cIik7XG4gICAgbm9kZS5zb3VyY2UgPSB0aGlzLnR5cGUgPT09IHR5cGVzJDEuc3RyaW5nID8gdGhpcy5wYXJzZUV4cHJBdG9tKCkgOiB0aGlzLnVuZXhwZWN0ZWQoKTtcbiAgfVxuICB0aGlzLnNlbWljb2xvbigpO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiSW1wb3J0RGVjbGFyYXRpb25cIilcbn07XG5cbi8vIFBhcnNlcyBhIGNvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIG1vZHVsZSBpbXBvcnRzLlxuXG5wcCQ4LnBhcnNlSW1wb3J0U3BlY2lmaWVycyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgbm9kZXMgPSBbXSwgZmlyc3QgPSB0cnVlO1xuICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLm5hbWUpIHtcbiAgICAvLyBpbXBvcnQgZGVmYXVsdE9iaiwgeyB4LCB5IGFzIHogfSBmcm9tICcuLi4nXG4gICAgdmFyIG5vZGUgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICAgIG5vZGUubG9jYWwgPSB0aGlzLnBhcnNlSWRlbnQoKTtcbiAgICB0aGlzLmNoZWNrTFZhbFNpbXBsZShub2RlLmxvY2FsLCBCSU5EX0xFWElDQUwpO1xuICAgIG5vZGVzLnB1c2godGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiSW1wb3J0RGVmYXVsdFNwZWNpZmllclwiKSk7XG4gICAgaWYgKCF0aGlzLmVhdCh0eXBlcyQxLmNvbW1hKSkgeyByZXR1cm4gbm9kZXMgfVxuICB9XG4gIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEuc3Rhcikge1xuICAgIHZhciBub2RlJDEgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICAgIHRoaXMubmV4dCgpO1xuICAgIHRoaXMuZXhwZWN0Q29udGV4dHVhbChcImFzXCIpO1xuICAgIG5vZGUkMS5sb2NhbCA9IHRoaXMucGFyc2VJZGVudCgpO1xuICAgIHRoaXMuY2hlY2tMVmFsU2ltcGxlKG5vZGUkMS5sb2NhbCwgQklORF9MRVhJQ0FMKTtcbiAgICBub2Rlcy5wdXNoKHRoaXMuZmluaXNoTm9kZShub2RlJDEsIFwiSW1wb3J0TmFtZXNwYWNlU3BlY2lmaWVyXCIpKTtcbiAgICByZXR1cm4gbm9kZXNcbiAgfVxuICB0aGlzLmV4cGVjdCh0eXBlcyQxLmJyYWNlTCk7XG4gIHdoaWxlICghdGhpcy5lYXQodHlwZXMkMS5icmFjZVIpKSB7XG4gICAgaWYgKCFmaXJzdCkge1xuICAgICAgdGhpcy5leHBlY3QodHlwZXMkMS5jb21tYSk7XG4gICAgICBpZiAodGhpcy5hZnRlclRyYWlsaW5nQ29tbWEodHlwZXMkMS5icmFjZVIpKSB7IGJyZWFrIH1cbiAgICB9IGVsc2UgeyBmaXJzdCA9IGZhbHNlOyB9XG5cbiAgICB2YXIgbm9kZSQyID0gdGhpcy5zdGFydE5vZGUoKTtcbiAgICBub2RlJDIuaW1wb3J0ZWQgPSB0aGlzLnBhcnNlTW9kdWxlRXhwb3J0TmFtZSgpO1xuICAgIGlmICh0aGlzLmVhdENvbnRleHR1YWwoXCJhc1wiKSkge1xuICAgICAgbm9kZSQyLmxvY2FsID0gdGhpcy5wYXJzZUlkZW50KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2hlY2tVbnJlc2VydmVkKG5vZGUkMi5pbXBvcnRlZCk7XG4gICAgICBub2RlJDIubG9jYWwgPSBub2RlJDIuaW1wb3J0ZWQ7XG4gICAgfVxuICAgIHRoaXMuY2hlY2tMVmFsU2ltcGxlKG5vZGUkMi5sb2NhbCwgQklORF9MRVhJQ0FMKTtcbiAgICBub2Rlcy5wdXNoKHRoaXMuZmluaXNoTm9kZShub2RlJDIsIFwiSW1wb3J0U3BlY2lmaWVyXCIpKTtcbiAgfVxuICByZXR1cm4gbm9kZXNcbn07XG5cbnBwJDgucGFyc2VNb2R1bGVFeHBvcnROYW1lID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gMTMgJiYgdGhpcy50eXBlID09PSB0eXBlcyQxLnN0cmluZykge1xuICAgIHZhciBzdHJpbmdMaXRlcmFsID0gdGhpcy5wYXJzZUxpdGVyYWwodGhpcy52YWx1ZSk7XG4gICAgaWYgKGxvbmVTdXJyb2dhdGUudGVzdChzdHJpbmdMaXRlcmFsLnZhbHVlKSkge1xuICAgICAgdGhpcy5yYWlzZShzdHJpbmdMaXRlcmFsLnN0YXJ0LCBcIkFuIGV4cG9ydCBuYW1lIGNhbm5vdCBpbmNsdWRlIGEgbG9uZSBzdXJyb2dhdGUuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gc3RyaW5nTGl0ZXJhbFxuICB9XG4gIHJldHVybiB0aGlzLnBhcnNlSWRlbnQodHJ1ZSlcbn07XG5cbi8vIFNldCBgRXhwcmVzc2lvblN0YXRlbWVudCNkaXJlY3RpdmVgIHByb3BlcnR5IGZvciBkaXJlY3RpdmUgcHJvbG9ndWVzLlxucHAkOC5hZGFwdERpcmVjdGl2ZVByb2xvZ3VlID0gZnVuY3Rpb24oc3RhdGVtZW50cykge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0YXRlbWVudHMubGVuZ3RoICYmIHRoaXMuaXNEaXJlY3RpdmVDYW5kaWRhdGUoc3RhdGVtZW50c1tpXSk7ICsraSkge1xuICAgIHN0YXRlbWVudHNbaV0uZGlyZWN0aXZlID0gc3RhdGVtZW50c1tpXS5leHByZXNzaW9uLnJhdy5zbGljZSgxLCAtMSk7XG4gIH1cbn07XG5wcCQ4LmlzRGlyZWN0aXZlQ2FuZGlkYXRlID0gZnVuY3Rpb24oc3RhdGVtZW50KSB7XG4gIHJldHVybiAoXG4gICAgc3RhdGVtZW50LnR5cGUgPT09IFwiRXhwcmVzc2lvblN0YXRlbWVudFwiICYmXG4gICAgc3RhdGVtZW50LmV4cHJlc3Npb24udHlwZSA9PT0gXCJMaXRlcmFsXCIgJiZcbiAgICB0eXBlb2Ygc3RhdGVtZW50LmV4cHJlc3Npb24udmFsdWUgPT09IFwic3RyaW5nXCIgJiZcbiAgICAvLyBSZWplY3QgcGFyZW50aGVzaXplZCBzdHJpbmdzLlxuICAgICh0aGlzLmlucHV0W3N0YXRlbWVudC5zdGFydF0gPT09IFwiXFxcIlwiIHx8IHRoaXMuaW5wdXRbc3RhdGVtZW50LnN0YXJ0XSA9PT0gXCInXCIpXG4gIClcbn07XG5cbnZhciBwcCQ3ID0gUGFyc2VyLnByb3RvdHlwZTtcblxuLy8gQ29udmVydCBleGlzdGluZyBleHByZXNzaW9uIGF0b20gdG8gYXNzaWduYWJsZSBwYXR0ZXJuXG4vLyBpZiBwb3NzaWJsZS5cblxucHAkNy50b0Fzc2lnbmFibGUgPSBmdW5jdGlvbihub2RlLCBpc0JpbmRpbmcsIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpIHtcbiAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA2ICYmIG5vZGUpIHtcbiAgICBzd2l0Y2ggKG5vZGUudHlwZSkge1xuICAgIGNhc2UgXCJJZGVudGlmaWVyXCI6XG4gICAgICBpZiAodGhpcy5pbkFzeW5jICYmIG5vZGUubmFtZSA9PT0gXCJhd2FpdFwiKVxuICAgICAgICB7IHRoaXMucmFpc2Uobm9kZS5zdGFydCwgXCJDYW5ub3QgdXNlICdhd2FpdCcgYXMgaWRlbnRpZmllciBpbnNpZGUgYW4gYXN5bmMgZnVuY3Rpb25cIik7IH1cbiAgICAgIGJyZWFrXG5cbiAgICBjYXNlIFwiT2JqZWN0UGF0dGVyblwiOlxuICAgIGNhc2UgXCJBcnJheVBhdHRlcm5cIjpcbiAgICBjYXNlIFwiQXNzaWdubWVudFBhdHRlcm5cIjpcbiAgICBjYXNlIFwiUmVzdEVsZW1lbnRcIjpcbiAgICAgIGJyZWFrXG5cbiAgICBjYXNlIFwiT2JqZWN0RXhwcmVzc2lvblwiOlxuICAgICAgbm9kZS50eXBlID0gXCJPYmplY3RQYXR0ZXJuXCI7XG4gICAgICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykgeyB0aGlzLmNoZWNrUGF0dGVybkVycm9ycyhyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCB0cnVlKTsgfVxuICAgICAgZm9yICh2YXIgaSA9IDAsIGxpc3QgPSBub2RlLnByb3BlcnRpZXM7IGkgPCBsaXN0Lmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIHZhciBwcm9wID0gbGlzdFtpXTtcblxuICAgICAgdGhpcy50b0Fzc2lnbmFibGUocHJvcCwgaXNCaW5kaW5nKTtcbiAgICAgICAgLy8gRWFybHkgZXJyb3I6XG4gICAgICAgIC8vICAgQXNzaWdubWVudFJlc3RQcm9wZXJ0eVtZaWVsZCwgQXdhaXRdIDpcbiAgICAgICAgLy8gICAgIGAuLi5gIERlc3RydWN0dXJpbmdBc3NpZ25tZW50VGFyZ2V0W1lpZWxkLCBBd2FpdF1cbiAgICAgICAgLy9cbiAgICAgICAgLy8gICBJdCBpcyBhIFN5bnRheCBFcnJvciBpZiB8RGVzdHJ1Y3R1cmluZ0Fzc2lnbm1lbnRUYXJnZXR8IGlzIGFuIHxBcnJheUxpdGVyYWx8IG9yIGFuIHxPYmplY3RMaXRlcmFsfC5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIHByb3AudHlwZSA9PT0gXCJSZXN0RWxlbWVudFwiICYmXG4gICAgICAgICAgKHByb3AuYXJndW1lbnQudHlwZSA9PT0gXCJBcnJheVBhdHRlcm5cIiB8fCBwcm9wLmFyZ3VtZW50LnR5cGUgPT09IFwiT2JqZWN0UGF0dGVyblwiKVxuICAgICAgICApIHtcbiAgICAgICAgICB0aGlzLnJhaXNlKHByb3AuYXJndW1lbnQuc3RhcnQsIFwiVW5leHBlY3RlZCB0b2tlblwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYnJlYWtcblxuICAgIGNhc2UgXCJQcm9wZXJ0eVwiOlxuICAgICAgLy8gQXNzaWdubWVudFByb3BlcnR5IGhhcyB0eXBlID09PSBcIlByb3BlcnR5XCJcbiAgICAgIGlmIChub2RlLmtpbmQgIT09IFwiaW5pdFwiKSB7IHRoaXMucmFpc2Uobm9kZS5rZXkuc3RhcnQsIFwiT2JqZWN0IHBhdHRlcm4gY2FuJ3QgY29udGFpbiBnZXR0ZXIgb3Igc2V0dGVyXCIpOyB9XG4gICAgICB0aGlzLnRvQXNzaWduYWJsZShub2RlLnZhbHVlLCBpc0JpbmRpbmcpO1xuICAgICAgYnJlYWtcblxuICAgIGNhc2UgXCJBcnJheUV4cHJlc3Npb25cIjpcbiAgICAgIG5vZGUudHlwZSA9IFwiQXJyYXlQYXR0ZXJuXCI7XG4gICAgICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykgeyB0aGlzLmNoZWNrUGF0dGVybkVycm9ycyhyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCB0cnVlKTsgfVxuICAgICAgdGhpcy50b0Fzc2lnbmFibGVMaXN0KG5vZGUuZWxlbWVudHMsIGlzQmluZGluZyk7XG4gICAgICBicmVha1xuXG4gICAgY2FzZSBcIlNwcmVhZEVsZW1lbnRcIjpcbiAgICAgIG5vZGUudHlwZSA9IFwiUmVzdEVsZW1lbnRcIjtcbiAgICAgIHRoaXMudG9Bc3NpZ25hYmxlKG5vZGUuYXJndW1lbnQsIGlzQmluZGluZyk7XG4gICAgICBpZiAobm9kZS5hcmd1bWVudC50eXBlID09PSBcIkFzc2lnbm1lbnRQYXR0ZXJuXCIpXG4gICAgICAgIHsgdGhpcy5yYWlzZShub2RlLmFyZ3VtZW50LnN0YXJ0LCBcIlJlc3QgZWxlbWVudHMgY2Fubm90IGhhdmUgYSBkZWZhdWx0IHZhbHVlXCIpOyB9XG4gICAgICBicmVha1xuXG4gICAgY2FzZSBcIkFzc2lnbm1lbnRFeHByZXNzaW9uXCI6XG4gICAgICBpZiAobm9kZS5vcGVyYXRvciAhPT0gXCI9XCIpIHsgdGhpcy5yYWlzZShub2RlLmxlZnQuZW5kLCBcIk9ubHkgJz0nIG9wZXJhdG9yIGNhbiBiZSB1c2VkIGZvciBzcGVjaWZ5aW5nIGRlZmF1bHQgdmFsdWUuXCIpOyB9XG4gICAgICBub2RlLnR5cGUgPSBcIkFzc2lnbm1lbnRQYXR0ZXJuXCI7XG4gICAgICBkZWxldGUgbm9kZS5vcGVyYXRvcjtcbiAgICAgIHRoaXMudG9Bc3NpZ25hYmxlKG5vZGUubGVmdCwgaXNCaW5kaW5nKTtcbiAgICAgIGJyZWFrXG5cbiAgICBjYXNlIFwiUGFyZW50aGVzaXplZEV4cHJlc3Npb25cIjpcbiAgICAgIHRoaXMudG9Bc3NpZ25hYmxlKG5vZGUuZXhwcmVzc2lvbiwgaXNCaW5kaW5nLCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzKTtcbiAgICAgIGJyZWFrXG5cbiAgICBjYXNlIFwiQ2hhaW5FeHByZXNzaW9uXCI6XG4gICAgICB0aGlzLnJhaXNlUmVjb3ZlcmFibGUobm9kZS5zdGFydCwgXCJPcHRpb25hbCBjaGFpbmluZyBjYW5ub3QgYXBwZWFyIGluIGxlZnQtaGFuZCBzaWRlXCIpO1xuICAgICAgYnJlYWtcblxuICAgIGNhc2UgXCJNZW1iZXJFeHByZXNzaW9uXCI6XG4gICAgICBpZiAoIWlzQmluZGluZykgeyBicmVhayB9XG5cbiAgICBkZWZhdWx0OlxuICAgICAgdGhpcy5yYWlzZShub2RlLnN0YXJ0LCBcIkFzc2lnbmluZyB0byBydmFsdWVcIik7XG4gICAgfVxuICB9IGVsc2UgaWYgKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpIHsgdGhpcy5jaGVja1BhdHRlcm5FcnJvcnMocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycywgdHJ1ZSk7IH1cbiAgcmV0dXJuIG5vZGVcbn07XG5cbi8vIENvbnZlcnQgbGlzdCBvZiBleHByZXNzaW9uIGF0b21zIHRvIGJpbmRpbmcgbGlzdC5cblxucHAkNy50b0Fzc2lnbmFibGVMaXN0ID0gZnVuY3Rpb24oZXhwckxpc3QsIGlzQmluZGluZykge1xuICB2YXIgZW5kID0gZXhwckxpc3QubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgdmFyIGVsdCA9IGV4cHJMaXN0W2ldO1xuICAgIGlmIChlbHQpIHsgdGhpcy50b0Fzc2lnbmFibGUoZWx0LCBpc0JpbmRpbmcpOyB9XG4gIH1cbiAgaWYgKGVuZCkge1xuICAgIHZhciBsYXN0ID0gZXhwckxpc3RbZW5kIC0gMV07XG4gICAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA9PT0gNiAmJiBpc0JpbmRpbmcgJiYgbGFzdCAmJiBsYXN0LnR5cGUgPT09IFwiUmVzdEVsZW1lbnRcIiAmJiBsYXN0LmFyZ3VtZW50LnR5cGUgIT09IFwiSWRlbnRpZmllclwiKVxuICAgICAgeyB0aGlzLnVuZXhwZWN0ZWQobGFzdC5hcmd1bWVudC5zdGFydCk7IH1cbiAgfVxuICByZXR1cm4gZXhwckxpc3Rcbn07XG5cbi8vIFBhcnNlcyBzcHJlYWQgZWxlbWVudC5cblxucHAkNy5wYXJzZVNwcmVhZCA9IGZ1bmN0aW9uKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpIHtcbiAgdmFyIG5vZGUgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICB0aGlzLm5leHQoKTtcbiAgbm9kZS5hcmd1bWVudCA9IHRoaXMucGFyc2VNYXliZUFzc2lnbihmYWxzZSwgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycyk7XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJTcHJlYWRFbGVtZW50XCIpXG59O1xuXG5wcCQ3LnBhcnNlUmVzdEJpbmRpbmcgPSBmdW5jdGlvbigpIHtcbiAgdmFyIG5vZGUgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICB0aGlzLm5leHQoKTtcblxuICAvLyBSZXN0RWxlbWVudCBpbnNpZGUgb2YgYSBmdW5jdGlvbiBwYXJhbWV0ZXIgbXVzdCBiZSBhbiBpZGVudGlmaWVyXG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPT09IDYgJiYgdGhpcy50eXBlICE9PSB0eXBlcyQxLm5hbWUpXG4gICAgeyB0aGlzLnVuZXhwZWN0ZWQoKTsgfVxuXG4gIG5vZGUuYXJndW1lbnQgPSB0aGlzLnBhcnNlQmluZGluZ0F0b20oKTtcblxuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiUmVzdEVsZW1lbnRcIilcbn07XG5cbi8vIFBhcnNlcyBsdmFsdWUgKGFzc2lnbmFibGUpIGF0b20uXG5cbnBwJDcucGFyc2VCaW5kaW5nQXRvbSA9IGZ1bmN0aW9uKCkge1xuICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDYpIHtcbiAgICBzd2l0Y2ggKHRoaXMudHlwZSkge1xuICAgIGNhc2UgdHlwZXMkMS5icmFja2V0TDpcbiAgICAgIHZhciBub2RlID0gdGhpcy5zdGFydE5vZGUoKTtcbiAgICAgIHRoaXMubmV4dCgpO1xuICAgICAgbm9kZS5lbGVtZW50cyA9IHRoaXMucGFyc2VCaW5kaW5nTGlzdCh0eXBlcyQxLmJyYWNrZXRSLCB0cnVlLCB0cnVlKTtcbiAgICAgIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJBcnJheVBhdHRlcm5cIilcblxuICAgIGNhc2UgdHlwZXMkMS5icmFjZUw6XG4gICAgICByZXR1cm4gdGhpcy5wYXJzZU9iaih0cnVlKVxuICAgIH1cbiAgfVxuICByZXR1cm4gdGhpcy5wYXJzZUlkZW50KClcbn07XG5cbnBwJDcucGFyc2VCaW5kaW5nTGlzdCA9IGZ1bmN0aW9uKGNsb3NlLCBhbGxvd0VtcHR5LCBhbGxvd1RyYWlsaW5nQ29tbWEpIHtcbiAgdmFyIGVsdHMgPSBbXSwgZmlyc3QgPSB0cnVlO1xuICB3aGlsZSAoIXRoaXMuZWF0KGNsb3NlKSkge1xuICAgIGlmIChmaXJzdCkgeyBmaXJzdCA9IGZhbHNlOyB9XG4gICAgZWxzZSB7IHRoaXMuZXhwZWN0KHR5cGVzJDEuY29tbWEpOyB9XG4gICAgaWYgKGFsbG93RW1wdHkgJiYgdGhpcy50eXBlID09PSB0eXBlcyQxLmNvbW1hKSB7XG4gICAgICBlbHRzLnB1c2gobnVsbCk7XG4gICAgfSBlbHNlIGlmIChhbGxvd1RyYWlsaW5nQ29tbWEgJiYgdGhpcy5hZnRlclRyYWlsaW5nQ29tbWEoY2xvc2UpKSB7XG4gICAgICBicmVha1xuICAgIH0gZWxzZSBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLmVsbGlwc2lzKSB7XG4gICAgICB2YXIgcmVzdCA9IHRoaXMucGFyc2VSZXN0QmluZGluZygpO1xuICAgICAgdGhpcy5wYXJzZUJpbmRpbmdMaXN0SXRlbShyZXN0KTtcbiAgICAgIGVsdHMucHVzaChyZXN0KTtcbiAgICAgIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEuY29tbWEpIHsgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIkNvbW1hIGlzIG5vdCBwZXJtaXR0ZWQgYWZ0ZXIgdGhlIHJlc3QgZWxlbWVudFwiKTsgfVxuICAgICAgdGhpcy5leHBlY3QoY2xvc2UpO1xuICAgICAgYnJlYWtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGVsZW0gPSB0aGlzLnBhcnNlTWF5YmVEZWZhdWx0KHRoaXMuc3RhcnQsIHRoaXMuc3RhcnRMb2MpO1xuICAgICAgdGhpcy5wYXJzZUJpbmRpbmdMaXN0SXRlbShlbGVtKTtcbiAgICAgIGVsdHMucHVzaChlbGVtKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGVsdHNcbn07XG5cbnBwJDcucGFyc2VCaW5kaW5nTGlzdEl0ZW0gPSBmdW5jdGlvbihwYXJhbSkge1xuICByZXR1cm4gcGFyYW1cbn07XG5cbi8vIFBhcnNlcyBhc3NpZ25tZW50IHBhdHRlcm4gYXJvdW5kIGdpdmVuIGF0b20gaWYgcG9zc2libGUuXG5cbnBwJDcucGFyc2VNYXliZURlZmF1bHQgPSBmdW5jdGlvbihzdGFydFBvcywgc3RhcnRMb2MsIGxlZnQpIHtcbiAgbGVmdCA9IGxlZnQgfHwgdGhpcy5wYXJzZUJpbmRpbmdBdG9tKCk7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPCA2IHx8ICF0aGlzLmVhdCh0eXBlcyQxLmVxKSkgeyByZXR1cm4gbGVmdCB9XG4gIHZhciBub2RlID0gdGhpcy5zdGFydE5vZGVBdChzdGFydFBvcywgc3RhcnRMb2MpO1xuICBub2RlLmxlZnQgPSBsZWZ0O1xuICBub2RlLnJpZ2h0ID0gdGhpcy5wYXJzZU1heWJlQXNzaWduKCk7XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJBc3NpZ25tZW50UGF0dGVyblwiKVxufTtcblxuLy8gVGhlIGZvbGxvd2luZyB0aHJlZSBmdW5jdGlvbnMgYWxsIHZlcmlmeSB0aGF0IGEgbm9kZSBpcyBhbiBsdmFsdWUg4oCUXG4vLyBzb21ldGhpbmcgdGhhdCBjYW4gYmUgYm91bmQsIG9yIGFzc2lnbmVkIHRvLiBJbiBvcmRlciB0byBkbyBzbywgdGhleSBwZXJmb3JtXG4vLyBhIHZhcmlldHkgb2YgY2hlY2tzOlxuLy9cbi8vIC0gQ2hlY2sgdGhhdCBub25lIG9mIHRoZSBib3VuZC9hc3NpZ25lZC10byBpZGVudGlmaWVycyBhcmUgcmVzZXJ2ZWQgd29yZHMuXG4vLyAtIFJlY29yZCBuYW1lIGRlY2xhcmF0aW9ucyBmb3IgYmluZGluZ3MgaW4gdGhlIGFwcHJvcHJpYXRlIHNjb3BlLlxuLy8gLSBDaGVjayBkdXBsaWNhdGUgYXJndW1lbnQgbmFtZXMsIGlmIGNoZWNrQ2xhc2hlcyBpcyBzZXQuXG4vL1xuLy8gSWYgYSBjb21wbGV4IGJpbmRpbmcgcGF0dGVybiBpcyBlbmNvdW50ZXJlZCAoZS5nLiwgb2JqZWN0IGFuZCBhcnJheVxuLy8gZGVzdHJ1Y3R1cmluZyksIHRoZSBlbnRpcmUgcGF0dGVybiBpcyByZWN1cnNpdmVseSBjaGVja2VkLlxuLy9cbi8vIFRoZXJlIGFyZSB0aHJlZSB2ZXJzaW9ucyBvZiBjaGVja0xWYWwqKCkgYXBwcm9wcmlhdGUgZm9yIGRpZmZlcmVudFxuLy8gY2lyY3Vtc3RhbmNlczpcbi8vXG4vLyAtIGNoZWNrTFZhbFNpbXBsZSgpIHNoYWxsIGJlIHVzZWQgaWYgdGhlIHN5bnRhY3RpYyBjb25zdHJ1Y3Qgc3VwcG9ydHNcbi8vICAgbm90aGluZyBvdGhlciB0aGFuIGlkZW50aWZpZXJzIGFuZCBtZW1iZXIgZXhwcmVzc2lvbnMuIFBhcmVudGhlc2l6ZWRcbi8vICAgZXhwcmVzc2lvbnMgYXJlIGFsc28gY29ycmVjdGx5IGhhbmRsZWQuIFRoaXMgaXMgZ2VuZXJhbGx5IGFwcHJvcHJpYXRlIGZvclxuLy8gICBjb25zdHJ1Y3RzIGZvciB3aGljaCB0aGUgc3BlYyBzYXlzXG4vL1xuLy8gICA+IEl0IGlzIGEgU3ludGF4IEVycm9yIGlmIEFzc2lnbm1lbnRUYXJnZXRUeXBlIG9mIFt0aGUgcHJvZHVjdGlvbl0gaXMgbm90XG4vLyAgID4gc2ltcGxlLlxuLy9cbi8vICAgSXQgaXMgYWxzbyBhcHByb3ByaWF0ZSBmb3IgY2hlY2tpbmcgaWYgYW4gaWRlbnRpZmllciBpcyB2YWxpZCBhbmQgbm90XG4vLyAgIGRlZmluZWQgZWxzZXdoZXJlLCBsaWtlIGltcG9ydCBkZWNsYXJhdGlvbnMgb3IgZnVuY3Rpb24vY2xhc3MgaWRlbnRpZmllcnMuXG4vL1xuLy8gICBFeGFtcGxlcyB3aGVyZSB0aGlzIGlzIHVzZWQgaW5jbHVkZTpcbi8vICAgICBhICs9IOKApjtcbi8vICAgICBpbXBvcnQgYSBmcm9tICfigKYnO1xuLy8gICB3aGVyZSBhIGlzIHRoZSBub2RlIHRvIGJlIGNoZWNrZWQuXG4vL1xuLy8gLSBjaGVja0xWYWxQYXR0ZXJuKCkgc2hhbGwgYmUgdXNlZCBpZiB0aGUgc3ludGFjdGljIGNvbnN0cnVjdCBzdXBwb3J0c1xuLy8gICBhbnl0aGluZyBjaGVja0xWYWxTaW1wbGUoKSBzdXBwb3J0cywgYXMgd2VsbCBhcyBvYmplY3QgYW5kIGFycmF5XG4vLyAgIGRlc3RydWN0dXJpbmcgcGF0dGVybnMuIFRoaXMgaXMgZ2VuZXJhbGx5IGFwcHJvcHJpYXRlIGZvciBjb25zdHJ1Y3RzIGZvclxuLy8gICB3aGljaCB0aGUgc3BlYyBzYXlzXG4vL1xuLy8gICA+IEl0IGlzIGEgU3ludGF4IEVycm9yIGlmIFt0aGUgcHJvZHVjdGlvbl0gaXMgbmVpdGhlciBhbiBPYmplY3RMaXRlcmFsIG5vclxuLy8gICA+IGFuIEFycmF5TGl0ZXJhbCBhbmQgQXNzaWdubWVudFRhcmdldFR5cGUgb2YgW3RoZSBwcm9kdWN0aW9uXSBpcyBub3Rcbi8vICAgPiBzaW1wbGUuXG4vL1xuLy8gICBFeGFtcGxlcyB3aGVyZSB0aGlzIGlzIHVzZWQgaW5jbHVkZTpcbi8vICAgICAoYSA9IOKApik7XG4vLyAgICAgY29uc3QgYSA9IOKApjtcbi8vICAgICB0cnkgeyDigKYgfSBjYXRjaCAoYSkgeyDigKYgfVxuLy8gICB3aGVyZSBhIGlzIHRoZSBub2RlIHRvIGJlIGNoZWNrZWQuXG4vL1xuLy8gLSBjaGVja0xWYWxJbm5lclBhdHRlcm4oKSBzaGFsbCBiZSB1c2VkIGlmIHRoZSBzeW50YWN0aWMgY29uc3RydWN0IHN1cHBvcnRzXG4vLyAgIGFueXRoaW5nIGNoZWNrTFZhbFBhdHRlcm4oKSBzdXBwb3J0cywgYXMgd2VsbCBhcyBkZWZhdWx0IGFzc2lnbm1lbnRcbi8vICAgcGF0dGVybnMsIHJlc3QgZWxlbWVudHMsIGFuZCBvdGhlciBjb25zdHJ1Y3RzIHRoYXQgbWF5IGFwcGVhciB3aXRoaW4gYW5cbi8vICAgb2JqZWN0IG9yIGFycmF5IGRlc3RydWN0dXJpbmcgcGF0dGVybi5cbi8vXG4vLyAgIEFzIGEgc3BlY2lhbCBjYXNlLCBmdW5jdGlvbiBwYXJhbWV0ZXJzIGFsc28gdXNlIGNoZWNrTFZhbElubmVyUGF0dGVybigpLFxuLy8gICBhcyB0aGV5IGFsc28gc3VwcG9ydCBkZWZhdWx0cyBhbmQgcmVzdCBjb25zdHJ1Y3RzLlxuLy9cbi8vIFRoZXNlIGZ1bmN0aW9ucyBkZWxpYmVyYXRlbHkgc3VwcG9ydCBib3RoIGFzc2lnbm1lbnQgYW5kIGJpbmRpbmcgY29uc3RydWN0cyxcbi8vIGFzIHRoZSBsb2dpYyBmb3IgYm90aCBpcyBleGNlZWRpbmdseSBzaW1pbGFyLiBJZiB0aGUgbm9kZSBpcyB0aGUgdGFyZ2V0IG9mXG4vLyBhbiBhc3NpZ25tZW50LCB0aGVuIGJpbmRpbmdUeXBlIHNob3VsZCBiZSBzZXQgdG8gQklORF9OT05FLiBPdGhlcndpc2UsIGl0XG4vLyBzaG91bGQgYmUgc2V0IHRvIHRoZSBhcHByb3ByaWF0ZSBCSU5EXyogY29uc3RhbnQsIGxpa2UgQklORF9WQVIgb3Jcbi8vIEJJTkRfTEVYSUNBTC5cbi8vXG4vLyBJZiB0aGUgZnVuY3Rpb24gaXMgY2FsbGVkIHdpdGggYSBub24tQklORF9OT05FIGJpbmRpbmdUeXBlLCB0aGVuXG4vLyBhZGRpdGlvbmFsbHkgYSBjaGVja0NsYXNoZXMgb2JqZWN0IG1heSBiZSBzcGVjaWZpZWQgdG8gYWxsb3cgY2hlY2tpbmcgZm9yXG4vLyBkdXBsaWNhdGUgYXJndW1lbnQgbmFtZXMuIGNoZWNrQ2xhc2hlcyBpcyBpZ25vcmVkIGlmIHRoZSBwcm92aWRlZCBjb25zdHJ1Y3Rcbi8vIGlzIGFuIGFzc2lnbm1lbnQgKGkuZS4sIGJpbmRpbmdUeXBlIGlzIEJJTkRfTk9ORSkuXG5cbnBwJDcuY2hlY2tMVmFsU2ltcGxlID0gZnVuY3Rpb24oZXhwciwgYmluZGluZ1R5cGUsIGNoZWNrQ2xhc2hlcykge1xuICBpZiAoIGJpbmRpbmdUeXBlID09PSB2b2lkIDAgKSBiaW5kaW5nVHlwZSA9IEJJTkRfTk9ORTtcblxuICB2YXIgaXNCaW5kID0gYmluZGluZ1R5cGUgIT09IEJJTkRfTk9ORTtcblxuICBzd2l0Y2ggKGV4cHIudHlwZSkge1xuICBjYXNlIFwiSWRlbnRpZmllclwiOlxuICAgIGlmICh0aGlzLnN0cmljdCAmJiB0aGlzLnJlc2VydmVkV29yZHNTdHJpY3RCaW5kLnRlc3QoZXhwci5uYW1lKSlcbiAgICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKGV4cHIuc3RhcnQsIChpc0JpbmQgPyBcIkJpbmRpbmcgXCIgOiBcIkFzc2lnbmluZyB0byBcIikgKyBleHByLm5hbWUgKyBcIiBpbiBzdHJpY3QgbW9kZVwiKTsgfVxuICAgIGlmIChpc0JpbmQpIHtcbiAgICAgIGlmIChiaW5kaW5nVHlwZSA9PT0gQklORF9MRVhJQ0FMICYmIGV4cHIubmFtZSA9PT0gXCJsZXRcIilcbiAgICAgICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUoZXhwci5zdGFydCwgXCJsZXQgaXMgZGlzYWxsb3dlZCBhcyBhIGxleGljYWxseSBib3VuZCBuYW1lXCIpOyB9XG4gICAgICBpZiAoY2hlY2tDbGFzaGVzKSB7XG4gICAgICAgIGlmIChoYXNPd24oY2hlY2tDbGFzaGVzLCBleHByLm5hbWUpKVxuICAgICAgICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKGV4cHIuc3RhcnQsIFwiQXJndW1lbnQgbmFtZSBjbGFzaFwiKTsgfVxuICAgICAgICBjaGVja0NsYXNoZXNbZXhwci5uYW1lXSA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoYmluZGluZ1R5cGUgIT09IEJJTkRfT1VUU0lERSkgeyB0aGlzLmRlY2xhcmVOYW1lKGV4cHIubmFtZSwgYmluZGluZ1R5cGUsIGV4cHIuc3RhcnQpOyB9XG4gICAgfVxuICAgIGJyZWFrXG5cbiAgY2FzZSBcIkNoYWluRXhwcmVzc2lvblwiOlxuICAgIHRoaXMucmFpc2VSZWNvdmVyYWJsZShleHByLnN0YXJ0LCBcIk9wdGlvbmFsIGNoYWluaW5nIGNhbm5vdCBhcHBlYXIgaW4gbGVmdC1oYW5kIHNpZGVcIik7XG4gICAgYnJlYWtcblxuICBjYXNlIFwiTWVtYmVyRXhwcmVzc2lvblwiOlxuICAgIGlmIChpc0JpbmQpIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKGV4cHIuc3RhcnQsIFwiQmluZGluZyBtZW1iZXIgZXhwcmVzc2lvblwiKTsgfVxuICAgIGJyZWFrXG5cbiAgY2FzZSBcIlBhcmVudGhlc2l6ZWRFeHByZXNzaW9uXCI6XG4gICAgaWYgKGlzQmluZCkgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUoZXhwci5zdGFydCwgXCJCaW5kaW5nIHBhcmVudGhlc2l6ZWQgZXhwcmVzc2lvblwiKTsgfVxuICAgIHJldHVybiB0aGlzLmNoZWNrTFZhbFNpbXBsZShleHByLmV4cHJlc3Npb24sIGJpbmRpbmdUeXBlLCBjaGVja0NsYXNoZXMpXG5cbiAgZGVmYXVsdDpcbiAgICB0aGlzLnJhaXNlKGV4cHIuc3RhcnQsIChpc0JpbmQgPyBcIkJpbmRpbmdcIiA6IFwiQXNzaWduaW5nIHRvXCIpICsgXCIgcnZhbHVlXCIpO1xuICB9XG59O1xuXG5wcCQ3LmNoZWNrTFZhbFBhdHRlcm4gPSBmdW5jdGlvbihleHByLCBiaW5kaW5nVHlwZSwgY2hlY2tDbGFzaGVzKSB7XG4gIGlmICggYmluZGluZ1R5cGUgPT09IHZvaWQgMCApIGJpbmRpbmdUeXBlID0gQklORF9OT05FO1xuXG4gIHN3aXRjaCAoZXhwci50eXBlKSB7XG4gIGNhc2UgXCJPYmplY3RQYXR0ZXJuXCI6XG4gICAgZm9yICh2YXIgaSA9IDAsIGxpc3QgPSBleHByLnByb3BlcnRpZXM7IGkgPCBsaXN0Lmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICB2YXIgcHJvcCA9IGxpc3RbaV07XG5cbiAgICB0aGlzLmNoZWNrTFZhbElubmVyUGF0dGVybihwcm9wLCBiaW5kaW5nVHlwZSwgY2hlY2tDbGFzaGVzKTtcbiAgICB9XG4gICAgYnJlYWtcblxuICBjYXNlIFwiQXJyYXlQYXR0ZXJuXCI6XG4gICAgZm9yICh2YXIgaSQxID0gMCwgbGlzdCQxID0gZXhwci5lbGVtZW50czsgaSQxIDwgbGlzdCQxLmxlbmd0aDsgaSQxICs9IDEpIHtcbiAgICAgIHZhciBlbGVtID0gbGlzdCQxW2kkMV07XG5cbiAgICBpZiAoZWxlbSkgeyB0aGlzLmNoZWNrTFZhbElubmVyUGF0dGVybihlbGVtLCBiaW5kaW5nVHlwZSwgY2hlY2tDbGFzaGVzKTsgfVxuICAgIH1cbiAgICBicmVha1xuXG4gIGRlZmF1bHQ6XG4gICAgdGhpcy5jaGVja0xWYWxTaW1wbGUoZXhwciwgYmluZGluZ1R5cGUsIGNoZWNrQ2xhc2hlcyk7XG4gIH1cbn07XG5cbnBwJDcuY2hlY2tMVmFsSW5uZXJQYXR0ZXJuID0gZnVuY3Rpb24oZXhwciwgYmluZGluZ1R5cGUsIGNoZWNrQ2xhc2hlcykge1xuICBpZiAoIGJpbmRpbmdUeXBlID09PSB2b2lkIDAgKSBiaW5kaW5nVHlwZSA9IEJJTkRfTk9ORTtcblxuICBzd2l0Y2ggKGV4cHIudHlwZSkge1xuICBjYXNlIFwiUHJvcGVydHlcIjpcbiAgICAvLyBBc3NpZ25tZW50UHJvcGVydHkgaGFzIHR5cGUgPT09IFwiUHJvcGVydHlcIlxuICAgIHRoaXMuY2hlY2tMVmFsSW5uZXJQYXR0ZXJuKGV4cHIudmFsdWUsIGJpbmRpbmdUeXBlLCBjaGVja0NsYXNoZXMpO1xuICAgIGJyZWFrXG5cbiAgY2FzZSBcIkFzc2lnbm1lbnRQYXR0ZXJuXCI6XG4gICAgdGhpcy5jaGVja0xWYWxQYXR0ZXJuKGV4cHIubGVmdCwgYmluZGluZ1R5cGUsIGNoZWNrQ2xhc2hlcyk7XG4gICAgYnJlYWtcblxuICBjYXNlIFwiUmVzdEVsZW1lbnRcIjpcbiAgICB0aGlzLmNoZWNrTFZhbFBhdHRlcm4oZXhwci5hcmd1bWVudCwgYmluZGluZ1R5cGUsIGNoZWNrQ2xhc2hlcyk7XG4gICAgYnJlYWtcblxuICBkZWZhdWx0OlxuICAgIHRoaXMuY2hlY2tMVmFsUGF0dGVybihleHByLCBiaW5kaW5nVHlwZSwgY2hlY2tDbGFzaGVzKTtcbiAgfVxufTtcblxuLy8gVGhlIGFsZ29yaXRobSB1c2VkIHRvIGRldGVybWluZSB3aGV0aGVyIGEgcmVnZXhwIGNhbiBhcHBlYXIgYXQgYVxuXG52YXIgVG9rQ29udGV4dCA9IGZ1bmN0aW9uIFRva0NvbnRleHQodG9rZW4sIGlzRXhwciwgcHJlc2VydmVTcGFjZSwgb3ZlcnJpZGUsIGdlbmVyYXRvcikge1xuICB0aGlzLnRva2VuID0gdG9rZW47XG4gIHRoaXMuaXNFeHByID0gISFpc0V4cHI7XG4gIHRoaXMucHJlc2VydmVTcGFjZSA9ICEhcHJlc2VydmVTcGFjZTtcbiAgdGhpcy5vdmVycmlkZSA9IG92ZXJyaWRlO1xuICB0aGlzLmdlbmVyYXRvciA9ICEhZ2VuZXJhdG9yO1xufTtcblxudmFyIHR5cGVzID0ge1xuICBiX3N0YXQ6IG5ldyBUb2tDb250ZXh0KFwie1wiLCBmYWxzZSksXG4gIGJfZXhwcjogbmV3IFRva0NvbnRleHQoXCJ7XCIsIHRydWUpLFxuICBiX3RtcGw6IG5ldyBUb2tDb250ZXh0KFwiJHtcIiwgZmFsc2UpLFxuICBwX3N0YXQ6IG5ldyBUb2tDb250ZXh0KFwiKFwiLCBmYWxzZSksXG4gIHBfZXhwcjogbmV3IFRva0NvbnRleHQoXCIoXCIsIHRydWUpLFxuICBxX3RtcGw6IG5ldyBUb2tDb250ZXh0KFwiYFwiLCB0cnVlLCB0cnVlLCBmdW5jdGlvbiAocCkgeyByZXR1cm4gcC50cnlSZWFkVGVtcGxhdGVUb2tlbigpOyB9KSxcbiAgZl9zdGF0OiBuZXcgVG9rQ29udGV4dChcImZ1bmN0aW9uXCIsIGZhbHNlKSxcbiAgZl9leHByOiBuZXcgVG9rQ29udGV4dChcImZ1bmN0aW9uXCIsIHRydWUpLFxuICBmX2V4cHJfZ2VuOiBuZXcgVG9rQ29udGV4dChcImZ1bmN0aW9uXCIsIHRydWUsIGZhbHNlLCBudWxsLCB0cnVlKSxcbiAgZl9nZW46IG5ldyBUb2tDb250ZXh0KFwiZnVuY3Rpb25cIiwgZmFsc2UsIGZhbHNlLCBudWxsLCB0cnVlKVxufTtcblxudmFyIHBwJDYgPSBQYXJzZXIucHJvdG90eXBlO1xuXG5wcCQ2LmluaXRpYWxDb250ZXh0ID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBbdHlwZXMuYl9zdGF0XVxufTtcblxucHAkNi5jdXJDb250ZXh0ID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmNvbnRleHRbdGhpcy5jb250ZXh0Lmxlbmd0aCAtIDFdXG59O1xuXG5wcCQ2LmJyYWNlSXNCbG9jayA9IGZ1bmN0aW9uKHByZXZUeXBlKSB7XG4gIHZhciBwYXJlbnQgPSB0aGlzLmN1ckNvbnRleHQoKTtcbiAgaWYgKHBhcmVudCA9PT0gdHlwZXMuZl9leHByIHx8IHBhcmVudCA9PT0gdHlwZXMuZl9zdGF0KVxuICAgIHsgcmV0dXJuIHRydWUgfVxuICBpZiAocHJldlR5cGUgPT09IHR5cGVzJDEuY29sb24gJiYgKHBhcmVudCA9PT0gdHlwZXMuYl9zdGF0IHx8IHBhcmVudCA9PT0gdHlwZXMuYl9leHByKSlcbiAgICB7IHJldHVybiAhcGFyZW50LmlzRXhwciB9XG5cbiAgLy8gVGhlIGNoZWNrIGZvciBgdHQubmFtZSAmJiBleHByQWxsb3dlZGAgZGV0ZWN0cyB3aGV0aGVyIHdlIGFyZVxuICAvLyBhZnRlciBhIGB5aWVsZGAgb3IgYG9mYCBjb25zdHJ1Y3QuIFNlZSB0aGUgYHVwZGF0ZUNvbnRleHRgIGZvclxuICAvLyBgdHQubmFtZWAuXG4gIGlmIChwcmV2VHlwZSA9PT0gdHlwZXMkMS5fcmV0dXJuIHx8IHByZXZUeXBlID09PSB0eXBlcyQxLm5hbWUgJiYgdGhpcy5leHByQWxsb3dlZClcbiAgICB7IHJldHVybiBsaW5lQnJlYWsudGVzdCh0aGlzLmlucHV0LnNsaWNlKHRoaXMubGFzdFRva0VuZCwgdGhpcy5zdGFydCkpIH1cbiAgaWYgKHByZXZUeXBlID09PSB0eXBlcyQxLl9lbHNlIHx8IHByZXZUeXBlID09PSB0eXBlcyQxLnNlbWkgfHwgcHJldlR5cGUgPT09IHR5cGVzJDEuZW9mIHx8IHByZXZUeXBlID09PSB0eXBlcyQxLnBhcmVuUiB8fCBwcmV2VHlwZSA9PT0gdHlwZXMkMS5hcnJvdylcbiAgICB7IHJldHVybiB0cnVlIH1cbiAgaWYgKHByZXZUeXBlID09PSB0eXBlcyQxLmJyYWNlTClcbiAgICB7IHJldHVybiBwYXJlbnQgPT09IHR5cGVzLmJfc3RhdCB9XG4gIGlmIChwcmV2VHlwZSA9PT0gdHlwZXMkMS5fdmFyIHx8IHByZXZUeXBlID09PSB0eXBlcyQxLl9jb25zdCB8fCBwcmV2VHlwZSA9PT0gdHlwZXMkMS5uYW1lKVxuICAgIHsgcmV0dXJuIGZhbHNlIH1cbiAgcmV0dXJuICF0aGlzLmV4cHJBbGxvd2VkXG59O1xuXG5wcCQ2LmluR2VuZXJhdG9yQ29udGV4dCA9IGZ1bmN0aW9uKCkge1xuICBmb3IgKHZhciBpID0gdGhpcy5jb250ZXh0Lmxlbmd0aCAtIDE7IGkgPj0gMTsgaS0tKSB7XG4gICAgdmFyIGNvbnRleHQgPSB0aGlzLmNvbnRleHRbaV07XG4gICAgaWYgKGNvbnRleHQudG9rZW4gPT09IFwiZnVuY3Rpb25cIilcbiAgICAgIHsgcmV0dXJuIGNvbnRleHQuZ2VuZXJhdG9yIH1cbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5cbnBwJDYudXBkYXRlQ29udGV4dCA9IGZ1bmN0aW9uKHByZXZUeXBlKSB7XG4gIHZhciB1cGRhdGUsIHR5cGUgPSB0aGlzLnR5cGU7XG4gIGlmICh0eXBlLmtleXdvcmQgJiYgcHJldlR5cGUgPT09IHR5cGVzJDEuZG90KVxuICAgIHsgdGhpcy5leHByQWxsb3dlZCA9IGZhbHNlOyB9XG4gIGVsc2UgaWYgKHVwZGF0ZSA9IHR5cGUudXBkYXRlQ29udGV4dClcbiAgICB7IHVwZGF0ZS5jYWxsKHRoaXMsIHByZXZUeXBlKTsgfVxuICBlbHNlXG4gICAgeyB0aGlzLmV4cHJBbGxvd2VkID0gdHlwZS5iZWZvcmVFeHByOyB9XG59O1xuXG4vLyBVc2VkIHRvIGhhbmRsZSBlZ2RlIGNhc2Ugd2hlbiB0b2tlbiBjb250ZXh0IGNvdWxkIG5vdCBiZSBpbmZlcnJlZCBjb3JyZWN0bHkgaW4gdG9rZW5pemUgcGhhc2VcbnBwJDYub3ZlcnJpZGVDb250ZXh0ID0gZnVuY3Rpb24odG9rZW5DdHgpIHtcbiAgaWYgKHRoaXMuY3VyQ29udGV4dCgpICE9PSB0b2tlbkN0eCkge1xuICAgIHRoaXMuY29udGV4dFt0aGlzLmNvbnRleHQubGVuZ3RoIC0gMV0gPSB0b2tlbkN0eDtcbiAgfVxufTtcblxuLy8gVG9rZW4tc3BlY2lmaWMgY29udGV4dCB1cGRhdGUgY29kZVxuXG50eXBlcyQxLnBhcmVuUi51cGRhdGVDb250ZXh0ID0gdHlwZXMkMS5icmFjZVIudXBkYXRlQ29udGV4dCA9IGZ1bmN0aW9uKCkge1xuICBpZiAodGhpcy5jb250ZXh0Lmxlbmd0aCA9PT0gMSkge1xuICAgIHRoaXMuZXhwckFsbG93ZWQgPSB0cnVlO1xuICAgIHJldHVyblxuICB9XG4gIHZhciBvdXQgPSB0aGlzLmNvbnRleHQucG9wKCk7XG4gIGlmIChvdXQgPT09IHR5cGVzLmJfc3RhdCAmJiB0aGlzLmN1ckNvbnRleHQoKS50b2tlbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgb3V0ID0gdGhpcy5jb250ZXh0LnBvcCgpO1xuICB9XG4gIHRoaXMuZXhwckFsbG93ZWQgPSAhb3V0LmlzRXhwcjtcbn07XG5cbnR5cGVzJDEuYnJhY2VMLnVwZGF0ZUNvbnRleHQgPSBmdW5jdGlvbihwcmV2VHlwZSkge1xuICB0aGlzLmNvbnRleHQucHVzaCh0aGlzLmJyYWNlSXNCbG9jayhwcmV2VHlwZSkgPyB0eXBlcy5iX3N0YXQgOiB0eXBlcy5iX2V4cHIpO1xuICB0aGlzLmV4cHJBbGxvd2VkID0gdHJ1ZTtcbn07XG5cbnR5cGVzJDEuZG9sbGFyQnJhY2VMLnVwZGF0ZUNvbnRleHQgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jb250ZXh0LnB1c2godHlwZXMuYl90bXBsKTtcbiAgdGhpcy5leHByQWxsb3dlZCA9IHRydWU7XG59O1xuXG50eXBlcyQxLnBhcmVuTC51cGRhdGVDb250ZXh0ID0gZnVuY3Rpb24ocHJldlR5cGUpIHtcbiAgdmFyIHN0YXRlbWVudFBhcmVucyA9IHByZXZUeXBlID09PSB0eXBlcyQxLl9pZiB8fCBwcmV2VHlwZSA9PT0gdHlwZXMkMS5fZm9yIHx8IHByZXZUeXBlID09PSB0eXBlcyQxLl93aXRoIHx8IHByZXZUeXBlID09PSB0eXBlcyQxLl93aGlsZTtcbiAgdGhpcy5jb250ZXh0LnB1c2goc3RhdGVtZW50UGFyZW5zID8gdHlwZXMucF9zdGF0IDogdHlwZXMucF9leHByKTtcbiAgdGhpcy5leHByQWxsb3dlZCA9IHRydWU7XG59O1xuXG50eXBlcyQxLmluY0RlYy51cGRhdGVDb250ZXh0ID0gZnVuY3Rpb24oKSB7XG4gIC8vIHRva0V4cHJBbGxvd2VkIHN0YXlzIHVuY2hhbmdlZFxufTtcblxudHlwZXMkMS5fZnVuY3Rpb24udXBkYXRlQ29udGV4dCA9IHR5cGVzJDEuX2NsYXNzLnVwZGF0ZUNvbnRleHQgPSBmdW5jdGlvbihwcmV2VHlwZSkge1xuICBpZiAocHJldlR5cGUuYmVmb3JlRXhwciAmJiBwcmV2VHlwZSAhPT0gdHlwZXMkMS5fZWxzZSAmJlxuICAgICAgIShwcmV2VHlwZSA9PT0gdHlwZXMkMS5zZW1pICYmIHRoaXMuY3VyQ29udGV4dCgpICE9PSB0eXBlcy5wX3N0YXQpICYmXG4gICAgICAhKHByZXZUeXBlID09PSB0eXBlcyQxLl9yZXR1cm4gJiYgbGluZUJyZWFrLnRlc3QodGhpcy5pbnB1dC5zbGljZSh0aGlzLmxhc3RUb2tFbmQsIHRoaXMuc3RhcnQpKSkgJiZcbiAgICAgICEoKHByZXZUeXBlID09PSB0eXBlcyQxLmNvbG9uIHx8IHByZXZUeXBlID09PSB0eXBlcyQxLmJyYWNlTCkgJiYgdGhpcy5jdXJDb250ZXh0KCkgPT09IHR5cGVzLmJfc3RhdCkpXG4gICAgeyB0aGlzLmNvbnRleHQucHVzaCh0eXBlcy5mX2V4cHIpOyB9XG4gIGVsc2VcbiAgICB7IHRoaXMuY29udGV4dC5wdXNoKHR5cGVzLmZfc3RhdCk7IH1cbiAgdGhpcy5leHByQWxsb3dlZCA9IGZhbHNlO1xufTtcblxudHlwZXMkMS5iYWNrUXVvdGUudXBkYXRlQ29udGV4dCA9IGZ1bmN0aW9uKCkge1xuICBpZiAodGhpcy5jdXJDb250ZXh0KCkgPT09IHR5cGVzLnFfdG1wbClcbiAgICB7IHRoaXMuY29udGV4dC5wb3AoKTsgfVxuICBlbHNlXG4gICAgeyB0aGlzLmNvbnRleHQucHVzaCh0eXBlcy5xX3RtcGwpOyB9XG4gIHRoaXMuZXhwckFsbG93ZWQgPSBmYWxzZTtcbn07XG5cbnR5cGVzJDEuc3Rhci51cGRhdGVDb250ZXh0ID0gZnVuY3Rpb24ocHJldlR5cGUpIHtcbiAgaWYgKHByZXZUeXBlID09PSB0eXBlcyQxLl9mdW5jdGlvbikge1xuICAgIHZhciBpbmRleCA9IHRoaXMuY29udGV4dC5sZW5ndGggLSAxO1xuICAgIGlmICh0aGlzLmNvbnRleHRbaW5kZXhdID09PSB0eXBlcy5mX2V4cHIpXG4gICAgICB7IHRoaXMuY29udGV4dFtpbmRleF0gPSB0eXBlcy5mX2V4cHJfZ2VuOyB9XG4gICAgZWxzZVxuICAgICAgeyB0aGlzLmNvbnRleHRbaW5kZXhdID0gdHlwZXMuZl9nZW47IH1cbiAgfVxuICB0aGlzLmV4cHJBbGxvd2VkID0gdHJ1ZTtcbn07XG5cbnR5cGVzJDEubmFtZS51cGRhdGVDb250ZXh0ID0gZnVuY3Rpb24ocHJldlR5cGUpIHtcbiAgdmFyIGFsbG93ZWQgPSBmYWxzZTtcbiAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA2ICYmIHByZXZUeXBlICE9PSB0eXBlcyQxLmRvdCkge1xuICAgIGlmICh0aGlzLnZhbHVlID09PSBcIm9mXCIgJiYgIXRoaXMuZXhwckFsbG93ZWQgfHxcbiAgICAgICAgdGhpcy52YWx1ZSA9PT0gXCJ5aWVsZFwiICYmIHRoaXMuaW5HZW5lcmF0b3JDb250ZXh0KCkpXG4gICAgICB7IGFsbG93ZWQgPSB0cnVlOyB9XG4gIH1cbiAgdGhpcy5leHByQWxsb3dlZCA9IGFsbG93ZWQ7XG59O1xuXG4vLyBBIHJlY3Vyc2l2ZSBkZXNjZW50IHBhcnNlciBvcGVyYXRlcyBieSBkZWZpbmluZyBmdW5jdGlvbnMgZm9yIGFsbFxuXG52YXIgcHAkNSA9IFBhcnNlci5wcm90b3R5cGU7XG5cbi8vIENoZWNrIGlmIHByb3BlcnR5IG5hbWUgY2xhc2hlcyB3aXRoIGFscmVhZHkgYWRkZWQuXG4vLyBPYmplY3QvY2xhc3MgZ2V0dGVycyBhbmQgc2V0dGVycyBhcmUgbm90IGFsbG93ZWQgdG8gY2xhc2gg4oCUXG4vLyBlaXRoZXIgd2l0aCBlYWNoIG90aGVyIG9yIHdpdGggYW4gaW5pdCBwcm9wZXJ0eSDigJQgYW5kIGluXG4vLyBzdHJpY3QgbW9kZSwgaW5pdCBwcm9wZXJ0aWVzIGFyZSBhbHNvIG5vdCBhbGxvd2VkIHRvIGJlIHJlcGVhdGVkLlxuXG5wcCQ1LmNoZWNrUHJvcENsYXNoID0gZnVuY3Rpb24ocHJvcCwgcHJvcEhhc2gsIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpIHtcbiAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA5ICYmIHByb3AudHlwZSA9PT0gXCJTcHJlYWRFbGVtZW50XCIpXG4gICAgeyByZXR1cm4gfVxuICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDYgJiYgKHByb3AuY29tcHV0ZWQgfHwgcHJvcC5tZXRob2QgfHwgcHJvcC5zaG9ydGhhbmQpKVxuICAgIHsgcmV0dXJuIH1cbiAgdmFyIGtleSA9IHByb3Aua2V5O1xuICB2YXIgbmFtZTtcbiAgc3dpdGNoIChrZXkudHlwZSkge1xuICBjYXNlIFwiSWRlbnRpZmllclwiOiBuYW1lID0ga2V5Lm5hbWU7IGJyZWFrXG4gIGNhc2UgXCJMaXRlcmFsXCI6IG5hbWUgPSBTdHJpbmcoa2V5LnZhbHVlKTsgYnJlYWtcbiAgZGVmYXVsdDogcmV0dXJuXG4gIH1cbiAgdmFyIGtpbmQgPSBwcm9wLmtpbmQ7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gNikge1xuICAgIGlmIChuYW1lID09PSBcIl9fcHJvdG9fX1wiICYmIGtpbmQgPT09IFwiaW5pdFwiKSB7XG4gICAgICBpZiAocHJvcEhhc2gucHJvdG8pIHtcbiAgICAgICAgaWYgKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpIHtcbiAgICAgICAgICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy5kb3VibGVQcm90byA8IDApIHtcbiAgICAgICAgICAgIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMuZG91YmxlUHJvdG8gPSBrZXkuc3RhcnQ7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucmFpc2VSZWNvdmVyYWJsZShrZXkuc3RhcnQsIFwiUmVkZWZpbml0aW9uIG9mIF9fcHJvdG9fXyBwcm9wZXJ0eVwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcHJvcEhhc2gucHJvdG8gPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm5cbiAgfVxuICBuYW1lID0gXCIkXCIgKyBuYW1lO1xuICB2YXIgb3RoZXIgPSBwcm9wSGFzaFtuYW1lXTtcbiAgaWYgKG90aGVyKSB7XG4gICAgdmFyIHJlZGVmaW5pdGlvbjtcbiAgICBpZiAoa2luZCA9PT0gXCJpbml0XCIpIHtcbiAgICAgIHJlZGVmaW5pdGlvbiA9IHRoaXMuc3RyaWN0ICYmIG90aGVyLmluaXQgfHwgb3RoZXIuZ2V0IHx8IG90aGVyLnNldDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVkZWZpbml0aW9uID0gb3RoZXIuaW5pdCB8fCBvdGhlcltraW5kXTtcbiAgICB9XG4gICAgaWYgKHJlZGVmaW5pdGlvbilcbiAgICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKGtleS5zdGFydCwgXCJSZWRlZmluaXRpb24gb2YgcHJvcGVydHlcIik7IH1cbiAgfSBlbHNlIHtcbiAgICBvdGhlciA9IHByb3BIYXNoW25hbWVdID0ge1xuICAgICAgaW5pdDogZmFsc2UsXG4gICAgICBnZXQ6IGZhbHNlLFxuICAgICAgc2V0OiBmYWxzZVxuICAgIH07XG4gIH1cbiAgb3RoZXJba2luZF0gPSB0cnVlO1xufTtcblxuLy8gIyMjIEV4cHJlc3Npb24gcGFyc2luZ1xuXG4vLyBUaGVzZSBuZXN0LCBmcm9tIHRoZSBtb3N0IGdlbmVyYWwgZXhwcmVzc2lvbiB0eXBlIGF0IHRoZSB0b3AgdG9cbi8vICdhdG9taWMnLCBub25kaXZpc2libGUgZXhwcmVzc2lvbiB0eXBlcyBhdCB0aGUgYm90dG9tLiBNb3N0IG9mXG4vLyB0aGUgZnVuY3Rpb25zIHdpbGwgc2ltcGx5IGxldCB0aGUgZnVuY3Rpb24ocykgYmVsb3cgdGhlbSBwYXJzZSxcbi8vIGFuZCwgKmlmKiB0aGUgc3ludGFjdGljIGNvbnN0cnVjdCB0aGV5IGhhbmRsZSBpcyBwcmVzZW50LCB3cmFwXG4vLyB0aGUgQVNUIG5vZGUgdGhhdCB0aGUgaW5uZXIgcGFyc2VyIGdhdmUgdGhlbSBpbiBhbm90aGVyIG5vZGUuXG5cbi8vIFBhcnNlIGEgZnVsbCBleHByZXNzaW9uLiBUaGUgb3B0aW9uYWwgYXJndW1lbnRzIGFyZSB1c2VkIHRvXG4vLyBmb3JiaWQgdGhlIGBpbmAgb3BlcmF0b3IgKGluIGZvciBsb29wcyBpbml0YWxpemF0aW9uIGV4cHJlc3Npb25zKVxuLy8gYW5kIHByb3ZpZGUgcmVmZXJlbmNlIGZvciBzdG9yaW5nICc9JyBvcGVyYXRvciBpbnNpZGUgc2hvcnRoYW5kXG4vLyBwcm9wZXJ0eSBhc3NpZ25tZW50IGluIGNvbnRleHRzIHdoZXJlIGJvdGggb2JqZWN0IGV4cHJlc3Npb25cbi8vIGFuZCBvYmplY3QgcGF0dGVybiBtaWdodCBhcHBlYXIgKHNvIGl0J3MgcG9zc2libGUgdG8gcmFpc2Vcbi8vIGRlbGF5ZWQgc3ludGF4IGVycm9yIGF0IGNvcnJlY3QgcG9zaXRpb24pLlxuXG5wcCQ1LnBhcnNlRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKGZvckluaXQsIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpIHtcbiAgdmFyIHN0YXJ0UG9zID0gdGhpcy5zdGFydCwgc3RhcnRMb2MgPSB0aGlzLnN0YXJ0TG9jO1xuICB2YXIgZXhwciA9IHRoaXMucGFyc2VNYXliZUFzc2lnbihmb3JJbml0LCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzKTtcbiAgaWYgKHRoaXMudHlwZSA9PT0gdHlwZXMkMS5jb21tYSkge1xuICAgIHZhciBub2RlID0gdGhpcy5zdGFydE5vZGVBdChzdGFydFBvcywgc3RhcnRMb2MpO1xuICAgIG5vZGUuZXhwcmVzc2lvbnMgPSBbZXhwcl07XG4gICAgd2hpbGUgKHRoaXMuZWF0KHR5cGVzJDEuY29tbWEpKSB7IG5vZGUuZXhwcmVzc2lvbnMucHVzaCh0aGlzLnBhcnNlTWF5YmVBc3NpZ24oZm9ySW5pdCwgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykpOyB9XG4gICAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCBcIlNlcXVlbmNlRXhwcmVzc2lvblwiKVxuICB9XG4gIHJldHVybiBleHByXG59O1xuXG4vLyBQYXJzZSBhbiBhc3NpZ25tZW50IGV4cHJlc3Npb24uIFRoaXMgaW5jbHVkZXMgYXBwbGljYXRpb25zIG9mXG4vLyBvcGVyYXRvcnMgbGlrZSBgKz1gLlxuXG5wcCQ1LnBhcnNlTWF5YmVBc3NpZ24gPSBmdW5jdGlvbihmb3JJbml0LCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCBhZnRlckxlZnRQYXJzZSkge1xuICBpZiAodGhpcy5pc0NvbnRleHR1YWwoXCJ5aWVsZFwiKSkge1xuICAgIGlmICh0aGlzLmluR2VuZXJhdG9yKSB7IHJldHVybiB0aGlzLnBhcnNlWWllbGQoZm9ySW5pdCkgfVxuICAgIC8vIFRoZSB0b2tlbml6ZXIgd2lsbCBhc3N1bWUgYW4gZXhwcmVzc2lvbiBpcyBhbGxvd2VkIGFmdGVyXG4gICAgLy8gYHlpZWxkYCwgYnV0IHRoaXMgaXNuJ3QgdGhhdCBraW5kIG9mIHlpZWxkXG4gICAgZWxzZSB7IHRoaXMuZXhwckFsbG93ZWQgPSBmYWxzZTsgfVxuICB9XG5cbiAgdmFyIG93bkRlc3RydWN0dXJpbmdFcnJvcnMgPSBmYWxzZSwgb2xkUGFyZW5Bc3NpZ24gPSAtMSwgb2xkVHJhaWxpbmdDb21tYSA9IC0xLCBvbGREb3VibGVQcm90byA9IC0xO1xuICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykge1xuICAgIG9sZFBhcmVuQXNzaWduID0gcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy5wYXJlbnRoZXNpemVkQXNzaWduO1xuICAgIG9sZFRyYWlsaW5nQ29tbWEgPSByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnRyYWlsaW5nQ29tbWE7XG4gICAgb2xkRG91YmxlUHJvdG8gPSByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLmRvdWJsZVByb3RvO1xuICAgIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMucGFyZW50aGVzaXplZEFzc2lnbiA9IHJlZkRlc3RydWN0dXJpbmdFcnJvcnMudHJhaWxpbmdDb21tYSA9IC0xO1xuICB9IGVsc2Uge1xuICAgIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMgPSBuZXcgRGVzdHJ1Y3R1cmluZ0Vycm9ycztcbiAgICBvd25EZXN0cnVjdHVyaW5nRXJyb3JzID0gdHJ1ZTtcbiAgfVxuXG4gIHZhciBzdGFydFBvcyA9IHRoaXMuc3RhcnQsIHN0YXJ0TG9jID0gdGhpcy5zdGFydExvYztcbiAgaWYgKHRoaXMudHlwZSA9PT0gdHlwZXMkMS5wYXJlbkwgfHwgdGhpcy50eXBlID09PSB0eXBlcyQxLm5hbWUpIHtcbiAgICB0aGlzLnBvdGVudGlhbEFycm93QXQgPSB0aGlzLnN0YXJ0O1xuICAgIHRoaXMucG90ZW50aWFsQXJyb3dJbkZvckF3YWl0ID0gZm9ySW5pdCA9PT0gXCJhd2FpdFwiO1xuICB9XG4gIHZhciBsZWZ0ID0gdGhpcy5wYXJzZU1heWJlQ29uZGl0aW9uYWwoZm9ySW5pdCwgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycyk7XG4gIGlmIChhZnRlckxlZnRQYXJzZSkgeyBsZWZ0ID0gYWZ0ZXJMZWZ0UGFyc2UuY2FsbCh0aGlzLCBsZWZ0LCBzdGFydFBvcywgc3RhcnRMb2MpOyB9XG4gIGlmICh0aGlzLnR5cGUuaXNBc3NpZ24pIHtcbiAgICB2YXIgbm9kZSA9IHRoaXMuc3RhcnROb2RlQXQoc3RhcnRQb3MsIHN0YXJ0TG9jKTtcbiAgICBub2RlLm9wZXJhdG9yID0gdGhpcy52YWx1ZTtcbiAgICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLmVxKVxuICAgICAgeyBsZWZ0ID0gdGhpcy50b0Fzc2lnbmFibGUobGVmdCwgZmFsc2UsIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpOyB9XG4gICAgaWYgKCFvd25EZXN0cnVjdHVyaW5nRXJyb3JzKSB7XG4gICAgICByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnBhcmVudGhlc2l6ZWRBc3NpZ24gPSByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnRyYWlsaW5nQ29tbWEgPSByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLmRvdWJsZVByb3RvID0gLTE7XG4gICAgfVxuICAgIGlmIChyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnNob3J0aGFuZEFzc2lnbiA+PSBsZWZ0LnN0YXJ0KVxuICAgICAgeyByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnNob3J0aGFuZEFzc2lnbiA9IC0xOyB9IC8vIHJlc2V0IGJlY2F1c2Ugc2hvcnRoYW5kIGRlZmF1bHQgd2FzIHVzZWQgY29ycmVjdGx5XG4gICAgaWYgKHRoaXMudHlwZSA9PT0gdHlwZXMkMS5lcSlcbiAgICAgIHsgdGhpcy5jaGVja0xWYWxQYXR0ZXJuKGxlZnQpOyB9XG4gICAgZWxzZVxuICAgICAgeyB0aGlzLmNoZWNrTFZhbFNpbXBsZShsZWZ0KTsgfVxuICAgIG5vZGUubGVmdCA9IGxlZnQ7XG4gICAgdGhpcy5uZXh0KCk7XG4gICAgbm9kZS5yaWdodCA9IHRoaXMucGFyc2VNYXliZUFzc2lnbihmb3JJbml0KTtcbiAgICBpZiAob2xkRG91YmxlUHJvdG8gPiAtMSkgeyByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLmRvdWJsZVByb3RvID0gb2xkRG91YmxlUHJvdG87IH1cbiAgICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiQXNzaWdubWVudEV4cHJlc3Npb25cIilcbiAgfSBlbHNlIHtcbiAgICBpZiAob3duRGVzdHJ1Y3R1cmluZ0Vycm9ycykgeyB0aGlzLmNoZWNrRXhwcmVzc2lvbkVycm9ycyhyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCB0cnVlKTsgfVxuICB9XG4gIGlmIChvbGRQYXJlbkFzc2lnbiA+IC0xKSB7IHJlZkRlc3RydWN0dXJpbmdFcnJvcnMucGFyZW50aGVzaXplZEFzc2lnbiA9IG9sZFBhcmVuQXNzaWduOyB9XG4gIGlmIChvbGRUcmFpbGluZ0NvbW1hID4gLTEpIHsgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy50cmFpbGluZ0NvbW1hID0gb2xkVHJhaWxpbmdDb21tYTsgfVxuICByZXR1cm4gbGVmdFxufTtcblxuLy8gUGFyc2UgYSB0ZXJuYXJ5IGNvbmRpdGlvbmFsIChgPzpgKSBvcGVyYXRvci5cblxucHAkNS5wYXJzZU1heWJlQ29uZGl0aW9uYWwgPSBmdW5jdGlvbihmb3JJbml0LCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzKSB7XG4gIHZhciBzdGFydFBvcyA9IHRoaXMuc3RhcnQsIHN0YXJ0TG9jID0gdGhpcy5zdGFydExvYztcbiAgdmFyIGV4cHIgPSB0aGlzLnBhcnNlRXhwck9wcyhmb3JJbml0LCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzKTtcbiAgaWYgKHRoaXMuY2hlY2tFeHByZXNzaW9uRXJyb3JzKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpKSB7IHJldHVybiBleHByIH1cbiAgaWYgKHRoaXMuZWF0KHR5cGVzJDEucXVlc3Rpb24pKSB7XG4gICAgdmFyIG5vZGUgPSB0aGlzLnN0YXJ0Tm9kZUF0KHN0YXJ0UG9zLCBzdGFydExvYyk7XG4gICAgbm9kZS50ZXN0ID0gZXhwcjtcbiAgICBub2RlLmNvbnNlcXVlbnQgPSB0aGlzLnBhcnNlTWF5YmVBc3NpZ24oKTtcbiAgICB0aGlzLmV4cGVjdCh0eXBlcyQxLmNvbG9uKTtcbiAgICBub2RlLmFsdGVybmF0ZSA9IHRoaXMucGFyc2VNYXliZUFzc2lnbihmb3JJbml0KTtcbiAgICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiQ29uZGl0aW9uYWxFeHByZXNzaW9uXCIpXG4gIH1cbiAgcmV0dXJuIGV4cHJcbn07XG5cbi8vIFN0YXJ0IHRoZSBwcmVjZWRlbmNlIHBhcnNlci5cblxucHAkNS5wYXJzZUV4cHJPcHMgPSBmdW5jdGlvbihmb3JJbml0LCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzKSB7XG4gIHZhciBzdGFydFBvcyA9IHRoaXMuc3RhcnQsIHN0YXJ0TG9jID0gdGhpcy5zdGFydExvYztcbiAgdmFyIGV4cHIgPSB0aGlzLnBhcnNlTWF5YmVVbmFyeShyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCBmYWxzZSwgZmFsc2UsIGZvckluaXQpO1xuICBpZiAodGhpcy5jaGVja0V4cHJlc3Npb25FcnJvcnMocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykpIHsgcmV0dXJuIGV4cHIgfVxuICByZXR1cm4gZXhwci5zdGFydCA9PT0gc3RhcnRQb3MgJiYgZXhwci50eXBlID09PSBcIkFycm93RnVuY3Rpb25FeHByZXNzaW9uXCIgPyBleHByIDogdGhpcy5wYXJzZUV4cHJPcChleHByLCBzdGFydFBvcywgc3RhcnRMb2MsIC0xLCBmb3JJbml0KVxufTtcblxuLy8gUGFyc2UgYmluYXJ5IG9wZXJhdG9ycyB3aXRoIHRoZSBvcGVyYXRvciBwcmVjZWRlbmNlIHBhcnNpbmdcbi8vIGFsZ29yaXRobS4gYGxlZnRgIGlzIHRoZSBsZWZ0LWhhbmQgc2lkZSBvZiB0aGUgb3BlcmF0b3IuXG4vLyBgbWluUHJlY2AgcHJvdmlkZXMgY29udGV4dCB0aGF0IGFsbG93cyB0aGUgZnVuY3Rpb24gdG8gc3RvcCBhbmRcbi8vIGRlZmVyIGZ1cnRoZXIgcGFyc2VyIHRvIG9uZSBvZiBpdHMgY2FsbGVycyB3aGVuIGl0IGVuY291bnRlcnMgYW5cbi8vIG9wZXJhdG9yIHRoYXQgaGFzIGEgbG93ZXIgcHJlY2VkZW5jZSB0aGFuIHRoZSBzZXQgaXQgaXMgcGFyc2luZy5cblxucHAkNS5wYXJzZUV4cHJPcCA9IGZ1bmN0aW9uKGxlZnQsIGxlZnRTdGFydFBvcywgbGVmdFN0YXJ0TG9jLCBtaW5QcmVjLCBmb3JJbml0KSB7XG4gIHZhciBwcmVjID0gdGhpcy50eXBlLmJpbm9wO1xuICBpZiAocHJlYyAhPSBudWxsICYmICghZm9ySW5pdCB8fCB0aGlzLnR5cGUgIT09IHR5cGVzJDEuX2luKSkge1xuICAgIGlmIChwcmVjID4gbWluUHJlYykge1xuICAgICAgdmFyIGxvZ2ljYWwgPSB0aGlzLnR5cGUgPT09IHR5cGVzJDEubG9naWNhbE9SIHx8IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5sb2dpY2FsQU5EO1xuICAgICAgdmFyIGNvYWxlc2NlID0gdGhpcy50eXBlID09PSB0eXBlcyQxLmNvYWxlc2NlO1xuICAgICAgaWYgKGNvYWxlc2NlKSB7XG4gICAgICAgIC8vIEhhbmRsZSB0aGUgcHJlY2VkZW5jZSBvZiBgdHQuY29hbGVzY2VgIGFzIGVxdWFsIHRvIHRoZSByYW5nZSBvZiBsb2dpY2FsIGV4cHJlc3Npb25zLlxuICAgICAgICAvLyBJbiBvdGhlciB3b3JkcywgYG5vZGUucmlnaHRgIHNob3VsZG4ndCBjb250YWluIGxvZ2ljYWwgZXhwcmVzc2lvbnMgaW4gb3JkZXIgdG8gY2hlY2sgdGhlIG1peGVkIGVycm9yLlxuICAgICAgICBwcmVjID0gdHlwZXMkMS5sb2dpY2FsQU5ELmJpbm9wO1xuICAgICAgfVxuICAgICAgdmFyIG9wID0gdGhpcy52YWx1ZTtcbiAgICAgIHRoaXMubmV4dCgpO1xuICAgICAgdmFyIHN0YXJ0UG9zID0gdGhpcy5zdGFydCwgc3RhcnRMb2MgPSB0aGlzLnN0YXJ0TG9jO1xuICAgICAgdmFyIHJpZ2h0ID0gdGhpcy5wYXJzZUV4cHJPcCh0aGlzLnBhcnNlTWF5YmVVbmFyeShudWxsLCBmYWxzZSwgZmFsc2UsIGZvckluaXQpLCBzdGFydFBvcywgc3RhcnRMb2MsIHByZWMsIGZvckluaXQpO1xuICAgICAgdmFyIG5vZGUgPSB0aGlzLmJ1aWxkQmluYXJ5KGxlZnRTdGFydFBvcywgbGVmdFN0YXJ0TG9jLCBsZWZ0LCByaWdodCwgb3AsIGxvZ2ljYWwgfHwgY29hbGVzY2UpO1xuICAgICAgaWYgKChsb2dpY2FsICYmIHRoaXMudHlwZSA9PT0gdHlwZXMkMS5jb2FsZXNjZSkgfHwgKGNvYWxlc2NlICYmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEubG9naWNhbE9SIHx8IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5sb2dpY2FsQU5EKSkpIHtcbiAgICAgICAgdGhpcy5yYWlzZVJlY292ZXJhYmxlKHRoaXMuc3RhcnQsIFwiTG9naWNhbCBleHByZXNzaW9ucyBhbmQgY29hbGVzY2UgZXhwcmVzc2lvbnMgY2Fubm90IGJlIG1peGVkLiBXcmFwIGVpdGhlciBieSBwYXJlbnRoZXNlc1wiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnBhcnNlRXhwck9wKG5vZGUsIGxlZnRTdGFydFBvcywgbGVmdFN0YXJ0TG9jLCBtaW5QcmVjLCBmb3JJbml0KVxuICAgIH1cbiAgfVxuICByZXR1cm4gbGVmdFxufTtcblxucHAkNS5idWlsZEJpbmFyeSA9IGZ1bmN0aW9uKHN0YXJ0UG9zLCBzdGFydExvYywgbGVmdCwgcmlnaHQsIG9wLCBsb2dpY2FsKSB7XG4gIGlmIChyaWdodC50eXBlID09PSBcIlByaXZhdGVJZGVudGlmaWVyXCIpIHsgdGhpcy5yYWlzZShyaWdodC5zdGFydCwgXCJQcml2YXRlIGlkZW50aWZpZXIgY2FuIG9ubHkgYmUgbGVmdCBzaWRlIG9mIGJpbmFyeSBleHByZXNzaW9uXCIpOyB9XG4gIHZhciBub2RlID0gdGhpcy5zdGFydE5vZGVBdChzdGFydFBvcywgc3RhcnRMb2MpO1xuICBub2RlLmxlZnQgPSBsZWZ0O1xuICBub2RlLm9wZXJhdG9yID0gb3A7XG4gIG5vZGUucmlnaHQgPSByaWdodDtcbiAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCBsb2dpY2FsID8gXCJMb2dpY2FsRXhwcmVzc2lvblwiIDogXCJCaW5hcnlFeHByZXNzaW9uXCIpXG59O1xuXG4vLyBQYXJzZSB1bmFyeSBvcGVyYXRvcnMsIGJvdGggcHJlZml4IGFuZCBwb3N0Zml4LlxuXG5wcCQ1LnBhcnNlTWF5YmVVbmFyeSA9IGZ1bmN0aW9uKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMsIHNhd1VuYXJ5LCBpbmNEZWMsIGZvckluaXQpIHtcbiAgdmFyIHN0YXJ0UG9zID0gdGhpcy5zdGFydCwgc3RhcnRMb2MgPSB0aGlzLnN0YXJ0TG9jLCBleHByO1xuICBpZiAodGhpcy5pc0NvbnRleHR1YWwoXCJhd2FpdFwiKSAmJiB0aGlzLmNhbkF3YWl0KSB7XG4gICAgZXhwciA9IHRoaXMucGFyc2VBd2FpdChmb3JJbml0KTtcbiAgICBzYXdVbmFyeSA9IHRydWU7XG4gIH0gZWxzZSBpZiAodGhpcy50eXBlLnByZWZpeCkge1xuICAgIHZhciBub2RlID0gdGhpcy5zdGFydE5vZGUoKSwgdXBkYXRlID0gdGhpcy50eXBlID09PSB0eXBlcyQxLmluY0RlYztcbiAgICBub2RlLm9wZXJhdG9yID0gdGhpcy52YWx1ZTtcbiAgICBub2RlLnByZWZpeCA9IHRydWU7XG4gICAgdGhpcy5uZXh0KCk7XG4gICAgbm9kZS5hcmd1bWVudCA9IHRoaXMucGFyc2VNYXliZVVuYXJ5KG51bGwsIHRydWUsIHVwZGF0ZSwgZm9ySW5pdCk7XG4gICAgdGhpcy5jaGVja0V4cHJlc3Npb25FcnJvcnMocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycywgdHJ1ZSk7XG4gICAgaWYgKHVwZGF0ZSkgeyB0aGlzLmNoZWNrTFZhbFNpbXBsZShub2RlLmFyZ3VtZW50KTsgfVxuICAgIGVsc2UgaWYgKHRoaXMuc3RyaWN0ICYmIG5vZGUub3BlcmF0b3IgPT09IFwiZGVsZXRlXCIgJiZcbiAgICAgICAgICAgICBub2RlLmFyZ3VtZW50LnR5cGUgPT09IFwiSWRlbnRpZmllclwiKVxuICAgICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUobm9kZS5zdGFydCwgXCJEZWxldGluZyBsb2NhbCB2YXJpYWJsZSBpbiBzdHJpY3QgbW9kZVwiKTsgfVxuICAgIGVsc2UgaWYgKG5vZGUub3BlcmF0b3IgPT09IFwiZGVsZXRlXCIgJiYgaXNQcml2YXRlRmllbGRBY2Nlc3Mobm9kZS5hcmd1bWVudCkpXG4gICAgICB7IHRoaXMucmFpc2VSZWNvdmVyYWJsZShub2RlLnN0YXJ0LCBcIlByaXZhdGUgZmllbGRzIGNhbiBub3QgYmUgZGVsZXRlZFwiKTsgfVxuICAgIGVsc2UgeyBzYXdVbmFyeSA9IHRydWU7IH1cbiAgICBleHByID0gdGhpcy5maW5pc2hOb2RlKG5vZGUsIHVwZGF0ZSA/IFwiVXBkYXRlRXhwcmVzc2lvblwiIDogXCJVbmFyeUV4cHJlc3Npb25cIik7XG4gIH0gZWxzZSBpZiAoIXNhd1VuYXJ5ICYmIHRoaXMudHlwZSA9PT0gdHlwZXMkMS5wcml2YXRlSWQpIHtcbiAgICBpZiAoZm9ySW5pdCB8fCB0aGlzLnByaXZhdGVOYW1lU3RhY2subGVuZ3RoID09PSAwKSB7IHRoaXMudW5leHBlY3RlZCgpOyB9XG4gICAgZXhwciA9IHRoaXMucGFyc2VQcml2YXRlSWRlbnQoKTtcbiAgICAvLyBvbmx5IGNvdWxkIGJlIHByaXZhdGUgZmllbGRzIGluICdpbicsIHN1Y2ggYXMgI3ggaW4gb2JqXG4gICAgaWYgKHRoaXMudHlwZSAhPT0gdHlwZXMkMS5faW4pIHsgdGhpcy51bmV4cGVjdGVkKCk7IH1cbiAgfSBlbHNlIHtcbiAgICBleHByID0gdGhpcy5wYXJzZUV4cHJTdWJzY3JpcHRzKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMsIGZvckluaXQpO1xuICAgIGlmICh0aGlzLmNoZWNrRXhwcmVzc2lvbkVycm9ycyhyZWZEZXN0cnVjdHVyaW5nRXJyb3JzKSkgeyByZXR1cm4gZXhwciB9XG4gICAgd2hpbGUgKHRoaXMudHlwZS5wb3N0Zml4ICYmICF0aGlzLmNhbkluc2VydFNlbWljb2xvbigpKSB7XG4gICAgICB2YXIgbm9kZSQxID0gdGhpcy5zdGFydE5vZGVBdChzdGFydFBvcywgc3RhcnRMb2MpO1xuICAgICAgbm9kZSQxLm9wZXJhdG9yID0gdGhpcy52YWx1ZTtcbiAgICAgIG5vZGUkMS5wcmVmaXggPSBmYWxzZTtcbiAgICAgIG5vZGUkMS5hcmd1bWVudCA9IGV4cHI7XG4gICAgICB0aGlzLmNoZWNrTFZhbFNpbXBsZShleHByKTtcbiAgICAgIHRoaXMubmV4dCgpO1xuICAgICAgZXhwciA9IHRoaXMuZmluaXNoTm9kZShub2RlJDEsIFwiVXBkYXRlRXhwcmVzc2lvblwiKTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWluY0RlYyAmJiB0aGlzLmVhdCh0eXBlcyQxLnN0YXJzdGFyKSkge1xuICAgIGlmIChzYXdVbmFyeSlcbiAgICAgIHsgdGhpcy51bmV4cGVjdGVkKHRoaXMubGFzdFRva1N0YXJ0KTsgfVxuICAgIGVsc2VcbiAgICAgIHsgcmV0dXJuIHRoaXMuYnVpbGRCaW5hcnkoc3RhcnRQb3MsIHN0YXJ0TG9jLCBleHByLCB0aGlzLnBhcnNlTWF5YmVVbmFyeShudWxsLCBmYWxzZSwgZmFsc2UsIGZvckluaXQpLCBcIioqXCIsIGZhbHNlKSB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGV4cHJcbiAgfVxufTtcblxuZnVuY3Rpb24gaXNQcml2YXRlRmllbGRBY2Nlc3Mobm9kZSkge1xuICByZXR1cm4gKFxuICAgIG5vZGUudHlwZSA9PT0gXCJNZW1iZXJFeHByZXNzaW9uXCIgJiYgbm9kZS5wcm9wZXJ0eS50eXBlID09PSBcIlByaXZhdGVJZGVudGlmaWVyXCIgfHxcbiAgICBub2RlLnR5cGUgPT09IFwiQ2hhaW5FeHByZXNzaW9uXCIgJiYgaXNQcml2YXRlRmllbGRBY2Nlc3Mobm9kZS5leHByZXNzaW9uKVxuICApXG59XG5cbi8vIFBhcnNlIGNhbGwsIGRvdCwgYW5kIGBbXWAtc3Vic2NyaXB0IGV4cHJlc3Npb25zLlxuXG5wcCQ1LnBhcnNlRXhwclN1YnNjcmlwdHMgPSBmdW5jdGlvbihyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCBmb3JJbml0KSB7XG4gIHZhciBzdGFydFBvcyA9IHRoaXMuc3RhcnQsIHN0YXJ0TG9jID0gdGhpcy5zdGFydExvYztcbiAgdmFyIGV4cHIgPSB0aGlzLnBhcnNlRXhwckF0b20ocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycywgZm9ySW5pdCk7XG4gIGlmIChleHByLnR5cGUgPT09IFwiQXJyb3dGdW5jdGlvbkV4cHJlc3Npb25cIiAmJiB0aGlzLmlucHV0LnNsaWNlKHRoaXMubGFzdFRva1N0YXJ0LCB0aGlzLmxhc3RUb2tFbmQpICE9PSBcIilcIilcbiAgICB7IHJldHVybiBleHByIH1cbiAgdmFyIHJlc3VsdCA9IHRoaXMucGFyc2VTdWJzY3JpcHRzKGV4cHIsIHN0YXJ0UG9zLCBzdGFydExvYywgZmFsc2UsIGZvckluaXQpO1xuICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycyAmJiByZXN1bHQudHlwZSA9PT0gXCJNZW1iZXJFeHByZXNzaW9uXCIpIHtcbiAgICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy5wYXJlbnRoZXNpemVkQXNzaWduID49IHJlc3VsdC5zdGFydCkgeyByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnBhcmVudGhlc2l6ZWRBc3NpZ24gPSAtMTsgfVxuICAgIGlmIChyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnBhcmVudGhlc2l6ZWRCaW5kID49IHJlc3VsdC5zdGFydCkgeyByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnBhcmVudGhlc2l6ZWRCaW5kID0gLTE7IH1cbiAgICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy50cmFpbGluZ0NvbW1hID49IHJlc3VsdC5zdGFydCkgeyByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnRyYWlsaW5nQ29tbWEgPSAtMTsgfVxuICB9XG4gIHJldHVybiByZXN1bHRcbn07XG5cbnBwJDUucGFyc2VTdWJzY3JpcHRzID0gZnVuY3Rpb24oYmFzZSwgc3RhcnRQb3MsIHN0YXJ0TG9jLCBub0NhbGxzLCBmb3JJbml0KSB7XG4gIHZhciBtYXliZUFzeW5jQXJyb3cgPSB0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOCAmJiBiYXNlLnR5cGUgPT09IFwiSWRlbnRpZmllclwiICYmIGJhc2UubmFtZSA9PT0gXCJhc3luY1wiICYmXG4gICAgICB0aGlzLmxhc3RUb2tFbmQgPT09IGJhc2UuZW5kICYmICF0aGlzLmNhbkluc2VydFNlbWljb2xvbigpICYmIGJhc2UuZW5kIC0gYmFzZS5zdGFydCA9PT0gNSAmJlxuICAgICAgdGhpcy5wb3RlbnRpYWxBcnJvd0F0ID09PSBiYXNlLnN0YXJ0O1xuICB2YXIgb3B0aW9uYWxDaGFpbmVkID0gZmFsc2U7XG5cbiAgd2hpbGUgKHRydWUpIHtcbiAgICB2YXIgZWxlbWVudCA9IHRoaXMucGFyc2VTdWJzY3JpcHQoYmFzZSwgc3RhcnRQb3MsIHN0YXJ0TG9jLCBub0NhbGxzLCBtYXliZUFzeW5jQXJyb3csIG9wdGlvbmFsQ2hhaW5lZCwgZm9ySW5pdCk7XG5cbiAgICBpZiAoZWxlbWVudC5vcHRpb25hbCkgeyBvcHRpb25hbENoYWluZWQgPSB0cnVlOyB9XG4gICAgaWYgKGVsZW1lbnQgPT09IGJhc2UgfHwgZWxlbWVudC50eXBlID09PSBcIkFycm93RnVuY3Rpb25FeHByZXNzaW9uXCIpIHtcbiAgICAgIGlmIChvcHRpb25hbENoYWluZWQpIHtcbiAgICAgICAgdmFyIGNoYWluTm9kZSA9IHRoaXMuc3RhcnROb2RlQXQoc3RhcnRQb3MsIHN0YXJ0TG9jKTtcbiAgICAgICAgY2hhaW5Ob2RlLmV4cHJlc3Npb24gPSBlbGVtZW50O1xuICAgICAgICBlbGVtZW50ID0gdGhpcy5maW5pc2hOb2RlKGNoYWluTm9kZSwgXCJDaGFpbkV4cHJlc3Npb25cIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gZWxlbWVudFxuICAgIH1cblxuICAgIGJhc2UgPSBlbGVtZW50O1xuICB9XG59O1xuXG5wcCQ1LnBhcnNlU3Vic2NyaXB0ID0gZnVuY3Rpb24oYmFzZSwgc3RhcnRQb3MsIHN0YXJ0TG9jLCBub0NhbGxzLCBtYXliZUFzeW5jQXJyb3csIG9wdGlvbmFsQ2hhaW5lZCwgZm9ySW5pdCkge1xuICB2YXIgb3B0aW9uYWxTdXBwb3J0ZWQgPSB0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gMTE7XG4gIHZhciBvcHRpb25hbCA9IG9wdGlvbmFsU3VwcG9ydGVkICYmIHRoaXMuZWF0KHR5cGVzJDEucXVlc3Rpb25Eb3QpO1xuICBpZiAobm9DYWxscyAmJiBvcHRpb25hbCkgeyB0aGlzLnJhaXNlKHRoaXMubGFzdFRva1N0YXJ0LCBcIk9wdGlvbmFsIGNoYWluaW5nIGNhbm5vdCBhcHBlYXIgaW4gdGhlIGNhbGxlZSBvZiBuZXcgZXhwcmVzc2lvbnNcIik7IH1cblxuICB2YXIgY29tcHV0ZWQgPSB0aGlzLmVhdCh0eXBlcyQxLmJyYWNrZXRMKTtcbiAgaWYgKGNvbXB1dGVkIHx8IChvcHRpb25hbCAmJiB0aGlzLnR5cGUgIT09IHR5cGVzJDEucGFyZW5MICYmIHRoaXMudHlwZSAhPT0gdHlwZXMkMS5iYWNrUXVvdGUpIHx8IHRoaXMuZWF0KHR5cGVzJDEuZG90KSkge1xuICAgIHZhciBub2RlID0gdGhpcy5zdGFydE5vZGVBdChzdGFydFBvcywgc3RhcnRMb2MpO1xuICAgIG5vZGUub2JqZWN0ID0gYmFzZTtcbiAgICBpZiAoY29tcHV0ZWQpIHtcbiAgICAgIG5vZGUucHJvcGVydHkgPSB0aGlzLnBhcnNlRXhwcmVzc2lvbigpO1xuICAgICAgdGhpcy5leHBlY3QodHlwZXMkMS5icmFja2V0Uik7XG4gICAgfSBlbHNlIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEucHJpdmF0ZUlkICYmIGJhc2UudHlwZSAhPT0gXCJTdXBlclwiKSB7XG4gICAgICBub2RlLnByb3BlcnR5ID0gdGhpcy5wYXJzZVByaXZhdGVJZGVudCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBub2RlLnByb3BlcnR5ID0gdGhpcy5wYXJzZUlkZW50KHRoaXMub3B0aW9ucy5hbGxvd1Jlc2VydmVkICE9PSBcIm5ldmVyXCIpO1xuICAgIH1cbiAgICBub2RlLmNvbXB1dGVkID0gISFjb21wdXRlZDtcbiAgICBpZiAob3B0aW9uYWxTdXBwb3J0ZWQpIHtcbiAgICAgIG5vZGUub3B0aW9uYWwgPSBvcHRpb25hbDtcbiAgICB9XG4gICAgYmFzZSA9IHRoaXMuZmluaXNoTm9kZShub2RlLCBcIk1lbWJlckV4cHJlc3Npb25cIik7XG4gIH0gZWxzZSBpZiAoIW5vQ2FsbHMgJiYgdGhpcy5lYXQodHlwZXMkMS5wYXJlbkwpKSB7XG4gICAgdmFyIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMgPSBuZXcgRGVzdHJ1Y3R1cmluZ0Vycm9ycywgb2xkWWllbGRQb3MgPSB0aGlzLnlpZWxkUG9zLCBvbGRBd2FpdFBvcyA9IHRoaXMuYXdhaXRQb3MsIG9sZEF3YWl0SWRlbnRQb3MgPSB0aGlzLmF3YWl0SWRlbnRQb3M7XG4gICAgdGhpcy55aWVsZFBvcyA9IDA7XG4gICAgdGhpcy5hd2FpdFBvcyA9IDA7XG4gICAgdGhpcy5hd2FpdElkZW50UG9zID0gMDtcbiAgICB2YXIgZXhwckxpc3QgPSB0aGlzLnBhcnNlRXhwckxpc3QodHlwZXMkMS5wYXJlblIsIHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA4LCBmYWxzZSwgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycyk7XG4gICAgaWYgKG1heWJlQXN5bmNBcnJvdyAmJiAhb3B0aW9uYWwgJiYgIXRoaXMuY2FuSW5zZXJ0U2VtaWNvbG9uKCkgJiYgdGhpcy5lYXQodHlwZXMkMS5hcnJvdykpIHtcbiAgICAgIHRoaXMuY2hlY2tQYXR0ZXJuRXJyb3JzKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMsIGZhbHNlKTtcbiAgICAgIHRoaXMuY2hlY2tZaWVsZEF3YWl0SW5EZWZhdWx0UGFyYW1zKCk7XG4gICAgICBpZiAodGhpcy5hd2FpdElkZW50UG9zID4gMClcbiAgICAgICAgeyB0aGlzLnJhaXNlKHRoaXMuYXdhaXRJZGVudFBvcywgXCJDYW5ub3QgdXNlICdhd2FpdCcgYXMgaWRlbnRpZmllciBpbnNpZGUgYW4gYXN5bmMgZnVuY3Rpb25cIik7IH1cbiAgICAgIHRoaXMueWllbGRQb3MgPSBvbGRZaWVsZFBvcztcbiAgICAgIHRoaXMuYXdhaXRQb3MgPSBvbGRBd2FpdFBvcztcbiAgICAgIHRoaXMuYXdhaXRJZGVudFBvcyA9IG9sZEF3YWl0SWRlbnRQb3M7XG4gICAgICByZXR1cm4gdGhpcy5wYXJzZUFycm93RXhwcmVzc2lvbih0aGlzLnN0YXJ0Tm9kZUF0KHN0YXJ0UG9zLCBzdGFydExvYyksIGV4cHJMaXN0LCB0cnVlLCBmb3JJbml0KVxuICAgIH1cbiAgICB0aGlzLmNoZWNrRXhwcmVzc2lvbkVycm9ycyhyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCB0cnVlKTtcbiAgICB0aGlzLnlpZWxkUG9zID0gb2xkWWllbGRQb3MgfHwgdGhpcy55aWVsZFBvcztcbiAgICB0aGlzLmF3YWl0UG9zID0gb2xkQXdhaXRQb3MgfHwgdGhpcy5hd2FpdFBvcztcbiAgICB0aGlzLmF3YWl0SWRlbnRQb3MgPSBvbGRBd2FpdElkZW50UG9zIHx8IHRoaXMuYXdhaXRJZGVudFBvcztcbiAgICB2YXIgbm9kZSQxID0gdGhpcy5zdGFydE5vZGVBdChzdGFydFBvcywgc3RhcnRMb2MpO1xuICAgIG5vZGUkMS5jYWxsZWUgPSBiYXNlO1xuICAgIG5vZGUkMS5hcmd1bWVudHMgPSBleHByTGlzdDtcbiAgICBpZiAob3B0aW9uYWxTdXBwb3J0ZWQpIHtcbiAgICAgIG5vZGUkMS5vcHRpb25hbCA9IG9wdGlvbmFsO1xuICAgIH1cbiAgICBiYXNlID0gdGhpcy5maW5pc2hOb2RlKG5vZGUkMSwgXCJDYWxsRXhwcmVzc2lvblwiKTtcbiAgfSBlbHNlIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEuYmFja1F1b3RlKSB7XG4gICAgaWYgKG9wdGlvbmFsIHx8IG9wdGlvbmFsQ2hhaW5lZCkge1xuICAgICAgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIk9wdGlvbmFsIGNoYWluaW5nIGNhbm5vdCBhcHBlYXIgaW4gdGhlIHRhZyBvZiB0YWdnZWQgdGVtcGxhdGUgZXhwcmVzc2lvbnNcIik7XG4gICAgfVxuICAgIHZhciBub2RlJDIgPSB0aGlzLnN0YXJ0Tm9kZUF0KHN0YXJ0UG9zLCBzdGFydExvYyk7XG4gICAgbm9kZSQyLnRhZyA9IGJhc2U7XG4gICAgbm9kZSQyLnF1YXNpID0gdGhpcy5wYXJzZVRlbXBsYXRlKHtpc1RhZ2dlZDogdHJ1ZX0pO1xuICAgIGJhc2UgPSB0aGlzLmZpbmlzaE5vZGUobm9kZSQyLCBcIlRhZ2dlZFRlbXBsYXRlRXhwcmVzc2lvblwiKTtcbiAgfVxuICByZXR1cm4gYmFzZVxufTtcblxuLy8gUGFyc2UgYW4gYXRvbWljIGV4cHJlc3Npb24g4oCUIGVpdGhlciBhIHNpbmdsZSB0b2tlbiB0aGF0IGlzIGFuXG4vLyBleHByZXNzaW9uLCBhbiBleHByZXNzaW9uIHN0YXJ0ZWQgYnkgYSBrZXl3b3JkIGxpa2UgYGZ1bmN0aW9uYCBvclxuLy8gYG5ld2AsIG9yIGFuIGV4cHJlc3Npb24gd3JhcHBlZCBpbiBwdW5jdHVhdGlvbiBsaWtlIGAoKWAsIGBbXWAsXG4vLyBvciBge31gLlxuXG5wcCQ1LnBhcnNlRXhwckF0b20gPSBmdW5jdGlvbihyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCBmb3JJbml0KSB7XG4gIC8vIElmIGEgZGl2aXNpb24gb3BlcmF0b3IgYXBwZWFycyBpbiBhbiBleHByZXNzaW9uIHBvc2l0aW9uLCB0aGVcbiAgLy8gdG9rZW5pemVyIGdvdCBjb25mdXNlZCwgYW5kIHdlIGZvcmNlIGl0IHRvIHJlYWQgYSByZWdleHAgaW5zdGVhZC5cbiAgaWYgKHRoaXMudHlwZSA9PT0gdHlwZXMkMS5zbGFzaCkgeyB0aGlzLnJlYWRSZWdleHAoKTsgfVxuXG4gIHZhciBub2RlLCBjYW5CZUFycm93ID0gdGhpcy5wb3RlbnRpYWxBcnJvd0F0ID09PSB0aGlzLnN0YXJ0O1xuICBzd2l0Y2ggKHRoaXMudHlwZSkge1xuICBjYXNlIHR5cGVzJDEuX3N1cGVyOlxuICAgIGlmICghdGhpcy5hbGxvd1N1cGVyKVxuICAgICAgeyB0aGlzLnJhaXNlKHRoaXMuc3RhcnQsIFwiJ3N1cGVyJyBrZXl3b3JkIG91dHNpZGUgYSBtZXRob2RcIik7IH1cbiAgICBub2RlID0gdGhpcy5zdGFydE5vZGUoKTtcbiAgICB0aGlzLm5leHQoKTtcbiAgICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLnBhcmVuTCAmJiAhdGhpcy5hbGxvd0RpcmVjdFN1cGVyKVxuICAgICAgeyB0aGlzLnJhaXNlKG5vZGUuc3RhcnQsIFwic3VwZXIoKSBjYWxsIG91dHNpZGUgY29uc3RydWN0b3Igb2YgYSBzdWJjbGFzc1wiKTsgfVxuICAgIC8vIFRoZSBgc3VwZXJgIGtleXdvcmQgY2FuIGFwcGVhciBhdCBiZWxvdzpcbiAgICAvLyBTdXBlclByb3BlcnR5OlxuICAgIC8vICAgICBzdXBlciBbIEV4cHJlc3Npb24gXVxuICAgIC8vICAgICBzdXBlciAuIElkZW50aWZpZXJOYW1lXG4gICAgLy8gU3VwZXJDYWxsOlxuICAgIC8vICAgICBzdXBlciAoIEFyZ3VtZW50cyApXG4gICAgaWYgKHRoaXMudHlwZSAhPT0gdHlwZXMkMS5kb3QgJiYgdGhpcy50eXBlICE9PSB0eXBlcyQxLmJyYWNrZXRMICYmIHRoaXMudHlwZSAhPT0gdHlwZXMkMS5wYXJlbkwpXG4gICAgICB7IHRoaXMudW5leHBlY3RlZCgpOyB9XG4gICAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCBcIlN1cGVyXCIpXG5cbiAgY2FzZSB0eXBlcyQxLl90aGlzOlxuICAgIG5vZGUgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICAgIHRoaXMubmV4dCgpO1xuICAgIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJUaGlzRXhwcmVzc2lvblwiKVxuXG4gIGNhc2UgdHlwZXMkMS5uYW1lOlxuICAgIHZhciBzdGFydFBvcyA9IHRoaXMuc3RhcnQsIHN0YXJ0TG9jID0gdGhpcy5zdGFydExvYywgY29udGFpbnNFc2MgPSB0aGlzLmNvbnRhaW5zRXNjO1xuICAgIHZhciBpZCA9IHRoaXMucGFyc2VJZGVudChmYWxzZSk7XG4gICAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA4ICYmICFjb250YWluc0VzYyAmJiBpZC5uYW1lID09PSBcImFzeW5jXCIgJiYgIXRoaXMuY2FuSW5zZXJ0U2VtaWNvbG9uKCkgJiYgdGhpcy5lYXQodHlwZXMkMS5fZnVuY3Rpb24pKSB7XG4gICAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCh0eXBlcy5mX2V4cHIpO1xuICAgICAgcmV0dXJuIHRoaXMucGFyc2VGdW5jdGlvbih0aGlzLnN0YXJ0Tm9kZUF0KHN0YXJ0UG9zLCBzdGFydExvYyksIDAsIGZhbHNlLCB0cnVlLCBmb3JJbml0KVxuICAgIH1cbiAgICBpZiAoY2FuQmVBcnJvdyAmJiAhdGhpcy5jYW5JbnNlcnRTZW1pY29sb24oKSkge1xuICAgICAgaWYgKHRoaXMuZWF0KHR5cGVzJDEuYXJyb3cpKVxuICAgICAgICB7IHJldHVybiB0aGlzLnBhcnNlQXJyb3dFeHByZXNzaW9uKHRoaXMuc3RhcnROb2RlQXQoc3RhcnRQb3MsIHN0YXJ0TG9jKSwgW2lkXSwgZmFsc2UsIGZvckluaXQpIH1cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOCAmJiBpZC5uYW1lID09PSBcImFzeW5jXCIgJiYgdGhpcy50eXBlID09PSB0eXBlcyQxLm5hbWUgJiYgIWNvbnRhaW5zRXNjICYmXG4gICAgICAgICAgKCF0aGlzLnBvdGVudGlhbEFycm93SW5Gb3JBd2FpdCB8fCB0aGlzLnZhbHVlICE9PSBcIm9mXCIgfHwgdGhpcy5jb250YWluc0VzYykpIHtcbiAgICAgICAgaWQgPSB0aGlzLnBhcnNlSWRlbnQoZmFsc2UpO1xuICAgICAgICBpZiAodGhpcy5jYW5JbnNlcnRTZW1pY29sb24oKSB8fCAhdGhpcy5lYXQodHlwZXMkMS5hcnJvdykpXG4gICAgICAgICAgeyB0aGlzLnVuZXhwZWN0ZWQoKTsgfVxuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUFycm93RXhwcmVzc2lvbih0aGlzLnN0YXJ0Tm9kZUF0KHN0YXJ0UG9zLCBzdGFydExvYyksIFtpZF0sIHRydWUsIGZvckluaXQpXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpZFxuXG4gIGNhc2UgdHlwZXMkMS5yZWdleHA6XG4gICAgdmFyIHZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICBub2RlID0gdGhpcy5wYXJzZUxpdGVyYWwodmFsdWUudmFsdWUpO1xuICAgIG5vZGUucmVnZXggPSB7cGF0dGVybjogdmFsdWUucGF0dGVybiwgZmxhZ3M6IHZhbHVlLmZsYWdzfTtcbiAgICByZXR1cm4gbm9kZVxuXG4gIGNhc2UgdHlwZXMkMS5udW06IGNhc2UgdHlwZXMkMS5zdHJpbmc6XG4gICAgcmV0dXJuIHRoaXMucGFyc2VMaXRlcmFsKHRoaXMudmFsdWUpXG5cbiAgY2FzZSB0eXBlcyQxLl9udWxsOiBjYXNlIHR5cGVzJDEuX3RydWU6IGNhc2UgdHlwZXMkMS5fZmFsc2U6XG4gICAgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gICAgbm9kZS52YWx1ZSA9IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5fbnVsbCA/IG51bGwgOiB0aGlzLnR5cGUgPT09IHR5cGVzJDEuX3RydWU7XG4gICAgbm9kZS5yYXcgPSB0aGlzLnR5cGUua2V5d29yZDtcbiAgICB0aGlzLm5leHQoKTtcbiAgICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiTGl0ZXJhbFwiKVxuXG4gIGNhc2UgdHlwZXMkMS5wYXJlbkw6XG4gICAgdmFyIHN0YXJ0ID0gdGhpcy5zdGFydCwgZXhwciA9IHRoaXMucGFyc2VQYXJlbkFuZERpc3Rpbmd1aXNoRXhwcmVzc2lvbihjYW5CZUFycm93LCBmb3JJbml0KTtcbiAgICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykge1xuICAgICAgaWYgKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMucGFyZW50aGVzaXplZEFzc2lnbiA8IDAgJiYgIXRoaXMuaXNTaW1wbGVBc3NpZ25UYXJnZXQoZXhwcikpXG4gICAgICAgIHsgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy5wYXJlbnRoZXNpemVkQXNzaWduID0gc3RhcnQ7IH1cbiAgICAgIGlmIChyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnBhcmVudGhlc2l6ZWRCaW5kIDwgMClcbiAgICAgICAgeyByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnBhcmVudGhlc2l6ZWRCaW5kID0gc3RhcnQ7IH1cbiAgICB9XG4gICAgcmV0dXJuIGV4cHJcblxuICBjYXNlIHR5cGVzJDEuYnJhY2tldEw6XG4gICAgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gICAgdGhpcy5uZXh0KCk7XG4gICAgbm9kZS5lbGVtZW50cyA9IHRoaXMucGFyc2VFeHByTGlzdCh0eXBlcyQxLmJyYWNrZXRSLCB0cnVlLCB0cnVlLCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzKTtcbiAgICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiQXJyYXlFeHByZXNzaW9uXCIpXG5cbiAgY2FzZSB0eXBlcyQxLmJyYWNlTDpcbiAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCh0eXBlcy5iX2V4cHIpO1xuICAgIHJldHVybiB0aGlzLnBhcnNlT2JqKGZhbHNlLCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzKVxuXG4gIGNhc2UgdHlwZXMkMS5fZnVuY3Rpb246XG4gICAgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gICAgdGhpcy5uZXh0KCk7XG4gICAgcmV0dXJuIHRoaXMucGFyc2VGdW5jdGlvbihub2RlLCAwKVxuXG4gIGNhc2UgdHlwZXMkMS5fY2xhc3M6XG4gICAgcmV0dXJuIHRoaXMucGFyc2VDbGFzcyh0aGlzLnN0YXJ0Tm9kZSgpLCBmYWxzZSlcblxuICBjYXNlIHR5cGVzJDEuX25ldzpcbiAgICByZXR1cm4gdGhpcy5wYXJzZU5ldygpXG5cbiAgY2FzZSB0eXBlcyQxLmJhY2tRdW90ZTpcbiAgICByZXR1cm4gdGhpcy5wYXJzZVRlbXBsYXRlKClcblxuICBjYXNlIHR5cGVzJDEuX2ltcG9ydDpcbiAgICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDExKSB7XG4gICAgICByZXR1cm4gdGhpcy5wYXJzZUV4cHJJbXBvcnQoKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy51bmV4cGVjdGVkKClcbiAgICB9XG5cbiAgZGVmYXVsdDpcbiAgICB0aGlzLnVuZXhwZWN0ZWQoKTtcbiAgfVxufTtcblxucHAkNS5wYXJzZUV4cHJJbXBvcnQgPSBmdW5jdGlvbigpIHtcbiAgdmFyIG5vZGUgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuXG4gIC8vIENvbnN1bWUgYGltcG9ydGAgYXMgYW4gaWRlbnRpZmllciBmb3IgYGltcG9ydC5tZXRhYC5cbiAgLy8gQmVjYXVzZSBgdGhpcy5wYXJzZUlkZW50KHRydWUpYCBkb2Vzbid0IGNoZWNrIGVzY2FwZSBzZXF1ZW5jZXMsIGl0IG5lZWRzIHRoZSBjaGVjayBvZiBgdGhpcy5jb250YWluc0VzY2AuXG4gIGlmICh0aGlzLmNvbnRhaW5zRXNjKSB7IHRoaXMucmFpc2VSZWNvdmVyYWJsZSh0aGlzLnN0YXJ0LCBcIkVzY2FwZSBzZXF1ZW5jZSBpbiBrZXl3b3JkIGltcG9ydFwiKTsgfVxuICB2YXIgbWV0YSA9IHRoaXMucGFyc2VJZGVudCh0cnVlKTtcblxuICBzd2l0Y2ggKHRoaXMudHlwZSkge1xuICBjYXNlIHR5cGVzJDEucGFyZW5MOlxuICAgIHJldHVybiB0aGlzLnBhcnNlRHluYW1pY0ltcG9ydChub2RlKVxuICBjYXNlIHR5cGVzJDEuZG90OlxuICAgIG5vZGUubWV0YSA9IG1ldGE7XG4gICAgcmV0dXJuIHRoaXMucGFyc2VJbXBvcnRNZXRhKG5vZGUpXG4gIGRlZmF1bHQ6XG4gICAgdGhpcy51bmV4cGVjdGVkKCk7XG4gIH1cbn07XG5cbnBwJDUucGFyc2VEeW5hbWljSW1wb3J0ID0gZnVuY3Rpb24obm9kZSkge1xuICB0aGlzLm5leHQoKTsgLy8gc2tpcCBgKGBcblxuICAvLyBQYXJzZSBub2RlLnNvdXJjZS5cbiAgbm9kZS5zb3VyY2UgPSB0aGlzLnBhcnNlTWF5YmVBc3NpZ24oKTtcblxuICAvLyBWZXJpZnkgZW5kaW5nLlxuICBpZiAoIXRoaXMuZWF0KHR5cGVzJDEucGFyZW5SKSkge1xuICAgIHZhciBlcnJvclBvcyA9IHRoaXMuc3RhcnQ7XG4gICAgaWYgKHRoaXMuZWF0KHR5cGVzJDEuY29tbWEpICYmIHRoaXMuZWF0KHR5cGVzJDEucGFyZW5SKSkge1xuICAgICAgdGhpcy5yYWlzZVJlY292ZXJhYmxlKGVycm9yUG9zLCBcIlRyYWlsaW5nIGNvbW1hIGlzIG5vdCBhbGxvd2VkIGluIGltcG9ydCgpXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVuZXhwZWN0ZWQoZXJyb3JQb3MpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJJbXBvcnRFeHByZXNzaW9uXCIpXG59O1xuXG5wcCQ1LnBhcnNlSW1wb3J0TWV0YSA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgdGhpcy5uZXh0KCk7IC8vIHNraXAgYC5gXG5cbiAgdmFyIGNvbnRhaW5zRXNjID0gdGhpcy5jb250YWluc0VzYztcbiAgbm9kZS5wcm9wZXJ0eSA9IHRoaXMucGFyc2VJZGVudCh0cnVlKTtcblxuICBpZiAobm9kZS5wcm9wZXJ0eS5uYW1lICE9PSBcIm1ldGFcIilcbiAgICB7IHRoaXMucmFpc2VSZWNvdmVyYWJsZShub2RlLnByb3BlcnR5LnN0YXJ0LCBcIlRoZSBvbmx5IHZhbGlkIG1ldGEgcHJvcGVydHkgZm9yIGltcG9ydCBpcyAnaW1wb3J0Lm1ldGEnXCIpOyB9XG4gIGlmIChjb250YWluc0VzYylcbiAgICB7IHRoaXMucmFpc2VSZWNvdmVyYWJsZShub2RlLnN0YXJ0LCBcIidpbXBvcnQubWV0YScgbXVzdCBub3QgY29udGFpbiBlc2NhcGVkIGNoYXJhY3RlcnNcIik7IH1cbiAgaWYgKHRoaXMub3B0aW9ucy5zb3VyY2VUeXBlICE9PSBcIm1vZHVsZVwiICYmICF0aGlzLm9wdGlvbnMuYWxsb3dJbXBvcnRFeHBvcnRFdmVyeXdoZXJlKVxuICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKG5vZGUuc3RhcnQsIFwiQ2Fubm90IHVzZSAnaW1wb3J0Lm1ldGEnIG91dHNpZGUgYSBtb2R1bGVcIik7IH1cblxuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiTWV0YVByb3BlcnR5XCIpXG59O1xuXG5wcCQ1LnBhcnNlTGl0ZXJhbCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHZhciBub2RlID0gdGhpcy5zdGFydE5vZGUoKTtcbiAgbm9kZS52YWx1ZSA9IHZhbHVlO1xuICBub2RlLnJhdyA9IHRoaXMuaW5wdXQuc2xpY2UodGhpcy5zdGFydCwgdGhpcy5lbmQpO1xuICBpZiAobm9kZS5yYXcuY2hhckNvZGVBdChub2RlLnJhdy5sZW5ndGggLSAxKSA9PT0gMTEwKSB7IG5vZGUuYmlnaW50ID0gbm9kZS5yYXcuc2xpY2UoMCwgLTEpLnJlcGxhY2UoL18vZywgXCJcIik7IH1cbiAgdGhpcy5uZXh0KCk7XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJMaXRlcmFsXCIpXG59O1xuXG5wcCQ1LnBhcnNlUGFyZW5FeHByZXNzaW9uID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZXhwZWN0KHR5cGVzJDEucGFyZW5MKTtcbiAgdmFyIHZhbCA9IHRoaXMucGFyc2VFeHByZXNzaW9uKCk7XG4gIHRoaXMuZXhwZWN0KHR5cGVzJDEucGFyZW5SKTtcbiAgcmV0dXJuIHZhbFxufTtcblxucHAkNS5wYXJzZVBhcmVuQW5kRGlzdGluZ3Vpc2hFeHByZXNzaW9uID0gZnVuY3Rpb24oY2FuQmVBcnJvdywgZm9ySW5pdCkge1xuICB2YXIgc3RhcnRQb3MgPSB0aGlzLnN0YXJ0LCBzdGFydExvYyA9IHRoaXMuc3RhcnRMb2MsIHZhbCwgYWxsb3dUcmFpbGluZ0NvbW1hID0gdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDg7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gNikge1xuICAgIHRoaXMubmV4dCgpO1xuXG4gICAgdmFyIGlubmVyU3RhcnRQb3MgPSB0aGlzLnN0YXJ0LCBpbm5lclN0YXJ0TG9jID0gdGhpcy5zdGFydExvYztcbiAgICB2YXIgZXhwckxpc3QgPSBbXSwgZmlyc3QgPSB0cnVlLCBsYXN0SXNDb21tYSA9IGZhbHNlO1xuICAgIHZhciByZWZEZXN0cnVjdHVyaW5nRXJyb3JzID0gbmV3IERlc3RydWN0dXJpbmdFcnJvcnMsIG9sZFlpZWxkUG9zID0gdGhpcy55aWVsZFBvcywgb2xkQXdhaXRQb3MgPSB0aGlzLmF3YWl0UG9zLCBzcHJlYWRTdGFydDtcbiAgICB0aGlzLnlpZWxkUG9zID0gMDtcbiAgICB0aGlzLmF3YWl0UG9zID0gMDtcbiAgICAvLyBEbyBub3Qgc2F2ZSBhd2FpdElkZW50UG9zIHRvIGFsbG93IGNoZWNraW5nIGF3YWl0cyBuZXN0ZWQgaW4gcGFyYW1ldGVyc1xuICAgIHdoaWxlICh0aGlzLnR5cGUgIT09IHR5cGVzJDEucGFyZW5SKSB7XG4gICAgICBmaXJzdCA/IGZpcnN0ID0gZmFsc2UgOiB0aGlzLmV4cGVjdCh0eXBlcyQxLmNvbW1hKTtcbiAgICAgIGlmIChhbGxvd1RyYWlsaW5nQ29tbWEgJiYgdGhpcy5hZnRlclRyYWlsaW5nQ29tbWEodHlwZXMkMS5wYXJlblIsIHRydWUpKSB7XG4gICAgICAgIGxhc3RJc0NvbW1hID0gdHJ1ZTtcbiAgICAgICAgYnJlYWtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLmVsbGlwc2lzKSB7XG4gICAgICAgIHNwcmVhZFN0YXJ0ID0gdGhpcy5zdGFydDtcbiAgICAgICAgZXhwckxpc3QucHVzaCh0aGlzLnBhcnNlUGFyZW5JdGVtKHRoaXMucGFyc2VSZXN0QmluZGluZygpKSk7XG4gICAgICAgIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEuY29tbWEpIHsgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIkNvbW1hIGlzIG5vdCBwZXJtaXR0ZWQgYWZ0ZXIgdGhlIHJlc3QgZWxlbWVudFwiKTsgfVxuICAgICAgICBicmVha1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXhwckxpc3QucHVzaCh0aGlzLnBhcnNlTWF5YmVBc3NpZ24oZmFsc2UsIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMsIHRoaXMucGFyc2VQYXJlbkl0ZW0pKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIGlubmVyRW5kUG9zID0gdGhpcy5sYXN0VG9rRW5kLCBpbm5lckVuZExvYyA9IHRoaXMubGFzdFRva0VuZExvYztcbiAgICB0aGlzLmV4cGVjdCh0eXBlcyQxLnBhcmVuUik7XG5cbiAgICBpZiAoY2FuQmVBcnJvdyAmJiAhdGhpcy5jYW5JbnNlcnRTZW1pY29sb24oKSAmJiB0aGlzLmVhdCh0eXBlcyQxLmFycm93KSkge1xuICAgICAgdGhpcy5jaGVja1BhdHRlcm5FcnJvcnMocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycywgZmFsc2UpO1xuICAgICAgdGhpcy5jaGVja1lpZWxkQXdhaXRJbkRlZmF1bHRQYXJhbXMoKTtcbiAgICAgIHRoaXMueWllbGRQb3MgPSBvbGRZaWVsZFBvcztcbiAgICAgIHRoaXMuYXdhaXRQb3MgPSBvbGRBd2FpdFBvcztcbiAgICAgIHJldHVybiB0aGlzLnBhcnNlUGFyZW5BcnJvd0xpc3Qoc3RhcnRQb3MsIHN0YXJ0TG9jLCBleHByTGlzdCwgZm9ySW5pdClcbiAgICB9XG5cbiAgICBpZiAoIWV4cHJMaXN0Lmxlbmd0aCB8fCBsYXN0SXNDb21tYSkgeyB0aGlzLnVuZXhwZWN0ZWQodGhpcy5sYXN0VG9rU3RhcnQpOyB9XG4gICAgaWYgKHNwcmVhZFN0YXJ0KSB7IHRoaXMudW5leHBlY3RlZChzcHJlYWRTdGFydCk7IH1cbiAgICB0aGlzLmNoZWNrRXhwcmVzc2lvbkVycm9ycyhyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCB0cnVlKTtcbiAgICB0aGlzLnlpZWxkUG9zID0gb2xkWWllbGRQb3MgfHwgdGhpcy55aWVsZFBvcztcbiAgICB0aGlzLmF3YWl0UG9zID0gb2xkQXdhaXRQb3MgfHwgdGhpcy5hd2FpdFBvcztcblxuICAgIGlmIChleHByTGlzdC5sZW5ndGggPiAxKSB7XG4gICAgICB2YWwgPSB0aGlzLnN0YXJ0Tm9kZUF0KGlubmVyU3RhcnRQb3MsIGlubmVyU3RhcnRMb2MpO1xuICAgICAgdmFsLmV4cHJlc3Npb25zID0gZXhwckxpc3Q7XG4gICAgICB0aGlzLmZpbmlzaE5vZGVBdCh2YWwsIFwiU2VxdWVuY2VFeHByZXNzaW9uXCIsIGlubmVyRW5kUG9zLCBpbm5lckVuZExvYyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbCA9IGV4cHJMaXN0WzBdO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB2YWwgPSB0aGlzLnBhcnNlUGFyZW5FeHByZXNzaW9uKCk7XG4gIH1cblxuICBpZiAodGhpcy5vcHRpb25zLnByZXNlcnZlUGFyZW5zKSB7XG4gICAgdmFyIHBhciA9IHRoaXMuc3RhcnROb2RlQXQoc3RhcnRQb3MsIHN0YXJ0TG9jKTtcbiAgICBwYXIuZXhwcmVzc2lvbiA9IHZhbDtcbiAgICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKHBhciwgXCJQYXJlbnRoZXNpemVkRXhwcmVzc2lvblwiKVxuICB9IGVsc2Uge1xuICAgIHJldHVybiB2YWxcbiAgfVxufTtcblxucHAkNS5wYXJzZVBhcmVuSXRlbSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgcmV0dXJuIGl0ZW1cbn07XG5cbnBwJDUucGFyc2VQYXJlbkFycm93TGlzdCA9IGZ1bmN0aW9uKHN0YXJ0UG9zLCBzdGFydExvYywgZXhwckxpc3QsIGZvckluaXQpIHtcbiAgcmV0dXJuIHRoaXMucGFyc2VBcnJvd0V4cHJlc3Npb24odGhpcy5zdGFydE5vZGVBdChzdGFydFBvcywgc3RhcnRMb2MpLCBleHByTGlzdCwgZmFsc2UsIGZvckluaXQpXG59O1xuXG4vLyBOZXcncyBwcmVjZWRlbmNlIGlzIHNsaWdodGx5IHRyaWNreS4gSXQgbXVzdCBhbGxvdyBpdHMgYXJndW1lbnQgdG9cbi8vIGJlIGEgYFtdYCBvciBkb3Qgc3Vic2NyaXB0IGV4cHJlc3Npb24sIGJ1dCBub3QgYSBjYWxsIOKAlCBhdCBsZWFzdCxcbi8vIG5vdCB3aXRob3V0IHdyYXBwaW5nIGl0IGluIHBhcmVudGhlc2VzLiBUaHVzLCBpdCB1c2VzIHRoZSBub0NhbGxzXG4vLyBhcmd1bWVudCB0byBwYXJzZVN1YnNjcmlwdHMgdG8gcHJldmVudCBpdCBmcm9tIGNvbnN1bWluZyB0aGVcbi8vIGFyZ3VtZW50IGxpc3QuXG5cbnZhciBlbXB0eSA9IFtdO1xuXG5wcCQ1LnBhcnNlTmV3ID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLmNvbnRhaW5zRXNjKSB7IHRoaXMucmFpc2VSZWNvdmVyYWJsZSh0aGlzLnN0YXJ0LCBcIkVzY2FwZSBzZXF1ZW5jZSBpbiBrZXl3b3JkIG5ld1wiKTsgfVxuICB2YXIgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gIHZhciBtZXRhID0gdGhpcy5wYXJzZUlkZW50KHRydWUpO1xuICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDYgJiYgdGhpcy5lYXQodHlwZXMkMS5kb3QpKSB7XG4gICAgbm9kZS5tZXRhID0gbWV0YTtcbiAgICB2YXIgY29udGFpbnNFc2MgPSB0aGlzLmNvbnRhaW5zRXNjO1xuICAgIG5vZGUucHJvcGVydHkgPSB0aGlzLnBhcnNlSWRlbnQodHJ1ZSk7XG4gICAgaWYgKG5vZGUucHJvcGVydHkubmFtZSAhPT0gXCJ0YXJnZXRcIilcbiAgICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKG5vZGUucHJvcGVydHkuc3RhcnQsIFwiVGhlIG9ubHkgdmFsaWQgbWV0YSBwcm9wZXJ0eSBmb3IgbmV3IGlzICduZXcudGFyZ2V0J1wiKTsgfVxuICAgIGlmIChjb250YWluc0VzYylcbiAgICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKG5vZGUuc3RhcnQsIFwiJ25ldy50YXJnZXQnIG11c3Qgbm90IGNvbnRhaW4gZXNjYXBlZCBjaGFyYWN0ZXJzXCIpOyB9XG4gICAgaWYgKCF0aGlzLmFsbG93TmV3RG90VGFyZ2V0KVxuICAgICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUobm9kZS5zdGFydCwgXCInbmV3LnRhcmdldCcgY2FuIG9ubHkgYmUgdXNlZCBpbiBmdW5jdGlvbnMgYW5kIGNsYXNzIHN0YXRpYyBibG9ja1wiKTsgfVxuICAgIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJNZXRhUHJvcGVydHlcIilcbiAgfVxuICB2YXIgc3RhcnRQb3MgPSB0aGlzLnN0YXJ0LCBzdGFydExvYyA9IHRoaXMuc3RhcnRMb2MsIGlzSW1wb3J0ID0gdGhpcy50eXBlID09PSB0eXBlcyQxLl9pbXBvcnQ7XG4gIG5vZGUuY2FsbGVlID0gdGhpcy5wYXJzZVN1YnNjcmlwdHModGhpcy5wYXJzZUV4cHJBdG9tKCksIHN0YXJ0UG9zLCBzdGFydExvYywgdHJ1ZSwgZmFsc2UpO1xuICBpZiAoaXNJbXBvcnQgJiYgbm9kZS5jYWxsZWUudHlwZSA9PT0gXCJJbXBvcnRFeHByZXNzaW9uXCIpIHtcbiAgICB0aGlzLnJhaXNlKHN0YXJ0UG9zLCBcIkNhbm5vdCB1c2UgbmV3IHdpdGggaW1wb3J0KClcIik7XG4gIH1cbiAgaWYgKHRoaXMuZWF0KHR5cGVzJDEucGFyZW5MKSkgeyBub2RlLmFyZ3VtZW50cyA9IHRoaXMucGFyc2VFeHByTGlzdCh0eXBlcyQxLnBhcmVuUiwgdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDgsIGZhbHNlKTsgfVxuICBlbHNlIHsgbm9kZS5hcmd1bWVudHMgPSBlbXB0eTsgfVxuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiTmV3RXhwcmVzc2lvblwiKVxufTtcblxuLy8gUGFyc2UgdGVtcGxhdGUgZXhwcmVzc2lvbi5cblxucHAkNS5wYXJzZVRlbXBsYXRlRWxlbWVudCA9IGZ1bmN0aW9uKHJlZikge1xuICB2YXIgaXNUYWdnZWQgPSByZWYuaXNUYWdnZWQ7XG5cbiAgdmFyIGVsZW0gPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLmludmFsaWRUZW1wbGF0ZSkge1xuICAgIGlmICghaXNUYWdnZWQpIHtcbiAgICAgIHRoaXMucmFpc2VSZWNvdmVyYWJsZSh0aGlzLnN0YXJ0LCBcIkJhZCBlc2NhcGUgc2VxdWVuY2UgaW4gdW50YWdnZWQgdGVtcGxhdGUgbGl0ZXJhbFwiKTtcbiAgICB9XG4gICAgZWxlbS52YWx1ZSA9IHtcbiAgICAgIHJhdzogdGhpcy52YWx1ZSxcbiAgICAgIGNvb2tlZDogbnVsbFxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgZWxlbS52YWx1ZSA9IHtcbiAgICAgIHJhdzogdGhpcy5pbnB1dC5zbGljZSh0aGlzLnN0YXJ0LCB0aGlzLmVuZCkucmVwbGFjZSgvXFxyXFxuPy9nLCBcIlxcblwiKSxcbiAgICAgIGNvb2tlZDogdGhpcy52YWx1ZVxuICAgIH07XG4gIH1cbiAgdGhpcy5uZXh0KCk7XG4gIGVsZW0udGFpbCA9IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5iYWNrUXVvdGU7XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUoZWxlbSwgXCJUZW1wbGF0ZUVsZW1lbnRcIilcbn07XG5cbnBwJDUucGFyc2VUZW1wbGF0ZSA9IGZ1bmN0aW9uKHJlZikge1xuICBpZiAoIHJlZiA9PT0gdm9pZCAwICkgcmVmID0ge307XG4gIHZhciBpc1RhZ2dlZCA9IHJlZi5pc1RhZ2dlZDsgaWYgKCBpc1RhZ2dlZCA9PT0gdm9pZCAwICkgaXNUYWdnZWQgPSBmYWxzZTtcblxuICB2YXIgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gIHRoaXMubmV4dCgpO1xuICBub2RlLmV4cHJlc3Npb25zID0gW107XG4gIHZhciBjdXJFbHQgPSB0aGlzLnBhcnNlVGVtcGxhdGVFbGVtZW50KHtpc1RhZ2dlZDogaXNUYWdnZWR9KTtcbiAgbm9kZS5xdWFzaXMgPSBbY3VyRWx0XTtcbiAgd2hpbGUgKCFjdXJFbHQudGFpbCkge1xuICAgIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEuZW9mKSB7IHRoaXMucmFpc2UodGhpcy5wb3MsIFwiVW50ZXJtaW5hdGVkIHRlbXBsYXRlIGxpdGVyYWxcIik7IH1cbiAgICB0aGlzLmV4cGVjdCh0eXBlcyQxLmRvbGxhckJyYWNlTCk7XG4gICAgbm9kZS5leHByZXNzaW9ucy5wdXNoKHRoaXMucGFyc2VFeHByZXNzaW9uKCkpO1xuICAgIHRoaXMuZXhwZWN0KHR5cGVzJDEuYnJhY2VSKTtcbiAgICBub2RlLnF1YXNpcy5wdXNoKGN1ckVsdCA9IHRoaXMucGFyc2VUZW1wbGF0ZUVsZW1lbnQoe2lzVGFnZ2VkOiBpc1RhZ2dlZH0pKTtcbiAgfVxuICB0aGlzLm5leHQoKTtcbiAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCBcIlRlbXBsYXRlTGl0ZXJhbFwiKVxufTtcblxucHAkNS5pc0FzeW5jUHJvcCA9IGZ1bmN0aW9uKHByb3ApIHtcbiAgcmV0dXJuICFwcm9wLmNvbXB1dGVkICYmIHByb3Aua2V5LnR5cGUgPT09IFwiSWRlbnRpZmllclwiICYmIHByb3Aua2V5Lm5hbWUgPT09IFwiYXN5bmNcIiAmJlxuICAgICh0aGlzLnR5cGUgPT09IHR5cGVzJDEubmFtZSB8fCB0aGlzLnR5cGUgPT09IHR5cGVzJDEubnVtIHx8IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5zdHJpbmcgfHwgdGhpcy50eXBlID09PSB0eXBlcyQxLmJyYWNrZXRMIHx8IHRoaXMudHlwZS5rZXl3b3JkIHx8ICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOSAmJiB0aGlzLnR5cGUgPT09IHR5cGVzJDEuc3RhcikpICYmXG4gICAgIWxpbmVCcmVhay50ZXN0KHRoaXMuaW5wdXQuc2xpY2UodGhpcy5sYXN0VG9rRW5kLCB0aGlzLnN0YXJ0KSlcbn07XG5cbi8vIFBhcnNlIGFuIG9iamVjdCBsaXRlcmFsIG9yIGJpbmRpbmcgcGF0dGVybi5cblxucHAkNS5wYXJzZU9iaiA9IGZ1bmN0aW9uKGlzUGF0dGVybiwgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykge1xuICB2YXIgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCksIGZpcnN0ID0gdHJ1ZSwgcHJvcEhhc2ggPSB7fTtcbiAgbm9kZS5wcm9wZXJ0aWVzID0gW107XG4gIHRoaXMubmV4dCgpO1xuICB3aGlsZSAoIXRoaXMuZWF0KHR5cGVzJDEuYnJhY2VSKSkge1xuICAgIGlmICghZmlyc3QpIHtcbiAgICAgIHRoaXMuZXhwZWN0KHR5cGVzJDEuY29tbWEpO1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA1ICYmIHRoaXMuYWZ0ZXJUcmFpbGluZ0NvbW1hKHR5cGVzJDEuYnJhY2VSKSkgeyBicmVhayB9XG4gICAgfSBlbHNlIHsgZmlyc3QgPSBmYWxzZTsgfVxuXG4gICAgdmFyIHByb3AgPSB0aGlzLnBhcnNlUHJvcGVydHkoaXNQYXR0ZXJuLCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzKTtcbiAgICBpZiAoIWlzUGF0dGVybikgeyB0aGlzLmNoZWNrUHJvcENsYXNoKHByb3AsIHByb3BIYXNoLCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzKTsgfVxuICAgIG5vZGUucHJvcGVydGllcy5wdXNoKHByb3ApO1xuICB9XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgaXNQYXR0ZXJuID8gXCJPYmplY3RQYXR0ZXJuXCIgOiBcIk9iamVjdEV4cHJlc3Npb25cIilcbn07XG5cbnBwJDUucGFyc2VQcm9wZXJ0eSA9IGZ1bmN0aW9uKGlzUGF0dGVybiwgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykge1xuICB2YXIgcHJvcCA9IHRoaXMuc3RhcnROb2RlKCksIGlzR2VuZXJhdG9yLCBpc0FzeW5jLCBzdGFydFBvcywgc3RhcnRMb2M7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOSAmJiB0aGlzLmVhdCh0eXBlcyQxLmVsbGlwc2lzKSkge1xuICAgIGlmIChpc1BhdHRlcm4pIHtcbiAgICAgIHByb3AuYXJndW1lbnQgPSB0aGlzLnBhcnNlSWRlbnQoZmFsc2UpO1xuICAgICAgaWYgKHRoaXMudHlwZSA9PT0gdHlwZXMkMS5jb21tYSkge1xuICAgICAgICB0aGlzLnJhaXNlKHRoaXMuc3RhcnQsIFwiQ29tbWEgaXMgbm90IHBlcm1pdHRlZCBhZnRlciB0aGUgcmVzdCBlbGVtZW50XCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShwcm9wLCBcIlJlc3RFbGVtZW50XCIpXG4gICAgfVxuICAgIC8vIFRvIGRpc2FsbG93IHBhcmVudGhlc2l6ZWQgaWRlbnRpZmllciB2aWEgYHRoaXMudG9Bc3NpZ25hYmxlKClgLlxuICAgIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEucGFyZW5MICYmIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpIHtcbiAgICAgIGlmIChyZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnBhcmVudGhlc2l6ZWRBc3NpZ24gPCAwKSB7XG4gICAgICAgIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMucGFyZW50aGVzaXplZEFzc2lnbiA9IHRoaXMuc3RhcnQ7XG4gICAgICB9XG4gICAgICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy5wYXJlbnRoZXNpemVkQmluZCA8IDApIHtcbiAgICAgICAgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy5wYXJlbnRoZXNpemVkQmluZCA9IHRoaXMuc3RhcnQ7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIFBhcnNlIGFyZ3VtZW50LlxuICAgIHByb3AuYXJndW1lbnQgPSB0aGlzLnBhcnNlTWF5YmVBc3NpZ24oZmFsc2UsIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpO1xuICAgIC8vIFRvIGRpc2FsbG93IHRyYWlsaW5nIGNvbW1hIHZpYSBgdGhpcy50b0Fzc2lnbmFibGUoKWAuXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gdHlwZXMkMS5jb21tYSAmJiByZWZEZXN0cnVjdHVyaW5nRXJyb3JzICYmIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMudHJhaWxpbmdDb21tYSA8IDApIHtcbiAgICAgIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMudHJhaWxpbmdDb21tYSA9IHRoaXMuc3RhcnQ7XG4gICAgfVxuICAgIC8vIEZpbmlzaFxuICAgIHJldHVybiB0aGlzLmZpbmlzaE5vZGUocHJvcCwgXCJTcHJlYWRFbGVtZW50XCIpXG4gIH1cbiAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA2KSB7XG4gICAgcHJvcC5tZXRob2QgPSBmYWxzZTtcbiAgICBwcm9wLnNob3J0aGFuZCA9IGZhbHNlO1xuICAgIGlmIChpc1BhdHRlcm4gfHwgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykge1xuICAgICAgc3RhcnRQb3MgPSB0aGlzLnN0YXJ0O1xuICAgICAgc3RhcnRMb2MgPSB0aGlzLnN0YXJ0TG9jO1xuICAgIH1cbiAgICBpZiAoIWlzUGF0dGVybilcbiAgICAgIHsgaXNHZW5lcmF0b3IgPSB0aGlzLmVhdCh0eXBlcyQxLnN0YXIpOyB9XG4gIH1cbiAgdmFyIGNvbnRhaW5zRXNjID0gdGhpcy5jb250YWluc0VzYztcbiAgdGhpcy5wYXJzZVByb3BlcnR5TmFtZShwcm9wKTtcbiAgaWYgKCFpc1BhdHRlcm4gJiYgIWNvbnRhaW5zRXNjICYmIHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA4ICYmICFpc0dlbmVyYXRvciAmJiB0aGlzLmlzQXN5bmNQcm9wKHByb3ApKSB7XG4gICAgaXNBc3luYyA9IHRydWU7XG4gICAgaXNHZW5lcmF0b3IgPSB0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOSAmJiB0aGlzLmVhdCh0eXBlcyQxLnN0YXIpO1xuICAgIHRoaXMucGFyc2VQcm9wZXJ0eU5hbWUocHJvcCwgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycyk7XG4gIH0gZWxzZSB7XG4gICAgaXNBc3luYyA9IGZhbHNlO1xuICB9XG4gIHRoaXMucGFyc2VQcm9wZXJ0eVZhbHVlKHByb3AsIGlzUGF0dGVybiwgaXNHZW5lcmF0b3IsIGlzQXN5bmMsIHN0YXJ0UG9zLCBzdGFydExvYywgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycywgY29udGFpbnNFc2MpO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKHByb3AsIFwiUHJvcGVydHlcIilcbn07XG5cbnBwJDUucGFyc2VQcm9wZXJ0eVZhbHVlID0gZnVuY3Rpb24ocHJvcCwgaXNQYXR0ZXJuLCBpc0dlbmVyYXRvciwgaXNBc3luYywgc3RhcnRQb3MsIHN0YXJ0TG9jLCByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLCBjb250YWluc0VzYykge1xuICBpZiAoKGlzR2VuZXJhdG9yIHx8IGlzQXN5bmMpICYmIHRoaXMudHlwZSA9PT0gdHlwZXMkMS5jb2xvbilcbiAgICB7IHRoaXMudW5leHBlY3RlZCgpOyB9XG5cbiAgaWYgKHRoaXMuZWF0KHR5cGVzJDEuY29sb24pKSB7XG4gICAgcHJvcC52YWx1ZSA9IGlzUGF0dGVybiA/IHRoaXMucGFyc2VNYXliZURlZmF1bHQodGhpcy5zdGFydCwgdGhpcy5zdGFydExvYykgOiB0aGlzLnBhcnNlTWF5YmVBc3NpZ24oZmFsc2UsIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpO1xuICAgIHByb3Aua2luZCA9IFwiaW5pdFwiO1xuICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA2ICYmIHRoaXMudHlwZSA9PT0gdHlwZXMkMS5wYXJlbkwpIHtcbiAgICBpZiAoaXNQYXR0ZXJuKSB7IHRoaXMudW5leHBlY3RlZCgpOyB9XG4gICAgcHJvcC5raW5kID0gXCJpbml0XCI7XG4gICAgcHJvcC5tZXRob2QgPSB0cnVlO1xuICAgIHByb3AudmFsdWUgPSB0aGlzLnBhcnNlTWV0aG9kKGlzR2VuZXJhdG9yLCBpc0FzeW5jKTtcbiAgfSBlbHNlIGlmICghaXNQYXR0ZXJuICYmICFjb250YWluc0VzYyAmJlxuICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA1ICYmICFwcm9wLmNvbXB1dGVkICYmIHByb3Aua2V5LnR5cGUgPT09IFwiSWRlbnRpZmllclwiICYmXG4gICAgICAgICAgICAgKHByb3Aua2V5Lm5hbWUgPT09IFwiZ2V0XCIgfHwgcHJvcC5rZXkubmFtZSA9PT0gXCJzZXRcIikgJiZcbiAgICAgICAgICAgICAodGhpcy50eXBlICE9PSB0eXBlcyQxLmNvbW1hICYmIHRoaXMudHlwZSAhPT0gdHlwZXMkMS5icmFjZVIgJiYgdGhpcy50eXBlICE9PSB0eXBlcyQxLmVxKSkge1xuICAgIGlmIChpc0dlbmVyYXRvciB8fCBpc0FzeW5jKSB7IHRoaXMudW5leHBlY3RlZCgpOyB9XG4gICAgcHJvcC5raW5kID0gcHJvcC5rZXkubmFtZTtcbiAgICB0aGlzLnBhcnNlUHJvcGVydHlOYW1lKHByb3ApO1xuICAgIHByb3AudmFsdWUgPSB0aGlzLnBhcnNlTWV0aG9kKGZhbHNlKTtcbiAgICB2YXIgcGFyYW1Db3VudCA9IHByb3Aua2luZCA9PT0gXCJnZXRcIiA/IDAgOiAxO1xuICAgIGlmIChwcm9wLnZhbHVlLnBhcmFtcy5sZW5ndGggIT09IHBhcmFtQ291bnQpIHtcbiAgICAgIHZhciBzdGFydCA9IHByb3AudmFsdWUuc3RhcnQ7XG4gICAgICBpZiAocHJvcC5raW5kID09PSBcImdldFwiKVxuICAgICAgICB7IHRoaXMucmFpc2VSZWNvdmVyYWJsZShzdGFydCwgXCJnZXR0ZXIgc2hvdWxkIGhhdmUgbm8gcGFyYW1zXCIpOyB9XG4gICAgICBlbHNlXG4gICAgICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKHN0YXJ0LCBcInNldHRlciBzaG91bGQgaGF2ZSBleGFjdGx5IG9uZSBwYXJhbVwiKTsgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocHJvcC5raW5kID09PSBcInNldFwiICYmIHByb3AudmFsdWUucGFyYW1zWzBdLnR5cGUgPT09IFwiUmVzdEVsZW1lbnRcIilcbiAgICAgICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUocHJvcC52YWx1ZS5wYXJhbXNbMF0uc3RhcnQsIFwiU2V0dGVyIGNhbm5vdCB1c2UgcmVzdCBwYXJhbXNcIik7IH1cbiAgICB9XG4gIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDYgJiYgIXByb3AuY29tcHV0ZWQgJiYgcHJvcC5rZXkudHlwZSA9PT0gXCJJZGVudGlmaWVyXCIpIHtcbiAgICBpZiAoaXNHZW5lcmF0b3IgfHwgaXNBc3luYykgeyB0aGlzLnVuZXhwZWN0ZWQoKTsgfVxuICAgIHRoaXMuY2hlY2tVbnJlc2VydmVkKHByb3Aua2V5KTtcbiAgICBpZiAocHJvcC5rZXkubmFtZSA9PT0gXCJhd2FpdFwiICYmICF0aGlzLmF3YWl0SWRlbnRQb3MpXG4gICAgICB7IHRoaXMuYXdhaXRJZGVudFBvcyA9IHN0YXJ0UG9zOyB9XG4gICAgcHJvcC5raW5kID0gXCJpbml0XCI7XG4gICAgaWYgKGlzUGF0dGVybikge1xuICAgICAgcHJvcC52YWx1ZSA9IHRoaXMucGFyc2VNYXliZURlZmF1bHQoc3RhcnRQb3MsIHN0YXJ0TG9jLCB0aGlzLmNvcHlOb2RlKHByb3Aua2V5KSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEuZXEgJiYgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycykge1xuICAgICAgaWYgKHJlZkRlc3RydWN0dXJpbmdFcnJvcnMuc2hvcnRoYW5kQXNzaWduIDwgMClcbiAgICAgICAgeyByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnNob3J0aGFuZEFzc2lnbiA9IHRoaXMuc3RhcnQ7IH1cbiAgICAgIHByb3AudmFsdWUgPSB0aGlzLnBhcnNlTWF5YmVEZWZhdWx0KHN0YXJ0UG9zLCBzdGFydExvYywgdGhpcy5jb3B5Tm9kZShwcm9wLmtleSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcm9wLnZhbHVlID0gdGhpcy5jb3B5Tm9kZShwcm9wLmtleSk7XG4gICAgfVxuICAgIHByb3Auc2hvcnRoYW5kID0gdHJ1ZTtcbiAgfSBlbHNlIHsgdGhpcy51bmV4cGVjdGVkKCk7IH1cbn07XG5cbnBwJDUucGFyc2VQcm9wZXJ0eU5hbWUgPSBmdW5jdGlvbihwcm9wKSB7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gNikge1xuICAgIGlmICh0aGlzLmVhdCh0eXBlcyQxLmJyYWNrZXRMKSkge1xuICAgICAgcHJvcC5jb21wdXRlZCA9IHRydWU7XG4gICAgICBwcm9wLmtleSA9IHRoaXMucGFyc2VNYXliZUFzc2lnbigpO1xuICAgICAgdGhpcy5leHBlY3QodHlwZXMkMS5icmFja2V0Uik7XG4gICAgICByZXR1cm4gcHJvcC5rZXlcbiAgICB9IGVsc2Uge1xuICAgICAgcHJvcC5jb21wdXRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcHJvcC5rZXkgPSB0aGlzLnR5cGUgPT09IHR5cGVzJDEubnVtIHx8IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5zdHJpbmcgPyB0aGlzLnBhcnNlRXhwckF0b20oKSA6IHRoaXMucGFyc2VJZGVudCh0aGlzLm9wdGlvbnMuYWxsb3dSZXNlcnZlZCAhPT0gXCJuZXZlclwiKVxufTtcblxuLy8gSW5pdGlhbGl6ZSBlbXB0eSBmdW5jdGlvbiBub2RlLlxuXG5wcCQ1LmluaXRGdW5jdGlvbiA9IGZ1bmN0aW9uKG5vZGUpIHtcbiAgbm9kZS5pZCA9IG51bGw7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gNikgeyBub2RlLmdlbmVyYXRvciA9IG5vZGUuZXhwcmVzc2lvbiA9IGZhbHNlOyB9XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOCkgeyBub2RlLmFzeW5jID0gZmFsc2U7IH1cbn07XG5cbi8vIFBhcnNlIG9iamVjdCBvciBjbGFzcyBtZXRob2QuXG5cbnBwJDUucGFyc2VNZXRob2QgPSBmdW5jdGlvbihpc0dlbmVyYXRvciwgaXNBc3luYywgYWxsb3dEaXJlY3RTdXBlcikge1xuICB2YXIgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCksIG9sZFlpZWxkUG9zID0gdGhpcy55aWVsZFBvcywgb2xkQXdhaXRQb3MgPSB0aGlzLmF3YWl0UG9zLCBvbGRBd2FpdElkZW50UG9zID0gdGhpcy5hd2FpdElkZW50UG9zO1xuXG4gIHRoaXMuaW5pdEZ1bmN0aW9uKG5vZGUpO1xuICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDYpXG4gICAgeyBub2RlLmdlbmVyYXRvciA9IGlzR2VuZXJhdG9yOyB9XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOClcbiAgICB7IG5vZGUuYXN5bmMgPSAhIWlzQXN5bmM7IH1cblxuICB0aGlzLnlpZWxkUG9zID0gMDtcbiAgdGhpcy5hd2FpdFBvcyA9IDA7XG4gIHRoaXMuYXdhaXRJZGVudFBvcyA9IDA7XG4gIHRoaXMuZW50ZXJTY29wZShmdW5jdGlvbkZsYWdzKGlzQXN5bmMsIG5vZGUuZ2VuZXJhdG9yKSB8IFNDT1BFX1NVUEVSIHwgKGFsbG93RGlyZWN0U3VwZXIgPyBTQ09QRV9ESVJFQ1RfU1VQRVIgOiAwKSk7XG5cbiAgdGhpcy5leHBlY3QodHlwZXMkMS5wYXJlbkwpO1xuICBub2RlLnBhcmFtcyA9IHRoaXMucGFyc2VCaW5kaW5nTGlzdCh0eXBlcyQxLnBhcmVuUiwgZmFsc2UsIHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA4KTtcbiAgdGhpcy5jaGVja1lpZWxkQXdhaXRJbkRlZmF1bHRQYXJhbXMoKTtcbiAgdGhpcy5wYXJzZUZ1bmN0aW9uQm9keShub2RlLCBmYWxzZSwgdHJ1ZSwgZmFsc2UpO1xuXG4gIHRoaXMueWllbGRQb3MgPSBvbGRZaWVsZFBvcztcbiAgdGhpcy5hd2FpdFBvcyA9IG9sZEF3YWl0UG9zO1xuICB0aGlzLmF3YWl0SWRlbnRQb3MgPSBvbGRBd2FpdElkZW50UG9zO1xuICByZXR1cm4gdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiRnVuY3Rpb25FeHByZXNzaW9uXCIpXG59O1xuXG4vLyBQYXJzZSBhcnJvdyBmdW5jdGlvbiBleHByZXNzaW9uIHdpdGggZ2l2ZW4gcGFyYW1ldGVycy5cblxucHAkNS5wYXJzZUFycm93RXhwcmVzc2lvbiA9IGZ1bmN0aW9uKG5vZGUsIHBhcmFtcywgaXNBc3luYywgZm9ySW5pdCkge1xuICB2YXIgb2xkWWllbGRQb3MgPSB0aGlzLnlpZWxkUG9zLCBvbGRBd2FpdFBvcyA9IHRoaXMuYXdhaXRQb3MsIG9sZEF3YWl0SWRlbnRQb3MgPSB0aGlzLmF3YWl0SWRlbnRQb3M7XG5cbiAgdGhpcy5lbnRlclNjb3BlKGZ1bmN0aW9uRmxhZ3MoaXNBc3luYywgZmFsc2UpIHwgU0NPUEVfQVJST1cpO1xuICB0aGlzLmluaXRGdW5jdGlvbihub2RlKTtcbiAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA4KSB7IG5vZGUuYXN5bmMgPSAhIWlzQXN5bmM7IH1cblxuICB0aGlzLnlpZWxkUG9zID0gMDtcbiAgdGhpcy5hd2FpdFBvcyA9IDA7XG4gIHRoaXMuYXdhaXRJZGVudFBvcyA9IDA7XG5cbiAgbm9kZS5wYXJhbXMgPSB0aGlzLnRvQXNzaWduYWJsZUxpc3QocGFyYW1zLCB0cnVlKTtcbiAgdGhpcy5wYXJzZUZ1bmN0aW9uQm9keShub2RlLCB0cnVlLCBmYWxzZSwgZm9ySW5pdCk7XG5cbiAgdGhpcy55aWVsZFBvcyA9IG9sZFlpZWxkUG9zO1xuICB0aGlzLmF3YWl0UG9zID0gb2xkQXdhaXRQb3M7XG4gIHRoaXMuYXdhaXRJZGVudFBvcyA9IG9sZEF3YWl0SWRlbnRQb3M7XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJBcnJvd0Z1bmN0aW9uRXhwcmVzc2lvblwiKVxufTtcblxuLy8gUGFyc2UgZnVuY3Rpb24gYm9keSBhbmQgY2hlY2sgcGFyYW1ldGVycy5cblxucHAkNS5wYXJzZUZ1bmN0aW9uQm9keSA9IGZ1bmN0aW9uKG5vZGUsIGlzQXJyb3dGdW5jdGlvbiwgaXNNZXRob2QsIGZvckluaXQpIHtcbiAgdmFyIGlzRXhwcmVzc2lvbiA9IGlzQXJyb3dGdW5jdGlvbiAmJiB0aGlzLnR5cGUgIT09IHR5cGVzJDEuYnJhY2VMO1xuICB2YXIgb2xkU3RyaWN0ID0gdGhpcy5zdHJpY3QsIHVzZVN0cmljdCA9IGZhbHNlO1xuXG4gIGlmIChpc0V4cHJlc3Npb24pIHtcbiAgICBub2RlLmJvZHkgPSB0aGlzLnBhcnNlTWF5YmVBc3NpZ24oZm9ySW5pdCk7XG4gICAgbm9kZS5leHByZXNzaW9uID0gdHJ1ZTtcbiAgICB0aGlzLmNoZWNrUGFyYW1zKG5vZGUsIGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgbm9uU2ltcGxlID0gdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDcgJiYgIXRoaXMuaXNTaW1wbGVQYXJhbUxpc3Qobm9kZS5wYXJhbXMpO1xuICAgIGlmICghb2xkU3RyaWN0IHx8IG5vblNpbXBsZSkge1xuICAgICAgdXNlU3RyaWN0ID0gdGhpcy5zdHJpY3REaXJlY3RpdmUodGhpcy5lbmQpO1xuICAgICAgLy8gSWYgdGhpcyBpcyBhIHN0cmljdCBtb2RlIGZ1bmN0aW9uLCB2ZXJpZnkgdGhhdCBhcmd1bWVudCBuYW1lc1xuICAgICAgLy8gYXJlIG5vdCByZXBlYXRlZCwgYW5kIGl0IGRvZXMgbm90IHRyeSB0byBiaW5kIHRoZSB3b3JkcyBgZXZhbGBcbiAgICAgIC8vIG9yIGBhcmd1bWVudHNgLlxuICAgICAgaWYgKHVzZVN0cmljdCAmJiBub25TaW1wbGUpXG4gICAgICAgIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKG5vZGUuc3RhcnQsIFwiSWxsZWdhbCAndXNlIHN0cmljdCcgZGlyZWN0aXZlIGluIGZ1bmN0aW9uIHdpdGggbm9uLXNpbXBsZSBwYXJhbWV0ZXIgbGlzdFwiKTsgfVxuICAgIH1cbiAgICAvLyBTdGFydCBhIG5ldyBzY29wZSB3aXRoIHJlZ2FyZCB0byBsYWJlbHMgYW5kIHRoZSBgaW5GdW5jdGlvbmBcbiAgICAvLyBmbGFnIChyZXN0b3JlIHRoZW0gdG8gdGhlaXIgb2xkIHZhbHVlIGFmdGVyd2FyZHMpLlxuICAgIHZhciBvbGRMYWJlbHMgPSB0aGlzLmxhYmVscztcbiAgICB0aGlzLmxhYmVscyA9IFtdO1xuICAgIGlmICh1c2VTdHJpY3QpIHsgdGhpcy5zdHJpY3QgPSB0cnVlOyB9XG5cbiAgICAvLyBBZGQgdGhlIHBhcmFtcyB0byB2YXJEZWNsYXJlZE5hbWVzIHRvIGVuc3VyZSB0aGF0IGFuIGVycm9yIGlzIHRocm93blxuICAgIC8vIGlmIGEgbGV0L2NvbnN0IGRlY2xhcmF0aW9uIGluIHRoZSBmdW5jdGlvbiBjbGFzaGVzIHdpdGggb25lIG9mIHRoZSBwYXJhbXMuXG4gICAgdGhpcy5jaGVja1BhcmFtcyhub2RlLCAhb2xkU3RyaWN0ICYmICF1c2VTdHJpY3QgJiYgIWlzQXJyb3dGdW5jdGlvbiAmJiAhaXNNZXRob2QgJiYgdGhpcy5pc1NpbXBsZVBhcmFtTGlzdChub2RlLnBhcmFtcykpO1xuICAgIC8vIEVuc3VyZSB0aGUgZnVuY3Rpb24gbmFtZSBpc24ndCBhIGZvcmJpZGRlbiBpZGVudGlmaWVyIGluIHN0cmljdCBtb2RlLCBlLmcuICdldmFsJ1xuICAgIGlmICh0aGlzLnN0cmljdCAmJiBub2RlLmlkKSB7IHRoaXMuY2hlY2tMVmFsU2ltcGxlKG5vZGUuaWQsIEJJTkRfT1VUU0lERSk7IH1cbiAgICBub2RlLmJvZHkgPSB0aGlzLnBhcnNlQmxvY2soZmFsc2UsIHVuZGVmaW5lZCwgdXNlU3RyaWN0ICYmICFvbGRTdHJpY3QpO1xuICAgIG5vZGUuZXhwcmVzc2lvbiA9IGZhbHNlO1xuICAgIHRoaXMuYWRhcHREaXJlY3RpdmVQcm9sb2d1ZShub2RlLmJvZHkuYm9keSk7XG4gICAgdGhpcy5sYWJlbHMgPSBvbGRMYWJlbHM7XG4gIH1cbiAgdGhpcy5leGl0U2NvcGUoKTtcbn07XG5cbnBwJDUuaXNTaW1wbGVQYXJhbUxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgZm9yICh2YXIgaSA9IDAsIGxpc3QgPSBwYXJhbXM7IGkgPCBsaXN0Lmxlbmd0aDsgaSArPSAxKVxuICAgIHtcbiAgICB2YXIgcGFyYW0gPSBsaXN0W2ldO1xuXG4gICAgaWYgKHBhcmFtLnR5cGUgIT09IFwiSWRlbnRpZmllclwiKSB7IHJldHVybiBmYWxzZVxuICB9IH1cbiAgcmV0dXJuIHRydWVcbn07XG5cbi8vIENoZWNrcyBmdW5jdGlvbiBwYXJhbXMgZm9yIHZhcmlvdXMgZGlzYWxsb3dlZCBwYXR0ZXJucyBzdWNoIGFzIHVzaW5nIFwiZXZhbFwiXG4vLyBvciBcImFyZ3VtZW50c1wiIGFuZCBkdXBsaWNhdGUgcGFyYW1ldGVycy5cblxucHAkNS5jaGVja1BhcmFtcyA9IGZ1bmN0aW9uKG5vZGUsIGFsbG93RHVwbGljYXRlcykge1xuICB2YXIgbmFtZUhhc2ggPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKHZhciBpID0gMCwgbGlzdCA9IG5vZGUucGFyYW1zOyBpIDwgbGlzdC5sZW5ndGg7IGkgKz0gMSlcbiAgICB7XG4gICAgdmFyIHBhcmFtID0gbGlzdFtpXTtcblxuICAgIHRoaXMuY2hlY2tMVmFsSW5uZXJQYXR0ZXJuKHBhcmFtLCBCSU5EX1ZBUiwgYWxsb3dEdXBsaWNhdGVzID8gbnVsbCA6IG5hbWVIYXNoKTtcbiAgfVxufTtcblxuLy8gUGFyc2VzIGEgY29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgZXhwcmVzc2lvbnMsIGFuZCByZXR1cm5zIHRoZW0gYXNcbi8vIGFuIGFycmF5LiBgY2xvc2VgIGlzIHRoZSB0b2tlbiB0eXBlIHRoYXQgZW5kcyB0aGUgbGlzdCwgYW5kXG4vLyBgYWxsb3dFbXB0eWAgY2FuIGJlIHR1cm5lZCBvbiB0byBhbGxvdyBzdWJzZXF1ZW50IGNvbW1hcyB3aXRoXG4vLyBub3RoaW5nIGluIGJldHdlZW4gdGhlbSB0byBiZSBwYXJzZWQgYXMgYG51bGxgICh3aGljaCBpcyBuZWVkZWRcbi8vIGZvciBhcnJheSBsaXRlcmFscykuXG5cbnBwJDUucGFyc2VFeHByTGlzdCA9IGZ1bmN0aW9uKGNsb3NlLCBhbGxvd1RyYWlsaW5nQ29tbWEsIGFsbG93RW1wdHksIHJlZkRlc3RydWN0dXJpbmdFcnJvcnMpIHtcbiAgdmFyIGVsdHMgPSBbXSwgZmlyc3QgPSB0cnVlO1xuICB3aGlsZSAoIXRoaXMuZWF0KGNsb3NlKSkge1xuICAgIGlmICghZmlyc3QpIHtcbiAgICAgIHRoaXMuZXhwZWN0KHR5cGVzJDEuY29tbWEpO1xuICAgICAgaWYgKGFsbG93VHJhaWxpbmdDb21tYSAmJiB0aGlzLmFmdGVyVHJhaWxpbmdDb21tYShjbG9zZSkpIHsgYnJlYWsgfVxuICAgIH0gZWxzZSB7IGZpcnN0ID0gZmFsc2U7IH1cblxuICAgIHZhciBlbHQgPSAodm9pZCAwKTtcbiAgICBpZiAoYWxsb3dFbXB0eSAmJiB0aGlzLnR5cGUgPT09IHR5cGVzJDEuY29tbWEpXG4gICAgICB7IGVsdCA9IG51bGw7IH1cbiAgICBlbHNlIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEuZWxsaXBzaXMpIHtcbiAgICAgIGVsdCA9IHRoaXMucGFyc2VTcHJlYWQocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycyk7XG4gICAgICBpZiAocmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycyAmJiB0aGlzLnR5cGUgPT09IHR5cGVzJDEuY29tbWEgJiYgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycy50cmFpbGluZ0NvbW1hIDwgMClcbiAgICAgICAgeyByZWZEZXN0cnVjdHVyaW5nRXJyb3JzLnRyYWlsaW5nQ29tbWEgPSB0aGlzLnN0YXJ0OyB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsdCA9IHRoaXMucGFyc2VNYXliZUFzc2lnbihmYWxzZSwgcmVmRGVzdHJ1Y3R1cmluZ0Vycm9ycyk7XG4gICAgfVxuICAgIGVsdHMucHVzaChlbHQpO1xuICB9XG4gIHJldHVybiBlbHRzXG59O1xuXG5wcCQ1LmNoZWNrVW5yZXNlcnZlZCA9IGZ1bmN0aW9uKHJlZikge1xuICB2YXIgc3RhcnQgPSByZWYuc3RhcnQ7XG4gIHZhciBlbmQgPSByZWYuZW5kO1xuICB2YXIgbmFtZSA9IHJlZi5uYW1lO1xuXG4gIGlmICh0aGlzLmluR2VuZXJhdG9yICYmIG5hbWUgPT09IFwieWllbGRcIilcbiAgICB7IHRoaXMucmFpc2VSZWNvdmVyYWJsZShzdGFydCwgXCJDYW5ub3QgdXNlICd5aWVsZCcgYXMgaWRlbnRpZmllciBpbnNpZGUgYSBnZW5lcmF0b3JcIik7IH1cbiAgaWYgKHRoaXMuaW5Bc3luYyAmJiBuYW1lID09PSBcImF3YWl0XCIpXG4gICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUoc3RhcnQsIFwiQ2Fubm90IHVzZSAnYXdhaXQnIGFzIGlkZW50aWZpZXIgaW5zaWRlIGFuIGFzeW5jIGZ1bmN0aW9uXCIpOyB9XG4gIGlmICh0aGlzLmN1cnJlbnRUaGlzU2NvcGUoKS5pbkNsYXNzRmllbGRJbml0ICYmIG5hbWUgPT09IFwiYXJndW1lbnRzXCIpXG4gICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUoc3RhcnQsIFwiQ2Fubm90IHVzZSAnYXJndW1lbnRzJyBpbiBjbGFzcyBmaWVsZCBpbml0aWFsaXplclwiKTsgfVxuICBpZiAodGhpcy5pbkNsYXNzU3RhdGljQmxvY2sgJiYgKG5hbWUgPT09IFwiYXJndW1lbnRzXCIgfHwgbmFtZSA9PT0gXCJhd2FpdFwiKSlcbiAgICB7IHRoaXMucmFpc2Uoc3RhcnQsIChcIkNhbm5vdCB1c2UgXCIgKyBuYW1lICsgXCIgaW4gY2xhc3Mgc3RhdGljIGluaXRpYWxpemF0aW9uIGJsb2NrXCIpKTsgfVxuICBpZiAodGhpcy5rZXl3b3Jkcy50ZXN0KG5hbWUpKVxuICAgIHsgdGhpcy5yYWlzZShzdGFydCwgKFwiVW5leHBlY3RlZCBrZXl3b3JkICdcIiArIG5hbWUgKyBcIidcIikpOyB9XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPCA2ICYmXG4gICAgdGhpcy5pbnB1dC5zbGljZShzdGFydCwgZW5kKS5pbmRleE9mKFwiXFxcXFwiKSAhPT0gLTEpIHsgcmV0dXJuIH1cbiAgdmFyIHJlID0gdGhpcy5zdHJpY3QgPyB0aGlzLnJlc2VydmVkV29yZHNTdHJpY3QgOiB0aGlzLnJlc2VydmVkV29yZHM7XG4gIGlmIChyZS50ZXN0KG5hbWUpKSB7XG4gICAgaWYgKCF0aGlzLmluQXN5bmMgJiYgbmFtZSA9PT0gXCJhd2FpdFwiKVxuICAgICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUoc3RhcnQsIFwiQ2Fubm90IHVzZSBrZXl3b3JkICdhd2FpdCcgb3V0c2lkZSBhbiBhc3luYyBmdW5jdGlvblwiKTsgfVxuICAgIHRoaXMucmFpc2VSZWNvdmVyYWJsZShzdGFydCwgKFwiVGhlIGtleXdvcmQgJ1wiICsgbmFtZSArIFwiJyBpcyByZXNlcnZlZFwiKSk7XG4gIH1cbn07XG5cbi8vIFBhcnNlIHRoZSBuZXh0IHRva2VuIGFzIGFuIGlkZW50aWZpZXIuIElmIGBsaWJlcmFsYCBpcyB0cnVlICh1c2VkXG4vLyB3aGVuIHBhcnNpbmcgcHJvcGVydGllcyksIGl0IHdpbGwgYWxzbyBjb252ZXJ0IGtleXdvcmRzIGludG9cbi8vIGlkZW50aWZpZXJzLlxuXG5wcCQ1LnBhcnNlSWRlbnQgPSBmdW5jdGlvbihsaWJlcmFsLCBpc0JpbmRpbmcpIHtcbiAgdmFyIG5vZGUgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLm5hbWUpIHtcbiAgICBub2RlLm5hbWUgPSB0aGlzLnZhbHVlO1xuICB9IGVsc2UgaWYgKHRoaXMudHlwZS5rZXl3b3JkKSB7XG4gICAgbm9kZS5uYW1lID0gdGhpcy50eXBlLmtleXdvcmQ7XG5cbiAgICAvLyBUbyBmaXggaHR0cHM6Ly9naXRodWIuY29tL2Fjb3JuanMvYWNvcm4vaXNzdWVzLzU3NVxuICAgIC8vIGBjbGFzc2AgYW5kIGBmdW5jdGlvbmAga2V5d29yZHMgcHVzaCBuZXcgY29udGV4dCBpbnRvIHRoaXMuY29udGV4dC5cbiAgICAvLyBCdXQgdGhlcmUgaXMgbm8gY2hhbmNlIHRvIHBvcCB0aGUgY29udGV4dCBpZiB0aGUga2V5d29yZCBpcyBjb25zdW1lZCBhcyBhbiBpZGVudGlmaWVyIHN1Y2ggYXMgYSBwcm9wZXJ0eSBuYW1lLlxuICAgIC8vIElmIHRoZSBwcmV2aW91cyB0b2tlbiBpcyBhIGRvdCwgdGhpcyBkb2VzIG5vdCBhcHBseSBiZWNhdXNlIHRoZSBjb250ZXh0LW1hbmFnaW5nIGNvZGUgYWxyZWFkeSBpZ25vcmVkIHRoZSBrZXl3b3JkXG4gICAgaWYgKChub2RlLm5hbWUgPT09IFwiY2xhc3NcIiB8fCBub2RlLm5hbWUgPT09IFwiZnVuY3Rpb25cIikgJiZcbiAgICAgICAgKHRoaXMubGFzdFRva0VuZCAhPT0gdGhpcy5sYXN0VG9rU3RhcnQgKyAxIHx8IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLmxhc3RUb2tTdGFydCkgIT09IDQ2KSkge1xuICAgICAgdGhpcy5jb250ZXh0LnBvcCgpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aGlzLnVuZXhwZWN0ZWQoKTtcbiAgfVxuICB0aGlzLm5leHQoISFsaWJlcmFsKTtcbiAgdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiSWRlbnRpZmllclwiKTtcbiAgaWYgKCFsaWJlcmFsKSB7XG4gICAgdGhpcy5jaGVja1VucmVzZXJ2ZWQobm9kZSk7XG4gICAgaWYgKG5vZGUubmFtZSA9PT0gXCJhd2FpdFwiICYmICF0aGlzLmF3YWl0SWRlbnRQb3MpXG4gICAgICB7IHRoaXMuYXdhaXRJZGVudFBvcyA9IG5vZGUuc3RhcnQ7IH1cbiAgfVxuICByZXR1cm4gbm9kZVxufTtcblxucHAkNS5wYXJzZVByaXZhdGVJZGVudCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gIGlmICh0aGlzLnR5cGUgPT09IHR5cGVzJDEucHJpdmF0ZUlkKSB7XG4gICAgbm9kZS5uYW1lID0gdGhpcy52YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLnVuZXhwZWN0ZWQoKTtcbiAgfVxuICB0aGlzLm5leHQoKTtcbiAgdGhpcy5maW5pc2hOb2RlKG5vZGUsIFwiUHJpdmF0ZUlkZW50aWZpZXJcIik7XG5cbiAgLy8gRm9yIHZhbGlkYXRpbmcgZXhpc3RlbmNlXG4gIGlmICh0aGlzLnByaXZhdGVOYW1lU3RhY2subGVuZ3RoID09PSAwKSB7XG4gICAgdGhpcy5yYWlzZShub2RlLnN0YXJ0LCAoXCJQcml2YXRlIGZpZWxkICcjXCIgKyAobm9kZS5uYW1lKSArIFwiJyBtdXN0IGJlIGRlY2xhcmVkIGluIGFuIGVuY2xvc2luZyBjbGFzc1wiKSk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5wcml2YXRlTmFtZVN0YWNrW3RoaXMucHJpdmF0ZU5hbWVTdGFjay5sZW5ndGggLSAxXS51c2VkLnB1c2gobm9kZSk7XG4gIH1cblxuICByZXR1cm4gbm9kZVxufTtcblxuLy8gUGFyc2VzIHlpZWxkIGV4cHJlc3Npb24gaW5zaWRlIGdlbmVyYXRvci5cblxucHAkNS5wYXJzZVlpZWxkID0gZnVuY3Rpb24oZm9ySW5pdCkge1xuICBpZiAoIXRoaXMueWllbGRQb3MpIHsgdGhpcy55aWVsZFBvcyA9IHRoaXMuc3RhcnQ7IH1cblxuICB2YXIgbm9kZSA9IHRoaXMuc3RhcnROb2RlKCk7XG4gIHRoaXMubmV4dCgpO1xuICBpZiAodGhpcy50eXBlID09PSB0eXBlcyQxLnNlbWkgfHwgdGhpcy5jYW5JbnNlcnRTZW1pY29sb24oKSB8fCAodGhpcy50eXBlICE9PSB0eXBlcyQxLnN0YXIgJiYgIXRoaXMudHlwZS5zdGFydHNFeHByKSkge1xuICAgIG5vZGUuZGVsZWdhdGUgPSBmYWxzZTtcbiAgICBub2RlLmFyZ3VtZW50ID0gbnVsbDtcbiAgfSBlbHNlIHtcbiAgICBub2RlLmRlbGVnYXRlID0gdGhpcy5lYXQodHlwZXMkMS5zdGFyKTtcbiAgICBub2RlLmFyZ3VtZW50ID0gdGhpcy5wYXJzZU1heWJlQXNzaWduKGZvckluaXQpO1xuICB9XG4gIHJldHVybiB0aGlzLmZpbmlzaE5vZGUobm9kZSwgXCJZaWVsZEV4cHJlc3Npb25cIilcbn07XG5cbnBwJDUucGFyc2VBd2FpdCA9IGZ1bmN0aW9uKGZvckluaXQpIHtcbiAgaWYgKCF0aGlzLmF3YWl0UG9zKSB7IHRoaXMuYXdhaXRQb3MgPSB0aGlzLnN0YXJ0OyB9XG5cbiAgdmFyIG5vZGUgPSB0aGlzLnN0YXJ0Tm9kZSgpO1xuICB0aGlzLm5leHQoKTtcbiAgbm9kZS5hcmd1bWVudCA9IHRoaXMucGFyc2VNYXliZVVuYXJ5KG51bGwsIHRydWUsIGZhbHNlLCBmb3JJbml0KTtcbiAgcmV0dXJuIHRoaXMuZmluaXNoTm9kZShub2RlLCBcIkF3YWl0RXhwcmVzc2lvblwiKVxufTtcblxudmFyIHBwJDQgPSBQYXJzZXIucHJvdG90eXBlO1xuXG4vLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmFpc2UgZXhjZXB0aW9ucyBvbiBwYXJzZSBlcnJvcnMuIEl0XG4vLyB0YWtlcyBhbiBvZmZzZXQgaW50ZWdlciAoaW50byB0aGUgY3VycmVudCBgaW5wdXRgKSB0byBpbmRpY2F0ZVxuLy8gdGhlIGxvY2F0aW9uIG9mIHRoZSBlcnJvciwgYXR0YWNoZXMgdGhlIHBvc2l0aW9uIHRvIHRoZSBlbmRcbi8vIG9mIHRoZSBlcnJvciBtZXNzYWdlLCBhbmQgdGhlbiByYWlzZXMgYSBgU3ludGF4RXJyb3JgIHdpdGggdGhhdFxuLy8gbWVzc2FnZS5cblxucHAkNC5yYWlzZSA9IGZ1bmN0aW9uKHBvcywgbWVzc2FnZSkge1xuICB2YXIgbG9jID0gZ2V0TGluZUluZm8odGhpcy5pbnB1dCwgcG9zKTtcbiAgbWVzc2FnZSArPSBcIiAoXCIgKyBsb2MubGluZSArIFwiOlwiICsgbG9jLmNvbHVtbiArIFwiKVwiO1xuICB2YXIgZXJyID0gbmV3IFN5bnRheEVycm9yKG1lc3NhZ2UpO1xuICBlcnIucG9zID0gcG9zOyBlcnIubG9jID0gbG9jOyBlcnIucmFpc2VkQXQgPSB0aGlzLnBvcztcbiAgdGhyb3cgZXJyXG59O1xuXG5wcCQ0LnJhaXNlUmVjb3ZlcmFibGUgPSBwcCQ0LnJhaXNlO1xuXG5wcCQ0LmN1clBvc2l0aW9uID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLm9wdGlvbnMubG9jYXRpb25zKSB7XG4gICAgcmV0dXJuIG5ldyBQb3NpdGlvbih0aGlzLmN1ckxpbmUsIHRoaXMucG9zIC0gdGhpcy5saW5lU3RhcnQpXG4gIH1cbn07XG5cbnZhciBwcCQzID0gUGFyc2VyLnByb3RvdHlwZTtcblxudmFyIFNjb3BlID0gZnVuY3Rpb24gU2NvcGUoZmxhZ3MpIHtcbiAgdGhpcy5mbGFncyA9IGZsYWdzO1xuICAvLyBBIGxpc3Qgb2YgdmFyLWRlY2xhcmVkIG5hbWVzIGluIHRoZSBjdXJyZW50IGxleGljYWwgc2NvcGVcbiAgdGhpcy52YXIgPSBbXTtcbiAgLy8gQSBsaXN0IG9mIGxleGljYWxseS1kZWNsYXJlZCBuYW1lcyBpbiB0aGUgY3VycmVudCBsZXhpY2FsIHNjb3BlXG4gIHRoaXMubGV4aWNhbCA9IFtdO1xuICAvLyBBIGxpc3Qgb2YgbGV4aWNhbGx5LWRlY2xhcmVkIEZ1bmN0aW9uRGVjbGFyYXRpb24gbmFtZXMgaW4gdGhlIGN1cnJlbnQgbGV4aWNhbCBzY29wZVxuICB0aGlzLmZ1bmN0aW9ucyA9IFtdO1xuICAvLyBBIHN3aXRjaCB0byBkaXNhbGxvdyB0aGUgaWRlbnRpZmllciByZWZlcmVuY2UgJ2FyZ3VtZW50cydcbiAgdGhpcy5pbkNsYXNzRmllbGRJbml0ID0gZmFsc2U7XG59O1xuXG4vLyBUaGUgZnVuY3Rpb25zIGluIHRoaXMgbW9kdWxlIGtlZXAgdHJhY2sgb2YgZGVjbGFyZWQgdmFyaWFibGVzIGluIHRoZSBjdXJyZW50IHNjb3BlIGluIG9yZGVyIHRvIGRldGVjdCBkdXBsaWNhdGUgdmFyaWFibGUgbmFtZXMuXG5cbnBwJDMuZW50ZXJTY29wZSA9IGZ1bmN0aW9uKGZsYWdzKSB7XG4gIHRoaXMuc2NvcGVTdGFjay5wdXNoKG5ldyBTY29wZShmbGFncykpO1xufTtcblxucHAkMy5leGl0U2NvcGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5zY29wZVN0YWNrLnBvcCgpO1xufTtcblxuLy8gVGhlIHNwZWMgc2F5czpcbi8vID4gQXQgdGhlIHRvcCBsZXZlbCBvZiBhIGZ1bmN0aW9uLCBvciBzY3JpcHQsIGZ1bmN0aW9uIGRlY2xhcmF0aW9ucyBhcmVcbi8vID4gdHJlYXRlZCBsaWtlIHZhciBkZWNsYXJhdGlvbnMgcmF0aGVyIHRoYW4gbGlrZSBsZXhpY2FsIGRlY2xhcmF0aW9ucy5cbnBwJDMudHJlYXRGdW5jdGlvbnNBc1ZhckluU2NvcGUgPSBmdW5jdGlvbihzY29wZSkge1xuICByZXR1cm4gKHNjb3BlLmZsYWdzICYgU0NPUEVfRlVOQ1RJT04pIHx8ICF0aGlzLmluTW9kdWxlICYmIChzY29wZS5mbGFncyAmIFNDT1BFX1RPUClcbn07XG5cbnBwJDMuZGVjbGFyZU5hbWUgPSBmdW5jdGlvbihuYW1lLCBiaW5kaW5nVHlwZSwgcG9zKSB7XG4gIHZhciByZWRlY2xhcmVkID0gZmFsc2U7XG4gIGlmIChiaW5kaW5nVHlwZSA9PT0gQklORF9MRVhJQ0FMKSB7XG4gICAgdmFyIHNjb3BlID0gdGhpcy5jdXJyZW50U2NvcGUoKTtcbiAgICByZWRlY2xhcmVkID0gc2NvcGUubGV4aWNhbC5pbmRleE9mKG5hbWUpID4gLTEgfHwgc2NvcGUuZnVuY3Rpb25zLmluZGV4T2YobmFtZSkgPiAtMSB8fCBzY29wZS52YXIuaW5kZXhPZihuYW1lKSA+IC0xO1xuICAgIHNjb3BlLmxleGljYWwucHVzaChuYW1lKTtcbiAgICBpZiAodGhpcy5pbk1vZHVsZSAmJiAoc2NvcGUuZmxhZ3MgJiBTQ09QRV9UT1ApKVxuICAgICAgeyBkZWxldGUgdGhpcy51bmRlZmluZWRFeHBvcnRzW25hbWVdOyB9XG4gIH0gZWxzZSBpZiAoYmluZGluZ1R5cGUgPT09IEJJTkRfU0lNUExFX0NBVENIKSB7XG4gICAgdmFyIHNjb3BlJDEgPSB0aGlzLmN1cnJlbnRTY29wZSgpO1xuICAgIHNjb3BlJDEubGV4aWNhbC5wdXNoKG5hbWUpO1xuICB9IGVsc2UgaWYgKGJpbmRpbmdUeXBlID09PSBCSU5EX0ZVTkNUSU9OKSB7XG4gICAgdmFyIHNjb3BlJDIgPSB0aGlzLmN1cnJlbnRTY29wZSgpO1xuICAgIGlmICh0aGlzLnRyZWF0RnVuY3Rpb25zQXNWYXIpXG4gICAgICB7IHJlZGVjbGFyZWQgPSBzY29wZSQyLmxleGljYWwuaW5kZXhPZihuYW1lKSA+IC0xOyB9XG4gICAgZWxzZVxuICAgICAgeyByZWRlY2xhcmVkID0gc2NvcGUkMi5sZXhpY2FsLmluZGV4T2YobmFtZSkgPiAtMSB8fCBzY29wZSQyLnZhci5pbmRleE9mKG5hbWUpID4gLTE7IH1cbiAgICBzY29wZSQyLmZ1bmN0aW9ucy5wdXNoKG5hbWUpO1xuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIGkgPSB0aGlzLnNjb3BlU3RhY2subGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgIHZhciBzY29wZSQzID0gdGhpcy5zY29wZVN0YWNrW2ldO1xuICAgICAgaWYgKHNjb3BlJDMubGV4aWNhbC5pbmRleE9mKG5hbWUpID4gLTEgJiYgISgoc2NvcGUkMy5mbGFncyAmIFNDT1BFX1NJTVBMRV9DQVRDSCkgJiYgc2NvcGUkMy5sZXhpY2FsWzBdID09PSBuYW1lKSB8fFxuICAgICAgICAgICF0aGlzLnRyZWF0RnVuY3Rpb25zQXNWYXJJblNjb3BlKHNjb3BlJDMpICYmIHNjb3BlJDMuZnVuY3Rpb25zLmluZGV4T2YobmFtZSkgPiAtMSkge1xuICAgICAgICByZWRlY2xhcmVkID0gdHJ1ZTtcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIHNjb3BlJDMudmFyLnB1c2gobmFtZSk7XG4gICAgICBpZiAodGhpcy5pbk1vZHVsZSAmJiAoc2NvcGUkMy5mbGFncyAmIFNDT1BFX1RPUCkpXG4gICAgICAgIHsgZGVsZXRlIHRoaXMudW5kZWZpbmVkRXhwb3J0c1tuYW1lXTsgfVxuICAgICAgaWYgKHNjb3BlJDMuZmxhZ3MgJiBTQ09QRV9WQVIpIHsgYnJlYWsgfVxuICAgIH1cbiAgfVxuICBpZiAocmVkZWNsYXJlZCkgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUocG9zLCAoXCJJZGVudGlmaWVyICdcIiArIG5hbWUgKyBcIicgaGFzIGFscmVhZHkgYmVlbiBkZWNsYXJlZFwiKSk7IH1cbn07XG5cbnBwJDMuY2hlY2tMb2NhbEV4cG9ydCA9IGZ1bmN0aW9uKGlkKSB7XG4gIC8vIHNjb3BlLmZ1bmN0aW9ucyBtdXN0IGJlIGVtcHR5IGFzIE1vZHVsZSBjb2RlIGlzIGFsd2F5cyBzdHJpY3QuXG4gIGlmICh0aGlzLnNjb3BlU3RhY2tbMF0ubGV4aWNhbC5pbmRleE9mKGlkLm5hbWUpID09PSAtMSAmJlxuICAgICAgdGhpcy5zY29wZVN0YWNrWzBdLnZhci5pbmRleE9mKGlkLm5hbWUpID09PSAtMSkge1xuICAgIHRoaXMudW5kZWZpbmVkRXhwb3J0c1tpZC5uYW1lXSA9IGlkO1xuICB9XG59O1xuXG5wcCQzLmN1cnJlbnRTY29wZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5zY29wZVN0YWNrW3RoaXMuc2NvcGVTdGFjay5sZW5ndGggLSAxXVxufTtcblxucHAkMy5jdXJyZW50VmFyU2NvcGUgPSBmdW5jdGlvbigpIHtcbiAgZm9yICh2YXIgaSA9IHRoaXMuc2NvcGVTdGFjay5sZW5ndGggLSAxOzsgaS0tKSB7XG4gICAgdmFyIHNjb3BlID0gdGhpcy5zY29wZVN0YWNrW2ldO1xuICAgIGlmIChzY29wZS5mbGFncyAmIFNDT1BFX1ZBUikgeyByZXR1cm4gc2NvcGUgfVxuICB9XG59O1xuXG4vLyBDb3VsZCBiZSB1c2VmdWwgZm9yIGB0aGlzYCwgYG5ldy50YXJnZXRgLCBgc3VwZXIoKWAsIGBzdXBlci5wcm9wZXJ0eWAsIGFuZCBgc3VwZXJbcHJvcGVydHldYC5cbnBwJDMuY3VycmVudFRoaXNTY29wZSA9IGZ1bmN0aW9uKCkge1xuICBmb3IgKHZhciBpID0gdGhpcy5zY29wZVN0YWNrLmxlbmd0aCAtIDE7OyBpLS0pIHtcbiAgICB2YXIgc2NvcGUgPSB0aGlzLnNjb3BlU3RhY2tbaV07XG4gICAgaWYgKHNjb3BlLmZsYWdzICYgU0NPUEVfVkFSICYmICEoc2NvcGUuZmxhZ3MgJiBTQ09QRV9BUlJPVykpIHsgcmV0dXJuIHNjb3BlIH1cbiAgfVxufTtcblxudmFyIE5vZGUgPSBmdW5jdGlvbiBOb2RlKHBhcnNlciwgcG9zLCBsb2MpIHtcbiAgdGhpcy50eXBlID0gXCJcIjtcbiAgdGhpcy5zdGFydCA9IHBvcztcbiAgdGhpcy5lbmQgPSAwO1xuICBpZiAocGFyc2VyLm9wdGlvbnMubG9jYXRpb25zKVxuICAgIHsgdGhpcy5sb2MgPSBuZXcgU291cmNlTG9jYXRpb24ocGFyc2VyLCBsb2MpOyB9XG4gIGlmIChwYXJzZXIub3B0aW9ucy5kaXJlY3RTb3VyY2VGaWxlKVxuICAgIHsgdGhpcy5zb3VyY2VGaWxlID0gcGFyc2VyLm9wdGlvbnMuZGlyZWN0U291cmNlRmlsZTsgfVxuICBpZiAocGFyc2VyLm9wdGlvbnMucmFuZ2VzKVxuICAgIHsgdGhpcy5yYW5nZSA9IFtwb3MsIDBdOyB9XG59O1xuXG4vLyBTdGFydCBhbiBBU1Qgbm9kZSwgYXR0YWNoaW5nIGEgc3RhcnQgb2Zmc2V0LlxuXG52YXIgcHAkMiA9IFBhcnNlci5wcm90b3R5cGU7XG5cbnBwJDIuc3RhcnROb2RlID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgTm9kZSh0aGlzLCB0aGlzLnN0YXJ0LCB0aGlzLnN0YXJ0TG9jKVxufTtcblxucHAkMi5zdGFydE5vZGVBdCA9IGZ1bmN0aW9uKHBvcywgbG9jKSB7XG4gIHJldHVybiBuZXcgTm9kZSh0aGlzLCBwb3MsIGxvYylcbn07XG5cbi8vIEZpbmlzaCBhbiBBU1Qgbm9kZSwgYWRkaW5nIGB0eXBlYCBhbmQgYGVuZGAgcHJvcGVydGllcy5cblxuZnVuY3Rpb24gZmluaXNoTm9kZUF0KG5vZGUsIHR5cGUsIHBvcywgbG9jKSB7XG4gIG5vZGUudHlwZSA9IHR5cGU7XG4gIG5vZGUuZW5kID0gcG9zO1xuICBpZiAodGhpcy5vcHRpb25zLmxvY2F0aW9ucylcbiAgICB7IG5vZGUubG9jLmVuZCA9IGxvYzsgfVxuICBpZiAodGhpcy5vcHRpb25zLnJhbmdlcylcbiAgICB7IG5vZGUucmFuZ2VbMV0gPSBwb3M7IH1cbiAgcmV0dXJuIG5vZGVcbn1cblxucHAkMi5maW5pc2hOb2RlID0gZnVuY3Rpb24obm9kZSwgdHlwZSkge1xuICByZXR1cm4gZmluaXNoTm9kZUF0LmNhbGwodGhpcywgbm9kZSwgdHlwZSwgdGhpcy5sYXN0VG9rRW5kLCB0aGlzLmxhc3RUb2tFbmRMb2MpXG59O1xuXG4vLyBGaW5pc2ggbm9kZSBhdCBnaXZlbiBwb3NpdGlvblxuXG5wcCQyLmZpbmlzaE5vZGVBdCA9IGZ1bmN0aW9uKG5vZGUsIHR5cGUsIHBvcywgbG9jKSB7XG4gIHJldHVybiBmaW5pc2hOb2RlQXQuY2FsbCh0aGlzLCBub2RlLCB0eXBlLCBwb3MsIGxvYylcbn07XG5cbnBwJDIuY29weU5vZGUgPSBmdW5jdGlvbihub2RlKSB7XG4gIHZhciBuZXdOb2RlID0gbmV3IE5vZGUodGhpcywgbm9kZS5zdGFydCwgdGhpcy5zdGFydExvYyk7XG4gIGZvciAodmFyIHByb3AgaW4gbm9kZSkgeyBuZXdOb2RlW3Byb3BdID0gbm9kZVtwcm9wXTsgfVxuICByZXR1cm4gbmV3Tm9kZVxufTtcblxuLy8gVGhpcyBmaWxlIGNvbnRhaW5zIFVuaWNvZGUgcHJvcGVydGllcyBleHRyYWN0ZWQgZnJvbSB0aGUgRUNNQVNjcmlwdFxuLy8gc3BlY2lmaWNhdGlvbi4gVGhlIGxpc3RzIGFyZSBleHRyYWN0ZWQgbGlrZSBzbzpcbi8vICQkKCcjdGFibGUtYmluYXJ5LXVuaWNvZGUtcHJvcGVydGllcyA+IGZpZ3VyZSA+IHRhYmxlID4gdGJvZHkgPiB0ciA+IHRkOm50aC1jaGlsZCgxKSBjb2RlJykubWFwKGVsID0+IGVsLmlubmVyVGV4dClcblxuLy8gI3RhYmxlLWJpbmFyeS11bmljb2RlLXByb3BlcnRpZXNcbnZhciBlY21hOUJpbmFyeVByb3BlcnRpZXMgPSBcIkFTQ0lJIEFTQ0lJX0hleF9EaWdpdCBBSGV4IEFscGhhYmV0aWMgQWxwaGEgQW55IEFzc2lnbmVkIEJpZGlfQ29udHJvbCBCaWRpX0MgQmlkaV9NaXJyb3JlZCBCaWRpX00gQ2FzZV9JZ25vcmFibGUgQ0kgQ2FzZWQgQ2hhbmdlc19XaGVuX0Nhc2Vmb2xkZWQgQ1dDRiBDaGFuZ2VzX1doZW5fQ2FzZW1hcHBlZCBDV0NNIENoYW5nZXNfV2hlbl9Mb3dlcmNhc2VkIENXTCBDaGFuZ2VzX1doZW5fTkZLQ19DYXNlZm9sZGVkIENXS0NGIENoYW5nZXNfV2hlbl9UaXRsZWNhc2VkIENXVCBDaGFuZ2VzX1doZW5fVXBwZXJjYXNlZCBDV1UgRGFzaCBEZWZhdWx0X0lnbm9yYWJsZV9Db2RlX1BvaW50IERJIERlcHJlY2F0ZWQgRGVwIERpYWNyaXRpYyBEaWEgRW1vamkgRW1vamlfQ29tcG9uZW50IEVtb2ppX01vZGlmaWVyIEVtb2ppX01vZGlmaWVyX0Jhc2UgRW1vamlfUHJlc2VudGF0aW9uIEV4dGVuZGVyIEV4dCBHcmFwaGVtZV9CYXNlIEdyX0Jhc2UgR3JhcGhlbWVfRXh0ZW5kIEdyX0V4dCBIZXhfRGlnaXQgSGV4IElEU19CaW5hcnlfT3BlcmF0b3IgSURTQiBJRFNfVHJpbmFyeV9PcGVyYXRvciBJRFNUIElEX0NvbnRpbnVlIElEQyBJRF9TdGFydCBJRFMgSWRlb2dyYXBoaWMgSWRlbyBKb2luX0NvbnRyb2wgSm9pbl9DIExvZ2ljYWxfT3JkZXJfRXhjZXB0aW9uIExPRSBMb3dlcmNhc2UgTG93ZXIgTWF0aCBOb25jaGFyYWN0ZXJfQ29kZV9Qb2ludCBOQ2hhciBQYXR0ZXJuX1N5bnRheCBQYXRfU3luIFBhdHRlcm5fV2hpdGVfU3BhY2UgUGF0X1dTIFF1b3RhdGlvbl9NYXJrIFFNYXJrIFJhZGljYWwgUmVnaW9uYWxfSW5kaWNhdG9yIFJJIFNlbnRlbmNlX1Rlcm1pbmFsIFNUZXJtIFNvZnRfRG90dGVkIFNEIFRlcm1pbmFsX1B1bmN0dWF0aW9uIFRlcm0gVW5pZmllZF9JZGVvZ3JhcGggVUlkZW8gVXBwZXJjYXNlIFVwcGVyIFZhcmlhdGlvbl9TZWxlY3RvciBWUyBXaGl0ZV9TcGFjZSBzcGFjZSBYSURfQ29udGludWUgWElEQyBYSURfU3RhcnQgWElEU1wiO1xudmFyIGVjbWExMEJpbmFyeVByb3BlcnRpZXMgPSBlY21hOUJpbmFyeVByb3BlcnRpZXMgKyBcIiBFeHRlbmRlZF9QaWN0b2dyYXBoaWNcIjtcbnZhciBlY21hMTFCaW5hcnlQcm9wZXJ0aWVzID0gZWNtYTEwQmluYXJ5UHJvcGVydGllcztcbnZhciBlY21hMTJCaW5hcnlQcm9wZXJ0aWVzID0gZWNtYTExQmluYXJ5UHJvcGVydGllcyArIFwiIEVCYXNlIEVDb21wIEVNb2QgRVByZXMgRXh0UGljdFwiO1xudmFyIGVjbWExM0JpbmFyeVByb3BlcnRpZXMgPSBlY21hMTJCaW5hcnlQcm9wZXJ0aWVzO1xudmFyIHVuaWNvZGVCaW5hcnlQcm9wZXJ0aWVzID0ge1xuICA5OiBlY21hOUJpbmFyeVByb3BlcnRpZXMsXG4gIDEwOiBlY21hMTBCaW5hcnlQcm9wZXJ0aWVzLFxuICAxMTogZWNtYTExQmluYXJ5UHJvcGVydGllcyxcbiAgMTI6IGVjbWExMkJpbmFyeVByb3BlcnRpZXMsXG4gIDEzOiBlY21hMTNCaW5hcnlQcm9wZXJ0aWVzXG59O1xuXG4vLyAjdGFibGUtdW5pY29kZS1nZW5lcmFsLWNhdGVnb3J5LXZhbHVlc1xudmFyIHVuaWNvZGVHZW5lcmFsQ2F0ZWdvcnlWYWx1ZXMgPSBcIkNhc2VkX0xldHRlciBMQyBDbG9zZV9QdW5jdHVhdGlvbiBQZSBDb25uZWN0b3JfUHVuY3R1YXRpb24gUGMgQ29udHJvbCBDYyBjbnRybCBDdXJyZW5jeV9TeW1ib2wgU2MgRGFzaF9QdW5jdHVhdGlvbiBQZCBEZWNpbWFsX051bWJlciBOZCBkaWdpdCBFbmNsb3NpbmdfTWFyayBNZSBGaW5hbF9QdW5jdHVhdGlvbiBQZiBGb3JtYXQgQ2YgSW5pdGlhbF9QdW5jdHVhdGlvbiBQaSBMZXR0ZXIgTCBMZXR0ZXJfTnVtYmVyIE5sIExpbmVfU2VwYXJhdG9yIFpsIExvd2VyY2FzZV9MZXR0ZXIgTGwgTWFyayBNIENvbWJpbmluZ19NYXJrIE1hdGhfU3ltYm9sIFNtIE1vZGlmaWVyX0xldHRlciBMbSBNb2RpZmllcl9TeW1ib2wgU2sgTm9uc3BhY2luZ19NYXJrIE1uIE51bWJlciBOIE9wZW5fUHVuY3R1YXRpb24gUHMgT3RoZXIgQyBPdGhlcl9MZXR0ZXIgTG8gT3RoZXJfTnVtYmVyIE5vIE90aGVyX1B1bmN0dWF0aW9uIFBvIE90aGVyX1N5bWJvbCBTbyBQYXJhZ3JhcGhfU2VwYXJhdG9yIFpwIFByaXZhdGVfVXNlIENvIFB1bmN0dWF0aW9uIFAgcHVuY3QgU2VwYXJhdG9yIFogU3BhY2VfU2VwYXJhdG9yIFpzIFNwYWNpbmdfTWFyayBNYyBTdXJyb2dhdGUgQ3MgU3ltYm9sIFMgVGl0bGVjYXNlX0xldHRlciBMdCBVbmFzc2lnbmVkIENuIFVwcGVyY2FzZV9MZXR0ZXIgTHVcIjtcblxuLy8gI3RhYmxlLXVuaWNvZGUtc2NyaXB0LXZhbHVlc1xudmFyIGVjbWE5U2NyaXB0VmFsdWVzID0gXCJBZGxhbSBBZGxtIEFob20gQW5hdG9saWFuX0hpZXJvZ2x5cGhzIEhsdXcgQXJhYmljIEFyYWIgQXJtZW5pYW4gQXJtbiBBdmVzdGFuIEF2c3QgQmFsaW5lc2UgQmFsaSBCYW11bSBCYW11IEJhc3NhX1ZhaCBCYXNzIEJhdGFrIEJhdGsgQmVuZ2FsaSBCZW5nIEJoYWlrc3VraSBCaGtzIEJvcG9tb2ZvIEJvcG8gQnJhaG1pIEJyYWggQnJhaWxsZSBCcmFpIEJ1Z2luZXNlIEJ1Z2kgQnVoaWQgQnVoZCBDYW5hZGlhbl9BYm9yaWdpbmFsIENhbnMgQ2FyaWFuIENhcmkgQ2F1Y2FzaWFuX0FsYmFuaWFuIEFnaGIgQ2hha21hIENha20gQ2hhbSBDaGFtIENoZXJva2VlIENoZXIgQ29tbW9uIFp5eXkgQ29wdGljIENvcHQgUWFhYyBDdW5laWZvcm0gWHN1eCBDeXByaW90IENwcnQgQ3lyaWxsaWMgQ3lybCBEZXNlcmV0IERzcnQgRGV2YW5hZ2FyaSBEZXZhIER1cGxveWFuIER1cGwgRWd5cHRpYW5fSGllcm9nbHlwaHMgRWd5cCBFbGJhc2FuIEVsYmEgRXRoaW9waWMgRXRoaSBHZW9yZ2lhbiBHZW9yIEdsYWdvbGl0aWMgR2xhZyBHb3RoaWMgR290aCBHcmFudGhhIEdyYW4gR3JlZWsgR3JlayBHdWphcmF0aSBHdWpyIEd1cm11a2hpIEd1cnUgSGFuIEhhbmkgSGFuZ3VsIEhhbmcgSGFudW5vbyBIYW5vIEhhdHJhbiBIYXRyIEhlYnJldyBIZWJyIEhpcmFnYW5hIEhpcmEgSW1wZXJpYWxfQXJhbWFpYyBBcm1pIEluaGVyaXRlZCBaaW5oIFFhYWkgSW5zY3JpcHRpb25hbF9QYWhsYXZpIFBobGkgSW5zY3JpcHRpb25hbF9QYXJ0aGlhbiBQcnRpIEphdmFuZXNlIEphdmEgS2FpdGhpIEt0aGkgS2FubmFkYSBLbmRhIEthdGFrYW5hIEthbmEgS2F5YWhfTGkgS2FsaSBLaGFyb3NodGhpIEtoYXIgS2htZXIgS2htciBLaG9qa2kgS2hvaiBLaHVkYXdhZGkgU2luZCBMYW8gTGFvbyBMYXRpbiBMYXRuIExlcGNoYSBMZXBjIExpbWJ1IExpbWIgTGluZWFyX0EgTGluYSBMaW5lYXJfQiBMaW5iIExpc3UgTGlzdSBMeWNpYW4gTHljaSBMeWRpYW4gTHlkaSBNYWhhamFuaSBNYWhqIE1hbGF5YWxhbSBNbHltIE1hbmRhaWMgTWFuZCBNYW5pY2hhZWFuIE1hbmkgTWFyY2hlbiBNYXJjIE1hc2FyYW1fR29uZGkgR29ubSBNZWV0ZWlfTWF5ZWsgTXRlaSBNZW5kZV9LaWtha3VpIE1lbmQgTWVyb2l0aWNfQ3Vyc2l2ZSBNZXJjIE1lcm9pdGljX0hpZXJvZ2x5cGhzIE1lcm8gTWlhbyBQbHJkIE1vZGkgTW9uZ29saWFuIE1vbmcgTXJvIE1yb28gTXVsdGFuaSBNdWx0IE15YW5tYXIgTXltciBOYWJhdGFlYW4gTmJhdCBOZXdfVGFpX0x1ZSBUYWx1IE5ld2EgTmV3YSBOa28gTmtvbyBOdXNodSBOc2h1IE9naGFtIE9nYW0gT2xfQ2hpa2kgT2xjayBPbGRfSHVuZ2FyaWFuIEh1bmcgT2xkX0l0YWxpYyBJdGFsIE9sZF9Ob3J0aF9BcmFiaWFuIE5hcmIgT2xkX1Blcm1pYyBQZXJtIE9sZF9QZXJzaWFuIFhwZW8gT2xkX1NvdXRoX0FyYWJpYW4gU2FyYiBPbGRfVHVya2ljIE9ya2ggT3JpeWEgT3J5YSBPc2FnZSBPc2dlIE9zbWFueWEgT3NtYSBQYWhhd2hfSG1vbmcgSG1uZyBQYWxteXJlbmUgUGFsbSBQYXVfQ2luX0hhdSBQYXVjIFBoYWdzX1BhIFBoYWcgUGhvZW5pY2lhbiBQaG54IFBzYWx0ZXJfUGFobGF2aSBQaGxwIFJlamFuZyBSam5nIFJ1bmljIFJ1bnIgU2FtYXJpdGFuIFNhbXIgU2F1cmFzaHRyYSBTYXVyIFNoYXJhZGEgU2hyZCBTaGF2aWFuIFNoYXcgU2lkZGhhbSBTaWRkIFNpZ25Xcml0aW5nIFNnbncgU2luaGFsYSBTaW5oIFNvcmFfU29tcGVuZyBTb3JhIFNveW9tYm8gU295byBTdW5kYW5lc2UgU3VuZCBTeWxvdGlfTmFncmkgU3lsbyBTeXJpYWMgU3lyYyBUYWdhbG9nIFRnbGcgVGFnYmFud2EgVGFnYiBUYWlfTGUgVGFsZSBUYWlfVGhhbSBMYW5hIFRhaV9WaWV0IFRhdnQgVGFrcmkgVGFrciBUYW1pbCBUYW1sIFRhbmd1dCBUYW5nIFRlbHVndSBUZWx1IFRoYWFuYSBUaGFhIFRoYWkgVGhhaSBUaWJldGFuIFRpYnQgVGlmaW5hZ2ggVGZuZyBUaXJodXRhIFRpcmggVWdhcml0aWMgVWdhciBWYWkgVmFpaSBXYXJhbmdfQ2l0aSBXYXJhIFlpIFlpaWkgWmFuYWJhemFyX1NxdWFyZSBaYW5iXCI7XG52YXIgZWNtYTEwU2NyaXB0VmFsdWVzID0gZWNtYTlTY3JpcHRWYWx1ZXMgKyBcIiBEb2dyYSBEb2dyIEd1bmphbGFfR29uZGkgR29uZyBIYW5pZmlfUm9oaW5neWEgUm9oZyBNYWthc2FyIE1ha2EgTWVkZWZhaWRyaW4gTWVkZiBPbGRfU29nZGlhbiBTb2dvIFNvZ2RpYW4gU29nZFwiO1xudmFyIGVjbWExMVNjcmlwdFZhbHVlcyA9IGVjbWExMFNjcmlwdFZhbHVlcyArIFwiIEVseW1haWMgRWx5bSBOYW5kaW5hZ2FyaSBOYW5kIE55aWFrZW5nX1B1YWNodWVfSG1vbmcgSG1ucCBXYW5jaG8gV2Nob1wiO1xudmFyIGVjbWExMlNjcmlwdFZhbHVlcyA9IGVjbWExMVNjcmlwdFZhbHVlcyArIFwiIENob3Jhc21pYW4gQ2hycyBEaWFrIERpdmVzX0FrdXJ1IEtoaXRhbl9TbWFsbF9TY3JpcHQgS2l0cyBZZXppIFllemlkaVwiO1xudmFyIGVjbWExM1NjcmlwdFZhbHVlcyA9IGVjbWExMlNjcmlwdFZhbHVlcyArIFwiIEN5cHJvX01pbm9hbiBDcG1uIE9sZF9VeWdodXIgT3VnciBUYW5nc2EgVG5zYSBUb3RvIFZpdGhrdXFpIFZpdGhcIjtcbnZhciB1bmljb2RlU2NyaXB0VmFsdWVzID0ge1xuICA5OiBlY21hOVNjcmlwdFZhbHVlcyxcbiAgMTA6IGVjbWExMFNjcmlwdFZhbHVlcyxcbiAgMTE6IGVjbWExMVNjcmlwdFZhbHVlcyxcbiAgMTI6IGVjbWExMlNjcmlwdFZhbHVlcyxcbiAgMTM6IGVjbWExM1NjcmlwdFZhbHVlc1xufTtcblxudmFyIGRhdGEgPSB7fTtcbmZ1bmN0aW9uIGJ1aWxkVW5pY29kZURhdGEoZWNtYVZlcnNpb24pIHtcbiAgdmFyIGQgPSBkYXRhW2VjbWFWZXJzaW9uXSA9IHtcbiAgICBiaW5hcnk6IHdvcmRzUmVnZXhwKHVuaWNvZGVCaW5hcnlQcm9wZXJ0aWVzW2VjbWFWZXJzaW9uXSArIFwiIFwiICsgdW5pY29kZUdlbmVyYWxDYXRlZ29yeVZhbHVlcyksXG4gICAgbm9uQmluYXJ5OiB7XG4gICAgICBHZW5lcmFsX0NhdGVnb3J5OiB3b3Jkc1JlZ2V4cCh1bmljb2RlR2VuZXJhbENhdGVnb3J5VmFsdWVzKSxcbiAgICAgIFNjcmlwdDogd29yZHNSZWdleHAodW5pY29kZVNjcmlwdFZhbHVlc1tlY21hVmVyc2lvbl0pXG4gICAgfVxuICB9O1xuICBkLm5vbkJpbmFyeS5TY3JpcHRfRXh0ZW5zaW9ucyA9IGQubm9uQmluYXJ5LlNjcmlwdDtcblxuICBkLm5vbkJpbmFyeS5nYyA9IGQubm9uQmluYXJ5LkdlbmVyYWxfQ2F0ZWdvcnk7XG4gIGQubm9uQmluYXJ5LnNjID0gZC5ub25CaW5hcnkuU2NyaXB0O1xuICBkLm5vbkJpbmFyeS5zY3ggPSBkLm5vbkJpbmFyeS5TY3JpcHRfRXh0ZW5zaW9ucztcbn1cblxuZm9yICh2YXIgaSA9IDAsIGxpc3QgPSBbOSwgMTAsIDExLCAxMiwgMTNdOyBpIDwgbGlzdC5sZW5ndGg7IGkgKz0gMSkge1xuICB2YXIgZWNtYVZlcnNpb24gPSBsaXN0W2ldO1xuXG4gIGJ1aWxkVW5pY29kZURhdGEoZWNtYVZlcnNpb24pO1xufVxuXG52YXIgcHAkMSA9IFBhcnNlci5wcm90b3R5cGU7XG5cbnZhciBSZWdFeHBWYWxpZGF0aW9uU3RhdGUgPSBmdW5jdGlvbiBSZWdFeHBWYWxpZGF0aW9uU3RhdGUocGFyc2VyKSB7XG4gIHRoaXMucGFyc2VyID0gcGFyc2VyO1xuICB0aGlzLnZhbGlkRmxhZ3MgPSBcImdpbVwiICsgKHBhcnNlci5vcHRpb25zLmVjbWFWZXJzaW9uID49IDYgPyBcInV5XCIgOiBcIlwiKSArIChwYXJzZXIub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA5ID8gXCJzXCIgOiBcIlwiKSArIChwYXJzZXIub3B0aW9ucy5lY21hVmVyc2lvbiA+PSAxMyA/IFwiZFwiIDogXCJcIik7XG4gIHRoaXMudW5pY29kZVByb3BlcnRpZXMgPSBkYXRhW3BhcnNlci5vcHRpb25zLmVjbWFWZXJzaW9uID49IDEzID8gMTMgOiBwYXJzZXIub3B0aW9ucy5lY21hVmVyc2lvbl07XG4gIHRoaXMuc291cmNlID0gXCJcIjtcbiAgdGhpcy5mbGFncyA9IFwiXCI7XG4gIHRoaXMuc3RhcnQgPSAwO1xuICB0aGlzLnN3aXRjaFUgPSBmYWxzZTtcbiAgdGhpcy5zd2l0Y2hOID0gZmFsc2U7XG4gIHRoaXMucG9zID0gMDtcbiAgdGhpcy5sYXN0SW50VmFsdWUgPSAwO1xuICB0aGlzLmxhc3RTdHJpbmdWYWx1ZSA9IFwiXCI7XG4gIHRoaXMubGFzdEFzc2VydGlvbklzUXVhbnRpZmlhYmxlID0gZmFsc2U7XG4gIHRoaXMubnVtQ2FwdHVyaW5nUGFyZW5zID0gMDtcbiAgdGhpcy5tYXhCYWNrUmVmZXJlbmNlID0gMDtcbiAgdGhpcy5ncm91cE5hbWVzID0gW107XG4gIHRoaXMuYmFja1JlZmVyZW5jZU5hbWVzID0gW107XG59O1xuXG5SZWdFeHBWYWxpZGF0aW9uU3RhdGUucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gcmVzZXQgKHN0YXJ0LCBwYXR0ZXJuLCBmbGFncykge1xuICB2YXIgdW5pY29kZSA9IGZsYWdzLmluZGV4T2YoXCJ1XCIpICE9PSAtMTtcbiAgdGhpcy5zdGFydCA9IHN0YXJ0IHwgMDtcbiAgdGhpcy5zb3VyY2UgPSBwYXR0ZXJuICsgXCJcIjtcbiAgdGhpcy5mbGFncyA9IGZsYWdzO1xuICB0aGlzLnN3aXRjaFUgPSB1bmljb2RlICYmIHRoaXMucGFyc2VyLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gNjtcbiAgdGhpcy5zd2l0Y2hOID0gdW5pY29kZSAmJiB0aGlzLnBhcnNlci5vcHRpb25zLmVjbWFWZXJzaW9uID49IDk7XG59O1xuXG5SZWdFeHBWYWxpZGF0aW9uU3RhdGUucHJvdG90eXBlLnJhaXNlID0gZnVuY3Rpb24gcmFpc2UgKG1lc3NhZ2UpIHtcbiAgdGhpcy5wYXJzZXIucmFpc2VSZWNvdmVyYWJsZSh0aGlzLnN0YXJ0LCAoXCJJbnZhbGlkIHJlZ3VsYXIgZXhwcmVzc2lvbjogL1wiICsgKHRoaXMuc291cmNlKSArIFwiLzogXCIgKyBtZXNzYWdlKSk7XG59O1xuXG4vLyBJZiB1IGZsYWcgaXMgZ2l2ZW4sIHRoaXMgcmV0dXJucyB0aGUgY29kZSBwb2ludCBhdCB0aGUgaW5kZXggKGl0IGNvbWJpbmVzIGEgc3Vycm9nYXRlIHBhaXIpLlxuLy8gT3RoZXJ3aXNlLCB0aGlzIHJldHVybnMgdGhlIGNvZGUgdW5pdCBvZiB0aGUgaW5kZXggKGNhbiBiZSBhIHBhcnQgb2YgYSBzdXJyb2dhdGUgcGFpcikuXG5SZWdFeHBWYWxpZGF0aW9uU3RhdGUucHJvdG90eXBlLmF0ID0gZnVuY3Rpb24gYXQgKGksIGZvcmNlVSkge1xuICAgIGlmICggZm9yY2VVID09PSB2b2lkIDAgKSBmb3JjZVUgPSBmYWxzZTtcblxuICB2YXIgcyA9IHRoaXMuc291cmNlO1xuICB2YXIgbCA9IHMubGVuZ3RoO1xuICBpZiAoaSA+PSBsKSB7XG4gICAgcmV0dXJuIC0xXG4gIH1cbiAgdmFyIGMgPSBzLmNoYXJDb2RlQXQoaSk7XG4gIGlmICghKGZvcmNlVSB8fCB0aGlzLnN3aXRjaFUpIHx8IGMgPD0gMHhEN0ZGIHx8IGMgPj0gMHhFMDAwIHx8IGkgKyAxID49IGwpIHtcbiAgICByZXR1cm4gY1xuICB9XG4gIHZhciBuZXh0ID0gcy5jaGFyQ29kZUF0KGkgKyAxKTtcbiAgcmV0dXJuIG5leHQgPj0gMHhEQzAwICYmIG5leHQgPD0gMHhERkZGID8gKGMgPDwgMTApICsgbmV4dCAtIDB4MzVGREMwMCA6IGNcbn07XG5cblJlZ0V4cFZhbGlkYXRpb25TdGF0ZS5wcm90b3R5cGUubmV4dEluZGV4ID0gZnVuY3Rpb24gbmV4dEluZGV4IChpLCBmb3JjZVUpIHtcbiAgICBpZiAoIGZvcmNlVSA9PT0gdm9pZCAwICkgZm9yY2VVID0gZmFsc2U7XG5cbiAgdmFyIHMgPSB0aGlzLnNvdXJjZTtcbiAgdmFyIGwgPSBzLmxlbmd0aDtcbiAgaWYgKGkgPj0gbCkge1xuICAgIHJldHVybiBsXG4gIH1cbiAgdmFyIGMgPSBzLmNoYXJDb2RlQXQoaSksIG5leHQ7XG4gIGlmICghKGZvcmNlVSB8fCB0aGlzLnN3aXRjaFUpIHx8IGMgPD0gMHhEN0ZGIHx8IGMgPj0gMHhFMDAwIHx8IGkgKyAxID49IGwgfHxcbiAgICAgIChuZXh0ID0gcy5jaGFyQ29kZUF0KGkgKyAxKSkgPCAweERDMDAgfHwgbmV4dCA+IDB4REZGRikge1xuICAgIHJldHVybiBpICsgMVxuICB9XG4gIHJldHVybiBpICsgMlxufTtcblxuUmVnRXhwVmFsaWRhdGlvblN0YXRlLnByb3RvdHlwZS5jdXJyZW50ID0gZnVuY3Rpb24gY3VycmVudCAoZm9yY2VVKSB7XG4gICAgaWYgKCBmb3JjZVUgPT09IHZvaWQgMCApIGZvcmNlVSA9IGZhbHNlO1xuXG4gIHJldHVybiB0aGlzLmF0KHRoaXMucG9zLCBmb3JjZVUpXG59O1xuXG5SZWdFeHBWYWxpZGF0aW9uU3RhdGUucHJvdG90eXBlLmxvb2thaGVhZCA9IGZ1bmN0aW9uIGxvb2thaGVhZCAoZm9yY2VVKSB7XG4gICAgaWYgKCBmb3JjZVUgPT09IHZvaWQgMCApIGZvcmNlVSA9IGZhbHNlO1xuXG4gIHJldHVybiB0aGlzLmF0KHRoaXMubmV4dEluZGV4KHRoaXMucG9zLCBmb3JjZVUpLCBmb3JjZVUpXG59O1xuXG5SZWdFeHBWYWxpZGF0aW9uU3RhdGUucHJvdG90eXBlLmFkdmFuY2UgPSBmdW5jdGlvbiBhZHZhbmNlIChmb3JjZVUpIHtcbiAgICBpZiAoIGZvcmNlVSA9PT0gdm9pZCAwICkgZm9yY2VVID0gZmFsc2U7XG5cbiAgdGhpcy5wb3MgPSB0aGlzLm5leHRJbmRleCh0aGlzLnBvcywgZm9yY2VVKTtcbn07XG5cblJlZ0V4cFZhbGlkYXRpb25TdGF0ZS5wcm90b3R5cGUuZWF0ID0gZnVuY3Rpb24gZWF0IChjaCwgZm9yY2VVKSB7XG4gICAgaWYgKCBmb3JjZVUgPT09IHZvaWQgMCApIGZvcmNlVSA9IGZhbHNlO1xuXG4gIGlmICh0aGlzLmN1cnJlbnQoZm9yY2VVKSA9PT0gY2gpIHtcbiAgICB0aGlzLmFkdmFuY2UoZm9yY2VVKTtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIHJldHVybiBmYWxzZVxufTtcblxuLyoqXG4gKiBWYWxpZGF0ZSB0aGUgZmxhZ3MgcGFydCBvZiBhIGdpdmVuIFJlZ0V4cExpdGVyYWwuXG4gKlxuICogQHBhcmFtIHtSZWdFeHBWYWxpZGF0aW9uU3RhdGV9IHN0YXRlIFRoZSBzdGF0ZSB0byB2YWxpZGF0ZSBSZWdFeHAuXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xucHAkMS52YWxpZGF0ZVJlZ0V4cEZsYWdzID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgdmFyIHZhbGlkRmxhZ3MgPSBzdGF0ZS52YWxpZEZsYWdzO1xuICB2YXIgZmxhZ3MgPSBzdGF0ZS5mbGFncztcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGZsYWdzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGZsYWcgPSBmbGFncy5jaGFyQXQoaSk7XG4gICAgaWYgKHZhbGlkRmxhZ3MuaW5kZXhPZihmbGFnKSA9PT0gLTEpIHtcbiAgICAgIHRoaXMucmFpc2Uoc3RhdGUuc3RhcnQsIFwiSW52YWxpZCByZWd1bGFyIGV4cHJlc3Npb24gZmxhZ1wiKTtcbiAgICB9XG4gICAgaWYgKGZsYWdzLmluZGV4T2YoZmxhZywgaSArIDEpID4gLTEpIHtcbiAgICAgIHRoaXMucmFpc2Uoc3RhdGUuc3RhcnQsIFwiRHVwbGljYXRlIHJlZ3VsYXIgZXhwcmVzc2lvbiBmbGFnXCIpO1xuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBWYWxpZGF0ZSB0aGUgcGF0dGVybiBwYXJ0IG9mIGEgZ2l2ZW4gUmVnRXhwTGl0ZXJhbC5cbiAqXG4gKiBAcGFyYW0ge1JlZ0V4cFZhbGlkYXRpb25TdGF0ZX0gc3RhdGUgVGhlIHN0YXRlIHRvIHZhbGlkYXRlIFJlZ0V4cC5cbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5wcCQxLnZhbGlkYXRlUmVnRXhwUGF0dGVybiA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHRoaXMucmVnZXhwX3BhdHRlcm4oc3RhdGUpO1xuXG4gIC8vIFRoZSBnb2FsIHN5bWJvbCBmb3IgdGhlIHBhcnNlIGlzIHxQYXR0ZXJuW35VLCB+Tl18LiBJZiB0aGUgcmVzdWx0IG9mXG4gIC8vIHBhcnNpbmcgY29udGFpbnMgYSB8R3JvdXBOYW1lfCwgcmVwYXJzZSB3aXRoIHRoZSBnb2FsIHN5bWJvbFxuICAvLyB8UGF0dGVyblt+VSwgK05dfCBhbmQgdXNlIHRoaXMgcmVzdWx0IGluc3RlYWQuIFRocm93IGEgKlN5bnRheEVycm9yKlxuICAvLyBleGNlcHRpb24gaWYgX1BfIGRpZCBub3QgY29uZm9ybSB0byB0aGUgZ3JhbW1hciwgaWYgYW55IGVsZW1lbnRzIG9mIF9QX1xuICAvLyB3ZXJlIG5vdCBtYXRjaGVkIGJ5IHRoZSBwYXJzZSwgb3IgaWYgYW55IEVhcmx5IEVycm9yIGNvbmRpdGlvbnMgZXhpc3QuXG4gIGlmICghc3RhdGUuc3dpdGNoTiAmJiB0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gOSAmJiBzdGF0ZS5ncm91cE5hbWVzLmxlbmd0aCA+IDApIHtcbiAgICBzdGF0ZS5zd2l0Y2hOID0gdHJ1ZTtcbiAgICB0aGlzLnJlZ2V4cF9wYXR0ZXJuKHN0YXRlKTtcbiAgfVxufTtcblxuLy8gaHR0cHM6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi84LjAvI3Byb2QtUGF0dGVyblxucHAkMS5yZWdleHBfcGF0dGVybiA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHN0YXRlLnBvcyA9IDA7XG4gIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IDA7XG4gIHN0YXRlLmxhc3RTdHJpbmdWYWx1ZSA9IFwiXCI7XG4gIHN0YXRlLmxhc3RBc3NlcnRpb25Jc1F1YW50aWZpYWJsZSA9IGZhbHNlO1xuICBzdGF0ZS5udW1DYXB0dXJpbmdQYXJlbnMgPSAwO1xuICBzdGF0ZS5tYXhCYWNrUmVmZXJlbmNlID0gMDtcbiAgc3RhdGUuZ3JvdXBOYW1lcy5sZW5ndGggPSAwO1xuICBzdGF0ZS5iYWNrUmVmZXJlbmNlTmFtZXMubGVuZ3RoID0gMDtcblxuICB0aGlzLnJlZ2V4cF9kaXNqdW5jdGlvbihzdGF0ZSk7XG5cbiAgaWYgKHN0YXRlLnBvcyAhPT0gc3RhdGUuc291cmNlLmxlbmd0aCkge1xuICAgIC8vIE1ha2UgdGhlIHNhbWUgbWVzc2FnZXMgYXMgVjguXG4gICAgaWYgKHN0YXRlLmVhdCgweDI5IC8qICkgKi8pKSB7XG4gICAgICBzdGF0ZS5yYWlzZShcIlVubWF0Y2hlZCAnKSdcIik7XG4gICAgfVxuICAgIGlmIChzdGF0ZS5lYXQoMHg1RCAvKiBdICovKSB8fCBzdGF0ZS5lYXQoMHg3RCAvKiB9ICovKSkge1xuICAgICAgc3RhdGUucmFpc2UoXCJMb25lIHF1YW50aWZpZXIgYnJhY2tldHNcIik7XG4gICAgfVxuICB9XG4gIGlmIChzdGF0ZS5tYXhCYWNrUmVmZXJlbmNlID4gc3RhdGUubnVtQ2FwdHVyaW5nUGFyZW5zKSB7XG4gICAgc3RhdGUucmFpc2UoXCJJbnZhbGlkIGVzY2FwZVwiKTtcbiAgfVxuICBmb3IgKHZhciBpID0gMCwgbGlzdCA9IHN0YXRlLmJhY2tSZWZlcmVuY2VOYW1lczsgaSA8IGxpc3QubGVuZ3RoOyBpICs9IDEpIHtcbiAgICB2YXIgbmFtZSA9IGxpc3RbaV07XG5cbiAgICBpZiAoc3RhdGUuZ3JvdXBOYW1lcy5pbmRleE9mKG5hbWUpID09PSAtMSkge1xuICAgICAgc3RhdGUucmFpc2UoXCJJbnZhbGlkIG5hbWVkIGNhcHR1cmUgcmVmZXJlbmNlZFwiKTtcbiAgICB9XG4gIH1cbn07XG5cbi8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLURpc2p1bmN0aW9uXG5wcCQxLnJlZ2V4cF9kaXNqdW5jdGlvbiA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHRoaXMucmVnZXhwX2FsdGVybmF0aXZlKHN0YXRlKTtcbiAgd2hpbGUgKHN0YXRlLmVhdCgweDdDIC8qIHwgKi8pKSB7XG4gICAgdGhpcy5yZWdleHBfYWx0ZXJuYXRpdmUoc3RhdGUpO1xuICB9XG5cbiAgLy8gTWFrZSB0aGUgc2FtZSBtZXNzYWdlIGFzIFY4LlxuICBpZiAodGhpcy5yZWdleHBfZWF0UXVhbnRpZmllcihzdGF0ZSwgdHJ1ZSkpIHtcbiAgICBzdGF0ZS5yYWlzZShcIk5vdGhpbmcgdG8gcmVwZWF0XCIpO1xuICB9XG4gIGlmIChzdGF0ZS5lYXQoMHg3QiAvKiB7ICovKSkge1xuICAgIHN0YXRlLnJhaXNlKFwiTG9uZSBxdWFudGlmaWVyIGJyYWNrZXRzXCIpO1xuICB9XG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1BbHRlcm5hdGl2ZVxucHAkMS5yZWdleHBfYWx0ZXJuYXRpdmUgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB3aGlsZSAoc3RhdGUucG9zIDwgc3RhdGUuc291cmNlLmxlbmd0aCAmJiB0aGlzLnJlZ2V4cF9lYXRUZXJtKHN0YXRlKSlcbiAgICB7IH1cbn07XG5cbi8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLWFubmV4Qi1UZXJtXG5wcCQxLnJlZ2V4cF9lYXRUZXJtID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgaWYgKHRoaXMucmVnZXhwX2VhdEFzc2VydGlvbihzdGF0ZSkpIHtcbiAgICAvLyBIYW5kbGUgYFF1YW50aWZpYWJsZUFzc2VydGlvbiBRdWFudGlmaWVyYCBhbHRlcm5hdGl2ZS5cbiAgICAvLyBgc3RhdGUubGFzdEFzc2VydGlvbklzUXVhbnRpZmlhYmxlYCBpcyB0cnVlIGlmIHRoZSBsYXN0IGVhdGVuIEFzc2VydGlvblxuICAgIC8vIGlzIGEgUXVhbnRpZmlhYmxlQXNzZXJ0aW9uLlxuICAgIGlmIChzdGF0ZS5sYXN0QXNzZXJ0aW9uSXNRdWFudGlmaWFibGUgJiYgdGhpcy5yZWdleHBfZWF0UXVhbnRpZmllcihzdGF0ZSkpIHtcbiAgICAgIC8vIE1ha2UgdGhlIHNhbWUgbWVzc2FnZSBhcyBWOC5cbiAgICAgIGlmIChzdGF0ZS5zd2l0Y2hVKSB7XG4gICAgICAgIHN0YXRlLnJhaXNlKFwiSW52YWxpZCBxdWFudGlmaWVyXCIpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgaWYgKHN0YXRlLnN3aXRjaFUgPyB0aGlzLnJlZ2V4cF9lYXRBdG9tKHN0YXRlKSA6IHRoaXMucmVnZXhwX2VhdEV4dGVuZGVkQXRvbShzdGF0ZSkpIHtcbiAgICB0aGlzLnJlZ2V4cF9lYXRRdWFudGlmaWVyKHN0YXRlKTtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1hbm5leEItQXNzZXJ0aW9uXG5wcCQxLnJlZ2V4cF9lYXRBc3NlcnRpb24gPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgc3RhcnQgPSBzdGF0ZS5wb3M7XG4gIHN0YXRlLmxhc3RBc3NlcnRpb25Jc1F1YW50aWZpYWJsZSA9IGZhbHNlO1xuXG4gIC8vIF4sICRcbiAgaWYgKHN0YXRlLmVhdCgweDVFIC8qIF4gKi8pIHx8IHN0YXRlLmVhdCgweDI0IC8qICQgKi8pKSB7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIC8vIFxcYiBcXEJcbiAgaWYgKHN0YXRlLmVhdCgweDVDIC8qIFxcICovKSkge1xuICAgIGlmIChzdGF0ZS5lYXQoMHg0MiAvKiBCICovKSB8fCBzdGF0ZS5lYXQoMHg2MiAvKiBiICovKSkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgc3RhdGUucG9zID0gc3RhcnQ7XG4gIH1cblxuICAvLyBMb29rYWhlYWQgLyBMb29rYmVoaW5kXG4gIGlmIChzdGF0ZS5lYXQoMHgyOCAvKiAoICovKSAmJiBzdGF0ZS5lYXQoMHgzRiAvKiA/ICovKSkge1xuICAgIHZhciBsb29rYmVoaW5kID0gZmFsc2U7XG4gICAgaWYgKHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA5KSB7XG4gICAgICBsb29rYmVoaW5kID0gc3RhdGUuZWF0KDB4M0MgLyogPCAqLyk7XG4gICAgfVxuICAgIGlmIChzdGF0ZS5lYXQoMHgzRCAvKiA9ICovKSB8fCBzdGF0ZS5lYXQoMHgyMSAvKiAhICovKSkge1xuICAgICAgdGhpcy5yZWdleHBfZGlzanVuY3Rpb24oc3RhdGUpO1xuICAgICAgaWYgKCFzdGF0ZS5lYXQoMHgyOSAvKiApICovKSkge1xuICAgICAgICBzdGF0ZS5yYWlzZShcIlVudGVybWluYXRlZCBncm91cFwiKTtcbiAgICAgIH1cbiAgICAgIHN0YXRlLmxhc3RBc3NlcnRpb25Jc1F1YW50aWZpYWJsZSA9ICFsb29rYmVoaW5kO1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gIH1cblxuICBzdGF0ZS5wb3MgPSBzdGFydDtcbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1RdWFudGlmaWVyXG5wcCQxLnJlZ2V4cF9lYXRRdWFudGlmaWVyID0gZnVuY3Rpb24oc3RhdGUsIG5vRXJyb3IpIHtcbiAgaWYgKCBub0Vycm9yID09PSB2b2lkIDAgKSBub0Vycm9yID0gZmFsc2U7XG5cbiAgaWYgKHRoaXMucmVnZXhwX2VhdFF1YW50aWZpZXJQcmVmaXgoc3RhdGUsIG5vRXJyb3IpKSB7XG4gICAgc3RhdGUuZWF0KDB4M0YgLyogPyAqLyk7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5cbi8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLVF1YW50aWZpZXJQcmVmaXhcbnBwJDEucmVnZXhwX2VhdFF1YW50aWZpZXJQcmVmaXggPSBmdW5jdGlvbihzdGF0ZSwgbm9FcnJvcikge1xuICByZXR1cm4gKFxuICAgIHN0YXRlLmVhdCgweDJBIC8qICogKi8pIHx8XG4gICAgc3RhdGUuZWF0KDB4MkIgLyogKyAqLykgfHxcbiAgICBzdGF0ZS5lYXQoMHgzRiAvKiA/ICovKSB8fFxuICAgIHRoaXMucmVnZXhwX2VhdEJyYWNlZFF1YW50aWZpZXIoc3RhdGUsIG5vRXJyb3IpXG4gIClcbn07XG5wcCQxLnJlZ2V4cF9lYXRCcmFjZWRRdWFudGlmaWVyID0gZnVuY3Rpb24oc3RhdGUsIG5vRXJyb3IpIHtcbiAgdmFyIHN0YXJ0ID0gc3RhdGUucG9zO1xuICBpZiAoc3RhdGUuZWF0KDB4N0IgLyogeyAqLykpIHtcbiAgICB2YXIgbWluID0gMCwgbWF4ID0gLTE7XG4gICAgaWYgKHRoaXMucmVnZXhwX2VhdERlY2ltYWxEaWdpdHMoc3RhdGUpKSB7XG4gICAgICBtaW4gPSBzdGF0ZS5sYXN0SW50VmFsdWU7XG4gICAgICBpZiAoc3RhdGUuZWF0KDB4MkMgLyogLCAqLykgJiYgdGhpcy5yZWdleHBfZWF0RGVjaW1hbERpZ2l0cyhzdGF0ZSkpIHtcbiAgICAgICAgbWF4ID0gc3RhdGUubGFzdEludFZhbHVlO1xuICAgICAgfVxuICAgICAgaWYgKHN0YXRlLmVhdCgweDdEIC8qIH0gKi8pKSB7XG4gICAgICAgIC8vIFN5bnRheEVycm9yIGluIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNzZWMtdGVybVxuICAgICAgICBpZiAobWF4ICE9PSAtMSAmJiBtYXggPCBtaW4gJiYgIW5vRXJyb3IpIHtcbiAgICAgICAgICBzdGF0ZS5yYWlzZShcIm51bWJlcnMgb3V0IG9mIG9yZGVyIGluIHt9IHF1YW50aWZpZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHN0YXRlLnN3aXRjaFUgJiYgIW5vRXJyb3IpIHtcbiAgICAgIHN0YXRlLnJhaXNlKFwiSW5jb21wbGV0ZSBxdWFudGlmaWVyXCIpO1xuICAgIH1cbiAgICBzdGF0ZS5wb3MgPSBzdGFydDtcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5cbi8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLUF0b21cbnBwJDEucmVnZXhwX2VhdEF0b20gPSBmdW5jdGlvbihzdGF0ZSkge1xuICByZXR1cm4gKFxuICAgIHRoaXMucmVnZXhwX2VhdFBhdHRlcm5DaGFyYWN0ZXJzKHN0YXRlKSB8fFxuICAgIHN0YXRlLmVhdCgweDJFIC8qIC4gKi8pIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0UmV2ZXJzZVNvbGlkdXNBdG9tRXNjYXBlKHN0YXRlKSB8fFxuICAgIHRoaXMucmVnZXhwX2VhdENoYXJhY3RlckNsYXNzKHN0YXRlKSB8fFxuICAgIHRoaXMucmVnZXhwX2VhdFVuY2FwdHVyaW5nR3JvdXAoc3RhdGUpIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0Q2FwdHVyaW5nR3JvdXAoc3RhdGUpXG4gIClcbn07XG5wcCQxLnJlZ2V4cF9lYXRSZXZlcnNlU29saWR1c0F0b21Fc2NhcGUgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgc3RhcnQgPSBzdGF0ZS5wb3M7XG4gIGlmIChzdGF0ZS5lYXQoMHg1QyAvKiBcXCAqLykpIHtcbiAgICBpZiAodGhpcy5yZWdleHBfZWF0QXRvbUVzY2FwZShzdGF0ZSkpIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIHN0YXRlLnBvcyA9IHN0YXJ0O1xuICB9XG4gIHJldHVybiBmYWxzZVxufTtcbnBwJDEucmVnZXhwX2VhdFVuY2FwdHVyaW5nR3JvdXAgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgc3RhcnQgPSBzdGF0ZS5wb3M7XG4gIGlmIChzdGF0ZS5lYXQoMHgyOCAvKiAoICovKSkge1xuICAgIGlmIChzdGF0ZS5lYXQoMHgzRiAvKiA/ICovKSAmJiBzdGF0ZS5lYXQoMHgzQSAvKiA6ICovKSkge1xuICAgICAgdGhpcy5yZWdleHBfZGlzanVuY3Rpb24oc3RhdGUpO1xuICAgICAgaWYgKHN0YXRlLmVhdCgweDI5IC8qICkgKi8pKSB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9XG4gICAgICBzdGF0ZS5yYWlzZShcIlVudGVybWluYXRlZCBncm91cFwiKTtcbiAgICB9XG4gICAgc3RhdGUucG9zID0gc3RhcnQ7XG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59O1xucHAkMS5yZWdleHBfZWF0Q2FwdHVyaW5nR3JvdXAgPSBmdW5jdGlvbihzdGF0ZSkge1xuICBpZiAoc3RhdGUuZWF0KDB4MjggLyogKCAqLykpIHtcbiAgICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDkpIHtcbiAgICAgIHRoaXMucmVnZXhwX2dyb3VwU3BlY2lmaWVyKHN0YXRlKTtcbiAgICB9IGVsc2UgaWYgKHN0YXRlLmN1cnJlbnQoKSA9PT0gMHgzRiAvKiA/ICovKSB7XG4gICAgICBzdGF0ZS5yYWlzZShcIkludmFsaWQgZ3JvdXBcIik7XG4gICAgfVxuICAgIHRoaXMucmVnZXhwX2Rpc2p1bmN0aW9uKHN0YXRlKTtcbiAgICBpZiAoc3RhdGUuZWF0KDB4MjkgLyogKSAqLykpIHtcbiAgICAgIHN0YXRlLm51bUNhcHR1cmluZ1BhcmVucyArPSAxO1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgc3RhdGUucmFpc2UoXCJVbnRlcm1pbmF0ZWQgZ3JvdXBcIik7XG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1hbm5leEItRXh0ZW5kZWRBdG9tXG5wcCQxLnJlZ2V4cF9lYXRFeHRlbmRlZEF0b20gPSBmdW5jdGlvbihzdGF0ZSkge1xuICByZXR1cm4gKFxuICAgIHN0YXRlLmVhdCgweDJFIC8qIC4gKi8pIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0UmV2ZXJzZVNvbGlkdXNBdG9tRXNjYXBlKHN0YXRlKSB8fFxuICAgIHRoaXMucmVnZXhwX2VhdENoYXJhY3RlckNsYXNzKHN0YXRlKSB8fFxuICAgIHRoaXMucmVnZXhwX2VhdFVuY2FwdHVyaW5nR3JvdXAoc3RhdGUpIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0Q2FwdHVyaW5nR3JvdXAoc3RhdGUpIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0SW52YWxpZEJyYWNlZFF1YW50aWZpZXIoc3RhdGUpIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0RXh0ZW5kZWRQYXR0ZXJuQ2hhcmFjdGVyKHN0YXRlKVxuICApXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1hbm5leEItSW52YWxpZEJyYWNlZFF1YW50aWZpZXJcbnBwJDEucmVnZXhwX2VhdEludmFsaWRCcmFjZWRRdWFudGlmaWVyID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgaWYgKHRoaXMucmVnZXhwX2VhdEJyYWNlZFF1YW50aWZpZXIoc3RhdGUsIHRydWUpKSB7XG4gICAgc3RhdGUucmFpc2UoXCJOb3RoaW5nIHRvIHJlcGVhdFwiKTtcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5cbi8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLVN5bnRheENoYXJhY3RlclxucHAkMS5yZWdleHBfZWF0U3ludGF4Q2hhcmFjdGVyID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgdmFyIGNoID0gc3RhdGUuY3VycmVudCgpO1xuICBpZiAoaXNTeW50YXhDaGFyYWN0ZXIoY2gpKSB7XG4gICAgc3RhdGUubGFzdEludFZhbHVlID0gY2g7XG4gICAgc3RhdGUuYWR2YW5jZSgpO1xuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59O1xuZnVuY3Rpb24gaXNTeW50YXhDaGFyYWN0ZXIoY2gpIHtcbiAgcmV0dXJuIChcbiAgICBjaCA9PT0gMHgyNCAvKiAkICovIHx8XG4gICAgY2ggPj0gMHgyOCAvKiAoICovICYmIGNoIDw9IDB4MkIgLyogKyAqLyB8fFxuICAgIGNoID09PSAweDJFIC8qIC4gKi8gfHxcbiAgICBjaCA9PT0gMHgzRiAvKiA/ICovIHx8XG4gICAgY2ggPj0gMHg1QiAvKiBbICovICYmIGNoIDw9IDB4NUUgLyogXiAqLyB8fFxuICAgIGNoID49IDB4N0IgLyogeyAqLyAmJiBjaCA8PSAweDdEIC8qIH0gKi9cbiAgKVxufVxuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1QYXR0ZXJuQ2hhcmFjdGVyXG4vLyBCdXQgZWF0IGVhZ2VyLlxucHAkMS5yZWdleHBfZWF0UGF0dGVybkNoYXJhY3RlcnMgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgc3RhcnQgPSBzdGF0ZS5wb3M7XG4gIHZhciBjaCA9IDA7XG4gIHdoaWxlICgoY2ggPSBzdGF0ZS5jdXJyZW50KCkpICE9PSAtMSAmJiAhaXNTeW50YXhDaGFyYWN0ZXIoY2gpKSB7XG4gICAgc3RhdGUuYWR2YW5jZSgpO1xuICB9XG4gIHJldHVybiBzdGF0ZS5wb3MgIT09IHN0YXJ0XG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1hbm5leEItRXh0ZW5kZWRQYXR0ZXJuQ2hhcmFjdGVyXG5wcCQxLnJlZ2V4cF9lYXRFeHRlbmRlZFBhdHRlcm5DaGFyYWN0ZXIgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgY2ggPSBzdGF0ZS5jdXJyZW50KCk7XG4gIGlmIChcbiAgICBjaCAhPT0gLTEgJiZcbiAgICBjaCAhPT0gMHgyNCAvKiAkICovICYmXG4gICAgIShjaCA+PSAweDI4IC8qICggKi8gJiYgY2ggPD0gMHgyQiAvKiArICovKSAmJlxuICAgIGNoICE9PSAweDJFIC8qIC4gKi8gJiZcbiAgICBjaCAhPT0gMHgzRiAvKiA/ICovICYmXG4gICAgY2ggIT09IDB4NUIgLyogWyAqLyAmJlxuICAgIGNoICE9PSAweDVFIC8qIF4gKi8gJiZcbiAgICBjaCAhPT0gMHg3QyAvKiB8ICovXG4gICkge1xuICAgIHN0YXRlLmFkdmFuY2UoKTtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIHJldHVybiBmYWxzZVxufTtcblxuLy8gR3JvdXBTcGVjaWZpZXIgOjpcbi8vICAgW2VtcHR5XVxuLy8gICBgP2AgR3JvdXBOYW1lXG5wcCQxLnJlZ2V4cF9ncm91cFNwZWNpZmllciA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIGlmIChzdGF0ZS5lYXQoMHgzRiAvKiA/ICovKSkge1xuICAgIGlmICh0aGlzLnJlZ2V4cF9lYXRHcm91cE5hbWUoc3RhdGUpKSB7XG4gICAgICBpZiAoc3RhdGUuZ3JvdXBOYW1lcy5pbmRleE9mKHN0YXRlLmxhc3RTdHJpbmdWYWx1ZSkgIT09IC0xKSB7XG4gICAgICAgIHN0YXRlLnJhaXNlKFwiRHVwbGljYXRlIGNhcHR1cmUgZ3JvdXAgbmFtZVwiKTtcbiAgICAgIH1cbiAgICAgIHN0YXRlLmdyb3VwTmFtZXMucHVzaChzdGF0ZS5sYXN0U3RyaW5nVmFsdWUpO1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHN0YXRlLnJhaXNlKFwiSW52YWxpZCBncm91cFwiKTtcbiAgfVxufTtcblxuLy8gR3JvdXBOYW1lIDo6XG4vLyAgIGA8YCBSZWdFeHBJZGVudGlmaWVyTmFtZSBgPmBcbi8vIE5vdGU6IHRoaXMgdXBkYXRlcyBgc3RhdGUubGFzdFN0cmluZ1ZhbHVlYCBwcm9wZXJ0eSB3aXRoIHRoZSBlYXRlbiBuYW1lLlxucHAkMS5yZWdleHBfZWF0R3JvdXBOYW1lID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgc3RhdGUubGFzdFN0cmluZ1ZhbHVlID0gXCJcIjtcbiAgaWYgKHN0YXRlLmVhdCgweDNDIC8qIDwgKi8pKSB7XG4gICAgaWYgKHRoaXMucmVnZXhwX2VhdFJlZ0V4cElkZW50aWZpZXJOYW1lKHN0YXRlKSAmJiBzdGF0ZS5lYXQoMHgzRSAvKiA+ICovKSkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgc3RhdGUucmFpc2UoXCJJbnZhbGlkIGNhcHR1cmUgZ3JvdXAgbmFtZVwiKTtcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5cbi8vIFJlZ0V4cElkZW50aWZpZXJOYW1lIDo6XG4vLyAgIFJlZ0V4cElkZW50aWZpZXJTdGFydFxuLy8gICBSZWdFeHBJZGVudGlmaWVyTmFtZSBSZWdFeHBJZGVudGlmaWVyUGFydFxuLy8gTm90ZTogdGhpcyB1cGRhdGVzIGBzdGF0ZS5sYXN0U3RyaW5nVmFsdWVgIHByb3BlcnR5IHdpdGggdGhlIGVhdGVuIG5hbWUuXG5wcCQxLnJlZ2V4cF9lYXRSZWdFeHBJZGVudGlmaWVyTmFtZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHN0YXRlLmxhc3RTdHJpbmdWYWx1ZSA9IFwiXCI7XG4gIGlmICh0aGlzLnJlZ2V4cF9lYXRSZWdFeHBJZGVudGlmaWVyU3RhcnQoc3RhdGUpKSB7XG4gICAgc3RhdGUubGFzdFN0cmluZ1ZhbHVlICs9IGNvZGVQb2ludFRvU3RyaW5nKHN0YXRlLmxhc3RJbnRWYWx1ZSk7XG4gICAgd2hpbGUgKHRoaXMucmVnZXhwX2VhdFJlZ0V4cElkZW50aWZpZXJQYXJ0KHN0YXRlKSkge1xuICAgICAgc3RhdGUubGFzdFN0cmluZ1ZhbHVlICs9IGNvZGVQb2ludFRvU3RyaW5nKHN0YXRlLmxhc3RJbnRWYWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBSZWdFeHBJZGVudGlmaWVyU3RhcnQgOjpcbi8vICAgVW5pY29kZUlEU3RhcnRcbi8vICAgYCRgXG4vLyAgIGBfYFxuLy8gICBgXFxgIFJlZ0V4cFVuaWNvZGVFc2NhcGVTZXF1ZW5jZVsrVV1cbnBwJDEucmVnZXhwX2VhdFJlZ0V4cElkZW50aWZpZXJTdGFydCA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHZhciBzdGFydCA9IHN0YXRlLnBvcztcbiAgdmFyIGZvcmNlVSA9IHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSAxMTtcbiAgdmFyIGNoID0gc3RhdGUuY3VycmVudChmb3JjZVUpO1xuICBzdGF0ZS5hZHZhbmNlKGZvcmNlVSk7XG5cbiAgaWYgKGNoID09PSAweDVDIC8qIFxcICovICYmIHRoaXMucmVnZXhwX2VhdFJlZ0V4cFVuaWNvZGVFc2NhcGVTZXF1ZW5jZShzdGF0ZSwgZm9yY2VVKSkge1xuICAgIGNoID0gc3RhdGUubGFzdEludFZhbHVlO1xuICB9XG4gIGlmIChpc1JlZ0V4cElkZW50aWZpZXJTdGFydChjaCkpIHtcbiAgICBzdGF0ZS5sYXN0SW50VmFsdWUgPSBjaDtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgc3RhdGUucG9zID0gc3RhcnQ7XG4gIHJldHVybiBmYWxzZVxufTtcbmZ1bmN0aW9uIGlzUmVnRXhwSWRlbnRpZmllclN0YXJ0KGNoKSB7XG4gIHJldHVybiBpc0lkZW50aWZpZXJTdGFydChjaCwgdHJ1ZSkgfHwgY2ggPT09IDB4MjQgLyogJCAqLyB8fCBjaCA9PT0gMHg1RiAvKiBfICovXG59XG5cbi8vIFJlZ0V4cElkZW50aWZpZXJQYXJ0IDo6XG4vLyAgIFVuaWNvZGVJRENvbnRpbnVlXG4vLyAgIGAkYFxuLy8gICBgX2Bcbi8vICAgYFxcYCBSZWdFeHBVbmljb2RlRXNjYXBlU2VxdWVuY2VbK1VdXG4vLyAgIDxaV05KPlxuLy8gICA8WldKPlxucHAkMS5yZWdleHBfZWF0UmVnRXhwSWRlbnRpZmllclBhcnQgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgc3RhcnQgPSBzdGF0ZS5wb3M7XG4gIHZhciBmb3JjZVUgPSB0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gMTE7XG4gIHZhciBjaCA9IHN0YXRlLmN1cnJlbnQoZm9yY2VVKTtcbiAgc3RhdGUuYWR2YW5jZShmb3JjZVUpO1xuXG4gIGlmIChjaCA9PT0gMHg1QyAvKiBcXCAqLyAmJiB0aGlzLnJlZ2V4cF9lYXRSZWdFeHBVbmljb2RlRXNjYXBlU2VxdWVuY2Uoc3RhdGUsIGZvcmNlVSkpIHtcbiAgICBjaCA9IHN0YXRlLmxhc3RJbnRWYWx1ZTtcbiAgfVxuICBpZiAoaXNSZWdFeHBJZGVudGlmaWVyUGFydChjaCkpIHtcbiAgICBzdGF0ZS5sYXN0SW50VmFsdWUgPSBjaDtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgc3RhdGUucG9zID0gc3RhcnQ7XG4gIHJldHVybiBmYWxzZVxufTtcbmZ1bmN0aW9uIGlzUmVnRXhwSWRlbnRpZmllclBhcnQoY2gpIHtcbiAgcmV0dXJuIGlzSWRlbnRpZmllckNoYXIoY2gsIHRydWUpIHx8IGNoID09PSAweDI0IC8qICQgKi8gfHwgY2ggPT09IDB4NUYgLyogXyAqLyB8fCBjaCA9PT0gMHgyMDBDIC8qIDxaV05KPiAqLyB8fCBjaCA9PT0gMHgyMDBEIC8qIDxaV0o+ICovXG59XG5cbi8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLWFubmV4Qi1BdG9tRXNjYXBlXG5wcCQxLnJlZ2V4cF9lYXRBdG9tRXNjYXBlID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgaWYgKFxuICAgIHRoaXMucmVnZXhwX2VhdEJhY2tSZWZlcmVuY2Uoc3RhdGUpIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0Q2hhcmFjdGVyQ2xhc3NFc2NhcGUoc3RhdGUpIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0Q2hhcmFjdGVyRXNjYXBlKHN0YXRlKSB8fFxuICAgIChzdGF0ZS5zd2l0Y2hOICYmIHRoaXMucmVnZXhwX2VhdEtHcm91cE5hbWUoc3RhdGUpKVxuICApIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIGlmIChzdGF0ZS5zd2l0Y2hVKSB7XG4gICAgLy8gTWFrZSB0aGUgc2FtZSBtZXNzYWdlIGFzIFY4LlxuICAgIGlmIChzdGF0ZS5jdXJyZW50KCkgPT09IDB4NjMgLyogYyAqLykge1xuICAgICAgc3RhdGUucmFpc2UoXCJJbnZhbGlkIHVuaWNvZGUgZXNjYXBlXCIpO1xuICAgIH1cbiAgICBzdGF0ZS5yYWlzZShcIkludmFsaWQgZXNjYXBlXCIpO1xuICB9XG4gIHJldHVybiBmYWxzZVxufTtcbnBwJDEucmVnZXhwX2VhdEJhY2tSZWZlcmVuY2UgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgc3RhcnQgPSBzdGF0ZS5wb3M7XG4gIGlmICh0aGlzLnJlZ2V4cF9lYXREZWNpbWFsRXNjYXBlKHN0YXRlKSkge1xuICAgIHZhciBuID0gc3RhdGUubGFzdEludFZhbHVlO1xuICAgIGlmIChzdGF0ZS5zd2l0Y2hVKSB7XG4gICAgICAvLyBGb3IgU3ludGF4RXJyb3IgaW4gaHR0cHM6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi84LjAvI3NlYy1hdG9tZXNjYXBlXG4gICAgICBpZiAobiA+IHN0YXRlLm1heEJhY2tSZWZlcmVuY2UpIHtcbiAgICAgICAgc3RhdGUubWF4QmFja1JlZmVyZW5jZSA9IG47XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICBpZiAobiA8PSBzdGF0ZS5udW1DYXB0dXJpbmdQYXJlbnMpIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIHN0YXRlLnBvcyA9IHN0YXJ0O1xuICB9XG4gIHJldHVybiBmYWxzZVxufTtcbnBwJDEucmVnZXhwX2VhdEtHcm91cE5hbWUgPSBmdW5jdGlvbihzdGF0ZSkge1xuICBpZiAoc3RhdGUuZWF0KDB4NkIgLyogayAqLykpIHtcbiAgICBpZiAodGhpcy5yZWdleHBfZWF0R3JvdXBOYW1lKHN0YXRlKSkge1xuICAgICAgc3RhdGUuYmFja1JlZmVyZW5jZU5hbWVzLnB1c2goc3RhdGUubGFzdFN0cmluZ1ZhbHVlKTtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIHN0YXRlLnJhaXNlKFwiSW52YWxpZCBuYW1lZCByZWZlcmVuY2VcIik7XG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1hbm5leEItQ2hhcmFjdGVyRXNjYXBlXG5wcCQxLnJlZ2V4cF9lYXRDaGFyYWN0ZXJFc2NhcGUgPSBmdW5jdGlvbihzdGF0ZSkge1xuICByZXR1cm4gKFxuICAgIHRoaXMucmVnZXhwX2VhdENvbnRyb2xFc2NhcGUoc3RhdGUpIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0Q0NvbnRyb2xMZXR0ZXIoc3RhdGUpIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0WmVybyhzdGF0ZSkgfHxcbiAgICB0aGlzLnJlZ2V4cF9lYXRIZXhFc2NhcGVTZXF1ZW5jZShzdGF0ZSkgfHxcbiAgICB0aGlzLnJlZ2V4cF9lYXRSZWdFeHBVbmljb2RlRXNjYXBlU2VxdWVuY2Uoc3RhdGUsIGZhbHNlKSB8fFxuICAgICghc3RhdGUuc3dpdGNoVSAmJiB0aGlzLnJlZ2V4cF9lYXRMZWdhY3lPY3RhbEVzY2FwZVNlcXVlbmNlKHN0YXRlKSkgfHxcbiAgICB0aGlzLnJlZ2V4cF9lYXRJZGVudGl0eUVzY2FwZShzdGF0ZSlcbiAgKVxufTtcbnBwJDEucmVnZXhwX2VhdENDb250cm9sTGV0dGVyID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgdmFyIHN0YXJ0ID0gc3RhdGUucG9zO1xuICBpZiAoc3RhdGUuZWF0KDB4NjMgLyogYyAqLykpIHtcbiAgICBpZiAodGhpcy5yZWdleHBfZWF0Q29udHJvbExldHRlcihzdGF0ZSkpIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIHN0YXRlLnBvcyA9IHN0YXJ0O1xuICB9XG4gIHJldHVybiBmYWxzZVxufTtcbnBwJDEucmVnZXhwX2VhdFplcm8gPSBmdW5jdGlvbihzdGF0ZSkge1xuICBpZiAoc3RhdGUuY3VycmVudCgpID09PSAweDMwIC8qIDAgKi8gJiYgIWlzRGVjaW1hbERpZ2l0KHN0YXRlLmxvb2thaGVhZCgpKSkge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IDA7XG4gICAgc3RhdGUuYWR2YW5jZSgpO1xuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1Db250cm9sRXNjYXBlXG5wcCQxLnJlZ2V4cF9lYXRDb250cm9sRXNjYXBlID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgdmFyIGNoID0gc3RhdGUuY3VycmVudCgpO1xuICBpZiAoY2ggPT09IDB4NzQgLyogdCAqLykge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IDB4MDk7IC8qIFxcdCAqL1xuICAgIHN0YXRlLmFkdmFuY2UoKTtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIGlmIChjaCA9PT0gMHg2RSAvKiBuICovKSB7XG4gICAgc3RhdGUubGFzdEludFZhbHVlID0gMHgwQTsgLyogXFxuICovXG4gICAgc3RhdGUuYWR2YW5jZSgpO1xuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgaWYgKGNoID09PSAweDc2IC8qIHYgKi8pIHtcbiAgICBzdGF0ZS5sYXN0SW50VmFsdWUgPSAweDBCOyAvKiBcXHYgKi9cbiAgICBzdGF0ZS5hZHZhbmNlKCk7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICBpZiAoY2ggPT09IDB4NjYgLyogZiAqLykge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IDB4MEM7IC8qIFxcZiAqL1xuICAgIHN0YXRlLmFkdmFuY2UoKTtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIGlmIChjaCA9PT0gMHg3MiAvKiByICovKSB7XG4gICAgc3RhdGUubGFzdEludFZhbHVlID0gMHgwRDsgLyogXFxyICovXG4gICAgc3RhdGUuYWR2YW5jZSgpO1xuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1Db250cm9sTGV0dGVyXG5wcCQxLnJlZ2V4cF9lYXRDb250cm9sTGV0dGVyID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgdmFyIGNoID0gc3RhdGUuY3VycmVudCgpO1xuICBpZiAoaXNDb250cm9sTGV0dGVyKGNoKSkge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IGNoICUgMHgyMDtcbiAgICBzdGF0ZS5hZHZhbmNlKCk7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5mdW5jdGlvbiBpc0NvbnRyb2xMZXR0ZXIoY2gpIHtcbiAgcmV0dXJuIChcbiAgICAoY2ggPj0gMHg0MSAvKiBBICovICYmIGNoIDw9IDB4NUEgLyogWiAqLykgfHxcbiAgICAoY2ggPj0gMHg2MSAvKiBhICovICYmIGNoIDw9IDB4N0EgLyogeiAqLylcbiAgKVxufVxuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1SZWdFeHBVbmljb2RlRXNjYXBlU2VxdWVuY2VcbnBwJDEucmVnZXhwX2VhdFJlZ0V4cFVuaWNvZGVFc2NhcGVTZXF1ZW5jZSA9IGZ1bmN0aW9uKHN0YXRlLCBmb3JjZVUpIHtcbiAgaWYgKCBmb3JjZVUgPT09IHZvaWQgMCApIGZvcmNlVSA9IGZhbHNlO1xuXG4gIHZhciBzdGFydCA9IHN0YXRlLnBvcztcbiAgdmFyIHN3aXRjaFUgPSBmb3JjZVUgfHwgc3RhdGUuc3dpdGNoVTtcblxuICBpZiAoc3RhdGUuZWF0KDB4NzUgLyogdSAqLykpIHtcbiAgICBpZiAodGhpcy5yZWdleHBfZWF0Rml4ZWRIZXhEaWdpdHMoc3RhdGUsIDQpKSB7XG4gICAgICB2YXIgbGVhZCA9IHN0YXRlLmxhc3RJbnRWYWx1ZTtcbiAgICAgIGlmIChzd2l0Y2hVICYmIGxlYWQgPj0gMHhEODAwICYmIGxlYWQgPD0gMHhEQkZGKSB7XG4gICAgICAgIHZhciBsZWFkU3Vycm9nYXRlRW5kID0gc3RhdGUucG9zO1xuICAgICAgICBpZiAoc3RhdGUuZWF0KDB4NUMgLyogXFwgKi8pICYmIHN0YXRlLmVhdCgweDc1IC8qIHUgKi8pICYmIHRoaXMucmVnZXhwX2VhdEZpeGVkSGV4RGlnaXRzKHN0YXRlLCA0KSkge1xuICAgICAgICAgIHZhciB0cmFpbCA9IHN0YXRlLmxhc3RJbnRWYWx1ZTtcbiAgICAgICAgICBpZiAodHJhaWwgPj0gMHhEQzAwICYmIHRyYWlsIDw9IDB4REZGRikge1xuICAgICAgICAgICAgc3RhdGUubGFzdEludFZhbHVlID0gKGxlYWQgLSAweEQ4MDApICogMHg0MDAgKyAodHJhaWwgLSAweERDMDApICsgMHgxMDAwMDtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN0YXRlLnBvcyA9IGxlYWRTdXJyb2dhdGVFbmQ7XG4gICAgICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IGxlYWQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICBpZiAoXG4gICAgICBzd2l0Y2hVICYmXG4gICAgICBzdGF0ZS5lYXQoMHg3QiAvKiB7ICovKSAmJlxuICAgICAgdGhpcy5yZWdleHBfZWF0SGV4RGlnaXRzKHN0YXRlKSAmJlxuICAgICAgc3RhdGUuZWF0KDB4N0QgLyogfSAqLykgJiZcbiAgICAgIGlzVmFsaWRVbmljb2RlKHN0YXRlLmxhc3RJbnRWYWx1ZSlcbiAgICApIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIGlmIChzd2l0Y2hVKSB7XG4gICAgICBzdGF0ZS5yYWlzZShcIkludmFsaWQgdW5pY29kZSBlc2NhcGVcIik7XG4gICAgfVxuICAgIHN0YXRlLnBvcyA9IHN0YXJ0O1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlXG59O1xuZnVuY3Rpb24gaXNWYWxpZFVuaWNvZGUoY2gpIHtcbiAgcmV0dXJuIGNoID49IDAgJiYgY2ggPD0gMHgxMEZGRkZcbn1cblxuLy8gaHR0cHM6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi84LjAvI3Byb2QtYW5uZXhCLUlkZW50aXR5RXNjYXBlXG5wcCQxLnJlZ2V4cF9lYXRJZGVudGl0eUVzY2FwZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIGlmIChzdGF0ZS5zd2l0Y2hVKSB7XG4gICAgaWYgKHRoaXMucmVnZXhwX2VhdFN5bnRheENoYXJhY3RlcihzdGF0ZSkpIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIGlmIChzdGF0ZS5lYXQoMHgyRiAvKiAvICovKSkge1xuICAgICAgc3RhdGUubGFzdEludFZhbHVlID0gMHgyRjsgLyogLyAqL1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICB2YXIgY2ggPSBzdGF0ZS5jdXJyZW50KCk7XG4gIGlmIChjaCAhPT0gMHg2MyAvKiBjICovICYmICghc3RhdGUuc3dpdGNoTiB8fCBjaCAhPT0gMHg2QiAvKiBrICovKSkge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IGNoO1xuICAgIHN0YXRlLmFkdmFuY2UoKTtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1EZWNpbWFsRXNjYXBlXG5wcCQxLnJlZ2V4cF9lYXREZWNpbWFsRXNjYXBlID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgc3RhdGUubGFzdEludFZhbHVlID0gMDtcbiAgdmFyIGNoID0gc3RhdGUuY3VycmVudCgpO1xuICBpZiAoY2ggPj0gMHgzMSAvKiAxICovICYmIGNoIDw9IDB4MzkgLyogOSAqLykge1xuICAgIGRvIHtcbiAgICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IDEwICogc3RhdGUubGFzdEludFZhbHVlICsgKGNoIC0gMHgzMCAvKiAwICovKTtcbiAgICAgIHN0YXRlLmFkdmFuY2UoKTtcbiAgICB9IHdoaWxlICgoY2ggPSBzdGF0ZS5jdXJyZW50KCkpID49IDB4MzAgLyogMCAqLyAmJiBjaCA8PSAweDM5IC8qIDkgKi8pXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5cbi8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLUNoYXJhY3RlckNsYXNzRXNjYXBlXG5wcCQxLnJlZ2V4cF9lYXRDaGFyYWN0ZXJDbGFzc0VzY2FwZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHZhciBjaCA9IHN0YXRlLmN1cnJlbnQoKTtcblxuICBpZiAoaXNDaGFyYWN0ZXJDbGFzc0VzY2FwZShjaCkpIHtcbiAgICBzdGF0ZS5sYXN0SW50VmFsdWUgPSAtMTtcbiAgICBzdGF0ZS5hZHZhbmNlKCk7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIGlmIChcbiAgICBzdGF0ZS5zd2l0Y2hVICYmXG4gICAgdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDkgJiZcbiAgICAoY2ggPT09IDB4NTAgLyogUCAqLyB8fCBjaCA9PT0gMHg3MCAvKiBwICovKVxuICApIHtcbiAgICBzdGF0ZS5sYXN0SW50VmFsdWUgPSAtMTtcbiAgICBzdGF0ZS5hZHZhbmNlKCk7XG4gICAgaWYgKFxuICAgICAgc3RhdGUuZWF0KDB4N0IgLyogeyAqLykgJiZcbiAgICAgIHRoaXMucmVnZXhwX2VhdFVuaWNvZGVQcm9wZXJ0eVZhbHVlRXhwcmVzc2lvbihzdGF0ZSkgJiZcbiAgICAgIHN0YXRlLmVhdCgweDdEIC8qIH0gKi8pXG4gICAgKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICBzdGF0ZS5yYWlzZShcIkludmFsaWQgcHJvcGVydHkgbmFtZVwiKTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZVxufTtcbmZ1bmN0aW9uIGlzQ2hhcmFjdGVyQ2xhc3NFc2NhcGUoY2gpIHtcbiAgcmV0dXJuIChcbiAgICBjaCA9PT0gMHg2NCAvKiBkICovIHx8XG4gICAgY2ggPT09IDB4NDQgLyogRCAqLyB8fFxuICAgIGNoID09PSAweDczIC8qIHMgKi8gfHxcbiAgICBjaCA9PT0gMHg1MyAvKiBTICovIHx8XG4gICAgY2ggPT09IDB4NzcgLyogdyAqLyB8fFxuICAgIGNoID09PSAweDU3IC8qIFcgKi9cbiAgKVxufVxuXG4vLyBVbmljb2RlUHJvcGVydHlWYWx1ZUV4cHJlc3Npb24gOjpcbi8vICAgVW5pY29kZVByb3BlcnR5TmFtZSBgPWAgVW5pY29kZVByb3BlcnR5VmFsdWVcbi8vICAgTG9uZVVuaWNvZGVQcm9wZXJ0eU5hbWVPclZhbHVlXG5wcCQxLnJlZ2V4cF9lYXRVbmljb2RlUHJvcGVydHlWYWx1ZUV4cHJlc3Npb24gPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgc3RhcnQgPSBzdGF0ZS5wb3M7XG5cbiAgLy8gVW5pY29kZVByb3BlcnR5TmFtZSBgPWAgVW5pY29kZVByb3BlcnR5VmFsdWVcbiAgaWYgKHRoaXMucmVnZXhwX2VhdFVuaWNvZGVQcm9wZXJ0eU5hbWUoc3RhdGUpICYmIHN0YXRlLmVhdCgweDNEIC8qID0gKi8pKSB7XG4gICAgdmFyIG5hbWUgPSBzdGF0ZS5sYXN0U3RyaW5nVmFsdWU7XG4gICAgaWYgKHRoaXMucmVnZXhwX2VhdFVuaWNvZGVQcm9wZXJ0eVZhbHVlKHN0YXRlKSkge1xuICAgICAgdmFyIHZhbHVlID0gc3RhdGUubGFzdFN0cmluZ1ZhbHVlO1xuICAgICAgdGhpcy5yZWdleHBfdmFsaWRhdGVVbmljb2RlUHJvcGVydHlOYW1lQW5kVmFsdWUoc3RhdGUsIG5hbWUsIHZhbHVlKTtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICB9XG4gIHN0YXRlLnBvcyA9IHN0YXJ0O1xuXG4gIC8vIExvbmVVbmljb2RlUHJvcGVydHlOYW1lT3JWYWx1ZVxuICBpZiAodGhpcy5yZWdleHBfZWF0TG9uZVVuaWNvZGVQcm9wZXJ0eU5hbWVPclZhbHVlKHN0YXRlKSkge1xuICAgIHZhciBuYW1lT3JWYWx1ZSA9IHN0YXRlLmxhc3RTdHJpbmdWYWx1ZTtcbiAgICB0aGlzLnJlZ2V4cF92YWxpZGF0ZVVuaWNvZGVQcm9wZXJ0eU5hbWVPclZhbHVlKHN0YXRlLCBuYW1lT3JWYWx1ZSk7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5wcCQxLnJlZ2V4cF92YWxpZGF0ZVVuaWNvZGVQcm9wZXJ0eU5hbWVBbmRWYWx1ZSA9IGZ1bmN0aW9uKHN0YXRlLCBuYW1lLCB2YWx1ZSkge1xuICBpZiAoIWhhc093bihzdGF0ZS51bmljb2RlUHJvcGVydGllcy5ub25CaW5hcnksIG5hbWUpKVxuICAgIHsgc3RhdGUucmFpc2UoXCJJbnZhbGlkIHByb3BlcnR5IG5hbWVcIik7IH1cbiAgaWYgKCFzdGF0ZS51bmljb2RlUHJvcGVydGllcy5ub25CaW5hcnlbbmFtZV0udGVzdCh2YWx1ZSkpXG4gICAgeyBzdGF0ZS5yYWlzZShcIkludmFsaWQgcHJvcGVydHkgdmFsdWVcIik7IH1cbn07XG5wcCQxLnJlZ2V4cF92YWxpZGF0ZVVuaWNvZGVQcm9wZXJ0eU5hbWVPclZhbHVlID0gZnVuY3Rpb24oc3RhdGUsIG5hbWVPclZhbHVlKSB7XG4gIGlmICghc3RhdGUudW5pY29kZVByb3BlcnRpZXMuYmluYXJ5LnRlc3QobmFtZU9yVmFsdWUpKVxuICAgIHsgc3RhdGUucmFpc2UoXCJJbnZhbGlkIHByb3BlcnR5IG5hbWVcIik7IH1cbn07XG5cbi8vIFVuaWNvZGVQcm9wZXJ0eU5hbWUgOjpcbi8vICAgVW5pY29kZVByb3BlcnR5TmFtZUNoYXJhY3RlcnNcbnBwJDEucmVnZXhwX2VhdFVuaWNvZGVQcm9wZXJ0eU5hbWUgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgY2ggPSAwO1xuICBzdGF0ZS5sYXN0U3RyaW5nVmFsdWUgPSBcIlwiO1xuICB3aGlsZSAoaXNVbmljb2RlUHJvcGVydHlOYW1lQ2hhcmFjdGVyKGNoID0gc3RhdGUuY3VycmVudCgpKSkge1xuICAgIHN0YXRlLmxhc3RTdHJpbmdWYWx1ZSArPSBjb2RlUG9pbnRUb1N0cmluZyhjaCk7XG4gICAgc3RhdGUuYWR2YW5jZSgpO1xuICB9XG4gIHJldHVybiBzdGF0ZS5sYXN0U3RyaW5nVmFsdWUgIT09IFwiXCJcbn07XG5mdW5jdGlvbiBpc1VuaWNvZGVQcm9wZXJ0eU5hbWVDaGFyYWN0ZXIoY2gpIHtcbiAgcmV0dXJuIGlzQ29udHJvbExldHRlcihjaCkgfHwgY2ggPT09IDB4NUYgLyogXyAqL1xufVxuXG4vLyBVbmljb2RlUHJvcGVydHlWYWx1ZSA6OlxuLy8gICBVbmljb2RlUHJvcGVydHlWYWx1ZUNoYXJhY3RlcnNcbnBwJDEucmVnZXhwX2VhdFVuaWNvZGVQcm9wZXJ0eVZhbHVlID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgdmFyIGNoID0gMDtcbiAgc3RhdGUubGFzdFN0cmluZ1ZhbHVlID0gXCJcIjtcbiAgd2hpbGUgKGlzVW5pY29kZVByb3BlcnR5VmFsdWVDaGFyYWN0ZXIoY2ggPSBzdGF0ZS5jdXJyZW50KCkpKSB7XG4gICAgc3RhdGUubGFzdFN0cmluZ1ZhbHVlICs9IGNvZGVQb2ludFRvU3RyaW5nKGNoKTtcbiAgICBzdGF0ZS5hZHZhbmNlKCk7XG4gIH1cbiAgcmV0dXJuIHN0YXRlLmxhc3RTdHJpbmdWYWx1ZSAhPT0gXCJcIlxufTtcbmZ1bmN0aW9uIGlzVW5pY29kZVByb3BlcnR5VmFsdWVDaGFyYWN0ZXIoY2gpIHtcbiAgcmV0dXJuIGlzVW5pY29kZVByb3BlcnR5TmFtZUNoYXJhY3RlcihjaCkgfHwgaXNEZWNpbWFsRGlnaXQoY2gpXG59XG5cbi8vIExvbmVVbmljb2RlUHJvcGVydHlOYW1lT3JWYWx1ZSA6OlxuLy8gICBVbmljb2RlUHJvcGVydHlWYWx1ZUNoYXJhY3RlcnNcbnBwJDEucmVnZXhwX2VhdExvbmVVbmljb2RlUHJvcGVydHlOYW1lT3JWYWx1ZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHJldHVybiB0aGlzLnJlZ2V4cF9lYXRVbmljb2RlUHJvcGVydHlWYWx1ZShzdGF0ZSlcbn07XG5cbi8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLUNoYXJhY3RlckNsYXNzXG5wcCQxLnJlZ2V4cF9lYXRDaGFyYWN0ZXJDbGFzcyA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIGlmIChzdGF0ZS5lYXQoMHg1QiAvKiBbICovKSkge1xuICAgIHN0YXRlLmVhdCgweDVFIC8qIF4gKi8pO1xuICAgIHRoaXMucmVnZXhwX2NsYXNzUmFuZ2VzKHN0YXRlKTtcbiAgICBpZiAoc3RhdGUuZWF0KDB4NUQgLyogXSAqLykpIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIC8vIFVucmVhY2hhYmxlIHNpbmNlIGl0IHRocmV3IFwidW50ZXJtaW5hdGVkIHJlZ3VsYXIgZXhwcmVzc2lvblwiIGVycm9yIGJlZm9yZS5cbiAgICBzdGF0ZS5yYWlzZShcIlVudGVybWluYXRlZCBjaGFyYWN0ZXIgY2xhc3NcIik7XG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1DbGFzc1Jhbmdlc1xuLy8gaHR0cHM6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi84LjAvI3Byb2QtTm9uZW1wdHlDbGFzc1Jhbmdlc1xuLy8gaHR0cHM6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi84LjAvI3Byb2QtTm9uZW1wdHlDbGFzc1Jhbmdlc05vRGFzaFxucHAkMS5yZWdleHBfY2xhc3NSYW5nZXMgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB3aGlsZSAodGhpcy5yZWdleHBfZWF0Q2xhc3NBdG9tKHN0YXRlKSkge1xuICAgIHZhciBsZWZ0ID0gc3RhdGUubGFzdEludFZhbHVlO1xuICAgIGlmIChzdGF0ZS5lYXQoMHgyRCAvKiAtICovKSAmJiB0aGlzLnJlZ2V4cF9lYXRDbGFzc0F0b20oc3RhdGUpKSB7XG4gICAgICB2YXIgcmlnaHQgPSBzdGF0ZS5sYXN0SW50VmFsdWU7XG4gICAgICBpZiAoc3RhdGUuc3dpdGNoVSAmJiAobGVmdCA9PT0gLTEgfHwgcmlnaHQgPT09IC0xKSkge1xuICAgICAgICBzdGF0ZS5yYWlzZShcIkludmFsaWQgY2hhcmFjdGVyIGNsYXNzXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGxlZnQgIT09IC0xICYmIHJpZ2h0ICE9PSAtMSAmJiBsZWZ0ID4gcmlnaHQpIHtcbiAgICAgICAgc3RhdGUucmFpc2UoXCJSYW5nZSBvdXQgb2Ygb3JkZXIgaW4gY2hhcmFjdGVyIGNsYXNzXCIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuLy8gaHR0cHM6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi84LjAvI3Byb2QtQ2xhc3NBdG9tXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1DbGFzc0F0b21Ob0Rhc2hcbnBwJDEucmVnZXhwX2VhdENsYXNzQXRvbSA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHZhciBzdGFydCA9IHN0YXRlLnBvcztcblxuICBpZiAoc3RhdGUuZWF0KDB4NUMgLyogXFwgKi8pKSB7XG4gICAgaWYgKHRoaXMucmVnZXhwX2VhdENsYXNzRXNjYXBlKHN0YXRlKSkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgaWYgKHN0YXRlLnN3aXRjaFUpIHtcbiAgICAgIC8vIE1ha2UgdGhlIHNhbWUgbWVzc2FnZSBhcyBWOC5cbiAgICAgIHZhciBjaCQxID0gc3RhdGUuY3VycmVudCgpO1xuICAgICAgaWYgKGNoJDEgPT09IDB4NjMgLyogYyAqLyB8fCBpc09jdGFsRGlnaXQoY2gkMSkpIHtcbiAgICAgICAgc3RhdGUucmFpc2UoXCJJbnZhbGlkIGNsYXNzIGVzY2FwZVwiKTtcbiAgICAgIH1cbiAgICAgIHN0YXRlLnJhaXNlKFwiSW52YWxpZCBlc2NhcGVcIik7XG4gICAgfVxuICAgIHN0YXRlLnBvcyA9IHN0YXJ0O1xuICB9XG5cbiAgdmFyIGNoID0gc3RhdGUuY3VycmVudCgpO1xuICBpZiAoY2ggIT09IDB4NUQgLyogXSAqLykge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IGNoO1xuICAgIHN0YXRlLmFkdmFuY2UoKTtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1hbm5leEItQ2xhc3NFc2NhcGVcbnBwJDEucmVnZXhwX2VhdENsYXNzRXNjYXBlID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgdmFyIHN0YXJ0ID0gc3RhdGUucG9zO1xuXG4gIGlmIChzdGF0ZS5lYXQoMHg2MiAvKiBiICovKSkge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IDB4MDg7IC8qIDxCUz4gKi9cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgaWYgKHN0YXRlLnN3aXRjaFUgJiYgc3RhdGUuZWF0KDB4MkQgLyogLSAqLykpIHtcbiAgICBzdGF0ZS5sYXN0SW50VmFsdWUgPSAweDJEOyAvKiAtICovXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIGlmICghc3RhdGUuc3dpdGNoVSAmJiBzdGF0ZS5lYXQoMHg2MyAvKiBjICovKSkge1xuICAgIGlmICh0aGlzLnJlZ2V4cF9lYXRDbGFzc0NvbnRyb2xMZXR0ZXIoc3RhdGUpKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICBzdGF0ZS5wb3MgPSBzdGFydDtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgdGhpcy5yZWdleHBfZWF0Q2hhcmFjdGVyQ2xhc3NFc2NhcGUoc3RhdGUpIHx8XG4gICAgdGhpcy5yZWdleHBfZWF0Q2hhcmFjdGVyRXNjYXBlKHN0YXRlKVxuICApXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1hbm5leEItQ2xhc3NDb250cm9sTGV0dGVyXG5wcCQxLnJlZ2V4cF9lYXRDbGFzc0NvbnRyb2xMZXR0ZXIgPSBmdW5jdGlvbihzdGF0ZSkge1xuICB2YXIgY2ggPSBzdGF0ZS5jdXJyZW50KCk7XG4gIGlmIChpc0RlY2ltYWxEaWdpdChjaCkgfHwgY2ggPT09IDB4NUYgLyogXyAqLykge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IGNoICUgMHgyMDtcbiAgICBzdGF0ZS5hZHZhbmNlKCk7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn07XG5cbi8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLUhleEVzY2FwZVNlcXVlbmNlXG5wcCQxLnJlZ2V4cF9lYXRIZXhFc2NhcGVTZXF1ZW5jZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHZhciBzdGFydCA9IHN0YXRlLnBvcztcbiAgaWYgKHN0YXRlLmVhdCgweDc4IC8qIHggKi8pKSB7XG4gICAgaWYgKHRoaXMucmVnZXhwX2VhdEZpeGVkSGV4RGlnaXRzKHN0YXRlLCAyKSkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgaWYgKHN0YXRlLnN3aXRjaFUpIHtcbiAgICAgIHN0YXRlLnJhaXNlKFwiSW52YWxpZCBlc2NhcGVcIik7XG4gICAgfVxuICAgIHN0YXRlLnBvcyA9IHN0YXJ0O1xuICB9XG4gIHJldHVybiBmYWxzZVxufTtcblxuLy8gaHR0cHM6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi84LjAvI3Byb2QtRGVjaW1hbERpZ2l0c1xucHAkMS5yZWdleHBfZWF0RGVjaW1hbERpZ2l0cyA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHZhciBzdGFydCA9IHN0YXRlLnBvcztcbiAgdmFyIGNoID0gMDtcbiAgc3RhdGUubGFzdEludFZhbHVlID0gMDtcbiAgd2hpbGUgKGlzRGVjaW1hbERpZ2l0KGNoID0gc3RhdGUuY3VycmVudCgpKSkge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IDEwICogc3RhdGUubGFzdEludFZhbHVlICsgKGNoIC0gMHgzMCAvKiAwICovKTtcbiAgICBzdGF0ZS5hZHZhbmNlKCk7XG4gIH1cbiAgcmV0dXJuIHN0YXRlLnBvcyAhPT0gc3RhcnRcbn07XG5mdW5jdGlvbiBpc0RlY2ltYWxEaWdpdChjaCkge1xuICByZXR1cm4gY2ggPj0gMHgzMCAvKiAwICovICYmIGNoIDw9IDB4MzkgLyogOSAqL1xufVxuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1IZXhEaWdpdHNcbnBwJDEucmVnZXhwX2VhdEhleERpZ2l0cyA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIHZhciBzdGFydCA9IHN0YXRlLnBvcztcbiAgdmFyIGNoID0gMDtcbiAgc3RhdGUubGFzdEludFZhbHVlID0gMDtcbiAgd2hpbGUgKGlzSGV4RGlnaXQoY2ggPSBzdGF0ZS5jdXJyZW50KCkpKSB7XG4gICAgc3RhdGUubGFzdEludFZhbHVlID0gMTYgKiBzdGF0ZS5sYXN0SW50VmFsdWUgKyBoZXhUb0ludChjaCk7XG4gICAgc3RhdGUuYWR2YW5jZSgpO1xuICB9XG4gIHJldHVybiBzdGF0ZS5wb3MgIT09IHN0YXJ0XG59O1xuZnVuY3Rpb24gaXNIZXhEaWdpdChjaCkge1xuICByZXR1cm4gKFxuICAgIChjaCA+PSAweDMwIC8qIDAgKi8gJiYgY2ggPD0gMHgzOSAvKiA5ICovKSB8fFxuICAgIChjaCA+PSAweDQxIC8qIEEgKi8gJiYgY2ggPD0gMHg0NiAvKiBGICovKSB8fFxuICAgIChjaCA+PSAweDYxIC8qIGEgKi8gJiYgY2ggPD0gMHg2NiAvKiBmICovKVxuICApXG59XG5mdW5jdGlvbiBoZXhUb0ludChjaCkge1xuICBpZiAoY2ggPj0gMHg0MSAvKiBBICovICYmIGNoIDw9IDB4NDYgLyogRiAqLykge1xuICAgIHJldHVybiAxMCArIChjaCAtIDB4NDEgLyogQSAqLylcbiAgfVxuICBpZiAoY2ggPj0gMHg2MSAvKiBhICovICYmIGNoIDw9IDB4NjYgLyogZiAqLykge1xuICAgIHJldHVybiAxMCArIChjaCAtIDB4NjEgLyogYSAqLylcbiAgfVxuICByZXR1cm4gY2ggLSAweDMwIC8qIDAgKi9cbn1cblxuLy8gaHR0cHM6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi84LjAvI3Byb2QtYW5uZXhCLUxlZ2FjeU9jdGFsRXNjYXBlU2VxdWVuY2Vcbi8vIEFsbG93cyBvbmx5IDAtMzc3KG9jdGFsKSBpLmUuIDAtMjU1KGRlY2ltYWwpLlxucHAkMS5yZWdleHBfZWF0TGVnYWN5T2N0YWxFc2NhcGVTZXF1ZW5jZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gIGlmICh0aGlzLnJlZ2V4cF9lYXRPY3RhbERpZ2l0KHN0YXRlKSkge1xuICAgIHZhciBuMSA9IHN0YXRlLmxhc3RJbnRWYWx1ZTtcbiAgICBpZiAodGhpcy5yZWdleHBfZWF0T2N0YWxEaWdpdChzdGF0ZSkpIHtcbiAgICAgIHZhciBuMiA9IHN0YXRlLmxhc3RJbnRWYWx1ZTtcbiAgICAgIGlmIChuMSA8PSAzICYmIHRoaXMucmVnZXhwX2VhdE9jdGFsRGlnaXQoc3RhdGUpKSB7XG4gICAgICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IG4xICogNjQgKyBuMiAqIDggKyBzdGF0ZS5sYXN0SW50VmFsdWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGF0ZS5sYXN0SW50VmFsdWUgPSBuMSAqIDggKyBuMjtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc3RhdGUubGFzdEludFZhbHVlID0gbjE7XG4gICAgfVxuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1PY3RhbERpZ2l0XG5wcCQxLnJlZ2V4cF9lYXRPY3RhbERpZ2l0ID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgdmFyIGNoID0gc3RhdGUuY3VycmVudCgpO1xuICBpZiAoaXNPY3RhbERpZ2l0KGNoKSkge1xuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IGNoIC0gMHgzMDsgLyogMCAqL1xuICAgIHN0YXRlLmFkdmFuY2UoKTtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IDA7XG4gIHJldHVybiBmYWxzZVxufTtcbmZ1bmN0aW9uIGlzT2N0YWxEaWdpdChjaCkge1xuICByZXR1cm4gY2ggPj0gMHgzMCAvKiAwICovICYmIGNoIDw9IDB4MzcgLyogNyAqL1xufVxuXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1IZXg0RGlnaXRzXG4vLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzguMC8jcHJvZC1IZXhEaWdpdFxuLy8gQW5kIEhleERpZ2l0IEhleERpZ2l0IGluIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOC4wLyNwcm9kLUhleEVzY2FwZVNlcXVlbmNlXG5wcCQxLnJlZ2V4cF9lYXRGaXhlZEhleERpZ2l0cyA9IGZ1bmN0aW9uKHN0YXRlLCBsZW5ndGgpIHtcbiAgdmFyIHN0YXJ0ID0gc3RhdGUucG9zO1xuICBzdGF0ZS5sYXN0SW50VmFsdWUgPSAwO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGNoID0gc3RhdGUuY3VycmVudCgpO1xuICAgIGlmICghaXNIZXhEaWdpdChjaCkpIHtcbiAgICAgIHN0YXRlLnBvcyA9IHN0YXJ0O1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIHN0YXRlLmxhc3RJbnRWYWx1ZSA9IDE2ICogc3RhdGUubGFzdEludFZhbHVlICsgaGV4VG9JbnQoY2gpO1xuICAgIHN0YXRlLmFkdmFuY2UoKTtcbiAgfVxuICByZXR1cm4gdHJ1ZVxufTtcblxuLy8gT2JqZWN0IHR5cGUgdXNlZCB0byByZXByZXNlbnQgdG9rZW5zLiBOb3RlIHRoYXQgbm9ybWFsbHksIHRva2Vuc1xuLy8gc2ltcGx5IGV4aXN0IGFzIHByb3BlcnRpZXMgb24gdGhlIHBhcnNlciBvYmplY3QuIFRoaXMgaXMgb25seVxuLy8gdXNlZCBmb3IgdGhlIG9uVG9rZW4gY2FsbGJhY2sgYW5kIHRoZSBleHRlcm5hbCB0b2tlbml6ZXIuXG5cbnZhciBUb2tlbiA9IGZ1bmN0aW9uIFRva2VuKHApIHtcbiAgdGhpcy50eXBlID0gcC50eXBlO1xuICB0aGlzLnZhbHVlID0gcC52YWx1ZTtcbiAgdGhpcy5zdGFydCA9IHAuc3RhcnQ7XG4gIHRoaXMuZW5kID0gcC5lbmQ7XG4gIGlmIChwLm9wdGlvbnMubG9jYXRpb25zKVxuICAgIHsgdGhpcy5sb2MgPSBuZXcgU291cmNlTG9jYXRpb24ocCwgcC5zdGFydExvYywgcC5lbmRMb2MpOyB9XG4gIGlmIChwLm9wdGlvbnMucmFuZ2VzKVxuICAgIHsgdGhpcy5yYW5nZSA9IFtwLnN0YXJ0LCBwLmVuZF07IH1cbn07XG5cbi8vICMjIFRva2VuaXplclxuXG52YXIgcHAgPSBQYXJzZXIucHJvdG90eXBlO1xuXG4vLyBNb3ZlIHRvIHRoZSBuZXh0IHRva2VuXG5cbnBwLm5leHQgPSBmdW5jdGlvbihpZ25vcmVFc2NhcGVTZXF1ZW5jZUluS2V5d29yZCkge1xuICBpZiAoIWlnbm9yZUVzY2FwZVNlcXVlbmNlSW5LZXl3b3JkICYmIHRoaXMudHlwZS5rZXl3b3JkICYmIHRoaXMuY29udGFpbnNFc2MpXG4gICAgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUodGhpcy5zdGFydCwgXCJFc2NhcGUgc2VxdWVuY2UgaW4ga2V5d29yZCBcIiArIHRoaXMudHlwZS5rZXl3b3JkKTsgfVxuICBpZiAodGhpcy5vcHRpb25zLm9uVG9rZW4pXG4gICAgeyB0aGlzLm9wdGlvbnMub25Ub2tlbihuZXcgVG9rZW4odGhpcykpOyB9XG5cbiAgdGhpcy5sYXN0VG9rRW5kID0gdGhpcy5lbmQ7XG4gIHRoaXMubGFzdFRva1N0YXJ0ID0gdGhpcy5zdGFydDtcbiAgdGhpcy5sYXN0VG9rRW5kTG9jID0gdGhpcy5lbmRMb2M7XG4gIHRoaXMubGFzdFRva1N0YXJ0TG9jID0gdGhpcy5zdGFydExvYztcbiAgdGhpcy5uZXh0VG9rZW4oKTtcbn07XG5cbnBwLmdldFRva2VuID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMubmV4dCgpO1xuICByZXR1cm4gbmV3IFRva2VuKHRoaXMpXG59O1xuXG4vLyBJZiB3ZSdyZSBpbiBhbiBFUzYgZW52aXJvbm1lbnQsIG1ha2UgcGFyc2VycyBpdGVyYWJsZVxuaWYgKHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIpXG4gIHsgcHBbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0aGlzJDEkMSA9IHRoaXM7XG5cbiAgICByZXR1cm4ge1xuICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzJDEkMS5nZXRUb2tlbigpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRvbmU6IHRva2VuLnR5cGUgPT09IHR5cGVzJDEuZW9mLFxuICAgICAgICAgIHZhbHVlOiB0b2tlblxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9OyB9XG5cbi8vIFRvZ2dsZSBzdHJpY3QgbW9kZS4gUmUtcmVhZHMgdGhlIG5leHQgbnVtYmVyIG9yIHN0cmluZyB0byBwbGVhc2Vcbi8vIHBlZGFudGljIHRlc3RzIChgXCJ1c2Ugc3RyaWN0XCI7IDAxMDtgIHNob3VsZCBmYWlsKS5cblxuLy8gUmVhZCBhIHNpbmdsZSB0b2tlbiwgdXBkYXRpbmcgdGhlIHBhcnNlciBvYmplY3QncyB0b2tlbi1yZWxhdGVkXG4vLyBwcm9wZXJ0aWVzLlxuXG5wcC5uZXh0VG9rZW4gPSBmdW5jdGlvbigpIHtcbiAgdmFyIGN1ckNvbnRleHQgPSB0aGlzLmN1ckNvbnRleHQoKTtcbiAgaWYgKCFjdXJDb250ZXh0IHx8ICFjdXJDb250ZXh0LnByZXNlcnZlU3BhY2UpIHsgdGhpcy5za2lwU3BhY2UoKTsgfVxuXG4gIHRoaXMuc3RhcnQgPSB0aGlzLnBvcztcbiAgaWYgKHRoaXMub3B0aW9ucy5sb2NhdGlvbnMpIHsgdGhpcy5zdGFydExvYyA9IHRoaXMuY3VyUG9zaXRpb24oKTsgfVxuICBpZiAodGhpcy5wb3MgPj0gdGhpcy5pbnB1dC5sZW5ndGgpIHsgcmV0dXJuIHRoaXMuZmluaXNoVG9rZW4odHlwZXMkMS5lb2YpIH1cblxuICBpZiAoY3VyQ29udGV4dC5vdmVycmlkZSkgeyByZXR1cm4gY3VyQ29udGV4dC5vdmVycmlkZSh0aGlzKSB9XG4gIGVsc2UgeyB0aGlzLnJlYWRUb2tlbih0aGlzLmZ1bGxDaGFyQ29kZUF0UG9zKCkpOyB9XG59O1xuXG5wcC5yZWFkVG9rZW4gPSBmdW5jdGlvbihjb2RlKSB7XG4gIC8vIElkZW50aWZpZXIgb3Iga2V5d29yZC4gJ1xcdVhYWFgnIHNlcXVlbmNlcyBhcmUgYWxsb3dlZCBpblxuICAvLyBpZGVudGlmaWVycywgc28gJ1xcJyBhbHNvIGRpc3BhdGNoZXMgdG8gdGhhdC5cbiAgaWYgKGlzSWRlbnRpZmllclN0YXJ0KGNvZGUsIHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA2KSB8fCBjb2RlID09PSA5MiAvKiAnXFwnICovKVxuICAgIHsgcmV0dXJuIHRoaXMucmVhZFdvcmQoKSB9XG5cbiAgcmV0dXJuIHRoaXMuZ2V0VG9rZW5Gcm9tQ29kZShjb2RlKVxufTtcblxucHAuZnVsbENoYXJDb2RlQXRQb3MgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGNvZGUgPSB0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MpO1xuICBpZiAoY29kZSA8PSAweGQ3ZmYgfHwgY29kZSA+PSAweGRjMDApIHsgcmV0dXJuIGNvZGUgfVxuICB2YXIgbmV4dCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyArIDEpO1xuICByZXR1cm4gbmV4dCA8PSAweGRiZmYgfHwgbmV4dCA+PSAweGUwMDAgPyBjb2RlIDogKGNvZGUgPDwgMTApICsgbmV4dCAtIDB4MzVmZGMwMFxufTtcblxucHAuc2tpcEJsb2NrQ29tbWVudCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgc3RhcnRMb2MgPSB0aGlzLm9wdGlvbnMub25Db21tZW50ICYmIHRoaXMuY3VyUG9zaXRpb24oKTtcbiAgdmFyIHN0YXJ0ID0gdGhpcy5wb3MsIGVuZCA9IHRoaXMuaW5wdXQuaW5kZXhPZihcIiovXCIsIHRoaXMucG9zICs9IDIpO1xuICBpZiAoZW5kID09PSAtMSkgeyB0aGlzLnJhaXNlKHRoaXMucG9zIC0gMiwgXCJVbnRlcm1pbmF0ZWQgY29tbWVudFwiKTsgfVxuICB0aGlzLnBvcyA9IGVuZCArIDI7XG4gIGlmICh0aGlzLm9wdGlvbnMubG9jYXRpb25zKSB7XG4gICAgZm9yICh2YXIgbmV4dEJyZWFrID0gKHZvaWQgMCksIHBvcyA9IHN0YXJ0OyAobmV4dEJyZWFrID0gbmV4dExpbmVCcmVhayh0aGlzLmlucHV0LCBwb3MsIHRoaXMucG9zKSkgPiAtMTspIHtcbiAgICAgICsrdGhpcy5jdXJMaW5lO1xuICAgICAgcG9zID0gdGhpcy5saW5lU3RhcnQgPSBuZXh0QnJlYWs7XG4gICAgfVxuICB9XG4gIGlmICh0aGlzLm9wdGlvbnMub25Db21tZW50KVxuICAgIHsgdGhpcy5vcHRpb25zLm9uQ29tbWVudCh0cnVlLCB0aGlzLmlucHV0LnNsaWNlKHN0YXJ0ICsgMiwgZW5kKSwgc3RhcnQsIHRoaXMucG9zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRMb2MsIHRoaXMuY3VyUG9zaXRpb24oKSk7IH1cbn07XG5cbnBwLnNraXBMaW5lQ29tbWVudCA9IGZ1bmN0aW9uKHN0YXJ0U2tpcCkge1xuICB2YXIgc3RhcnQgPSB0aGlzLnBvcztcbiAgdmFyIHN0YXJ0TG9jID0gdGhpcy5vcHRpb25zLm9uQ29tbWVudCAmJiB0aGlzLmN1clBvc2l0aW9uKCk7XG4gIHZhciBjaCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyArPSBzdGFydFNraXApO1xuICB3aGlsZSAodGhpcy5wb3MgPCB0aGlzLmlucHV0Lmxlbmd0aCAmJiAhaXNOZXdMaW5lKGNoKSkge1xuICAgIGNoID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KCsrdGhpcy5wb3MpO1xuICB9XG4gIGlmICh0aGlzLm9wdGlvbnMub25Db21tZW50KVxuICAgIHsgdGhpcy5vcHRpb25zLm9uQ29tbWVudChmYWxzZSwgdGhpcy5pbnB1dC5zbGljZShzdGFydCArIHN0YXJ0U2tpcCwgdGhpcy5wb3MpLCBzdGFydCwgdGhpcy5wb3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydExvYywgdGhpcy5jdXJQb3NpdGlvbigpKTsgfVxufTtcblxuLy8gQ2FsbGVkIGF0IHRoZSBzdGFydCBvZiB0aGUgcGFyc2UgYW5kIGFmdGVyIGV2ZXJ5IHRva2VuLiBTa2lwc1xuLy8gd2hpdGVzcGFjZSBhbmQgY29tbWVudHMsIGFuZC5cblxucHAuc2tpcFNwYWNlID0gZnVuY3Rpb24oKSB7XG4gIGxvb3A6IHdoaWxlICh0aGlzLnBvcyA8IHRoaXMuaW5wdXQubGVuZ3RoKSB7XG4gICAgdmFyIGNoID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zKTtcbiAgICBzd2l0Y2ggKGNoKSB7XG4gICAgY2FzZSAzMjogY2FzZSAxNjA6IC8vICcgJ1xuICAgICAgKyt0aGlzLnBvcztcbiAgICAgIGJyZWFrXG4gICAgY2FzZSAxMzpcbiAgICAgIGlmICh0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MgKyAxKSA9PT0gMTApIHtcbiAgICAgICAgKyt0aGlzLnBvcztcbiAgICAgIH1cbiAgICBjYXNlIDEwOiBjYXNlIDgyMzI6IGNhc2UgODIzMzpcbiAgICAgICsrdGhpcy5wb3M7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmxvY2F0aW9ucykge1xuICAgICAgICArK3RoaXMuY3VyTGluZTtcbiAgICAgICAgdGhpcy5saW5lU3RhcnQgPSB0aGlzLnBvcztcbiAgICAgIH1cbiAgICAgIGJyZWFrXG4gICAgY2FzZSA0NzogLy8gJy8nXG4gICAgICBzd2l0Y2ggKHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyArIDEpKSB7XG4gICAgICBjYXNlIDQyOiAvLyAnKidcbiAgICAgICAgdGhpcy5za2lwQmxvY2tDb21tZW50KCk7XG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIDQ3OlxuICAgICAgICB0aGlzLnNraXBMaW5lQ29tbWVudCgyKTtcbiAgICAgICAgYnJlYWtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrIGxvb3BcbiAgICAgIH1cbiAgICAgIGJyZWFrXG4gICAgZGVmYXVsdDpcbiAgICAgIGlmIChjaCA+IDggJiYgY2ggPCAxNCB8fCBjaCA+PSA1NzYwICYmIG5vbkFTQ0lJd2hpdGVzcGFjZS50ZXN0KFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpKSkge1xuICAgICAgICArK3RoaXMucG9zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnJlYWsgbG9vcFxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuLy8gQ2FsbGVkIGF0IHRoZSBlbmQgb2YgZXZlcnkgdG9rZW4uIFNldHMgYGVuZGAsIGB2YWxgLCBhbmRcbi8vIG1haW50YWlucyBgY29udGV4dGAgYW5kIGBleHByQWxsb3dlZGAsIGFuZCBza2lwcyB0aGUgc3BhY2UgYWZ0ZXJcbi8vIHRoZSB0b2tlbiwgc28gdGhhdCB0aGUgbmV4dCBvbmUncyBgc3RhcnRgIHdpbGwgcG9pbnQgYXQgdGhlXG4vLyByaWdodCBwb3NpdGlvbi5cblxucHAuZmluaXNoVG9rZW4gPSBmdW5jdGlvbih0eXBlLCB2YWwpIHtcbiAgdGhpcy5lbmQgPSB0aGlzLnBvcztcbiAgaWYgKHRoaXMub3B0aW9ucy5sb2NhdGlvbnMpIHsgdGhpcy5lbmRMb2MgPSB0aGlzLmN1clBvc2l0aW9uKCk7IH1cbiAgdmFyIHByZXZUeXBlID0gdGhpcy50eXBlO1xuICB0aGlzLnR5cGUgPSB0eXBlO1xuICB0aGlzLnZhbHVlID0gdmFsO1xuXG4gIHRoaXMudXBkYXRlQ29udGV4dChwcmV2VHlwZSk7XG59O1xuXG4vLyAjIyMgVG9rZW4gcmVhZGluZ1xuXG4vLyBUaGlzIGlzIHRoZSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB0byBmZXRjaCB0aGUgbmV4dCB0b2tlbi4gSXRcbi8vIGlzIHNvbWV3aGF0IG9ic2N1cmUsIGJlY2F1c2UgaXQgd29ya3MgaW4gY2hhcmFjdGVyIGNvZGVzIHJhdGhlclxuLy8gdGhhbiBjaGFyYWN0ZXJzLCBhbmQgYmVjYXVzZSBvcGVyYXRvciBwYXJzaW5nIGhhcyBiZWVuIGlubGluZWRcbi8vIGludG8gaXQuXG4vL1xuLy8gQWxsIGluIHRoZSBuYW1lIG9mIHNwZWVkLlxuLy9cbnBwLnJlYWRUb2tlbl9kb3QgPSBmdW5jdGlvbigpIHtcbiAgdmFyIG5leHQgPSB0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MgKyAxKTtcbiAgaWYgKG5leHQgPj0gNDggJiYgbmV4dCA8PSA1NykgeyByZXR1cm4gdGhpcy5yZWFkTnVtYmVyKHRydWUpIH1cbiAgdmFyIG5leHQyID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMik7XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gNiAmJiBuZXh0ID09PSA0NiAmJiBuZXh0MiA9PT0gNDYpIHsgLy8gNDYgPSBkb3QgJy4nXG4gICAgdGhpcy5wb3MgKz0gMztcbiAgICByZXR1cm4gdGhpcy5maW5pc2hUb2tlbih0eXBlcyQxLmVsbGlwc2lzKVxuICB9IGVsc2Uge1xuICAgICsrdGhpcy5wb3M7XG4gICAgcmV0dXJuIHRoaXMuZmluaXNoVG9rZW4odHlwZXMkMS5kb3QpXG4gIH1cbn07XG5cbnBwLnJlYWRUb2tlbl9zbGFzaCA9IGZ1bmN0aW9uKCkgeyAvLyAnLydcbiAgdmFyIG5leHQgPSB0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MgKyAxKTtcbiAgaWYgKHRoaXMuZXhwckFsbG93ZWQpIHsgKyt0aGlzLnBvczsgcmV0dXJuIHRoaXMucmVhZFJlZ2V4cCgpIH1cbiAgaWYgKG5leHQgPT09IDYxKSB7IHJldHVybiB0aGlzLmZpbmlzaE9wKHR5cGVzJDEuYXNzaWduLCAyKSB9XG4gIHJldHVybiB0aGlzLmZpbmlzaE9wKHR5cGVzJDEuc2xhc2gsIDEpXG59O1xuXG5wcC5yZWFkVG9rZW5fbXVsdF9tb2R1bG9fZXhwID0gZnVuY3Rpb24oY29kZSkgeyAvLyAnJSonXG4gIHZhciBuZXh0ID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMSk7XG4gIHZhciBzaXplID0gMTtcbiAgdmFyIHRva2VudHlwZSA9IGNvZGUgPT09IDQyID8gdHlwZXMkMS5zdGFyIDogdHlwZXMkMS5tb2R1bG87XG5cbiAgLy8gZXhwb25lbnRpYXRpb24gb3BlcmF0b3IgKiogYW5kICoqPVxuICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDcgJiYgY29kZSA9PT0gNDIgJiYgbmV4dCA9PT0gNDIpIHtcbiAgICArK3NpemU7XG4gICAgdG9rZW50eXBlID0gdHlwZXMkMS5zdGFyc3RhcjtcbiAgICBuZXh0ID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMik7XG4gIH1cblxuICBpZiAobmV4dCA9PT0gNjEpIHsgcmV0dXJuIHRoaXMuZmluaXNoT3AodHlwZXMkMS5hc3NpZ24sIHNpemUgKyAxKSB9XG4gIHJldHVybiB0aGlzLmZpbmlzaE9wKHRva2VudHlwZSwgc2l6ZSlcbn07XG5cbnBwLnJlYWRUb2tlbl9waXBlX2FtcCA9IGZ1bmN0aW9uKGNvZGUpIHsgLy8gJ3wmJ1xuICB2YXIgbmV4dCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyArIDEpO1xuICBpZiAobmV4dCA9PT0gY29kZSkge1xuICAgIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gMTIpIHtcbiAgICAgIHZhciBuZXh0MiA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyArIDIpO1xuICAgICAgaWYgKG5leHQyID09PSA2MSkgeyByZXR1cm4gdGhpcy5maW5pc2hPcCh0eXBlcyQxLmFzc2lnbiwgMykgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5maW5pc2hPcChjb2RlID09PSAxMjQgPyB0eXBlcyQxLmxvZ2ljYWxPUiA6IHR5cGVzJDEubG9naWNhbEFORCwgMilcbiAgfVxuICBpZiAobmV4dCA9PT0gNjEpIHsgcmV0dXJuIHRoaXMuZmluaXNoT3AodHlwZXMkMS5hc3NpZ24sIDIpIH1cbiAgcmV0dXJuIHRoaXMuZmluaXNoT3AoY29kZSA9PT0gMTI0ID8gdHlwZXMkMS5iaXR3aXNlT1IgOiB0eXBlcyQxLmJpdHdpc2VBTkQsIDEpXG59O1xuXG5wcC5yZWFkVG9rZW5fY2FyZXQgPSBmdW5jdGlvbigpIHsgLy8gJ14nXG4gIHZhciBuZXh0ID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMSk7XG4gIGlmIChuZXh0ID09PSA2MSkgeyByZXR1cm4gdGhpcy5maW5pc2hPcCh0eXBlcyQxLmFzc2lnbiwgMikgfVxuICByZXR1cm4gdGhpcy5maW5pc2hPcCh0eXBlcyQxLmJpdHdpc2VYT1IsIDEpXG59O1xuXG5wcC5yZWFkVG9rZW5fcGx1c19taW4gPSBmdW5jdGlvbihjb2RlKSB7IC8vICcrLSdcbiAgdmFyIG5leHQgPSB0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MgKyAxKTtcbiAgaWYgKG5leHQgPT09IGNvZGUpIHtcbiAgICBpZiAobmV4dCA9PT0gNDUgJiYgIXRoaXMuaW5Nb2R1bGUgJiYgdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMikgPT09IDYyICYmXG4gICAgICAgICh0aGlzLmxhc3RUb2tFbmQgPT09IDAgfHwgbGluZUJyZWFrLnRlc3QodGhpcy5pbnB1dC5zbGljZSh0aGlzLmxhc3RUb2tFbmQsIHRoaXMucG9zKSkpKSB7XG4gICAgICAvLyBBIGAtLT5gIGxpbmUgY29tbWVudFxuICAgICAgdGhpcy5za2lwTGluZUNvbW1lbnQoMyk7XG4gICAgICB0aGlzLnNraXBTcGFjZSgpO1xuICAgICAgcmV0dXJuIHRoaXMubmV4dFRva2VuKClcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZmluaXNoT3AodHlwZXMkMS5pbmNEZWMsIDIpXG4gIH1cbiAgaWYgKG5leHQgPT09IDYxKSB7IHJldHVybiB0aGlzLmZpbmlzaE9wKHR5cGVzJDEuYXNzaWduLCAyKSB9XG4gIHJldHVybiB0aGlzLmZpbmlzaE9wKHR5cGVzJDEucGx1c01pbiwgMSlcbn07XG5cbnBwLnJlYWRUb2tlbl9sdF9ndCA9IGZ1bmN0aW9uKGNvZGUpIHsgLy8gJzw+J1xuICB2YXIgbmV4dCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyArIDEpO1xuICB2YXIgc2l6ZSA9IDE7XG4gIGlmIChuZXh0ID09PSBjb2RlKSB7XG4gICAgc2l6ZSA9IGNvZGUgPT09IDYyICYmIHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyArIDIpID09PSA2MiA/IDMgOiAyO1xuICAgIGlmICh0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MgKyBzaXplKSA9PT0gNjEpIHsgcmV0dXJuIHRoaXMuZmluaXNoT3AodHlwZXMkMS5hc3NpZ24sIHNpemUgKyAxKSB9XG4gICAgcmV0dXJuIHRoaXMuZmluaXNoT3AodHlwZXMkMS5iaXRTaGlmdCwgc2l6ZSlcbiAgfVxuICBpZiAobmV4dCA9PT0gMzMgJiYgY29kZSA9PT0gNjAgJiYgIXRoaXMuaW5Nb2R1bGUgJiYgdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMikgPT09IDQ1ICYmXG4gICAgICB0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MgKyAzKSA9PT0gNDUpIHtcbiAgICAvLyBgPCEtLWAsIGFuIFhNTC1zdHlsZSBjb21tZW50IHRoYXQgc2hvdWxkIGJlIGludGVycHJldGVkIGFzIGEgbGluZSBjb21tZW50XG4gICAgdGhpcy5za2lwTGluZUNvbW1lbnQoNCk7XG4gICAgdGhpcy5za2lwU3BhY2UoKTtcbiAgICByZXR1cm4gdGhpcy5uZXh0VG9rZW4oKVxuICB9XG4gIGlmIChuZXh0ID09PSA2MSkgeyBzaXplID0gMjsgfVxuICByZXR1cm4gdGhpcy5maW5pc2hPcCh0eXBlcyQxLnJlbGF0aW9uYWwsIHNpemUpXG59O1xuXG5wcC5yZWFkVG9rZW5fZXFfZXhjbCA9IGZ1bmN0aW9uKGNvZGUpIHsgLy8gJz0hJ1xuICB2YXIgbmV4dCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyArIDEpO1xuICBpZiAobmV4dCA9PT0gNjEpIHsgcmV0dXJuIHRoaXMuZmluaXNoT3AodHlwZXMkMS5lcXVhbGl0eSwgdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMikgPT09IDYxID8gMyA6IDIpIH1cbiAgaWYgKGNvZGUgPT09IDYxICYmIG5leHQgPT09IDYyICYmIHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbiA+PSA2KSB7IC8vICc9PidcbiAgICB0aGlzLnBvcyArPSAyO1xuICAgIHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEuYXJyb3cpXG4gIH1cbiAgcmV0dXJuIHRoaXMuZmluaXNoT3AoY29kZSA9PT0gNjEgPyB0eXBlcyQxLmVxIDogdHlwZXMkMS5wcmVmaXgsIDEpXG59O1xuXG5wcC5yZWFkVG9rZW5fcXVlc3Rpb24gPSBmdW5jdGlvbigpIHsgLy8gJz8nXG4gIHZhciBlY21hVmVyc2lvbiA9IHRoaXMub3B0aW9ucy5lY21hVmVyc2lvbjtcbiAgaWYgKGVjbWFWZXJzaW9uID49IDExKSB7XG4gICAgdmFyIG5leHQgPSB0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MgKyAxKTtcbiAgICBpZiAobmV4dCA9PT0gNDYpIHtcbiAgICAgIHZhciBuZXh0MiA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyArIDIpO1xuICAgICAgaWYgKG5leHQyIDwgNDggfHwgbmV4dDIgPiA1NykgeyByZXR1cm4gdGhpcy5maW5pc2hPcCh0eXBlcyQxLnF1ZXN0aW9uRG90LCAyKSB9XG4gICAgfVxuICAgIGlmIChuZXh0ID09PSA2Mykge1xuICAgICAgaWYgKGVjbWFWZXJzaW9uID49IDEyKSB7XG4gICAgICAgIHZhciBuZXh0MiQxID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMik7XG4gICAgICAgIGlmIChuZXh0MiQxID09PSA2MSkgeyByZXR1cm4gdGhpcy5maW5pc2hPcCh0eXBlcyQxLmFzc2lnbiwgMykgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuZmluaXNoT3AodHlwZXMkMS5jb2FsZXNjZSwgMilcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRoaXMuZmluaXNoT3AodHlwZXMkMS5xdWVzdGlvbiwgMSlcbn07XG5cbnBwLnJlYWRUb2tlbl9udW1iZXJTaWduID0gZnVuY3Rpb24oKSB7IC8vICcjJ1xuICB2YXIgZWNtYVZlcnNpb24gPSB0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb247XG4gIHZhciBjb2RlID0gMzU7IC8vICcjJ1xuICBpZiAoZWNtYVZlcnNpb24gPj0gMTMpIHtcbiAgICArK3RoaXMucG9zO1xuICAgIGNvZGUgPSB0aGlzLmZ1bGxDaGFyQ29kZUF0UG9zKCk7XG4gICAgaWYgKGlzSWRlbnRpZmllclN0YXJ0KGNvZGUsIHRydWUpIHx8IGNvZGUgPT09IDkyIC8qICdcXCcgKi8pIHtcbiAgICAgIHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEucHJpdmF0ZUlkLCB0aGlzLnJlYWRXb3JkMSgpKVxuICAgIH1cbiAgfVxuXG4gIHRoaXMucmFpc2UodGhpcy5wb3MsIFwiVW5leHBlY3RlZCBjaGFyYWN0ZXIgJ1wiICsgY29kZVBvaW50VG9TdHJpbmcoY29kZSkgKyBcIidcIik7XG59O1xuXG5wcC5nZXRUb2tlbkZyb21Db2RlID0gZnVuY3Rpb24oY29kZSkge1xuICBzd2l0Y2ggKGNvZGUpIHtcbiAgLy8gVGhlIGludGVycHJldGF0aW9uIG9mIGEgZG90IGRlcGVuZHMgb24gd2hldGhlciBpdCBpcyBmb2xsb3dlZFxuICAvLyBieSBhIGRpZ2l0IG9yIGFub3RoZXIgdHdvIGRvdHMuXG4gIGNhc2UgNDY6IC8vICcuJ1xuICAgIHJldHVybiB0aGlzLnJlYWRUb2tlbl9kb3QoKVxuXG4gIC8vIFB1bmN0dWF0aW9uIHRva2Vucy5cbiAgY2FzZSA0MDogKyt0aGlzLnBvczsgcmV0dXJuIHRoaXMuZmluaXNoVG9rZW4odHlwZXMkMS5wYXJlbkwpXG4gIGNhc2UgNDE6ICsrdGhpcy5wb3M7IHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEucGFyZW5SKVxuICBjYXNlIDU5OiArK3RoaXMucG9zOyByZXR1cm4gdGhpcy5maW5pc2hUb2tlbih0eXBlcyQxLnNlbWkpXG4gIGNhc2UgNDQ6ICsrdGhpcy5wb3M7IHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEuY29tbWEpXG4gIGNhc2UgOTE6ICsrdGhpcy5wb3M7IHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEuYnJhY2tldEwpXG4gIGNhc2UgOTM6ICsrdGhpcy5wb3M7IHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEuYnJhY2tldFIpXG4gIGNhc2UgMTIzOiArK3RoaXMucG9zOyByZXR1cm4gdGhpcy5maW5pc2hUb2tlbih0eXBlcyQxLmJyYWNlTClcbiAgY2FzZSAxMjU6ICsrdGhpcy5wb3M7IHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEuYnJhY2VSKVxuICBjYXNlIDU4OiArK3RoaXMucG9zOyByZXR1cm4gdGhpcy5maW5pc2hUb2tlbih0eXBlcyQxLmNvbG9uKVxuXG4gIGNhc2UgOTY6IC8vICdgJ1xuICAgIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPCA2KSB7IGJyZWFrIH1cbiAgICArK3RoaXMucG9zO1xuICAgIHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEuYmFja1F1b3RlKVxuXG4gIGNhc2UgNDg6IC8vICcwJ1xuICAgIHZhciBuZXh0ID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMSk7XG4gICAgaWYgKG5leHQgPT09IDEyMCB8fCBuZXh0ID09PSA4OCkgeyByZXR1cm4gdGhpcy5yZWFkUmFkaXhOdW1iZXIoMTYpIH0gLy8gJzB4JywgJzBYJyAtIGhleCBudW1iZXJcbiAgICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDYpIHtcbiAgICAgIGlmIChuZXh0ID09PSAxMTEgfHwgbmV4dCA9PT0gNzkpIHsgcmV0dXJuIHRoaXMucmVhZFJhZGl4TnVtYmVyKDgpIH0gLy8gJzBvJywgJzBPJyAtIG9jdGFsIG51bWJlclxuICAgICAgaWYgKG5leHQgPT09IDk4IHx8IG5leHQgPT09IDY2KSB7IHJldHVybiB0aGlzLnJlYWRSYWRpeE51bWJlcigyKSB9IC8vICcwYicsICcwQicgLSBiaW5hcnkgbnVtYmVyXG4gICAgfVxuXG4gIC8vIEFueXRoaW5nIGVsc2UgYmVnaW5uaW5nIHdpdGggYSBkaWdpdCBpcyBhbiBpbnRlZ2VyLCBvY3RhbFxuICAvLyBudW1iZXIsIG9yIGZsb2F0LlxuICBjYXNlIDQ5OiBjYXNlIDUwOiBjYXNlIDUxOiBjYXNlIDUyOiBjYXNlIDUzOiBjYXNlIDU0OiBjYXNlIDU1OiBjYXNlIDU2OiBjYXNlIDU3OiAvLyAxLTlcbiAgICByZXR1cm4gdGhpcy5yZWFkTnVtYmVyKGZhbHNlKVxuXG4gIC8vIFF1b3RlcyBwcm9kdWNlIHN0cmluZ3MuXG4gIGNhc2UgMzQ6IGNhc2UgMzk6IC8vICdcIicsIFwiJ1wiXG4gICAgcmV0dXJuIHRoaXMucmVhZFN0cmluZyhjb2RlKVxuXG4gIC8vIE9wZXJhdG9ycyBhcmUgcGFyc2VkIGlubGluZSBpbiB0aW55IHN0YXRlIG1hY2hpbmVzLiAnPScgKDYxKSBpc1xuICAvLyBvZnRlbiByZWZlcnJlZCB0by4gYGZpbmlzaE9wYCBzaW1wbHkgc2tpcHMgdGhlIGFtb3VudCBvZlxuICAvLyBjaGFyYWN0ZXJzIGl0IGlzIGdpdmVuIGFzIHNlY29uZCBhcmd1bWVudCwgYW5kIHJldHVybnMgYSB0b2tlblxuICAvLyBvZiB0aGUgdHlwZSBnaXZlbiBieSBpdHMgZmlyc3QgYXJndW1lbnQuXG4gIGNhc2UgNDc6IC8vICcvJ1xuICAgIHJldHVybiB0aGlzLnJlYWRUb2tlbl9zbGFzaCgpXG5cbiAgY2FzZSAzNzogY2FzZSA0MjogLy8gJyUqJ1xuICAgIHJldHVybiB0aGlzLnJlYWRUb2tlbl9tdWx0X21vZHVsb19leHAoY29kZSlcblxuICBjYXNlIDEyNDogY2FzZSAzODogLy8gJ3wmJ1xuICAgIHJldHVybiB0aGlzLnJlYWRUb2tlbl9waXBlX2FtcChjb2RlKVxuXG4gIGNhc2UgOTQ6IC8vICdeJ1xuICAgIHJldHVybiB0aGlzLnJlYWRUb2tlbl9jYXJldCgpXG5cbiAgY2FzZSA0MzogY2FzZSA0NTogLy8gJystJ1xuICAgIHJldHVybiB0aGlzLnJlYWRUb2tlbl9wbHVzX21pbihjb2RlKVxuXG4gIGNhc2UgNjA6IGNhc2UgNjI6IC8vICc8PidcbiAgICByZXR1cm4gdGhpcy5yZWFkVG9rZW5fbHRfZ3QoY29kZSlcblxuICBjYXNlIDYxOiBjYXNlIDMzOiAvLyAnPSEnXG4gICAgcmV0dXJuIHRoaXMucmVhZFRva2VuX2VxX2V4Y2woY29kZSlcblxuICBjYXNlIDYzOiAvLyAnPydcbiAgICByZXR1cm4gdGhpcy5yZWFkVG9rZW5fcXVlc3Rpb24oKVxuXG4gIGNhc2UgMTI2OiAvLyAnfidcbiAgICByZXR1cm4gdGhpcy5maW5pc2hPcCh0eXBlcyQxLnByZWZpeCwgMSlcblxuICBjYXNlIDM1OiAvLyAnIydcbiAgICByZXR1cm4gdGhpcy5yZWFkVG9rZW5fbnVtYmVyU2lnbigpXG4gIH1cblxuICB0aGlzLnJhaXNlKHRoaXMucG9zLCBcIlVuZXhwZWN0ZWQgY2hhcmFjdGVyICdcIiArIGNvZGVQb2ludFRvU3RyaW5nKGNvZGUpICsgXCInXCIpO1xufTtcblxucHAuZmluaXNoT3AgPSBmdW5jdGlvbih0eXBlLCBzaXplKSB7XG4gIHZhciBzdHIgPSB0aGlzLmlucHV0LnNsaWNlKHRoaXMucG9zLCB0aGlzLnBvcyArIHNpemUpO1xuICB0aGlzLnBvcyArPSBzaXplO1xuICByZXR1cm4gdGhpcy5maW5pc2hUb2tlbih0eXBlLCBzdHIpXG59O1xuXG5wcC5yZWFkUmVnZXhwID0gZnVuY3Rpb24oKSB7XG4gIHZhciBlc2NhcGVkLCBpbkNsYXNzLCBzdGFydCA9IHRoaXMucG9zO1xuICBmb3IgKDs7KSB7XG4gICAgaWYgKHRoaXMucG9zID49IHRoaXMuaW5wdXQubGVuZ3RoKSB7IHRoaXMucmFpc2Uoc3RhcnQsIFwiVW50ZXJtaW5hdGVkIHJlZ3VsYXIgZXhwcmVzc2lvblwiKTsgfVxuICAgIHZhciBjaCA9IHRoaXMuaW5wdXQuY2hhckF0KHRoaXMucG9zKTtcbiAgICBpZiAobGluZUJyZWFrLnRlc3QoY2gpKSB7IHRoaXMucmFpc2Uoc3RhcnQsIFwiVW50ZXJtaW5hdGVkIHJlZ3VsYXIgZXhwcmVzc2lvblwiKTsgfVxuICAgIGlmICghZXNjYXBlZCkge1xuICAgICAgaWYgKGNoID09PSBcIltcIikgeyBpbkNsYXNzID0gdHJ1ZTsgfVxuICAgICAgZWxzZSBpZiAoY2ggPT09IFwiXVwiICYmIGluQ2xhc3MpIHsgaW5DbGFzcyA9IGZhbHNlOyB9XG4gICAgICBlbHNlIGlmIChjaCA9PT0gXCIvXCIgJiYgIWluQ2xhc3MpIHsgYnJlYWsgfVxuICAgICAgZXNjYXBlZCA9IGNoID09PSBcIlxcXFxcIjtcbiAgICB9IGVsc2UgeyBlc2NhcGVkID0gZmFsc2U7IH1cbiAgICArK3RoaXMucG9zO1xuICB9XG4gIHZhciBwYXR0ZXJuID0gdGhpcy5pbnB1dC5zbGljZShzdGFydCwgdGhpcy5wb3MpO1xuICArK3RoaXMucG9zO1xuICB2YXIgZmxhZ3NTdGFydCA9IHRoaXMucG9zO1xuICB2YXIgZmxhZ3MgPSB0aGlzLnJlYWRXb3JkMSgpO1xuICBpZiAodGhpcy5jb250YWluc0VzYykgeyB0aGlzLnVuZXhwZWN0ZWQoZmxhZ3NTdGFydCk7IH1cblxuICAvLyBWYWxpZGF0ZSBwYXR0ZXJuXG4gIHZhciBzdGF0ZSA9IHRoaXMucmVnZXhwU3RhdGUgfHwgKHRoaXMucmVnZXhwU3RhdGUgPSBuZXcgUmVnRXhwVmFsaWRhdGlvblN0YXRlKHRoaXMpKTtcbiAgc3RhdGUucmVzZXQoc3RhcnQsIHBhdHRlcm4sIGZsYWdzKTtcbiAgdGhpcy52YWxpZGF0ZVJlZ0V4cEZsYWdzKHN0YXRlKTtcbiAgdGhpcy52YWxpZGF0ZVJlZ0V4cFBhdHRlcm4oc3RhdGUpO1xuXG4gIC8vIENyZWF0ZSBMaXRlcmFsI3ZhbHVlIHByb3BlcnR5IHZhbHVlLlxuICB2YXIgdmFsdWUgPSBudWxsO1xuICB0cnkge1xuICAgIHZhbHVlID0gbmV3IFJlZ0V4cChwYXR0ZXJuLCBmbGFncyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBFU1RyZWUgcmVxdWlyZXMgbnVsbCBpZiBpdCBmYWlsZWQgdG8gaW5zdGFudGlhdGUgUmVnRXhwIG9iamVjdC5cbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZXN0cmVlL2VzdHJlZS9ibG9iL2EyNzAwM2FkZjRmZDdiZmFkNDRkZTljZWYzNzJhMmVhY2Q1MjdiMWMvZXM1Lm1kI3JlZ2V4cGxpdGVyYWxcbiAgfVxuXG4gIHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEucmVnZXhwLCB7cGF0dGVybjogcGF0dGVybiwgZmxhZ3M6IGZsYWdzLCB2YWx1ZTogdmFsdWV9KVxufTtcblxuLy8gUmVhZCBhbiBpbnRlZ2VyIGluIHRoZSBnaXZlbiByYWRpeC4gUmV0dXJuIG51bGwgaWYgemVybyBkaWdpdHNcbi8vIHdlcmUgcmVhZCwgdGhlIGludGVnZXIgdmFsdWUgb3RoZXJ3aXNlLiBXaGVuIGBsZW5gIGlzIGdpdmVuLCB0aGlzXG4vLyB3aWxsIHJldHVybiBgbnVsbGAgdW5sZXNzIHRoZSBpbnRlZ2VyIGhhcyBleGFjdGx5IGBsZW5gIGRpZ2l0cy5cblxucHAucmVhZEludCA9IGZ1bmN0aW9uKHJhZGl4LCBsZW4sIG1heWJlTGVnYWN5T2N0YWxOdW1lcmljTGl0ZXJhbCkge1xuICAvLyBgbGVuYCBpcyB1c2VkIGZvciBjaGFyYWN0ZXIgZXNjYXBlIHNlcXVlbmNlcy4gSW4gdGhhdCBjYXNlLCBkaXNhbGxvdyBzZXBhcmF0b3JzLlxuICB2YXIgYWxsb3dTZXBhcmF0b3JzID0gdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDEyICYmIGxlbiA9PT0gdW5kZWZpbmVkO1xuXG4gIC8vIGBtYXliZUxlZ2FjeU9jdGFsTnVtZXJpY0xpdGVyYWxgIGlzIHRydWUgaWYgaXQgZG9lc24ndCBoYXZlIHByZWZpeCAoMHgsMG8sMGIpXG4gIC8vIGFuZCBpc24ndCBmcmFjdGlvbiBwYXJ0IG5vciBleHBvbmVudCBwYXJ0LiBJbiB0aGF0IGNhc2UsIGlmIHRoZSBmaXJzdCBkaWdpdFxuICAvLyBpcyB6ZXJvIHRoZW4gZGlzYWxsb3cgc2VwYXJhdG9ycy5cbiAgdmFyIGlzTGVnYWN5T2N0YWxOdW1lcmljTGl0ZXJhbCA9IG1heWJlTGVnYWN5T2N0YWxOdW1lcmljTGl0ZXJhbCAmJiB0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MpID09PSA0ODtcblxuICB2YXIgc3RhcnQgPSB0aGlzLnBvcywgdG90YWwgPSAwLCBsYXN0Q29kZSA9IDA7XG4gIGZvciAodmFyIGkgPSAwLCBlID0gbGVuID09IG51bGwgPyBJbmZpbml0eSA6IGxlbjsgaSA8IGU7ICsraSwgKyt0aGlzLnBvcykge1xuICAgIHZhciBjb2RlID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zKSwgdmFsID0gKHZvaWQgMCk7XG5cbiAgICBpZiAoYWxsb3dTZXBhcmF0b3JzICYmIGNvZGUgPT09IDk1KSB7XG4gICAgICBpZiAoaXNMZWdhY3lPY3RhbE51bWVyaWNMaXRlcmFsKSB7IHRoaXMucmFpc2VSZWNvdmVyYWJsZSh0aGlzLnBvcywgXCJOdW1lcmljIHNlcGFyYXRvciBpcyBub3QgYWxsb3dlZCBpbiBsZWdhY3kgb2N0YWwgbnVtZXJpYyBsaXRlcmFsc1wiKTsgfVxuICAgICAgaWYgKGxhc3RDb2RlID09PSA5NSkgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUodGhpcy5wb3MsIFwiTnVtZXJpYyBzZXBhcmF0b3IgbXVzdCBiZSBleGFjdGx5IG9uZSB1bmRlcnNjb3JlXCIpOyB9XG4gICAgICBpZiAoaSA9PT0gMCkgeyB0aGlzLnJhaXNlUmVjb3ZlcmFibGUodGhpcy5wb3MsIFwiTnVtZXJpYyBzZXBhcmF0b3IgaXMgbm90IGFsbG93ZWQgYXQgdGhlIGZpcnN0IG9mIGRpZ2l0c1wiKTsgfVxuICAgICAgbGFzdENvZGUgPSBjb2RlO1xuICAgICAgY29udGludWVcbiAgICB9XG5cbiAgICBpZiAoY29kZSA+PSA5NykgeyB2YWwgPSBjb2RlIC0gOTcgKyAxMDsgfSAvLyBhXG4gICAgZWxzZSBpZiAoY29kZSA+PSA2NSkgeyB2YWwgPSBjb2RlIC0gNjUgKyAxMDsgfSAvLyBBXG4gICAgZWxzZSBpZiAoY29kZSA+PSA0OCAmJiBjb2RlIDw9IDU3KSB7IHZhbCA9IGNvZGUgLSA0ODsgfSAvLyAwLTlcbiAgICBlbHNlIHsgdmFsID0gSW5maW5pdHk7IH1cbiAgICBpZiAodmFsID49IHJhZGl4KSB7IGJyZWFrIH1cbiAgICBsYXN0Q29kZSA9IGNvZGU7XG4gICAgdG90YWwgPSB0b3RhbCAqIHJhZGl4ICsgdmFsO1xuICB9XG5cbiAgaWYgKGFsbG93U2VwYXJhdG9ycyAmJiBsYXN0Q29kZSA9PT0gOTUpIHsgdGhpcy5yYWlzZVJlY292ZXJhYmxlKHRoaXMucG9zIC0gMSwgXCJOdW1lcmljIHNlcGFyYXRvciBpcyBub3QgYWxsb3dlZCBhdCB0aGUgbGFzdCBvZiBkaWdpdHNcIik7IH1cbiAgaWYgKHRoaXMucG9zID09PSBzdGFydCB8fCBsZW4gIT0gbnVsbCAmJiB0aGlzLnBvcyAtIHN0YXJ0ICE9PSBsZW4pIHsgcmV0dXJuIG51bGwgfVxuXG4gIHJldHVybiB0b3RhbFxufTtcblxuZnVuY3Rpb24gc3RyaW5nVG9OdW1iZXIoc3RyLCBpc0xlZ2FjeU9jdGFsTnVtZXJpY0xpdGVyYWwpIHtcbiAgaWYgKGlzTGVnYWN5T2N0YWxOdW1lcmljTGl0ZXJhbCkge1xuICAgIHJldHVybiBwYXJzZUludChzdHIsIDgpXG4gIH1cblxuICAvLyBgcGFyc2VGbG9hdCh2YWx1ZSlgIHN0b3BzIHBhcnNpbmcgYXQgdGhlIGZpcnN0IG51bWVyaWMgc2VwYXJhdG9yIHRoZW4gcmV0dXJucyBhIHdyb25nIHZhbHVlLlxuICByZXR1cm4gcGFyc2VGbG9hdChzdHIucmVwbGFjZSgvXy9nLCBcIlwiKSlcbn1cblxuZnVuY3Rpb24gc3RyaW5nVG9CaWdJbnQoc3RyKSB7XG4gIGlmICh0eXBlb2YgQmlnSW50ICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLy8gYEJpZ0ludCh2YWx1ZSlgIHRocm93cyBzeW50YXggZXJyb3IgaWYgdGhlIHN0cmluZyBjb250YWlucyBudW1lcmljIHNlcGFyYXRvcnMuXG4gIHJldHVybiBCaWdJbnQoc3RyLnJlcGxhY2UoL18vZywgXCJcIikpXG59XG5cbnBwLnJlYWRSYWRpeE51bWJlciA9IGZ1bmN0aW9uKHJhZGl4KSB7XG4gIHZhciBzdGFydCA9IHRoaXMucG9zO1xuICB0aGlzLnBvcyArPSAyOyAvLyAweFxuICB2YXIgdmFsID0gdGhpcy5yZWFkSW50KHJhZGl4KTtcbiAgaWYgKHZhbCA9PSBudWxsKSB7IHRoaXMucmFpc2UodGhpcy5zdGFydCArIDIsIFwiRXhwZWN0ZWQgbnVtYmVyIGluIHJhZGl4IFwiICsgcmFkaXgpOyB9XG4gIGlmICh0aGlzLm9wdGlvbnMuZWNtYVZlcnNpb24gPj0gMTEgJiYgdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zKSA9PT0gMTEwKSB7XG4gICAgdmFsID0gc3RyaW5nVG9CaWdJbnQodGhpcy5pbnB1dC5zbGljZShzdGFydCwgdGhpcy5wb3MpKTtcbiAgICArK3RoaXMucG9zO1xuICB9IGVsc2UgaWYgKGlzSWRlbnRpZmllclN0YXJ0KHRoaXMuZnVsbENoYXJDb2RlQXRQb3MoKSkpIHsgdGhpcy5yYWlzZSh0aGlzLnBvcywgXCJJZGVudGlmaWVyIGRpcmVjdGx5IGFmdGVyIG51bWJlclwiKTsgfVxuICByZXR1cm4gdGhpcy5maW5pc2hUb2tlbih0eXBlcyQxLm51bSwgdmFsKVxufTtcblxuLy8gUmVhZCBhbiBpbnRlZ2VyLCBvY3RhbCBpbnRlZ2VyLCBvciBmbG9hdGluZy1wb2ludCBudW1iZXIuXG5cbnBwLnJlYWROdW1iZXIgPSBmdW5jdGlvbihzdGFydHNXaXRoRG90KSB7XG4gIHZhciBzdGFydCA9IHRoaXMucG9zO1xuICBpZiAoIXN0YXJ0c1dpdGhEb3QgJiYgdGhpcy5yZWFkSW50KDEwLCB1bmRlZmluZWQsIHRydWUpID09PSBudWxsKSB7IHRoaXMucmFpc2Uoc3RhcnQsIFwiSW52YWxpZCBudW1iZXJcIik7IH1cbiAgdmFyIG9jdGFsID0gdGhpcy5wb3MgLSBzdGFydCA+PSAyICYmIHRoaXMuaW5wdXQuY2hhckNvZGVBdChzdGFydCkgPT09IDQ4O1xuICBpZiAob2N0YWwgJiYgdGhpcy5zdHJpY3QpIHsgdGhpcy5yYWlzZShzdGFydCwgXCJJbnZhbGlkIG51bWJlclwiKTsgfVxuICB2YXIgbmV4dCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyk7XG4gIGlmICghb2N0YWwgJiYgIXN0YXJ0c1dpdGhEb3QgJiYgdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDExICYmIG5leHQgPT09IDExMCkge1xuICAgIHZhciB2YWwkMSA9IHN0cmluZ1RvQmlnSW50KHRoaXMuaW5wdXQuc2xpY2Uoc3RhcnQsIHRoaXMucG9zKSk7XG4gICAgKyt0aGlzLnBvcztcbiAgICBpZiAoaXNJZGVudGlmaWVyU3RhcnQodGhpcy5mdWxsQ2hhckNvZGVBdFBvcygpKSkgeyB0aGlzLnJhaXNlKHRoaXMucG9zLCBcIklkZW50aWZpZXIgZGlyZWN0bHkgYWZ0ZXIgbnVtYmVyXCIpOyB9XG4gICAgcmV0dXJuIHRoaXMuZmluaXNoVG9rZW4odHlwZXMkMS5udW0sIHZhbCQxKVxuICB9XG4gIGlmIChvY3RhbCAmJiAvWzg5XS8udGVzdCh0aGlzLmlucHV0LnNsaWNlKHN0YXJ0LCB0aGlzLnBvcykpKSB7IG9jdGFsID0gZmFsc2U7IH1cbiAgaWYgKG5leHQgPT09IDQ2ICYmICFvY3RhbCkgeyAvLyAnLidcbiAgICArK3RoaXMucG9zO1xuICAgIHRoaXMucmVhZEludCgxMCk7XG4gICAgbmV4dCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyk7XG4gIH1cbiAgaWYgKChuZXh0ID09PSA2OSB8fCBuZXh0ID09PSAxMDEpICYmICFvY3RhbCkgeyAvLyAnZUUnXG4gICAgbmV4dCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCgrK3RoaXMucG9zKTtcbiAgICBpZiAobmV4dCA9PT0gNDMgfHwgbmV4dCA9PT0gNDUpIHsgKyt0aGlzLnBvczsgfSAvLyAnKy0nXG4gICAgaWYgKHRoaXMucmVhZEludCgxMCkgPT09IG51bGwpIHsgdGhpcy5yYWlzZShzdGFydCwgXCJJbnZhbGlkIG51bWJlclwiKTsgfVxuICB9XG4gIGlmIChpc0lkZW50aWZpZXJTdGFydCh0aGlzLmZ1bGxDaGFyQ29kZUF0UG9zKCkpKSB7IHRoaXMucmFpc2UodGhpcy5wb3MsIFwiSWRlbnRpZmllciBkaXJlY3RseSBhZnRlciBudW1iZXJcIik7IH1cblxuICB2YXIgdmFsID0gc3RyaW5nVG9OdW1iZXIodGhpcy5pbnB1dC5zbGljZShzdGFydCwgdGhpcy5wb3MpLCBvY3RhbCk7XG4gIHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEubnVtLCB2YWwpXG59O1xuXG4vLyBSZWFkIGEgc3RyaW5nIHZhbHVlLCBpbnRlcnByZXRpbmcgYmFja3NsYXNoLWVzY2FwZXMuXG5cbnBwLnJlYWRDb2RlUG9pbnQgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGNoID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zKSwgY29kZTtcblxuICBpZiAoY2ggPT09IDEyMykgeyAvLyAneydcbiAgICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uIDwgNikgeyB0aGlzLnVuZXhwZWN0ZWQoKTsgfVxuICAgIHZhciBjb2RlUG9zID0gKyt0aGlzLnBvcztcbiAgICBjb2RlID0gdGhpcy5yZWFkSGV4Q2hhcih0aGlzLmlucHV0LmluZGV4T2YoXCJ9XCIsIHRoaXMucG9zKSAtIHRoaXMucG9zKTtcbiAgICArK3RoaXMucG9zO1xuICAgIGlmIChjb2RlID4gMHgxMEZGRkYpIHsgdGhpcy5pbnZhbGlkU3RyaW5nVG9rZW4oY29kZVBvcywgXCJDb2RlIHBvaW50IG91dCBvZiBib3VuZHNcIik7IH1cbiAgfSBlbHNlIHtcbiAgICBjb2RlID0gdGhpcy5yZWFkSGV4Q2hhcig0KTtcbiAgfVxuICByZXR1cm4gY29kZVxufTtcblxucHAucmVhZFN0cmluZyA9IGZ1bmN0aW9uKHF1b3RlKSB7XG4gIHZhciBvdXQgPSBcIlwiLCBjaHVua1N0YXJ0ID0gKyt0aGlzLnBvcztcbiAgZm9yICg7Oykge1xuICAgIGlmICh0aGlzLnBvcyA+PSB0aGlzLmlucHV0Lmxlbmd0aCkgeyB0aGlzLnJhaXNlKHRoaXMuc3RhcnQsIFwiVW50ZXJtaW5hdGVkIHN0cmluZyBjb25zdGFudFwiKTsgfVxuICAgIHZhciBjaCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyk7XG4gICAgaWYgKGNoID09PSBxdW90ZSkgeyBicmVhayB9XG4gICAgaWYgKGNoID09PSA5MikgeyAvLyAnXFwnXG4gICAgICBvdXQgKz0gdGhpcy5pbnB1dC5zbGljZShjaHVua1N0YXJ0LCB0aGlzLnBvcyk7XG4gICAgICBvdXQgKz0gdGhpcy5yZWFkRXNjYXBlZENoYXIoZmFsc2UpO1xuICAgICAgY2h1bmtTdGFydCA9IHRoaXMucG9zO1xuICAgIH0gZWxzZSBpZiAoY2ggPT09IDB4MjAyOCB8fCBjaCA9PT0gMHgyMDI5KSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uIDwgMTApIHsgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIlVudGVybWluYXRlZCBzdHJpbmcgY29uc3RhbnRcIik7IH1cbiAgICAgICsrdGhpcy5wb3M7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmxvY2F0aW9ucykge1xuICAgICAgICB0aGlzLmN1ckxpbmUrKztcbiAgICAgICAgdGhpcy5saW5lU3RhcnQgPSB0aGlzLnBvcztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGlzTmV3TGluZShjaCkpIHsgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIlVudGVybWluYXRlZCBzdHJpbmcgY29uc3RhbnRcIik7IH1cbiAgICAgICsrdGhpcy5wb3M7XG4gICAgfVxuICB9XG4gIG91dCArPSB0aGlzLmlucHV0LnNsaWNlKGNodW5rU3RhcnQsIHRoaXMucG9zKyspO1xuICByZXR1cm4gdGhpcy5maW5pc2hUb2tlbih0eXBlcyQxLnN0cmluZywgb3V0KVxufTtcblxuLy8gUmVhZHMgdGVtcGxhdGUgc3RyaW5nIHRva2Vucy5cblxudmFyIElOVkFMSURfVEVNUExBVEVfRVNDQVBFX0VSUk9SID0ge307XG5cbnBwLnRyeVJlYWRUZW1wbGF0ZVRva2VuID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaW5UZW1wbGF0ZUVsZW1lbnQgPSB0cnVlO1xuICB0cnkge1xuICAgIHRoaXMucmVhZFRtcGxUb2tlbigpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAoZXJyID09PSBJTlZBTElEX1RFTVBMQVRFX0VTQ0FQRV9FUlJPUikge1xuICAgICAgdGhpcy5yZWFkSW52YWxpZFRlbXBsYXRlVG9rZW4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgZXJyXG4gICAgfVxuICB9XG5cbiAgdGhpcy5pblRlbXBsYXRlRWxlbWVudCA9IGZhbHNlO1xufTtcblxucHAuaW52YWxpZFN0cmluZ1Rva2VuID0gZnVuY3Rpb24ocG9zaXRpb24sIG1lc3NhZ2UpIHtcbiAgaWYgKHRoaXMuaW5UZW1wbGF0ZUVsZW1lbnQgJiYgdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDkpIHtcbiAgICB0aHJvdyBJTlZBTElEX1RFTVBMQVRFX0VTQ0FQRV9FUlJPUlxuICB9IGVsc2Uge1xuICAgIHRoaXMucmFpc2UocG9zaXRpb24sIG1lc3NhZ2UpO1xuICB9XG59O1xuXG5wcC5yZWFkVG1wbFRva2VuID0gZnVuY3Rpb24oKSB7XG4gIHZhciBvdXQgPSBcIlwiLCBjaHVua1N0YXJ0ID0gdGhpcy5wb3M7XG4gIGZvciAoOzspIHtcbiAgICBpZiAodGhpcy5wb3MgPj0gdGhpcy5pbnB1dC5sZW5ndGgpIHsgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIlVudGVybWluYXRlZCB0ZW1wbGF0ZVwiKTsgfVxuICAgIHZhciBjaCA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcyk7XG4gICAgaWYgKGNoID09PSA5NiB8fCBjaCA9PT0gMzYgJiYgdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zICsgMSkgPT09IDEyMykgeyAvLyAnYCcsICckeydcbiAgICAgIGlmICh0aGlzLnBvcyA9PT0gdGhpcy5zdGFydCAmJiAodGhpcy50eXBlID09PSB0eXBlcyQxLnRlbXBsYXRlIHx8IHRoaXMudHlwZSA9PT0gdHlwZXMkMS5pbnZhbGlkVGVtcGxhdGUpKSB7XG4gICAgICAgIGlmIChjaCA9PT0gMzYpIHtcbiAgICAgICAgICB0aGlzLnBvcyArPSAyO1xuICAgICAgICAgIHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEuZG9sbGFyQnJhY2VMKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICsrdGhpcy5wb3M7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZmluaXNoVG9rZW4odHlwZXMkMS5iYWNrUXVvdGUpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIG91dCArPSB0aGlzLmlucHV0LnNsaWNlKGNodW5rU3RhcnQsIHRoaXMucG9zKTtcbiAgICAgIHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEudGVtcGxhdGUsIG91dClcbiAgICB9XG4gICAgaWYgKGNoID09PSA5MikgeyAvLyAnXFwnXG4gICAgICBvdXQgKz0gdGhpcy5pbnB1dC5zbGljZShjaHVua1N0YXJ0LCB0aGlzLnBvcyk7XG4gICAgICBvdXQgKz0gdGhpcy5yZWFkRXNjYXBlZENoYXIodHJ1ZSk7XG4gICAgICBjaHVua1N0YXJ0ID0gdGhpcy5wb3M7XG4gICAgfSBlbHNlIGlmIChpc05ld0xpbmUoY2gpKSB7XG4gICAgICBvdXQgKz0gdGhpcy5pbnB1dC5zbGljZShjaHVua1N0YXJ0LCB0aGlzLnBvcyk7XG4gICAgICArK3RoaXMucG9zO1xuICAgICAgc3dpdGNoIChjaCkge1xuICAgICAgY2FzZSAxMzpcbiAgICAgICAgaWYgKHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLnBvcykgPT09IDEwKSB7ICsrdGhpcy5wb3M7IH1cbiAgICAgIGNhc2UgMTA6XG4gICAgICAgIG91dCArPSBcIlxcblwiO1xuICAgICAgICBicmVha1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpO1xuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5sb2NhdGlvbnMpIHtcbiAgICAgICAgKyt0aGlzLmN1ckxpbmU7XG4gICAgICAgIHRoaXMubGluZVN0YXJ0ID0gdGhpcy5wb3M7XG4gICAgICB9XG4gICAgICBjaHVua1N0YXJ0ID0gdGhpcy5wb3M7XG4gICAgfSBlbHNlIHtcbiAgICAgICsrdGhpcy5wb3M7XG4gICAgfVxuICB9XG59O1xuXG4vLyBSZWFkcyBhIHRlbXBsYXRlIHRva2VuIHRvIHNlYXJjaCBmb3IgdGhlIGVuZCwgd2l0aG91dCB2YWxpZGF0aW5nIGFueSBlc2NhcGUgc2VxdWVuY2VzXG5wcC5yZWFkSW52YWxpZFRlbXBsYXRlVG9rZW4gPSBmdW5jdGlvbigpIHtcbiAgZm9yICg7IHRoaXMucG9zIDwgdGhpcy5pbnB1dC5sZW5ndGg7IHRoaXMucG9zKyspIHtcbiAgICBzd2l0Y2ggKHRoaXMuaW5wdXRbdGhpcy5wb3NdKSB7XG4gICAgY2FzZSBcIlxcXFxcIjpcbiAgICAgICsrdGhpcy5wb3M7XG4gICAgICBicmVha1xuXG4gICAgY2FzZSBcIiRcIjpcbiAgICAgIGlmICh0aGlzLmlucHV0W3RoaXMucG9zICsgMV0gIT09IFwie1wiKSB7XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG5cbiAgICAvLyBmYWxscyB0aHJvdWdoXG4gICAgY2FzZSBcImBcIjpcbiAgICAgIHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGVzJDEuaW52YWxpZFRlbXBsYXRlLCB0aGlzLmlucHV0LnNsaWNlKHRoaXMuc3RhcnQsIHRoaXMucG9zKSlcblxuICAgIC8vIG5vIGRlZmF1bHRcbiAgICB9XG4gIH1cbiAgdGhpcy5yYWlzZSh0aGlzLnN0YXJ0LCBcIlVudGVybWluYXRlZCB0ZW1wbGF0ZVwiKTtcbn07XG5cbi8vIFVzZWQgdG8gcmVhZCBlc2NhcGVkIGNoYXJhY3RlcnNcblxucHAucmVhZEVzY2FwZWRDaGFyID0gZnVuY3Rpb24oaW5UZW1wbGF0ZSkge1xuICB2YXIgY2ggPSB0aGlzLmlucHV0LmNoYXJDb2RlQXQoKyt0aGlzLnBvcyk7XG4gICsrdGhpcy5wb3M7XG4gIHN3aXRjaCAoY2gpIHtcbiAgY2FzZSAxMTA6IHJldHVybiBcIlxcblwiIC8vICduJyAtPiAnXFxuJ1xuICBjYXNlIDExNDogcmV0dXJuIFwiXFxyXCIgLy8gJ3InIC0+ICdcXHInXG4gIGNhc2UgMTIwOiByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSh0aGlzLnJlYWRIZXhDaGFyKDIpKSAvLyAneCdcbiAgY2FzZSAxMTc6IHJldHVybiBjb2RlUG9pbnRUb1N0cmluZyh0aGlzLnJlYWRDb2RlUG9pbnQoKSkgLy8gJ3UnXG4gIGNhc2UgMTE2OiByZXR1cm4gXCJcXHRcIiAvLyAndCcgLT4gJ1xcdCdcbiAgY2FzZSA5ODogcmV0dXJuIFwiXFxiXCIgLy8gJ2InIC0+ICdcXGInXG4gIGNhc2UgMTE4OiByZXR1cm4gXCJcXHUwMDBiXCIgLy8gJ3YnIC0+ICdcXHUwMDBiJ1xuICBjYXNlIDEwMjogcmV0dXJuIFwiXFxmXCIgLy8gJ2YnIC0+ICdcXGYnXG4gIGNhc2UgMTM6IGlmICh0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wb3MpID09PSAxMCkgeyArK3RoaXMucG9zOyB9IC8vICdcXHJcXG4nXG4gIGNhc2UgMTA6IC8vICcgXFxuJ1xuICAgIGlmICh0aGlzLm9wdGlvbnMubG9jYXRpb25zKSB7IHRoaXMubGluZVN0YXJ0ID0gdGhpcy5wb3M7ICsrdGhpcy5jdXJMaW5lOyB9XG4gICAgcmV0dXJuIFwiXCJcbiAgY2FzZSA1NjpcbiAgY2FzZSA1NzpcbiAgICBpZiAodGhpcy5zdHJpY3QpIHtcbiAgICAgIHRoaXMuaW52YWxpZFN0cmluZ1Rva2VuKFxuICAgICAgICB0aGlzLnBvcyAtIDEsXG4gICAgICAgIFwiSW52YWxpZCBlc2NhcGUgc2VxdWVuY2VcIlxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKGluVGVtcGxhdGUpIHtcbiAgICAgIHZhciBjb2RlUG9zID0gdGhpcy5wb3MgLSAxO1xuXG4gICAgICB0aGlzLmludmFsaWRTdHJpbmdUb2tlbihcbiAgICAgICAgY29kZVBvcyxcbiAgICAgICAgXCJJbnZhbGlkIGVzY2FwZSBzZXF1ZW5jZSBpbiB0ZW1wbGF0ZSBzdHJpbmdcIlxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIGRlZmF1bHQ6XG4gICAgaWYgKGNoID49IDQ4ICYmIGNoIDw9IDU1KSB7XG4gICAgICB2YXIgb2N0YWxTdHIgPSB0aGlzLmlucHV0LnN1YnN0cih0aGlzLnBvcyAtIDEsIDMpLm1hdGNoKC9eWzAtN10rLylbMF07XG4gICAgICB2YXIgb2N0YWwgPSBwYXJzZUludChvY3RhbFN0ciwgOCk7XG4gICAgICBpZiAob2N0YWwgPiAyNTUpIHtcbiAgICAgICAgb2N0YWxTdHIgPSBvY3RhbFN0ci5zbGljZSgwLCAtMSk7XG4gICAgICAgIG9jdGFsID0gcGFyc2VJbnQob2N0YWxTdHIsIDgpO1xuICAgICAgfVxuICAgICAgdGhpcy5wb3MgKz0gb2N0YWxTdHIubGVuZ3RoIC0gMTtcbiAgICAgIGNoID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMucG9zKTtcbiAgICAgIGlmICgob2N0YWxTdHIgIT09IFwiMFwiIHx8IGNoID09PSA1NiB8fCBjaCA9PT0gNTcpICYmICh0aGlzLnN0cmljdCB8fCBpblRlbXBsYXRlKSkge1xuICAgICAgICB0aGlzLmludmFsaWRTdHJpbmdUb2tlbihcbiAgICAgICAgICB0aGlzLnBvcyAtIDEgLSBvY3RhbFN0ci5sZW5ndGgsXG4gICAgICAgICAgaW5UZW1wbGF0ZVxuICAgICAgICAgICAgPyBcIk9jdGFsIGxpdGVyYWwgaW4gdGVtcGxhdGUgc3RyaW5nXCJcbiAgICAgICAgICAgIDogXCJPY3RhbCBsaXRlcmFsIGluIHN0cmljdCBtb2RlXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKG9jdGFsKVxuICAgIH1cbiAgICBpZiAoaXNOZXdMaW5lKGNoKSkge1xuICAgICAgLy8gVW5pY29kZSBuZXcgbGluZSBjaGFyYWN0ZXJzIGFmdGVyIFxcIGdldCByZW1vdmVkIGZyb20gb3V0cHV0IGluIGJvdGhcbiAgICAgIC8vIHRlbXBsYXRlIGxpdGVyYWxzIGFuZCBzdHJpbmdzXG4gICAgICByZXR1cm4gXCJcIlxuICAgIH1cbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaClcbiAgfVxufTtcblxuLy8gVXNlZCB0byByZWFkIGNoYXJhY3RlciBlc2NhcGUgc2VxdWVuY2VzICgnXFx4JywgJ1xcdScsICdcXFUnKS5cblxucHAucmVhZEhleENoYXIgPSBmdW5jdGlvbihsZW4pIHtcbiAgdmFyIGNvZGVQb3MgPSB0aGlzLnBvcztcbiAgdmFyIG4gPSB0aGlzLnJlYWRJbnQoMTYsIGxlbik7XG4gIGlmIChuID09PSBudWxsKSB7IHRoaXMuaW52YWxpZFN0cmluZ1Rva2VuKGNvZGVQb3MsIFwiQmFkIGNoYXJhY3RlciBlc2NhcGUgc2VxdWVuY2VcIik7IH1cbiAgcmV0dXJuIG5cbn07XG5cbi8vIFJlYWQgYW4gaWRlbnRpZmllciwgYW5kIHJldHVybiBpdCBhcyBhIHN0cmluZy4gU2V0cyBgdGhpcy5jb250YWluc0VzY2Bcbi8vIHRvIHdoZXRoZXIgdGhlIHdvcmQgY29udGFpbmVkIGEgJ1xcdScgZXNjYXBlLlxuLy9cbi8vIEluY3JlbWVudGFsbHkgYWRkcyBvbmx5IGVzY2FwZWQgY2hhcnMsIGFkZGluZyBvdGhlciBjaHVua3MgYXMtaXNcbi8vIGFzIGEgbWljcm8tb3B0aW1pemF0aW9uLlxuXG5wcC5yZWFkV29yZDEgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jb250YWluc0VzYyA9IGZhbHNlO1xuICB2YXIgd29yZCA9IFwiXCIsIGZpcnN0ID0gdHJ1ZSwgY2h1bmtTdGFydCA9IHRoaXMucG9zO1xuICB2YXIgYXN0cmFsID0gdGhpcy5vcHRpb25zLmVjbWFWZXJzaW9uID49IDY7XG4gIHdoaWxlICh0aGlzLnBvcyA8IHRoaXMuaW5wdXQubGVuZ3RoKSB7XG4gICAgdmFyIGNoID0gdGhpcy5mdWxsQ2hhckNvZGVBdFBvcygpO1xuICAgIGlmIChpc0lkZW50aWZpZXJDaGFyKGNoLCBhc3RyYWwpKSB7XG4gICAgICB0aGlzLnBvcyArPSBjaCA8PSAweGZmZmYgPyAxIDogMjtcbiAgICB9IGVsc2UgaWYgKGNoID09PSA5MikgeyAvLyBcIlxcXCJcbiAgICAgIHRoaXMuY29udGFpbnNFc2MgPSB0cnVlO1xuICAgICAgd29yZCArPSB0aGlzLmlucHV0LnNsaWNlKGNodW5rU3RhcnQsIHRoaXMucG9zKTtcbiAgICAgIHZhciBlc2NTdGFydCA9IHRoaXMucG9zO1xuICAgICAgaWYgKHRoaXMuaW5wdXQuY2hhckNvZGVBdCgrK3RoaXMucG9zKSAhPT0gMTE3KSAvLyBcInVcIlxuICAgICAgICB7IHRoaXMuaW52YWxpZFN0cmluZ1Rva2VuKHRoaXMucG9zLCBcIkV4cGVjdGluZyBVbmljb2RlIGVzY2FwZSBzZXF1ZW5jZSBcXFxcdVhYWFhcIik7IH1cbiAgICAgICsrdGhpcy5wb3M7XG4gICAgICB2YXIgZXNjID0gdGhpcy5yZWFkQ29kZVBvaW50KCk7XG4gICAgICBpZiAoIShmaXJzdCA/IGlzSWRlbnRpZmllclN0YXJ0IDogaXNJZGVudGlmaWVyQ2hhcikoZXNjLCBhc3RyYWwpKVxuICAgICAgICB7IHRoaXMuaW52YWxpZFN0cmluZ1Rva2VuKGVzY1N0YXJ0LCBcIkludmFsaWQgVW5pY29kZSBlc2NhcGVcIik7IH1cbiAgICAgIHdvcmQgKz0gY29kZVBvaW50VG9TdHJpbmcoZXNjKTtcbiAgICAgIGNodW5rU3RhcnQgPSB0aGlzLnBvcztcbiAgICB9IGVsc2Uge1xuICAgICAgYnJlYWtcbiAgICB9XG4gICAgZmlyc3QgPSBmYWxzZTtcbiAgfVxuICByZXR1cm4gd29yZCArIHRoaXMuaW5wdXQuc2xpY2UoY2h1bmtTdGFydCwgdGhpcy5wb3MpXG59O1xuXG4vLyBSZWFkIGFuIGlkZW50aWZpZXIgb3Iga2V5d29yZCB0b2tlbi4gV2lsbCBjaGVjayBmb3IgcmVzZXJ2ZWRcbi8vIHdvcmRzIHdoZW4gbmVjZXNzYXJ5LlxuXG5wcC5yZWFkV29yZCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgd29yZCA9IHRoaXMucmVhZFdvcmQxKCk7XG4gIHZhciB0eXBlID0gdHlwZXMkMS5uYW1lO1xuICBpZiAodGhpcy5rZXl3b3Jkcy50ZXN0KHdvcmQpKSB7XG4gICAgdHlwZSA9IGtleXdvcmRzW3dvcmRdO1xuICB9XG4gIHJldHVybiB0aGlzLmZpbmlzaFRva2VuKHR5cGUsIHdvcmQpXG59O1xuXG4vLyBBY29ybiBpcyBhIHRpbnksIGZhc3QgSmF2YVNjcmlwdCBwYXJzZXIgd3JpdHRlbiBpbiBKYXZhU2NyaXB0LlxuXG52YXIgdmVyc2lvbiA9IFwiOC43LjFcIjtcblxuUGFyc2VyLmFjb3JuID0ge1xuICBQYXJzZXI6IFBhcnNlcixcbiAgdmVyc2lvbjogdmVyc2lvbixcbiAgZGVmYXVsdE9wdGlvbnM6IGRlZmF1bHRPcHRpb25zLFxuICBQb3NpdGlvbjogUG9zaXRpb24sXG4gIFNvdXJjZUxvY2F0aW9uOiBTb3VyY2VMb2NhdGlvbixcbiAgZ2V0TGluZUluZm86IGdldExpbmVJbmZvLFxuICBOb2RlOiBOb2RlLFxuICBUb2tlblR5cGU6IFRva2VuVHlwZSxcbiAgdG9rVHlwZXM6IHR5cGVzJDEsXG4gIGtleXdvcmRUeXBlczoga2V5d29yZHMsXG4gIFRva0NvbnRleHQ6IFRva0NvbnRleHQsXG4gIHRva0NvbnRleHRzOiB0eXBlcyxcbiAgaXNJZGVudGlmaWVyQ2hhcjogaXNJZGVudGlmaWVyQ2hhcixcbiAgaXNJZGVudGlmaWVyU3RhcnQ6IGlzSWRlbnRpZmllclN0YXJ0LFxuICBUb2tlbjogVG9rZW4sXG4gIGlzTmV3TGluZTogaXNOZXdMaW5lLFxuICBsaW5lQnJlYWs6IGxpbmVCcmVhayxcbiAgbGluZUJyZWFrRzogbGluZUJyZWFrRyxcbiAgbm9uQVNDSUl3aGl0ZXNwYWNlOiBub25BU0NJSXdoaXRlc3BhY2Vcbn07XG5cbi8vIFRoZSBtYWluIGV4cG9ydGVkIGludGVyZmFjZSAodW5kZXIgYHNlbGYuYWNvcm5gIHdoZW4gaW4gdGhlXG4vLyBicm93c2VyKSBpcyBhIGBwYXJzZWAgZnVuY3Rpb24gdGhhdCB0YWtlcyBhIGNvZGUgc3RyaW5nIGFuZFxuLy8gcmV0dXJucyBhbiBhYnN0cmFjdCBzeW50YXggdHJlZSBhcyBzcGVjaWZpZWQgYnkgW01vemlsbGEgcGFyc2VyXG4vLyBBUEldW2FwaV0uXG4vL1xuLy8gW2FwaV06IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvU3BpZGVyTW9ua2V5L1BhcnNlcl9BUElcblxuZnVuY3Rpb24gcGFyc2UoaW5wdXQsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIFBhcnNlci5wYXJzZShpbnB1dCwgb3B0aW9ucylcbn1cblxuLy8gVGhpcyBmdW5jdGlvbiB0cmllcyB0byBwYXJzZSBhIHNpbmdsZSBleHByZXNzaW9uIGF0IGEgZ2l2ZW5cbi8vIG9mZnNldCBpbiBhIHN0cmluZy4gVXNlZnVsIGZvciBwYXJzaW5nIG1peGVkLWxhbmd1YWdlIGZvcm1hdHNcbi8vIHRoYXQgZW1iZWQgSmF2YVNjcmlwdCBleHByZXNzaW9ucy5cblxuZnVuY3Rpb24gcGFyc2VFeHByZXNzaW9uQXQoaW5wdXQsIHBvcywgb3B0aW9ucykge1xuICByZXR1cm4gUGFyc2VyLnBhcnNlRXhwcmVzc2lvbkF0KGlucHV0LCBwb3MsIG9wdGlvbnMpXG59XG5cbmZ1bmN0aW9uIGZsYXR0ZW4obm9kZXMsIHRhcmdldCA9IFtdKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KG5vZGUpKSB7XG4gICAgICAgICAgICBmbGF0dGVuKG5vZGUsIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXQucHVzaChub2RlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuXG5jb25zdCByZWdleF93aGl0ZXNwYWNlID0gL1xccy87XG5jb25zdCByZWdleF93aGl0ZXNwYWNlcyA9IC9cXHMrLztcbmNvbnN0IHJlZ2V4X3N0YXJ0c193aXRoX3doaXRlc3BhY2UgPSAvXlxccy87XG5jb25zdCByZWdleF9zdGFydHNfd2l0aF93aGl0ZXNwYWNlcyA9IC9eWyBcXHRcXHJcXG5dKi87XG5jb25zdCByZWdleF9lbmRzX3dpdGhfd2hpdGVzcGFjZSA9IC9cXHMkLztcbmNvbnN0IHJlZ2V4X2VuZHNfd2l0aF93aGl0ZXNwYWNlcyA9IC9bIFxcdFxcclxcbl0qJC87XG5jb25zdCByZWdleF9vbmx5X3doaXRlc3BhY2VzID0gL15cXHMrJC87XG5jb25zdCByZWdleF93aGl0ZXNwYWNlX2NoYXJhY3RlcnMgPSAvXFxzL2c7XG5jb25zdCByZWdleF9ub25fd2hpdGVzcGFjZV9jaGFyYWN0ZXIgPSAvXFxTLztcbmNvbnN0IHJlZ2V4X3N0YXJ0c193aXRoX25ld2xpbmUgPSAvXlxccj9cXG4vO1xuY29uc3QgcmVnZXhfbm90X25ld2xpbmVfY2hhcmFjdGVycyA9IC9bXlxcbl0vZztcbmNvbnN0IHJlZ2V4X2RvdWJsZV9xdW90ZXMgPSAvXCIvZztcbmNvbnN0IHJlZ2V4X2JhY2tzbGFzaGVzID0gL1xcXFwvZztcbmNvbnN0IHJlZ2V4X3N0YXJ0c193aXRoX3VuZGVyc2NvcmUgPSAvXl8vO1xuY29uc3QgcmVnZXhfZW5kc193aXRoX3VuZGVyc2NvcmUgPSAvXyQvO1xuY29uc3QgcmVnZXhfZGltZW5zaW9ucyA9IC9eKD86b2Zmc2V0fGNsaWVudCkoPzpXaWR0aHxIZWlnaHQpJC87XG5cbmNvbnN0IHJlZ2V4X3N2ZWx0ZV9pZ25vcmUgPSAvXlxccypzdmVsdGUtaWdub3JlXFxzKyhbXFxzXFxTXSspXFxzKiQvbTtcbmZ1bmN0aW9uIGV4dHJhY3Rfc3ZlbHRlX2lnbm9yZSh0ZXh0KSB7XG4gICAgY29uc3QgbWF0Y2ggPSByZWdleF9zdmVsdGVfaWdub3JlLmV4ZWModGV4dCk7XG4gICAgcmV0dXJuIG1hdGNoID8gbWF0Y2hbMV0uc3BsaXQocmVnZXhfd2hpdGVzcGFjZSkubWFwKHggPT4geC50cmltKCkpLmZpbHRlcihCb29sZWFuKSA6IFtdO1xufVxuZnVuY3Rpb24gZXh0cmFjdF9zdmVsdGVfaWdub3JlX2Zyb21fY29tbWVudHMobm9kZSkge1xuICAgIHJldHVybiBmbGF0dGVuKChub2RlLmxlYWRpbmdDb21tZW50cyB8fCBbXSkubWFwKGNvbW1lbnQgPT4gZXh0cmFjdF9zdmVsdGVfaWdub3JlKGNvbW1lbnQudmFsdWUpKSk7XG59XG5mdW5jdGlvbiBleHRyYWN0X2lnbm9yZXNfYWJvdmVfcG9zaXRpb24ocG9zaXRpb24sIHRlbXBsYXRlX25vZGVzKSB7XG4gICAgY29uc3QgcHJldmlvdXNfbm9kZV9pZHggPSB0ZW1wbGF0ZV9ub2Rlcy5maW5kSW5kZXgoY2hpbGQgPT4gY2hpbGQuZW5kID09PSBwb3NpdGlvbik7XG4gICAgaWYgKHByZXZpb3VzX25vZGVfaWR4ID09PSAtMSkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSBwcmV2aW91c19ub2RlX2lkeDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHRlbXBsYXRlX25vZGVzW2ldO1xuICAgICAgICBpZiAobm9kZS50eXBlICE9PSAnQ29tbWVudCcgJiYgbm9kZS50eXBlICE9PSAnVGV4dCcpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZS50eXBlID09PSAnQ29tbWVudCcpIHtcbiAgICAgICAgICAgIGlmIChub2RlLmlnbm9yZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuaWdub3JlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gW107XG59XG5cbmZ1bmN0aW9uIGZ1enp5bWF0Y2gobmFtZSwgbmFtZXMpIHtcbiAgICBjb25zdCBzZXQgPSBuZXcgRnV6enlTZXQobmFtZXMpO1xuICAgIGNvbnN0IG1hdGNoZXMgPSBzZXQuZ2V0KG5hbWUpO1xuICAgIHJldHVybiBtYXRjaGVzICYmIG1hdGNoZXNbMF0gJiYgbWF0Y2hlc1swXVswXSA+IDAuNyA/IG1hdGNoZXNbMF1bMV0gOiBudWxsO1xufVxuLy8gYWRhcHRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9HbGVuY2gvZnV6enlzZXQuanMvYmxvYi9tYXN0ZXIvbGliL2Z1enp5c2V0LmpzXG4vLyBCU0QgTGljZW5zZWRcbmNvbnN0IEdSQU1fU0laRV9MT1dFUiA9IDI7XG5jb25zdCBHUkFNX1NJWkVfVVBQRVIgPSAzO1xuLy8gcmV0dXJuIGFuIGVkaXQgZGlzdGFuY2UgZnJvbSAwIHRvIDFcbmZ1bmN0aW9uIF9kaXN0YW5jZShzdHIxLCBzdHIyKSB7XG4gICAgaWYgKHN0cjEgPT09IG51bGwgJiYgc3RyMiA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyAnVHJ5aW5nIHRvIGNvbXBhcmUgdHdvIG51bGwgdmFsdWVzJztcbiAgICB9XG4gICAgaWYgKHN0cjEgPT09IG51bGwgfHwgc3RyMiA9PT0gbnVsbClcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgc3RyMSA9IFN0cmluZyhzdHIxKTtcbiAgICBzdHIyID0gU3RyaW5nKHN0cjIpO1xuICAgIGNvbnN0IGRpc3RhbmNlID0gbGV2ZW5zaHRlaW4oc3RyMSwgc3RyMik7XG4gICAgaWYgKHN0cjEubGVuZ3RoID4gc3RyMi5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIDEgLSBkaXN0YW5jZSAvIHN0cjEubGVuZ3RoO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIDEgLSBkaXN0YW5jZSAvIHN0cjIubGVuZ3RoO1xuICAgIH1cbn1cbi8vIGhlbHBlciBmdW5jdGlvbnNcbmZ1bmN0aW9uIGxldmVuc2h0ZWluKHN0cjEsIHN0cjIpIHtcbiAgICBjb25zdCBjdXJyZW50ID0gW107XG4gICAgbGV0IHByZXY7XG4gICAgbGV0IHZhbHVlO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHN0cjIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPD0gc3RyMS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgaWYgKGkgJiYgaikge1xuICAgICAgICAgICAgICAgIGlmIChzdHIxLmNoYXJBdChqIC0gMSkgPT09IHN0cjIuY2hhckF0KGkgLSAxKSkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHByZXY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IE1hdGgubWluKGN1cnJlbnRbal0sIGN1cnJlbnRbaiAtIDFdLCBwcmV2KSArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBpICsgajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByZXYgPSBjdXJyZW50W2pdO1xuICAgICAgICAgICAgY3VycmVudFtqXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjdXJyZW50LnBvcCgpO1xufVxuY29uc3Qgbm9uX3dvcmRfcmVnZXggPSAvW15cXHcsIF0rLztcbmZ1bmN0aW9uIGl0ZXJhdGVfZ3JhbXModmFsdWUsIGdyYW1fc2l6ZSA9IDIpIHtcbiAgICBjb25zdCBzaW1wbGlmaWVkID0gJy0nICsgdmFsdWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKG5vbl93b3JkX3JlZ2V4LCAnJykgKyAnLSc7XG4gICAgY29uc3QgbGVuX2RpZmYgPSBncmFtX3NpemUgLSBzaW1wbGlmaWVkLmxlbmd0aDtcbiAgICBjb25zdCByZXN1bHRzID0gW107XG4gICAgaWYgKGxlbl9kaWZmID4gMCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbl9kaWZmOyArK2kpIHtcbiAgICAgICAgICAgIHZhbHVlICs9ICctJztcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpbXBsaWZpZWQubGVuZ3RoIC0gZ3JhbV9zaXplICsgMTsgKytpKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaChzaW1wbGlmaWVkLnNsaWNlKGksIGkgKyBncmFtX3NpemUpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHM7XG59XG5mdW5jdGlvbiBncmFtX2NvdW50ZXIodmFsdWUsIGdyYW1fc2l6ZSA9IDIpIHtcbiAgICAvLyByZXR1cm4gYW4gb2JqZWN0IHdoZXJlIGtleT1ncmFtLCB2YWx1ZT1udW1iZXIgb2Ygb2NjdXJyZW5jZXNcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBjb25zdCBncmFtcyA9IGl0ZXJhdGVfZ3JhbXModmFsdWUsIGdyYW1fc2l6ZSk7XG4gICAgbGV0IGkgPSAwO1xuICAgIGZvciAoaTsgaSA8IGdyYW1zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGlmIChncmFtc1tpXSBpbiByZXN1bHQpIHtcbiAgICAgICAgICAgIHJlc3VsdFtncmFtc1tpXV0gKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdFtncmFtc1tpXV0gPSAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBzb3J0X2Rlc2NlbmRpbmcoYSwgYikge1xuICAgIHJldHVybiBiWzBdIC0gYVswXTtcbn1cbmNsYXNzIEZ1enp5U2V0IHtcbiAgICBjb25zdHJ1Y3RvcihhcnIpIHtcbiAgICAgICAgdGhpcy5leGFjdF9zZXQgPSB7fTtcbiAgICAgICAgdGhpcy5tYXRjaF9kaWN0ID0ge307XG4gICAgICAgIHRoaXMuaXRlbXMgPSB7fTtcbiAgICAgICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICAgICAgZm9yIChsZXQgaSA9IEdSQU1fU0laRV9MT1dFUjsgaSA8IEdSQU1fU0laRV9VUFBFUiArIDE7ICsraSkge1xuICAgICAgICAgICAgdGhpcy5pdGVtc1tpXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGFkZCBhbGwgdGhlIGl0ZW1zIHRvIHRoZSBzZXRcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkKGFycltpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRfdmFsdWUgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAobm9ybWFsaXplZF92YWx1ZSBpbiB0aGlzLmV4YWN0X3NldCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBpID0gR1JBTV9TSVpFX0xPV0VSO1xuICAgICAgICBmb3IgKGk7IGkgPCBHUkFNX1NJWkVfVVBQRVIgKyAxOyArK2kpIHtcbiAgICAgICAgICAgIHRoaXMuX2FkZCh2YWx1ZSwgaSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2FkZCh2YWx1ZSwgZ3JhbV9zaXplKSB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRfdmFsdWUgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBpdGVtcyA9IHRoaXMuaXRlbXNbZ3JhbV9zaXplXSB8fCBbXTtcbiAgICAgICAgY29uc3QgaW5kZXggPSBpdGVtcy5sZW5ndGg7XG4gICAgICAgIGl0ZW1zLnB1c2goMCk7XG4gICAgICAgIGNvbnN0IGdyYW1fY291bnRzID0gZ3JhbV9jb3VudGVyKG5vcm1hbGl6ZWRfdmFsdWUsIGdyYW1fc2l6ZSk7XG4gICAgICAgIGxldCBzdW1fb2Zfc3F1YXJlX2dyYW1fY291bnRzID0gMDtcbiAgICAgICAgbGV0IGdyYW07XG4gICAgICAgIGxldCBncmFtX2NvdW50O1xuICAgICAgICBmb3IgKGdyYW0gaW4gZ3JhbV9jb3VudHMpIHtcbiAgICAgICAgICAgIGdyYW1fY291bnQgPSBncmFtX2NvdW50c1tncmFtXTtcbiAgICAgICAgICAgIHN1bV9vZl9zcXVhcmVfZ3JhbV9jb3VudHMgKz0gTWF0aC5wb3coZ3JhbV9jb3VudCwgMik7XG4gICAgICAgICAgICBpZiAoZ3JhbSBpbiB0aGlzLm1hdGNoX2RpY3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1hdGNoX2RpY3RbZ3JhbV0ucHVzaChbaW5kZXgsIGdyYW1fY291bnRdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hfZGljdFtncmFtXSA9IFtbaW5kZXgsIGdyYW1fY291bnRdXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCB2ZWN0b3Jfbm9ybWFsID0gTWF0aC5zcXJ0KHN1bV9vZl9zcXVhcmVfZ3JhbV9jb3VudHMpO1xuICAgICAgICBpdGVtc1tpbmRleF0gPSBbdmVjdG9yX25vcm1hbCwgbm9ybWFsaXplZF92YWx1ZV07XG4gICAgICAgIHRoaXMuaXRlbXNbZ3JhbV9zaXplXSA9IGl0ZW1zO1xuICAgICAgICB0aGlzLmV4YWN0X3NldFtub3JtYWxpemVkX3ZhbHVlXSA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZF92YWx1ZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuZXhhY3Rfc2V0W25vcm1hbGl6ZWRfdmFsdWVdO1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gW1sxLCByZXN1bHRdXTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0cyA9IFtdO1xuICAgICAgICAvLyBzdGFydCB3aXRoIGhpZ2ggZ3JhbSBzaXplIGFuZCBpZiB0aGVyZSBhcmUgbm8gcmVzdWx0cywgZ28gdG8gbG93ZXIgZ3JhbSBzaXplc1xuICAgICAgICBmb3IgKGxldCBncmFtX3NpemUgPSBHUkFNX1NJWkVfVVBQRVI7IGdyYW1fc2l6ZSA+PSBHUkFNX1NJWkVfTE9XRVI7IC0tZ3JhbV9zaXplKSB7XG4gICAgICAgICAgICByZXN1bHRzID0gdGhpcy5fX2dldCh2YWx1ZSwgZ3JhbV9zaXplKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIF9fZ2V0KHZhbHVlLCBncmFtX3NpemUpIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZF92YWx1ZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSB7fTtcbiAgICAgICAgY29uc3QgZ3JhbV9jb3VudHMgPSBncmFtX2NvdW50ZXIobm9ybWFsaXplZF92YWx1ZSwgZ3JhbV9zaXplKTtcbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLml0ZW1zW2dyYW1fc2l6ZV07XG4gICAgICAgIGxldCBzdW1fb2Zfc3F1YXJlX2dyYW1fY291bnRzID0gMDtcbiAgICAgICAgbGV0IGdyYW07XG4gICAgICAgIGxldCBncmFtX2NvdW50O1xuICAgICAgICBsZXQgaTtcbiAgICAgICAgbGV0IGluZGV4O1xuICAgICAgICBsZXQgb3RoZXJfZ3JhbV9jb3VudDtcbiAgICAgICAgZm9yIChncmFtIGluIGdyYW1fY291bnRzKSB7XG4gICAgICAgICAgICBncmFtX2NvdW50ID0gZ3JhbV9jb3VudHNbZ3JhbV07XG4gICAgICAgICAgICBzdW1fb2Zfc3F1YXJlX2dyYW1fY291bnRzICs9IE1hdGgucG93KGdyYW1fY291bnQsIDIpO1xuICAgICAgICAgICAgaWYgKGdyYW0gaW4gdGhpcy5tYXRjaF9kaWN0KSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMubWF0Y2hfZGljdFtncmFtXS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IHRoaXMubWF0Y2hfZGljdFtncmFtXVtpXVswXTtcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJfZ3JhbV9jb3VudCA9IHRoaXMubWF0Y2hfZGljdFtncmFtXVtpXVsxXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4IGluIG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXNbaW5kZXhdICs9IGdyYW1fY291bnQgKiBvdGhlcl9ncmFtX2NvdW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlc1tpbmRleF0gPSBncmFtX2NvdW50ICogb3RoZXJfZ3JhbV9jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCB2ZWN0b3Jfbm9ybWFsID0gTWF0aC5zcXJ0KHN1bV9vZl9zcXVhcmVfZ3JhbV9jb3VudHMpO1xuICAgICAgICBsZXQgcmVzdWx0cyA9IFtdO1xuICAgICAgICBsZXQgbWF0Y2hfc2NvcmU7XG4gICAgICAgIC8vIGJ1aWxkIGEgcmVzdWx0cyBsaXN0IG9mIFtzY29yZSwgc3RyXVxuICAgICAgICBmb3IgKGNvbnN0IG1hdGNoX2luZGV4IGluIG1hdGNoZXMpIHtcbiAgICAgICAgICAgIG1hdGNoX3Njb3JlID0gbWF0Y2hlc1ttYXRjaF9pbmRleF07XG4gICAgICAgICAgICByZXN1bHRzLnB1c2goW1xuICAgICAgICAgICAgICAgIG1hdGNoX3Njb3JlIC8gKHZlY3Rvcl9ub3JtYWwgKiBpdGVtc1ttYXRjaF9pbmRleF1bMF0pLFxuICAgICAgICAgICAgICAgIGl0ZW1zW21hdGNoX2luZGV4XVsxXVxuICAgICAgICAgICAgXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0cy5zb3J0KHNvcnRfZGVzY2VuZGluZyk7XG4gICAgICAgIGxldCBuZXdfcmVzdWx0cyA9IFtdO1xuICAgICAgICBjb25zdCBlbmRfaW5kZXggPSBNYXRoLm1pbig1MCwgcmVzdWx0cy5sZW5ndGgpO1xuICAgICAgICAvLyB0cnVuY2F0ZSBzb21ld2hhdCBhcmJpdHJhcmlseSB0byA1MFxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVuZF9pbmRleDsgKytpKSB7XG4gICAgICAgICAgICBuZXdfcmVzdWx0cy5wdXNoKFtcbiAgICAgICAgICAgICAgICBfZGlzdGFuY2UocmVzdWx0c1tpXVsxXSwgbm9ybWFsaXplZF92YWx1ZSksXG4gICAgICAgICAgICAgICAgcmVzdWx0c1tpXVsxXVxuICAgICAgICAgICAgXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0cyA9IG5ld19yZXN1bHRzO1xuICAgICAgICByZXN1bHRzLnNvcnQoc29ydF9kZXNjZW5kaW5nKTtcbiAgICAgICAgbmV3X3Jlc3VsdHMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0c1tpXVswXSA9PSByZXN1bHRzWzBdWzBdKSB7XG4gICAgICAgICAgICAgICAgbmV3X3Jlc3VsdHMucHVzaChbcmVzdWx0c1tpXVswXSwgdGhpcy5leGFjdF9zZXRbcmVzdWx0c1tpXVsxXV1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3X3Jlc3VsdHM7XG4gICAgfVxufVxuXG4vKiogcmVnZXggb2YgYWxsIGh0bWwgdm9pZCBlbGVtZW50IG5hbWVzICovXG5jb25zdCB2b2lkX2VsZW1lbnRfbmFtZXMgPSAvXig/OmFyZWF8YmFzZXxicnxjb2x8Y29tbWFuZHxlbWJlZHxocnxpbWd8aW5wdXR8a2V5Z2VufGxpbmt8bWV0YXxwYXJhbXxzb3VyY2V8dHJhY2t8d2JyKSQvO1xuLyoqIHJlZ2V4IG9mIGFsbCBodG1sIGVsZW1lbnQgbmFtZXMuIHN2ZyBhbmQgbWF0aCBhcmUgb21pdHRlZCBiZWNhdXNlIHRoZXkgYmVsb25nIHRvIHRoZSBzdmcgZWxlbWVudHMgbmFtZXNwYWNlICovXG5jb25zdCBodG1sX2VsZW1lbnRfbmFtZXMgPSAvXig/OmF8YWJicnxhZGRyZXNzfGFyZWF8YXJ0aWNsZXxhc2lkZXxhdWRpb3xifGJhc2V8YmRpfGJkb3xibG9ja3F1b3RlfGJvZHl8YnJ8YnV0dG9ufGNhbnZhc3xjYXB0aW9ufGNpdGV8Y29kZXxjb2x8Y29sZ3JvdXB8ZGF0YXxkYXRhbGlzdHxkZHxkZWx8ZGV0YWlsc3xkZm58ZGlhbG9nfGRpdnxkbHxkdHxlbXxlbWJlZHxmaWVsZHNldHxmaWdjYXB0aW9ufGZpZ3VyZXxmb290ZXJ8Zm9ybXxoMXxoMnxoM3xoNHxoNXxoNnxoZWFkfGhlYWRlcnxocnxodG1sfGl8aWZyYW1lfGltZ3xpbnB1dHxpbnN8a2JkfGxhYmVsfGxlZ2VuZHxsaXxsaW5rfG1haW58bWFwfG1hcmt8bWV0YXxtZXRlcnxuYXZ8bm9zY3JpcHR8b2JqZWN0fG9sfG9wdGdyb3VwfG9wdGlvbnxvdXRwdXR8cHxwYXJhbXxwaWN0dXJlfHByZXxwcm9ncmVzc3xxfHJwfHJ0fHJ1Ynl8c3xzYW1wfHNjcmlwdHxzZWN0aW9ufHNlbGVjdHxzbWFsbHxzb3VyY2V8c3BhbnxzdHJvbmd8c3R5bGV8c3VifHN1bW1hcnl8c3VwfHRhYmxlfHRib2R5fHRkfHRlbXBsYXRlfHRleHRhcmVhfHRmb290fHRofHRoZWFkfHRpbWV8dGl0bGV8dHJ8dHJhY2t8dXx1bHx2YXJ8dmlkZW98d2JyKSQvO1xuLyoqIHJlZ2V4IG9mIGFsbCBzdmcgZWxlbWVudCBuYW1lcyAqL1xuY29uc3Qgc3ZnID0gL14oPzphbHRHbHlwaHxhbHRHbHlwaERlZnxhbHRHbHlwaEl0ZW18YW5pbWF0ZXxhbmltYXRlQ29sb3J8YW5pbWF0ZU1vdGlvbnxhbmltYXRlVHJhbnNmb3JtfGNpcmNsZXxjbGlwUGF0aHxjb2xvci1wcm9maWxlfGN1cnNvcnxkZWZzfGRlc2N8ZGlzY2FyZHxlbGxpcHNlfGZlQmxlbmR8ZmVDb2xvck1hdHJpeHxmZUNvbXBvbmVudFRyYW5zZmVyfGZlQ29tcG9zaXRlfGZlQ29udm9sdmVNYXRyaXh8ZmVEaWZmdXNlTGlnaHRpbmd8ZmVEaXNwbGFjZW1lbnRNYXB8ZmVEaXN0YW50TGlnaHR8ZmVEcm9wU2hhZG93fGZlRmxvb2R8ZmVGdW5jQXxmZUZ1bmNCfGZlRnVuY0d8ZmVGdW5jUnxmZUdhdXNzaWFuQmx1cnxmZUltYWdlfGZlTWVyZ2V8ZmVNZXJnZU5vZGV8ZmVNb3JwaG9sb2d5fGZlT2Zmc2V0fGZlUG9pbnRMaWdodHxmZVNwZWN1bGFyTGlnaHRpbmd8ZmVTcG90TGlnaHR8ZmVUaWxlfGZlVHVyYnVsZW5jZXxmaWx0ZXJ8Zm9udHxmb250LWZhY2V8Zm9udC1mYWNlLWZvcm1hdHxmb250LWZhY2UtbmFtZXxmb250LWZhY2Utc3JjfGZvbnQtZmFjZS11cml8Zm9yZWlnbk9iamVjdHxnfGdseXBofGdseXBoUmVmfGhhdGNofGhhdGNocGF0aHxoa2VybnxpbWFnZXxsaW5lfGxpbmVhckdyYWRpZW50fG1hcmtlcnxtYXNrfG1lc2h8bWVzaGdyYWRpZW50fG1lc2hwYXRjaHxtZXNocm93fG1ldGFkYXRhfG1pc3NpbmctZ2x5cGh8bXBhdGh8cGF0aHxwYXR0ZXJufHBvbHlnb258cG9seWxpbmV8cmFkaWFsR3JhZGllbnR8cmVjdHxzZXR8c29saWRjb2xvcnxzdG9wfHN2Z3xzd2l0Y2h8c3ltYm9sfHRleHR8dGV4dFBhdGh8dHJlZnx0c3Bhbnx1bmtub3dufHVzZXx2aWV3fHZrZXJuKSQvO1xuZnVuY3Rpb24gaXNfdm9pZChuYW1lKSB7XG4gICAgcmV0dXJuIHZvaWRfZWxlbWVudF9uYW1lcy50ZXN0KG5hbWUpIHx8IG5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJyFkb2N0eXBlJztcbn1cbmZ1bmN0aW9uIGlzX2h0bWwobmFtZSkge1xuICAgIHJldHVybiBodG1sX2VsZW1lbnRfbmFtZXMudGVzdChuYW1lKTtcbn1cbmZ1bmN0aW9uIGlzX3N2ZyhuYW1lKSB7XG4gICAgcmV0dXJuIHN2Zy50ZXN0KG5hbWUpO1xufVxuXG5mdW5jdGlvbiBsaXN0JDEoaXRlbXMsIGNvbmp1bmN0aW9uID0gJ29yJykge1xuICAgIGlmIChpdGVtcy5sZW5ndGggPT09IDEpXG4gICAgICAgIHJldHVybiBpdGVtc1swXTtcbiAgICByZXR1cm4gYCR7aXRlbXMuc2xpY2UoMCwgLTEpLmpvaW4oJywgJyl9ICR7Y29uanVuY3Rpb259ICR7aXRlbXNbaXRlbXMubGVuZ3RoIC0gMV19YDtcbn1cblxuLy8gQWxsIHBhcnNlciBlcnJvcnMgc2hvdWxkIGJlIGxpc3RlZCBhbmQgYWNjZXNzZWQgZnJvbSBoZXJlXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG52YXIgcGFyc2VyX2Vycm9ycyA9IHtcbiAgICBjc3Nfc3ludGF4X2Vycm9yOiAobWVzc2FnZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ2Nzcy1zeW50YXgtZXJyb3InLFxuICAgICAgICBtZXNzYWdlXG4gICAgfSksXG4gICAgZHVwbGljYXRlX2F0dHJpYnV0ZToge1xuICAgICAgICBjb2RlOiAnZHVwbGljYXRlLWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6ICdBdHRyaWJ1dGVzIG5lZWQgdG8gYmUgdW5pcXVlJ1xuICAgIH0sXG4gICAgZHVwbGljYXRlX2VsZW1lbnQ6IChzbHVnLCBuYW1lKSA9PiAoe1xuICAgICAgICBjb2RlOiBgZHVwbGljYXRlLSR7c2x1Z31gLFxuICAgICAgICBtZXNzYWdlOiBgQSBjb21wb25lbnQgY2FuIG9ubHkgaGF2ZSBvbmUgPCR7bmFtZX0+IHRhZ2BcbiAgICB9KSxcbiAgICBkdXBsaWNhdGVfc3R5bGU6IHtcbiAgICAgICAgY29kZTogJ2R1cGxpY2F0ZS1zdHlsZScsXG4gICAgICAgIG1lc3NhZ2U6ICdZb3UgY2FuIG9ubHkgaGF2ZSBvbmUgdG9wLWxldmVsIDxzdHlsZT4gdGFnIHBlciBjb21wb25lbnQnXG4gICAgfSxcbiAgICBlbXB0eV9hdHRyaWJ1dGVfc2hvcnRoYW5kOiB7XG4gICAgICAgIGNvZGU6ICdlbXB0eS1hdHRyaWJ1dGUtc2hvcnRoYW5kJyxcbiAgICAgICAgbWVzc2FnZTogJ0F0dHJpYnV0ZSBzaG9ydGhhbmQgY2Fubm90IGJlIGVtcHR5J1xuICAgIH0sXG4gICAgZW1wdHlfZGlyZWN0aXZlX25hbWU6ICh0eXBlKSA9PiAoe1xuICAgICAgICBjb2RlOiAnZW1wdHktZGlyZWN0aXZlLW5hbWUnLFxuICAgICAgICBtZXNzYWdlOiBgJHt0eXBlfSBuYW1lIGNhbm5vdCBiZSBlbXB0eWBcbiAgICB9KSxcbiAgICBlbXB0eV9nbG9iYWxfc2VsZWN0b3I6IHtcbiAgICAgICAgY29kZTogJ2Nzcy1zeW50YXgtZXJyb3InLFxuICAgICAgICBtZXNzYWdlOiAnOmdsb2JhbCgpIG11c3QgY29udGFpbiBhIHNlbGVjdG9yJ1xuICAgIH0sXG4gICAgZXhwZWN0ZWRfYmxvY2tfdHlwZToge1xuICAgICAgICBjb2RlOiAnZXhwZWN0ZWQtYmxvY2stdHlwZScsXG4gICAgICAgIG1lc3NhZ2U6ICdFeHBlY3RlZCBpZiwgZWFjaCBvciBhd2FpdCdcbiAgICB9LFxuICAgIGV4cGVjdGVkX25hbWU6IHtcbiAgICAgICAgY29kZTogJ2V4cGVjdGVkLW5hbWUnLFxuICAgICAgICBtZXNzYWdlOiAnRXhwZWN0ZWQgbmFtZSdcbiAgICB9LFxuICAgIGludmFsaWRfY2F0Y2hfcGxhY2VtZW50X3VuY2xvc2VkX2Jsb2NrOiAoYmxvY2spID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWNhdGNoLXBsYWNlbWVudCcsXG4gICAgICAgIG1lc3NhZ2U6IGBFeHBlY3RlZCB0byBjbG9zZSAke2Jsb2NrfSBiZWZvcmUgc2VlaW5nIHs6Y2F0Y2h9IGJsb2NrYFxuICAgIH0pLFxuICAgIGludmFsaWRfY2F0Y2hfcGxhY2VtZW50X3dpdGhvdXRfYXdhaXQ6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtY2F0Y2gtcGxhY2VtZW50JyxcbiAgICAgICAgbWVzc2FnZTogJ0Nhbm5vdCBoYXZlIGFuIHs6Y2F0Y2h9IGJsb2NrIG91dHNpZGUgYW4geyNhd2FpdCAuLi59IGJsb2NrJ1xuICAgIH0sXG4gICAgaW52YWxpZF9jb21wb25lbnRfZGVmaW5pdGlvbjoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1jb21wb25lbnQtZGVmaW5pdGlvbicsXG4gICAgICAgIG1lc3NhZ2U6ICdpbnZhbGlkIGNvbXBvbmVudCBkZWZpbml0aW9uJ1xuICAgIH0sXG4gICAgaW52YWxpZF9jbG9zaW5nX3RhZ191bm9wZW5lZDogKG5hbWUpID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWNsb3NpbmctdGFnJyxcbiAgICAgICAgbWVzc2FnZTogYDwvJHtuYW1lfT4gYXR0ZW1wdGVkIHRvIGNsb3NlIGFuIGVsZW1lbnQgdGhhdCB3YXMgbm90IG9wZW5gXG4gICAgfSksXG4gICAgaW52YWxpZF9jbG9zaW5nX3RhZ19hdXRvY2xvc2VkOiAobmFtZSwgcmVhc29uKSA9PiAoe1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1jbG9zaW5nLXRhZycsXG4gICAgICAgIG1lc3NhZ2U6IGA8LyR7bmFtZX0+IGF0dGVtcHRlZCB0byBjbG9zZSA8JHtuYW1lfT4gdGhhdCB3YXMgYWxyZWFkeSBhdXRvbWF0aWNhbGx5IGNsb3NlZCBieSA8JHtyZWFzb259PmBcbiAgICB9KSxcbiAgICBpbnZhbGlkX2RlYnVnX2FyZ3M6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtZGVidWctYXJncycsXG4gICAgICAgIG1lc3NhZ2U6ICd7QGRlYnVnIC4uLn0gYXJndW1lbnRzIG11c3QgYmUgaWRlbnRpZmllcnMsIG5vdCBhcmJpdHJhcnkgZXhwcmVzc2lvbnMnXG4gICAgfSxcbiAgICBpbnZhbGlkX2RlY2xhcmF0aW9uOiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWRlY2xhcmF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogJ0RlY2xhcmF0aW9uIGNhbm5vdCBiZSBlbXB0eSdcbiAgICB9LFxuICAgIGludmFsaWRfZGlyZWN0aXZlX3ZhbHVlOiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWRpcmVjdGl2ZS12YWx1ZScsXG4gICAgICAgIG1lc3NhZ2U6ICdEaXJlY3RpdmUgdmFsdWUgbXVzdCBiZSBhIEphdmFTY3JpcHQgZXhwcmVzc2lvbiBlbmNsb3NlZCBpbiBjdXJseSBicmFjZXMnXG4gICAgfSxcbiAgICBpbnZhbGlkX2Vsc2VpZjoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1lbHNlaWYnLFxuICAgICAgICBtZXNzYWdlOiAnXFwnZWxzZWlmXFwnIHNob3VsZCBiZSBcXCdlbHNlIGlmXFwnJ1xuICAgIH0sXG4gICAgaW52YWxpZF9lbHNlaWZfcGxhY2VtZW50X291dHNpZGVfaWY6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtZWxzZWlmLXBsYWNlbWVudCcsXG4gICAgICAgIG1lc3NhZ2U6ICdDYW5ub3QgaGF2ZSBhbiB7OmVsc2UgaWYgLi4ufSBibG9jayBvdXRzaWRlIGFuIHsjaWYgLi4ufSBibG9jaydcbiAgICB9LFxuICAgIGludmFsaWRfZWxzZWlmX3BsYWNlbWVudF91bmNsb3NlZF9ibG9jazogKGJsb2NrKSA9PiAoe1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1lbHNlaWYtcGxhY2VtZW50JyxcbiAgICAgICAgbWVzc2FnZTogYEV4cGVjdGVkIHRvIGNsb3NlICR7YmxvY2t9IGJlZm9yZSBzZWVpbmcgezplbHNlIGlmIC4uLn0gYmxvY2tgXG4gICAgfSksXG4gICAgaW52YWxpZF9lbHNlX3BsYWNlbWVudF9vdXRzaWRlX2lmOiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWVsc2UtcGxhY2VtZW50JyxcbiAgICAgICAgbWVzc2FnZTogJ0Nhbm5vdCBoYXZlIGFuIHs6ZWxzZX0gYmxvY2sgb3V0c2lkZSBhbiB7I2lmIC4uLn0gb3IgeyNlYWNoIC4uLn0gYmxvY2snXG4gICAgfSxcbiAgICBpbnZhbGlkX2Vsc2VfcGxhY2VtZW50X3VuY2xvc2VkX2Jsb2NrOiAoYmxvY2spID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWVsc2UtcGxhY2VtZW50JyxcbiAgICAgICAgbWVzc2FnZTogYEV4cGVjdGVkIHRvIGNsb3NlICR7YmxvY2t9IGJlZm9yZSBzZWVpbmcgezplbHNlfSBibG9ja2BcbiAgICB9KSxcbiAgICBpbnZhbGlkX2VsZW1lbnRfY29udGVudDogKHNsdWcsIG5hbWUpID0+ICh7XG4gICAgICAgIGNvZGU6IGBpbnZhbGlkLSR7c2x1Z30tY29udGVudGAsXG4gICAgICAgIG1lc3NhZ2U6IGA8JHtuYW1lfT4gY2Fubm90IGhhdmUgY2hpbGRyZW5gXG4gICAgfSksXG4gICAgaW52YWxpZF9lbGVtZW50X2RlZmluaXRpb246IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtZWxlbWVudC1kZWZpbml0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgZWxlbWVudCBkZWZpbml0aW9uJ1xuICAgIH0sXG4gICAgaW52YWxpZF9lbGVtZW50X3BsYWNlbWVudDogKHNsdWcsIG5hbWUpID0+ICh7XG4gICAgICAgIGNvZGU6IGBpbnZhbGlkLSR7c2x1Z30tcGxhY2VtZW50YCxcbiAgICAgICAgbWVzc2FnZTogYDwke25hbWV9PiB0YWdzIGNhbm5vdCBiZSBpbnNpZGUgZWxlbWVudHMgb3IgYmxvY2tzYFxuICAgIH0pLFxuICAgIGludmFsaWRfbG9naWNfYmxvY2tfcGxhY2VtZW50OiAobG9jYXRpb24sIG5hbWUpID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWxvZ2ljLWJsb2NrLXBsYWNlbWVudCcsXG4gICAgICAgIG1lc3NhZ2U6IGB7IyR7bmFtZX19IGxvZ2ljIGJsb2NrIGNhbm5vdCBiZSAke2xvY2F0aW9ufWBcbiAgICB9KSxcbiAgICBpbnZhbGlkX3RhZ19wbGFjZW1lbnQ6IChsb2NhdGlvbiwgbmFtZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtdGFnLXBsYWNlbWVudCcsXG4gICAgICAgIG1lc3NhZ2U6IGB7QCR7bmFtZX19IHRhZyBjYW5ub3QgYmUgJHtsb2NhdGlvbn1gXG4gICAgfSksXG4gICAgaW52YWxpZF9yZWZfZGlyZWN0aXZlOiAobmFtZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtcmVmLWRpcmVjdGl2ZScsXG4gICAgICAgIG1lc3NhZ2U6IGBUaGUgcmVmIGRpcmVjdGl2ZSBpcyBubyBsb25nZXIgc3VwcG9ydGVkIOKAlCB1c2UgXFxgYmluZDp0aGlzPXske25hbWV9fVxcYCBpbnN0ZWFkYFxuICAgIH0pLFxuICAgIGludmFsaWRfcmVmX3NlbGVjdG9yOiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLXJlZi1zZWxlY3RvcicsXG4gICAgICAgIG1lc3NhZ2U6ICdyZWYgc2VsZWN0b3JzIGFyZSBubyBsb25nZXIgc3VwcG9ydGVkJ1xuICAgIH0sXG4gICAgaW52YWxpZF9zZWxmX3BsYWNlbWVudDoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1zZWxmLXBsYWNlbWVudCcsXG4gICAgICAgIG1lc3NhZ2U6ICc8c3ZlbHRlOnNlbGY+IGNvbXBvbmVudHMgY2FuIG9ubHkgZXhpc3QgaW5zaWRlIHsjaWZ9IGJsb2NrcywgeyNlYWNofSBibG9ja3MsIG9yIHNsb3RzIHBhc3NlZCB0byBjb21wb25lbnRzJ1xuICAgIH0sXG4gICAgaW52YWxpZF9zY3JpcHRfaW5zdGFuY2U6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtc2NyaXB0JyxcbiAgICAgICAgbWVzc2FnZTogJ0EgY29tcG9uZW50IGNhbiBvbmx5IGhhdmUgb25lIGluc3RhbmNlLWxldmVsIDxzY3JpcHQ+IGVsZW1lbnQnXG4gICAgfSxcbiAgICBpbnZhbGlkX3NjcmlwdF9tb2R1bGU6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtc2NyaXB0JyxcbiAgICAgICAgbWVzc2FnZTogJ0EgY29tcG9uZW50IGNhbiBvbmx5IGhhdmUgb25lIDxzY3JpcHQgY29udGV4dD1cIm1vZHVsZVwiPiBlbGVtZW50J1xuICAgIH0sXG4gICAgaW52YWxpZF9zY3JpcHRfY29udGV4dF9hdHRyaWJ1dGU6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtc2NyaXB0JyxcbiAgICAgICAgbWVzc2FnZTogJ2NvbnRleHQgYXR0cmlidXRlIG11c3QgYmUgc3RhdGljJ1xuICAgIH0sXG4gICAgaW52YWxpZF9zY3JpcHRfY29udGV4dF92YWx1ZToge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1zY3JpcHQnLFxuICAgICAgICBtZXNzYWdlOiAnSWYgdGhlIGNvbnRleHQgYXR0cmlidXRlIGlzIHN1cHBsaWVkLCBpdHMgdmFsdWUgbXVzdCBiZSBcIm1vZHVsZVwiJ1xuICAgIH0sXG4gICAgaW52YWxpZF90YWdfbmFtZToge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC10YWctbmFtZScsXG4gICAgICAgIG1lc3NhZ2U6ICdFeHBlY3RlZCB2YWxpZCB0YWcgbmFtZSdcbiAgICB9LFxuICAgIGludmFsaWRfdGFnX25hbWVfc3ZlbHRlX2VsZW1lbnQ6ICh0YWdzLCBtYXRjaCkgPT4gKHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtdGFnLW5hbWUnLFxuICAgICAgICBtZXNzYWdlOiBgVmFsaWQgPHN2ZWx0ZTouLi4+IHRhZyBuYW1lcyBhcmUgJHtsaXN0JDEodGFncyl9JHttYXRjaCA/ICcgKGRpZCB5b3UgbWVhbiAnICsgbWF0Y2ggKyAnPyknIDogJyd9YFxuICAgIH0pLFxuICAgIGludmFsaWRfdGhlbl9wbGFjZW1lbnRfdW5jbG9zZWRfYmxvY2s6IChibG9jaykgPT4gKHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtdGhlbi1wbGFjZW1lbnQnLFxuICAgICAgICBtZXNzYWdlOiBgRXhwZWN0ZWQgdG8gY2xvc2UgJHtibG9ja30gYmVmb3JlIHNlZWluZyB7OnRoZW59IGJsb2NrYFxuICAgIH0pLFxuICAgIGludmFsaWRfdGhlbl9wbGFjZW1lbnRfd2l0aG91dF9hd2FpdDoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC10aGVuLXBsYWNlbWVudCcsXG4gICAgICAgIG1lc3NhZ2U6ICdDYW5ub3QgaGF2ZSBhbiB7OnRoZW59IGJsb2NrIG91dHNpZGUgYW4geyNhd2FpdCAuLi59IGJsb2NrJ1xuICAgIH0sXG4gICAgaW52YWxpZF92b2lkX2NvbnRlbnQ6IChuYW1lKSA9PiAoe1xuICAgICAgICBjb2RlOiAnaW52YWxpZC12b2lkLWNvbnRlbnQnLFxuICAgICAgICBtZXNzYWdlOiBgPCR7bmFtZX0+IGlzIGEgdm9pZCBlbGVtZW50IGFuZCBjYW5ub3QgaGF2ZSBjaGlsZHJlbiwgb3IgYSBjbG9zaW5nIHRhZ2BcbiAgICB9KSxcbiAgICBtaXNzaW5nX2NvbXBvbmVudF9kZWZpbml0aW9uOiB7XG4gICAgICAgIGNvZGU6ICdtaXNzaW5nLWNvbXBvbmVudC1kZWZpbml0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogJzxzdmVsdGU6Y29tcG9uZW50PiBtdXN0IGhhdmUgYSBcXCd0aGlzXFwnIGF0dHJpYnV0ZSdcbiAgICB9LFxuICAgIG1pc3NpbmdfYXR0cmlidXRlX3ZhbHVlOiB7XG4gICAgICAgIGNvZGU6ICdtaXNzaW5nLWF0dHJpYnV0ZS12YWx1ZScsXG4gICAgICAgIG1lc3NhZ2U6ICdFeHBlY3RlZCB2YWx1ZSBmb3IgdGhlIGF0dHJpYnV0ZSdcbiAgICB9LFxuICAgIG1pc3NpbmdfZWxlbWVudF9kZWZpbml0aW9uOiB7XG4gICAgICAgIGNvZGU6ICdtaXNzaW5nLWVsZW1lbnQtZGVmaW5pdGlvbicsXG4gICAgICAgIG1lc3NhZ2U6ICc8c3ZlbHRlOmVsZW1lbnQ+IG11c3QgaGF2ZSBhIFxcJ3RoaXNcXCcgYXR0cmlidXRlJ1xuICAgIH0sXG4gICAgdW5jbG9zZWRfc2NyaXB0OiB7XG4gICAgICAgIGNvZGU6ICd1bmNsb3NlZC1zY3JpcHQnLFxuICAgICAgICBtZXNzYWdlOiAnPHNjcmlwdD4gbXVzdCBoYXZlIGEgY2xvc2luZyB0YWcnXG4gICAgfSxcbiAgICB1bmNsb3NlZF9zdHlsZToge1xuICAgICAgICBjb2RlOiAndW5jbG9zZWQtc3R5bGUnLFxuICAgICAgICBtZXNzYWdlOiAnPHN0eWxlPiBtdXN0IGhhdmUgYSBjbG9zaW5nIHRhZydcbiAgICB9LFxuICAgIHVuY2xvc2VkX2NvbW1lbnQ6IHtcbiAgICAgICAgY29kZTogJ3VuY2xvc2VkLWNvbW1lbnQnLFxuICAgICAgICBtZXNzYWdlOiAnY29tbWVudCB3YXMgbGVmdCBvcGVuLCBleHBlY3RlZCAtLT4nXG4gICAgfSxcbiAgICB1bmNsb3NlZF9hdHRyaWJ1dGVfdmFsdWU6ICh0b2tlbikgPT4gKHtcbiAgICAgICAgY29kZTogJ3VuY2xvc2VkLWF0dHJpYnV0ZS12YWx1ZScsXG4gICAgICAgIG1lc3NhZ2U6IGBFeHBlY3RlZCB0byBjbG9zZSB0aGUgYXR0cmlidXRlIHZhbHVlIHdpdGggJHt0b2tlbn1gXG4gICAgfSksXG4gICAgdW5leHBlY3RlZF9ibG9ja19jbG9zZToge1xuICAgICAgICBjb2RlOiAndW5leHBlY3RlZC1ibG9jay1jbG9zZScsXG4gICAgICAgIG1lc3NhZ2U6ICdVbmV4cGVjdGVkIGJsb2NrIGNsb3NpbmcgdGFnJ1xuICAgIH0sXG4gICAgdW5leHBlY3RlZF9lb2Y6IHtcbiAgICAgICAgY29kZTogJ3VuZXhwZWN0ZWQtZW9mJyxcbiAgICAgICAgbWVzc2FnZTogJ1VuZXhwZWN0ZWQgZW5kIG9mIGlucHV0J1xuICAgIH0sXG4gICAgdW5leHBlY3RlZF9lb2ZfdG9rZW46ICh0b2tlbikgPT4gKHtcbiAgICAgICAgY29kZTogJ3VuZXhwZWN0ZWQtZW9mJyxcbiAgICAgICAgbWVzc2FnZTogYFVuZXhwZWN0ZWQgJHt0b2tlbn1gXG4gICAgfSksXG4gICAgdW5leHBlY3RlZF90b2tlbjogKHRva2VuKSA9PiAoe1xuICAgICAgICBjb2RlOiAndW5leHBlY3RlZC10b2tlbicsXG4gICAgICAgIG1lc3NhZ2U6IGBFeHBlY3RlZCAke3Rva2VufWBcbiAgICB9KSxcbiAgICB1bmV4cGVjdGVkX3Rva2VuX2Rlc3RydWN0dXJlOiB7XG4gICAgICAgIGNvZGU6ICd1bmV4cGVjdGVkLXRva2VuJyxcbiAgICAgICAgbWVzc2FnZTogJ0V4cGVjdGVkIGlkZW50aWZpZXIgb3IgZGVzdHJ1Y3R1cmUgcGF0dGVybidcbiAgICB9XG59O1xuXG4vLyBAdHMtY2hlY2tcbi8qKiBAdHlwZWRlZiB7IGltcG9ydCgnZXN0cmVlJykuQmFzZU5vZGV9IEJhc2VOb2RlICovXG5cbi8qKiBAdHlwZWRlZiB7e1xuXHRza2lwOiAoKSA9PiB2b2lkO1xuXHRyZW1vdmU6ICgpID0+IHZvaWQ7XG5cdHJlcGxhY2U6IChub2RlOiBCYXNlTm9kZSkgPT4gdm9pZDtcbn19IFdhbGtlckNvbnRleHQgKi9cblxuY2xhc3MgV2Fsa2VyQmFzZSB7XG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cblx0XHR0aGlzLnNob3VsZF9za2lwID0gZmFsc2U7XG5cblx0XHQvKiogQHR5cGUge2Jvb2xlYW59ICovXG5cdFx0dGhpcy5zaG91bGRfcmVtb3ZlID0gZmFsc2U7XG5cblx0XHQvKiogQHR5cGUge0Jhc2VOb2RlIHwgbnVsbH0gKi9cblx0XHR0aGlzLnJlcGxhY2VtZW50ID0gbnVsbDtcblxuXHRcdC8qKiBAdHlwZSB7V2Fsa2VyQ29udGV4dH0gKi9cblx0XHR0aGlzLmNvbnRleHQgPSB7XG5cdFx0XHRza2lwOiAoKSA9PiAodGhpcy5zaG91bGRfc2tpcCA9IHRydWUpLFxuXHRcdFx0cmVtb3ZlOiAoKSA9PiAodGhpcy5zaG91bGRfcmVtb3ZlID0gdHJ1ZSksXG5cdFx0XHRyZXBsYWNlOiAobm9kZSkgPT4gKHRoaXMucmVwbGFjZW1lbnQgPSBub2RlKVxuXHRcdH07XG5cdH1cblxuXHQvKipcblx0ICpcblx0ICogQHBhcmFtIHthbnl9IHBhcmVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gcHJvcFxuXHQgKiBAcGFyYW0ge251bWJlcn0gaW5kZXhcblx0ICogQHBhcmFtIHtCYXNlTm9kZX0gbm9kZVxuXHQgKi9cblx0cmVwbGFjZShwYXJlbnQsIHByb3AsIGluZGV4LCBub2RlKSB7XG5cdFx0aWYgKHBhcmVudCkge1xuXHRcdFx0aWYgKGluZGV4ICE9PSBudWxsKSB7XG5cdFx0XHRcdHBhcmVudFtwcm9wXVtpbmRleF0gPSBub2RlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGFyZW50W3Byb3BdID0gbm9kZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICpcblx0ICogQHBhcmFtIHthbnl9IHBhcmVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gcHJvcFxuXHQgKiBAcGFyYW0ge251bWJlcn0gaW5kZXhcblx0ICovXG5cdHJlbW92ZShwYXJlbnQsIHByb3AsIGluZGV4KSB7XG5cdFx0aWYgKHBhcmVudCkge1xuXHRcdFx0aWYgKGluZGV4ICE9PSBudWxsKSB7XG5cdFx0XHRcdHBhcmVudFtwcm9wXS5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZGVsZXRlIHBhcmVudFtwcm9wXTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cblxuLy8gQHRzLWNoZWNrXG5cbi8qKiBAdHlwZWRlZiB7IGltcG9ydCgnZXN0cmVlJykuQmFzZU5vZGV9IEJhc2VOb2RlICovXG4vKiogQHR5cGVkZWYgeyBpbXBvcnQoJy4vd2Fsa2VyLmpzJykuV2Fsa2VyQ29udGV4dH0gV2Fsa2VyQ29udGV4dCAqL1xuXG4vKiogQHR5cGVkZWYgeyhcbiAqICAgIHRoaXM6IFdhbGtlckNvbnRleHQsXG4gKiAgICBub2RlOiBCYXNlTm9kZSxcbiAqICAgIHBhcmVudDogQmFzZU5vZGUsXG4gKiAgICBrZXk6IHN0cmluZyxcbiAqICAgIGluZGV4OiBudW1iZXJcbiAqICkgPT4gdm9pZH0gU3luY0hhbmRsZXIgKi9cblxuY2xhc3MgU3luY1dhbGtlciBleHRlbmRzIFdhbGtlckJhc2Uge1xuXHQvKipcblx0ICpcblx0ICogQHBhcmFtIHtTeW5jSGFuZGxlcn0gZW50ZXJcblx0ICogQHBhcmFtIHtTeW5jSGFuZGxlcn0gbGVhdmVcblx0ICovXG5cdGNvbnN0cnVjdG9yKGVudGVyLCBsZWF2ZSkge1xuXHRcdHN1cGVyKCk7XG5cblx0XHQvKiogQHR5cGUge1N5bmNIYW5kbGVyfSAqL1xuXHRcdHRoaXMuZW50ZXIgPSBlbnRlcjtcblxuXHRcdC8qKiBAdHlwZSB7U3luY0hhbmRsZXJ9ICovXG5cdFx0dGhpcy5sZWF2ZSA9IGxlYXZlO1xuXHR9XG5cblx0LyoqXG5cdCAqXG5cdCAqIEBwYXJhbSB7QmFzZU5vZGV9IG5vZGVcblx0ICogQHBhcmFtIHtCYXNlTm9kZX0gcGFyZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvcF1cblx0ICogQHBhcmFtIHtudW1iZXJ9IFtpbmRleF1cblx0ICogQHJldHVybnMge0Jhc2VOb2RlfVxuXHQgKi9cblx0dmlzaXQobm9kZSwgcGFyZW50LCBwcm9wLCBpbmRleCkge1xuXHRcdGlmIChub2RlKSB7XG5cdFx0XHRpZiAodGhpcy5lbnRlcikge1xuXHRcdFx0XHRjb25zdCBfc2hvdWxkX3NraXAgPSB0aGlzLnNob3VsZF9za2lwO1xuXHRcdFx0XHRjb25zdCBfc2hvdWxkX3JlbW92ZSA9IHRoaXMuc2hvdWxkX3JlbW92ZTtcblx0XHRcdFx0Y29uc3QgX3JlcGxhY2VtZW50ID0gdGhpcy5yZXBsYWNlbWVudDtcblx0XHRcdFx0dGhpcy5zaG91bGRfc2tpcCA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLnNob3VsZF9yZW1vdmUgPSBmYWxzZTtcblx0XHRcdFx0dGhpcy5yZXBsYWNlbWVudCA9IG51bGw7XG5cblx0XHRcdFx0dGhpcy5lbnRlci5jYWxsKHRoaXMuY29udGV4dCwgbm9kZSwgcGFyZW50LCBwcm9wLCBpbmRleCk7XG5cblx0XHRcdFx0aWYgKHRoaXMucmVwbGFjZW1lbnQpIHtcblx0XHRcdFx0XHRub2RlID0gdGhpcy5yZXBsYWNlbWVudDtcblx0XHRcdFx0XHR0aGlzLnJlcGxhY2UocGFyZW50LCBwcm9wLCBpbmRleCwgbm9kZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodGhpcy5zaG91bGRfcmVtb3ZlKSB7XG5cdFx0XHRcdFx0dGhpcy5yZW1vdmUocGFyZW50LCBwcm9wLCBpbmRleCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zdCBza2lwcGVkID0gdGhpcy5zaG91bGRfc2tpcDtcblx0XHRcdFx0Y29uc3QgcmVtb3ZlZCA9IHRoaXMuc2hvdWxkX3JlbW92ZTtcblxuXHRcdFx0XHR0aGlzLnNob3VsZF9za2lwID0gX3Nob3VsZF9za2lwO1xuXHRcdFx0XHR0aGlzLnNob3VsZF9yZW1vdmUgPSBfc2hvdWxkX3JlbW92ZTtcblx0XHRcdFx0dGhpcy5yZXBsYWNlbWVudCA9IF9yZXBsYWNlbWVudDtcblxuXHRcdFx0XHRpZiAoc2tpcHBlZCkgcmV0dXJuIG5vZGU7XG5cdFx0XHRcdGlmIChyZW1vdmVkKSByZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Zm9yIChjb25zdCBrZXkgaW4gbm9kZSkge1xuXHRcdFx0XHRjb25zdCB2YWx1ZSA9IG5vZGVba2V5XTtcblxuXHRcdFx0XHRpZiAodHlwZW9mIHZhbHVlICE9PSBcIm9iamVjdFwiKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcblx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdFx0XHRpZiAodmFsdWVbaV0gIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlW2ldLnR5cGUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0XHRcdGlmICghdGhpcy52aXNpdCh2YWx1ZVtpXSwgbm9kZSwga2V5LCBpKSkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIHJlbW92ZWRcblx0XHRcdFx0XHRcdFx0XHRpLS07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSBpZiAodmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlLnR5cGUgPT09IFwic3RyaW5nXCIpIHtcblx0XHRcdFx0XHR0aGlzLnZpc2l0KHZhbHVlLCBub2RlLCBrZXksIG51bGwpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0aGlzLmxlYXZlKSB7XG5cdFx0XHRcdGNvbnN0IF9yZXBsYWNlbWVudCA9IHRoaXMucmVwbGFjZW1lbnQ7XG5cdFx0XHRcdGNvbnN0IF9zaG91bGRfcmVtb3ZlID0gdGhpcy5zaG91bGRfcmVtb3ZlO1xuXHRcdFx0XHR0aGlzLnJlcGxhY2VtZW50ID0gbnVsbDtcblx0XHRcdFx0dGhpcy5zaG91bGRfcmVtb3ZlID0gZmFsc2U7XG5cblx0XHRcdFx0dGhpcy5sZWF2ZS5jYWxsKHRoaXMuY29udGV4dCwgbm9kZSwgcGFyZW50LCBwcm9wLCBpbmRleCk7XG5cblx0XHRcdFx0aWYgKHRoaXMucmVwbGFjZW1lbnQpIHtcblx0XHRcdFx0XHRub2RlID0gdGhpcy5yZXBsYWNlbWVudDtcblx0XHRcdFx0XHR0aGlzLnJlcGxhY2UocGFyZW50LCBwcm9wLCBpbmRleCwgbm9kZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodGhpcy5zaG91bGRfcmVtb3ZlKSB7XG5cdFx0XHRcdFx0dGhpcy5yZW1vdmUocGFyZW50LCBwcm9wLCBpbmRleCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zdCByZW1vdmVkID0gdGhpcy5zaG91bGRfcmVtb3ZlO1xuXG5cdFx0XHRcdHRoaXMucmVwbGFjZW1lbnQgPSBfcmVwbGFjZW1lbnQ7XG5cdFx0XHRcdHRoaXMuc2hvdWxkX3JlbW92ZSA9IF9zaG91bGRfcmVtb3ZlO1xuXG5cdFx0XHRcdGlmIChyZW1vdmVkKSByZXR1cm4gbnVsbDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbm9kZTtcblx0fVxufVxuXG4vLyBAdHMtY2hlY2tcblxuLyoqIEB0eXBlZGVmIHsgaW1wb3J0KCdlc3RyZWUnKS5CYXNlTm9kZX0gQmFzZU5vZGUgKi9cbi8qKiBAdHlwZWRlZiB7IGltcG9ydCgnLi9zeW5jLmpzJykuU3luY0hhbmRsZXJ9IFN5bmNIYW5kbGVyICovXG4vKiogQHR5cGVkZWYgeyBpbXBvcnQoJy4vYXN5bmMuanMnKS5Bc3luY0hhbmRsZXJ9IEFzeW5jSGFuZGxlciAqL1xuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0Jhc2VOb2RlfSBhc3RcbiAqIEBwYXJhbSB7e1xuICogICBlbnRlcj86IFN5bmNIYW5kbGVyXG4gKiAgIGxlYXZlPzogU3luY0hhbmRsZXJcbiAqIH19IHdhbGtlclxuICogQHJldHVybnMge0Jhc2VOb2RlfVxuICovXG5mdW5jdGlvbiB3YWxrKGFzdCwgeyBlbnRlciwgbGVhdmUgfSkge1xuXHRjb25zdCBpbnN0YW5jZSA9IG5ldyBTeW5jV2Fsa2VyKGVudGVyLCBsZWF2ZSk7XG5cdHJldHVybiBpbnN0YW5jZS52aXNpdChhc3QsIG51bGwpO1xufVxuXG4vLyBnZW5lcmF0ZSBhbiBJRCB0aGF0IGlzLCB0byBhbGwgaW50ZW50cyBhbmQgcHVycG9zZXMsIHVuaXF1ZVxuY29uc3QgaWQgPSAoTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMWUyMCkpLnRvU3RyaW5nKDM2KTtcbmNvbnN0IHJlID0gbmV3IFJlZ0V4cChgXyR7aWR9Xyg/OihcXFxcZCspfChBVCl8KEhBU0gpKV8oXFxcXHcrKT9gLCAnZycpO1xuXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnZXN0cmVlJykuQ29tbWVudH0gQ29tbWVudCAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLk5vZGV9IE5vZGUgKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7Tm9kZSAmIHtcbiAqICAgc3RhcnQ6IG51bWJlcjtcbiAqICAgZW5kOiBudW1iZXI7XG4gKiAgIGhhc190cmFpbGluZ19uZXdsaW5lPzogYm9vbGVhblxuICogfX0gTm9kZVdpdGhMb2NhdGlvblxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge0NvbW1lbnQgJiB7XG4gKiAgIHN0YXJ0OiBudW1iZXI7XG4gKiAgIGVuZDogbnVtYmVyO1xuICogICBoYXNfdHJhaWxpbmdfbmV3bGluZT86IGJvb2xlYW5cbiAqIH19IENvbW1lbnRXaXRoTG9jYXRpb25cbiAqL1xuXG4vKipcbiAqIEBwYXJhbSB7Q29tbWVudFdpdGhMb2NhdGlvbltdfSBjb21tZW50c1xuICogQHBhcmFtIHtzdHJpbmd9IHJhd1xuICovXG5jb25zdCBnZXRfY29tbWVudF9oYW5kbGVycyA9IChjb21tZW50cywgcmF3KSA9PiAoe1xuXG5cdC8vIHBhc3MgdG8gYWNvcm4gb3B0aW9uc1xuXHQvKipcblx0ICogQHBhcmFtIHtib29sZWFufSBibG9ja1xuXHQgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcblx0ICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0XG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBlbmRcblx0ICovXG5cdG9uQ29tbWVudDogKGJsb2NrLCB2YWx1ZSwgc3RhcnQsIGVuZCkgPT4ge1xuXHRcdGlmIChibG9jayAmJiAvXFxuLy50ZXN0KHZhbHVlKSkge1xuXHRcdFx0bGV0IGEgPSBzdGFydDtcblx0XHRcdHdoaWxlIChhID4gMCAmJiByYXdbYSAtIDFdICE9PSAnXFxuJykgYSAtPSAxO1xuXG5cdFx0XHRsZXQgYiA9IGE7XG5cdFx0XHR3aGlsZSAoL1sgXFx0XS8udGVzdChyYXdbYl0pKSBiICs9IDE7XG5cblx0XHRcdGNvbnN0IGluZGVudGF0aW9uID0gcmF3LnNsaWNlKGEsIGIpO1xuXHRcdFx0dmFsdWUgPSB2YWx1ZS5yZXBsYWNlKG5ldyBSZWdFeHAoYF4ke2luZGVudGF0aW9ufWAsICdnbScpLCAnJyk7XG5cdFx0fVxuXG5cdFx0Y29tbWVudHMucHVzaCh7IHR5cGU6IGJsb2NrID8gJ0Jsb2NrJyA6ICdMaW5lJywgdmFsdWUsIHN0YXJ0LCBlbmQgfSk7XG5cdH0sXG5cblx0Ly8gcGFzcyB0byBlc3RyZWUtd2Fsa2VyIG9wdGlvbnNcblx0LyoqIEBwYXJhbSB7Tm9kZVdpdGhMb2NhdGlvbn0gbm9kZSAqL1xuXHRlbnRlcihub2RlKSB7XG5cdFx0bGV0IGNvbW1lbnQ7XG5cblx0XHR3aGlsZSAoY29tbWVudHNbMF0gJiYgY29tbWVudHNbMF0uc3RhcnQgPCBub2RlLnN0YXJ0KSB7XG5cdFx0XHRjb21tZW50ID0gY29tbWVudHMuc2hpZnQoKTtcblxuXHRcdFx0Y29tbWVudC52YWx1ZSA9IGNvbW1lbnQudmFsdWUucmVwbGFjZShyZSwgKG1hdGNoLCBpZCwgYXQsIGhhc2gsIHZhbHVlKSA9PiB7XG5cdFx0XHRcdGlmIChoYXNoKSByZXR1cm4gYCMke3ZhbHVlfWA7XG5cdFx0XHRcdGlmIChhdCkgcmV0dXJuIGBAJHt2YWx1ZX1gO1xuXG5cdFx0XHRcdHJldHVybiBtYXRjaDtcblx0XHRcdH0pO1xuXG5cdFx0XHRjb25zdCBuZXh0ID0gY29tbWVudHNbMF0gfHwgbm9kZTtcblx0XHRcdGNvbW1lbnQuaGFzX3RyYWlsaW5nX25ld2xpbmUgPSAoXG5cdFx0XHRcdGNvbW1lbnQudHlwZSA9PT0gJ0xpbmUnIHx8XG5cdFx0XHRcdC9cXG4vLnRlc3QocmF3LnNsaWNlKGNvbW1lbnQuZW5kLCBuZXh0LnN0YXJ0KSlcblx0XHRcdCk7XG5cblx0XHRcdChub2RlLmxlYWRpbmdDb21tZW50cyB8fCAobm9kZS5sZWFkaW5nQ29tbWVudHMgPSBbXSkpLnB1c2goY29tbWVudCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAcGFyYW0ge05vZGVXaXRoTG9jYXRpb259IG5vZGUgKi9cblx0bGVhdmUobm9kZSkge1xuXHRcdGlmIChjb21tZW50c1swXSkge1xuXHRcdFx0Y29uc3Qgc2xpY2UgPSByYXcuc2xpY2Uobm9kZS5lbmQsIGNvbW1lbnRzWzBdLnN0YXJ0KTtcblxuXHRcdFx0aWYgKC9eWywpIFxcdF0qJC8udGVzdChzbGljZSkpIHtcblx0XHRcdFx0bm9kZS50cmFpbGluZ0NvbW1lbnRzID0gW2NvbW1lbnRzLnNoaWZ0KCldO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufSk7XG5cbi8vQHRzLWNoZWNrXG4vKiogQHR5cGVkZWYgeyBpbXBvcnQoJ2VzdHJlZScpLk5vZGV9IE5vZGUgKi9cbi8qKiBAdHlwZWRlZiB7Tm9kZSB8IHtcbiAqICAgdHlwZTogJ1Byb3BlcnR5RGVmaW5pdGlvbic7XG4gKiAgIGNvbXB1dGVkOiBib29sZWFuO1xuICogICB2YWx1ZTogTm9kZVxuICogfX0gTm9kZVdpdGhQcm9wZXJ0eURlZmluaXRpb24gKi9cblxuLyoqXG4gKlxuICogQHBhcmFtIHtOb2RlV2l0aFByb3BlcnR5RGVmaW5pdGlvbn0gbm9kZVxuICogQHBhcmFtIHtOb2RlV2l0aFByb3BlcnR5RGVmaW5pdGlvbn0gcGFyZW50XG4gKiBAcmV0dXJucyBib29sZWFuXG4gKi9cbmZ1bmN0aW9uIGlzX3JlZmVyZW5jZSAobm9kZSwgcGFyZW50KSB7XG5cdGlmIChub2RlLnR5cGUgPT09ICdNZW1iZXJFeHByZXNzaW9uJykge1xuXHRcdHJldHVybiAhbm9kZS5jb21wdXRlZCAmJiBpc19yZWZlcmVuY2Uobm9kZS5vYmplY3QsIG5vZGUpO1xuXHR9XG5cblx0aWYgKG5vZGUudHlwZSA9PT0gJ0lkZW50aWZpZXInKSB7XG5cdFx0aWYgKCFwYXJlbnQpIHJldHVybiB0cnVlO1xuXG5cdFx0c3dpdGNoIChwYXJlbnQudHlwZSkge1xuXHRcdFx0Ly8gZGlzcmVnYXJkIGBiYXJgIGluIGBmb28uYmFyYFxuXHRcdFx0Y2FzZSAnTWVtYmVyRXhwcmVzc2lvbic6IHJldHVybiBwYXJlbnQuY29tcHV0ZWQgfHwgbm9kZSA9PT0gcGFyZW50Lm9iamVjdDtcblxuXHRcdFx0Ly8gZGlzcmVnYXJkIHRoZSBgZm9vYCBpbiBgY2xhc3Mge2Zvbygpe319YCBidXQga2VlcCBpdCBpbiBgY2xhc3Mge1tmb29dKCl7fX1gXG5cdFx0XHRjYXNlICdNZXRob2REZWZpbml0aW9uJzogcmV0dXJuIHBhcmVudC5jb21wdXRlZDtcblxuXHRcdFx0Ly8gZGlzcmVnYXJkIHRoZSBgZm9vYCBpbiBgY2xhc3Mge2Zvbz1iYXJ9YCBidXQga2VlcCBpdCBpbiBgY2xhc3Mge1tmb29dPWJhcn1gIGFuZCBgY2xhc3Mge2Jhcj1mb299YFxuXHRcdFx0Y2FzZSAnUHJvcGVydHlEZWZpbml0aW9uJzogcmV0dXJuIHBhcmVudC5jb21wdXRlZCB8fCBub2RlID09PSBwYXJlbnQudmFsdWU7XG5cblx0XHRcdC8vIGRpc3JlZ2FyZCB0aGUgYGJhcmAgaW4gYHsgYmFyOiBmb28gfWAsIGJ1dCBrZWVwIGl0IGluIGB7IFtiYXJdOiBmb28gfWBcblx0XHRcdGNhc2UgJ1Byb3BlcnR5JzogcmV0dXJuIHBhcmVudC5jb21wdXRlZCB8fCBub2RlID09PSBwYXJlbnQudmFsdWU7XG5cblx0XHRcdC8vIGRpc3JlZ2FyZCB0aGUgYGJhcmAgaW4gYGV4cG9ydCB7IGZvbyBhcyBiYXIgfWAgb3Jcblx0XHRcdC8vIHRoZSBmb28gaW4gYGltcG9ydCB7IGZvbyBhcyBiYXIgfWBcblx0XHRcdGNhc2UgJ0V4cG9ydFNwZWNpZmllcic6XG5cdFx0XHRjYXNlICdJbXBvcnRTcGVjaWZpZXInOiByZXR1cm4gbm9kZSA9PT0gcGFyZW50LmxvY2FsO1xuXG5cdFx0XHQvLyBkaXNyZWdhcmQgdGhlIGBmb29gIGluIGBmb286IHdoaWxlICguLi4pIHsgLi4uIGJyZWFrIGZvbzsgLi4uIGNvbnRpbnVlIGZvbzt9YFxuXHRcdFx0Y2FzZSAnTGFiZWxlZFN0YXRlbWVudCc6XG5cdFx0XHRjYXNlICdCcmVha1N0YXRlbWVudCc6XG5cdFx0XHRjYXNlICdDb250aW51ZVN0YXRlbWVudCc6IHJldHVybiBmYWxzZTtcblx0XHRcdGRlZmF1bHQ6IHJldHVybiB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBmYWxzZTtcbn1cblxuLyoqIEBwYXJhbSB7aW1wb3J0KCdlc3RyZWUnKS5Ob2RlfSBleHByZXNzaW9uICovXG5mdW5jdGlvbiBhbmFseXplKGV4cHJlc3Npb24pIHtcblx0LyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLk5vZGV9IE5vZGUgKi9cblxuXHQvKiogQHR5cGUge1dlYWtNYXA8Tm9kZSwgU2NvcGU+fSAqL1xuXHRjb25zdCBtYXAgPSBuZXcgV2Vha01hcCgpO1xuXG5cdC8qKiBAdHlwZSB7TWFwPHN0cmluZywgTm9kZT59ICovXG5cdGNvbnN0IGdsb2JhbHMgPSBuZXcgTWFwKCk7XG5cblx0Y29uc3Qgc2NvcGUgPSBuZXcgU2NvcGUkMShudWxsLCBmYWxzZSk7XG5cblx0LyoqIEB0eXBlIHtbU2NvcGUsIGltcG9ydCgnZXN0cmVlJykuSWRlbnRpZmllcl1bXX0gKi9cblx0Y29uc3QgcmVmZXJlbmNlcyA9IFtdO1xuXHRsZXQgY3VycmVudF9zY29wZSA9IHNjb3BlO1xuXG5cdHdhbGsoZXhwcmVzc2lvbiwge1xuXHRcdC8qKlxuXHRcdCAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuXHRcdCAqIEBwYXJhbSB7YW55fSBwYXJlbnRcblx0XHQgKi9cblx0XHRlbnRlcihub2RlLCBwYXJlbnQpIHtcblx0XHRcdHN3aXRjaCAobm9kZS50eXBlKSB7XG5cdFx0XHRcdGNhc2UgJ0lkZW50aWZpZXInOlxuXHRcdFx0XHRcdGlmIChpc19yZWZlcmVuY2Uobm9kZSwgcGFyZW50KSkge1xuXHRcdFx0XHRcdFx0cmVmZXJlbmNlcy5wdXNoKFtjdXJyZW50X3Njb3BlLCBub2RlXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgJ0ltcG9ydERlY2xhcmF0aW9uJzpcblx0XHRcdFx0XHRub2RlLnNwZWNpZmllcnMuZm9yRWFjaCgoc3BlY2lmaWVyKSA9PiB7XG5cdFx0XHRcdFx0XHRjdXJyZW50X3Njb3BlLmRlY2xhcmF0aW9ucy5zZXQoc3BlY2lmaWVyLmxvY2FsLm5hbWUsIHNwZWNpZmllcik7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAnRnVuY3Rpb25FeHByZXNzaW9uJzpcblx0XHRcdFx0Y2FzZSAnRnVuY3Rpb25EZWNsYXJhdGlvbic6XG5cdFx0XHRcdGNhc2UgJ0Fycm93RnVuY3Rpb25FeHByZXNzaW9uJzpcblx0XHRcdFx0XHRpZiAobm9kZS50eXBlID09PSAnRnVuY3Rpb25EZWNsYXJhdGlvbicpIHtcblx0XHRcdFx0XHRcdGlmIChub2RlLmlkKSB7XG5cdFx0XHRcdFx0XHRcdGN1cnJlbnRfc2NvcGUuZGVjbGFyYXRpb25zLnNldChub2RlLmlkLm5hbWUsIG5vZGUpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRtYXAuc2V0KG5vZGUsIGN1cnJlbnRfc2NvcGUgPSBuZXcgU2NvcGUkMShjdXJyZW50X3Njb3BlLCBmYWxzZSkpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRtYXAuc2V0KG5vZGUsIGN1cnJlbnRfc2NvcGUgPSBuZXcgU2NvcGUkMShjdXJyZW50X3Njb3BlLCBmYWxzZSkpO1xuXG5cdFx0XHRcdFx0XHRpZiAobm9kZS50eXBlID09PSAnRnVuY3Rpb25FeHByZXNzaW9uJyAmJiBub2RlLmlkKSB7XG5cdFx0XHRcdFx0XHRcdGN1cnJlbnRfc2NvcGUuZGVjbGFyYXRpb25zLnNldChub2RlLmlkLm5hbWUsIG5vZGUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG5vZGUucGFyYW1zLmZvckVhY2gocGFyYW0gPT4ge1xuXHRcdFx0XHRcdFx0ZXh0cmFjdF9uYW1lcyhwYXJhbSkuZm9yRWFjaChuYW1lID0+IHtcblx0XHRcdFx0XHRcdFx0Y3VycmVudF9zY29wZS5kZWNsYXJhdGlvbnMuc2V0KG5hbWUsIG5vZGUpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAnRm9yU3RhdGVtZW50Jzpcblx0XHRcdFx0Y2FzZSAnRm9ySW5TdGF0ZW1lbnQnOlxuXHRcdFx0XHRjYXNlICdGb3JPZlN0YXRlbWVudCc6XG5cdFx0XHRcdFx0bWFwLnNldChub2RlLCBjdXJyZW50X3Njb3BlID0gbmV3IFNjb3BlJDEoY3VycmVudF9zY29wZSwgdHJ1ZSkpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgJ0Jsb2NrU3RhdGVtZW50Jzpcblx0XHRcdFx0XHRtYXAuc2V0KG5vZGUsIGN1cnJlbnRfc2NvcGUgPSBuZXcgU2NvcGUkMShjdXJyZW50X3Njb3BlLCB0cnVlKSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAnQ2xhc3NEZWNsYXJhdGlvbic6XG5cdFx0XHRcdGNhc2UgJ1ZhcmlhYmxlRGVjbGFyYXRpb24nOlxuXHRcdFx0XHRcdGN1cnJlbnRfc2NvcGUuYWRkX2RlY2xhcmF0aW9uKG5vZGUpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgJ0NhdGNoQ2xhdXNlJzpcblx0XHRcdFx0XHRtYXAuc2V0KG5vZGUsIGN1cnJlbnRfc2NvcGUgPSBuZXcgU2NvcGUkMShjdXJyZW50X3Njb3BlLCB0cnVlKSk7XG5cblx0XHRcdFx0XHRpZiAobm9kZS5wYXJhbSkge1xuXHRcdFx0XHRcdFx0ZXh0cmFjdF9uYW1lcyhub2RlLnBhcmFtKS5mb3JFYWNoKG5hbWUgPT4ge1xuXHRcdFx0XHRcdFx0XHRjdXJyZW50X3Njb3BlLmRlY2xhcmF0aW9ucy5zZXQobmFtZSwgbm9kZS5wYXJhbSk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdC8qKiBAcGFyYW0ge05vZGV9IG5vZGUgKi9cblx0XHRsZWF2ZShub2RlKSB7XG5cdFx0XHRpZiAobWFwLmhhcyhub2RlKSkge1xuXHRcdFx0XHRjdXJyZW50X3Njb3BlID0gY3VycmVudF9zY29wZS5wYXJlbnQ7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRmb3IgKGxldCBpID0gcmVmZXJlbmNlcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuXHRcdGNvbnN0IFtzY29wZSwgcmVmZXJlbmNlXSA9IHJlZmVyZW5jZXNbaV07XG5cblx0XHRpZiAoIXNjb3BlLnJlZmVyZW5jZXMuaGFzKHJlZmVyZW5jZS5uYW1lKSkge1xuXHRcdFx0YWRkX3JlZmVyZW5jZShzY29wZSwgcmVmZXJlbmNlLm5hbWUpO1xuXHRcdH1cblx0XHRpZiAoIXNjb3BlLmZpbmRfb3duZXIocmVmZXJlbmNlLm5hbWUpKSB7XG5cdFx0XHRnbG9iYWxzLnNldChyZWZlcmVuY2UubmFtZSwgcmVmZXJlbmNlKTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4geyBtYXAsIHNjb3BlLCBnbG9iYWxzIH07XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7U2NvcGV9IHNjb3BlXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICovXG5mdW5jdGlvbiBhZGRfcmVmZXJlbmNlKHNjb3BlLCBuYW1lKSB7XG5cdHNjb3BlLnJlZmVyZW5jZXMuYWRkKG5hbWUpO1xuXHRpZiAoc2NvcGUucGFyZW50KSBhZGRfcmVmZXJlbmNlKHNjb3BlLnBhcmVudCwgbmFtZSk7XG59XG5cbmNsYXNzIFNjb3BlJDEge1xuXHRjb25zdHJ1Y3RvcihwYXJlbnQsIGJsb2NrKSB7XG5cdFx0LyoqIEB0eXBlIHtTY29wZSB8IG51bGx9ICovXG5cdFx0dGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cblx0XHQvKiogQHR5cGUge2Jvb2xlYW59ICovXG5cdFx0dGhpcy5ibG9jayA9IGJsb2NrO1xuXG5cdFx0LyoqIEB0eXBlIHtNYXA8c3RyaW5nLCBpbXBvcnQoJ2VzdHJlZScpLk5vZGU+fSAqL1xuXHRcdHRoaXMuZGVjbGFyYXRpb25zID0gbmV3IE1hcCgpO1xuXG5cdFx0LyoqIEB0eXBlIHtTZXQ8c3RyaW5nPn0gKi9cblx0XHR0aGlzLmluaXRpYWxpc2VkX2RlY2xhcmF0aW9ucyA9IG5ldyBTZXQoKTtcblxuXHRcdC8qKiBAdHlwZSB7U2V0PHN0cmluZz59ICovXG5cdFx0dGhpcy5yZWZlcmVuY2VzID0gbmV3IFNldCgpO1xuXHR9XG5cblx0LyoqIEBwYXJhbSB7aW1wb3J0KCdlc3RyZWUnKS5WYXJpYWJsZURlY2xhcmF0aW9uIHwgaW1wb3J0KCdlc3RyZWUnKS5DbGFzc0RlY2xhcmF0aW9ufSBub2RlICovXG5cdGFkZF9kZWNsYXJhdGlvbihub2RlKSB7XG5cdFx0aWYgKG5vZGUudHlwZSA9PT0gJ1ZhcmlhYmxlRGVjbGFyYXRpb24nKSB7XG5cdFx0XHRpZiAobm9kZS5raW5kID09PSAndmFyJyAmJiB0aGlzLmJsb2NrICYmIHRoaXMucGFyZW50KSB7XG5cdFx0XHRcdHRoaXMucGFyZW50LmFkZF9kZWNsYXJhdGlvbihub2RlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8qKiBAcGFyYW0ge2ltcG9ydCgnZXN0cmVlJykuVmFyaWFibGVEZWNsYXJhdG9yfSBkZWNsYXJhdG9yICovXG5cdFx0XHRcdGNvbnN0IGhhbmRsZV9kZWNsYXJhdG9yID0gKGRlY2xhcmF0b3IpID0+IHtcblx0XHRcdFx0XHRleHRyYWN0X25hbWVzKGRlY2xhcmF0b3IuaWQpLmZvckVhY2gobmFtZSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLmRlY2xhcmF0aW9ucy5zZXQobmFtZSwgbm9kZSk7XG5cdFx0XHRcdFx0XHRpZiAoZGVjbGFyYXRvci5pbml0KSB0aGlzLmluaXRpYWxpc2VkX2RlY2xhcmF0aW9ucy5hZGQobmFtZSk7XG5cdFx0XHRcdFx0fSk7XHRcdFx0XHR9O1xuXG5cdFx0XHRcdG5vZGUuZGVjbGFyYXRpb25zLmZvckVhY2goaGFuZGxlX2RlY2xhcmF0b3IpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAobm9kZS5pZCkge1xuXHRcdFx0dGhpcy5kZWNsYXJhdGlvbnMuc2V0KG5vZGUuaWQubmFtZSwgbm9kZSk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG5cdCAqIEByZXR1cm5zIHtTY29wZSB8IG51bGx9XG5cdCAqL1xuXHRmaW5kX293bmVyKG5hbWUpIHtcblx0XHRpZiAodGhpcy5kZWNsYXJhdGlvbnMuaGFzKG5hbWUpKSByZXR1cm4gdGhpcztcblx0XHRyZXR1cm4gdGhpcy5wYXJlbnQgJiYgdGhpcy5wYXJlbnQuZmluZF9vd25lcihuYW1lKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cblx0ICovXG5cdGhhcyhuYW1lKSB7XG5cdFx0cmV0dXJuIChcblx0XHRcdHRoaXMuZGVjbGFyYXRpb25zLmhhcyhuYW1lKSB8fCAoISF0aGlzLnBhcmVudCAmJiB0aGlzLnBhcmVudC5oYXMobmFtZSkpXG5cdFx0KTtcblx0fVxufVxuXG4vKipcbiAqIEBwYXJhbSB7aW1wb3J0KCdlc3RyZWUnKS5Ob2RlfSBwYXJhbVxuICogQHJldHVybnMge3N0cmluZ1tdfVxuICovXG5mdW5jdGlvbiBleHRyYWN0X25hbWVzKHBhcmFtKSB7XG5cdHJldHVybiBleHRyYWN0X2lkZW50aWZpZXJzKHBhcmFtKS5tYXAobm9kZSA9PiBub2RlLm5hbWUpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7aW1wb3J0KCdlc3RyZWUnKS5Ob2RlfSBwYXJhbVxuICogQHBhcmFtIHtpbXBvcnQoJ2VzdHJlZScpLklkZW50aWZpZXJbXX0gbm9kZXNcbiAqIEByZXR1cm5zIHtpbXBvcnQoJ2VzdHJlZScpLklkZW50aWZpZXJbXX1cbiAqL1xuZnVuY3Rpb24gZXh0cmFjdF9pZGVudGlmaWVycyhwYXJhbSwgbm9kZXMgPSBbXSkge1xuXHRzd2l0Y2ggKHBhcmFtLnR5cGUpIHtcblx0XHRjYXNlICdJZGVudGlmaWVyJzpcblx0XHRcdG5vZGVzLnB1c2gocGFyYW0pO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlICdNZW1iZXJFeHByZXNzaW9uJzpcblx0XHRcdGxldCBvYmplY3QgPSBwYXJhbTtcblx0XHRcdHdoaWxlIChvYmplY3QudHlwZSA9PT0gJ01lbWJlckV4cHJlc3Npb24nKSB7XG5cdFx0XHRcdG9iamVjdCA9IC8qKiBAdHlwZSB7YW55fSAqLyAob2JqZWN0Lm9iamVjdCk7XG5cdFx0XHR9XG5cdFx0XHRub2Rlcy5wdXNoKC8qKiBAdHlwZSB7YW55fSAqLyAob2JqZWN0KSk7XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgJ09iamVjdFBhdHRlcm4nOlxuXHRcdFx0LyoqIEBwYXJhbSB7aW1wb3J0KCdlc3RyZWUnKS5Qcm9wZXJ0eSB8IGltcG9ydCgnZXN0cmVlJykuUmVzdEVsZW1lbnR9IHByb3AgKi9cblx0XHRcdGNvbnN0IGhhbmRsZV9wcm9wID0gKHByb3ApID0+IHtcblx0XHRcdFx0aWYgKHByb3AudHlwZSA9PT0gJ1Jlc3RFbGVtZW50Jykge1xuXHRcdFx0XHRcdGV4dHJhY3RfaWRlbnRpZmllcnMocHJvcC5hcmd1bWVudCwgbm9kZXMpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGV4dHJhY3RfaWRlbnRpZmllcnMocHJvcC52YWx1ZSwgbm9kZXMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHRwYXJhbS5wcm9wZXJ0aWVzLmZvckVhY2goaGFuZGxlX3Byb3ApO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlICdBcnJheVBhdHRlcm4nOlxuXHRcdFx0LyoqIEBwYXJhbSB7aW1wb3J0KCdlc3RyZWUnKS5Ob2RlfSBlbGVtZW50ICovXG5cdFx0XHRjb25zdCBoYW5kbGVfZWxlbWVudCA9IChlbGVtZW50KSA9PiB7XG5cdFx0XHRcdGlmIChlbGVtZW50KSBleHRyYWN0X2lkZW50aWZpZXJzKGVsZW1lbnQsIG5vZGVzKTtcblx0XHRcdH07XG5cblx0XHRcdHBhcmFtLmVsZW1lbnRzLmZvckVhY2goaGFuZGxlX2VsZW1lbnQpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlICdSZXN0RWxlbWVudCc6XG5cdFx0XHRleHRyYWN0X2lkZW50aWZpZXJzKHBhcmFtLmFyZ3VtZW50LCBub2Rlcyk7XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgJ0Fzc2lnbm1lbnRQYXR0ZXJuJzpcblx0XHRcdGV4dHJhY3RfaWRlbnRpZmllcnMocGFyYW0ubGVmdCwgbm9kZXMpO1xuXHRcdFx0YnJlYWs7XG5cdH1cblxuXHRyZXR1cm4gbm9kZXM7XG59XG5cbi8qKlxuICogRG9lcyBgYXJyYXkucHVzaGAgZm9yIGFsbCBgaXRlbXNgLiBOZWVkZWQgYmVjYXVzZSBgYXJyYXkucHVzaCguLi5pdGVtcylgIHRocm93c1xuICogXCJNYXhpbXVtIGNhbGwgc3RhY2sgc2l6ZSBleGNlZWRlZFwiIHdoZW4gYGl0ZW1zYCBpcyB0b28gYmlnIG9mIGFuIGFycmF5LlxuICpcbiAqIEBwYXJhbSB7YW55W119IGFycmF5IFxuICogQHBhcmFtIHthbnlbXX0gaXRlbXMgXG4gKi9cbmZ1bmN0aW9uIHB1c2hfYXJyYXkoYXJyYXksIGl0ZW1zKSB7XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcblx0XHRhcnJheS5wdXNoKGl0ZW1zW2ldKTtcblx0fVxufVxuXG4vLyBoZWF2aWx5IGJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9kYXZpZGJvbm5ldC9hc3RyaW5nXG5cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5BcnJvd0Z1bmN0aW9uRXhwcmVzc2lvbn0gQXJyb3dGdW5jdGlvbkV4cHJlc3Npb24gKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5CaW5hcnlFeHByZXNzaW9ufSBCaW5hcnlFeHByZXNzaW9uICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnZXN0cmVlJykuQ2FsbEV4cHJlc3Npb259IENhbGxFeHByZXNzaW9uICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnZXN0cmVlJykuQ29tbWVudH0gQ29tbWVudCAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLkV4cG9ydFNwZWNpZmllcn0gRXhwb3J0U3BlY2lmaWVyICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnZXN0cmVlJykuRXhwcmVzc2lvbn0gRXhwcmVzc2lvbiAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLkZ1bmN0aW9uRGVjbGFyYXRpb259IEZ1bmN0aW9uRGVjbGFyYXRpb24gKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5JbXBvcnREZWNsYXJhdGlvbn0gSW1wb3J0RGVjbGFyYXRpb24gKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5JbXBvcnRTcGVjaWZpZXJ9IEltcG9ydFNwZWNpZmllciAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLkxpdGVyYWx9IExpdGVyYWwgKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5Mb2dpY2FsRXhwcmVzc2lvbn0gTG9naWNhbEV4cHJlc3Npb24gKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5OZXdFeHByZXNzaW9ufSBOZXdFeHByZXNzaW9uICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnZXN0cmVlJykuTm9kZX0gTm9kZSAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLk9iamVjdEV4cHJlc3Npb259IE9iamVjdEV4cHJlc3Npb24gKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5QYXR0ZXJufSBQYXR0ZXJuICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnZXN0cmVlJykuU2VxdWVuY2VFeHByZXNzaW9ufSBTZXF1ZW5jZUV4cHJlc3Npb24gKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5TaW1wbGVDYWxsRXhwcmVzc2lvbn0gU2ltcGxlQ2FsbEV4cHJlc3Npb24gKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5Td2l0Y2hTdGF0ZW1lbnR9IFN3aXRjaFN0YXRlbWVudCAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLlZhcmlhYmxlRGVjbGFyYXRpb259IFZhcmlhYmxlRGVjbGFyYXRpb24gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBjb250ZW50OiBzdHJpbmc7XG4gKiAgIGxvYz86IHtcbiAqICAgICBzdGFydDogeyBsaW5lOiBudW1iZXI7IGNvbHVtbjogbnVtYmVyOyB9O1xuICogICAgIGVuZDogeyBsaW5lOiBudW1iZXI7IGNvbHVtbjogbnVtYmVyOyB9O1xuICogICB9O1xuICogICBoYXNfbmV3bGluZTogYm9vbGVhbjtcbiAqIH19IENodW5rXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7KG5vZGU6IGFueSwgc3RhdGU6IFN0YXRlKSA9PiBDaHVua1tdfSBIYW5kbGVyXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBpbmRlbnQ6IHN0cmluZztcbiAqICAgc2NvcGU6IGFueTsgLy8gVE9ETyBpbXBvcnQgZnJvbSBwZXJpc2NvcGljXG4gKiAgIHNjb3BlX21hcDogV2Vha01hcDxOb2RlLCBhbnk+O1xuICogICBnZXROYW1lOiAobmFtZTogc3RyaW5nKSA9PiBzdHJpbmc7XG4gKiAgIGRlY29uZmxpY3RlZDogV2Vha01hcDxOb2RlLCBNYXA8c3RyaW5nLCBzdHJpbmc+PjtcbiAqICAgY29tbWVudHM6IENvbW1lbnRbXTtcbiAqIH19IFN0YXRlXG4gKi9cblxuLyoqXG4gKiBAcGFyYW0ge05vZGV9IG5vZGVcbiAqIEBwYXJhbSB7U3RhdGV9IHN0YXRlXG4gKiBAcmV0dXJucyB7Q2h1bmtbXX1cbiAqL1xuZnVuY3Rpb24gaGFuZGxlKG5vZGUsIHN0YXRlKSB7XG5cdGNvbnN0IGhhbmRsZXIgPSBoYW5kbGVyc1tub2RlLnR5cGVdO1xuXG5cdGlmICghaGFuZGxlcikge1xuXHRcdHRocm93IG5ldyBFcnJvcihgTm90IGltcGxlbWVudGVkICR7bm9kZS50eXBlfWApO1xuXHR9XG5cblx0Y29uc3QgcmVzdWx0ID0gaGFuZGxlcihub2RlLCBzdGF0ZSk7XG5cblx0aWYgKG5vZGUubGVhZGluZ0NvbW1lbnRzKSB7XG5cdFx0cmVzdWx0LnVuc2hpZnQoYyhub2RlLmxlYWRpbmdDb21tZW50cy5tYXAoY29tbWVudCA9PiBjb21tZW50LnR5cGUgPT09ICdCbG9jaydcblx0XHRcdD8gYC8qJHtjb21tZW50LnZhbHVlfSovJHsvKiogQHR5cGUge2FueX0gKi8gKGNvbW1lbnQpLmhhc190cmFpbGluZ19uZXdsaW5lID8gYFxcbiR7c3RhdGUuaW5kZW50fWAgOiBgIGB9YFxuXHRcdFx0OiBgLy8ke2NvbW1lbnQudmFsdWV9JHsvKiogQHR5cGUge2FueX0gKi8gKGNvbW1lbnQpLmhhc190cmFpbGluZ19uZXdsaW5lID8gYFxcbiR7c3RhdGUuaW5kZW50fWAgOiBgIGB9YCkuam9pbihgYCkpKTtcblx0fVxuXG5cdGlmIChub2RlLnRyYWlsaW5nQ29tbWVudHMpIHtcblx0XHRzdGF0ZS5jb21tZW50cy5wdXNoKG5vZGUudHJhaWxpbmdDb21tZW50c1swXSk7IC8vIHRoZXJlIGlzIG9ubHkgZXZlciBvbmVcblx0fVxuXG5cdHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvbnRlbnRcbiAqIEBwYXJhbSB7Tm9kZX0gW25vZGVdXG4gKiBAcmV0dXJucyB7Q2h1bmt9XG4gKi9cbmZ1bmN0aW9uIGMoY29udGVudCwgbm9kZSkge1xuXHRyZXR1cm4ge1xuXHRcdGNvbnRlbnQsXG5cdFx0bG9jOiBub2RlICYmIG5vZGUubG9jLFxuXHRcdGhhc19uZXdsaW5lOiAvXFxuLy50ZXN0KGNvbnRlbnQpXG5cdH07XG59XG5cbmNvbnN0IE9QRVJBVE9SX1BSRUNFREVOQ0UgPSB7XG5cdCd8fCc6IDIsXG5cdCcmJic6IDMsXG5cdCc/Pyc6IDQsXG5cdCd8JzogNSxcblx0J14nOiA2LFxuXHQnJic6IDcsXG5cdCc9PSc6IDgsXG5cdCchPSc6IDgsXG5cdCc9PT0nOiA4LFxuXHQnIT09JzogOCxcblx0JzwnOiA5LFxuXHQnPic6IDksXG5cdCc8PSc6IDksXG5cdCc+PSc6IDksXG5cdGluOiA5LFxuXHRpbnN0YW5jZW9mOiA5LFxuXHQnPDwnOiAxMCxcblx0Jz4+JzogMTAsXG5cdCc+Pj4nOiAxMCxcblx0JysnOiAxMSxcblx0Jy0nOiAxMSxcblx0JyonOiAxMixcblx0JyUnOiAxMixcblx0Jy8nOiAxMixcblx0JyoqJzogMTMsXG59O1xuXG4vKiogQHR5cGUge1JlY29yZDxzdHJpbmcsIG51bWJlcj59ICovXG5jb25zdCBFWFBSRVNTSU9OU19QUkVDRURFTkNFID0ge1xuXHRBcnJheUV4cHJlc3Npb246IDIwLFxuXHRUYWdnZWRUZW1wbGF0ZUV4cHJlc3Npb246IDIwLFxuXHRUaGlzRXhwcmVzc2lvbjogMjAsXG5cdElkZW50aWZpZXI6IDIwLFxuXHRMaXRlcmFsOiAxOCxcblx0VGVtcGxhdGVMaXRlcmFsOiAyMCxcblx0U3VwZXI6IDIwLFxuXHRTZXF1ZW5jZUV4cHJlc3Npb246IDIwLFxuXHRNZW1iZXJFeHByZXNzaW9uOiAxOSxcblx0Q2FsbEV4cHJlc3Npb246IDE5LFxuXHROZXdFeHByZXNzaW9uOiAxOSxcblx0QXdhaXRFeHByZXNzaW9uOiAxNyxcblx0Q2xhc3NFeHByZXNzaW9uOiAxNyxcblx0RnVuY3Rpb25FeHByZXNzaW9uOiAxNyxcblx0T2JqZWN0RXhwcmVzc2lvbjogMTcsXG5cdFVwZGF0ZUV4cHJlc3Npb246IDE2LFxuXHRVbmFyeUV4cHJlc3Npb246IDE1LFxuXHRCaW5hcnlFeHByZXNzaW9uOiAxNCxcblx0TG9naWNhbEV4cHJlc3Npb246IDEzLFxuXHRDb25kaXRpb25hbEV4cHJlc3Npb246IDQsXG5cdEFycm93RnVuY3Rpb25FeHByZXNzaW9uOiAzLFxuXHRBc3NpZ25tZW50RXhwcmVzc2lvbjogMyxcblx0WWllbGRFeHByZXNzaW9uOiAyLFxuXHRSZXN0RWxlbWVudDogMVxufTtcblxuLyoqXG4gKlxuICogQHBhcmFtIHtFeHByZXNzaW9ufSBub2RlXG4gKiBAcGFyYW0ge0JpbmFyeUV4cHJlc3Npb24gfCBMb2dpY2FsRXhwcmVzc2lvbn0gcGFyZW50XG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzX3JpZ2h0XG4gKiBAcmV0dXJuc1xuICovXG5mdW5jdGlvbiBuZWVkc19wYXJlbnMobm9kZSwgcGFyZW50LCBpc19yaWdodCkge1xuXHQvLyBzcGVjaWFsIGNhc2Ugd2hlcmUgbG9naWNhbCBleHByZXNzaW9ucyBhbmQgY29hbGVzY2UgZXhwcmVzc2lvbnMgY2Fubm90IGJlIG1peGVkLFxuXHQvLyBlaXRoZXIgb2YgdGhlbSBuZWVkIHRvIGJlIHdyYXBwZWQgd2l0aCBwYXJlbnRoZXNlc1xuXHRpZiAoXG5cdFx0bm9kZS50eXBlID09PSAnTG9naWNhbEV4cHJlc3Npb24nICYmXG5cdFx0cGFyZW50LnR5cGUgPT09ICdMb2dpY2FsRXhwcmVzc2lvbicgJiZcblx0XHQoKHBhcmVudC5vcGVyYXRvciA9PT0gJz8/JyAmJiBub2RlLm9wZXJhdG9yICE9PSAnPz8nKSB8fFxuXHRcdFx0KHBhcmVudC5vcGVyYXRvciAhPT0gJz8/JyAmJiBub2RlLm9wZXJhdG9yID09PSAnPz8nKSlcblx0KSB7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRjb25zdCBwcmVjZWRlbmNlID0gRVhQUkVTU0lPTlNfUFJFQ0VERU5DRVtub2RlLnR5cGVdO1xuXHRjb25zdCBwYXJlbnRfcHJlY2VkZW5jZSA9IEVYUFJFU1NJT05TX1BSRUNFREVOQ0VbcGFyZW50LnR5cGVdO1xuXG5cdGlmIChwcmVjZWRlbmNlICE9PSBwYXJlbnRfcHJlY2VkZW5jZSkge1xuXHRcdC8vIERpZmZlcmVudCBub2RlIHR5cGVzXG5cdFx0cmV0dXJuIChcblx0XHRcdCghaXNfcmlnaHQgJiZcblx0XHRcdFx0cHJlY2VkZW5jZSA9PT0gMTUgJiZcblx0XHRcdFx0cGFyZW50X3ByZWNlZGVuY2UgPT09IDE0ICYmXG5cdFx0XHRcdHBhcmVudC5vcGVyYXRvciA9PT0gJyoqJykgfHxcblx0XHRcdHByZWNlZGVuY2UgPCBwYXJlbnRfcHJlY2VkZW5jZVxuXHRcdCk7XG5cdH1cblxuXHRpZiAocHJlY2VkZW5jZSAhPT0gMTMgJiYgcHJlY2VkZW5jZSAhPT0gMTQpIHtcblx0XHQvLyBOb3QgYSBgTG9naWNhbEV4cHJlc3Npb25gIG9yIGBCaW5hcnlFeHByZXNzaW9uYFxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGlmICgvKiogQHR5cGUge0JpbmFyeUV4cHJlc3Npb259ICovIChub2RlKS5vcGVyYXRvciA9PT0gJyoqJyAmJiBwYXJlbnQub3BlcmF0b3IgPT09ICcqKicpIHtcblx0XHQvLyBFeHBvbmVudGlhdGlvbiBvcGVyYXRvciBoYXMgcmlnaHQtdG8tbGVmdCBhc3NvY2lhdGl2aXR5XG5cdFx0cmV0dXJuICFpc19yaWdodDtcblx0fVxuXG5cdGlmIChpc19yaWdodCkge1xuXHRcdC8vIFBhcmVudGhlc2lzIGFyZSB1c2VkIGlmIGJvdGggb3BlcmF0b3JzIGhhdmUgdGhlIHNhbWUgcHJlY2VkZW5jZVxuXHRcdHJldHVybiAoXG5cdFx0XHRPUEVSQVRPUl9QUkVDRURFTkNFWy8qKiBAdHlwZSB7QmluYXJ5RXhwcmVzc2lvbn0gKi8gKG5vZGUpLm9wZXJhdG9yXSA8PVxuXHRcdFx0T1BFUkFUT1JfUFJFQ0VERU5DRVtwYXJlbnQub3BlcmF0b3JdXG5cdFx0KTtcblx0fVxuXG5cdHJldHVybiAoXG5cdFx0T1BFUkFUT1JfUFJFQ0VERU5DRVsvKiogQHR5cGUge0JpbmFyeUV4cHJlc3Npb259ICovIChub2RlKS5vcGVyYXRvcl0gPFxuXHRcdE9QRVJBVE9SX1BSRUNFREVOQ0VbcGFyZW50Lm9wZXJhdG9yXVxuXHQpO1xufVxuXG4vKiogQHBhcmFtIHtOb2RlfSBub2RlICovXG5mdW5jdGlvbiBoYXNfY2FsbF9leHByZXNzaW9uKG5vZGUpIHtcblx0d2hpbGUgKG5vZGUpIHtcblx0XHRpZiAobm9kZS50eXBlWzBdID09PSAnQ2FsbEV4cHJlc3Npb24nKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ01lbWJlckV4cHJlc3Npb24nKSB7XG5cdFx0XHRub2RlID0gbm9kZS5vYmplY3Q7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cbn1cblxuLyoqIEBwYXJhbSB7Q2h1bmtbXX0gY2h1bmtzICovXG5jb25zdCBoYXNfbmV3bGluZSA9IChjaHVua3MpID0+IHtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjaHVua3MubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRpZiAoY2h1bmtzW2ldLmhhc19uZXdsaW5lKSByZXR1cm4gdHJ1ZTtcblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG4vKiogQHBhcmFtIHtDaHVua1tdfSBjaHVua3MgKi9cbmNvbnN0IGdldF9sZW5ndGggPSAoY2h1bmtzKSA9PiB7XG5cdGxldCB0b3RhbCA9IDA7XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgY2h1bmtzLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0dG90YWwgKz0gY2h1bmtzW2ldLmNvbnRlbnQubGVuZ3RoO1xuXHR9XG5cdHJldHVybiB0b3RhbDtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtudW1iZXJ9IGFcbiAqIEBwYXJhbSB7bnVtYmVyfSBiXG4gKi9cbmNvbnN0IHN1bSA9IChhLCBiKSA9PiBhICsgYjtcblxuLyoqXG4gKiBAcGFyYW0ge0NodW5rW11bXX0gbm9kZXNcbiAqIEBwYXJhbSB7Q2h1bmt9IHNlcGFyYXRvclxuICogQHJldHVybnMge0NodW5rW119XG4gKi9cbmNvbnN0IGpvaW4gPSAobm9kZXMsIHNlcGFyYXRvcikgPT4ge1xuXHRpZiAobm9kZXMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XG5cblx0Y29uc3Qgam9pbmVkID0gWy4uLm5vZGVzWzBdXTtcblx0Zm9yIChsZXQgaSA9IDE7IGkgPCBub2Rlcy5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdGpvaW5lZC5wdXNoKHNlcGFyYXRvcik7XG5cdFx0cHVzaF9hcnJheShqb2luZWQsIG5vZGVzW2ldKTtcblx0fVxuXHRyZXR1cm4gam9pbmVkO1xufTtcblxuLyoqXG4gKiBAcGFyYW0geyhub2RlOiBhbnksIHN0YXRlOiBTdGF0ZSkgPT4gQ2h1bmtbXX0gZm5cbiAqL1xuY29uc3Qgc2NvcGVkID0gKGZuKSA9PiB7XG5cdC8qKlxuXHQgKiBAcGFyYW0ge2FueX0gbm9kZVxuXHQgKiBAcGFyYW0ge1N0YXRlfSBzdGF0ZVxuXHQgKi9cblx0Y29uc3Qgc2NvcGVkX2ZuID0gKG5vZGUsIHN0YXRlKSA9PiB7XG5cdFx0cmV0dXJuIGZuKG5vZGUsIHtcblx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0c2NvcGU6IHN0YXRlLnNjb3BlX21hcC5nZXQobm9kZSlcblx0XHR9KTtcblx0fTtcblxuXHRyZXR1cm4gc2NvcGVkX2ZuO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtTZXQ8c3RyaW5nPn0gbmFtZXNcbiAqL1xuY29uc3QgZGVjb25mbGljdCA9IChuYW1lLCBuYW1lcykgPT4ge1xuXHRjb25zdCBvcmlnaW5hbCA9IG5hbWU7XG5cdGxldCBpID0gMTtcblxuXHR3aGlsZSAobmFtZXMuaGFzKG5hbWUpKSB7XG5cdFx0bmFtZSA9IGAke29yaWdpbmFsfSQke2krK31gO1xuXHR9XG5cblx0cmV0dXJuIG5hbWU7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7Tm9kZVtdfSBub2Rlc1xuICogQHBhcmFtIHtTdGF0ZX0gc3RhdGVcbiAqL1xuY29uc3QgaGFuZGxlX2JvZHkgPSAobm9kZXMsIHN0YXRlKSA9PiB7XG5cdGNvbnN0IGNodW5rcyA9IFtdO1xuXG5cdGNvbnN0IGJvZHkgPSBub2Rlcy5tYXAoc3RhdGVtZW50ID0+IHtcblx0XHRjb25zdCBjaHVua3MgPSBoYW5kbGUoc3RhdGVtZW50LCB7XG5cdFx0XHQuLi5zdGF0ZSxcblx0XHRcdGluZGVudDogc3RhdGUuaW5kZW50XG5cdFx0fSk7XG5cblx0XHRsZXQgYWRkX25ld2xpbmUgPSBmYWxzZTtcblxuXHRcdHdoaWxlIChzdGF0ZS5jb21tZW50cy5sZW5ndGgpIHtcblx0XHRcdGNvbnN0IGNvbW1lbnQgPSBzdGF0ZS5jb21tZW50cy5zaGlmdCgpO1xuXHRcdFx0Y29uc3QgcHJlZml4ID0gYWRkX25ld2xpbmUgPyBgXFxuJHtzdGF0ZS5pbmRlbnR9YCA6IGAgYDtcblxuXHRcdFx0Y2h1bmtzLnB1c2goYyhjb21tZW50LnR5cGUgPT09ICdCbG9jaydcblx0XHRcdFx0PyBgJHtwcmVmaXh9Lyoke2NvbW1lbnQudmFsdWV9Ki9gXG5cdFx0XHRcdDogYCR7cHJlZml4fS8vJHtjb21tZW50LnZhbHVlfWApKTtcblxuXHRcdFx0YWRkX25ld2xpbmUgPSAoY29tbWVudC50eXBlID09PSAnTGluZScpO1xuXHRcdH1cblxuXHRcdHJldHVybiBjaHVua3M7XG5cdH0pO1xuXG5cdGxldCBuZWVkZWRfcGFkZGluZyA9IGZhbHNlO1xuXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgYm9keS5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdGNvbnN0IG5lZWRzX3BhZGRpbmcgPSBoYXNfbmV3bGluZShib2R5W2ldKTtcblxuXHRcdGlmIChpID4gMCkge1xuXHRcdFx0Y2h1bmtzLnB1c2goXG5cdFx0XHRcdGMobmVlZHNfcGFkZGluZyB8fCBuZWVkZWRfcGFkZGluZyA/IGBcXG5cXG4ke3N0YXRlLmluZGVudH1gIDogYFxcbiR7c3RhdGUuaW5kZW50fWApXG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBib2R5W2ldKTtcblxuXHRcdG5lZWRlZF9wYWRkaW5nID0gbmVlZHNfcGFkZGluZztcblx0fVxuXG5cdHJldHVybiBjaHVua3M7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7VmFyaWFibGVEZWNsYXJhdGlvbn0gbm9kZVxuICogQHBhcmFtIHtTdGF0ZX0gc3RhdGVcbiAqL1xuY29uc3QgaGFuZGxlX3Zhcl9kZWNsYXJhdGlvbiA9IChub2RlLCBzdGF0ZSkgPT4ge1xuXHRjb25zdCBjaHVua3MgPSBbYyhgJHtub2RlLmtpbmR9IGApXTtcblxuXHRjb25zdCBkZWNsYXJhdG9ycyA9IG5vZGUuZGVjbGFyYXRpb25zLm1hcChkID0+IGhhbmRsZShkLCB7XG5cdFx0Li4uc3RhdGUsXG5cdFx0aW5kZW50OiBzdGF0ZS5pbmRlbnQgKyAobm9kZS5kZWNsYXJhdGlvbnMubGVuZ3RoID09PSAxID8gJycgOiAnXFx0Jylcblx0fSkpO1xuXG5cdGNvbnN0IG11bHRpcGxlX2xpbmVzID0gKFxuXHRcdGRlY2xhcmF0b3JzLnNvbWUoaGFzX25ld2xpbmUpIHx8XG5cdFx0KGRlY2xhcmF0b3JzLm1hcChnZXRfbGVuZ3RoKS5yZWR1Y2Uoc3VtLCAwKSArIChzdGF0ZS5pbmRlbnQubGVuZ3RoICsgZGVjbGFyYXRvcnMubGVuZ3RoIC0gMSkgKiAyKSA+IDgwXG5cdCk7XG5cblx0Y29uc3Qgc2VwYXJhdG9yID0gYyhtdWx0aXBsZV9saW5lcyA/IGAsXFxuJHtzdGF0ZS5pbmRlbnR9XFx0YCA6ICcsICcpO1xuXG5cdHB1c2hfYXJyYXkoY2h1bmtzLCBqb2luKGRlY2xhcmF0b3JzLCBzZXBhcmF0b3IpKTtcblxuXHRyZXR1cm4gY2h1bmtzO1xufTtcblxuLyoqIEB0eXBlIHtSZWNvcmQ8c3RyaW5nLCBIYW5kbGVyPn0gKi9cbmNvbnN0IGhhbmRsZXJzID0ge1xuXHRQcm9ncmFtKG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIGhhbmRsZV9ib2R5KG5vZGUuYm9keSwgc3RhdGUpO1xuXHR9LFxuXG5cdEJsb2NrU3RhdGVtZW50OiBzY29wZWQoKG5vZGUsIHN0YXRlKSA9PiB7XG5cdFx0cmV0dXJuIFtcblx0XHRcdGMoYHtcXG4ke3N0YXRlLmluZGVudH1cXHRgKSxcblx0XHRcdC4uLmhhbmRsZV9ib2R5KG5vZGUuYm9keSwgeyAuLi5zdGF0ZSwgaW5kZW50OiBzdGF0ZS5pbmRlbnQgKyAnXFx0JyB9KSxcblx0XHRcdGMoYFxcbiR7c3RhdGUuaW5kZW50fX1gKVxuXHRcdF07XG5cdH0pLFxuXG5cdEVtcHR5U3RhdGVtZW50KG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIFtjKCc7JyldO1xuXHR9LFxuXG5cdFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIGhhbmRsZShub2RlLmV4cHJlc3Npb24sIHN0YXRlKTtcblx0fSxcblxuXHRFeHByZXNzaW9uU3RhdGVtZW50KG5vZGUsIHN0YXRlKSB7XG5cdFx0aWYgKFxuXHRcdFx0bm9kZS5leHByZXNzaW9uLnR5cGUgPT09ICdBc3NpZ25tZW50RXhwcmVzc2lvbicgJiZcblx0XHRcdG5vZGUuZXhwcmVzc2lvbi5sZWZ0LnR5cGUgPT09ICdPYmplY3RQYXR0ZXJuJ1xuXHRcdCkge1xuXHRcdFx0Ly8gaXMgYW4gQXNzaWdubWVudEV4cHJlc3Npb24gdG8gYW4gT2JqZWN0UGF0dGVyblxuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0YygnKCcpLFxuXHRcdFx0XHQuLi5oYW5kbGUobm9kZS5leHByZXNzaW9uLCBzdGF0ZSksXG5cdFx0XHRcdGMoJyk7Jylcblx0XHRcdF07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIFtcblx0XHRcdC4uLmhhbmRsZShub2RlLmV4cHJlc3Npb24sIHN0YXRlKSxcblx0XHRcdGMoJzsnKVxuXHRcdF07XG5cdH0sXG5cblx0SWZTdGF0ZW1lbnQobm9kZSwgc3RhdGUpIHtcblx0XHRjb25zdCBjaHVua3MgPSBbXG5cdFx0XHRjKCdpZiAoJyksXG5cdFx0XHQuLi5oYW5kbGUobm9kZS50ZXN0LCBzdGF0ZSksXG5cdFx0XHRjKCcpICcpLFxuXHRcdFx0Li4uaGFuZGxlKG5vZGUuY29uc2VxdWVudCwgc3RhdGUpXG5cdFx0XTtcblxuXHRcdGlmIChub2RlLmFsdGVybmF0ZSkge1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnIGVsc2UgJykpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmFsdGVybmF0ZSwgc3RhdGUpKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gY2h1bmtzO1xuXHR9LFxuXG5cdExhYmVsZWRTdGF0ZW1lbnQobm9kZSwgc3RhdGUpIHtcblx0XHRyZXR1cm4gW1xuXHRcdFx0Li4uaGFuZGxlKG5vZGUubGFiZWwsIHN0YXRlKSxcblx0XHRcdGMoJzogJyksXG5cdFx0XHQuLi5oYW5kbGUobm9kZS5ib2R5LCBzdGF0ZSlcblx0XHRdO1xuXHR9LFxuXG5cdEJyZWFrU3RhdGVtZW50KG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIG5vZGUubGFiZWxcblx0XHRcdD8gW2MoJ2JyZWFrICcpLCAuLi5oYW5kbGUobm9kZS5sYWJlbCwgc3RhdGUpLCBjKCc7JyldXG5cdFx0XHQ6IFtjKCdicmVhazsnKV07XG5cdH0sXG5cblx0Q29udGludWVTdGF0ZW1lbnQobm9kZSwgc3RhdGUpIHtcblx0XHRyZXR1cm4gbm9kZS5sYWJlbFxuXHRcdFx0PyBbYygnY29udGludWUgJyksIC4uLmhhbmRsZShub2RlLmxhYmVsLCBzdGF0ZSksIGMoJzsnKV1cblx0XHRcdDogW2MoJ2NvbnRpbnVlOycpXTtcblx0fSxcblxuXHRXaXRoU3RhdGVtZW50KG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIFtcblx0XHRcdGMoJ3dpdGggKCcpLFxuXHRcdFx0Li4uaGFuZGxlKG5vZGUub2JqZWN0LCBzdGF0ZSksXG5cdFx0XHRjKCcpICcpLFxuXHRcdFx0Li4uaGFuZGxlKG5vZGUuYm9keSwgc3RhdGUpXG5cdFx0XTtcblx0fSxcblxuXHRTd2l0Y2hTdGF0ZW1lbnQoLyoqIEB0eXBlIHtTd2l0Y2hTdGF0ZW1lbnR9ICovIG5vZGUsIHN0YXRlKSB7XG5cdFx0Y29uc3QgY2h1bmtzID0gW1xuXHRcdFx0Yygnc3dpdGNoICgnKSxcblx0XHRcdC4uLmhhbmRsZShub2RlLmRpc2NyaW1pbmFudCwgc3RhdGUpLFxuXHRcdFx0YygnKSB7Jylcblx0XHRdO1xuXG5cdFx0bm9kZS5jYXNlcy5mb3JFYWNoKGJsb2NrID0+IHtcblx0XHRcdGlmIChibG9jay50ZXN0KSB7XG5cdFx0XHRcdGNodW5rcy5wdXNoKGMoYFxcbiR7c3RhdGUuaW5kZW50fVxcdGNhc2UgYCkpO1xuXHRcdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKGJsb2NrLnRlc3QsIHsgLi4uc3RhdGUsIGluZGVudDogYCR7c3RhdGUuaW5kZW50fVxcdGAgfSkpO1xuXHRcdFx0XHRjaHVua3MucHVzaChjKCc6JykpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2h1bmtzLnB1c2goYyhgXFxuJHtzdGF0ZS5pbmRlbnR9XFx0ZGVmYXVsdDpgKSk7XG5cdFx0XHR9XG5cblx0XHRcdGJsb2NrLmNvbnNlcXVlbnQuZm9yRWFjaChzdGF0ZW1lbnQgPT4ge1xuXHRcdFx0XHRjaHVua3MucHVzaChjKGBcXG4ke3N0YXRlLmluZGVudH1cXHRcXHRgKSk7XG5cdFx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUoc3RhdGVtZW50LCB7IC4uLnN0YXRlLCBpbmRlbnQ6IGAke3N0YXRlLmluZGVudH1cXHRcXHRgIH0pKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Y2h1bmtzLnB1c2goYyhgXFxuJHtzdGF0ZS5pbmRlbnR9fWApKTtcblxuXHRcdHJldHVybiBjaHVua3M7XG5cdH0sXG5cblx0UmV0dXJuU3RhdGVtZW50KG5vZGUsIHN0YXRlKSB7XG5cdFx0aWYgKG5vZGUuYXJndW1lbnQpIHtcblx0XHRcdGNvbnN0IGNvbnRhaW5zX2NvbW1lbnQgPSBub2RlLmFyZ3VtZW50LmxlYWRpbmdDb21tZW50cyAmJiBub2RlLmFyZ3VtZW50LmxlYWRpbmdDb21tZW50cy5zb21lKCgvKiogQHR5cGUgaW1wb3J0KCcuLi91dGlscy9jb21tZW50cy5qcycpLkNvbW1lbnRXaXRoTG9jYXRpb24gKi8gY29tbWVudCkgPT4gY29tbWVudC5oYXNfdHJhaWxpbmdfbmV3bGluZSk7XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHRjKGNvbnRhaW5zX2NvbW1lbnQgPyAncmV0dXJuICgnIDogJ3JldHVybiAnKSxcblx0XHRcdFx0Li4uaGFuZGxlKG5vZGUuYXJndW1lbnQsIHN0YXRlKSxcblx0XHRcdFx0Yyhjb250YWluc19jb21tZW50ID8gJyk7JyA6ICc7Jylcblx0XHRcdF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBbYygncmV0dXJuOycpXTtcblx0XHR9XG5cdH0sXG5cblx0VGhyb3dTdGF0ZW1lbnQobm9kZSwgc3RhdGUpIHtcblx0XHRyZXR1cm4gW1xuXHRcdFx0YygndGhyb3cgJyksXG5cdFx0XHQuLi5oYW5kbGUobm9kZS5hcmd1bWVudCwgc3RhdGUpLFxuXHRcdFx0YygnOycpXG5cdFx0XTtcblx0fSxcblxuXHRUcnlTdGF0ZW1lbnQobm9kZSwgc3RhdGUpIHtcblx0XHRjb25zdCBjaHVua3MgPSBbXG5cdFx0XHRjKCd0cnkgJyksXG5cdFx0XHQuLi5oYW5kbGUobm9kZS5ibG9jaywgc3RhdGUpXG5cdFx0XTtcblxuXHRcdGlmIChub2RlLmhhbmRsZXIpIHtcblx0XHRcdGlmIChub2RlLmhhbmRsZXIucGFyYW0pIHtcblx0XHRcdFx0Y2h1bmtzLnB1c2goYygnIGNhdGNoKCcpKTtcblx0XHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmhhbmRsZXIucGFyYW0sIHN0YXRlKSk7XG5cdFx0XHRcdGNodW5rcy5wdXNoKGMoJykgJykpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2h1bmtzLnB1c2goYygnIGNhdGNoICcpKTtcblx0XHRcdH1cblxuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmhhbmRsZXIuYm9keSwgc3RhdGUpKTtcblx0XHR9XG5cblx0XHRpZiAobm9kZS5maW5hbGl6ZXIpIHtcblx0XHRcdGNodW5rcy5wdXNoKGMoJyBmaW5hbGx5ICcpKTtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5maW5hbGl6ZXIsIHN0YXRlKSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSxcblxuXHRXaGlsZVN0YXRlbWVudChub2RlLCBzdGF0ZSkge1xuXHRcdHJldHVybiBbXG5cdFx0XHRjKCd3aGlsZSAoJyksXG5cdFx0XHQuLi5oYW5kbGUobm9kZS50ZXN0LCBzdGF0ZSksXG5cdFx0XHRjKCcpICcpLFxuXHRcdFx0Li4uaGFuZGxlKG5vZGUuYm9keSwgc3RhdGUpXG5cdFx0XTtcblx0fSxcblxuXHREb1doaWxlU3RhdGVtZW50KG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIFtcblx0XHRcdGMoJ2RvICcpLFxuXHRcdFx0Li4uaGFuZGxlKG5vZGUuYm9keSwgc3RhdGUpLFxuXHRcdFx0YygnIHdoaWxlICgnKSxcblx0XHRcdC4uLmhhbmRsZShub2RlLnRlc3QsIHN0YXRlKSxcblx0XHRcdGMoJyk7Jylcblx0XHRdO1xuXHR9LFxuXG5cdEZvclN0YXRlbWVudDogc2NvcGVkKChub2RlLCBzdGF0ZSkgPT4ge1xuXHRcdGNvbnN0IGNodW5rcyA9IFtjKCdmb3IgKCcpXTtcblxuXHRcdGlmIChub2RlLmluaXQpIHtcblx0XHRcdGlmIChub2RlLmluaXQudHlwZSA9PT0gJ1ZhcmlhYmxlRGVjbGFyYXRpb24nKSB7XG5cdFx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGVfdmFyX2RlY2xhcmF0aW9uKG5vZGUuaW5pdCwgc3RhdGUpKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5pbml0LCBzdGF0ZSkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGNodW5rcy5wdXNoKGMoJzsgJykpO1xuXHRcdGlmIChub2RlLnRlc3QpIHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS50ZXN0LCBzdGF0ZSkpO1xuXHRcdGNodW5rcy5wdXNoKGMoJzsgJykpO1xuXHRcdGlmIChub2RlLnVwZGF0ZSkgcHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLnVwZGF0ZSwgc3RhdGUpKTtcblxuXHRcdGNodW5rcy5wdXNoKGMoJykgJykpO1xuXHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5ib2R5LCBzdGF0ZSkpO1xuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSksXG5cblx0Rm9ySW5TdGF0ZW1lbnQ6IHNjb3BlZCgobm9kZSwgc3RhdGUpID0+IHtcblx0XHRjb25zdCBjaHVua3MgPSBbXG5cdFx0XHRjKGBmb3IgJHtub2RlLmF3YWl0ID8gJ2F3YWl0ICcgOiAnJ30oYClcblx0XHRdO1xuXG5cdFx0aWYgKG5vZGUubGVmdC50eXBlID09PSAnVmFyaWFibGVEZWNsYXJhdGlvbicpIHtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGVfdmFyX2RlY2xhcmF0aW9uKG5vZGUubGVmdCwgc3RhdGUpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmxlZnQsIHN0YXRlKSk7XG5cdFx0fVxuXG5cdFx0Y2h1bmtzLnB1c2goYyhub2RlLnR5cGUgPT09ICdGb3JJblN0YXRlbWVudCcgPyBgIGluIGAgOiBgIG9mIGApKTtcblx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUucmlnaHQsIHN0YXRlKSk7XG5cdFx0Y2h1bmtzLnB1c2goYygnKSAnKSk7XG5cdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmJvZHksIHN0YXRlKSk7XG5cblx0XHRyZXR1cm4gY2h1bmtzO1xuXHR9KSxcblxuXHREZWJ1Z2dlclN0YXRlbWVudChub2RlLCBzdGF0ZSkge1xuXHRcdHJldHVybiBbYygnZGVidWdnZXInLCBub2RlKSwgYygnOycpXTtcblx0fSxcblxuXHRGdW5jdGlvbkRlY2xhcmF0aW9uOiBzY29wZWQoKC8qKiBAdHlwZSB7RnVuY3Rpb25EZWNsYXJhdGlvbn0gKi8gbm9kZSwgc3RhdGUpID0+IHtcblx0XHRjb25zdCBjaHVua3MgPSBbXTtcblxuXHRcdGlmIChub2RlLmFzeW5jKSBjaHVua3MucHVzaChjKCdhc3luYyAnKSk7XG5cdFx0Y2h1bmtzLnB1c2goYyhub2RlLmdlbmVyYXRvciA/ICdmdW5jdGlvbiogJyA6ICdmdW5jdGlvbiAnKSk7XG5cdFx0aWYgKG5vZGUuaWQpIHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5pZCwgc3RhdGUpKTtcblx0XHRjaHVua3MucHVzaChjKCcoJykpO1xuXG5cdFx0Y29uc3QgcGFyYW1zID0gbm9kZS5wYXJhbXMubWFwKHAgPT4gaGFuZGxlKHAsIHtcblx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0aW5kZW50OiBzdGF0ZS5pbmRlbnQgKyAnXFx0J1xuXHRcdH0pKTtcblxuXHRcdGNvbnN0IG11bHRpcGxlX2xpbmVzID0gKFxuXHRcdFx0cGFyYW1zLnNvbWUoaGFzX25ld2xpbmUpIHx8XG5cdFx0XHQocGFyYW1zLm1hcChnZXRfbGVuZ3RoKS5yZWR1Y2Uoc3VtLCAwKSArIChzdGF0ZS5pbmRlbnQubGVuZ3RoICsgcGFyYW1zLmxlbmd0aCAtIDEpICogMikgPiA4MFxuXHRcdCk7XG5cblx0XHRjb25zdCBzZXBhcmF0b3IgPSBjKG11bHRpcGxlX2xpbmVzID8gYCxcXG4ke3N0YXRlLmluZGVudH1gIDogJywgJyk7XG5cblx0XHRpZiAobXVsdGlwbGVfbGluZXMpIHtcblx0XHRcdGNodW5rcy5wdXNoKGMoYFxcbiR7c3RhdGUuaW5kZW50fVxcdGApKTtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBqb2luKHBhcmFtcywgc2VwYXJhdG9yKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKGBcXG4ke3N0YXRlLmluZGVudH1gKSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBqb2luKHBhcmFtcywgc2VwYXJhdG9yKSk7XG5cdFx0fVxuXG5cdFx0Y2h1bmtzLnB1c2goYygnKSAnKSk7XG5cdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmJvZHksIHN0YXRlKSk7XG5cblx0XHRyZXR1cm4gY2h1bmtzO1xuXHR9KSxcblxuXHRWYXJpYWJsZURlY2xhcmF0aW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIGhhbmRsZV92YXJfZGVjbGFyYXRpb24obm9kZSwgc3RhdGUpLmNvbmNhdChjKCc7JykpO1xuXHR9LFxuXG5cdFZhcmlhYmxlRGVjbGFyYXRvcihub2RlLCBzdGF0ZSkge1xuXHRcdGlmIChub2RlLmluaXQpIHtcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdC4uLmhhbmRsZShub2RlLmlkLCBzdGF0ZSksXG5cdFx0XHRcdGMoJyA9ICcpLFxuXHRcdFx0XHQuLi5oYW5kbGUobm9kZS5pbml0LCBzdGF0ZSlcblx0XHRcdF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBoYW5kbGUobm9kZS5pZCwgc3RhdGUpO1xuXHRcdH1cblx0fSxcblxuXHRDbGFzc0RlY2xhcmF0aW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0Y29uc3QgY2h1bmtzID0gW2MoJ2NsYXNzICcpXTtcblxuXHRcdGlmIChub2RlLmlkKSB7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUuaWQsIHN0YXRlKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCcgJykpO1xuXHRcdH1cblxuXHRcdGlmIChub2RlLnN1cGVyQ2xhc3MpIHtcblx0XHRcdGNodW5rcy5wdXNoKGMoJ2V4dGVuZHMgJykpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLnN1cGVyQ2xhc3MsIHN0YXRlKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCcgJykpO1xuXHRcdH1cblxuXHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5ib2R5LCBzdGF0ZSkpO1xuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSxcblxuXHRJbXBvcnREZWNsYXJhdGlvbigvKiogQHR5cGUge0ltcG9ydERlY2xhcmF0aW9ufSAqLyBub2RlLCBzdGF0ZSkge1xuXHRcdGNvbnN0IGNodW5rcyA9IFtjKCdpbXBvcnQgJyldO1xuXG5cdFx0Y29uc3QgeyBsZW5ndGggfSA9IG5vZGUuc3BlY2lmaWVycztcblx0XHRjb25zdCBzb3VyY2UgPSBoYW5kbGUobm9kZS5zb3VyY2UsIHN0YXRlKTtcblxuXHRcdGlmIChsZW5ndGggPiAwKSB7XG5cdFx0XHRsZXQgaSA9IDA7XG5cblx0XHRcdHdoaWxlIChpIDwgbGVuZ3RoKSB7XG5cdFx0XHRcdGlmIChpID4gMCkge1xuXHRcdFx0XHRcdGNodW5rcy5wdXNoKGMoJywgJykpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3Qgc3BlY2lmaWVyID0gbm9kZS5zcGVjaWZpZXJzW2ldO1xuXG5cdFx0XHRcdGlmIChzcGVjaWZpZXIudHlwZSA9PT0gJ0ltcG9ydERlZmF1bHRTcGVjaWZpZXInKSB7XG5cdFx0XHRcdFx0Y2h1bmtzLnB1c2goYyhzcGVjaWZpZXIubG9jYWwubmFtZSwgc3BlY2lmaWVyKSk7XG5cdFx0XHRcdFx0aSArPSAxO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHNwZWNpZmllci50eXBlID09PSAnSW1wb3J0TmFtZXNwYWNlU3BlY2lmaWVyJykge1xuXHRcdFx0XHRcdGNodW5rcy5wdXNoKGMoJyogYXMgJyArIHNwZWNpZmllci5sb2NhbC5uYW1lLCBzcGVjaWZpZXIpKTtcblx0XHRcdFx0XHRpICs9IDE7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKGkgPCBsZW5ndGgpIHtcblx0XHRcdFx0Ly8gd2UgaGF2ZSBuYW1lZCBzcGVjaWZpZXJzXG5cdFx0XHRcdGNvbnN0IHNwZWNpZmllcnMgPSBub2RlLnNwZWNpZmllcnMuc2xpY2UoaSkubWFwKCgvKiogQHR5cGUge0ltcG9ydFNwZWNpZmllcn0gKi8gc3BlY2lmaWVyKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgbmFtZSA9IGhhbmRsZShzcGVjaWZpZXIuaW1wb3J0ZWQsIHN0YXRlKVswXTtcblx0XHRcdFx0XHRjb25zdCBhcyA9IGhhbmRsZShzcGVjaWZpZXIubG9jYWwsIHN0YXRlKVswXTtcblxuXHRcdFx0XHRcdGlmIChuYW1lLmNvbnRlbnQgPT09IGFzLmNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdHJldHVybiBbYXNdO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBbbmFtZSwgYygnIGFzICcpLCBhc107XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGNvbnN0IHdpZHRoID0gZ2V0X2xlbmd0aChjaHVua3MpICsgc3BlY2lmaWVycy5tYXAoZ2V0X2xlbmd0aCkucmVkdWNlKHN1bSwgMCkgKyAoMiAqIHNwZWNpZmllcnMubGVuZ3RoKSArIDYgKyBnZXRfbGVuZ3RoKHNvdXJjZSk7XG5cblx0XHRcdFx0aWYgKHdpZHRoID4gODApIHtcblx0XHRcdFx0XHRjaHVua3MucHVzaChjKGB7XFxuXFx0YCkpO1xuXHRcdFx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBqb2luKHNwZWNpZmllcnMsIGMoJyxcXG5cXHQnKSkpO1xuXHRcdFx0XHRcdGNodW5rcy5wdXNoKGMoJ1xcbn0nKSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y2h1bmtzLnB1c2goYyhgeyBgKSk7XG5cdFx0XHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGpvaW4oc3BlY2lmaWVycywgYygnLCAnKSkpO1xuXHRcdFx0XHRcdGNodW5rcy5wdXNoKGMoJyB9JykpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGNodW5rcy5wdXNoKGMoJyBmcm9tICcpKTtcblx0XHR9XG5cblx0XHRwdXNoX2FycmF5KGNodW5rcywgc291cmNlKTtcblx0XHRjaHVua3MucHVzaChjKCc7JykpO1xuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSxcblxuXHRJbXBvcnRFeHByZXNzaW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIFtjKCdpbXBvcnQoJyksIC4uLmhhbmRsZShub2RlLnNvdXJjZSwgc3RhdGUpLCBjKCcpJyldO1xuXHR9LFxuXG5cdEV4cG9ydERlZmF1bHREZWNsYXJhdGlvbihub2RlLCBzdGF0ZSkge1xuXHRcdGNvbnN0IGNodW5rcyA9IFtcblx0XHRcdGMoYGV4cG9ydCBkZWZhdWx0IGApLFxuXHRcdFx0Li4uaGFuZGxlKG5vZGUuZGVjbGFyYXRpb24sIHN0YXRlKVxuXHRcdF07XG5cblx0XHRpZiAobm9kZS5kZWNsYXJhdGlvbi50eXBlICE9PSAnRnVuY3Rpb25EZWNsYXJhdGlvbicpIHtcblx0XHRcdGNodW5rcy5wdXNoKGMoJzsnKSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSxcblxuXHRFeHBvcnROYW1lZERlY2xhcmF0aW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0Y29uc3QgY2h1bmtzID0gW2MoJ2V4cG9ydCAnKV07XG5cblx0XHRpZiAobm9kZS5kZWNsYXJhdGlvbikge1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmRlY2xhcmF0aW9uLCBzdGF0ZSkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBzcGVjaWZpZXJzID0gbm9kZS5zcGVjaWZpZXJzLm1hcCgoLyoqIEB0eXBlIHtFeHBvcnRTcGVjaWZpZXJ9ICovIHNwZWNpZmllcikgPT4ge1xuXHRcdFx0XHRjb25zdCBuYW1lID0gaGFuZGxlKHNwZWNpZmllci5sb2NhbCwgc3RhdGUpWzBdO1xuXHRcdFx0XHRjb25zdCBhcyA9IGhhbmRsZShzcGVjaWZpZXIuZXhwb3J0ZWQsIHN0YXRlKVswXTtcblxuXHRcdFx0XHRpZiAobmFtZS5jb250ZW50ID09PSBhcy5jb250ZW50KSB7XG5cdFx0XHRcdFx0cmV0dXJuIFtuYW1lXTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBbbmFtZSwgYygnIGFzICcpLCBhc107XG5cdFx0XHR9KTtcblxuXHRcdFx0Y29uc3Qgd2lkdGggPSA3ICsgc3BlY2lmaWVycy5tYXAoZ2V0X2xlbmd0aCkucmVkdWNlKHN1bSwgMCkgKyAyICogc3BlY2lmaWVycy5sZW5ndGg7XG5cblx0XHRcdGlmICh3aWR0aCA+IDgwKSB7XG5cdFx0XHRcdGNodW5rcy5wdXNoKGMoJ3tcXG5cXHQnKSk7XG5cdFx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBqb2luKHNwZWNpZmllcnMsIGMoJyxcXG5cXHQnKSkpO1xuXHRcdFx0XHRjaHVua3MucHVzaChjKCdcXG59JykpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2h1bmtzLnB1c2goYygneyAnKSk7XG5cdFx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBqb2luKHNwZWNpZmllcnMsIGMoJywgJykpKTtcblx0XHRcdFx0Y2h1bmtzLnB1c2goYygnIH0nKSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChub2RlLnNvdXJjZSkge1xuXHRcdFx0XHRjaHVua3MucHVzaChjKCcgZnJvbSAnKSk7XG5cdFx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5zb3VyY2UsIHN0YXRlKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y2h1bmtzLnB1c2goYygnOycpKTtcblxuXHRcdHJldHVybiBjaHVua3M7XG5cdH0sXG5cblx0RXhwb3J0QWxsRGVjbGFyYXRpb24obm9kZSwgc3RhdGUpIHtcblx0XHRyZXR1cm4gW1xuXHRcdFx0YyhgZXhwb3J0ICogZnJvbSBgKSxcblx0XHRcdC4uLmhhbmRsZShub2RlLnNvdXJjZSwgc3RhdGUpLFxuXHRcdFx0YyhgO2ApXG5cdFx0XTtcblx0fSxcblxuXHRNZXRob2REZWZpbml0aW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0Y29uc3QgY2h1bmtzID0gW107XG5cblx0XHRpZiAobm9kZS5zdGF0aWMpIHtcblx0XHRcdGNodW5rcy5wdXNoKGMoJ3N0YXRpYyAnKSk7XG5cdFx0fVxuXG5cdFx0aWYgKG5vZGUua2luZCA9PT0gJ2dldCcgfHwgbm9kZS5raW5kID09PSAnc2V0Jykge1xuXHRcdFx0Ly8gR2V0dGVyIG9yIHNldHRlclxuXHRcdFx0Y2h1bmtzLnB1c2goYyhub2RlLmtpbmQgKyAnICcpKTtcblx0XHR9XG5cblx0XHRpZiAobm9kZS52YWx1ZS5hc3luYykge1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnYXN5bmMgJykpO1xuXHRcdH1cblxuXHRcdGlmIChub2RlLnZhbHVlLmdlbmVyYXRvcikge1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKicpKTtcblx0XHR9XG5cblx0XHRpZiAobm9kZS5jb21wdXRlZCkge1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnWycpKTtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5rZXksIHN0YXRlKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCddJykpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUua2V5LCBzdGF0ZSkpO1xuXHRcdH1cblxuXHRcdGNodW5rcy5wdXNoKGMoJygnKSk7XG5cblx0XHRjb25zdCB7IHBhcmFtcyB9ID0gbm9kZS52YWx1ZTtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFtcy5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShwYXJhbXNbaV0sIHN0YXRlKSk7XG5cdFx0XHRpZiAoaSA8IHBhcmFtcy5sZW5ndGggLSAxKSBjaHVua3MucHVzaChjKCcsICcpKTtcblx0XHR9XG5cblx0XHRjaHVua3MucHVzaChjKCcpICcpKTtcblx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUudmFsdWUuYm9keSwgc3RhdGUpKTtcblxuXHRcdHJldHVybiBjaHVua3M7XG5cdH0sXG5cblx0QXJyb3dGdW5jdGlvbkV4cHJlc3Npb246IHNjb3BlZCgoLyoqIEB0eXBlIHtBcnJvd0Z1bmN0aW9uRXhwcmVzc2lvbn0gKi8gbm9kZSwgc3RhdGUpID0+IHtcblx0XHRjb25zdCBjaHVua3MgPSBbXTtcblxuXHRcdGlmIChub2RlLmFzeW5jKSBjaHVua3MucHVzaChjKCdhc3luYyAnKSk7XG5cblx0XHRpZiAobm9kZS5wYXJhbXMubGVuZ3RoID09PSAxICYmIG5vZGUucGFyYW1zWzBdLnR5cGUgPT09ICdJZGVudGlmaWVyJykge1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLnBhcmFtc1swXSwgc3RhdGUpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgcGFyYW1zID0gbm9kZS5wYXJhbXMubWFwKHBhcmFtID0+IGhhbmRsZShwYXJhbSwge1xuXHRcdFx0XHQuLi5zdGF0ZSxcblx0XHRcdFx0aW5kZW50OiBzdGF0ZS5pbmRlbnQgKyAnXFx0J1xuXHRcdFx0fSkpO1xuXG5cdFx0XHRjaHVua3MucHVzaChjKCcoJykpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGpvaW4ocGFyYW1zLCBjKCcsICcpKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCcpJykpO1xuXHRcdH1cblxuXHRcdGNodW5rcy5wdXNoKGMoJyA9PiAnKSk7XG5cblx0XHRpZiAoXG5cdFx0XHRub2RlLmJvZHkudHlwZSA9PT0gJ09iamVjdEV4cHJlc3Npb24nIHx8XG5cdFx0XHQobm9kZS5ib2R5LnR5cGUgPT09ICdBc3NpZ25tZW50RXhwcmVzc2lvbicgJiYgbm9kZS5ib2R5LmxlZnQudHlwZSA9PT0gJ09iamVjdFBhdHRlcm4nKVxuXHRcdCkge1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKCcpKTtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5ib2R5LCBzdGF0ZSkpO1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKScpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmJvZHksIHN0YXRlKSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSksXG5cblx0VGhpc0V4cHJlc3Npb24obm9kZSwgc3RhdGUpIHtcblx0XHRyZXR1cm4gW2MoJ3RoaXMnLCBub2RlKV07XG5cdH0sXG5cblx0U3VwZXIobm9kZSwgc3RhdGUpIHtcblx0XHRyZXR1cm4gW2MoJ3N1cGVyJywgbm9kZSldO1xuXHR9LFxuXG5cdFJlc3RFbGVtZW50KG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIFtjKCcuLi4nKSwgLi4uaGFuZGxlKG5vZGUuYXJndW1lbnQsIHN0YXRlKV07XG5cdH0sXG5cblx0WWllbGRFeHByZXNzaW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0aWYgKG5vZGUuYXJndW1lbnQpIHtcblx0XHRcdHJldHVybiBbYyhub2RlLmRlbGVnYXRlID8gYHlpZWxkKiBgIDogYHlpZWxkIGApLCAuLi5oYW5kbGUobm9kZS5hcmd1bWVudCwgc3RhdGUpXTtcblx0XHR9XG5cblx0XHRyZXR1cm4gW2Mobm9kZS5kZWxlZ2F0ZSA/IGB5aWVsZCpgIDogYHlpZWxkYCldO1xuXHR9LFxuXG5cdEF3YWl0RXhwcmVzc2lvbihub2RlLCBzdGF0ZSkge1xuXHRcdGlmIChub2RlLmFyZ3VtZW50KSB7XG5cdFx0XHRjb25zdCBwcmVjZWRlbmNlID0gRVhQUkVTU0lPTlNfUFJFQ0VERU5DRVtub2RlLmFyZ3VtZW50LnR5cGVdO1xuXG5cdFx0XHRpZiAocHJlY2VkZW5jZSAmJiAocHJlY2VkZW5jZSA8IEVYUFJFU1NJT05TX1BSRUNFREVOQ0UuQXdhaXRFeHByZXNzaW9uKSkge1xuXHRcdFx0XHRyZXR1cm4gW2MoJ2F3YWl0ICgnKSwgLi4uaGFuZGxlKG5vZGUuYXJndW1lbnQsIHN0YXRlKSwgYygnKScpXTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBbYygnYXdhaXQgJyksIC4uLmhhbmRsZShub2RlLmFyZ3VtZW50LCBzdGF0ZSldO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBbYygnYXdhaXQnKV07XG5cdH0sXG5cblx0VGVtcGxhdGVMaXRlcmFsKG5vZGUsIHN0YXRlKSB7XG5cdFx0Y29uc3QgY2h1bmtzID0gW2MoJ2AnKV07XG5cblx0XHRjb25zdCB7IHF1YXNpcywgZXhwcmVzc2lvbnMgfSA9IG5vZGU7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGV4cHJlc3Npb25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRjaHVua3MucHVzaChcblx0XHRcdFx0YyhxdWFzaXNbaV0udmFsdWUucmF3KSxcblx0XHRcdFx0YygnJHsnKVxuXHRcdFx0KTtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUoZXhwcmVzc2lvbnNbaV0sIHN0YXRlKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCd9JykpO1xuXHRcdH1cblxuXHRcdGNodW5rcy5wdXNoKFxuXHRcdFx0YyhxdWFzaXNbcXVhc2lzLmxlbmd0aCAtIDFdLnZhbHVlLnJhdyksXG5cdFx0XHRjKCdgJylcblx0XHQpO1xuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSxcblxuXHRUYWdnZWRUZW1wbGF0ZUV4cHJlc3Npb24obm9kZSwgc3RhdGUpIHtcblx0XHRyZXR1cm4gaGFuZGxlKG5vZGUudGFnLCBzdGF0ZSkuY29uY2F0KGhhbmRsZShub2RlLnF1YXNpLCBzdGF0ZSkpO1xuXHR9LFxuXG5cdEFycmF5RXhwcmVzc2lvbihub2RlLCBzdGF0ZSkge1xuXHRcdGNvbnN0IGNodW5rcyA9IFtjKCdbJyldO1xuXG5cdFx0LyoqIEB0eXBlIHtDaHVua1tdW119ICovXG5cdFx0Y29uc3QgZWxlbWVudHMgPSBbXTtcblxuXHRcdC8qKiBAdHlwZSB7Q2h1bmtbXX0gKi9cblx0XHRsZXQgc3BhcnNlX2NvbW1hcyA9IFtdO1xuXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBub2RlLmVsZW1lbnRzLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHQvLyBjYW4ndCB1c2UgbWFwL2ZvckVhY2ggYmVjYXVzZSBvZiBzcGFyc2UgYXJyYXlzXG5cdFx0XHRjb25zdCBlbGVtZW50ID0gbm9kZS5lbGVtZW50c1tpXTtcblx0XHRcdGlmIChlbGVtZW50KSB7XG5cdFx0XHRcdGVsZW1lbnRzLnB1c2goWy4uLnNwYXJzZV9jb21tYXMsIC4uLmhhbmRsZShlbGVtZW50LCB7XG5cdFx0XHRcdFx0Li4uc3RhdGUsXG5cdFx0XHRcdFx0aW5kZW50OiBzdGF0ZS5pbmRlbnQgKyAnXFx0J1xuXHRcdFx0XHR9KV0pO1xuXHRcdFx0XHRzcGFyc2VfY29tbWFzID0gW107XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzcGFyc2VfY29tbWFzLnB1c2goYygnLCcpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRjb25zdCBtdWx0aXBsZV9saW5lcyA9IChcblx0XHRcdGVsZW1lbnRzLnNvbWUoaGFzX25ld2xpbmUpIHx8XG5cdFx0XHQoZWxlbWVudHMubWFwKGdldF9sZW5ndGgpLnJlZHVjZShzdW0sIDApICsgKHN0YXRlLmluZGVudC5sZW5ndGggKyBlbGVtZW50cy5sZW5ndGggLSAxKSAqIDIpID4gODBcblx0XHQpO1xuXG5cdFx0aWYgKG11bHRpcGxlX2xpbmVzKSB7XG5cdFx0XHRjaHVua3MucHVzaChjKGBcXG4ke3N0YXRlLmluZGVudH1cXHRgKSk7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgam9pbihlbGVtZW50cywgYyhgLFxcbiR7c3RhdGUuaW5kZW50fVxcdGApKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKGBcXG4ke3N0YXRlLmluZGVudH1gKSk7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgc3BhcnNlX2NvbW1hcyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBqb2luKGVsZW1lbnRzLCBjKCcsICcpKSk7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgc3BhcnNlX2NvbW1hcyk7XG5cdFx0fVxuXG5cdFx0Y2h1bmtzLnB1c2goYygnXScpKTtcblxuXHRcdHJldHVybiBjaHVua3M7XG5cdH0sXG5cblx0T2JqZWN0RXhwcmVzc2lvbigvKiogQHR5cGUge09iamVjdEV4cHJlc3Npb259ICovIG5vZGUsIHN0YXRlKSB7XG5cdFx0aWYgKG5vZGUucHJvcGVydGllcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHJldHVybiBbYygne30nKV07XG5cdFx0fVxuXG5cdFx0bGV0IGhhc19pbmxpbmVfY29tbWVudCA9IGZhbHNlO1xuXG5cdFx0LyoqIEB0eXBlIHtDaHVua1tdfSAqL1xuXHRcdGNvbnN0IGNodW5rcyA9IFtdO1xuXHRcdGNvbnN0IHNlcGFyYXRvciA9IGMoJywgJyk7XG5cblx0XHRub2RlLnByb3BlcnRpZXMuZm9yRWFjaCgocCwgaSkgPT4ge1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShwLCB7XG5cdFx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0XHRpbmRlbnQ6IHN0YXRlLmluZGVudCArICdcXHQnXG5cdFx0XHR9KSk7XG5cblx0XHRcdGlmIChzdGF0ZS5jb21tZW50cy5sZW5ndGgpIHtcblx0XHRcdFx0Ly8gVE9ETyBnZW5lcmFsaXNlIHRoaXMsIHNvIGl0IHdvcmtzIHdpdGggQXJyYXlFeHByZXNzaW9ucyBhbmQgb3RoZXIgdGhpbmdzLlxuXHRcdFx0XHQvLyBBdCBwcmVzZW50LCBzdHVmZiB3aWxsIGp1c3QgZ2V0IGFwcGVuZGVkIHRvIHRoZSBjbG9zZXN0IHN0YXRlbWVudC9kZWNsYXJhdGlvblxuXHRcdFx0XHRjaHVua3MucHVzaChjKCcsICcpKTtcblxuXHRcdFx0XHR3aGlsZSAoc3RhdGUuY29tbWVudHMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0Y29uc3QgY29tbWVudCA9IHN0YXRlLmNvbW1lbnRzLnNoaWZ0KCk7XG5cblx0XHRcdFx0XHRjaHVua3MucHVzaChjKGNvbW1lbnQudHlwZSA9PT0gJ0Jsb2NrJ1xuXHRcdFx0XHRcdFx0PyBgLyoke2NvbW1lbnQudmFsdWV9Ki9cXG4ke3N0YXRlLmluZGVudH1cXHRgXG5cdFx0XHRcdFx0XHQ6IGAvLyR7Y29tbWVudC52YWx1ZX1cXG4ke3N0YXRlLmluZGVudH1cXHRgKSk7XG5cblx0XHRcdFx0XHRpZiAoY29tbWVudC50eXBlID09PSAnTGluZScpIHtcblx0XHRcdFx0XHRcdGhhc19pbmxpbmVfY29tbWVudCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoaSA8IG5vZGUucHJvcGVydGllcy5sZW5ndGggLSAxKSB7XG5cdFx0XHRcdFx0Y2h1bmtzLnB1c2goc2VwYXJhdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Y29uc3QgbXVsdGlwbGVfbGluZXMgPSAoXG5cdFx0XHRoYXNfaW5saW5lX2NvbW1lbnQgfHxcblx0XHRcdGhhc19uZXdsaW5lKGNodW5rcykgfHxcblx0XHRcdGdldF9sZW5ndGgoY2h1bmtzKSA+IDQwXG5cdFx0KTtcblxuXHRcdGlmIChtdWx0aXBsZV9saW5lcykge1xuXHRcdFx0c2VwYXJhdG9yLmNvbnRlbnQgPSBgLFxcbiR7c3RhdGUuaW5kZW50fVxcdGA7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIFtcblx0XHRcdGMobXVsdGlwbGVfbGluZXMgPyBge1xcbiR7c3RhdGUuaW5kZW50fVxcdGAgOiBgeyBgKSxcblx0XHRcdC4uLmNodW5rcyxcblx0XHRcdGMobXVsdGlwbGVfbGluZXMgPyBgXFxuJHtzdGF0ZS5pbmRlbnR9fWAgOiBgIH1gKVxuXHRcdF07XG5cdH0sXG5cblx0UHJvcGVydHkobm9kZSwgc3RhdGUpIHtcblx0XHRjb25zdCB2YWx1ZSA9IGhhbmRsZShub2RlLnZhbHVlLCBzdGF0ZSk7XG5cblx0XHRpZiAobm9kZS5rZXkgPT09IG5vZGUudmFsdWUpIHtcblx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHR9XG5cblx0XHQvLyBzcGVjaWFsIGNhc2Vcblx0XHRpZiAoXG5cdFx0XHQhbm9kZS5jb21wdXRlZCAmJlxuXHRcdFx0bm9kZS52YWx1ZS50eXBlID09PSAnQXNzaWdubWVudFBhdHRlcm4nICYmXG5cdFx0XHRub2RlLnZhbHVlLmxlZnQudHlwZSA9PT0gJ0lkZW50aWZpZXInICYmXG5cdFx0XHRub2RlLnZhbHVlLmxlZnQubmFtZSA9PT0gbm9kZS5rZXkubmFtZVxuXHRcdCkge1xuXHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdH1cblxuXHRcdGlmICghbm9kZS5jb21wdXRlZCAmJiBub2RlLnZhbHVlLnR5cGUgPT09ICdJZGVudGlmaWVyJyAmJiAoXG5cdFx0XHQobm9kZS5rZXkudHlwZSA9PT0gJ0lkZW50aWZpZXInICYmIG5vZGUua2V5Lm5hbWUgPT09IHZhbHVlWzBdLmNvbnRlbnQpIHx8XG5cdFx0XHQobm9kZS5rZXkudHlwZSA9PT0gJ0xpdGVyYWwnICYmIG5vZGUua2V5LnZhbHVlID09PSB2YWx1ZVswXS5jb250ZW50KVxuXHRcdCkpIHtcblx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHR9XG5cblx0XHRjb25zdCBrZXkgPSBoYW5kbGUobm9kZS5rZXksIHN0YXRlKTtcblxuXHRcdGlmIChub2RlLnZhbHVlLnR5cGUgPT09ICdGdW5jdGlvbkV4cHJlc3Npb24nICYmICFub2RlLnZhbHVlLmlkKSB7XG5cdFx0XHRzdGF0ZSA9IHtcblx0XHRcdFx0Li4uc3RhdGUsXG5cdFx0XHRcdHNjb3BlOiBzdGF0ZS5zY29wZV9tYXAuZ2V0KG5vZGUudmFsdWUpXG5cdFx0XHR9O1xuXG5cdFx0XHRjb25zdCBjaHVua3MgPSBub2RlLmtpbmQgIT09ICdpbml0J1xuXHRcdFx0XHQ/IFtjKGAke25vZGUua2luZH0gYCldXG5cdFx0XHRcdDogW107XG5cblx0XHRcdGlmIChub2RlLnZhbHVlLmFzeW5jKSB7XG5cdFx0XHRcdGNodW5rcy5wdXNoKGMoJ2FzeW5jICcpKTtcblx0XHRcdH1cblx0XHRcdGlmIChub2RlLnZhbHVlLmdlbmVyYXRvcikge1xuXHRcdFx0XHRjaHVua3MucHVzaChjKCcqJykpO1xuXHRcdFx0fVxuXG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgbm9kZS5jb21wdXRlZCA/IFtjKCdbJyksIC4uLmtleSwgYygnXScpXSA6IGtleSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCcoJykpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGpvaW4obm9kZS52YWx1ZS5wYXJhbXMubWFwKCgvKiogQHR5cGUge1BhdHRlcm59ICovIHBhcmFtKSA9PiBoYW5kbGUocGFyYW0sIHN0YXRlKSksIGMoJywgJykpKTtcblx0XHRcdGNodW5rcy5wdXNoKGMoJykgJykpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLnZhbHVlLmJvZHksIHN0YXRlKSk7XG5cblx0XHRcdHJldHVybiBjaHVua3M7XG5cdFx0fVxuXG5cdFx0aWYgKG5vZGUuY29tcHV0ZWQpIHtcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdGMoJ1snKSxcblx0XHRcdFx0Li4ua2V5LFxuXHRcdFx0XHRjKCddOiAnKSxcblx0XHRcdFx0Li4udmFsdWVcblx0XHRcdF07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIFtcblx0XHRcdC4uLmtleSxcblx0XHRcdGMoJzogJyksXG5cdFx0XHQuLi52YWx1ZVxuXHRcdF07XG5cdH0sXG5cblx0T2JqZWN0UGF0dGVybihub2RlLCBzdGF0ZSkge1xuXHRcdGNvbnN0IGNodW5rcyA9IFtjKCd7ICcpXTtcblxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZS5wcm9wZXJ0aWVzLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUucHJvcGVydGllc1tpXSwgc3RhdGUpKTtcblx0XHRcdGlmIChpIDwgbm9kZS5wcm9wZXJ0aWVzLmxlbmd0aCAtIDEpIGNodW5rcy5wdXNoKGMoJywgJykpO1xuXHRcdH1cblxuXHRcdGNodW5rcy5wdXNoKGMoJyB9JykpO1xuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSxcblxuXHRTZXF1ZW5jZUV4cHJlc3Npb24oLyoqIEB0eXBlIHtTZXF1ZW5jZUV4cHJlc3Npb259ICovIG5vZGUsIHN0YXRlKSB7XG5cdFx0Y29uc3QgZXhwcmVzc2lvbnMgPSBub2RlLmV4cHJlc3Npb25zLm1hcChlID0+IGhhbmRsZShlLCBzdGF0ZSkpO1xuXG5cdFx0cmV0dXJuIFtcblx0XHRcdGMoJygnKSxcblx0XHRcdC4uLmpvaW4oZXhwcmVzc2lvbnMsIGMoJywgJykpLFxuXHRcdFx0YygnKScpXG5cdFx0XTtcblx0fSxcblxuXHRVbmFyeUV4cHJlc3Npb24obm9kZSwgc3RhdGUpIHtcblx0XHRjb25zdCBjaHVua3MgPSBbYyhub2RlLm9wZXJhdG9yKV07XG5cblx0XHRpZiAobm9kZS5vcGVyYXRvci5sZW5ndGggPiAxKSB7XG5cdFx0XHRjaHVua3MucHVzaChjKCcgJykpO1xuXHRcdH1cblxuXHRcdGlmIChcblx0XHRcdEVYUFJFU1NJT05TX1BSRUNFREVOQ0Vbbm9kZS5hcmd1bWVudC50eXBlXSA8XG5cdFx0XHRFWFBSRVNTSU9OU19QUkVDRURFTkNFLlVuYXJ5RXhwcmVzc2lvblxuXHRcdCkge1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKCcpKTtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5hcmd1bWVudCwgc3RhdGUpKTtcblx0XHRcdGNodW5rcy5wdXNoKGMoJyknKSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5hcmd1bWVudCwgc3RhdGUpKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gY2h1bmtzO1xuXHR9LFxuXG5cdFVwZGF0ZUV4cHJlc3Npb24obm9kZSwgc3RhdGUpIHtcblx0XHRyZXR1cm4gbm9kZS5wcmVmaXhcblx0XHRcdD8gW2Mobm9kZS5vcGVyYXRvciksIC4uLmhhbmRsZShub2RlLmFyZ3VtZW50LCBzdGF0ZSldXG5cdFx0XHQ6IFsuLi5oYW5kbGUobm9kZS5hcmd1bWVudCwgc3RhdGUpLCBjKG5vZGUub3BlcmF0b3IpXTtcblx0fSxcblxuXHRBc3NpZ25tZW50RXhwcmVzc2lvbihub2RlLCBzdGF0ZSkge1xuXHRcdHJldHVybiBbXG5cdFx0XHQuLi5oYW5kbGUobm9kZS5sZWZ0LCBzdGF0ZSksXG5cdFx0XHRjKGAgJHtub2RlLm9wZXJhdG9yIHx8ICc9J30gYCksXG5cdFx0XHQuLi5oYW5kbGUobm9kZS5yaWdodCwgc3RhdGUpXG5cdFx0XTtcblx0fSxcblxuXHRCaW5hcnlFeHByZXNzaW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0LyoqXG5cdFx0ICogQHR5cGUgYW55W11cblx0XHQgKi9cblx0XHRjb25zdCBjaHVua3MgPSBbXTtcblxuXHRcdC8vIFRPRE9cblx0XHQvLyBjb25zdCBpc19pbiA9IG5vZGUub3BlcmF0b3IgPT09ICdpbic7XG5cdFx0Ly8gaWYgKGlzX2luKSB7XG5cdFx0Ly8gXHQvLyBBdm9pZHMgY29uZnVzaW9uIGluIGBmb3JgIGxvb3BzIGluaXRpYWxpemVyc1xuXHRcdC8vIFx0Y2h1bmtzLnB1c2goYygnKCcpKTtcblx0XHQvLyB9XG5cblx0XHRpZiAobmVlZHNfcGFyZW5zKG5vZGUubGVmdCwgbm9kZSwgZmFsc2UpKSB7XG5cdFx0XHRjaHVua3MucHVzaChjKCcoJykpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmxlZnQsIHN0YXRlKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCcpJykpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUubGVmdCwgc3RhdGUpKTtcblx0XHR9XG5cblx0XHRjaHVua3MucHVzaChjKGAgJHtub2RlLm9wZXJhdG9yfSBgKSk7XG5cblx0XHRpZiAobmVlZHNfcGFyZW5zKG5vZGUucmlnaHQsIG5vZGUsIHRydWUpKSB7XG5cdFx0XHRjaHVua3MucHVzaChjKCcoJykpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLnJpZ2h0LCBzdGF0ZSkpO1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKScpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLnJpZ2h0LCBzdGF0ZSkpO1xuXHRcdH1cblxuXHRcdHJldHVybiBjaHVua3M7XG5cdH0sXG5cblx0Q29uZGl0aW9uYWxFeHByZXNzaW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0LyoqXG5cdFx0ICogQHR5cGUgYW55W11cblx0XHQgKi9cblx0XHRjb25zdCBjaHVua3MgPSBbXTtcblxuXHRcdGlmIChcblx0XHRcdEVYUFJFU1NJT05TX1BSRUNFREVOQ0Vbbm9kZS50ZXN0LnR5cGVdID5cblx0XHRcdEVYUFJFU1NJT05TX1BSRUNFREVOQ0UuQ29uZGl0aW9uYWxFeHByZXNzaW9uXG5cdFx0KSB7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUudGVzdCwgc3RhdGUpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKCcpKTtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS50ZXN0LCBzdGF0ZSkpO1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKScpKTtcblx0XHR9XG5cblx0XHRjb25zdCBjaGlsZF9zdGF0ZSA9IHsgLi4uc3RhdGUsIGluZGVudDogc3RhdGUuaW5kZW50ICsgJ1xcdCcgfTtcblxuXHRcdGNvbnN0IGNvbnNlcXVlbnQgPSBoYW5kbGUobm9kZS5jb25zZXF1ZW50LCBjaGlsZF9zdGF0ZSk7XG5cdFx0Y29uc3QgYWx0ZXJuYXRlID0gaGFuZGxlKG5vZGUuYWx0ZXJuYXRlLCBjaGlsZF9zdGF0ZSk7XG5cblx0XHRjb25zdCBtdWx0aXBsZV9saW5lcyA9IChcblx0XHRcdGhhc19uZXdsaW5lKGNvbnNlcXVlbnQpIHx8IGhhc19uZXdsaW5lKGFsdGVybmF0ZSkgfHxcblx0XHRcdGdldF9sZW5ndGgoY2h1bmtzKSArIGdldF9sZW5ndGgoY29uc2VxdWVudCkgKyBnZXRfbGVuZ3RoKGFsdGVybmF0ZSkgPiA1MFxuXHRcdCk7XG5cblx0XHRpZiAobXVsdGlwbGVfbGluZXMpIHtcblx0XHRcdGNodW5rcy5wdXNoKGMoYFxcbiR7c3RhdGUuaW5kZW50fT8gYCkpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGNvbnNlcXVlbnQpO1xuXHRcdFx0Y2h1bmtzLnB1c2goYyhgXFxuJHtzdGF0ZS5pbmRlbnR9OiBgKSk7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgYWx0ZXJuYXRlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y2h1bmtzLnB1c2goYyhgID8gYCkpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGNvbnNlcXVlbnQpO1xuXHRcdFx0Y2h1bmtzLnB1c2goYyhgIDogYCkpO1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGFsdGVybmF0ZSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSxcblxuXHROZXdFeHByZXNzaW9uKC8qKiBAdHlwZSB7TmV3RXhwcmVzc2lvbn0gKi8gbm9kZSwgc3RhdGUpIHtcblx0XHRjb25zdCBjaHVua3MgPSBbYygnbmV3ICcpXTtcblxuXHRcdGlmIChcblx0XHRcdEVYUFJFU1NJT05TX1BSRUNFREVOQ0Vbbm9kZS5jYWxsZWUudHlwZV0gPFxuXHRcdFx0RVhQUkVTU0lPTlNfUFJFQ0VERU5DRS5DYWxsRXhwcmVzc2lvbiB8fCBoYXNfY2FsbF9leHByZXNzaW9uKG5vZGUuY2FsbGVlKVxuXHRcdCkge1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKCcpKTtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5jYWxsZWUsIHN0YXRlKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCcpJykpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUuY2FsbGVlLCBzdGF0ZSkpO1xuXHRcdH1cblxuXHRcdC8vIFRPRE8gdGhpcyBpcyBjb3BpZWQgZnJvbSBDYWxsRXhwcmVzc2lvbiDigJQgRFJZIGl0IG91dFxuXHRcdGNvbnN0IGFyZ3MgPSBub2RlLmFyZ3VtZW50cy5tYXAoYXJnID0+IGhhbmRsZShhcmcsIHtcblx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0aW5kZW50OiBzdGF0ZS5pbmRlbnQgKyAnXFx0J1xuXHRcdH0pKTtcblxuXHRcdGNvbnN0IHNlcGFyYXRvciA9IGFyZ3Muc29tZShoYXNfbmV3bGluZSkgLy8gVE9ETyBvciBsZW5ndGggZXhjZWVkcyA4MFxuXHRcdFx0PyBjKCcsXFxuJyArIHN0YXRlLmluZGVudClcblx0XHRcdDogYygnLCAnKTtcblxuXHRcdGNodW5rcy5wdXNoKGMoJygnKSk7XG5cdFx0cHVzaF9hcnJheShjaHVua3MsIGpvaW4oYXJncywgc2VwYXJhdG9yKSk7XG5cdFx0Y2h1bmtzLnB1c2goYygnKScpKTtcblxuXHRcdHJldHVybiBjaHVua3M7XG5cdH0sXG5cblx0Q2hhaW5FeHByZXNzaW9uKG5vZGUsIHN0YXRlKSB7XG5cdFx0cmV0dXJuIGhhbmRsZShub2RlLmV4cHJlc3Npb24sIHN0YXRlKTtcblx0fSxcblxuXHRDYWxsRXhwcmVzc2lvbigvKiogQHR5cGUge0NhbGxFeHByZXNzaW9ufSAqLyBub2RlLCBzdGF0ZSkge1xuXHRcdC8qKlxuXHRcdCAqIEB0eXBlIGFueVtdXG5cdFx0ICovXG5cdFx0Y29uc3QgY2h1bmtzID0gW107XG5cblx0XHRpZiAoXG5cdFx0XHRFWFBSRVNTSU9OU19QUkVDRURFTkNFW25vZGUuY2FsbGVlLnR5cGVdIDxcblx0XHRcdEVYUFJFU1NJT05TX1BSRUNFREVOQ0UuQ2FsbEV4cHJlc3Npb25cblx0XHQpIHtcblx0XHRcdGNodW5rcy5wdXNoKGMoJygnKSk7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUuY2FsbGVlLCBzdGF0ZSkpO1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKScpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cHVzaF9hcnJheShjaHVua3MsIGhhbmRsZShub2RlLmNhbGxlZSwgc3RhdGUpKTtcblx0XHR9XG5cblx0XHRpZiAoLyoqIEB0eXBlIHtTaW1wbGVDYWxsRXhwcmVzc2lvbn0gKi8gKG5vZGUpLm9wdGlvbmFsKSB7XG5cdFx0XHRjaHVua3MucHVzaChjKCc/LicpKTtcblx0XHR9XG5cblx0XHRjb25zdCBhcmdzID0gbm9kZS5hcmd1bWVudHMubWFwKGFyZyA9PiBoYW5kbGUoYXJnLCBzdGF0ZSkpO1xuXG5cdFx0Y29uc3QgbXVsdGlwbGVfbGluZXMgPSBhcmdzLnNsaWNlKDAsIC0xKS5zb21lKGhhc19uZXdsaW5lKTsgLy8gVE9ETyBvciBsZW5ndGggZXhjZWVkcyA4MFxuXG5cdFx0aWYgKG11bHRpcGxlX2xpbmVzKSB7XG5cdFx0XHQvLyBuZWVkIHRvIGhhbmRsZSBhcmdzIGFnYWluLiBUT0RPIGZpbmQgYWx0ZXJuYXRpdmUgYXBwcm9hY2g/XG5cdFx0XHRjb25zdCBhcmdzID0gbm9kZS5hcmd1bWVudHMubWFwKGFyZyA9PiBoYW5kbGUoYXJnLCB7XG5cdFx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0XHRpbmRlbnQ6IGAke3N0YXRlLmluZGVudH1cXHRgXG5cdFx0XHR9KSk7XG5cblx0XHRcdGNodW5rcy5wdXNoKGMoYChcXG4ke3N0YXRlLmluZGVudH1cXHRgKSk7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgam9pbihhcmdzLCBjKGAsXFxuJHtzdGF0ZS5pbmRlbnR9XFx0YCkpKTtcblx0XHRcdGNodW5rcy5wdXNoKGMoYFxcbiR7c3RhdGUuaW5kZW50fSlgKSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNodW5rcy5wdXNoKGMoJygnKSk7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgam9pbihhcmdzLCBjKCcsICcpKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCcpJykpO1xuXHRcdH1cblxuXHRcdHJldHVybiBjaHVua3M7XG5cdH0sXG5cblx0TWVtYmVyRXhwcmVzc2lvbihub2RlLCBzdGF0ZSkge1xuXHRcdC8qKlxuXHRcdCAqIEB0eXBlIGFueVtdXG5cdFx0ICovXG5cdFx0Y29uc3QgY2h1bmtzID0gW107XG5cblx0XHRpZiAoRVhQUkVTU0lPTlNfUFJFQ0VERU5DRVtub2RlLm9iamVjdC50eXBlXSA8IEVYUFJFU1NJT05TX1BSRUNFREVOQ0UuTWVtYmVyRXhwcmVzc2lvbikge1xuXHRcdFx0Y2h1bmtzLnB1c2goYygnKCcpKTtcblx0XHRcdHB1c2hfYXJyYXkoY2h1bmtzLCBoYW5kbGUobm9kZS5vYmplY3QsIHN0YXRlKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCcpJykpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUub2JqZWN0LCBzdGF0ZSkpO1xuXHRcdH1cblxuXHRcdGlmIChub2RlLmNvbXB1dGVkKSB7XG5cdFx0XHRpZiAobm9kZS5vcHRpb25hbCkge1xuXHRcdFx0XHRjaHVua3MucHVzaChjKCc/LicpKTtcblx0XHRcdH1cblx0XHRcdGNodW5rcy5wdXNoKGMoJ1snKSk7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUucHJvcGVydHksIHN0YXRlKSk7XG5cdFx0XHRjaHVua3MucHVzaChjKCddJykpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjaHVua3MucHVzaChjKG5vZGUub3B0aW9uYWwgPyAnPy4nIDogJy4nKSk7XG5cdFx0XHRwdXNoX2FycmF5KGNodW5rcywgaGFuZGxlKG5vZGUucHJvcGVydHksIHN0YXRlKSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNodW5rcztcblx0fSxcblxuXHRNZXRhUHJvcGVydHkobm9kZSwgc3RhdGUpIHtcblx0XHRyZXR1cm4gWy4uLmhhbmRsZShub2RlLm1ldGEsIHN0YXRlKSwgYygnLicpLCAuLi5oYW5kbGUobm9kZS5wcm9wZXJ0eSwgc3RhdGUpXTtcblx0fSxcblxuXHRJZGVudGlmaWVyKG5vZGUsIHN0YXRlKSB7XG5cdFx0bGV0IG5hbWUgPSBub2RlLm5hbWU7XG5cblx0XHRpZiAobmFtZVswXSA9PT0gJ0AnKSB7XG5cdFx0XHRuYW1lID0gc3RhdGUuZ2V0TmFtZShuYW1lLnNsaWNlKDEpKTtcblx0XHR9IGVsc2UgaWYgKG5vZGUubmFtZVswXSA9PT0gJyMnKSB7XG5cdFx0XHRjb25zdCBvd25lciA9IHN0YXRlLnNjb3BlLmZpbmRfb3duZXIobm9kZS5uYW1lKTtcblxuXHRcdFx0aWYgKCFvd25lcikge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmaW5kIG93bmVyIGZvciBub2RlYCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghc3RhdGUuZGVjb25mbGljdGVkLmhhcyhvd25lcikpIHtcblx0XHRcdFx0c3RhdGUuZGVjb25mbGljdGVkLnNldChvd25lciwgbmV3IE1hcCgpKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgZGVjb25mbGljdF9tYXAgPSBzdGF0ZS5kZWNvbmZsaWN0ZWQuZ2V0KG93bmVyKTtcblxuXHRcdFx0aWYgKCFkZWNvbmZsaWN0X21hcC5oYXMobm9kZS5uYW1lKSkge1xuXHRcdFx0XHRkZWNvbmZsaWN0X21hcC5zZXQobm9kZS5uYW1lLCBkZWNvbmZsaWN0KG5vZGUubmFtZS5zbGljZSgxKSwgb3duZXIucmVmZXJlbmNlcykpO1xuXHRcdFx0fVxuXG5cdFx0XHRuYW1lID0gZGVjb25mbGljdF9tYXAuZ2V0KG5vZGUubmFtZSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIFtjKG5hbWUsIG5vZGUpXTtcblx0fSxcblxuXHRMaXRlcmFsKC8qKiBAdHlwZSB7TGl0ZXJhbH0gKi8gbm9kZSwgc3RhdGUpIHtcblx0XHRpZiAodHlwZW9mIG5vZGUudmFsdWUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHQvLyBUT0RPIGRvIHdlIG5lZWQgdG8gaGFuZGxlIHdlaXJkIHVuaWNvZGUgY2hhcmFjdGVycyBzb21laG93P1xuXHRcdFx0XHQvLyBzdHIucmVwbGFjZSgvXFxcXHUoXFxkezR9KS9nLCAobSwgbikgPT4gU3RyaW5nLmZyb21DaGFyQ29kZSgrbikpXG5cdFx0XHRcdGMoKG5vZGUucmF3IHx8IEpTT04uc3RyaW5naWZ5KG5vZGUudmFsdWUpKS5yZXBsYWNlKHJlLCAoX20sIF9pLCBhdCwgaGFzaCwgbmFtZSkgPT4ge1xuXHRcdFx0XHRcdGlmIChhdClcdHJldHVybiAnQCcgKyBuYW1lO1xuXHRcdFx0XHRcdGlmIChoYXNoKSByZXR1cm4gJyMnICsgbmFtZTtcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYHRoaXMgc2hvdWxkbid0IGhhcHBlbmApO1xuXHRcdFx0XHR9KSwgbm9kZSlcblx0XHRcdF07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIFtjKG5vZGUucmF3IHx8IFN0cmluZyhub2RlLnZhbHVlKSwgbm9kZSldO1xuXHR9XG59O1xuXG5oYW5kbGVycy5Gb3JPZlN0YXRlbWVudCA9IGhhbmRsZXJzLkZvckluU3RhdGVtZW50O1xuaGFuZGxlcnMuRnVuY3Rpb25FeHByZXNzaW9uID0gaGFuZGxlcnMuRnVuY3Rpb25EZWNsYXJhdGlvbjtcbmhhbmRsZXJzLkNsYXNzRXhwcmVzc2lvbiA9IGhhbmRsZXJzLkNsYXNzRGVjbGFyYXRpb247XG5oYW5kbGVycy5DbGFzc0JvZHkgPSBoYW5kbGVycy5CbG9ja1N0YXRlbWVudDtcbmhhbmRsZXJzLlNwcmVhZEVsZW1lbnQgPSBoYW5kbGVycy5SZXN0RWxlbWVudDtcbmhhbmRsZXJzLkFycmF5UGF0dGVybiA9IGhhbmRsZXJzLkFycmF5RXhwcmVzc2lvbjtcbmhhbmRsZXJzLkxvZ2ljYWxFeHByZXNzaW9uID0gaGFuZGxlcnMuQmluYXJ5RXhwcmVzc2lvbjtcbmhhbmRsZXJzLkFzc2lnbm1lbnRQYXR0ZXJuID0gaGFuZGxlcnMuQXNzaWdubWVudEV4cHJlc3Npb247XG5cbnZhciBjaGFyVG9JbnRlZ2VyID0ge307XG52YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0nO1xuZm9yICh2YXIgaSQxID0gMDsgaSQxIDwgY2hhcnMubGVuZ3RoOyBpJDErKykge1xuICAgIGNoYXJUb0ludGVnZXJbY2hhcnMuY2hhckNvZGVBdChpJDEpXSA9IGkkMTtcbn1cbmZ1bmN0aW9uIGRlY29kZShtYXBwaW5ncykge1xuICAgIHZhciBkZWNvZGVkID0gW107XG4gICAgdmFyIGxpbmUgPSBbXTtcbiAgICB2YXIgc2VnbWVudCA9IFtcbiAgICAgICAgMCxcbiAgICAgICAgMCxcbiAgICAgICAgMCxcbiAgICAgICAgMCxcbiAgICAgICAgMCxcbiAgICBdO1xuICAgIHZhciBqID0gMDtcbiAgICBmb3IgKHZhciBpID0gMCwgc2hpZnQgPSAwLCB2YWx1ZSA9IDA7IGkgPCBtYXBwaW5ncy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYyA9IG1hcHBpbmdzLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIGlmIChjID09PSA0NCkgeyAvLyBcIixcIlxuICAgICAgICAgICAgc2VnbWVudGlmeShsaW5lLCBzZWdtZW50LCBqKTtcbiAgICAgICAgICAgIGogPSAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGMgPT09IDU5KSB7IC8vIFwiO1wiXG4gICAgICAgICAgICBzZWdtZW50aWZ5KGxpbmUsIHNlZ21lbnQsIGopO1xuICAgICAgICAgICAgaiA9IDA7XG4gICAgICAgICAgICBkZWNvZGVkLnB1c2gobGluZSk7XG4gICAgICAgICAgICBsaW5lID0gW107XG4gICAgICAgICAgICBzZWdtZW50WzBdID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpbnRlZ2VyID0gY2hhclRvSW50ZWdlcltjXTtcbiAgICAgICAgICAgIGlmIChpbnRlZ2VyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY2hhcmFjdGVyICgnICsgU3RyaW5nLmZyb21DaGFyQ29kZShjKSArICcpJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGFzQ29udGludWF0aW9uQml0ID0gaW50ZWdlciAmIDMyO1xuICAgICAgICAgICAgaW50ZWdlciAmPSAzMTtcbiAgICAgICAgICAgIHZhbHVlICs9IGludGVnZXIgPDwgc2hpZnQ7XG4gICAgICAgICAgICBpZiAoaGFzQ29udGludWF0aW9uQml0KSB7XG4gICAgICAgICAgICAgICAgc2hpZnQgKz0gNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBzaG91bGROZWdhdGUgPSB2YWx1ZSAmIDE7XG4gICAgICAgICAgICAgICAgdmFsdWUgPj4+PSAxO1xuICAgICAgICAgICAgICAgIGlmIChzaG91bGROZWdhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSA9PT0gMCA/IC0weDgwMDAwMDAwIDogLXZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWdtZW50W2pdICs9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHNoaWZ0ID0gMDsgLy8gcmVzZXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWdtZW50aWZ5KGxpbmUsIHNlZ21lbnQsIGopO1xuICAgIGRlY29kZWQucHVzaChsaW5lKTtcbiAgICByZXR1cm4gZGVjb2RlZDtcbn1cbmZ1bmN0aW9uIHNlZ21lbnRpZnkobGluZSwgc2VnbWVudCwgaikge1xuICAgIC8vIFRoaXMgbG9va3MgdWdseSwgYnV0IHdlJ3JlIGNyZWF0aW5nIHNwZWNpYWxpemVkIGFycmF5cyB3aXRoIGEgc3BlY2lmaWNcbiAgICAvLyBsZW5ndGguIFRoaXMgaXMgbXVjaCBmYXN0ZXIgdGhhbiBjcmVhdGluZyBhIG5ldyBhcnJheSAod2hpY2ggdjggZXhwYW5kcyB0b1xuICAgIC8vIGEgY2FwYWNpdHkgb2YgMTcgYWZ0ZXIgcHVzaGluZyB0aGUgZmlyc3QgaXRlbSksIG9yIHNsaWNpbmcgb3V0IGEgc3ViYXJyYXlcbiAgICAvLyAod2hpY2ggaXMgc2xvdykuIExlbmd0aCA0IGlzIGFzc3VtZWQgdG8gYmUgdGhlIG1vc3QgZnJlcXVlbnQsIGZvbGxvd2VkIGJ5XG4gICAgLy8gbGVuZ3RoIDUgKHNpbmNlIG5vdCBldmVyeXRoaW5nIHdpbGwgaGF2ZSBhbiBhc3NvY2lhdGVkIG5hbWUpLCBmb2xsb3dlZCBieVxuICAgIC8vIGxlbmd0aCAxIChpdCdzIHByb2JhYmx5IHJhcmUgZm9yIGEgc291cmNlIHN1YnN0cmluZyB0byBub3QgaGF2ZSBhblxuICAgIC8vIGFzc29jaWF0ZWQgc2VnbWVudCBkYXRhKS5cbiAgICBpZiAoaiA9PT0gNClcbiAgICAgICAgbGluZS5wdXNoKFtzZWdtZW50WzBdLCBzZWdtZW50WzFdLCBzZWdtZW50WzJdLCBzZWdtZW50WzNdXSk7XG4gICAgZWxzZSBpZiAoaiA9PT0gNSlcbiAgICAgICAgbGluZS5wdXNoKFtzZWdtZW50WzBdLCBzZWdtZW50WzFdLCBzZWdtZW50WzJdLCBzZWdtZW50WzNdLCBzZWdtZW50WzRdXSk7XG4gICAgZWxzZSBpZiAoaiA9PT0gMSlcbiAgICAgICAgbGluZS5wdXNoKFtzZWdtZW50WzBdXSk7XG59XG5mdW5jdGlvbiBlbmNvZGUoZGVjb2RlZCkge1xuICAgIHZhciBzb3VyY2VGaWxlSW5kZXggPSAwOyAvLyBzZWNvbmQgZmllbGRcbiAgICB2YXIgc291cmNlQ29kZUxpbmUgPSAwOyAvLyB0aGlyZCBmaWVsZFxuICAgIHZhciBzb3VyY2VDb2RlQ29sdW1uID0gMDsgLy8gZm91cnRoIGZpZWxkXG4gICAgdmFyIG5hbWVJbmRleCA9IDA7IC8vIGZpZnRoIGZpZWxkXG4gICAgdmFyIG1hcHBpbmdzID0gJyc7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZWNvZGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBsaW5lID0gZGVjb2RlZFtpXTtcbiAgICAgICAgaWYgKGkgPiAwKVxuICAgICAgICAgICAgbWFwcGluZ3MgKz0gJzsnO1xuICAgICAgICBpZiAobGluZS5sZW5ndGggPT09IDApXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgdmFyIGdlbmVyYXRlZENvZGVDb2x1bW4gPSAwOyAvLyBmaXJzdCBmaWVsZFxuICAgICAgICB2YXIgbGluZU1hcHBpbmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgbGluZV8xID0gbGluZTsgX2kgPCBsaW5lXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgc2VnbWVudCA9IGxpbmVfMVtfaV07XG4gICAgICAgICAgICB2YXIgc2VnbWVudE1hcHBpbmdzID0gZW5jb2RlSW50ZWdlcihzZWdtZW50WzBdIC0gZ2VuZXJhdGVkQ29kZUNvbHVtbik7XG4gICAgICAgICAgICBnZW5lcmF0ZWRDb2RlQ29sdW1uID0gc2VnbWVudFswXTtcbiAgICAgICAgICAgIGlmIChzZWdtZW50Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBzZWdtZW50TWFwcGluZ3MgKz1cbiAgICAgICAgICAgICAgICAgICAgZW5jb2RlSW50ZWdlcihzZWdtZW50WzFdIC0gc291cmNlRmlsZUluZGV4KSArXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVJbnRlZ2VyKHNlZ21lbnRbMl0gLSBzb3VyY2VDb2RlTGluZSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RlSW50ZWdlcihzZWdtZW50WzNdIC0gc291cmNlQ29kZUNvbHVtbik7XG4gICAgICAgICAgICAgICAgc291cmNlRmlsZUluZGV4ID0gc2VnbWVudFsxXTtcbiAgICAgICAgICAgICAgICBzb3VyY2VDb2RlTGluZSA9IHNlZ21lbnRbMl07XG4gICAgICAgICAgICAgICAgc291cmNlQ29kZUNvbHVtbiA9IHNlZ21lbnRbM107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VnbWVudC5sZW5ndGggPT09IDUpIHtcbiAgICAgICAgICAgICAgICBzZWdtZW50TWFwcGluZ3MgKz0gZW5jb2RlSW50ZWdlcihzZWdtZW50WzRdIC0gbmFtZUluZGV4KTtcbiAgICAgICAgICAgICAgICBuYW1lSW5kZXggPSBzZWdtZW50WzRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGluZU1hcHBpbmdzLnB1c2goc2VnbWVudE1hcHBpbmdzKTtcbiAgICAgICAgfVxuICAgICAgICBtYXBwaW5ncyArPSBsaW5lTWFwcGluZ3Muam9pbignLCcpO1xuICAgIH1cbiAgICByZXR1cm4gbWFwcGluZ3M7XG59XG5mdW5jdGlvbiBlbmNvZGVJbnRlZ2VyKG51bSkge1xuICAgIHZhciByZXN1bHQgPSAnJztcbiAgICBudW0gPSBudW0gPCAwID8gKC1udW0gPDwgMSkgfCAxIDogbnVtIDw8IDE7XG4gICAgZG8ge1xuICAgICAgICB2YXIgY2xhbXBlZCA9IG51bSAmIDMxO1xuICAgICAgICBudW0gPj4+PSA1O1xuICAgICAgICBpZiAobnVtID4gMCkge1xuICAgICAgICAgICAgY2xhbXBlZCB8PSAzMjtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgKz0gY2hhcnNbY2xhbXBlZF07XG4gICAgfSB3aGlsZSAobnVtID4gMCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqIEB0eXBlIHsoc3RyPzogc3RyaW5nKSA9PiBzdHJpbmd9IHN0ciAqL1xubGV0IGJ0b2EkMSA9ICgpID0+IHtcblx0dGhyb3cgbmV3IEVycm9yKCdVbnN1cHBvcnRlZCBlbnZpcm9ubWVudDogYHdpbmRvdy5idG9hYCBvciBgQnVmZmVyYCBzaG91bGQgYmUgc3VwcG9ydGVkLicpO1xufTtcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiB3aW5kb3cuYnRvYSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRidG9hJDEgPSAoc3RyKSA9PiB3aW5kb3cuYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3RyKSkpO1xufSBlbHNlIGlmICh0eXBlb2YgQnVmZmVyID09PSAnZnVuY3Rpb24nKSB7XG5cdGJ0b2EkMSA9IChzdHIpID0+IEJ1ZmZlci5mcm9tKHN0ciwgJ3V0Zi04JykudG9TdHJpbmcoJ2Jhc2U2NCcpO1xufVxuXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnZXN0cmVlJykuTm9kZX0gTm9kZSAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGZpbGU/OiBzdHJpbmc7XG4gKiAgIHNvdXJjZU1hcFNvdXJjZT86IHN0cmluZztcbiAqICAgc291cmNlTWFwQ29udGVudD86IHN0cmluZztcbiAqICAgc291cmNlTWFwRW5jb2RlTWFwcGluZ3M/OiBib29sZWFuOyAvLyBkZWZhdWx0IHRydWVcbiAqICAgZ2V0TmFtZT86IChuYW1lOiBzdHJpbmcpID0+IHN0cmluZztcbiAqIH19IFByaW50T3B0aW9uc1xuICovXG5cbi8qKlxuICogQHBhcmFtIHtOb2RlfSBub2RlXG4gKiBAcGFyYW0ge1ByaW50T3B0aW9uc30gb3B0c1xuICogQHJldHVybnMge3sgY29kZTogc3RyaW5nLCBtYXA6IGFueSB9fSAvLyBUT0RPXG4gKi9cbmZ1bmN0aW9uIHByaW50KG5vZGUsIG9wdHMgPSB7fSkge1xuXHRpZiAoQXJyYXkuaXNBcnJheShub2RlKSkge1xuXHRcdHJldHVybiBwcmludCh7XG5cdFx0XHR0eXBlOiAnUHJvZ3JhbScsXG5cdFx0XHRib2R5OiBub2RlLFxuXHRcdFx0c291cmNlVHlwZTogJ21vZHVsZSdcblx0XHR9LCBvcHRzKTtcblx0fVxuXG5cdGNvbnN0IHtcblx0XHRnZXROYW1lID0gLyoqIEBwYXJhbSB7c3RyaW5nfSB4ICovICh4KSA9PiB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZCBzaWdpbCBAJHt4fWApO1xuXHRcdH1cblx0fSA9IG9wdHM7XG5cblx0bGV0IHsgbWFwOiBzY29wZV9tYXAsIHNjb3BlIH0gPSBhbmFseXplKG5vZGUpO1xuXHRjb25zdCBkZWNvbmZsaWN0ZWQgPSBuZXcgV2Vha01hcCgpO1xuXG5cdGNvbnN0IGNodW5rcyA9IGhhbmRsZShub2RlLCB7XG5cdFx0aW5kZW50OiAnJyxcblx0XHRnZXROYW1lLFxuXHRcdHNjb3BlLFxuXHRcdHNjb3BlX21hcCxcblx0XHRkZWNvbmZsaWN0ZWQsXG5cdFx0Y29tbWVudHM6IFtdXG5cdH0pO1xuXG5cdC8qKiBAdHlwZWRlZiB7W251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcl19IFNlZ21lbnQgKi9cblxuXHRsZXQgY29kZSA9ICcnO1xuXHRsZXQgY3VycmVudF9jb2x1bW4gPSAwO1xuXG5cdC8qKiBAdHlwZSB7U2VnbWVudFtdW119ICovXG5cdGxldCBtYXBwaW5ncyA9IFtdO1xuXG5cdC8qKiBAdHlwZSB7U2VnbWVudFtdfSAqL1xuXHRsZXQgY3VycmVudF9saW5lID0gW107XG5cblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjaHVua3MubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRjb25zdCBjaHVuayA9IGNodW5rc1tpXTtcblxuXHRcdGNvZGUgKz0gY2h1bmsuY29udGVudDtcblxuXHRcdGlmIChjaHVuay5sb2MpIHtcblx0XHRcdGN1cnJlbnRfbGluZS5wdXNoKFtcblx0XHRcdFx0Y3VycmVudF9jb2x1bW4sXG5cdFx0XHRcdDAsIC8vIHNvdXJjZSBpbmRleCBpcyBhbHdheXMgemVyb1xuXHRcdFx0XHRjaHVuay5sb2Muc3RhcnQubGluZSAtIDEsXG5cdFx0XHRcdGNodW5rLmxvYy5zdGFydC5jb2x1bW4sXG5cdFx0XHRdKTtcblx0XHR9XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGNodW5rLmNvbnRlbnQubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdGlmIChjaHVuay5jb250ZW50W2ldID09PSAnXFxuJykge1xuXHRcdFx0XHRtYXBwaW5ncy5wdXNoKGN1cnJlbnRfbGluZSk7XG5cdFx0XHRcdGN1cnJlbnRfbGluZSA9IFtdO1xuXHRcdFx0XHRjdXJyZW50X2NvbHVtbiA9IDA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjdXJyZW50X2NvbHVtbiArPSAxO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChjaHVuay5sb2MpIHtcblx0XHRcdGN1cnJlbnRfbGluZS5wdXNoKFtcblx0XHRcdFx0Y3VycmVudF9jb2x1bW4sXG5cdFx0XHRcdDAsIC8vIHNvdXJjZSBpbmRleCBpcyBhbHdheXMgemVyb1xuXHRcdFx0XHRjaHVuay5sb2MuZW5kLmxpbmUgLSAxLFxuXHRcdFx0XHRjaHVuay5sb2MuZW5kLmNvbHVtbixcblx0XHRcdF0pO1xuXHRcdH1cblx0fVxuXG5cdG1hcHBpbmdzLnB1c2goY3VycmVudF9saW5lKTtcblxuXHRjb25zdCBtYXAgPSB7XG5cdFx0dmVyc2lvbjogMyxcblx0XHQvKiogQHR5cGUge3N0cmluZ1tdfSAqL1xuXHRcdG5hbWVzOiBbXSxcblx0XHRzb3VyY2VzOiBbb3B0cy5zb3VyY2VNYXBTb3VyY2UgfHwgbnVsbF0sXG5cdFx0c291cmNlc0NvbnRlbnQ6IFtvcHRzLnNvdXJjZU1hcENvbnRlbnQgfHwgbnVsbF0sXG5cdFx0bWFwcGluZ3M6IG9wdHMuc291cmNlTWFwRW5jb2RlTWFwcGluZ3MgPT0gdW5kZWZpbmVkIHx8IG9wdHMuc291cmNlTWFwRW5jb2RlTWFwcGluZ3Ncblx0XHRcdD8gZW5jb2RlKG1hcHBpbmdzKSA6IG1hcHBpbmdzXG5cdH07XG5cblx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXMobWFwLCB7XG5cdFx0dG9TdHJpbmc6IHtcblx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuXHRcdFx0XHRyZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHR0b1VybDoge1xuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdG9VcmwoKSB7XG5cdFx0XHRcdHJldHVybiAnZGF0YTphcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTg7YmFzZTY0LCcgKyBidG9hJDEodGhpcy50b1N0cmluZygpKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiB7XG5cdFx0Y29kZSxcblx0XHRtYXBcblx0fTtcbn1cblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLkV4cHJlc3Npb259IEV4cHJlc3Npb24gKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCdlc3RyZWUnKS5Ob2RlfSBOb2RlICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnZXN0cmVlJykuT2JqZWN0RXhwcmVzc2lvbn0gT2JqZWN0RXhwcmVzc2lvbiAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLlByb3BlcnR5fSBQcm9wZXJ0eSAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJ2VzdHJlZScpLlNwcmVhZEVsZW1lbnR9IFNwcmVhZEVsZW1lbnQgKi9cblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4vdXRpbHMvY29tbWVudHMnKS5Db21tZW50V2l0aExvY2F0aW9ufSBDb21tZW50V2l0aExvY2F0aW9uICovXG5cbi8qKiBAdHlwZSB7UmVjb3JkPHN0cmluZywgc3RyaW5nPn0gKi9cbmNvbnN0IHNpZ2lscyA9IHtcblx0J0AnOiAnQVQnLFxuXHQnIyc6ICdIQVNIJ1xufTtcblxuLyoqIEBwYXJhbSB7VGVtcGxhdGVTdHJpbmdzQXJyYXl9IHN0cmluZ3MgKi9cbmNvbnN0IGpvaW4kMSA9IChzdHJpbmdzKSA9PiB7XG5cdGxldCBzdHIgPSBzdHJpbmdzWzBdO1xuXHRmb3IgKGxldCBpID0gMTsgaSA8IHN0cmluZ3MubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRzdHIgKz0gYF8ke2lkfV8ke2kgLSAxfV8ke3N0cmluZ3NbaV19YDtcblx0fVxuXHRyZXR1cm4gc3RyLnJlcGxhY2UoXG5cdFx0LyhbQCNdKShcXHcrKS9nLFxuXHRcdChfbSwgc2lnaWwsIG5hbWUpID0+IGBfJHtpZH1fJHtzaWdpbHNbc2lnaWxdfV8ke25hbWV9YFxuXHQpO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge2FueVtdfSBhcnJheVxuICogQHBhcmFtIHthbnlbXX0gdGFyZ2V0XG4gKi9cbmNvbnN0IGZsYXR0ZW5fYm9keSA9IChhcnJheSwgdGFyZ2V0KSA9PiB7XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRjb25zdCBzdGF0ZW1lbnQgPSBhcnJheVtpXTtcblx0XHRpZiAoQXJyYXkuaXNBcnJheShzdGF0ZW1lbnQpKSB7XG5cdFx0XHRmbGF0dGVuX2JvZHkoc3RhdGVtZW50LCB0YXJnZXQpO1xuXHRcdFx0Y29udGludWU7XG5cdFx0fVxuXG5cdFx0aWYgKHN0YXRlbWVudC50eXBlID09PSAnRXhwcmVzc2lvblN0YXRlbWVudCcpIHtcblx0XHRcdGlmIChzdGF0ZW1lbnQuZXhwcmVzc2lvbiA9PT0gRU1QVFkpIGNvbnRpbnVlO1xuXG5cdFx0XHRpZiAoQXJyYXkuaXNBcnJheShzdGF0ZW1lbnQuZXhwcmVzc2lvbikpIHtcblx0XHRcdFx0Ly8gVE9ETyB0aGlzIGlzIGhhY2t0YWN1bGFyXG5cdFx0XHRcdGxldCBub2RlID0gc3RhdGVtZW50LmV4cHJlc3Npb25bMF07XG5cdFx0XHRcdHdoaWxlIChBcnJheS5pc0FycmF5KG5vZGUpKSBub2RlID0gbm9kZVswXTtcblx0XHRcdFx0aWYgKG5vZGUpIG5vZGUubGVhZGluZ0NvbW1lbnRzID0gc3RhdGVtZW50LmxlYWRpbmdDb21tZW50cztcblxuXHRcdFx0XHRmbGF0dGVuX2JvZHkoc3RhdGVtZW50LmV4cHJlc3Npb24sIHRhcmdldCk7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoLyhFeHByZXNzaW9ufExpdGVyYWwpJC8udGVzdChzdGF0ZW1lbnQuZXhwcmVzc2lvbi50eXBlKSkge1xuXHRcdFx0XHR0YXJnZXQucHVzaChzdGF0ZW1lbnQpO1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHN0YXRlbWVudC5sZWFkaW5nQ29tbWVudHMpXG5cdFx0XHRcdHN0YXRlbWVudC5leHByZXNzaW9uLmxlYWRpbmdDb21tZW50cyA9IHN0YXRlbWVudC5sZWFkaW5nQ29tbWVudHM7XG5cdFx0XHRpZiAoc3RhdGVtZW50LnRyYWlsaW5nQ29tbWVudHMpXG5cdFx0XHRcdHN0YXRlbWVudC5leHByZXNzaW9uLnRyYWlsaW5nQ29tbWVudHMgPSBzdGF0ZW1lbnQudHJhaWxpbmdDb21tZW50cztcblxuXHRcdFx0dGFyZ2V0LnB1c2goc3RhdGVtZW50LmV4cHJlc3Npb24pO1xuXHRcdFx0Y29udGludWU7XG5cdFx0fVxuXG5cdFx0dGFyZ2V0LnB1c2goc3RhdGVtZW50KTtcblx0fVxuXG5cdHJldHVybiB0YXJnZXQ7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7YW55W119IGFycmF5XG4gKiBAcGFyYW0ge2FueVtdfSB0YXJnZXRcbiAqL1xuY29uc3QgZmxhdHRlbl9wcm9wZXJ0aWVzID0gKGFycmF5LCB0YXJnZXQpID0+IHtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdGNvbnN0IHByb3BlcnR5ID0gYXJyYXlbaV07XG5cblx0XHRpZiAocHJvcGVydHkudmFsdWUgPT09IEVNUFRZKSBjb250aW51ZTtcblxuXHRcdGlmIChwcm9wZXJ0eS5rZXkgPT09IHByb3BlcnR5LnZhbHVlICYmIEFycmF5LmlzQXJyYXkocHJvcGVydHkua2V5KSkge1xuXHRcdFx0ZmxhdHRlbl9wcm9wZXJ0aWVzKHByb3BlcnR5LmtleSwgdGFyZ2V0KTtcblx0XHRcdGNvbnRpbnVlO1xuXHRcdH1cblxuXHRcdHRhcmdldC5wdXNoKHByb3BlcnR5KTtcblx0fVxuXG5cdHJldHVybiB0YXJnZXQ7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7YW55W119IG5vZGVzXG4gKiBAcGFyYW0ge2FueVtdfSB0YXJnZXRcbiAqL1xuY29uc3QgZmxhdHRlbiQxID0gKG5vZGVzLCB0YXJnZXQpID0+IHtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcblxuXHRcdGlmIChub2RlID09PSBFTVBUWSkgY29udGludWU7XG5cblx0XHRpZiAoQXJyYXkuaXNBcnJheShub2RlKSkge1xuXHRcdFx0ZmxhdHRlbiQxKG5vZGUsIHRhcmdldCk7XG5cdFx0XHRjb250aW51ZTtcblx0XHR9XG5cblx0XHR0YXJnZXQucHVzaChub2RlKTtcblx0fVxuXG5cdHJldHVybiB0YXJnZXQ7XG59O1xuXG5jb25zdCBFTVBUWSA9IHsgdHlwZTogJ0VtcHR5JyB9O1xuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0NvbW1lbnRXaXRoTG9jYXRpb25bXX0gY29tbWVudHNcbiAqIEBwYXJhbSB7c3RyaW5nfSByYXdcbiAqIEByZXR1cm5zIHthbnl9XG4gKi9cbmNvbnN0IGFjb3JuX29wdHMgPSAoY29tbWVudHMsIHJhdykgPT4ge1xuXHRjb25zdCB7IG9uQ29tbWVudCB9ID0gZ2V0X2NvbW1lbnRfaGFuZGxlcnMoY29tbWVudHMsIHJhdyk7XG5cdHJldHVybiB7XG5cdFx0ZWNtYVZlcnNpb246IDIwMjAsXG5cdFx0c291cmNlVHlwZTogJ21vZHVsZScsXG5cdFx0YWxsb3dBd2FpdE91dHNpZGVGdW5jdGlvbjogdHJ1ZSxcblx0XHRhbGxvd0ltcG9ydEV4cG9ydEV2ZXJ5d2hlcmU6IHRydWUsXG5cdFx0YWxsb3dSZXR1cm5PdXRzaWRlRnVuY3Rpb246IHRydWUsXG5cdFx0b25Db21tZW50XG5cdH07XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSByYXdcbiAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICogQHBhcmFtIHthbnlbXX0gdmFsdWVzXG4gKiBAcGFyYW0ge0NvbW1lbnRXaXRoTG9jYXRpb25bXX0gY29tbWVudHNcbiAqL1xuY29uc3QgaW5qZWN0ID0gKHJhdywgbm9kZSwgdmFsdWVzLCBjb21tZW50cykgPT4ge1xuXHRjb21tZW50cy5mb3JFYWNoKChjb21tZW50KSA9PiB7XG5cdFx0Y29tbWVudC52YWx1ZSA9IGNvbW1lbnQudmFsdWUucmVwbGFjZShyZSwgKG0sIGkpID0+XG5cdFx0XHQraSBpbiB2YWx1ZXMgPyB2YWx1ZXNbK2ldIDogbVxuXHRcdCk7XG5cdH0pO1xuXG5cdGNvbnN0IHsgZW50ZXIsIGxlYXZlIH0gPSBnZXRfY29tbWVudF9oYW5kbGVycyhjb21tZW50cywgcmF3KTtcblxuXHRyZXR1cm4gd2Fsayhub2RlLCB7XG5cdFx0ZW50ZXIsXG5cblx0XHQvKiogQHBhcmFtIHthbnl9IG5vZGUgKi9cblx0XHRsZWF2ZShub2RlKSB7XG5cdFx0XHRpZiAobm9kZS50eXBlID09PSAnSWRlbnRpZmllcicpIHtcblx0XHRcdFx0cmUubGFzdEluZGV4ID0gMDtcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSByZS5leGVjKG5vZGUubmFtZSk7XG5cblx0XHRcdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRcdFx0aWYgKG1hdGNoWzFdKSB7XG5cdFx0XHRcdFx0XHRpZiAoK21hdGNoWzFdIGluIHZhbHVlcykge1xuXHRcdFx0XHRcdFx0XHRsZXQgdmFsdWUgPSB2YWx1ZXNbK21hdGNoWzFdXTtcblxuXHRcdFx0XHRcdFx0XHRpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdFx0XHRcdHZhbHVlID0ge1xuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogJ0lkZW50aWZpZXInLFxuXHRcdFx0XHRcdFx0XHRcdFx0bmFtZTogdmFsdWUsXG5cdFx0XHRcdFx0XHRcdFx0XHRsZWFkaW5nQ29tbWVudHM6IG5vZGUubGVhZGluZ0NvbW1lbnRzLFxuXHRcdFx0XHRcdFx0XHRcdFx0dHJhaWxpbmdDb21tZW50czogbm9kZS50cmFpbGluZ0NvbW1lbnRzXG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiAnTGl0ZXJhbCcsXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSxcblx0XHRcdFx0XHRcdFx0XHRcdGxlYWRpbmdDb21tZW50czogbm9kZS5sZWFkaW5nQ29tbWVudHMsXG5cdFx0XHRcdFx0XHRcdFx0XHR0cmFpbGluZ0NvbW1lbnRzOiBub2RlLnRyYWlsaW5nQ29tbWVudHNcblx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0dGhpcy5yZXBsYWNlKHZhbHVlIHx8IEVNUFRZKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0bm9kZS5uYW1lID0gYCR7bWF0Y2hbMl0gPyBgQGAgOiBgI2B9JHttYXRjaFs0XX1gO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAobm9kZS50eXBlID09PSAnTGl0ZXJhbCcpIHtcblx0XHRcdFx0aWYgKHR5cGVvZiBub2RlLnZhbHVlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHJlLmxhc3RJbmRleCA9IDA7XG5cdFx0XHRcdFx0Y29uc3QgbmV3X3ZhbHVlID0gLyoqIEB0eXBlIHtzdHJpbmd9ICovIChub2RlLnZhbHVlKS5yZXBsYWNlKFxuXHRcdFx0XHRcdFx0cmUsXG5cdFx0XHRcdFx0XHQobSwgaSkgPT4gKCtpIGluIHZhbHVlcyA/IHZhbHVlc1sraV0gOiBtKVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0Y29uc3QgaGFzX2NoYW5nZWQgPSBuZXdfdmFsdWUgIT09IG5vZGUudmFsdWU7XG5cdFx0XHRcdFx0bm9kZS52YWx1ZSA9IG5ld192YWx1ZTtcblx0XHRcdFx0XHRpZiAoaGFzX2NoYW5nZWQgJiYgbm9kZS5yYXcpIHtcblx0XHRcdFx0XHRcdC8vIHByZXNlcnZlIHRoZSBxdW90ZXNcblx0XHRcdFx0XHRcdG5vZGUucmF3ID0gYCR7bm9kZS5yYXdbMF19JHtKU09OLnN0cmluZ2lmeShub2RlLnZhbHVlKS5zbGljZShcblx0XHRcdFx0XHRcdFx0MSxcblx0XHRcdFx0XHRcdFx0LTFcblx0XHRcdFx0XHRcdCl9JHtub2RlLnJhd1tub2RlLnJhdy5sZW5ndGggLSAxXX1gO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAobm9kZS50eXBlID09PSAnVGVtcGxhdGVFbGVtZW50Jykge1xuXHRcdFx0XHRyZS5sYXN0SW5kZXggPSAwO1xuXHRcdFx0XHRub2RlLnZhbHVlLnJhdyA9IC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAobm9kZS52YWx1ZS5yYXcpLnJlcGxhY2UoXG5cdFx0XHRcdFx0cmUsXG5cdFx0XHRcdFx0KG0sIGkpID0+ICgraSBpbiB2YWx1ZXMgPyB2YWx1ZXNbK2ldIDogbSlcblx0XHRcdFx0KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKG5vZGUudHlwZSA9PT0gJ1Byb2dyYW0nIHx8IG5vZGUudHlwZSA9PT0gJ0Jsb2NrU3RhdGVtZW50Jykge1xuXHRcdFx0XHRub2RlLmJvZHkgPSBmbGF0dGVuX2JvZHkobm9kZS5ib2R5LCBbXSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChub2RlLnR5cGUgPT09ICdPYmplY3RFeHByZXNzaW9uJyB8fCBub2RlLnR5cGUgPT09ICdPYmplY3RQYXR0ZXJuJykge1xuXHRcdFx0XHRub2RlLnByb3BlcnRpZXMgPSBmbGF0dGVuX3Byb3BlcnRpZXMobm9kZS5wcm9wZXJ0aWVzLCBbXSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChub2RlLnR5cGUgPT09ICdBcnJheUV4cHJlc3Npb24nIHx8IG5vZGUudHlwZSA9PT0gJ0FycmF5UGF0dGVybicpIHtcblx0XHRcdFx0bm9kZS5lbGVtZW50cyA9IGZsYXR0ZW4kMShub2RlLmVsZW1lbnRzLCBbXSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChcblx0XHRcdFx0bm9kZS50eXBlID09PSAnRnVuY3Rpb25FeHByZXNzaW9uJyB8fFxuXHRcdFx0XHRub2RlLnR5cGUgPT09ICdGdW5jdGlvbkRlY2xhcmF0aW9uJyB8fFxuXHRcdFx0XHRub2RlLnR5cGUgPT09ICdBcnJvd0Z1bmN0aW9uRXhwcmVzc2lvbidcblx0XHRcdCkge1xuXHRcdFx0XHRub2RlLnBhcmFtcyA9IGZsYXR0ZW4kMShub2RlLnBhcmFtcywgW10pO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAobm9kZS50eXBlID09PSAnQ2FsbEV4cHJlc3Npb24nIHx8IG5vZGUudHlwZSA9PT0gJ05ld0V4cHJlc3Npb24nKSB7XG5cdFx0XHRcdG5vZGUuYXJndW1lbnRzID0gZmxhdHRlbiQxKG5vZGUuYXJndW1lbnRzLCBbXSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChcblx0XHRcdFx0bm9kZS50eXBlID09PSAnSW1wb3J0RGVjbGFyYXRpb24nIHx8XG5cdFx0XHRcdG5vZGUudHlwZSA9PT0gJ0V4cG9ydE5hbWVkRGVjbGFyYXRpb24nXG5cdFx0XHQpIHtcblx0XHRcdFx0bm9kZS5zcGVjaWZpZXJzID0gZmxhdHRlbiQxKG5vZGUuc3BlY2lmaWVycywgW10pO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAobm9kZS50eXBlID09PSAnRm9yU3RhdGVtZW50Jykge1xuXHRcdFx0XHRub2RlLmluaXQgPSBub2RlLmluaXQgPT09IEVNUFRZID8gbnVsbCA6IG5vZGUuaW5pdDtcblx0XHRcdFx0bm9kZS50ZXN0ID0gbm9kZS50ZXN0ID09PSBFTVBUWSA/IG51bGwgOiBub2RlLnRlc3Q7XG5cdFx0XHRcdG5vZGUudXBkYXRlID0gbm9kZS51cGRhdGUgPT09IEVNUFRZID8gbnVsbCA6IG5vZGUudXBkYXRlO1xuXHRcdFx0fVxuXG5cdFx0XHRsZWF2ZShub2RlKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLyoqXG4gKlxuICogQHBhcmFtIHtUZW1wbGF0ZVN0cmluZ3NBcnJheX0gc3RyaW5nc1xuICogQHBhcmFtICB7YW55W119IHZhbHVlc1xuICogQHJldHVybnMge05vZGVbXX1cbiAqL1xuZnVuY3Rpb24gYihzdHJpbmdzLCAuLi52YWx1ZXMpIHtcblx0Y29uc3Qgc3RyID0gam9pbiQxKHN0cmluZ3MpO1xuXG5cdC8qKiBAdHlwZSB7Q29tbWVudFdpdGhMb2NhdGlvbltdfSAqL1xuXHRjb25zdCBjb21tZW50cyA9IFtdO1xuXG5cdHRyeSB7XG5cdFx0bGV0IGFzdCA9IC8qKiBAdHlwZSB7YW55fSAqLyAoXG5cdFx0XHRwYXJzZShzdHIsIGFjb3JuX29wdHMoY29tbWVudHMsIHN0cikpXG5cdFx0KTtcblxuXHRcdGFzdCA9IGluamVjdChzdHIsIGFzdCwgdmFsdWVzLCBjb21tZW50cyk7XG5cblx0XHRyZXR1cm4gYXN0LmJvZHk7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGhhbmRsZV9lcnJvcihzdHIsIGVycik7XG5cdH1cbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIHtUZW1wbGF0ZVN0cmluZ3NBcnJheX0gc3RyaW5nc1xuICogQHBhcmFtICB7YW55W119IHZhbHVlc1xuICogQHJldHVybnMge0V4cHJlc3Npb24gJiB7IHN0YXJ0OiBOdW1iZXIsIGVuZDogbnVtYmVyIH19XG4gKi9cbmZ1bmN0aW9uIHgoc3RyaW5ncywgLi4udmFsdWVzKSB7XG5cdGNvbnN0IHN0ciA9IGpvaW4kMShzdHJpbmdzKTtcblxuXHQvKiogQHR5cGUge0NvbW1lbnRXaXRoTG9jYXRpb25bXX0gKi9cblx0Y29uc3QgY29tbWVudHMgPSBbXTtcblxuXHR0cnkge1xuXHRcdGxldCBleHByZXNzaW9uID1cblx0XHRcdC8qKiBAdHlwZSB7RXhwcmVzc2lvbiAmIHsgc3RhcnQ6IE51bWJlciwgZW5kOiBudW1iZXIgfX0gKi8gKFxuXHRcdFx0XHRwYXJzZUV4cHJlc3Npb25BdChzdHIsIDAsIGFjb3JuX29wdHMoY29tbWVudHMsIHN0cikpXG5cdFx0XHQpO1xuXHRcdGNvbnN0IG1hdGNoID0gL1xcUysvLmV4ZWMoc3RyLnNsaWNlKGV4cHJlc3Npb24uZW5kKSk7XG5cdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgdG9rZW4gJyR7bWF0Y2hbMF19J2ApO1xuXHRcdH1cblxuXHRcdGV4cHJlc3Npb24gPSAvKiogQHR5cGUge0V4cHJlc3Npb24gJiB7IHN0YXJ0OiBOdW1iZXIsIGVuZDogbnVtYmVyIH19ICovIChcblx0XHRcdGluamVjdChzdHIsIGV4cHJlc3Npb24sIHZhbHVlcywgY29tbWVudHMpXG5cdFx0KTtcblxuXHRcdHJldHVybiBleHByZXNzaW9uO1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHRoYW5kbGVfZXJyb3Ioc3RyLCBlcnIpO1xuXHR9XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7VGVtcGxhdGVTdHJpbmdzQXJyYXl9IHN0cmluZ3NcbiAqIEBwYXJhbSAge2FueVtdfSB2YWx1ZXNcbiAqIEByZXR1cm5zIHsoUHJvcGVydHkgfCBTcHJlYWRFbGVtZW50KSAmIHsgc3RhcnQ6IE51bWJlciwgZW5kOiBudW1iZXIgfX1cbiAqL1xuZnVuY3Rpb24gcChzdHJpbmdzLCAuLi52YWx1ZXMpIHtcblx0Y29uc3Qgc3RyID0gYHske2pvaW4kMShzdHJpbmdzKX19YDtcblxuXHQvKiogQHR5cGUge0NvbW1lbnRXaXRoTG9jYXRpb25bXX0gKi9cblx0Y29uc3QgY29tbWVudHMgPSBbXTtcblxuXHR0cnkge1xuXHRcdGxldCBleHByZXNzaW9uID0gLyoqIEB0eXBlIHthbnl9ICovIChcblx0XHRcdHBhcnNlRXhwcmVzc2lvbkF0KHN0ciwgMCwgYWNvcm5fb3B0cyhjb21tZW50cywgc3RyKSlcblx0XHQpO1xuXG5cdFx0ZXhwcmVzc2lvbiA9IGluamVjdChzdHIsIGV4cHJlc3Npb24sIHZhbHVlcywgY29tbWVudHMpO1xuXG5cdFx0cmV0dXJuIGV4cHJlc3Npb24ucHJvcGVydGllc1swXTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0aGFuZGxlX2Vycm9yKHN0ciwgZXJyKTtcblx0fVxufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEBwYXJhbSB7RXJyb3J9IGVyclxuICovXG5mdW5jdGlvbiBoYW5kbGVfZXJyb3Ioc3RyLCBlcnIpIHtcblx0Ly8gVE9ETyBsb2NhdGlvbi9jb2RlIGZyYW1lXG5cblx0cmUubGFzdEluZGV4ID0gMDtcblxuXHRzdHIgPSBzdHIucmVwbGFjZShyZSwgKG0sIGksIGF0LCBoYXNoLCBuYW1lKSA9PiB7XG5cdFx0aWYgKGF0KSByZXR1cm4gYEAke25hbWV9YDtcblx0XHRpZiAoaGFzaCkgcmV0dXJuIGAjJHtuYW1lfWA7XG5cblx0XHRyZXR1cm4gJyR7Li4ufSc7XG5cdH0pO1xuXG5cdGNvbnNvbGUubG9nKGBmYWlsZWQgdG8gcGFyc2U6XFxuJHtzdHJ9YCk7XG5cdHRocm93IGVycjtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gc291cmNlXG4gKiBAcGFyYW0ge2FueX0gb3B0c1xuICovXG5jb25zdCBwYXJzZSQxID0gKHNvdXJjZSwgb3B0cykgPT4ge1xuXHQvKiogQHR5cGUge0NvbW1lbnRXaXRoTG9jYXRpb25bXX0gKi9cblx0Y29uc3QgY29tbWVudHMgPSBbXTtcblx0Y29uc3QgeyBvbkNvbW1lbnQsIGVudGVyLCBsZWF2ZSB9ID0gZ2V0X2NvbW1lbnRfaGFuZGxlcnMoY29tbWVudHMsIHNvdXJjZSk7XG5cdGNvbnN0IGFzdCA9IC8qKiBAdHlwZSB7YW55fSAqLyAocGFyc2Uoc291cmNlLCB7IG9uQ29tbWVudCwgLi4ub3B0cyB9KSk7XG5cdHdhbGsoYXN0LCB7IGVudGVyLCBsZWF2ZSB9KTtcblx0cmV0dXJuIGFzdDtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZVxuICogQHBhcmFtIHtudW1iZXJ9IGluZGV4XG4gKiBAcGFyYW0ge2FueX0gb3B0c1xuICovXG5jb25zdCBwYXJzZUV4cHJlc3Npb25BdCQxID0gKHNvdXJjZSwgaW5kZXgsIG9wdHMpID0+IHtcblx0LyoqIEB0eXBlIHtDb21tZW50V2l0aExvY2F0aW9uW119ICovXG5cdGNvbnN0IGNvbW1lbnRzID0gW107XG5cdGNvbnN0IHsgb25Db21tZW50LCBlbnRlciwgbGVhdmUgfSA9IGdldF9jb21tZW50X2hhbmRsZXJzKGNvbW1lbnRzLCBzb3VyY2UpO1xuXHRjb25zdCBhc3QgPSAvKiogQHR5cGUge2FueX0gKi8gKFxuXHRcdHBhcnNlRXhwcmVzc2lvbkF0KHNvdXJjZSwgaW5kZXgsIHsgb25Db21tZW50LCAuLi5vcHRzIH0pXG5cdCk7XG5cdHdhbGsoYXN0LCB7IGVudGVyLCBsZWF2ZSB9KTtcblx0cmV0dXJuIGFzdDtcbn07XG5cbmNvbnN0IHBhcnNlJDIgPSAoc291cmNlKSA9PiBwYXJzZSQxKHNvdXJjZSwge1xuICAgIHNvdXJjZVR5cGU6ICdtb2R1bGUnLFxuICAgIGVjbWFWZXJzaW9uOiAxMixcbiAgICBsb2NhdGlvbnM6IHRydWVcbn0pO1xuY29uc3QgcGFyc2VfZXhwcmVzc2lvbl9hdCA9IChzb3VyY2UsIGluZGV4KSA9PiBwYXJzZUV4cHJlc3Npb25BdCQxKHNvdXJjZSwgaW5kZXgsIHtcbiAgICBzb3VyY2VUeXBlOiAnbW9kdWxlJyxcbiAgICBlY21hVmVyc2lvbjogMTIsXG4gICAgbG9jYXRpb25zOiB0cnVlXG59KTtcblxuZnVuY3Rpb24gcmVhZF9leHByZXNzaW9uKHBhcnNlcikge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBwYXJzZV9leHByZXNzaW9uX2F0KHBhcnNlci50ZW1wbGF0ZSwgcGFyc2VyLmluZGV4KTtcbiAgICAgICAgbGV0IG51bV9wYXJlbnMgPSAwO1xuICAgICAgICBmb3IgKGxldCBpID0gcGFyc2VyLmluZGV4OyBpIDwgbm9kZS5zdGFydDsgaSArPSAxKSB7XG4gICAgICAgICAgICBpZiAocGFyc2VyLnRlbXBsYXRlW2ldID09PSAnKCcpXG4gICAgICAgICAgICAgICAgbnVtX3BhcmVucyArPSAxO1xuICAgICAgICB9XG4gICAgICAgIGxldCBpbmRleCA9IG5vZGUuZW5kO1xuICAgICAgICB3aGlsZSAobnVtX3BhcmVucyA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGNoYXIgPSBwYXJzZXIudGVtcGxhdGVbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKGNoYXIgPT09ICcpJykge1xuICAgICAgICAgICAgICAgIG51bV9wYXJlbnMgLT0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFyZWdleF93aGl0ZXNwYWNlLnRlc3QoY2hhcikpIHtcbiAgICAgICAgICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy51bmV4cGVjdGVkX3Rva2VuKCcpJyksIGluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluZGV4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcGFyc2VyLmluZGV4ID0gaW5kZXg7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHBhcnNlci5hY29ybl9lcnJvcihlcnIpO1xuICAgIH1cbn1cblxuY29uc3QgcmVnZXhfY2xvc2luZ19zY3JpcHRfdGFnID0gLzxcXC9zY3JpcHRcXHMqPi87XG5mdW5jdGlvbiBnZXRfY29udGV4dChwYXJzZXIsIGF0dHJpYnV0ZXMsIHN0YXJ0KSB7XG4gICAgY29uc3QgY29udGV4dCA9IGF0dHJpYnV0ZXMuZmluZChhdHRyaWJ1dGUgPT4gYXR0cmlidXRlLm5hbWUgPT09ICdjb250ZXh0Jyk7XG4gICAgaWYgKCFjb250ZXh0KVxuICAgICAgICByZXR1cm4gJ2RlZmF1bHQnO1xuICAgIGlmIChjb250ZXh0LnZhbHVlLmxlbmd0aCAhPT0gMSB8fCBjb250ZXh0LnZhbHVlWzBdLnR5cGUgIT09ICdUZXh0Jykge1xuICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy5pbnZhbGlkX3NjcmlwdF9jb250ZXh0X2F0dHJpYnV0ZSwgc3RhcnQpO1xuICAgIH1cbiAgICBjb25zdCB2YWx1ZSA9IGNvbnRleHQudmFsdWVbMF0uZGF0YTtcbiAgICBpZiAodmFsdWUgIT09ICdtb2R1bGUnKSB7XG4gICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmludmFsaWRfc2NyaXB0X2NvbnRleHRfdmFsdWUsIGNvbnRleHQuc3RhcnQpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiByZWFkX3NjcmlwdChwYXJzZXIsIHN0YXJ0LCBhdHRyaWJ1dGVzKSB7XG4gICAgY29uc3Qgc2NyaXB0X3N0YXJ0ID0gcGFyc2VyLmluZGV4O1xuICAgIGNvbnN0IGRhdGEgPSBwYXJzZXIucmVhZF91bnRpbChyZWdleF9jbG9zaW5nX3NjcmlwdF90YWcsIHBhcnNlcl9lcnJvcnMudW5jbG9zZWRfc2NyaXB0KTtcbiAgICBpZiAocGFyc2VyLmluZGV4ID49IHBhcnNlci50ZW1wbGF0ZS5sZW5ndGgpIHtcbiAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMudW5jbG9zZWRfc2NyaXB0KTtcbiAgICB9XG4gICAgY29uc3Qgc291cmNlID0gcGFyc2VyLnRlbXBsYXRlLnNsaWNlKDAsIHNjcmlwdF9zdGFydCkucmVwbGFjZShyZWdleF9ub3RfbmV3bGluZV9jaGFyYWN0ZXJzLCAnICcpICsgZGF0YTtcbiAgICBwYXJzZXIucmVhZChyZWdleF9jbG9zaW5nX3NjcmlwdF90YWcpO1xuICAgIGxldCBhc3Q7XG4gICAgdHJ5IHtcbiAgICAgICAgYXN0ID0gcGFyc2UkMihzb3VyY2UpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHBhcnNlci5hY29ybl9lcnJvcihlcnIpO1xuICAgIH1cbiAgICAvLyBUT0RPIGlzIHRoaXMgbmVjZXNzYXJ5P1xuICAgIGFzdC5zdGFydCA9IHNjcmlwdF9zdGFydDtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnU2NyaXB0JyxcbiAgICAgICAgc3RhcnQsXG4gICAgICAgIGVuZDogcGFyc2VyLmluZGV4LFxuICAgICAgICBjb250ZXh0OiBnZXRfY29udGV4dChwYXJzZXIsIGF0dHJpYnV0ZXMsIHN0YXJ0KSxcbiAgICAgICAgY29udGVudDogYXN0XG4gICAgfTtcbn1cblxudmFyIE1JTl9TSVpFID0gMTYgKiAxMDI0O1xudmFyIFNhZmVVaW50MzJBcnJheSA9IHR5cGVvZiBVaW50MzJBcnJheSAhPT0gJ3VuZGVmaW5lZCcgPyBVaW50MzJBcnJheSA6IEFycmF5OyAvLyBmYWxsYmFjayBvbiBBcnJheSB3aGVuIFR5cGVkQXJyYXkgaXMgbm90IHN1cHBvcnRlZFxuXG52YXIgYWRvcHRCdWZmZXIgPSBmdW5jdGlvbiBhZG9wdEJ1ZmZlcihidWZmZXIsIHNpemUpIHtcbiAgICBpZiAoYnVmZmVyID09PSBudWxsIHx8IGJ1ZmZlci5sZW5ndGggPCBzaXplKSB7XG4gICAgICAgIHJldHVybiBuZXcgU2FmZVVpbnQzMkFycmF5KE1hdGgubWF4KHNpemUgKyAxMDI0LCBNSU5fU0laRSkpO1xuICAgIH1cblxuICAgIHJldHVybiBidWZmZXI7XG59O1xuXG4vLyBDU1MgU3ludGF4IE1vZHVsZSBMZXZlbCAzXG4vLyBodHRwczovL3d3dy53My5vcmcvVFIvY3NzLXN5bnRheC0zL1xudmFyIFRZUEUgPSB7XG4gICAgRU9GOiAwLCAgICAgICAgICAgICAgICAgLy8gPEVPRi10b2tlbj5cbiAgICBJZGVudDogMSwgICAgICAgICAgICAgICAvLyA8aWRlbnQtdG9rZW4+XG4gICAgRnVuY3Rpb246IDIsICAgICAgICAgICAgLy8gPGZ1bmN0aW9uLXRva2VuPlxuICAgIEF0S2V5d29yZDogMywgICAgICAgICAgIC8vIDxhdC1rZXl3b3JkLXRva2VuPlxuICAgIEhhc2g6IDQsICAgICAgICAgICAgICAgIC8vIDxoYXNoLXRva2VuPlxuICAgIFN0cmluZzogNSwgICAgICAgICAgICAgIC8vIDxzdHJpbmctdG9rZW4+XG4gICAgQmFkU3RyaW5nOiA2LCAgICAgICAgICAgLy8gPGJhZC1zdHJpbmctdG9rZW4+XG4gICAgVXJsOiA3LCAgICAgICAgICAgICAgICAgLy8gPHVybC10b2tlbj5cbiAgICBCYWRVcmw6IDgsICAgICAgICAgICAgICAvLyA8YmFkLXVybC10b2tlbj5cbiAgICBEZWxpbTogOSwgICAgICAgICAgICAgICAvLyA8ZGVsaW0tdG9rZW4+XG4gICAgTnVtYmVyOiAxMCwgICAgICAgICAgICAgLy8gPG51bWJlci10b2tlbj5cbiAgICBQZXJjZW50YWdlOiAxMSwgICAgICAgICAvLyA8cGVyY2VudGFnZS10b2tlbj5cbiAgICBEaW1lbnNpb246IDEyLCAgICAgICAgICAvLyA8ZGltZW5zaW9uLXRva2VuPlxuICAgIFdoaXRlU3BhY2U6IDEzLCAgICAgICAgIC8vIDx3aGl0ZXNwYWNlLXRva2VuPlxuICAgIENETzogMTQsICAgICAgICAgICAgICAgIC8vIDxDRE8tdG9rZW4+XG4gICAgQ0RDOiAxNSwgICAgICAgICAgICAgICAgLy8gPENEQy10b2tlbj5cbiAgICBDb2xvbjogMTYsICAgICAgICAgICAgICAvLyA8Y29sb24tdG9rZW4+ICAgICA6XG4gICAgU2VtaWNvbG9uOiAxNywgICAgICAgICAgLy8gPHNlbWljb2xvbi10b2tlbj4gO1xuICAgIENvbW1hOiAxOCwgICAgICAgICAgICAgIC8vIDxjb21tYS10b2tlbj4gICAgICxcbiAgICBMZWZ0U3F1YXJlQnJhY2tldDogMTksICAvLyA8Wy10b2tlbj5cbiAgICBSaWdodFNxdWFyZUJyYWNrZXQ6IDIwLCAvLyA8XS10b2tlbj5cbiAgICBMZWZ0UGFyZW50aGVzaXM6IDIxLCAgICAvLyA8KC10b2tlbj5cbiAgICBSaWdodFBhcmVudGhlc2lzOiAyMiwgICAvLyA8KS10b2tlbj5cbiAgICBMZWZ0Q3VybHlCcmFja2V0OiAyMywgICAvLyA8ey10b2tlbj5cbiAgICBSaWdodEN1cmx5QnJhY2tldDogMjQsICAvLyA8fS10b2tlbj5cbiAgICBDb21tZW50OiAyNVxufTtcblxudmFyIE5BTUUgPSBPYmplY3Qua2V5cyhUWVBFKS5yZWR1Y2UoZnVuY3Rpb24ocmVzdWx0LCBrZXkpIHtcbiAgICByZXN1bHRbVFlQRVtrZXldXSA9IGtleTtcbiAgICByZXR1cm4gcmVzdWx0O1xufSwge30pO1xuXG52YXIgX2NvbnN0ID0ge1xuICAgIFRZUEU6IFRZUEUsXG4gICAgTkFNRTogTkFNRVxufTtcblxudmFyIEVPRiA9IDA7XG5cbi8vIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3Mtc3ludGF4LTMvXG4vLyDCpyA0LjIuIERlZmluaXRpb25zXG5cbi8vIGRpZ2l0XG4vLyBBIGNvZGUgcG9pbnQgYmV0d2VlbiBVKzAwMzAgRElHSVQgWkVSTyAoMCkgYW5kIFUrMDAzOSBESUdJVCBOSU5FICg5KS5cbmZ1bmN0aW9uIGlzRGlnaXQoY29kZSkge1xuICAgIHJldHVybiBjb2RlID49IDB4MDAzMCAmJiBjb2RlIDw9IDB4MDAzOTtcbn1cblxuLy8gaGV4IGRpZ2l0XG4vLyBBIGRpZ2l0LCBvciBhIGNvZGUgcG9pbnQgYmV0d2VlbiBVKzAwNDEgTEFUSU4gQ0FQSVRBTCBMRVRURVIgQSAoQSkgYW5kIFUrMDA0NiBMQVRJTiBDQVBJVEFMIExFVFRFUiBGIChGKSxcbi8vIG9yIGEgY29kZSBwb2ludCBiZXR3ZWVuIFUrMDA2MSBMQVRJTiBTTUFMTCBMRVRURVIgQSAoYSkgYW5kIFUrMDA2NiBMQVRJTiBTTUFMTCBMRVRURVIgRiAoZikuXG5mdW5jdGlvbiBpc0hleERpZ2l0JDEoY29kZSkge1xuICAgIHJldHVybiAoXG4gICAgICAgIGlzRGlnaXQoY29kZSkgfHwgLy8gMCAuLiA5XG4gICAgICAgIChjb2RlID49IDB4MDA0MSAmJiBjb2RlIDw9IDB4MDA0NikgfHwgLy8gQSAuLiBGXG4gICAgICAgIChjb2RlID49IDB4MDA2MSAmJiBjb2RlIDw9IDB4MDA2NikgICAgLy8gYSAuLiBmXG4gICAgKTtcbn1cblxuLy8gdXBwZXJjYXNlIGxldHRlclxuLy8gQSBjb2RlIHBvaW50IGJldHdlZW4gVSswMDQxIExBVElOIENBUElUQUwgTEVUVEVSIEEgKEEpIGFuZCBVKzAwNUEgTEFUSU4gQ0FQSVRBTCBMRVRURVIgWiAoWikuXG5mdW5jdGlvbiBpc1VwcGVyY2FzZUxldHRlcihjb2RlKSB7XG4gICAgcmV0dXJuIGNvZGUgPj0gMHgwMDQxICYmIGNvZGUgPD0gMHgwMDVBO1xufVxuXG4vLyBsb3dlcmNhc2UgbGV0dGVyXG4vLyBBIGNvZGUgcG9pbnQgYmV0d2VlbiBVKzAwNjEgTEFUSU4gU01BTEwgTEVUVEVSIEEgKGEpIGFuZCBVKzAwN0EgTEFUSU4gU01BTEwgTEVUVEVSIFogKHopLlxuZnVuY3Rpb24gaXNMb3dlcmNhc2VMZXR0ZXIoY29kZSkge1xuICAgIHJldHVybiBjb2RlID49IDB4MDA2MSAmJiBjb2RlIDw9IDB4MDA3QTtcbn1cblxuLy8gbGV0dGVyXG4vLyBBbiB1cHBlcmNhc2UgbGV0dGVyIG9yIGEgbG93ZXJjYXNlIGxldHRlci5cbmZ1bmN0aW9uIGlzTGV0dGVyKGNvZGUpIHtcbiAgICByZXR1cm4gaXNVcHBlcmNhc2VMZXR0ZXIoY29kZSkgfHwgaXNMb3dlcmNhc2VMZXR0ZXIoY29kZSk7XG59XG5cbi8vIG5vbi1BU0NJSSBjb2RlIHBvaW50XG4vLyBBIGNvZGUgcG9pbnQgd2l0aCBhIHZhbHVlIGVxdWFsIHRvIG9yIGdyZWF0ZXIgdGhhbiBVKzAwODAgPGNvbnRyb2w+LlxuZnVuY3Rpb24gaXNOb25Bc2NpaShjb2RlKSB7XG4gICAgcmV0dXJuIGNvZGUgPj0gMHgwMDgwO1xufVxuXG4vLyBuYW1lLXN0YXJ0IGNvZGUgcG9pbnRcbi8vIEEgbGV0dGVyLCBhIG5vbi1BU0NJSSBjb2RlIHBvaW50LCBvciBVKzAwNUYgTE9XIExJTkUgKF8pLlxuZnVuY3Rpb24gaXNOYW1lU3RhcnQoY29kZSkge1xuICAgIHJldHVybiBpc0xldHRlcihjb2RlKSB8fCBpc05vbkFzY2lpKGNvZGUpIHx8IGNvZGUgPT09IDB4MDA1Rjtcbn1cblxuLy8gbmFtZSBjb2RlIHBvaW50XG4vLyBBIG5hbWUtc3RhcnQgY29kZSBwb2ludCwgYSBkaWdpdCwgb3IgVSswMDJEIEhZUEhFTi1NSU5VUyAoLSkuXG5mdW5jdGlvbiBpc05hbWUoY29kZSkge1xuICAgIHJldHVybiBpc05hbWVTdGFydChjb2RlKSB8fCBpc0RpZ2l0KGNvZGUpIHx8IGNvZGUgPT09IDB4MDAyRDtcbn1cblxuLy8gbm9uLXByaW50YWJsZSBjb2RlIHBvaW50XG4vLyBBIGNvZGUgcG9pbnQgYmV0d2VlbiBVKzAwMDAgTlVMTCBhbmQgVSswMDA4IEJBQ0tTUEFDRSwgb3IgVSswMDBCIExJTkUgVEFCVUxBVElPTixcbi8vIG9yIGEgY29kZSBwb2ludCBiZXR3ZWVuIFUrMDAwRSBTSElGVCBPVVQgYW5kIFUrMDAxRiBJTkZPUk1BVElPTiBTRVBBUkFUT1IgT05FLCBvciBVKzAwN0YgREVMRVRFLlxuZnVuY3Rpb24gaXNOb25QcmludGFibGUoY29kZSkge1xuICAgIHJldHVybiAoXG4gICAgICAgIChjb2RlID49IDB4MDAwMCAmJiBjb2RlIDw9IDB4MDAwOCkgfHxcbiAgICAgICAgKGNvZGUgPT09IDB4MDAwQikgfHxcbiAgICAgICAgKGNvZGUgPj0gMHgwMDBFICYmIGNvZGUgPD0gMHgwMDFGKSB8fFxuICAgICAgICAoY29kZSA9PT0gMHgwMDdGKVxuICAgICk7XG59XG5cbi8vIG5ld2xpbmVcbi8vIFUrMDAwQSBMSU5FIEZFRUQuIE5vdGUgdGhhdCBVKzAwMEQgQ0FSUklBR0UgUkVUVVJOIGFuZCBVKzAwMEMgRk9STSBGRUVEIGFyZSBub3QgaW5jbHVkZWQgaW4gdGhpcyBkZWZpbml0aW9uLFxuLy8gYXMgdGhleSBhcmUgY29udmVydGVkIHRvIFUrMDAwQSBMSU5FIEZFRUQgZHVyaW5nIHByZXByb2Nlc3NpbmcuXG4vLyBUT0RPOiB3ZSBkb2Vzbid0IGRvIGEgcHJlcHJvY2Vzc2luZywgc28gY2hlY2sgYSBjb2RlIHBvaW50IGZvciBVKzAwMEQgQ0FSUklBR0UgUkVUVVJOIGFuZCBVKzAwMEMgRk9STSBGRUVEXG5mdW5jdGlvbiBpc05ld2xpbmUoY29kZSkge1xuICAgIHJldHVybiBjb2RlID09PSAweDAwMEEgfHwgY29kZSA9PT0gMHgwMDBEIHx8IGNvZGUgPT09IDB4MDAwQztcbn1cblxuLy8gd2hpdGVzcGFjZVxuLy8gQSBuZXdsaW5lLCBVKzAwMDkgQ0hBUkFDVEVSIFRBQlVMQVRJT04sIG9yIFUrMDAyMCBTUEFDRS5cbmZ1bmN0aW9uIGlzV2hpdGVTcGFjZShjb2RlKSB7XG4gICAgcmV0dXJuIGlzTmV3bGluZShjb2RlKSB8fCBjb2RlID09PSAweDAwMjAgfHwgY29kZSA9PT0gMHgwMDA5O1xufVxuXG4vLyDCpyA0LjMuOC4gQ2hlY2sgaWYgdHdvIGNvZGUgcG9pbnRzIGFyZSBhIHZhbGlkIGVzY2FwZVxuZnVuY3Rpb24gaXNWYWxpZEVzY2FwZShmaXJzdCwgc2Vjb25kKSB7XG4gICAgLy8gSWYgdGhlIGZpcnN0IGNvZGUgcG9pbnQgaXMgbm90IFUrMDA1QyBSRVZFUlNFIFNPTElEVVMgKFxcKSwgcmV0dXJuIGZhbHNlLlxuICAgIGlmIChmaXJzdCAhPT0gMHgwMDVDKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBPdGhlcndpc2UsIGlmIHRoZSBzZWNvbmQgY29kZSBwb2ludCBpcyBhIG5ld2xpbmUgb3IgRU9GLCByZXR1cm4gZmFsc2UuXG4gICAgaWYgKGlzTmV3bGluZShzZWNvbmQpIHx8IHNlY29uZCA9PT0gRU9GKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBPdGhlcndpc2UsIHJldHVybiB0cnVlLlxuICAgIHJldHVybiB0cnVlO1xufVxuXG4vLyDCpyA0LjMuOS4gQ2hlY2sgaWYgdGhyZWUgY29kZSBwb2ludHMgd291bGQgc3RhcnQgYW4gaWRlbnRpZmllclxuZnVuY3Rpb24gaXNJZGVudGlmaWVyU3RhcnQkMShmaXJzdCwgc2Vjb25kLCB0aGlyZCkge1xuICAgIC8vIExvb2sgYXQgdGhlIGZpcnN0IGNvZGUgcG9pbnQ6XG5cbiAgICAvLyBVKzAwMkQgSFlQSEVOLU1JTlVTXG4gICAgaWYgKGZpcnN0ID09PSAweDAwMkQpIHtcbiAgICAgICAgLy8gSWYgdGhlIHNlY29uZCBjb2RlIHBvaW50IGlzIGEgbmFtZS1zdGFydCBjb2RlIHBvaW50IG9yIGEgVSswMDJEIEhZUEhFTi1NSU5VUyxcbiAgICAgICAgLy8gb3IgdGhlIHNlY29uZCBhbmQgdGhpcmQgY29kZSBwb2ludHMgYXJlIGEgdmFsaWQgZXNjYXBlLCByZXR1cm4gdHJ1ZS4gT3RoZXJ3aXNlLCByZXR1cm4gZmFsc2UuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBpc05hbWVTdGFydChzZWNvbmQpIHx8XG4gICAgICAgICAgICBzZWNvbmQgPT09IDB4MDAyRCB8fFxuICAgICAgICAgICAgaXNWYWxpZEVzY2FwZShzZWNvbmQsIHRoaXJkKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8vIG5hbWUtc3RhcnQgY29kZSBwb2ludFxuICAgIGlmIChpc05hbWVTdGFydChmaXJzdCkpIHtcbiAgICAgICAgLy8gUmV0dXJuIHRydWUuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIFUrMDA1QyBSRVZFUlNFIFNPTElEVVMgKFxcKVxuICAgIGlmIChmaXJzdCA9PT0gMHgwMDVDKSB7XG4gICAgICAgIC8vIElmIHRoZSBmaXJzdCBhbmQgc2Vjb25kIGNvZGUgcG9pbnRzIGFyZSBhIHZhbGlkIGVzY2FwZSwgcmV0dXJuIHRydWUuIE90aGVyd2lzZSwgcmV0dXJuIGZhbHNlLlxuICAgICAgICByZXR1cm4gaXNWYWxpZEVzY2FwZShmaXJzdCwgc2Vjb25kKTtcbiAgICB9XG5cbiAgICAvLyBhbnl0aGluZyBlbHNlXG4gICAgLy8gUmV0dXJuIGZhbHNlLlxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLy8gwqcgNC4zLjEwLiBDaGVjayBpZiB0aHJlZSBjb2RlIHBvaW50cyB3b3VsZCBzdGFydCBhIG51bWJlclxuZnVuY3Rpb24gaXNOdW1iZXJTdGFydChmaXJzdCwgc2Vjb25kLCB0aGlyZCkge1xuICAgIC8vIExvb2sgYXQgdGhlIGZpcnN0IGNvZGUgcG9pbnQ6XG5cbiAgICAvLyBVKzAwMkIgUExVUyBTSUdOICgrKVxuICAgIC8vIFUrMDAyRCBIWVBIRU4tTUlOVVMgKC0pXG4gICAgaWYgKGZpcnN0ID09PSAweDAwMkIgfHwgZmlyc3QgPT09IDB4MDAyRCkge1xuICAgICAgICAvLyBJZiB0aGUgc2Vjb25kIGNvZGUgcG9pbnQgaXMgYSBkaWdpdCwgcmV0dXJuIHRydWUuXG4gICAgICAgIGlmIChpc0RpZ2l0KHNlY29uZCkpIHtcbiAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBpZiB0aGUgc2Vjb25kIGNvZGUgcG9pbnQgaXMgYSBVKzAwMkUgRlVMTCBTVE9QICguKVxuICAgICAgICAvLyBhbmQgdGhlIHRoaXJkIGNvZGUgcG9pbnQgaXMgYSBkaWdpdCwgcmV0dXJuIHRydWUuXG4gICAgICAgIC8vIE90aGVyd2lzZSwgcmV0dXJuIGZhbHNlLlxuICAgICAgICByZXR1cm4gc2Vjb25kID09PSAweDAwMkUgJiYgaXNEaWdpdCh0aGlyZCkgPyAzIDogMDtcbiAgICB9XG5cbiAgICAvLyBVKzAwMkUgRlVMTCBTVE9QICguKVxuICAgIGlmIChmaXJzdCA9PT0gMHgwMDJFKSB7XG4gICAgICAgIC8vIElmIHRoZSBzZWNvbmQgY29kZSBwb2ludCBpcyBhIGRpZ2l0LCByZXR1cm4gdHJ1ZS4gT3RoZXJ3aXNlLCByZXR1cm4gZmFsc2UuXG4gICAgICAgIHJldHVybiBpc0RpZ2l0KHNlY29uZCkgPyAyIDogMDtcbiAgICB9XG5cbiAgICAvLyBkaWdpdFxuICAgIGlmIChpc0RpZ2l0KGZpcnN0KSkge1xuICAgICAgICAvLyBSZXR1cm4gdHJ1ZS5cbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuXG4gICAgLy8gYW55dGhpbmcgZWxzZVxuICAgIC8vIFJldHVybiBmYWxzZS5cbiAgICByZXR1cm4gMDtcbn1cblxuLy9cbi8vIE1pc2Ncbi8vXG5cbi8vIGRldGVjdCBCT00gKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0J5dGVfb3JkZXJfbWFyaylcbmZ1bmN0aW9uIGlzQk9NKGNvZGUpIHtcbiAgICAvLyBVVEYtMTZCRVxuICAgIGlmIChjb2RlID09PSAweEZFRkYpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuXG4gICAgLy8gVVRGLTE2TEVcbiAgICBpZiAoY29kZSA9PT0gMHhGRkZFKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cblxuICAgIHJldHVybiAwO1xufVxuXG4vLyBGYXN0IGNvZGUgY2F0ZWdvcnlcbi8vXG4vLyBodHRwczovL2RyYWZ0cy5jc3N3Zy5vcmcvY3NzLXN5bnRheC8jdG9rZW5pemVyLWRlZmluaXRpb25zXG4vLyA+IG5vbi1BU0NJSSBjb2RlIHBvaW50XG4vLyA+ICAgQSBjb2RlIHBvaW50IHdpdGggYSB2YWx1ZSBlcXVhbCB0byBvciBncmVhdGVyIHRoYW4gVSswMDgwIDxjb250cm9sPlxuLy8gPiBuYW1lLXN0YXJ0IGNvZGUgcG9pbnRcbi8vID4gICBBIGxldHRlciwgYSBub24tQVNDSUkgY29kZSBwb2ludCwgb3IgVSswMDVGIExPVyBMSU5FIChfKS5cbi8vID4gbmFtZSBjb2RlIHBvaW50XG4vLyA+ICAgQSBuYW1lLXN0YXJ0IGNvZGUgcG9pbnQsIGEgZGlnaXQsIG9yIFUrMDAyRCBIWVBIRU4tTUlOVVMgKC0pXG4vLyBUaGF0IG1lYW5zIG9ubHkgQVNDSUkgY29kZSBwb2ludHMgaGFzIGEgc3BlY2lhbCBtZWFuaW5nIGFuZCB3ZSBkZWZpbmUgYSBtYXBzIGZvciAwLi4xMjcgY29kZXMgb25seVxudmFyIENBVEVHT1JZID0gbmV3IEFycmF5KDB4ODApO1xuY2hhckNvZGVDYXRlZ29yeS5Fb2YgPSAweDgwO1xuY2hhckNvZGVDYXRlZ29yeS5XaGl0ZVNwYWNlID0gMHg4MjtcbmNoYXJDb2RlQ2F0ZWdvcnkuRGlnaXQgPSAweDgzO1xuY2hhckNvZGVDYXRlZ29yeS5OYW1lU3RhcnQgPSAweDg0O1xuY2hhckNvZGVDYXRlZ29yeS5Ob25QcmludGFibGUgPSAweDg1O1xuXG5mb3IgKHZhciBpJDIgPSAwOyBpJDIgPCBDQVRFR09SWS5sZW5ndGg7IGkkMisrKSB7XG4gICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgIGNhc2UgaXNXaGl0ZVNwYWNlKGkkMik6XG4gICAgICAgICAgICBDQVRFR09SWVtpJDJdID0gY2hhckNvZGVDYXRlZ29yeS5XaGl0ZVNwYWNlO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBpc0RpZ2l0KGkkMik6XG4gICAgICAgICAgICBDQVRFR09SWVtpJDJdID0gY2hhckNvZGVDYXRlZ29yeS5EaWdpdDtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgaXNOYW1lU3RhcnQoaSQyKTpcbiAgICAgICAgICAgIENBVEVHT1JZW2kkMl0gPSBjaGFyQ29kZUNhdGVnb3J5Lk5hbWVTdGFydDtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgaXNOb25QcmludGFibGUoaSQyKTpcbiAgICAgICAgICAgIENBVEVHT1JZW2kkMl0gPSBjaGFyQ29kZUNhdGVnb3J5Lk5vblByaW50YWJsZTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBDQVRFR09SWVtpJDJdID0gaSQyIHx8IGNoYXJDb2RlQ2F0ZWdvcnkuRW9mO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2hhckNvZGVDYXRlZ29yeShjb2RlKSB7XG4gICAgcmV0dXJuIGNvZGUgPCAweDgwID8gQ0FURUdPUllbY29kZV0gOiBjaGFyQ29kZUNhdGVnb3J5Lk5hbWVTdGFydDtcbn1cbnZhciBjaGFyQ29kZURlZmluaXRpb25zID0ge1xuICAgIGlzRGlnaXQ6IGlzRGlnaXQsXG4gICAgaXNIZXhEaWdpdDogaXNIZXhEaWdpdCQxLFxuICAgIGlzVXBwZXJjYXNlTGV0dGVyOiBpc1VwcGVyY2FzZUxldHRlcixcbiAgICBpc0xvd2VyY2FzZUxldHRlcjogaXNMb3dlcmNhc2VMZXR0ZXIsXG4gICAgaXNMZXR0ZXI6IGlzTGV0dGVyLFxuICAgIGlzTm9uQXNjaWk6IGlzTm9uQXNjaWksXG4gICAgaXNOYW1lU3RhcnQ6IGlzTmFtZVN0YXJ0LFxuICAgIGlzTmFtZTogaXNOYW1lLFxuICAgIGlzTm9uUHJpbnRhYmxlOiBpc05vblByaW50YWJsZSxcbiAgICBpc05ld2xpbmU6IGlzTmV3bGluZSxcbiAgICBpc1doaXRlU3BhY2U6IGlzV2hpdGVTcGFjZSxcbiAgICBpc1ZhbGlkRXNjYXBlOiBpc1ZhbGlkRXNjYXBlLFxuICAgIGlzSWRlbnRpZmllclN0YXJ0OiBpc0lkZW50aWZpZXJTdGFydCQxLFxuICAgIGlzTnVtYmVyU3RhcnQ6IGlzTnVtYmVyU3RhcnQsXG5cbiAgICBpc0JPTTogaXNCT00sXG4gICAgY2hhckNvZGVDYXRlZ29yeTogY2hhckNvZGVDYXRlZ29yeVxufTtcblxudmFyIGlzRGlnaXQkMSA9IGNoYXJDb2RlRGVmaW5pdGlvbnMuaXNEaWdpdDtcbnZhciBpc0hleERpZ2l0JDIgPSBjaGFyQ29kZURlZmluaXRpb25zLmlzSGV4RGlnaXQ7XG52YXIgaXNVcHBlcmNhc2VMZXR0ZXIkMSA9IGNoYXJDb2RlRGVmaW5pdGlvbnMuaXNVcHBlcmNhc2VMZXR0ZXI7XG52YXIgaXNOYW1lJDEgPSBjaGFyQ29kZURlZmluaXRpb25zLmlzTmFtZTtcbnZhciBpc1doaXRlU3BhY2UkMSA9IGNoYXJDb2RlRGVmaW5pdGlvbnMuaXNXaGl0ZVNwYWNlO1xudmFyIGlzVmFsaWRFc2NhcGUkMSA9IGNoYXJDb2RlRGVmaW5pdGlvbnMuaXNWYWxpZEVzY2FwZTtcblxuZnVuY3Rpb24gZ2V0Q2hhckNvZGUoc291cmNlLCBvZmZzZXQpIHtcbiAgICByZXR1cm4gb2Zmc2V0IDwgc291cmNlLmxlbmd0aCA/IHNvdXJjZS5jaGFyQ29kZUF0KG9mZnNldCkgOiAwO1xufVxuXG5mdW5jdGlvbiBnZXROZXdsaW5lTGVuZ3RoKHNvdXJjZSwgb2Zmc2V0LCBjb2RlKSB7XG4gICAgaWYgKGNvZGUgPT09IDEzIC8qIFxcciAqLyAmJiBnZXRDaGFyQ29kZShzb3VyY2UsIG9mZnNldCArIDEpID09PSAxMCAvKiBcXG4gKi8pIHtcbiAgICAgICAgcmV0dXJuIDI7XG4gICAgfVxuXG4gICAgcmV0dXJuIDE7XG59XG5cbmZ1bmN0aW9uIGNtcENoYXIodGVzdFN0ciwgb2Zmc2V0LCByZWZlcmVuY2VDb2RlKSB7XG4gICAgdmFyIGNvZGUgPSB0ZXN0U3RyLmNoYXJDb2RlQXQob2Zmc2V0KTtcblxuICAgIC8vIGNvZGUudG9Mb3dlckNhc2UoKSBmb3IgQS4uWlxuICAgIGlmIChpc1VwcGVyY2FzZUxldHRlciQxKGNvZGUpKSB7XG4gICAgICAgIGNvZGUgPSBjb2RlIHwgMzI7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvZGUgPT09IHJlZmVyZW5jZUNvZGU7XG59XG5cbmZ1bmN0aW9uIGNtcFN0cih0ZXN0U3RyLCBzdGFydCwgZW5kLCByZWZlcmVuY2VTdHIpIHtcbiAgICBpZiAoZW5kIC0gc3RhcnQgIT09IHJlZmVyZW5jZVN0ci5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChzdGFydCA8IDAgfHwgZW5kID4gdGVzdFN0ci5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgIHZhciB0ZXN0Q29kZSA9IHRlc3RTdHIuY2hhckNvZGVBdChpKTtcbiAgICAgICAgdmFyIHJlZmVyZW5jZUNvZGUgPSByZWZlcmVuY2VTdHIuY2hhckNvZGVBdChpIC0gc3RhcnQpO1xuXG4gICAgICAgIC8vIHRlc3RDb2RlLnRvTG93ZXJDYXNlKCkgZm9yIEEuLlpcbiAgICAgICAgaWYgKGlzVXBwZXJjYXNlTGV0dGVyJDEodGVzdENvZGUpKSB7XG4gICAgICAgICAgICB0ZXN0Q29kZSA9IHRlc3RDb2RlIHwgMzI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGVzdENvZGUgIT09IHJlZmVyZW5jZUNvZGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBmaW5kV2hpdGVTcGFjZVN0YXJ0KHNvdXJjZSwgb2Zmc2V0KSB7XG4gICAgZm9yICg7IG9mZnNldCA+PSAwOyBvZmZzZXQtLSkge1xuICAgICAgICBpZiAoIWlzV2hpdGVTcGFjZSQxKHNvdXJjZS5jaGFyQ29kZUF0KG9mZnNldCkpKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBvZmZzZXQgKyAxO1xufVxuXG5mdW5jdGlvbiBmaW5kV2hpdGVTcGFjZUVuZChzb3VyY2UsIG9mZnNldCkge1xuICAgIGZvciAoOyBvZmZzZXQgPCBzb3VyY2UubGVuZ3RoOyBvZmZzZXQrKykge1xuICAgICAgICBpZiAoIWlzV2hpdGVTcGFjZSQxKHNvdXJjZS5jaGFyQ29kZUF0KG9mZnNldCkpKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBvZmZzZXQ7XG59XG5cbmZ1bmN0aW9uIGZpbmREZWNpbWFsTnVtYmVyRW5kKHNvdXJjZSwgb2Zmc2V0KSB7XG4gICAgZm9yICg7IG9mZnNldCA8IHNvdXJjZS5sZW5ndGg7IG9mZnNldCsrKSB7XG4gICAgICAgIGlmICghaXNEaWdpdCQxKHNvdXJjZS5jaGFyQ29kZUF0KG9mZnNldCkpKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBvZmZzZXQ7XG59XG5cbi8vIMKnIDQuMy43LiBDb25zdW1lIGFuIGVzY2FwZWQgY29kZSBwb2ludFxuZnVuY3Rpb24gY29uc3VtZUVzY2FwZWQoc291cmNlLCBvZmZzZXQpIHtcbiAgICAvLyBJdCBhc3N1bWVzIHRoYXQgdGhlIFUrMDA1QyBSRVZFUlNFIFNPTElEVVMgKFxcKSBoYXMgYWxyZWFkeSBiZWVuIGNvbnN1bWVkIGFuZFxuICAgIC8vIHRoYXQgdGhlIG5leHQgaW5wdXQgY29kZSBwb2ludCBoYXMgYWxyZWFkeSBiZWVuIHZlcmlmaWVkIHRvIGJlIHBhcnQgb2YgYSB2YWxpZCBlc2NhcGUuXG4gICAgb2Zmc2V0ICs9IDI7XG5cbiAgICAvLyBoZXggZGlnaXRcbiAgICBpZiAoaXNIZXhEaWdpdCQyKGdldENoYXJDb2RlKHNvdXJjZSwgb2Zmc2V0IC0gMSkpKSB7XG4gICAgICAgIC8vIENvbnN1bWUgYXMgbWFueSBoZXggZGlnaXRzIGFzIHBvc3NpYmxlLCBidXQgbm8gbW9yZSB0aGFuIDUuXG4gICAgICAgIC8vIE5vdGUgdGhhdCB0aGlzIG1lYW5zIDEtNiBoZXggZGlnaXRzIGhhdmUgYmVlbiBjb25zdW1lZCBpbiB0b3RhbC5cbiAgICAgICAgZm9yICh2YXIgbWF4T2Zmc2V0ID0gTWF0aC5taW4oc291cmNlLmxlbmd0aCwgb2Zmc2V0ICsgNSk7IG9mZnNldCA8IG1heE9mZnNldDsgb2Zmc2V0KyspIHtcbiAgICAgICAgICAgIGlmICghaXNIZXhEaWdpdCQyKGdldENoYXJDb2RlKHNvdXJjZSwgb2Zmc2V0KSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRoZSBuZXh0IGlucHV0IGNvZGUgcG9pbnQgaXMgd2hpdGVzcGFjZSwgY29uc3VtZSBpdCBhcyB3ZWxsLlxuICAgICAgICB2YXIgY29kZSA9IGdldENoYXJDb2RlKHNvdXJjZSwgb2Zmc2V0KTtcbiAgICAgICAgaWYgKGlzV2hpdGVTcGFjZSQxKGNvZGUpKSB7XG4gICAgICAgICAgICBvZmZzZXQgKz0gZ2V0TmV3bGluZUxlbmd0aChzb3VyY2UsIG9mZnNldCwgY29kZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gb2Zmc2V0O1xufVxuXG4vLyDCpzQuMy4xMS4gQ29uc3VtZSBhIG5hbWVcbi8vIE5vdGU6IFRoaXMgYWxnb3JpdGhtIGRvZXMgbm90IGRvIHRoZSB2ZXJpZmljYXRpb24gb2YgdGhlIGZpcnN0IGZldyBjb2RlIHBvaW50cyB0aGF0IGFyZSBuZWNlc3Nhcnlcbi8vIHRvIGVuc3VyZSB0aGUgcmV0dXJuZWQgY29kZSBwb2ludHMgd291bGQgY29uc3RpdHV0ZSBhbiA8aWRlbnQtdG9rZW4+LiBJZiB0aGF0IGlzIHRoZSBpbnRlbmRlZCB1c2UsXG4vLyBlbnN1cmUgdGhhdCB0aGUgc3RyZWFtIHN0YXJ0cyB3aXRoIGFuIGlkZW50aWZpZXIgYmVmb3JlIGNhbGxpbmcgdGhpcyBhbGdvcml0aG0uXG5mdW5jdGlvbiBjb25zdW1lTmFtZShzb3VyY2UsIG9mZnNldCkge1xuICAgIC8vIExldCByZXN1bHQgaW5pdGlhbGx5IGJlIGFuIGVtcHR5IHN0cmluZy5cbiAgICAvLyBSZXBlYXRlZGx5IGNvbnN1bWUgdGhlIG5leHQgaW5wdXQgY29kZSBwb2ludCBmcm9tIHRoZSBzdHJlYW06XG4gICAgZm9yICg7IG9mZnNldCA8IHNvdXJjZS5sZW5ndGg7IG9mZnNldCsrKSB7XG4gICAgICAgIHZhciBjb2RlID0gc291cmNlLmNoYXJDb2RlQXQob2Zmc2V0KTtcblxuICAgICAgICAvLyBuYW1lIGNvZGUgcG9pbnRcbiAgICAgICAgaWYgKGlzTmFtZSQxKGNvZGUpKSB7XG4gICAgICAgICAgICAvLyBBcHBlbmQgdGhlIGNvZGUgcG9pbnQgdG8gcmVzdWx0LlxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB0aGUgc3RyZWFtIHN0YXJ0cyB3aXRoIGEgdmFsaWQgZXNjYXBlXG4gICAgICAgIGlmIChpc1ZhbGlkRXNjYXBlJDEoY29kZSwgZ2V0Q2hhckNvZGUoc291cmNlLCBvZmZzZXQgKyAxKSkpIHtcbiAgICAgICAgICAgIC8vIENvbnN1bWUgYW4gZXNjYXBlZCBjb2RlIHBvaW50LiBBcHBlbmQgdGhlIHJldHVybmVkIGNvZGUgcG9pbnQgdG8gcmVzdWx0LlxuICAgICAgICAgICAgb2Zmc2V0ID0gY29uc3VtZUVzY2FwZWQoc291cmNlLCBvZmZzZXQpIC0gMTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYW55dGhpbmcgZWxzZVxuICAgICAgICAvLyBSZWNvbnN1bWUgdGhlIGN1cnJlbnQgaW5wdXQgY29kZSBwb2ludC4gUmV0dXJuIHJlc3VsdC5cbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9mZnNldDtcbn1cblxuLy8gwqc0LjMuMTIuIENvbnN1bWUgYSBudW1iZXJcbmZ1bmN0aW9uIGNvbnN1bWVOdW1iZXIoc291cmNlLCBvZmZzZXQpIHtcbiAgICB2YXIgY29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KG9mZnNldCk7XG5cbiAgICAvLyAyLiBJZiB0aGUgbmV4dCBpbnB1dCBjb2RlIHBvaW50IGlzIFUrMDAyQiBQTFVTIFNJR04gKCspIG9yIFUrMDAyRCBIWVBIRU4tTUlOVVMgKC0pLFxuICAgIC8vIGNvbnN1bWUgaXQgYW5kIGFwcGVuZCBpdCB0byByZXByLlxuICAgIGlmIChjb2RlID09PSAweDAwMkIgfHwgY29kZSA9PT0gMHgwMDJEKSB7XG4gICAgICAgIGNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChvZmZzZXQgKz0gMSk7XG4gICAgfVxuXG4gICAgLy8gMy4gV2hpbGUgdGhlIG5leHQgaW5wdXQgY29kZSBwb2ludCBpcyBhIGRpZ2l0LCBjb25zdW1lIGl0IGFuZCBhcHBlbmQgaXQgdG8gcmVwci5cbiAgICBpZiAoaXNEaWdpdCQxKGNvZGUpKSB7XG4gICAgICAgIG9mZnNldCA9IGZpbmREZWNpbWFsTnVtYmVyRW5kKHNvdXJjZSwgb2Zmc2V0ICsgMSk7XG4gICAgICAgIGNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChvZmZzZXQpO1xuICAgIH1cblxuICAgIC8vIDQuIElmIHRoZSBuZXh0IDIgaW5wdXQgY29kZSBwb2ludHMgYXJlIFUrMDAyRSBGVUxMIFNUT1AgKC4pIGZvbGxvd2VkIGJ5IGEgZGlnaXQsIHRoZW46XG4gICAgaWYgKGNvZGUgPT09IDB4MDAyRSAmJiBpc0RpZ2l0JDEoc291cmNlLmNoYXJDb2RlQXQob2Zmc2V0ICsgMSkpKSB7XG4gICAgICAgIC8vIDQuMSBDb25zdW1lIHRoZW0uXG4gICAgICAgIC8vIDQuMiBBcHBlbmQgdGhlbSB0byByZXByLlxuICAgICAgICBjb2RlID0gc291cmNlLmNoYXJDb2RlQXQob2Zmc2V0ICs9IDIpO1xuXG4gICAgICAgIC8vIDQuMyBTZXQgdHlwZSB0byBcIm51bWJlclwiLlxuICAgICAgICAvLyBUT0RPXG5cbiAgICAgICAgLy8gNC40IFdoaWxlIHRoZSBuZXh0IGlucHV0IGNvZGUgcG9pbnQgaXMgYSBkaWdpdCwgY29uc3VtZSBpdCBhbmQgYXBwZW5kIGl0IHRvIHJlcHIuXG5cbiAgICAgICAgb2Zmc2V0ID0gZmluZERlY2ltYWxOdW1iZXJFbmQoc291cmNlLCBvZmZzZXQpO1xuICAgIH1cblxuICAgIC8vIDUuIElmIHRoZSBuZXh0IDIgb3IgMyBpbnB1dCBjb2RlIHBvaW50cyBhcmUgVSswMDQ1IExBVElOIENBUElUQUwgTEVUVEVSIEUgKEUpXG4gICAgLy8gb3IgVSswMDY1IExBVElOIFNNQUxMIExFVFRFUiBFIChlKSwgLi4uICwgZm9sbG93ZWQgYnkgYSBkaWdpdCwgdGhlbjpcbiAgICBpZiAoY21wQ2hhcihzb3VyY2UsIG9mZnNldCwgMTAxIC8qIGUgKi8pKSB7XG4gICAgICAgIHZhciBzaWduID0gMDtcbiAgICAgICAgY29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KG9mZnNldCArIDEpO1xuXG4gICAgICAgIC8vIC4uLiBvcHRpb25hbGx5IGZvbGxvd2VkIGJ5IFUrMDAyRCBIWVBIRU4tTUlOVVMgKC0pIG9yIFUrMDAyQiBQTFVTIFNJR04gKCspIC4uLlxuICAgICAgICBpZiAoY29kZSA9PT0gMHgwMDJEIHx8IGNvZGUgPT09IDB4MDAyQikge1xuICAgICAgICAgICAgc2lnbiA9IDE7XG4gICAgICAgICAgICBjb2RlID0gc291cmNlLmNoYXJDb2RlQXQob2Zmc2V0ICsgMik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyAuLi4gZm9sbG93ZWQgYnkgYSBkaWdpdFxuICAgICAgICBpZiAoaXNEaWdpdCQxKGNvZGUpKSB7XG4gICAgICAgICAgICAvLyA1LjEgQ29uc3VtZSB0aGVtLlxuICAgICAgICAgICAgLy8gNS4yIEFwcGVuZCB0aGVtIHRvIHJlcHIuXG5cbiAgICAgICAgICAgIC8vIDUuMyBTZXQgdHlwZSB0byBcIm51bWJlclwiLlxuICAgICAgICAgICAgLy8gVE9ET1xuXG4gICAgICAgICAgICAvLyA1LjQgV2hpbGUgdGhlIG5leHQgaW5wdXQgY29kZSBwb2ludCBpcyBhIGRpZ2l0LCBjb25zdW1lIGl0IGFuZCBhcHBlbmQgaXQgdG8gcmVwci5cbiAgICAgICAgICAgIG9mZnNldCA9IGZpbmREZWNpbWFsTnVtYmVyRW5kKHNvdXJjZSwgb2Zmc2V0ICsgMSArIHNpZ24gKyAxKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBvZmZzZXQ7XG59XG5cbi8vIMKnIDQuMy4xNC4gQ29uc3VtZSB0aGUgcmVtbmFudHMgb2YgYSBiYWQgdXJsXG4vLyAuLi4gaXRzIHNvbGUgdXNlIGlzIHRvIGNvbnN1bWUgZW5vdWdoIG9mIHRoZSBpbnB1dCBzdHJlYW0gdG8gcmVhY2ggYSByZWNvdmVyeSBwb2ludFxuLy8gd2hlcmUgbm9ybWFsIHRva2VuaXppbmcgY2FuIHJlc3VtZS5cbmZ1bmN0aW9uIGNvbnN1bWVCYWRVcmxSZW1uYW50cyhzb3VyY2UsIG9mZnNldCkge1xuICAgIC8vIFJlcGVhdGVkbHkgY29uc3VtZSB0aGUgbmV4dCBpbnB1dCBjb2RlIHBvaW50IGZyb20gdGhlIHN0cmVhbTpcbiAgICBmb3IgKDsgb2Zmc2V0IDwgc291cmNlLmxlbmd0aDsgb2Zmc2V0KyspIHtcbiAgICAgICAgdmFyIGNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChvZmZzZXQpO1xuXG4gICAgICAgIC8vIFUrMDAyOSBSSUdIVCBQQVJFTlRIRVNJUyAoKSlcbiAgICAgICAgLy8gRU9GXG4gICAgICAgIGlmIChjb2RlID09PSAweDAwMjkpIHtcbiAgICAgICAgICAgIC8vIFJldHVybi5cbiAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNWYWxpZEVzY2FwZSQxKGNvZGUsIGdldENoYXJDb2RlKHNvdXJjZSwgb2Zmc2V0ICsgMSkpKSB7XG4gICAgICAgICAgICAvLyBDb25zdW1lIGFuIGVzY2FwZWQgY29kZSBwb2ludC5cbiAgICAgICAgICAgIC8vIE5vdGU6IFRoaXMgYWxsb3dzIGFuIGVzY2FwZWQgcmlnaHQgcGFyZW50aGVzaXMgKFwiXFwpXCIpIHRvIGJlIGVuY291bnRlcmVkXG4gICAgICAgICAgICAvLyB3aXRob3V0IGVuZGluZyB0aGUgPGJhZC11cmwtdG9rZW4+LiBUaGlzIGlzIG90aGVyd2lzZSBpZGVudGljYWwgdG9cbiAgICAgICAgICAgIC8vIHRoZSBcImFueXRoaW5nIGVsc2VcIiBjbGF1c2UuXG4gICAgICAgICAgICBvZmZzZXQgPSBjb25zdW1lRXNjYXBlZChzb3VyY2UsIG9mZnNldCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gb2Zmc2V0O1xufVxuXG52YXIgdXRpbHMgPSB7XG4gICAgY29uc3VtZUVzY2FwZWQ6IGNvbnN1bWVFc2NhcGVkLFxuICAgIGNvbnN1bWVOYW1lOiBjb25zdW1lTmFtZSxcbiAgICBjb25zdW1lTnVtYmVyOiBjb25zdW1lTnVtYmVyLFxuICAgIGNvbnN1bWVCYWRVcmxSZW1uYW50czogY29uc3VtZUJhZFVybFJlbW5hbnRzLFxuXG4gICAgY21wQ2hhcjogY21wQ2hhcixcbiAgICBjbXBTdHI6IGNtcFN0cixcblxuICAgIGdldE5ld2xpbmVMZW5ndGg6IGdldE5ld2xpbmVMZW5ndGgsXG4gICAgZmluZFdoaXRlU3BhY2VTdGFydDogZmluZFdoaXRlU3BhY2VTdGFydCxcbiAgICBmaW5kV2hpdGVTcGFjZUVuZDogZmluZFdoaXRlU3BhY2VFbmRcbn07XG5cbnZhciBUWVBFJDEgPSBfY29uc3QuVFlQRTtcbnZhciBOQU1FJDEgPSBfY29uc3QuTkFNRTtcblxuXG52YXIgY21wU3RyJDEgPSB1dGlscy5jbXBTdHI7XG5cbnZhciBFT0YkMSA9IFRZUEUkMS5FT0Y7XG52YXIgV0hJVEVTUEFDRSA9IFRZUEUkMS5XaGl0ZVNwYWNlO1xudmFyIENPTU1FTlQgPSBUWVBFJDEuQ29tbWVudDtcblxudmFyIE9GRlNFVF9NQVNLID0gMHgwMEZGRkZGRjtcbnZhciBUWVBFX1NISUZUID0gMjQ7XG5cbnZhciBUb2tlblN0cmVhbSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMub2Zmc2V0QW5kVHlwZSA9IG51bGw7XG4gICAgdGhpcy5iYWxhbmNlID0gbnVsbDtcblxuICAgIHRoaXMucmVzZXQoKTtcbn07XG5cblRva2VuU3RyZWFtLnByb3RvdHlwZSA9IHtcbiAgICByZXNldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZW9mID0gZmFsc2U7XG4gICAgICAgIHRoaXMudG9rZW5JbmRleCA9IC0xO1xuICAgICAgICB0aGlzLnRva2VuVHlwZSA9IDA7XG4gICAgICAgIHRoaXMudG9rZW5TdGFydCA9IHRoaXMuZmlyc3RDaGFyT2Zmc2V0O1xuICAgICAgICB0aGlzLnRva2VuRW5kID0gdGhpcy5maXJzdENoYXJPZmZzZXQ7XG4gICAgfSxcblxuICAgIGxvb2t1cFR5cGU6IGZ1bmN0aW9uKG9mZnNldCkge1xuICAgICAgICBvZmZzZXQgKz0gdGhpcy50b2tlbkluZGV4O1xuXG4gICAgICAgIGlmIChvZmZzZXQgPCB0aGlzLnRva2VuQ291bnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9mZnNldEFuZFR5cGVbb2Zmc2V0XSA+PiBUWVBFX1NISUZUO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIEVPRiQxO1xuICAgIH0sXG4gICAgbG9va3VwT2Zmc2V0OiBmdW5jdGlvbihvZmZzZXQpIHtcbiAgICAgICAgb2Zmc2V0ICs9IHRoaXMudG9rZW5JbmRleDtcblxuICAgICAgICBpZiAob2Zmc2V0IDwgdGhpcy50b2tlbkNvdW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vZmZzZXRBbmRUeXBlW29mZnNldCAtIDFdICYgT0ZGU0VUX01BU0s7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5zb3VyY2UubGVuZ3RoO1xuICAgIH0sXG4gICAgbG9va3VwVmFsdWU6IGZ1bmN0aW9uKG9mZnNldCwgcmVmZXJlbmNlU3RyKSB7XG4gICAgICAgIG9mZnNldCArPSB0aGlzLnRva2VuSW5kZXg7XG5cbiAgICAgICAgaWYgKG9mZnNldCA8IHRoaXMudG9rZW5Db3VudCkge1xuICAgICAgICAgICAgcmV0dXJuIGNtcFN0ciQxKFxuICAgICAgICAgICAgICAgIHRoaXMuc291cmNlLFxuICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0QW5kVHlwZVtvZmZzZXQgLSAxXSAmIE9GRlNFVF9NQVNLLFxuICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0QW5kVHlwZVtvZmZzZXRdICYgT0ZGU0VUX01BU0ssXG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlU3RyXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sXG4gICAgZ2V0VG9rZW5TdGFydDogZnVuY3Rpb24odG9rZW5JbmRleCkge1xuICAgICAgICBpZiAodG9rZW5JbmRleCA9PT0gdGhpcy50b2tlbkluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b2tlblN0YXJ0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRva2VuSW5kZXggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdG9rZW5JbmRleCA8IHRoaXMudG9rZW5Db3VudFxuICAgICAgICAgICAgICAgID8gdGhpcy5vZmZzZXRBbmRUeXBlW3Rva2VuSW5kZXggLSAxXSAmIE9GRlNFVF9NQVNLXG4gICAgICAgICAgICAgICAgOiB0aGlzLm9mZnNldEFuZFR5cGVbdGhpcy50b2tlbkNvdW50XSAmIE9GRlNFVF9NQVNLO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZmlyc3RDaGFyT2Zmc2V0O1xuICAgIH0sXG5cbiAgICAvLyBUT0RPOiAtPiBza2lwVW50aWxCYWxhbmNlZFxuICAgIGdldFJhd0xlbmd0aDogZnVuY3Rpb24oc3RhcnRUb2tlbiwgbW9kZSkge1xuICAgICAgICB2YXIgY3Vyc29yID0gc3RhcnRUb2tlbjtcbiAgICAgICAgdmFyIGJhbGFuY2VFbmQ7XG4gICAgICAgIHZhciBvZmZzZXQgPSB0aGlzLm9mZnNldEFuZFR5cGVbTWF0aC5tYXgoY3Vyc29yIC0gMSwgMCldICYgT0ZGU0VUX01BU0s7XG4gICAgICAgIHZhciB0eXBlO1xuXG4gICAgICAgIGxvb3A6XG4gICAgICAgIGZvciAoOyBjdXJzb3IgPCB0aGlzLnRva2VuQ291bnQ7IGN1cnNvcisrKSB7XG4gICAgICAgICAgICBiYWxhbmNlRW5kID0gdGhpcy5iYWxhbmNlW2N1cnNvcl07XG5cbiAgICAgICAgICAgIC8vIHN0b3Agc2Nhbm5pbmcgb24gYmFsYW5jZSBlZGdlIHRoYXQgcG9pbnRzIHRvIG9mZnNldCBiZWZvcmUgc3RhcnQgdG9rZW5cbiAgICAgICAgICAgIGlmIChiYWxhbmNlRW5kIDwgc3RhcnRUb2tlbikge1xuICAgICAgICAgICAgICAgIGJyZWFrIGxvb3A7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHR5cGUgPSB0aGlzLm9mZnNldEFuZFR5cGVbY3Vyc29yXSA+PiBUWVBFX1NISUZUO1xuXG4gICAgICAgICAgICAvLyBjaGVjayB0b2tlbiBpcyBzdG9wIHR5cGVcbiAgICAgICAgICAgIHN3aXRjaCAobW9kZSh0eXBlLCB0aGlzLnNvdXJjZSwgb2Zmc2V0KSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWsgbG9vcDtcblxuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yKys7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrIGxvb3A7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSB0aGlzLm9mZnNldEFuZFR5cGVbY3Vyc29yXSAmIE9GRlNFVF9NQVNLO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGZhc3QgZm9yd2FyZCB0byB0aGUgZW5kIG9mIGJhbGFuY2VkIGJsb2NrXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmJhbGFuY2VbYmFsYW5jZUVuZF0gPT09IGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yID0gYmFsYW5jZUVuZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGN1cnNvciAtIHRoaXMudG9rZW5JbmRleDtcbiAgICB9LFxuICAgIGlzQmFsYW5jZUVkZ2U6IGZ1bmN0aW9uKHBvcykge1xuICAgICAgICByZXR1cm4gdGhpcy5iYWxhbmNlW3RoaXMudG9rZW5JbmRleF0gPCBwb3M7XG4gICAgfSxcbiAgICBpc0RlbGltOiBmdW5jdGlvbihjb2RlLCBvZmZzZXQpIHtcbiAgICAgICAgaWYgKG9mZnNldCkge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICB0aGlzLmxvb2t1cFR5cGUob2Zmc2V0KSA9PT0gVFlQRSQxLkRlbGltICYmXG4gICAgICAgICAgICAgICAgdGhpcy5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLmxvb2t1cE9mZnNldChvZmZzZXQpKSA9PT0gY29kZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICB0aGlzLnRva2VuVHlwZSA9PT0gVFlQRSQxLkRlbGltICYmXG4gICAgICAgICAgICB0aGlzLnNvdXJjZS5jaGFyQ29kZUF0KHRoaXMudG9rZW5TdGFydCkgPT09IGNvZGVcbiAgICAgICAgKTtcbiAgICB9LFxuXG4gICAgZ2V0VG9rZW5WYWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzdHJpbmcodGhpcy50b2tlblN0YXJ0LCB0aGlzLnRva2VuRW5kKTtcbiAgICB9LFxuICAgIGdldFRva2VuTGVuZ3RoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5FbmQgLSB0aGlzLnRva2VuU3RhcnQ7XG4gICAgfSxcbiAgICBzdWJzdHJUb0N1cnNvcjogZnVuY3Rpb24oc3RhcnQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnN0cmluZyhzdGFydCwgdGhpcy50b2tlblN0YXJ0KTtcbiAgICB9LFxuXG4gICAgc2tpcFdTOiBmdW5jdGlvbigpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMudG9rZW5JbmRleCwgc2tpcFRva2VuQ291bnQgPSAwOyBpIDwgdGhpcy50b2tlbkNvdW50OyBpKyssIHNraXBUb2tlbkNvdW50KyspIHtcbiAgICAgICAgICAgIGlmICgodGhpcy5vZmZzZXRBbmRUeXBlW2ldID4+IFRZUEVfU0hJRlQpICE9PSBXSElURVNQQUNFKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2tpcFRva2VuQ291bnQgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnNraXAoc2tpcFRva2VuQ291bnQpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBza2lwU0M6IGZ1bmN0aW9uKCkge1xuICAgICAgICB3aGlsZSAodGhpcy50b2tlblR5cGUgPT09IFdISVRFU1BBQ0UgfHwgdGhpcy50b2tlblR5cGUgPT09IENPTU1FTlQpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dCgpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBza2lwOiBmdW5jdGlvbih0b2tlbkNvdW50KSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGhpcy50b2tlbkluZGV4ICsgdG9rZW5Db3VudDtcblxuICAgICAgICBpZiAobmV4dCA8IHRoaXMudG9rZW5Db3VudCkge1xuICAgICAgICAgICAgdGhpcy50b2tlbkluZGV4ID0gbmV4dDtcbiAgICAgICAgICAgIHRoaXMudG9rZW5TdGFydCA9IHRoaXMub2Zmc2V0QW5kVHlwZVtuZXh0IC0gMV0gJiBPRkZTRVRfTUFTSztcbiAgICAgICAgICAgIG5leHQgPSB0aGlzLm9mZnNldEFuZFR5cGVbbmV4dF07XG4gICAgICAgICAgICB0aGlzLnRva2VuVHlwZSA9IG5leHQgPj4gVFlQRV9TSElGVDtcbiAgICAgICAgICAgIHRoaXMudG9rZW5FbmQgPSBuZXh0ICYgT0ZGU0VUX01BU0s7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRva2VuSW5kZXggPSB0aGlzLnRva2VuQ291bnQ7XG4gICAgICAgICAgICB0aGlzLm5leHQoKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgbmV4dDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGhpcy50b2tlbkluZGV4ICsgMTtcblxuICAgICAgICBpZiAobmV4dCA8IHRoaXMudG9rZW5Db3VudCkge1xuICAgICAgICAgICAgdGhpcy50b2tlbkluZGV4ID0gbmV4dDtcbiAgICAgICAgICAgIHRoaXMudG9rZW5TdGFydCA9IHRoaXMudG9rZW5FbmQ7XG4gICAgICAgICAgICBuZXh0ID0gdGhpcy5vZmZzZXRBbmRUeXBlW25leHRdO1xuICAgICAgICAgICAgdGhpcy50b2tlblR5cGUgPSBuZXh0ID4+IFRZUEVfU0hJRlQ7XG4gICAgICAgICAgICB0aGlzLnRva2VuRW5kID0gbmV4dCAmIE9GRlNFVF9NQVNLO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50b2tlbkluZGV4ID0gdGhpcy50b2tlbkNvdW50O1xuICAgICAgICAgICAgdGhpcy5lb2YgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy50b2tlblR5cGUgPSBFT0YkMTtcbiAgICAgICAgICAgIHRoaXMudG9rZW5TdGFydCA9IHRoaXMudG9rZW5FbmQgPSB0aGlzLnNvdXJjZS5sZW5ndGg7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZm9yRWFjaFRva2VuKGZuKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBvZmZzZXQgPSB0aGlzLmZpcnN0Q2hhck9mZnNldDsgaSA8IHRoaXMudG9rZW5Db3VudDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBvZmZzZXQ7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMub2Zmc2V0QW5kVHlwZVtpXTtcbiAgICAgICAgICAgIHZhciBlbmQgPSBpdGVtICYgT0ZGU0VUX01BU0s7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IGl0ZW0gPj4gVFlQRV9TSElGVDtcblxuICAgICAgICAgICAgb2Zmc2V0ID0gZW5kO1xuXG4gICAgICAgICAgICBmbih0eXBlLCBzdGFydCwgZW5kLCBpKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBkdW1wKCkge1xuICAgICAgICB2YXIgdG9rZW5zID0gbmV3IEFycmF5KHRoaXMudG9rZW5Db3VudCk7XG5cbiAgICAgICAgdGhpcy5mb3JFYWNoVG9rZW4oKHR5cGUsIHN0YXJ0LCBlbmQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICB0b2tlbnNbaW5kZXhdID0ge1xuICAgICAgICAgICAgICAgIGlkeDogaW5kZXgsXG4gICAgICAgICAgICAgICAgdHlwZTogTkFNRSQxW3R5cGVdLFxuICAgICAgICAgICAgICAgIGNodW5rOiB0aGlzLnNvdXJjZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCksXG4gICAgICAgICAgICAgICAgYmFsYW5jZTogdGhpcy5iYWxhbmNlW2luZGV4XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRva2VucztcbiAgICB9XG59O1xuXG52YXIgVG9rZW5TdHJlYW1fMSA9IFRva2VuU3RyZWFtO1xuXG52YXIgVFlQRSQyID0gX2NvbnN0LlRZUEU7XG5cblxudmFyIGlzTmV3bGluZSQxID0gY2hhckNvZGVEZWZpbml0aW9ucy5pc05ld2xpbmU7XG52YXIgaXNOYW1lJDIgPSBjaGFyQ29kZURlZmluaXRpb25zLmlzTmFtZTtcbnZhciBpc1ZhbGlkRXNjYXBlJDIgPSBjaGFyQ29kZURlZmluaXRpb25zLmlzVmFsaWRFc2NhcGU7XG52YXIgaXNOdW1iZXJTdGFydCQxID0gY2hhckNvZGVEZWZpbml0aW9ucy5pc051bWJlclN0YXJ0O1xudmFyIGlzSWRlbnRpZmllclN0YXJ0JDIgPSBjaGFyQ29kZURlZmluaXRpb25zLmlzSWRlbnRpZmllclN0YXJ0O1xudmFyIGNoYXJDb2RlQ2F0ZWdvcnkkMSA9IGNoYXJDb2RlRGVmaW5pdGlvbnMuY2hhckNvZGVDYXRlZ29yeTtcbnZhciBpc0JPTSQxID0gY2hhckNvZGVEZWZpbml0aW9ucy5pc0JPTTtcblxuXG52YXIgY21wU3RyJDIgPSB1dGlscy5jbXBTdHI7XG52YXIgZ2V0TmV3bGluZUxlbmd0aCQxID0gdXRpbHMuZ2V0TmV3bGluZUxlbmd0aDtcbnZhciBmaW5kV2hpdGVTcGFjZUVuZCQxID0gdXRpbHMuZmluZFdoaXRlU3BhY2VFbmQ7XG52YXIgY29uc3VtZUVzY2FwZWQkMSA9IHV0aWxzLmNvbnN1bWVFc2NhcGVkO1xudmFyIGNvbnN1bWVOYW1lJDEgPSB1dGlscy5jb25zdW1lTmFtZTtcbnZhciBjb25zdW1lTnVtYmVyJDEgPSB1dGlscy5jb25zdW1lTnVtYmVyO1xudmFyIGNvbnN1bWVCYWRVcmxSZW1uYW50cyQxID0gdXRpbHMuY29uc3VtZUJhZFVybFJlbW5hbnRzO1xuXG52YXIgT0ZGU0VUX01BU0skMSA9IDB4MDBGRkZGRkY7XG52YXIgVFlQRV9TSElGVCQxID0gMjQ7XG5cbmZ1bmN0aW9uIHRva2VuaXplKHNvdXJjZSwgc3RyZWFtKSB7XG4gICAgZnVuY3Rpb24gZ2V0Q2hhckNvZGUob2Zmc2V0KSB7XG4gICAgICAgIHJldHVybiBvZmZzZXQgPCBzb3VyY2VMZW5ndGggPyBzb3VyY2UuY2hhckNvZGVBdChvZmZzZXQpIDogMDtcbiAgICB9XG5cbiAgICAvLyDCpyA0LjMuMy4gQ29uc3VtZSBhIG51bWVyaWMgdG9rZW5cbiAgICBmdW5jdGlvbiBjb25zdW1lTnVtZXJpY1Rva2VuKCkge1xuICAgICAgICAvLyBDb25zdW1lIGEgbnVtYmVyIGFuZCBsZXQgbnVtYmVyIGJlIHRoZSByZXN1bHQuXG4gICAgICAgIG9mZnNldCA9IGNvbnN1bWVOdW1iZXIkMShzb3VyY2UsIG9mZnNldCk7XG5cbiAgICAgICAgLy8gSWYgdGhlIG5leHQgMyBpbnB1dCBjb2RlIHBvaW50cyB3b3VsZCBzdGFydCBhbiBpZGVudGlmaWVyLCB0aGVuOlxuICAgICAgICBpZiAoaXNJZGVudGlmaWVyU3RhcnQkMihnZXRDaGFyQ29kZShvZmZzZXQpLCBnZXRDaGFyQ29kZShvZmZzZXQgKyAxKSwgZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMikpKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgYSA8ZGltZW5zaW9uLXRva2VuPiB3aXRoIHRoZSBzYW1lIHZhbHVlIGFuZCB0eXBlIGZsYWcgYXMgbnVtYmVyLCBhbmQgYSB1bml0IHNldCBpbml0aWFsbHkgdG8gdGhlIGVtcHR5IHN0cmluZy5cbiAgICAgICAgICAgIC8vIENvbnN1bWUgYSBuYW1lLiBTZXQgdGhlIDxkaW1lbnNpb24tdG9rZW4+4oCZcyB1bml0IHRvIHRoZSByZXR1cm5lZCB2YWx1ZS5cbiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgPGRpbWVuc2lvbi10b2tlbj4uXG4gICAgICAgICAgICB0eXBlID0gVFlQRSQyLkRpbWVuc2lvbjtcbiAgICAgICAgICAgIG9mZnNldCA9IGNvbnN1bWVOYW1lJDEoc291cmNlLCBvZmZzZXQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBpZiB0aGUgbmV4dCBpbnB1dCBjb2RlIHBvaW50IGlzIFUrMDAyNSBQRVJDRU5UQUdFIFNJR04gKCUpLCBjb25zdW1lIGl0LlxuICAgICAgICBpZiAoZ2V0Q2hhckNvZGUob2Zmc2V0KSA9PT0gMHgwMDI1KSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgYSA8cGVyY2VudGFnZS10b2tlbj4gd2l0aCB0aGUgc2FtZSB2YWx1ZSBhcyBudW1iZXIsIGFuZCByZXR1cm4gaXQuXG4gICAgICAgICAgICB0eXBlID0gVFlQRSQyLlBlcmNlbnRhZ2U7XG4gICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE90aGVyd2lzZSwgY3JlYXRlIGEgPG51bWJlci10b2tlbj4gd2l0aCB0aGUgc2FtZSB2YWx1ZSBhbmQgdHlwZSBmbGFnIGFzIG51bWJlciwgYW5kIHJldHVybiBpdC5cbiAgICAgICAgdHlwZSA9IFRZUEUkMi5OdW1iZXI7XG4gICAgfVxuXG4gICAgLy8gwqcgNC4zLjQuIENvbnN1bWUgYW4gaWRlbnQtbGlrZSB0b2tlblxuICAgIGZ1bmN0aW9uIGNvbnN1bWVJZGVudExpa2VUb2tlbigpIHtcbiAgICAgICAgY29uc3QgbmFtZVN0YXJ0T2Zmc2V0ID0gb2Zmc2V0O1xuXG4gICAgICAgIC8vIENvbnN1bWUgYSBuYW1lLCBhbmQgbGV0IHN0cmluZyBiZSB0aGUgcmVzdWx0LlxuICAgICAgICBvZmZzZXQgPSBjb25zdW1lTmFtZSQxKHNvdXJjZSwgb2Zmc2V0KTtcblxuICAgICAgICAvLyBJZiBzdHJpbmfigJlzIHZhbHVlIGlzIGFuIEFTQ0lJIGNhc2UtaW5zZW5zaXRpdmUgbWF0Y2ggZm9yIFwidXJsXCIsXG4gICAgICAgIC8vIGFuZCB0aGUgbmV4dCBpbnB1dCBjb2RlIHBvaW50IGlzIFUrMDAyOCBMRUZUIFBBUkVOVEhFU0lTICgoKSwgY29uc3VtZSBpdC5cbiAgICAgICAgaWYgKGNtcFN0ciQyKHNvdXJjZSwgbmFtZVN0YXJ0T2Zmc2V0LCBvZmZzZXQsICd1cmwnKSAmJiBnZXRDaGFyQ29kZShvZmZzZXQpID09PSAweDAwMjgpIHtcbiAgICAgICAgICAgIC8vIFdoaWxlIHRoZSBuZXh0IHR3byBpbnB1dCBjb2RlIHBvaW50cyBhcmUgd2hpdGVzcGFjZSwgY29uc3VtZSB0aGUgbmV4dCBpbnB1dCBjb2RlIHBvaW50LlxuICAgICAgICAgICAgb2Zmc2V0ID0gZmluZFdoaXRlU3BhY2VFbmQkMShzb3VyY2UsIG9mZnNldCArIDEpO1xuXG4gICAgICAgICAgICAvLyBJZiB0aGUgbmV4dCBvbmUgb3IgdHdvIGlucHV0IGNvZGUgcG9pbnRzIGFyZSBVKzAwMjIgUVVPVEFUSU9OIE1BUksgKFwiKSwgVSswMDI3IEFQT1NUUk9QSEUgKCcpLFxuICAgICAgICAgICAgLy8gb3Igd2hpdGVzcGFjZSBmb2xsb3dlZCBieSBVKzAwMjIgUVVPVEFUSU9OIE1BUksgKFwiKSBvciBVKzAwMjcgQVBPU1RST1BIRSAoJyksXG4gICAgICAgICAgICAvLyB0aGVuIGNyZWF0ZSBhIDxmdW5jdGlvbi10b2tlbj4gd2l0aCBpdHMgdmFsdWUgc2V0IHRvIHN0cmluZyBhbmQgcmV0dXJuIGl0LlxuICAgICAgICAgICAgaWYgKGdldENoYXJDb2RlKG9mZnNldCkgPT09IDB4MDAyMiB8fFxuICAgICAgICAgICAgICAgIGdldENoYXJDb2RlKG9mZnNldCkgPT09IDB4MDAyNykge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuRnVuY3Rpb247XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gbmFtZVN0YXJ0T2Zmc2V0ICsgNDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgY29uc3VtZSBhIHVybCB0b2tlbiwgYW5kIHJldHVybiBpdC5cbiAgICAgICAgICAgIGNvbnN1bWVVcmxUb2tlbigpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBpZiB0aGUgbmV4dCBpbnB1dCBjb2RlIHBvaW50IGlzIFUrMDAyOCBMRUZUIFBBUkVOVEhFU0lTICgoKSwgY29uc3VtZSBpdC5cbiAgICAgICAgLy8gQ3JlYXRlIGEgPGZ1bmN0aW9uLXRva2VuPiB3aXRoIGl0cyB2YWx1ZSBzZXQgdG8gc3RyaW5nIGFuZCByZXR1cm4gaXQuXG4gICAgICAgIGlmIChnZXRDaGFyQ29kZShvZmZzZXQpID09PSAweDAwMjgpIHtcbiAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuRnVuY3Rpb247XG4gICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE90aGVyd2lzZSwgY3JlYXRlIGFuIDxpZGVudC10b2tlbj4gd2l0aCBpdHMgdmFsdWUgc2V0IHRvIHN0cmluZyBhbmQgcmV0dXJuIGl0LlxuICAgICAgICB0eXBlID0gVFlQRSQyLklkZW50O1xuICAgIH1cblxuICAgIC8vIMKnIDQuMy41LiBDb25zdW1lIGEgc3RyaW5nIHRva2VuXG4gICAgZnVuY3Rpb24gY29uc3VtZVN0cmluZ1Rva2VuKGVuZGluZ0NvZGVQb2ludCkge1xuICAgICAgICAvLyBUaGlzIGFsZ29yaXRobSBtYXkgYmUgY2FsbGVkIHdpdGggYW4gZW5kaW5nIGNvZGUgcG9pbnQsIHdoaWNoIGRlbm90ZXMgdGhlIGNvZGUgcG9pbnRcbiAgICAgICAgLy8gdGhhdCBlbmRzIHRoZSBzdHJpbmcuIElmIGFuIGVuZGluZyBjb2RlIHBvaW50IGlzIG5vdCBzcGVjaWZpZWQsXG4gICAgICAgIC8vIHRoZSBjdXJyZW50IGlucHV0IGNvZGUgcG9pbnQgaXMgdXNlZC5cbiAgICAgICAgaWYgKCFlbmRpbmdDb2RlUG9pbnQpIHtcbiAgICAgICAgICAgIGVuZGluZ0NvZGVQb2ludCA9IGdldENoYXJDb2RlKG9mZnNldCsrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluaXRpYWxseSBjcmVhdGUgYSA8c3RyaW5nLXRva2VuPiB3aXRoIGl0cyB2YWx1ZSBzZXQgdG8gdGhlIGVtcHR5IHN0cmluZy5cbiAgICAgICAgdHlwZSA9IFRZUEUkMi5TdHJpbmc7XG5cbiAgICAgICAgLy8gUmVwZWF0ZWRseSBjb25zdW1lIHRoZSBuZXh0IGlucHV0IGNvZGUgcG9pbnQgZnJvbSB0aGUgc3RyZWFtOlxuICAgICAgICBmb3IgKDsgb2Zmc2V0IDwgc291cmNlLmxlbmd0aDsgb2Zmc2V0KyspIHtcbiAgICAgICAgICAgIHZhciBjb2RlID0gc291cmNlLmNoYXJDb2RlQXQob2Zmc2V0KTtcblxuICAgICAgICAgICAgc3dpdGNoIChjaGFyQ29kZUNhdGVnb3J5JDEoY29kZSkpIHtcbiAgICAgICAgICAgICAgICAvLyBlbmRpbmcgY29kZSBwb2ludFxuICAgICAgICAgICAgICAgIGNhc2UgZW5kaW5nQ29kZVBvaW50OlxuICAgICAgICAgICAgICAgICAgICAvLyBSZXR1cm4gdGhlIDxzdHJpbmctdG9rZW4+LlxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgLy8gRU9GXG4gICAgICAgICAgICAgICAgY2FzZSBjaGFyQ29kZUNhdGVnb3J5JDEuRW9mOlxuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgcGFyc2UgZXJyb3IuIFJldHVybiB0aGUgPHN0cmluZy10b2tlbj4uXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgICAgIC8vIG5ld2xpbmVcbiAgICAgICAgICAgICAgICBjYXNlIGNoYXJDb2RlQ2F0ZWdvcnkkMS5XaGl0ZVNwYWNlOlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNOZXdsaW5lJDEoY29kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBwYXJzZSBlcnJvci4gUmVjb25zdW1lIHRoZSBjdXJyZW50IGlucHV0IGNvZGUgcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgYSA8YmFkLXN0cmluZy10b2tlbj4sIGFuZCByZXR1cm4gaXQuXG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gZ2V0TmV3bGluZUxlbmd0aCQxKHNvdXJjZSwgb2Zmc2V0LCBjb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuQmFkU3RyaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgLy8gVSswMDVDIFJFVkVSU0UgU09MSURVUyAoXFwpXG4gICAgICAgICAgICAgICAgY2FzZSAweDAwNUM6XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBuZXh0IGlucHV0IGNvZGUgcG9pbnQgaXMgRU9GLCBkbyBub3RoaW5nLlxuICAgICAgICAgICAgICAgICAgICBpZiAob2Zmc2V0ID09PSBzb3VyY2UubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dENvZGUgPSBnZXRDaGFyQ29kZShvZmZzZXQgKyAxKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UsIGlmIHRoZSBuZXh0IGlucHV0IGNvZGUgcG9pbnQgaXMgYSBuZXdsaW5lLCBjb25zdW1lIGl0LlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNOZXdsaW5lJDEobmV4dENvZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gZ2V0TmV3bGluZUxlbmd0aCQxKHNvdXJjZSwgb2Zmc2V0ICsgMSwgbmV4dENvZGUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzVmFsaWRFc2NhcGUkMihjb2RlLCBuZXh0Q29kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgKHRoZSBzdHJlYW0gc3RhcnRzIHdpdGggYSB2YWxpZCBlc2NhcGUpIGNvbnN1bWVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuIGVzY2FwZWQgY29kZSBwb2ludCBhbmQgYXBwZW5kIHRoZSByZXR1cm5lZCBjb2RlIHBvaW50IHRvXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgPHN0cmluZy10b2tlbj7igJlzIHZhbHVlLlxuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gY29uc3VtZUVzY2FwZWQkMShzb3VyY2UsIG9mZnNldCkgLSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgLy8gYW55dGhpbmcgZWxzZVxuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0aGUgY3VycmVudCBpbnB1dCBjb2RlIHBvaW50IHRvIHRoZSA8c3RyaW5nLXRva2VuPuKAmXMgdmFsdWUuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDCpyA0LjMuNi4gQ29uc3VtZSBhIHVybCB0b2tlblxuICAgIC8vIE5vdGU6IFRoaXMgYWxnb3JpdGhtIGFzc3VtZXMgdGhhdCB0aGUgaW5pdGlhbCBcInVybChcIiBoYXMgYWxyZWFkeSBiZWVuIGNvbnN1bWVkLlxuICAgIC8vIFRoaXMgYWxnb3JpdGhtIGFsc28gYXNzdW1lcyB0aGF0IGl04oCZcyBiZWluZyBjYWxsZWQgdG8gY29uc3VtZSBhbiBcInVucXVvdGVkXCIgdmFsdWUsIGxpa2UgdXJsKGZvbykuXG4gICAgLy8gQSBxdW90ZWQgdmFsdWUsIGxpa2UgdXJsKFwiZm9vXCIpLCBpcyBwYXJzZWQgYXMgYSA8ZnVuY3Rpb24tdG9rZW4+LiBDb25zdW1lIGFuIGlkZW50LWxpa2UgdG9rZW5cbiAgICAvLyBhdXRvbWF0aWNhbGx5IGhhbmRsZXMgdGhpcyBkaXN0aW5jdGlvbjsgdGhpcyBhbGdvcml0aG0gc2hvdWxkbuKAmXQgYmUgY2FsbGVkIGRpcmVjdGx5IG90aGVyd2lzZS5cbiAgICBmdW5jdGlvbiBjb25zdW1lVXJsVG9rZW4oKSB7XG4gICAgICAgIC8vIEluaXRpYWxseSBjcmVhdGUgYSA8dXJsLXRva2VuPiB3aXRoIGl0cyB2YWx1ZSBzZXQgdG8gdGhlIGVtcHR5IHN0cmluZy5cbiAgICAgICAgdHlwZSA9IFRZUEUkMi5Vcmw7XG5cbiAgICAgICAgLy8gQ29uc3VtZSBhcyBtdWNoIHdoaXRlc3BhY2UgYXMgcG9zc2libGUuXG4gICAgICAgIG9mZnNldCA9IGZpbmRXaGl0ZVNwYWNlRW5kJDEoc291cmNlLCBvZmZzZXQpO1xuXG4gICAgICAgIC8vIFJlcGVhdGVkbHkgY29uc3VtZSB0aGUgbmV4dCBpbnB1dCBjb2RlIHBvaW50IGZyb20gdGhlIHN0cmVhbTpcbiAgICAgICAgZm9yICg7IG9mZnNldCA8IHNvdXJjZS5sZW5ndGg7IG9mZnNldCsrKSB7XG4gICAgICAgICAgICB2YXIgY29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KG9mZnNldCk7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY2hhckNvZGVDYXRlZ29yeSQxKGNvZGUpKSB7XG4gICAgICAgICAgICAgICAgLy8gVSswMDI5IFJJR0hUIFBBUkVOVEhFU0lTICgpKVxuICAgICAgICAgICAgICAgIGNhc2UgMHgwMDI5OlxuICAgICAgICAgICAgICAgICAgICAvLyBSZXR1cm4gdGhlIDx1cmwtdG9rZW4+LlxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgLy8gRU9GXG4gICAgICAgICAgICAgICAgY2FzZSBjaGFyQ29kZUNhdGVnb3J5JDEuRW9mOlxuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgcGFyc2UgZXJyb3IuIFJldHVybiB0aGUgPHVybC10b2tlbj4uXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgICAgIC8vIHdoaXRlc3BhY2VcbiAgICAgICAgICAgICAgICBjYXNlIGNoYXJDb2RlQ2F0ZWdvcnkkMS5XaGl0ZVNwYWNlOlxuICAgICAgICAgICAgICAgICAgICAvLyBDb25zdW1lIGFzIG11Y2ggd2hpdGVzcGFjZSBhcyBwb3NzaWJsZS5cbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gZmluZFdoaXRlU3BhY2VFbmQkMShzb3VyY2UsIG9mZnNldCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIG5leHQgaW5wdXQgY29kZSBwb2ludCBpcyBVKzAwMjkgUklHSFQgUEFSRU5USEVTSVMgKCkpIG9yIEVPRixcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc3VtZSBpdCBhbmQgcmV0dXJuIHRoZSA8dXJsLXRva2VuPlxuICAgICAgICAgICAgICAgICAgICAvLyAoaWYgRU9GIHdhcyBlbmNvdW50ZXJlZCwgdGhpcyBpcyBhIHBhcnNlIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdldENoYXJDb2RlKG9mZnNldCkgPT09IDB4MDAyOSB8fCBvZmZzZXQgPj0gc291cmNlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9mZnNldCA8IHNvdXJjZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSwgY29uc3VtZSB0aGUgcmVtbmFudHMgb2YgYSBiYWQgdXJsLCBjcmVhdGUgYSA8YmFkLXVybC10b2tlbj4sXG4gICAgICAgICAgICAgICAgICAgIC8vIGFuZCByZXR1cm4gaXQuXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IGNvbnN1bWVCYWRVcmxSZW1uYW50cyQxKHNvdXJjZSwgb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IFRZUEUkMi5CYWRVcmw7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgICAgIC8vIFUrMDAyMiBRVU9UQVRJT04gTUFSSyAoXCIpXG4gICAgICAgICAgICAgICAgLy8gVSswMDI3IEFQT1NUUk9QSEUgKCcpXG4gICAgICAgICAgICAgICAgLy8gVSswMDI4IExFRlQgUEFSRU5USEVTSVMgKCgpXG4gICAgICAgICAgICAgICAgLy8gbm9uLXByaW50YWJsZSBjb2RlIHBvaW50XG4gICAgICAgICAgICAgICAgY2FzZSAweDAwMjI6XG4gICAgICAgICAgICAgICAgY2FzZSAweDAwMjc6XG4gICAgICAgICAgICAgICAgY2FzZSAweDAwMjg6XG4gICAgICAgICAgICAgICAgY2FzZSBjaGFyQ29kZUNhdGVnb3J5JDEuTm9uUHJpbnRhYmxlOlxuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgcGFyc2UgZXJyb3IuIENvbnN1bWUgdGhlIHJlbW5hbnRzIG9mIGEgYmFkIHVybCxcbiAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIGEgPGJhZC11cmwtdG9rZW4+LCBhbmQgcmV0dXJuIGl0LlxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBjb25zdW1lQmFkVXJsUmVtbmFudHMkMShzb3VyY2UsIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuQmFkVXJsO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAvLyBVKzAwNUMgUkVWRVJTRSBTT0xJRFVTIChcXClcbiAgICAgICAgICAgICAgICBjYXNlIDB4MDA1QzpcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHN0cmVhbSBzdGFydHMgd2l0aCBhIHZhbGlkIGVzY2FwZSwgY29uc3VtZSBhbiBlc2NhcGVkIGNvZGUgcG9pbnQgYW5kXG4gICAgICAgICAgICAgICAgICAgIC8vIGFwcGVuZCB0aGUgcmV0dXJuZWQgY29kZSBwb2ludCB0byB0aGUgPHVybC10b2tlbj7igJlzIHZhbHVlLlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZEVzY2FwZSQyKGNvZGUsIGdldENoYXJDb2RlKG9mZnNldCArIDEpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gY29uc3VtZUVzY2FwZWQkMShzb3VyY2UsIG9mZnNldCkgLSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UsIHRoaXMgaXMgYSBwYXJzZSBlcnJvci4gQ29uc3VtZSB0aGUgcmVtbmFudHMgb2YgYSBiYWQgdXJsLFxuICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgYSA8YmFkLXVybC10b2tlbj4sIGFuZCByZXR1cm4gaXQuXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IGNvbnN1bWVCYWRVcmxSZW1uYW50cyQxKHNvdXJjZSwgb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IFRZUEUkMi5CYWRVcmw7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgICAgIC8vIGFueXRoaW5nIGVsc2VcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdGhlIGN1cnJlbnQgaW5wdXQgY29kZSBwb2ludCB0byB0aGUgPHVybC10b2tlbj7igJlzIHZhbHVlLlxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFzdHJlYW0pIHtcbiAgICAgICAgc3RyZWFtID0gbmV3IFRva2VuU3RyZWFtXzEoKTtcbiAgICB9XG5cbiAgICAvLyBlbnN1cmUgc291cmNlIGlzIGEgc3RyaW5nXG4gICAgc291cmNlID0gU3RyaW5nKHNvdXJjZSB8fCAnJyk7XG5cbiAgICB2YXIgc291cmNlTGVuZ3RoID0gc291cmNlLmxlbmd0aDtcbiAgICB2YXIgb2Zmc2V0QW5kVHlwZSA9IGFkb3B0QnVmZmVyKHN0cmVhbS5vZmZzZXRBbmRUeXBlLCBzb3VyY2VMZW5ndGggKyAxKTsgLy8gKzEgYmVjYXVzZSBvZiBlb2YtdG9rZW5cbiAgICB2YXIgYmFsYW5jZSA9IGFkb3B0QnVmZmVyKHN0cmVhbS5iYWxhbmNlLCBzb3VyY2VMZW5ndGggKyAxKTtcbiAgICB2YXIgdG9rZW5Db3VudCA9IDA7XG4gICAgdmFyIHN0YXJ0ID0gaXNCT00kMShnZXRDaGFyQ29kZSgwKSk7XG4gICAgdmFyIG9mZnNldCA9IHN0YXJ0O1xuICAgIHZhciBiYWxhbmNlQ2xvc2VUeXBlID0gMDtcbiAgICB2YXIgYmFsYW5jZVN0YXJ0ID0gMDtcbiAgICB2YXIgYmFsYW5jZVByZXYgPSAwO1xuXG4gICAgLy8gaHR0cHM6Ly9kcmFmdHMuY3Nzd2cub3JnL2Nzcy1zeW50YXgtMy8jY29uc3VtZS10b2tlblxuICAgIC8vIMKnIDQuMy4xLiBDb25zdW1lIGEgdG9rZW5cbiAgICB3aGlsZSAob2Zmc2V0IDwgc291cmNlTGVuZ3RoKSB7XG4gICAgICAgIHZhciBjb2RlID0gc291cmNlLmNoYXJDb2RlQXQob2Zmc2V0KTtcbiAgICAgICAgdmFyIHR5cGUgPSAwO1xuXG4gICAgICAgIGJhbGFuY2VbdG9rZW5Db3VudF0gPSBzb3VyY2VMZW5ndGg7XG5cbiAgICAgICAgc3dpdGNoIChjaGFyQ29kZUNhdGVnb3J5JDEoY29kZSkpIHtcbiAgICAgICAgICAgIC8vIHdoaXRlc3BhY2VcbiAgICAgICAgICAgIGNhc2UgY2hhckNvZGVDYXRlZ29yeSQxLldoaXRlU3BhY2U6XG4gICAgICAgICAgICAgICAgLy8gQ29uc3VtZSBhcyBtdWNoIHdoaXRlc3BhY2UgYXMgcG9zc2libGUuIFJldHVybiBhIDx3aGl0ZXNwYWNlLXRva2VuPi5cbiAgICAgICAgICAgICAgICB0eXBlID0gVFlQRSQyLldoaXRlU3BhY2U7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gZmluZFdoaXRlU3BhY2VFbmQkMShzb3VyY2UsIG9mZnNldCArIDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBVKzAwMjIgUVVPVEFUSU9OIE1BUksgKFwiKVxuICAgICAgICAgICAgY2FzZSAweDAwMjI6XG4gICAgICAgICAgICAgICAgLy8gQ29uc3VtZSBhIHN0cmluZyB0b2tlbiBhbmQgcmV0dXJuIGl0LlxuICAgICAgICAgICAgICAgIGNvbnN1bWVTdHJpbmdUb2tlbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBVKzAwMjMgTlVNQkVSIFNJR04gKCMpXG4gICAgICAgICAgICBjYXNlIDB4MDAyMzpcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgbmV4dCBpbnB1dCBjb2RlIHBvaW50IGlzIGEgbmFtZSBjb2RlIHBvaW50IG9yIHRoZSBuZXh0IHR3byBpbnB1dCBjb2RlIHBvaW50cyBhcmUgYSB2YWxpZCBlc2NhcGUsIHRoZW46XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFtZSQyKGdldENoYXJDb2RlKG9mZnNldCArIDEpKSB8fCBpc1ZhbGlkRXNjYXBlJDIoZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMSksIGdldENoYXJDb2RlKG9mZnNldCArIDIpKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSA8aGFzaC10b2tlbj4uXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuSGFzaDtcblxuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgbmV4dCAzIGlucHV0IGNvZGUgcG9pbnRzIHdvdWxkIHN0YXJ0IGFuIGlkZW50aWZpZXIsIHNldCB0aGUgPGhhc2gtdG9rZW4+4oCZcyB0eXBlIGZsYWcgdG8gXCJpZFwiLlxuICAgICAgICAgICAgICAgICAgICAvLyBpZiAoaXNJZGVudGlmaWVyU3RhcnQoZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMSksIGdldENoYXJDb2RlKG9mZnNldCArIDIpLCBnZXRDaGFyQ29kZShvZmZzZXQgKyAzKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vIFRPRE86IHNldCBpZCBmbGFnXG4gICAgICAgICAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBDb25zdW1lIGEgbmFtZSwgYW5kIHNldCB0aGUgPGhhc2gtdG9rZW4+4oCZcyB2YWx1ZSB0byB0aGUgcmV0dXJuZWQgc3RyaW5nLlxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBjb25zdW1lTmFtZSQxKHNvdXJjZSwgb2Zmc2V0ICsgMSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSA8aGFzaC10b2tlbj4uXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCByZXR1cm4gYSA8ZGVsaW0tdG9rZW4+IHdpdGggaXRzIHZhbHVlIHNldCB0byB0aGUgY3VycmVudCBpbnB1dCBjb2RlIHBvaW50LlxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gVFlQRSQyLkRlbGltO1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVSswMDI3IEFQT1NUUk9QSEUgKCcpXG4gICAgICAgICAgICBjYXNlIDB4MDAyNzpcbiAgICAgICAgICAgICAgICAvLyBDb25zdW1lIGEgc3RyaW5nIHRva2VuIGFuZCByZXR1cm4gaXQuXG4gICAgICAgICAgICAgICAgY29uc3VtZVN0cmluZ1Rva2VuKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIFUrMDAyOCBMRUZUIFBBUkVOVEhFU0lTICgoKVxuICAgICAgICAgICAgY2FzZSAweDAwMjg6XG4gICAgICAgICAgICAgICAgLy8gUmV0dXJuIGEgPCgtdG9rZW4+LlxuICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuTGVmdFBhcmVudGhlc2lzO1xuICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBVKzAwMjkgUklHSFQgUEFSRU5USEVTSVMgKCkpXG4gICAgICAgICAgICBjYXNlIDB4MDAyOTpcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gYSA8KS10b2tlbj4uXG4gICAgICAgICAgICAgICAgdHlwZSA9IFRZUEUkMi5SaWdodFBhcmVudGhlc2lzO1xuICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBVKzAwMkIgUExVUyBTSUdOICgrKVxuICAgICAgICAgICAgY2FzZSAweDAwMkI6XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGlucHV0IHN0cmVhbSBzdGFydHMgd2l0aCBhIG51bWJlciwgLi4uXG4gICAgICAgICAgICAgICAgaWYgKGlzTnVtYmVyU3RhcnQkMShjb2RlLCBnZXRDaGFyQ29kZShvZmZzZXQgKyAxKSwgZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMikpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIC4uLiByZWNvbnN1bWUgdGhlIGN1cnJlbnQgaW5wdXQgY29kZSBwb2ludCwgY29uc3VtZSBhIG51bWVyaWMgdG9rZW4sIGFuZCByZXR1cm4gaXQuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN1bWVOdW1lcmljVG9rZW4oKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UsIHJldHVybiBhIDxkZWxpbS10b2tlbj4gd2l0aCBpdHMgdmFsdWUgc2V0IHRvIHRoZSBjdXJyZW50IGlucHV0IGNvZGUgcG9pbnQuXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuRGVsaW07XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVSswMDJDIENPTU1BICgsKVxuICAgICAgICAgICAgY2FzZSAweDAwMkM6XG4gICAgICAgICAgICAgICAgLy8gUmV0dXJuIGEgPGNvbW1hLXRva2VuPi5cbiAgICAgICAgICAgICAgICB0eXBlID0gVFlQRSQyLkNvbW1hO1xuICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBVKzAwMkQgSFlQSEVOLU1JTlVTICgtKVxuICAgICAgICAgICAgY2FzZSAweDAwMkQ6XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGlucHV0IHN0cmVhbSBzdGFydHMgd2l0aCBhIG51bWJlciwgcmVjb25zdW1lIHRoZSBjdXJyZW50IGlucHV0IGNvZGUgcG9pbnQsIGNvbnN1bWUgYSBudW1lcmljIHRva2VuLCBhbmQgcmV0dXJuIGl0LlxuICAgICAgICAgICAgICAgIGlmIChpc051bWJlclN0YXJ0JDEoY29kZSwgZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMSksIGdldENoYXJDb2RlKG9mZnNldCArIDIpKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdW1lTnVtZXJpY1Rva2VuKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCBpZiB0aGUgbmV4dCAyIGlucHV0IGNvZGUgcG9pbnRzIGFyZSBVKzAwMkQgSFlQSEVOLU1JTlVTIFUrMDAzRSBHUkVBVEVSLVRIQU4gU0lHTiAoLT4pLCBjb25zdW1lIHRoZW0gYW5kIHJldHVybiBhIDxDREMtdG9rZW4+LlxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMSkgPT09IDB4MDAyRCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMikgPT09IDB4MDAzRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IFRZUEUkMi5DREM7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXQgKyAzO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCBpZiB0aGUgaW5wdXQgc3RyZWFtIHN0YXJ0cyB3aXRoIGFuIGlkZW50aWZpZXIsIC4uLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzSWRlbnRpZmllclN0YXJ0JDIoY29kZSwgZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMSksIGdldENoYXJDb2RlKG9mZnNldCArIDIpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIC4uLiByZWNvbnN1bWUgdGhlIGN1cnJlbnQgaW5wdXQgY29kZSBwb2ludCwgY29uc3VtZSBhbiBpZGVudC1saWtlIHRva2VuLCBhbmQgcmV0dXJuIGl0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN1bWVJZGVudExpa2VUb2tlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UsIHJldHVybiBhIDxkZWxpbS10b2tlbj4gd2l0aCBpdHMgdmFsdWUgc2V0IHRvIHRoZSBjdXJyZW50IGlucHV0IGNvZGUgcG9pbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IFRZUEUkMi5EZWxpbTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVSswMDJFIEZVTEwgU1RPUCAoLilcbiAgICAgICAgICAgIGNhc2UgMHgwMDJFOlxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBpbnB1dCBzdHJlYW0gc3RhcnRzIHdpdGggYSBudW1iZXIsIC4uLlxuICAgICAgICAgICAgICAgIGlmIChpc051bWJlclN0YXJ0JDEoY29kZSwgZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMSksIGdldENoYXJDb2RlKG9mZnNldCArIDIpKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyAuLi4gcmVjb25zdW1lIHRoZSBjdXJyZW50IGlucHV0IGNvZGUgcG9pbnQsIGNvbnN1bWUgYSBudW1lcmljIHRva2VuLCBhbmQgcmV0dXJuIGl0LlxuICAgICAgICAgICAgICAgICAgICBjb25zdW1lTnVtZXJpY1Rva2VuKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCByZXR1cm4gYSA8ZGVsaW0tdG9rZW4+IHdpdGggaXRzIHZhbHVlIHNldCB0byB0aGUgY3VycmVudCBpbnB1dCBjb2RlIHBvaW50LlxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gVFlQRSQyLkRlbGltO1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVSswMDJGIFNPTElEVVMgKC8pXG4gICAgICAgICAgICBjYXNlIDB4MDAyRjpcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgbmV4dCB0d28gaW5wdXQgY29kZSBwb2ludCBhcmUgVSswMDJGIFNPTElEVVMgKC8pIGZvbGxvd2VkIGJ5IGEgVSswMDJBIEFTVEVSSVNLICgqKSxcbiAgICAgICAgICAgICAgICBpZiAoZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMSkgPT09IDB4MDAyQSkge1xuICAgICAgICAgICAgICAgICAgICAvLyAuLi4gY29uc3VtZSB0aGVtIGFuZCBhbGwgZm9sbG93aW5nIGNvZGUgcG9pbnRzIHVwIHRvIGFuZCBpbmNsdWRpbmcgdGhlIGZpcnN0IFUrMDAyQSBBU1RFUklTSyAoKilcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9sbG93ZWQgYnkgYSBVKzAwMkYgU09MSURVUyAoLyksIG9yIHVwIHRvIGFuIEVPRiBjb2RlIHBvaW50LlxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gVFlQRSQyLkNvbW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IHNvdXJjZS5pbmRleE9mKCcqLycsIG9mZnNldCArIDIpICsgMjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9mZnNldCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gc291cmNlLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuRGVsaW07XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVSswMDNBIENPTE9OICg6KVxuICAgICAgICAgICAgY2FzZSAweDAwM0E6XG4gICAgICAgICAgICAgICAgLy8gUmV0dXJuIGEgPGNvbG9uLXRva2VuPi5cbiAgICAgICAgICAgICAgICB0eXBlID0gVFlQRSQyLkNvbG9uO1xuICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBVKzAwM0IgU0VNSUNPTE9OICg7KVxuICAgICAgICAgICAgY2FzZSAweDAwM0I6XG4gICAgICAgICAgICAgICAgLy8gUmV0dXJuIGEgPHNlbWljb2xvbi10b2tlbj4uXG4gICAgICAgICAgICAgICAgdHlwZSA9IFRZUEUkMi5TZW1pY29sb247XG4gICAgICAgICAgICAgICAgb2Zmc2V0Kys7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIFUrMDAzQyBMRVNTLVRIQU4gU0lHTiAoPClcbiAgICAgICAgICAgIGNhc2UgMHgwMDNDOlxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBuZXh0IDMgaW5wdXQgY29kZSBwb2ludHMgYXJlIFUrMDAyMSBFWENMQU1BVElPTiBNQVJLIFUrMDAyRCBIWVBIRU4tTUlOVVMgVSswMDJEIEhZUEhFTi1NSU5VUyAoIS0tKSwgLi4uXG4gICAgICAgICAgICAgICAgaWYgKGdldENoYXJDb2RlKG9mZnNldCArIDEpID09PSAweDAwMjEgJiZcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMikgPT09IDB4MDAyRCAmJlxuICAgICAgICAgICAgICAgICAgICBnZXRDaGFyQ29kZShvZmZzZXQgKyAzKSA9PT0gMHgwMDJEKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIC4uLiBjb25zdW1lIHRoZW0gYW5kIHJldHVybiBhIDxDRE8tdG9rZW4+LlxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gVFlQRSQyLkNETztcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ICsgNDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UsIHJldHVybiBhIDxkZWxpbS10b2tlbj4gd2l0aCBpdHMgdmFsdWUgc2V0IHRvIHRoZSBjdXJyZW50IGlucHV0IGNvZGUgcG9pbnQuXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuRGVsaW07XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBVKzAwNDAgQ09NTUVSQ0lBTCBBVCAoQClcbiAgICAgICAgICAgIGNhc2UgMHgwMDQwOlxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBuZXh0IDMgaW5wdXQgY29kZSBwb2ludHMgd291bGQgc3RhcnQgYW4gaWRlbnRpZmllciwgLi4uXG4gICAgICAgICAgICAgICAgaWYgKGlzSWRlbnRpZmllclN0YXJ0JDIoZ2V0Q2hhckNvZGUob2Zmc2V0ICsgMSksIGdldENoYXJDb2RlKG9mZnNldCArIDIpLCBnZXRDaGFyQ29kZShvZmZzZXQgKyAzKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gLi4uIGNvbnN1bWUgYSBuYW1lLCBjcmVhdGUgYW4gPGF0LWtleXdvcmQtdG9rZW4+IHdpdGggaXRzIHZhbHVlIHNldCB0byB0aGUgcmV0dXJuZWQgdmFsdWUsIGFuZCByZXR1cm4gaXQuXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuQXRLZXl3b3JkO1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBjb25zdW1lTmFtZSQxKHNvdXJjZSwgb2Zmc2V0ICsgMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCByZXR1cm4gYSA8ZGVsaW0tdG9rZW4+IHdpdGggaXRzIHZhbHVlIHNldCB0byB0aGUgY3VycmVudCBpbnB1dCBjb2RlIHBvaW50LlxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gVFlQRSQyLkRlbGltO1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVSswMDVCIExFRlQgU1FVQVJFIEJSQUNLRVQgKFspXG4gICAgICAgICAgICBjYXNlIDB4MDA1QjpcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gYSA8Wy10b2tlbj4uXG4gICAgICAgICAgICAgICAgdHlwZSA9IFRZUEUkMi5MZWZ0U3F1YXJlQnJhY2tldDtcbiAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVSswMDVDIFJFVkVSU0UgU09MSURVUyAoXFwpXG4gICAgICAgICAgICBjYXNlIDB4MDA1QzpcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgaW5wdXQgc3RyZWFtIHN0YXJ0cyB3aXRoIGEgdmFsaWQgZXNjYXBlLCAuLi5cbiAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZEVzY2FwZSQyKGNvZGUsIGdldENoYXJDb2RlKG9mZnNldCArIDEpKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyAuLi4gcmVjb25zdW1lIHRoZSBjdXJyZW50IGlucHV0IGNvZGUgcG9pbnQsIGNvbnN1bWUgYW4gaWRlbnQtbGlrZSB0b2tlbiwgYW5kIHJldHVybiBpdC5cbiAgICAgICAgICAgICAgICAgICAgY29uc3VtZUlkZW50TGlrZVRva2VuKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCB0aGlzIGlzIGEgcGFyc2UgZXJyb3IuIFJldHVybiBhIDxkZWxpbS10b2tlbj4gd2l0aCBpdHMgdmFsdWUgc2V0IHRvIHRoZSBjdXJyZW50IGlucHV0IGNvZGUgcG9pbnQuXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuRGVsaW07XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVSswMDVEIFJJR0hUIFNRVUFSRSBCUkFDS0VUIChdKVxuICAgICAgICAgICAgY2FzZSAweDAwNUQ6XG4gICAgICAgICAgICAgICAgLy8gUmV0dXJuIGEgPF0tdG9rZW4+LlxuICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuUmlnaHRTcXVhcmVCcmFja2V0O1xuICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBVKzAwN0IgTEVGVCBDVVJMWSBCUkFDS0VUICh7KVxuICAgICAgICAgICAgY2FzZSAweDAwN0I6XG4gICAgICAgICAgICAgICAgLy8gUmV0dXJuIGEgPHstdG9rZW4+LlxuICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuTGVmdEN1cmx5QnJhY2tldDtcbiAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVSswMDdEIFJJR0hUIENVUkxZIEJSQUNLRVQgKH0pXG4gICAgICAgICAgICBjYXNlIDB4MDA3RDpcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gYSA8fS10b2tlbj4uXG4gICAgICAgICAgICAgICAgdHlwZSA9IFRZUEUkMi5SaWdodEN1cmx5QnJhY2tldDtcbiAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gZGlnaXRcbiAgICAgICAgICAgIGNhc2UgY2hhckNvZGVDYXRlZ29yeSQxLkRpZ2l0OlxuICAgICAgICAgICAgICAgIC8vIFJlY29uc3VtZSB0aGUgY3VycmVudCBpbnB1dCBjb2RlIHBvaW50LCBjb25zdW1lIGEgbnVtZXJpYyB0b2tlbiwgYW5kIHJldHVybiBpdC5cbiAgICAgICAgICAgICAgICBjb25zdW1lTnVtZXJpY1Rva2VuKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIG5hbWUtc3RhcnQgY29kZSBwb2ludFxuICAgICAgICAgICAgY2FzZSBjaGFyQ29kZUNhdGVnb3J5JDEuTmFtZVN0YXJ0OlxuICAgICAgICAgICAgICAgIC8vIFJlY29uc3VtZSB0aGUgY3VycmVudCBpbnB1dCBjb2RlIHBvaW50LCBjb25zdW1lIGFuIGlkZW50LWxpa2UgdG9rZW4sIGFuZCByZXR1cm4gaXQuXG4gICAgICAgICAgICAgICAgY29uc3VtZUlkZW50TGlrZVRva2VuKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIEVPRlxuICAgICAgICAgICAgY2FzZSBjaGFyQ29kZUNhdGVnb3J5JDEuRW9mOlxuICAgICAgICAgICAgICAgIC8vIFJldHVybiBhbiA8RU9GLXRva2VuPi5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gYW55dGhpbmcgZWxzZVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gYSA8ZGVsaW0tdG9rZW4+IHdpdGggaXRzIHZhbHVlIHNldCB0byB0aGUgY3VycmVudCBpbnB1dCBjb2RlIHBvaW50LlxuICAgICAgICAgICAgICAgIHR5cGUgPSBUWVBFJDIuRGVsaW07XG4gICAgICAgICAgICAgICAgb2Zmc2V0Kys7XG4gICAgICAgIH1cblxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgYmFsYW5jZUNsb3NlVHlwZTpcbiAgICAgICAgICAgICAgICBiYWxhbmNlUHJldiA9IGJhbGFuY2VTdGFydCAmIE9GRlNFVF9NQVNLJDE7XG4gICAgICAgICAgICAgICAgYmFsYW5jZVN0YXJ0ID0gYmFsYW5jZVtiYWxhbmNlUHJldl07XG4gICAgICAgICAgICAgICAgYmFsYW5jZUNsb3NlVHlwZSA9IGJhbGFuY2VTdGFydCA+PiBUWVBFX1NISUZUJDE7XG4gICAgICAgICAgICAgICAgYmFsYW5jZVt0b2tlbkNvdW50XSA9IGJhbGFuY2VQcmV2O1xuICAgICAgICAgICAgICAgIGJhbGFuY2VbYmFsYW5jZVByZXYrK10gPSB0b2tlbkNvdW50O1xuICAgICAgICAgICAgICAgIGZvciAoOyBiYWxhbmNlUHJldiA8IHRva2VuQ291bnQ7IGJhbGFuY2VQcmV2KyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJhbGFuY2VbYmFsYW5jZVByZXZdID09PSBzb3VyY2VMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2VbYmFsYW5jZVByZXZdID0gdG9rZW5Db3VudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBUWVBFJDIuTGVmdFBhcmVudGhlc2lzOlxuICAgICAgICAgICAgY2FzZSBUWVBFJDIuRnVuY3Rpb246XG4gICAgICAgICAgICAgICAgYmFsYW5jZVt0b2tlbkNvdW50XSA9IGJhbGFuY2VTdGFydDtcbiAgICAgICAgICAgICAgICBiYWxhbmNlQ2xvc2VUeXBlID0gVFlQRSQyLlJpZ2h0UGFyZW50aGVzaXM7XG4gICAgICAgICAgICAgICAgYmFsYW5jZVN0YXJ0ID0gKGJhbGFuY2VDbG9zZVR5cGUgPDwgVFlQRV9TSElGVCQxKSB8IHRva2VuQ291bnQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgVFlQRSQyLkxlZnRTcXVhcmVCcmFja2V0OlxuICAgICAgICAgICAgICAgIGJhbGFuY2VbdG9rZW5Db3VudF0gPSBiYWxhbmNlU3RhcnQ7XG4gICAgICAgICAgICAgICAgYmFsYW5jZUNsb3NlVHlwZSA9IFRZUEUkMi5SaWdodFNxdWFyZUJyYWNrZXQ7XG4gICAgICAgICAgICAgICAgYmFsYW5jZVN0YXJ0ID0gKGJhbGFuY2VDbG9zZVR5cGUgPDwgVFlQRV9TSElGVCQxKSB8IHRva2VuQ291bnQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgVFlQRSQyLkxlZnRDdXJseUJyYWNrZXQ6XG4gICAgICAgICAgICAgICAgYmFsYW5jZVt0b2tlbkNvdW50XSA9IGJhbGFuY2VTdGFydDtcbiAgICAgICAgICAgICAgICBiYWxhbmNlQ2xvc2VUeXBlID0gVFlQRSQyLlJpZ2h0Q3VybHlCcmFja2V0O1xuICAgICAgICAgICAgICAgIGJhbGFuY2VTdGFydCA9IChiYWxhbmNlQ2xvc2VUeXBlIDw8IFRZUEVfU0hJRlQkMSkgfCB0b2tlbkNvdW50O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgb2Zmc2V0QW5kVHlwZVt0b2tlbkNvdW50KytdID0gKHR5cGUgPDwgVFlQRV9TSElGVCQxKSB8IG9mZnNldDtcbiAgICB9XG5cbiAgICAvLyBmaW5hbGl6ZSBidWZmZXJzXG4gICAgb2Zmc2V0QW5kVHlwZVt0b2tlbkNvdW50XSA9IChUWVBFJDIuRU9GIDw8IFRZUEVfU0hJRlQkMSkgfCBvZmZzZXQ7IC8vIDxFT0YtdG9rZW4+XG4gICAgYmFsYW5jZVt0b2tlbkNvdW50XSA9IHNvdXJjZUxlbmd0aDtcbiAgICBiYWxhbmNlW3NvdXJjZUxlbmd0aF0gPSBzb3VyY2VMZW5ndGg7IC8vIHByZXZlbnRzIGZhbHNlIHBvc2l0aXZlIGJhbGFuY2UgbWF0Y2ggd2l0aCBhbnkgdG9rZW5cbiAgICB3aGlsZSAoYmFsYW5jZVN0YXJ0ICE9PSAwKSB7XG4gICAgICAgIGJhbGFuY2VQcmV2ID0gYmFsYW5jZVN0YXJ0ICYgT0ZGU0VUX01BU0skMTtcbiAgICAgICAgYmFsYW5jZVN0YXJ0ID0gYmFsYW5jZVtiYWxhbmNlUHJldl07XG4gICAgICAgIGJhbGFuY2VbYmFsYW5jZVByZXZdID0gc291cmNlTGVuZ3RoO1xuICAgIH1cblxuICAgIC8vIHVwZGF0ZSBzdHJlYW1cbiAgICBzdHJlYW0uc291cmNlID0gc291cmNlO1xuICAgIHN0cmVhbS5maXJzdENoYXJPZmZzZXQgPSBzdGFydDtcbiAgICBzdHJlYW0ub2Zmc2V0QW5kVHlwZSA9IG9mZnNldEFuZFR5cGU7XG4gICAgc3RyZWFtLnRva2VuQ291bnQgPSB0b2tlbkNvdW50O1xuICAgIHN0cmVhbS5iYWxhbmNlID0gYmFsYW5jZTtcbiAgICBzdHJlYW0ucmVzZXQoKTtcbiAgICBzdHJlYW0ubmV4dCgpO1xuXG4gICAgcmV0dXJuIHN0cmVhbTtcbn1cblxuLy8gZXh0ZW5kIHRva2VuaXplciB3aXRoIGNvbnN0YW50c1xuT2JqZWN0LmtleXMoX2NvbnN0KS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgIHRva2VuaXplW2tleV0gPSBfY29uc3Rba2V5XTtcbn0pO1xuXG4vLyBleHRlbmQgdG9rZW5pemVyIHdpdGggc3RhdGljIG1ldGhvZHMgZnJvbSB1dGlsc1xuT2JqZWN0LmtleXMoY2hhckNvZGVEZWZpbml0aW9ucykuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICB0b2tlbml6ZVtrZXldID0gY2hhckNvZGVEZWZpbml0aW9uc1trZXldO1xufSk7XG5PYmplY3Qua2V5cyh1dGlscykuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICB0b2tlbml6ZVtrZXldID0gdXRpbHNba2V5XTtcbn0pO1xuXG52YXIgdG9rZW5pemVyID0gdG9rZW5pemU7XG5cbnZhciBpc0JPTSQyID0gdG9rZW5pemVyLmlzQk9NO1xuXG52YXIgTiA9IDEwO1xudmFyIEYgPSAxMjtcbnZhciBSID0gMTM7XG5cbmZ1bmN0aW9uIGNvbXB1dGVMaW5lc0FuZENvbHVtbnMoaG9zdCwgc291cmNlKSB7XG4gICAgdmFyIHNvdXJjZUxlbmd0aCA9IHNvdXJjZS5sZW5ndGg7XG4gICAgdmFyIGxpbmVzID0gYWRvcHRCdWZmZXIoaG9zdC5saW5lcywgc291cmNlTGVuZ3RoKTsgLy8gKzFcbiAgICB2YXIgbGluZSA9IGhvc3Quc3RhcnRMaW5lO1xuICAgIHZhciBjb2x1bW5zID0gYWRvcHRCdWZmZXIoaG9zdC5jb2x1bW5zLCBzb3VyY2VMZW5ndGgpO1xuICAgIHZhciBjb2x1bW4gPSBob3N0LnN0YXJ0Q29sdW1uO1xuICAgIHZhciBzdGFydE9mZnNldCA9IHNvdXJjZS5sZW5ndGggPiAwID8gaXNCT00kMihzb3VyY2UuY2hhckNvZGVBdCgwKSkgOiAwO1xuXG4gICAgZm9yICh2YXIgaSA9IHN0YXJ0T2Zmc2V0OyBpIDwgc291cmNlTGVuZ3RoOyBpKyspIHsgLy8gLTFcbiAgICAgICAgdmFyIGNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChpKTtcblxuICAgICAgICBsaW5lc1tpXSA9IGxpbmU7XG4gICAgICAgIGNvbHVtbnNbaV0gPSBjb2x1bW4rKztcblxuICAgICAgICBpZiAoY29kZSA9PT0gTiB8fCBjb2RlID09PSBSIHx8IGNvZGUgPT09IEYpIHtcbiAgICAgICAgICAgIGlmIChjb2RlID09PSBSICYmIGkgKyAxIDwgc291cmNlTGVuZ3RoICYmIHNvdXJjZS5jaGFyQ29kZUF0KGkgKyAxKSA9PT0gTikge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICBsaW5lc1tpXSA9IGxpbmU7XG4gICAgICAgICAgICAgICAgY29sdW1uc1tpXSA9IGNvbHVtbjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGluZSsrO1xuICAgICAgICAgICAgY29sdW1uID0gMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxpbmVzW2ldID0gbGluZTtcbiAgICBjb2x1bW5zW2ldID0gY29sdW1uO1xuXG4gICAgaG9zdC5saW5lcyA9IGxpbmVzO1xuICAgIGhvc3QuY29sdW1ucyA9IGNvbHVtbnM7XG59XG5cbnZhciBPZmZzZXRUb0xvY2F0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5saW5lcyA9IG51bGw7XG4gICAgdGhpcy5jb2x1bW5zID0gbnVsbDtcbiAgICB0aGlzLmxpbmVzQW5kQ29sdW1uc0NvbXB1dGVkID0gZmFsc2U7XG59O1xuXG5PZmZzZXRUb0xvY2F0aW9uLnByb3RvdHlwZSA9IHtcbiAgICBzZXRTb3VyY2U6IGZ1bmN0aW9uKHNvdXJjZSwgc3RhcnRPZmZzZXQsIHN0YXJ0TGluZSwgc3RhcnRDb2x1bW4pIHtcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIHRoaXMuc3RhcnRPZmZzZXQgPSB0eXBlb2Ygc3RhcnRPZmZzZXQgPT09ICd1bmRlZmluZWQnID8gMCA6IHN0YXJ0T2Zmc2V0O1xuICAgICAgICB0aGlzLnN0YXJ0TGluZSA9IHR5cGVvZiBzdGFydExpbmUgPT09ICd1bmRlZmluZWQnID8gMSA6IHN0YXJ0TGluZTtcbiAgICAgICAgdGhpcy5zdGFydENvbHVtbiA9IHR5cGVvZiBzdGFydENvbHVtbiA9PT0gJ3VuZGVmaW5lZCcgPyAxIDogc3RhcnRDb2x1bW47XG4gICAgICAgIHRoaXMubGluZXNBbmRDb2x1bW5zQ29tcHV0ZWQgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgZW5zdXJlTGluZXNBbmRDb2x1bW5zQ29tcHV0ZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMubGluZXNBbmRDb2x1bW5zQ29tcHV0ZWQpIHtcbiAgICAgICAgICAgIGNvbXB1dGVMaW5lc0FuZENvbHVtbnModGhpcywgdGhpcy5zb3VyY2UpO1xuICAgICAgICAgICAgdGhpcy5saW5lc0FuZENvbHVtbnNDb21wdXRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGdldExvY2F0aW9uOiBmdW5jdGlvbihvZmZzZXQsIGZpbGVuYW1lKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlTGluZXNBbmRDb2x1bW5zQ29tcHV0ZWQoKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc291cmNlOiBmaWxlbmFtZSxcbiAgICAgICAgICAgIG9mZnNldDogdGhpcy5zdGFydE9mZnNldCArIG9mZnNldCxcbiAgICAgICAgICAgIGxpbmU6IHRoaXMubGluZXNbb2Zmc2V0XSxcbiAgICAgICAgICAgIGNvbHVtbjogdGhpcy5jb2x1bW5zW29mZnNldF1cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdldExvY2F0aW9uUmFuZ2U6IGZ1bmN0aW9uKHN0YXJ0LCBlbmQsIGZpbGVuYW1lKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlTGluZXNBbmRDb2x1bW5zQ29tcHV0ZWQoKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc291cmNlOiBmaWxlbmFtZSxcbiAgICAgICAgICAgIHN0YXJ0OiB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0OiB0aGlzLnN0YXJ0T2Zmc2V0ICsgc3RhcnQsXG4gICAgICAgICAgICAgICAgbGluZTogdGhpcy5saW5lc1tzdGFydF0sXG4gICAgICAgICAgICAgICAgY29sdW1uOiB0aGlzLmNvbHVtbnNbc3RhcnRdXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW5kOiB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0OiB0aGlzLnN0YXJ0T2Zmc2V0ICsgZW5kLFxuICAgICAgICAgICAgICAgIGxpbmU6IHRoaXMubGluZXNbZW5kXSxcbiAgICAgICAgICAgICAgICBjb2x1bW46IHRoaXMuY29sdW1uc1tlbmRdXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxufTtcblxudmFyIE9mZnNldFRvTG9jYXRpb25fMSA9IE9mZnNldFRvTG9jYXRpb247XG5cbnZhciBjcmVhdGVDdXN0b21FcnJvciA9IGZ1bmN0aW9uIGNyZWF0ZUN1c3RvbUVycm9yKG5hbWUsIG1lc3NhZ2UpIHtcbiAgICAvLyB1c2UgT2JqZWN0LmNyZWF0ZSgpLCBiZWNhdXNlIHNvbWUgVk1zIHByZXZlbnQgc2V0dGluZyBsaW5lL2NvbHVtbiBvdGhlcndpc2VcbiAgICAvLyAoaU9TIFNhZmFyaSAxMCBldmVuIHRocm93cyBhbiBleGNlcHRpb24pXG4gICAgdmFyIGVycm9yID0gT2JqZWN0LmNyZWF0ZShTeW50YXhFcnJvci5wcm90b3R5cGUpO1xuICAgIHZhciBlcnJvclN0YWNrID0gbmV3IEVycm9yKCk7XG5cbiAgICBlcnJvci5uYW1lID0gbmFtZTtcbiAgICBlcnJvci5tZXNzYWdlID0gbWVzc2FnZTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlcnJvciwgJ3N0YWNrJywge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIChlcnJvclN0YWNrLnN0YWNrIHx8ICcnKS5yZXBsYWNlKC9eKC4rXFxuKXsxLDN9LywgbmFtZSArICc6ICcgKyBtZXNzYWdlICsgJ1xcbicpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZXJyb3I7XG59O1xuXG52YXIgTUFYX0xJTkVfTEVOR1RIID0gMTAwO1xudmFyIE9GRlNFVF9DT1JSRUNUSU9OID0gNjA7XG52YXIgVEFCX1JFUExBQ0VNRU5UID0gJyAgICAnO1xuXG5mdW5jdGlvbiBzb3VyY2VGcmFnbWVudChlcnJvciwgZXh0cmFMaW5lcykge1xuICAgIGZ1bmN0aW9uIHByb2Nlc3NMaW5lcyhzdGFydCwgZW5kKSB7XG4gICAgICAgIHJldHVybiBsaW5lcy5zbGljZShzdGFydCwgZW5kKS5tYXAoZnVuY3Rpb24obGluZSwgaWR4KSB7XG4gICAgICAgICAgICB2YXIgbnVtID0gU3RyaW5nKHN0YXJ0ICsgaWR4ICsgMSk7XG5cbiAgICAgICAgICAgIHdoaWxlIChudW0ubGVuZ3RoIDwgbWF4TnVtTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgbnVtID0gJyAnICsgbnVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbnVtICsgJyB8JyArIGxpbmU7XG4gICAgICAgIH0pLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIHZhciBsaW5lcyA9IGVycm9yLnNvdXJjZS5zcGxpdCgvXFxyXFxuP3xcXG58XFxmLyk7XG4gICAgdmFyIGxpbmUgPSBlcnJvci5saW5lO1xuICAgIHZhciBjb2x1bW4gPSBlcnJvci5jb2x1bW47XG4gICAgdmFyIHN0YXJ0TGluZSA9IE1hdGgubWF4KDEsIGxpbmUgLSBleHRyYUxpbmVzKSAtIDE7XG4gICAgdmFyIGVuZExpbmUgPSBNYXRoLm1pbihsaW5lICsgZXh0cmFMaW5lcywgbGluZXMubGVuZ3RoICsgMSk7XG4gICAgdmFyIG1heE51bUxlbmd0aCA9IE1hdGgubWF4KDQsIFN0cmluZyhlbmRMaW5lKS5sZW5ndGgpICsgMTtcbiAgICB2YXIgY3V0TGVmdCA9IDA7XG5cbiAgICAvLyBjb2x1bW4gY29ycmVjdGlvbiBhY2NvcmRpbmcgdG8gcmVwbGFjZWQgdGFiIGJlZm9yZSBjb2x1bW5cbiAgICBjb2x1bW4gKz0gKFRBQl9SRVBMQUNFTUVOVC5sZW5ndGggLSAxKSAqIChsaW5lc1tsaW5lIC0gMV0uc3Vic3RyKDAsIGNvbHVtbiAtIDEpLm1hdGNoKC9cXHQvZykgfHwgW10pLmxlbmd0aDtcblxuICAgIGlmIChjb2x1bW4gPiBNQVhfTElORV9MRU5HVEgpIHtcbiAgICAgICAgY3V0TGVmdCA9IGNvbHVtbiAtIE9GRlNFVF9DT1JSRUNUSU9OICsgMztcbiAgICAgICAgY29sdW1uID0gT0ZGU0VUX0NPUlJFQ1RJT04gLSAyO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSBzdGFydExpbmU7IGkgPD0gZW5kTGluZTsgaSsrKSB7XG4gICAgICAgIGlmIChpID49IDAgJiYgaSA8IGxpbmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgbGluZXNbaV0gPSBsaW5lc1tpXS5yZXBsYWNlKC9cXHQvZywgVEFCX1JFUExBQ0VNRU5UKTtcbiAgICAgICAgICAgIGxpbmVzW2ldID1cbiAgICAgICAgICAgICAgICAoY3V0TGVmdCA+IDAgJiYgbGluZXNbaV0ubGVuZ3RoID4gY3V0TGVmdCA/ICdcXHUyMDI2JyA6ICcnKSArXG4gICAgICAgICAgICAgICAgbGluZXNbaV0uc3Vic3RyKGN1dExlZnQsIE1BWF9MSU5FX0xFTkdUSCAtIDIpICtcbiAgICAgICAgICAgICAgICAobGluZXNbaV0ubGVuZ3RoID4gY3V0TGVmdCArIE1BWF9MSU5FX0xFTkdUSCAtIDEgPyAnXFx1MjAyNicgOiAnJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gW1xuICAgICAgICBwcm9jZXNzTGluZXMoc3RhcnRMaW5lLCBsaW5lKSxcbiAgICAgICAgbmV3IEFycmF5KGNvbHVtbiArIG1heE51bUxlbmd0aCArIDIpLmpvaW4oJy0nKSArICdeJyxcbiAgICAgICAgcHJvY2Vzc0xpbmVzKGxpbmUsIGVuZExpbmUpXG4gICAgXS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XG59XG5cbnZhciBTeW50YXhFcnJvciQxID0gZnVuY3Rpb24obWVzc2FnZSwgc291cmNlLCBvZmZzZXQsIGxpbmUsIGNvbHVtbikge1xuICAgIHZhciBlcnJvciA9IGNyZWF0ZUN1c3RvbUVycm9yKCdTeW50YXhFcnJvcicsIG1lc3NhZ2UpO1xuXG4gICAgZXJyb3Iuc291cmNlID0gc291cmNlO1xuICAgIGVycm9yLm9mZnNldCA9IG9mZnNldDtcbiAgICBlcnJvci5saW5lID0gbGluZTtcbiAgICBlcnJvci5jb2x1bW4gPSBjb2x1bW47XG5cbiAgICBlcnJvci5zb3VyY2VGcmFnbWVudCA9IGZ1bmN0aW9uKGV4dHJhTGluZXMpIHtcbiAgICAgICAgcmV0dXJuIHNvdXJjZUZyYWdtZW50KGVycm9yLCBpc05hTihleHRyYUxpbmVzKSA/IDAgOiBleHRyYUxpbmVzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlcnJvciwgJ2Zvcm1hdHRlZE1lc3NhZ2UnLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICdQYXJzZSBlcnJvcjogJyArIGVycm9yLm1lc3NhZ2UgKyAnXFxuJyArXG4gICAgICAgICAgICAgICAgc291cmNlRnJhZ21lbnQoZXJyb3IsIDIpXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBmb3IgYmFja3dhcmQgY2FwYWJpbGl0eVxuICAgIGVycm9yLnBhcnNlRXJyb3IgPSB7XG4gICAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgICBsaW5lOiBsaW5lLFxuICAgICAgICBjb2x1bW46IGNvbHVtblxuICAgIH07XG5cbiAgICByZXR1cm4gZXJyb3I7XG59O1xuXG52YXIgX1N5bnRheEVycm9yID0gU3ludGF4RXJyb3IkMTtcblxuLy9cbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdFxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSQXG4vLyAgICAgICAgICAgICDilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLzilIBoZWFkIOKUglxuLy8gICAgICAgICAgICAg4pSCICAgICAgICAgICAgICDilIIgdGFpbOKUgOKUvOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxuLy8gICAgICAgICAgICAg4pSCICAgICAgICAgICAgICDilJTilIDilIDilIDilIDilIDilIDilJggICAgICAgICAgICAgIOKUglxuLy8gICAgICAgICAgICAg4pa8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4pa8XG4vLyAgICAgICAgICAgIGl0ZW0gICAgICAgIGl0ZW0gICAgICAgIGl0ZW0gICAgICAgIGl0ZW1cbi8vICAgICAgICAgIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUkCAgICDilIzilIDilIDilIDilIDilIDilIDilJAgICAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSQICAgIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxuLy8gIG51bGwg4peA4pSA4pSA4pS84pSAcHJldiDilILil4DilIDilIDilIDilLzilIBwcmV2IOKUguKXgOKUgOKUgOKUgOKUvOKUgHByZXYg4pSC4peA4pSA4pSA4pSA4pS84pSAcHJldiDilIJcbi8vICAgICAgICAgIOKUgiBuZXh04pSA4pS84pSA4pSA4pSA4pa24pSCIG5leHTilIDilLzilIDilIDilIDilrbilIIgbmV4dOKUgOKUvOKUgOKUgOKUgOKWtuKUgiBuZXh04pSA4pS84pSA4pSA4pa2IG51bGxcbi8vICAgICAgICAgIOKUnOKUgOKUgOKUgOKUgOKUgOKUgOKUpCAgICDilJzilIDilIDilIDilIDilIDilIDilKQgICAg4pSc4pSA4pSA4pSA4pSA4pSA4pSA4pSkICAgIOKUnOKUgOKUgOKUgOKUgOKUgOKUgOKUpFxuLy8gICAgICAgICAg4pSCIGRhdGEg4pSCICAgIOKUgiBkYXRhIOKUgiAgICDilIIgZGF0YSDilIIgICAg4pSCIGRhdGEg4pSCXG4vLyAgICAgICAgICDilJTilIDilIDilIDilIDilIDilIDilJggICAg4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSYICAgIOKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUmCAgICDilJTilIDilIDilIDilIDilIDilIDilJhcbi8vXG5cbmZ1bmN0aW9uIGNyZWF0ZUl0ZW0oZGF0YSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHByZXY6IG51bGwsXG4gICAgICAgIG5leHQ6IG51bGwsXG4gICAgICAgIGRhdGE6IGRhdGFcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBhbGxvY2F0ZUN1cnNvcihub2RlLCBwcmV2LCBuZXh0KSB7XG4gICAgdmFyIGN1cnNvcjtcblxuICAgIGlmIChjdXJzb3JzICE9PSBudWxsKSB7XG4gICAgICAgIGN1cnNvciA9IGN1cnNvcnM7XG4gICAgICAgIGN1cnNvcnMgPSBjdXJzb3JzLmN1cnNvcjtcbiAgICAgICAgY3Vyc29yLnByZXYgPSBwcmV2O1xuICAgICAgICBjdXJzb3IubmV4dCA9IG5leHQ7XG4gICAgICAgIGN1cnNvci5jdXJzb3IgPSBub2RlLmN1cnNvcjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjdXJzb3IgPSB7XG4gICAgICAgICAgICBwcmV2OiBwcmV2LFxuICAgICAgICAgICAgbmV4dDogbmV4dCxcbiAgICAgICAgICAgIGN1cnNvcjogbm9kZS5jdXJzb3JcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBub2RlLmN1cnNvciA9IGN1cnNvcjtcblxuICAgIHJldHVybiBjdXJzb3I7XG59XG5cbmZ1bmN0aW9uIHJlbGVhc2VDdXJzb3Iobm9kZSkge1xuICAgIHZhciBjdXJzb3IgPSBub2RlLmN1cnNvcjtcblxuICAgIG5vZGUuY3Vyc29yID0gY3Vyc29yLmN1cnNvcjtcbiAgICBjdXJzb3IucHJldiA9IG51bGw7XG4gICAgY3Vyc29yLm5leHQgPSBudWxsO1xuICAgIGN1cnNvci5jdXJzb3IgPSBjdXJzb3JzO1xuICAgIGN1cnNvcnMgPSBjdXJzb3I7XG59XG5cbnZhciBjdXJzb3JzID0gbnVsbDtcbnZhciBMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5jdXJzb3IgPSBudWxsO1xuICAgIHRoaXMuaGVhZCA9IG51bGw7XG4gICAgdGhpcy50YWlsID0gbnVsbDtcbn07XG5cbkxpc3QuY3JlYXRlSXRlbSA9IGNyZWF0ZUl0ZW07XG5MaXN0LnByb3RvdHlwZS5jcmVhdGVJdGVtID0gY3JlYXRlSXRlbTtcblxuTGlzdC5wcm90b3R5cGUudXBkYXRlQ3Vyc29ycyA9IGZ1bmN0aW9uKHByZXZPbGQsIHByZXZOZXcsIG5leHRPbGQsIG5leHROZXcpIHtcbiAgICB2YXIgY3Vyc29yID0gdGhpcy5jdXJzb3I7XG5cbiAgICB3aGlsZSAoY3Vyc29yICE9PSBudWxsKSB7XG4gICAgICAgIGlmIChjdXJzb3IucHJldiA9PT0gcHJldk9sZCkge1xuICAgICAgICAgICAgY3Vyc29yLnByZXYgPSBwcmV2TmV3O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGN1cnNvci5uZXh0ID09PSBuZXh0T2xkKSB7XG4gICAgICAgICAgICBjdXJzb3IubmV4dCA9IG5leHROZXc7XG4gICAgICAgIH1cblxuICAgICAgICBjdXJzb3IgPSBjdXJzb3IuY3Vyc29yO1xuICAgIH1cbn07XG5cbkxpc3QucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2l6ZSA9IDA7XG4gICAgdmFyIGN1cnNvciA9IHRoaXMuaGVhZDtcblxuICAgIHdoaWxlIChjdXJzb3IpIHtcbiAgICAgICAgc2l6ZSsrO1xuICAgICAgICBjdXJzb3IgPSBjdXJzb3IubmV4dDtcbiAgICB9XG5cbiAgICByZXR1cm4gc2l6ZTtcbn07XG5cbkxpc3QucHJvdG90eXBlLmZyb21BcnJheSA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgdmFyIGN1cnNvciA9IG51bGw7XG5cbiAgICB0aGlzLmhlYWQgPSBudWxsO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgaXRlbSA9IGNyZWF0ZUl0ZW0oYXJyYXlbaV0pO1xuXG4gICAgICAgIGlmIChjdXJzb3IgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGN1cnNvci5uZXh0ID0gaXRlbTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IGl0ZW07XG4gICAgICAgIH1cblxuICAgICAgICBpdGVtLnByZXYgPSBjdXJzb3I7XG4gICAgICAgIGN1cnNvciA9IGl0ZW07XG4gICAgfVxuXG4gICAgdGhpcy50YWlsID0gY3Vyc29yO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5MaXN0LnByb3RvdHlwZS50b0FycmF5ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGN1cnNvciA9IHRoaXMuaGVhZDtcbiAgICB2YXIgcmVzdWx0ID0gW107XG5cbiAgICB3aGlsZSAoY3Vyc29yKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKGN1cnNvci5kYXRhKTtcbiAgICAgICAgY3Vyc29yID0gY3Vyc29yLm5leHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbkxpc3QucHJvdG90eXBlLnRvSlNPTiA9IExpc3QucHJvdG90eXBlLnRvQXJyYXk7XG5cbkxpc3QucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5oZWFkID09PSBudWxsO1xufTtcblxuTGlzdC5wcm90b3R5cGUuZmlyc3QgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5oZWFkICYmIHRoaXMuaGVhZC5kYXRhO1xufTtcblxuTGlzdC5wcm90b3R5cGUubGFzdCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnRhaWwgJiYgdGhpcy50YWlsLmRhdGE7XG59O1xuXG5MaXN0LnByb3RvdHlwZS5lYWNoID0gZnVuY3Rpb24oZm4sIGNvbnRleHQpIHtcbiAgICB2YXIgaXRlbTtcblxuICAgIGlmIChjb250ZXh0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29udGV4dCA9IHRoaXM7XG4gICAgfVxuXG4gICAgLy8gcHVzaCBjdXJzb3JcbiAgICB2YXIgY3Vyc29yID0gYWxsb2NhdGVDdXJzb3IodGhpcywgbnVsbCwgdGhpcy5oZWFkKTtcblxuICAgIHdoaWxlIChjdXJzb3IubmV4dCAhPT0gbnVsbCkge1xuICAgICAgICBpdGVtID0gY3Vyc29yLm5leHQ7XG4gICAgICAgIGN1cnNvci5uZXh0ID0gaXRlbS5uZXh0O1xuXG4gICAgICAgIGZuLmNhbGwoY29udGV4dCwgaXRlbS5kYXRhLCBpdGVtLCB0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBwb3AgY3Vyc29yXG4gICAgcmVsZWFzZUN1cnNvcih0aGlzKTtcbn07XG5cbkxpc3QucHJvdG90eXBlLmZvckVhY2ggPSBMaXN0LnByb3RvdHlwZS5lYWNoO1xuXG5MaXN0LnByb3RvdHlwZS5lYWNoUmlnaHQgPSBmdW5jdGlvbihmbiwgY29udGV4dCkge1xuICAgIHZhciBpdGVtO1xuXG4gICAgaWYgKGNvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb250ZXh0ID0gdGhpcztcbiAgICB9XG5cbiAgICAvLyBwdXNoIGN1cnNvclxuICAgIHZhciBjdXJzb3IgPSBhbGxvY2F0ZUN1cnNvcih0aGlzLCB0aGlzLnRhaWwsIG51bGwpO1xuXG4gICAgd2hpbGUgKGN1cnNvci5wcmV2ICE9PSBudWxsKSB7XG4gICAgICAgIGl0ZW0gPSBjdXJzb3IucHJldjtcbiAgICAgICAgY3Vyc29yLnByZXYgPSBpdGVtLnByZXY7XG5cbiAgICAgICAgZm4uY2FsbChjb250ZXh0LCBpdGVtLmRhdGEsIGl0ZW0sIHRoaXMpO1xuICAgIH1cblxuICAgIC8vIHBvcCBjdXJzb3JcbiAgICByZWxlYXNlQ3Vyc29yKHRoaXMpO1xufTtcblxuTGlzdC5wcm90b3R5cGUuZm9yRWFjaFJpZ2h0ID0gTGlzdC5wcm90b3R5cGUuZWFjaFJpZ2h0O1xuXG5MaXN0LnByb3RvdHlwZS5yZWR1Y2UgPSBmdW5jdGlvbihmbiwgaW5pdGlhbFZhbHVlLCBjb250ZXh0KSB7XG4gICAgdmFyIGl0ZW07XG5cbiAgICBpZiAoY29udGV4dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnRleHQgPSB0aGlzO1xuICAgIH1cblxuICAgIC8vIHB1c2ggY3Vyc29yXG4gICAgdmFyIGN1cnNvciA9IGFsbG9jYXRlQ3Vyc29yKHRoaXMsIG51bGwsIHRoaXMuaGVhZCk7XG4gICAgdmFyIGFjYyA9IGluaXRpYWxWYWx1ZTtcblxuICAgIHdoaWxlIChjdXJzb3IubmV4dCAhPT0gbnVsbCkge1xuICAgICAgICBpdGVtID0gY3Vyc29yLm5leHQ7XG4gICAgICAgIGN1cnNvci5uZXh0ID0gaXRlbS5uZXh0O1xuXG4gICAgICAgIGFjYyA9IGZuLmNhbGwoY29udGV4dCwgYWNjLCBpdGVtLmRhdGEsIGl0ZW0sIHRoaXMpO1xuICAgIH1cblxuICAgIC8vIHBvcCBjdXJzb3JcbiAgICByZWxlYXNlQ3Vyc29yKHRoaXMpO1xuXG4gICAgcmV0dXJuIGFjYztcbn07XG5cbkxpc3QucHJvdG90eXBlLnJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24oZm4sIGluaXRpYWxWYWx1ZSwgY29udGV4dCkge1xuICAgIHZhciBpdGVtO1xuXG4gICAgaWYgKGNvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb250ZXh0ID0gdGhpcztcbiAgICB9XG5cbiAgICAvLyBwdXNoIGN1cnNvclxuICAgIHZhciBjdXJzb3IgPSBhbGxvY2F0ZUN1cnNvcih0aGlzLCB0aGlzLnRhaWwsIG51bGwpO1xuICAgIHZhciBhY2MgPSBpbml0aWFsVmFsdWU7XG5cbiAgICB3aGlsZSAoY3Vyc29yLnByZXYgIT09IG51bGwpIHtcbiAgICAgICAgaXRlbSA9IGN1cnNvci5wcmV2O1xuICAgICAgICBjdXJzb3IucHJldiA9IGl0ZW0ucHJldjtcblxuICAgICAgICBhY2MgPSBmbi5jYWxsKGNvbnRleHQsIGFjYywgaXRlbS5kYXRhLCBpdGVtLCB0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBwb3AgY3Vyc29yXG4gICAgcmVsZWFzZUN1cnNvcih0aGlzKTtcblxuICAgIHJldHVybiBhY2M7XG59O1xuXG5MaXN0LnByb3RvdHlwZS5uZXh0VW50aWwgPSBmdW5jdGlvbihzdGFydCwgZm4sIGNvbnRleHQpIHtcbiAgICBpZiAoc3RhcnQgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBpdGVtO1xuXG4gICAgaWYgKGNvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb250ZXh0ID0gdGhpcztcbiAgICB9XG5cbiAgICAvLyBwdXNoIGN1cnNvclxuICAgIHZhciBjdXJzb3IgPSBhbGxvY2F0ZUN1cnNvcih0aGlzLCBudWxsLCBzdGFydCk7XG5cbiAgICB3aGlsZSAoY3Vyc29yLm5leHQgIT09IG51bGwpIHtcbiAgICAgICAgaXRlbSA9IGN1cnNvci5uZXh0O1xuICAgICAgICBjdXJzb3IubmV4dCA9IGl0ZW0ubmV4dDtcblxuICAgICAgICBpZiAoZm4uY2FsbChjb250ZXh0LCBpdGVtLmRhdGEsIGl0ZW0sIHRoaXMpKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIHBvcCBjdXJzb3JcbiAgICByZWxlYXNlQ3Vyc29yKHRoaXMpO1xufTtcblxuTGlzdC5wcm90b3R5cGUucHJldlVudGlsID0gZnVuY3Rpb24oc3RhcnQsIGZuLCBjb250ZXh0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgaXRlbTtcblxuICAgIGlmIChjb250ZXh0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29udGV4dCA9IHRoaXM7XG4gICAgfVxuXG4gICAgLy8gcHVzaCBjdXJzb3JcbiAgICB2YXIgY3Vyc29yID0gYWxsb2NhdGVDdXJzb3IodGhpcywgc3RhcnQsIG51bGwpO1xuXG4gICAgd2hpbGUgKGN1cnNvci5wcmV2ICE9PSBudWxsKSB7XG4gICAgICAgIGl0ZW0gPSBjdXJzb3IucHJldjtcbiAgICAgICAgY3Vyc29yLnByZXYgPSBpdGVtLnByZXY7XG5cbiAgICAgICAgaWYgKGZuLmNhbGwoY29udGV4dCwgaXRlbS5kYXRhLCBpdGVtLCB0aGlzKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBwb3AgY3Vyc29yXG4gICAgcmVsZWFzZUN1cnNvcih0aGlzKTtcbn07XG5cbkxpc3QucHJvdG90eXBlLnNvbWUgPSBmdW5jdGlvbihmbiwgY29udGV4dCkge1xuICAgIHZhciBjdXJzb3IgPSB0aGlzLmhlYWQ7XG5cbiAgICBpZiAoY29udGV4dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnRleHQgPSB0aGlzO1xuICAgIH1cblxuICAgIHdoaWxlIChjdXJzb3IgIT09IG51bGwpIHtcbiAgICAgICAgaWYgKGZuLmNhbGwoY29udGV4dCwgY3Vyc29yLmRhdGEsIGN1cnNvciwgdGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY3Vyc29yID0gY3Vyc29yLm5leHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuTGlzdC5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24oZm4sIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0ID0gbmV3IExpc3QoKTtcbiAgICB2YXIgY3Vyc29yID0gdGhpcy5oZWFkO1xuXG4gICAgaWYgKGNvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb250ZXh0ID0gdGhpcztcbiAgICB9XG5cbiAgICB3aGlsZSAoY3Vyc29yICE9PSBudWxsKSB7XG4gICAgICAgIHJlc3VsdC5hcHBlbmREYXRhKGZuLmNhbGwoY29udGV4dCwgY3Vyc29yLmRhdGEsIGN1cnNvciwgdGhpcykpO1xuICAgICAgICBjdXJzb3IgPSBjdXJzb3IubmV4dDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuTGlzdC5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24oZm4sIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0ID0gbmV3IExpc3QoKTtcbiAgICB2YXIgY3Vyc29yID0gdGhpcy5oZWFkO1xuXG4gICAgaWYgKGNvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb250ZXh0ID0gdGhpcztcbiAgICB9XG5cbiAgICB3aGlsZSAoY3Vyc29yICE9PSBudWxsKSB7XG4gICAgICAgIGlmIChmbi5jYWxsKGNvbnRleHQsIGN1cnNvci5kYXRhLCBjdXJzb3IsIHRoaXMpKSB7XG4gICAgICAgICAgICByZXN1bHQuYXBwZW5kRGF0YShjdXJzb3IuZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgY3Vyc29yID0gY3Vyc29yLm5leHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbkxpc3QucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5oZWFkID0gbnVsbDtcbiAgICB0aGlzLnRhaWwgPSBudWxsO1xufTtcblxuTGlzdC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciByZXN1bHQgPSBuZXcgTGlzdCgpO1xuICAgIHZhciBjdXJzb3IgPSB0aGlzLmhlYWQ7XG5cbiAgICB3aGlsZSAoY3Vyc29yICE9PSBudWxsKSB7XG4gICAgICAgIHJlc3VsdC5pbnNlcnQoY3JlYXRlSXRlbShjdXJzb3IuZGF0YSkpO1xuICAgICAgICBjdXJzb3IgPSBjdXJzb3IubmV4dDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuTGlzdC5wcm90b3R5cGUucHJlcGVuZCA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAvLyAgICAgIGhlYWRcbiAgICAvLyAgICBeXG4gICAgLy8gaXRlbVxuICAgIHRoaXMudXBkYXRlQ3Vyc29ycyhudWxsLCBpdGVtLCB0aGlzLmhlYWQsIGl0ZW0pO1xuXG4gICAgLy8gaW5zZXJ0IHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpc3RcbiAgICBpZiAodGhpcy5oZWFkICE9PSBudWxsKSB7XG4gICAgICAgIC8vIG5ldyBpdGVtIDwtIGZpcnN0IGl0ZW1cbiAgICAgICAgdGhpcy5oZWFkLnByZXYgPSBpdGVtO1xuXG4gICAgICAgIC8vIG5ldyBpdGVtIC0+IGZpcnN0IGl0ZW1cbiAgICAgICAgaXRlbS5uZXh0ID0gdGhpcy5oZWFkO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGlmIGxpc3QgaGFzIG5vIGhlYWQsIHRoZW4gaXQgYWxzbyBoYXMgbm8gdGFpbFxuICAgICAgICAvLyBpbiB0aGlzIGNhc2UgdGFpbCBwb2ludHMgdG8gdGhlIG5ldyBpdGVtXG4gICAgICAgIHRoaXMudGFpbCA9IGl0ZW07XG4gICAgfVxuXG4gICAgLy8gaGVhZCBhbHdheXMgcG9pbnRzIHRvIG5ldyBpdGVtXG4gICAgdGhpcy5oZWFkID0gaXRlbTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuTGlzdC5wcm90b3R5cGUucHJlcGVuZERhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgcmV0dXJuIHRoaXMucHJlcGVuZChjcmVhdGVJdGVtKGRhdGEpKTtcbn07XG5cbkxpc3QucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICByZXR1cm4gdGhpcy5pbnNlcnQoaXRlbSk7XG59O1xuXG5MaXN0LnByb3RvdHlwZS5hcHBlbmREYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHJldHVybiB0aGlzLmluc2VydChjcmVhdGVJdGVtKGRhdGEpKTtcbn07XG5cbkxpc3QucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uKGl0ZW0sIGJlZm9yZSkge1xuICAgIGlmIChiZWZvcmUgIT09IHVuZGVmaW5lZCAmJiBiZWZvcmUgIT09IG51bGwpIHtcbiAgICAgICAgLy8gcHJldiAgIGJlZm9yZVxuICAgICAgICAvLyAgICAgIF5cbiAgICAgICAgLy8gICAgIGl0ZW1cbiAgICAgICAgdGhpcy51cGRhdGVDdXJzb3JzKGJlZm9yZS5wcmV2LCBpdGVtLCBiZWZvcmUsIGl0ZW0pO1xuXG4gICAgICAgIGlmIChiZWZvcmUucHJldiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gaW5zZXJ0IHRvIHRoZSBiZWdpbm5pbmcgb2YgbGlzdFxuICAgICAgICAgICAgaWYgKHRoaXMuaGVhZCAhPT0gYmVmb3JlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdiZWZvcmUgZG9lc25cXCd0IGJlbG9uZyB0byBsaXN0Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHNpbmNlIGhlYWQgcG9pbnRzIHRvIGJlZm9yZSB0aGVyZWZvcmUgbGlzdCBkb2Vzbid0IGVtcHR5XG4gICAgICAgICAgICAvLyBubyBuZWVkIHRvIGNoZWNrIHRhaWxcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IGl0ZW07XG4gICAgICAgICAgICBiZWZvcmUucHJldiA9IGl0ZW07XG4gICAgICAgICAgICBpdGVtLm5leHQgPSBiZWZvcmU7XG5cbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ3Vyc29ycyhudWxsLCBpdGVtKTtcbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgLy8gaW5zZXJ0IGJldHdlZW4gdHdvIGl0ZW1zXG4gICAgICAgICAgICBiZWZvcmUucHJldi5uZXh0ID0gaXRlbTtcbiAgICAgICAgICAgIGl0ZW0ucHJldiA9IGJlZm9yZS5wcmV2O1xuXG4gICAgICAgICAgICBiZWZvcmUucHJldiA9IGl0ZW07XG4gICAgICAgICAgICBpdGVtLm5leHQgPSBiZWZvcmU7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyB0YWlsXG4gICAgICAgIC8vICAgICAgXlxuICAgICAgICAvLyAgICAgIGl0ZW1cbiAgICAgICAgdGhpcy51cGRhdGVDdXJzb3JzKHRoaXMudGFpbCwgaXRlbSwgbnVsbCwgaXRlbSk7XG5cbiAgICAgICAgLy8gaW5zZXJ0IHRvIHRoZSBlbmRpbmcgb2YgdGhlIGxpc3RcbiAgICAgICAgaWYgKHRoaXMudGFpbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gbGFzdCBpdGVtIC0+IG5ldyBpdGVtXG4gICAgICAgICAgICB0aGlzLnRhaWwubmV4dCA9IGl0ZW07XG5cbiAgICAgICAgICAgIC8vIGxhc3QgaXRlbSA8LSBuZXcgaXRlbVxuICAgICAgICAgICAgaXRlbS5wcmV2ID0gdGhpcy50YWlsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gaWYgbGlzdCBoYXMgbm8gdGFpbCwgdGhlbiBpdCBhbHNvIGhhcyBubyBoZWFkXG4gICAgICAgICAgICAvLyBpbiB0aGlzIGNhc2UgaGVhZCBwb2ludHMgdG8gbmV3IGl0ZW1cbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IGl0ZW07XG4gICAgICAgIH1cblxuICAgICAgICAvLyB0YWlsIGFsd2F5cyBwb2ludHMgdG8gbmV3IGl0ZW1cbiAgICAgICAgdGhpcy50YWlsID0gaXRlbTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbkxpc3QucHJvdG90eXBlLmluc2VydERhdGEgPSBmdW5jdGlvbihkYXRhLCBiZWZvcmUpIHtcbiAgICByZXR1cm4gdGhpcy5pbnNlcnQoY3JlYXRlSXRlbShkYXRhKSwgYmVmb3JlKTtcbn07XG5cbkxpc3QucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAvLyAgICAgIGl0ZW1cbiAgICAvLyAgICAgICBeXG4gICAgLy8gcHJldiAgICAgbmV4dFxuICAgIHRoaXMudXBkYXRlQ3Vyc29ycyhpdGVtLCBpdGVtLnByZXYsIGl0ZW0sIGl0ZW0ubmV4dCk7XG5cbiAgICBpZiAoaXRlbS5wcmV2ICE9PSBudWxsKSB7XG4gICAgICAgIGl0ZW0ucHJldi5uZXh0ID0gaXRlbS5uZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLmhlYWQgIT09IGl0ZW0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaXRlbSBkb2VzblxcJ3QgYmVsb25nIHRvIGxpc3QnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaGVhZCA9IGl0ZW0ubmV4dDtcbiAgICB9XG5cbiAgICBpZiAoaXRlbS5uZXh0ICE9PSBudWxsKSB7XG4gICAgICAgIGl0ZW0ubmV4dC5wcmV2ID0gaXRlbS5wcmV2O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLnRhaWwgIT09IGl0ZW0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaXRlbSBkb2VzblxcJ3QgYmVsb25nIHRvIGxpc3QnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudGFpbCA9IGl0ZW0ucHJldjtcbiAgICB9XG5cbiAgICBpdGVtLnByZXYgPSBudWxsO1xuICAgIGl0ZW0ubmV4dCA9IG51bGw7XG5cbiAgICByZXR1cm4gaXRlbTtcbn07XG5cbkxpc3QucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgdGhpcy5pbnNlcnQoY3JlYXRlSXRlbShkYXRhKSk7XG59O1xuXG5MaXN0LnByb3RvdHlwZS5wb3AgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy50YWlsICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZSh0aGlzLnRhaWwpO1xuICAgIH1cbn07XG5cbkxpc3QucHJvdG90eXBlLnVuc2hpZnQgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgdGhpcy5wcmVwZW5kKGNyZWF0ZUl0ZW0oZGF0YSkpO1xufTtcblxuTGlzdC5wcm90b3R5cGUuc2hpZnQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5oZWFkICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZSh0aGlzLmhlYWQpO1xuICAgIH1cbn07XG5cbkxpc3QucHJvdG90eXBlLnByZXBlbmRMaXN0ID0gZnVuY3Rpb24obGlzdCkge1xuICAgIHJldHVybiB0aGlzLmluc2VydExpc3QobGlzdCwgdGhpcy5oZWFkKTtcbn07XG5cbkxpc3QucHJvdG90eXBlLmFwcGVuZExpc3QgPSBmdW5jdGlvbihsaXN0KSB7XG4gICAgcmV0dXJuIHRoaXMuaW5zZXJ0TGlzdChsaXN0KTtcbn07XG5cbkxpc3QucHJvdG90eXBlLmluc2VydExpc3QgPSBmdW5jdGlvbihsaXN0LCBiZWZvcmUpIHtcbiAgICAvLyBpZ25vcmUgZW1wdHkgbGlzdHNcbiAgICBpZiAobGlzdC5oZWFkID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGlmIChiZWZvcmUgIT09IHVuZGVmaW5lZCAmJiBiZWZvcmUgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy51cGRhdGVDdXJzb3JzKGJlZm9yZS5wcmV2LCBsaXN0LnRhaWwsIGJlZm9yZSwgbGlzdC5oZWFkKTtcblxuICAgICAgICAvLyBpbnNlcnQgaW4gdGhlIG1pZGRsZSBvZiBkaXN0IGxpc3RcbiAgICAgICAgaWYgKGJlZm9yZS5wcmV2ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAvLyBiZWZvcmUucHJldiA8LT4gbGlzdC5oZWFkXG4gICAgICAgICAgICBiZWZvcmUucHJldi5uZXh0ID0gbGlzdC5oZWFkO1xuICAgICAgICAgICAgbGlzdC5oZWFkLnByZXYgPSBiZWZvcmUucHJldjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IGxpc3QuaGVhZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGJlZm9yZS5wcmV2ID0gbGlzdC50YWlsO1xuICAgICAgICBsaXN0LnRhaWwubmV4dCA9IGJlZm9yZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnVwZGF0ZUN1cnNvcnModGhpcy50YWlsLCBsaXN0LnRhaWwsIG51bGwsIGxpc3QuaGVhZCk7XG5cbiAgICAgICAgLy8gaW5zZXJ0IHRvIGVuZCBvZiB0aGUgbGlzdFxuICAgICAgICBpZiAodGhpcy50YWlsICE9PSBudWxsKSB7XG4gICAgICAgICAgICAvLyBpZiBkZXN0aW5hdGlvbiBsaXN0IGhhcyBhIHRhaWwsIHRoZW4gaXQgYWxzbyBoYXMgYSBoZWFkLFxuICAgICAgICAgICAgLy8gYnV0IGhlYWQgZG9lc24ndCBjaGFuZ2VcblxuICAgICAgICAgICAgLy8gZGVzdCB0YWlsIC0+IHNvdXJjZSBoZWFkXG4gICAgICAgICAgICB0aGlzLnRhaWwubmV4dCA9IGxpc3QuaGVhZDtcblxuICAgICAgICAgICAgLy8gZGVzdCB0YWlsIDwtIHNvdXJjZSBoZWFkXG4gICAgICAgICAgICBsaXN0LmhlYWQucHJldiA9IHRoaXMudGFpbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGlmIGxpc3QgaGFzIG5vIGEgdGFpbCwgdGhlbiBpdCBhbHNvIGhhcyBubyBhIGhlYWRcbiAgICAgICAgICAgIC8vIGluIHRoaXMgY2FzZSBwb2ludHMgaGVhZCB0byBuZXcgaXRlbVxuICAgICAgICAgICAgdGhpcy5oZWFkID0gbGlzdC5oZWFkO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdGFpbCBhbHdheXMgc3RhcnQgcG9pbnQgdG8gbmV3IGl0ZW1cbiAgICAgICAgdGhpcy50YWlsID0gbGlzdC50YWlsO1xuICAgIH1cblxuICAgIGxpc3QuaGVhZCA9IG51bGw7XG4gICAgbGlzdC50YWlsID0gbnVsbDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuTGlzdC5wcm90b3R5cGUucmVwbGFjZSA9IGZ1bmN0aW9uKG9sZEl0ZW0sIG5ld0l0ZW1Pckxpc3QpIHtcbiAgICBpZiAoJ2hlYWQnIGluIG5ld0l0ZW1Pckxpc3QpIHtcbiAgICAgICAgdGhpcy5pbnNlcnRMaXN0KG5ld0l0ZW1Pckxpc3QsIG9sZEl0ZW0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaW5zZXJ0KG5ld0l0ZW1Pckxpc3QsIG9sZEl0ZW0pO1xuICAgIH1cblxuICAgIHRoaXMucmVtb3ZlKG9sZEl0ZW0pO1xufTtcblxudmFyIExpc3RfMSA9IExpc3Q7XG5cbnZhciBUWVBFJDMgPSB0b2tlbml6ZXIuVFlQRTtcbnZhciBXSElURVNQQUNFJDEgPSBUWVBFJDMuV2hpdGVTcGFjZTtcbnZhciBDT01NRU5UJDEgPSBUWVBFJDMuQ29tbWVudDtcblxudmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gcmVhZFNlcXVlbmNlKHJlY29nbml6ZXIpIHtcbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNyZWF0ZUxpc3QoKTtcbiAgICB2YXIgY2hpbGQgPSBudWxsO1xuICAgIHZhciBjb250ZXh0ID0ge1xuICAgICAgICByZWNvZ25pemVyOiByZWNvZ25pemVyLFxuICAgICAgICBzcGFjZTogbnVsbCxcbiAgICAgICAgaWdub3JlV1M6IGZhbHNlLFxuICAgICAgICBpZ25vcmVXU0FmdGVyOiBmYWxzZVxuICAgIH07XG5cbiAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICB3aGlsZSAoIXRoaXMuc2Nhbm5lci5lb2YpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlKSB7XG4gICAgICAgICAgICBjYXNlIENPTU1FTlQkMTpcbiAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBjYXNlIFdISVRFU1BBQ0UkMTpcbiAgICAgICAgICAgICAgICBpZiAoY29udGV4dC5pZ25vcmVXUykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc3BhY2UgPSB0aGlzLldoaXRlU3BhY2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBjaGlsZCA9IHJlY29nbml6ZXIuZ2V0Tm9kZS5jYWxsKHRoaXMsIGNvbnRleHQpO1xuXG4gICAgICAgIGlmIChjaGlsZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb250ZXh0LnNwYWNlICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGNvbnRleHQuc3BhY2UpO1xuICAgICAgICAgICAgY29udGV4dC5zcGFjZSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjaGlsZHJlbi5wdXNoKGNoaWxkKTtcblxuICAgICAgICBpZiAoY29udGV4dC5pZ25vcmVXU0FmdGVyKSB7XG4gICAgICAgICAgICBjb250ZXh0Lmlnbm9yZVdTQWZ0ZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnRleHQuaWdub3JlV1MgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dC5pZ25vcmVXUyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoaWxkcmVuO1xufTtcblxudmFyIHsgZmluZFdoaXRlU3BhY2VTdGFydDogZmluZFdoaXRlU3BhY2VTdGFydCQxLCBjbXBTdHI6IGNtcFN0ciQzIH0gPSB1dGlscztcblxudmFyIG5vb3AgPSBmdW5jdGlvbigpIHt9O1xuXG52YXIgVFlQRSQ0ID0gX2NvbnN0LlRZUEU7XG52YXIgTkFNRSQyID0gX2NvbnN0Lk5BTUU7XG52YXIgV0hJVEVTUEFDRSQyID0gVFlQRSQ0LldoaXRlU3BhY2U7XG52YXIgQ09NTUVOVCQyID0gVFlQRSQ0LkNvbW1lbnQ7XG52YXIgSURFTlQgPSBUWVBFJDQuSWRlbnQ7XG52YXIgRlVOQ1RJT04gPSBUWVBFJDQuRnVuY3Rpb247XG52YXIgVVJMJDEgPSBUWVBFJDQuVXJsO1xudmFyIEhBU0ggPSBUWVBFJDQuSGFzaDtcbnZhciBQRVJDRU5UQUdFID0gVFlQRSQ0LlBlcmNlbnRhZ2U7XG52YXIgTlVNQkVSID0gVFlQRSQ0Lk51bWJlcjtcbnZhciBOVU1CRVJTSUdOID0gMHgwMDIzOyAvLyBVKzAwMjMgTlVNQkVSIFNJR04gKCMpXG52YXIgTlVMTCA9IDA7XG5cbmZ1bmN0aW9uIGNyZWF0ZVBhcnNlQ29udGV4dChuYW1lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpc1tuYW1lXSgpO1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NDb25maWcoY29uZmlnKSB7XG4gICAgdmFyIHBhcnNlckNvbmZpZyA9IHtcbiAgICAgICAgY29udGV4dDoge30sXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgYXRydWxlOiB7fSxcbiAgICAgICAgcHNldWRvOiB7fVxuICAgIH07XG5cbiAgICBpZiAoY29uZmlnLnBhcnNlQ29udGV4dCkge1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIGNvbmZpZy5wYXJzZUNvbnRleHQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZW9mIGNvbmZpZy5wYXJzZUNvbnRleHRbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICBjYXNlICdmdW5jdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlckNvbmZpZy5jb250ZXh0W25hbWVdID0gY29uZmlnLnBhcnNlQ29udGV4dFtuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgICAgICAgICBwYXJzZXJDb25maWcuY29udGV4dFtuYW1lXSA9IGNyZWF0ZVBhcnNlQ29udGV4dChjb25maWcucGFyc2VDb250ZXh0W25hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLnNjb3BlKSB7XG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gY29uZmlnLnNjb3BlKSB7XG4gICAgICAgICAgICBwYXJzZXJDb25maWcuc2NvcGVbbmFtZV0gPSBjb25maWcuc2NvcGVbbmFtZV07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLmF0cnVsZSkge1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIGNvbmZpZy5hdHJ1bGUpIHtcbiAgICAgICAgICAgIHZhciBhdHJ1bGUgPSBjb25maWcuYXRydWxlW25hbWVdO1xuXG4gICAgICAgICAgICBpZiAoYXRydWxlLnBhcnNlKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VyQ29uZmlnLmF0cnVsZVtuYW1lXSA9IGF0cnVsZS5wYXJzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjb25maWcucHNldWRvKSB7XG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gY29uZmlnLnBzZXVkbykge1xuICAgICAgICAgICAgdmFyIHBzZXVkbyA9IGNvbmZpZy5wc2V1ZG9bbmFtZV07XG5cbiAgICAgICAgICAgIGlmIChwc2V1ZG8ucGFyc2UpIHtcbiAgICAgICAgICAgICAgICBwYXJzZXJDb25maWcucHNldWRvW25hbWVdID0gcHNldWRvLnBhcnNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5ub2RlKSB7XG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gY29uZmlnLm5vZGUpIHtcbiAgICAgICAgICAgIHBhcnNlckNvbmZpZ1tuYW1lXSA9IGNvbmZpZy5ub2RlW25hbWVdLnBhcnNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcnNlckNvbmZpZztcbn1cblxudmFyIGNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZVBhcnNlcihjb25maWcpIHtcbiAgICB2YXIgcGFyc2VyID0ge1xuICAgICAgICBzY2FubmVyOiBuZXcgVG9rZW5TdHJlYW1fMSgpLFxuICAgICAgICBsb2NhdGlvbk1hcDogbmV3IE9mZnNldFRvTG9jYXRpb25fMSgpLFxuXG4gICAgICAgIGZpbGVuYW1lOiAnPHVua25vd24+JyxcbiAgICAgICAgbmVlZFBvc2l0aW9uczogZmFsc2UsXG4gICAgICAgIG9uUGFyc2VFcnJvcjogbm9vcCxcbiAgICAgICAgb25QYXJzZUVycm9yVGhyb3c6IGZhbHNlLFxuICAgICAgICBwYXJzZUF0cnVsZVByZWx1ZGU6IHRydWUsXG4gICAgICAgIHBhcnNlUnVsZVByZWx1ZGU6IHRydWUsXG4gICAgICAgIHBhcnNlVmFsdWU6IHRydWUsXG4gICAgICAgIHBhcnNlQ3VzdG9tUHJvcGVydHk6IGZhbHNlLFxuXG4gICAgICAgIHJlYWRTZXF1ZW5jZTogc2VxdWVuY2UsXG5cbiAgICAgICAgY3JlYXRlTGlzdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IExpc3RfMSgpO1xuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVTaW5nbGVOb2RlTGlzdDogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBMaXN0XzEoKS5hcHBlbmREYXRhKG5vZGUpO1xuICAgICAgICB9LFxuICAgICAgICBnZXRGaXJzdExpc3ROb2RlOiBmdW5jdGlvbihsaXN0KSB7XG4gICAgICAgICAgICByZXR1cm4gbGlzdCAmJiBsaXN0LmZpcnN0KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldExhc3RMaXN0Tm9kZTogZnVuY3Rpb24obGlzdCkge1xuICAgICAgICAgICAgcmV0dXJuIGxpc3QubGFzdCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHBhcnNlV2l0aEZhbGxiYWNrOiBmdW5jdGlvbihjb25zdW1lciwgZmFsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciBzdGFydFRva2VuID0gdGhpcy5zY2FubmVyLnRva2VuSW5kZXg7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN1bWVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub25QYXJzZUVycm9yVGhyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgZmFsbGJhY2tOb2RlID0gZmFsbGJhY2suY2FsbCh0aGlzLCBzdGFydFRva2VuKTtcblxuICAgICAgICAgICAgICAgIHRoaXMub25QYXJzZUVycm9yVGhyb3cgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMub25QYXJzZUVycm9yKGUsIGZhbGxiYWNrTm9kZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblBhcnNlRXJyb3JUaHJvdyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbGxiYWNrTm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBsb29rdXBOb25XU1R5cGU6IGZ1bmN0aW9uKG9mZnNldCkge1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIHZhciB0eXBlID0gdGhpcy5zY2FubmVyLmxvb2t1cFR5cGUob2Zmc2V0KyspO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlICE9PSBXSElURVNQQUNFJDIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR5cGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHlwZSAhPT0gTlVMTCk7XG5cbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9LFxuXG4gICAgICAgIGVhdDogZnVuY3Rpb24odG9rZW5UeXBlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuVHlwZSAhPT0gdG9rZW5UeXBlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gTkFNRSQyW3Rva2VuVHlwZV0gKyAnIGlzIGV4cGVjdGVkJztcblxuICAgICAgICAgICAgICAgIC8vIHR3ZWFrIG1lc3NhZ2UgYW5kIG9mZnNldFxuICAgICAgICAgICAgICAgIHN3aXRjaCAodG9rZW5UeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgSURFTlQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3aGVuIGlkZW50aWZpZXIgaXMgZXhwZWN0ZWQgYnV0IHRoZXJlIGlzIGEgZnVuY3Rpb24gb3IgdXJsXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuVHlwZSA9PT0gRlVOQ1RJT04gfHwgdGhpcy5zY2FubmVyLnRva2VuVHlwZSA9PT0gVVJMJDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSB0aGlzLnNjYW5uZXIudG9rZW5FbmQgLSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAnSWRlbnRpZmllciBpcyBleHBlY3RlZCBidXQgZnVuY3Rpb24gZm91bmQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gJ0lkZW50aWZpZXIgaXMgZXhwZWN0ZWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBIQVNIOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci5pc0RlbGltKE5VTUJFUlNJR04pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gJ05hbWUgaXMgZXhwZWN0ZWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBQRVJDRU5UQUdFOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgPT09IE5VTUJFUikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IHRoaXMuc2Nhbm5lci50b2tlbkVuZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gJ1BlcmNlbnQgc2lnbiBpcyBleHBlY3RlZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiB0ZXN0IHR5cGUgaXMgcGFydCBvZiBhbm90aGVyIHRva2VuIHNob3cgZXJyb3IgZm9yIGN1cnJlbnQgcG9zaXRpb24gKyAxXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlLmcuIGVhdChIWVBIRU5NSU5VUykgd2lsbCBmYWlsIG9uIFwiLWZvb1wiLCBidXQgcG9pbnRpbmcgb24gXCItXCIgaXMgb2RkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zY2FubmVyLnNvdXJjZS5jaGFyQ29kZUF0KHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSA9PT0gdG9rZW5UeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yKG1lc3NhZ2UsIG9mZnNldCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY29uc3VtZTogZnVuY3Rpb24odG9rZW5UeXBlKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLnNjYW5uZXIuZ2V0VG9rZW5WYWx1ZSgpO1xuXG4gICAgICAgICAgICB0aGlzLmVhdCh0b2tlblR5cGUpO1xuXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnN1bWVGdW5jdGlvbk5hbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG5hbWUgPSB0aGlzLnNjYW5uZXIuc291cmNlLnN1YnN0cmluZyh0aGlzLnNjYW5uZXIudG9rZW5TdGFydCwgdGhpcy5zY2FubmVyLnRva2VuRW5kIC0gMSk7XG5cbiAgICAgICAgICAgIHRoaXMuZWF0KEZVTkNUSU9OKTtcblxuICAgICAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0TG9jYXRpb246IGZ1bmN0aW9uKHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5lZWRQb3NpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhdGlvbk1hcC5nZXRMb2NhdGlvblJhbmdlKFxuICAgICAgICAgICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgICAgICAgICAgZW5kLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVuYW1lXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGdldExvY2F0aW9uRnJvbUxpc3Q6IGZ1bmN0aW9uKGxpc3QpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5lZWRQb3NpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZCA9IHRoaXMuZ2V0Rmlyc3RMaXN0Tm9kZShsaXN0KTtcbiAgICAgICAgICAgICAgICB2YXIgdGFpbCA9IHRoaXMuZ2V0TGFzdExpc3ROb2RlKGxpc3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2F0aW9uTWFwLmdldExvY2F0aW9uUmFuZ2UoXG4gICAgICAgICAgICAgICAgICAgIGhlYWQgIT09IG51bGwgPyBoZWFkLmxvYy5zdGFydC5vZmZzZXQgLSB0aGlzLmxvY2F0aW9uTWFwLnN0YXJ0T2Zmc2V0IDogdGhpcy5zY2FubmVyLnRva2VuU3RhcnQsXG4gICAgICAgICAgICAgICAgICAgIHRhaWwgIT09IG51bGwgPyB0YWlsLmxvYy5lbmQub2Zmc2V0IC0gdGhpcy5sb2NhdGlvbk1hcC5zdGFydE9mZnNldCA6IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVuYW1lXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1lc3NhZ2UsIG9mZnNldCkge1xuICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gdHlwZW9mIG9mZnNldCAhPT0gJ3VuZGVmaW5lZCcgJiYgb2Zmc2V0IDwgdGhpcy5zY2FubmVyLnNvdXJjZS5sZW5ndGhcbiAgICAgICAgICAgICAgICA/IHRoaXMubG9jYXRpb25NYXAuZ2V0TG9jYXRpb24ob2Zmc2V0KVxuICAgICAgICAgICAgICAgIDogdGhpcy5zY2FubmVyLmVvZlxuICAgICAgICAgICAgICAgICAgICA/IHRoaXMubG9jYXRpb25NYXAuZ2V0TG9jYXRpb24oZmluZFdoaXRlU3BhY2VTdGFydCQxKHRoaXMuc2Nhbm5lci5zb3VyY2UsIHRoaXMuc2Nhbm5lci5zb3VyY2UubGVuZ3RoIC0gMSkpXG4gICAgICAgICAgICAgICAgICAgIDogdGhpcy5sb2NhdGlvbk1hcC5nZXRMb2NhdGlvbih0aGlzLnNjYW5uZXIudG9rZW5TdGFydCk7XG5cbiAgICAgICAgICAgIHRocm93IG5ldyBfU3ludGF4RXJyb3IoXG4gICAgICAgICAgICAgICAgbWVzc2FnZSB8fCAnVW5leHBlY3RlZCBpbnB1dCcsXG4gICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLnNvdXJjZSxcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5vZmZzZXQsXG4gICAgICAgICAgICAgICAgbG9jYXRpb24ubGluZSxcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5jb2x1bW5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uZmlnID0gcHJvY2Vzc0NvbmZpZyhjb25maWcgfHwge30pO1xuICAgIGZvciAodmFyIGtleSBpbiBjb25maWcpIHtcbiAgICAgICAgcGFyc2VyW2tleV0gPSBjb25maWdba2V5XTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24oc291cmNlLCBvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAgIHZhciBjb250ZXh0ID0gb3B0aW9ucy5jb250ZXh0IHx8ICdkZWZhdWx0JztcbiAgICAgICAgdmFyIG9uQ29tbWVudCA9IG9wdGlvbnMub25Db21tZW50O1xuICAgICAgICB2YXIgYXN0O1xuXG4gICAgICAgIHRva2VuaXplcihzb3VyY2UsIHBhcnNlci5zY2FubmVyKTtcbiAgICAgICAgcGFyc2VyLmxvY2F0aW9uTWFwLnNldFNvdXJjZShcbiAgICAgICAgICAgIHNvdXJjZSxcbiAgICAgICAgICAgIG9wdGlvbnMub2Zmc2V0LFxuICAgICAgICAgICAgb3B0aW9ucy5saW5lLFxuICAgICAgICAgICAgb3B0aW9ucy5jb2x1bW5cbiAgICAgICAgKTtcblxuICAgICAgICBwYXJzZXIuZmlsZW5hbWUgPSBvcHRpb25zLmZpbGVuYW1lIHx8ICc8dW5rbm93bj4nO1xuICAgICAgICBwYXJzZXIubmVlZFBvc2l0aW9ucyA9IEJvb2xlYW4ob3B0aW9ucy5wb3NpdGlvbnMpO1xuICAgICAgICBwYXJzZXIub25QYXJzZUVycm9yID0gdHlwZW9mIG9wdGlvbnMub25QYXJzZUVycm9yID09PSAnZnVuY3Rpb24nID8gb3B0aW9ucy5vblBhcnNlRXJyb3IgOiBub29wO1xuICAgICAgICBwYXJzZXIub25QYXJzZUVycm9yVGhyb3cgPSBmYWxzZTtcbiAgICAgICAgcGFyc2VyLnBhcnNlQXRydWxlUHJlbHVkZSA9ICdwYXJzZUF0cnVsZVByZWx1ZGUnIGluIG9wdGlvbnMgPyBCb29sZWFuKG9wdGlvbnMucGFyc2VBdHJ1bGVQcmVsdWRlKSA6IHRydWU7XG4gICAgICAgIHBhcnNlci5wYXJzZVJ1bGVQcmVsdWRlID0gJ3BhcnNlUnVsZVByZWx1ZGUnIGluIG9wdGlvbnMgPyBCb29sZWFuKG9wdGlvbnMucGFyc2VSdWxlUHJlbHVkZSkgOiB0cnVlO1xuICAgICAgICBwYXJzZXIucGFyc2VWYWx1ZSA9ICdwYXJzZVZhbHVlJyBpbiBvcHRpb25zID8gQm9vbGVhbihvcHRpb25zLnBhcnNlVmFsdWUpIDogdHJ1ZTtcbiAgICAgICAgcGFyc2VyLnBhcnNlQ3VzdG9tUHJvcGVydHkgPSAncGFyc2VDdXN0b21Qcm9wZXJ0eScgaW4gb3B0aW9ucyA/IEJvb2xlYW4ob3B0aW9ucy5wYXJzZUN1c3RvbVByb3BlcnR5KSA6IGZhbHNlO1xuXG4gICAgICAgIGlmICghcGFyc2VyLmNvbnRleHQuaGFzT3duUHJvcGVydHkoY29udGV4dCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBjb250ZXh0IGAnICsgY29udGV4dCArICdgJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIG9uQ29tbWVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcGFyc2VyLnNjYW5uZXIuZm9yRWFjaFRva2VuKCh0eXBlLCBzdGFydCwgZW5kKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09IENPTU1FTlQkMikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsb2MgPSBwYXJzZXIuZ2V0TG9jYXRpb24oc3RhcnQsIGVuZCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gY21wU3RyJDMoc291cmNlLCBlbmQgLSAyLCBlbmQsICcqLycpXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNvdXJjZS5zbGljZShzdGFydCArIDIsIGVuZCAtIDIpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHNvdXJjZS5zbGljZShzdGFydCArIDIsIGVuZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgb25Db21tZW50KHZhbHVlLCBsb2MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgYXN0ID0gcGFyc2VyLmNvbnRleHRbY29udGV4dF0uY2FsbChwYXJzZXIsIG9wdGlvbnMpO1xuXG4gICAgICAgIGlmICghcGFyc2VyLnNjYW5uZXIuZW9mKSB7XG4gICAgICAgICAgICBwYXJzZXIuZXJyb3IoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhc3Q7XG4gICAgfTtcbn07XG5cbnZhciBjbXBDaGFyJDEgPSB0b2tlbml6ZXIuY21wQ2hhcjtcbnZhciBjbXBTdHIkNCA9IHRva2VuaXplci5jbXBTdHI7XG52YXIgVFlQRSQ1ID0gdG9rZW5pemVyLlRZUEU7XG5cbnZhciBJREVOVCQxID0gVFlQRSQ1LklkZW50O1xudmFyIFNUUklORyA9IFRZUEUkNS5TdHJpbmc7XG52YXIgTlVNQkVSJDEgPSBUWVBFJDUuTnVtYmVyO1xudmFyIEZVTkNUSU9OJDEgPSBUWVBFJDUuRnVuY3Rpb247XG52YXIgVVJMJDIgPSBUWVBFJDUuVXJsO1xudmFyIEhBU0gkMSA9IFRZUEUkNS5IYXNoO1xudmFyIERJTUVOU0lPTiA9IFRZUEUkNS5EaW1lbnNpb247XG52YXIgUEVSQ0VOVEFHRSQxID0gVFlQRSQ1LlBlcmNlbnRhZ2U7XG52YXIgTEVGVFBBUkVOVEhFU0lTID0gVFlQRSQ1LkxlZnRQYXJlbnRoZXNpcztcbnZhciBMRUZUU1FVQVJFQlJBQ0tFVCA9IFRZUEUkNS5MZWZ0U3F1YXJlQnJhY2tldDtcbnZhciBDT01NQSA9IFRZUEUkNS5Db21tYTtcbnZhciBERUxJTSA9IFRZUEUkNS5EZWxpbTtcbnZhciBOVU1CRVJTSUdOJDEgPSAweDAwMjM7ICAvLyBVKzAwMjMgTlVNQkVSIFNJR04gKCMpXG52YXIgQVNURVJJU0sgPSAweDAwMkE7ICAgIC8vIFUrMDAyQSBBU1RFUklTSyAoKilcbnZhciBQTFVTU0lHTiA9IDB4MDAyQjsgICAgLy8gVSswMDJCIFBMVVMgU0lHTiAoKylcbnZhciBIWVBIRU5NSU5VUyA9IDB4MDAyRDsgLy8gVSswMDJEIEhZUEhFTi1NSU5VUyAoLSlcbnZhciBTT0xJRFVTID0gMHgwMDJGOyAgICAgLy8gVSswMDJGIFNPTElEVVMgKC8pXG52YXIgVSA9IDB4MDA3NTsgICAgICAgICAgIC8vIFUrMDA3NSBMQVRJTiBTTUFMTCBMRVRURVIgVSAodSlcblxudmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gZGVmYXVsdFJlY29nbml6ZXIoY29udGV4dCkge1xuICAgIHN3aXRjaCAodGhpcy5zY2FubmVyLnRva2VuVHlwZSkge1xuICAgICAgICBjYXNlIEhBU0gkMTpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkhhc2goKTtcblxuICAgICAgICBjYXNlIENPTU1BOlxuICAgICAgICAgICAgY29udGV4dC5zcGFjZSA9IG51bGw7XG4gICAgICAgICAgICBjb250ZXh0Lmlnbm9yZVdTQWZ0ZXIgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuT3BlcmF0b3IoKTtcblxuICAgICAgICBjYXNlIExFRlRQQVJFTlRIRVNJUzpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLlBhcmVudGhlc2VzKHRoaXMucmVhZFNlcXVlbmNlLCBjb250ZXh0LnJlY29nbml6ZXIpO1xuXG4gICAgICAgIGNhc2UgTEVGVFNRVUFSRUJSQUNLRVQ6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5CcmFja2V0cyh0aGlzLnJlYWRTZXF1ZW5jZSwgY29udGV4dC5yZWNvZ25pemVyKTtcblxuICAgICAgICBjYXNlIFNUUklORzpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLlN0cmluZygpO1xuXG4gICAgICAgIGNhc2UgRElNRU5TSU9OOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuRGltZW5zaW9uKCk7XG5cbiAgICAgICAgY2FzZSBQRVJDRU5UQUdFJDE6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5QZXJjZW50YWdlKCk7XG5cbiAgICAgICAgY2FzZSBOVU1CRVIkMTpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLk51bWJlcigpO1xuXG4gICAgICAgIGNhc2UgRlVOQ1RJT04kMTpcbiAgICAgICAgICAgIHJldHVybiBjbXBTdHIkNCh0aGlzLnNjYW5uZXIuc291cmNlLCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCwgdGhpcy5zY2FubmVyLnRva2VuRW5kLCAndXJsKCcpXG4gICAgICAgICAgICAgICAgPyB0aGlzLlVybCgpXG4gICAgICAgICAgICAgICAgOiB0aGlzLkZ1bmN0aW9uKHRoaXMucmVhZFNlcXVlbmNlLCBjb250ZXh0LnJlY29nbml6ZXIpO1xuXG4gICAgICAgIGNhc2UgVVJMJDI6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5VcmwoKTtcblxuICAgICAgICBjYXNlIElERU5UJDE6XG4gICAgICAgICAgICAvLyBjaGVjayBmb3IgdW5pY29kZSByYW5nZSwgaXQgc2hvdWxkIHN0YXJ0IHdpdGggdSsgb3IgVStcbiAgICAgICAgICAgIGlmIChjbXBDaGFyJDEodGhpcy5zY2FubmVyLnNvdXJjZSwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQsIFUpICYmXG4gICAgICAgICAgICAgICAgY21wQ2hhciQxKHRoaXMuc2Nhbm5lci5zb3VyY2UsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0ICsgMSwgUExVU1NJR04pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuVW5pY29kZVJhbmdlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLklkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICBjYXNlIERFTElNOlxuICAgICAgICAgICAgdmFyIGNvZGUgPSB0aGlzLnNjYW5uZXIuc291cmNlLmNoYXJDb2RlQXQodGhpcy5zY2FubmVyLnRva2VuU3RhcnQpO1xuXG4gICAgICAgICAgICBpZiAoY29kZSA9PT0gU09MSURVUyB8fFxuICAgICAgICAgICAgICAgIGNvZGUgPT09IEFTVEVSSVNLIHx8XG4gICAgICAgICAgICAgICAgY29kZSA9PT0gUExVU1NJR04gfHxcbiAgICAgICAgICAgICAgICBjb2RlID09PSBIWVBIRU5NSU5VUykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLk9wZXJhdG9yKCk7IC8vIFRPRE86IHJlcGxhY2Ugd2l0aCBEZWxpbVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUT0RPOiBwcm9kdWNlIGEgbm9kZSB3aXRoIERlbGltIG5vZGUgdHlwZVxuXG4gICAgICAgICAgICBpZiAoY29kZSA9PT0gTlVNQkVSU0lHTiQxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvcignSGV4IG9yIGlkZW50aWZpZXIgaXMgZXhwZWN0ZWQnLCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCArIDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG59O1xuXG52YXIgYXRydWxlUHJlbHVkZSA9IHtcbiAgICBnZXROb2RlOiBfZGVmYXVsdFxufTtcblxudmFyIFRZUEUkNiA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgREVMSU0kMSA9IFRZUEUkNi5EZWxpbTtcbnZhciBJREVOVCQyID0gVFlQRSQ2LklkZW50O1xudmFyIERJTUVOU0lPTiQxID0gVFlQRSQ2LkRpbWVuc2lvbjtcbnZhciBQRVJDRU5UQUdFJDIgPSBUWVBFJDYuUGVyY2VudGFnZTtcbnZhciBOVU1CRVIkMiA9IFRZUEUkNi5OdW1iZXI7XG52YXIgSEFTSCQyID0gVFlQRSQ2Lkhhc2g7XG52YXIgQ09MT04gPSBUWVBFJDYuQ29sb247XG52YXIgTEVGVFNRVUFSRUJSQUNLRVQkMSA9IFRZUEUkNi5MZWZ0U3F1YXJlQnJhY2tldDtcbnZhciBOVU1CRVJTSUdOJDIgPSAweDAwMjM7ICAgICAgLy8gVSswMDIzIE5VTUJFUiBTSUdOICgjKVxudmFyIEFTVEVSSVNLJDEgPSAweDAwMkE7ICAgICAgICAvLyBVKzAwMkEgQVNURVJJU0sgKCopXG52YXIgUExVU1NJR04kMSA9IDB4MDAyQjsgICAgICAgIC8vIFUrMDAyQiBQTFVTIFNJR04gKCspXG52YXIgU09MSURVUyQxID0gMHgwMDJGOyAgICAgICAgIC8vIFUrMDAyRiBTT0xJRFVTICgvKVxudmFyIEZVTExTVE9QID0gMHgwMDJFOyAgICAgICAgLy8gVSswMDJFIEZVTEwgU1RPUCAoLilcbnZhciBHUkVBVEVSVEhBTlNJR04gPSAweDAwM0U7IC8vIFUrMDAzRSBHUkVBVEVSLVRIQU4gU0lHTiAoPilcbnZhciBWRVJUSUNBTExJTkUgPSAweDAwN0M7ICAgIC8vIFUrMDA3QyBWRVJUSUNBTCBMSU5FICh8KVxudmFyIFRJTERFID0gMHgwMDdFOyAgICAgICAgICAgLy8gVSswMDdFIFRJTERFICh+KVxuXG5mdW5jdGlvbiBnZXROb2RlKGNvbnRleHQpIHtcbiAgICBzd2l0Y2ggKHRoaXMuc2Nhbm5lci50b2tlblR5cGUpIHtcbiAgICAgICAgY2FzZSBMRUZUU1FVQVJFQlJBQ0tFVCQxOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuQXR0cmlidXRlU2VsZWN0b3IoKTtcblxuICAgICAgICBjYXNlIEhBU0gkMjpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLklkU2VsZWN0b3IoKTtcblxuICAgICAgICBjYXNlIENPTE9OOlxuICAgICAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci5sb29rdXBUeXBlKDEpID09PSBDT0xPTikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLlBzZXVkb0VsZW1lbnRTZWxlY3RvcigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5Qc2V1ZG9DbGFzc1NlbGVjdG9yKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgY2FzZSBJREVOVCQyOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuVHlwZVNlbGVjdG9yKCk7XG5cbiAgICAgICAgY2FzZSBOVU1CRVIkMjpcbiAgICAgICAgY2FzZSBQRVJDRU5UQUdFJDI6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5QZXJjZW50YWdlKCk7XG5cbiAgICAgICAgY2FzZSBESU1FTlNJT04kMTpcbiAgICAgICAgICAgIC8vIHRocm93cyB3aGVuIC4xMjNpZGVudFxuICAgICAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLnNjYW5uZXIudG9rZW5TdGFydCkgPT09IEZVTExTVE9QKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvcignSWRlbnRpZmllciBpcyBleHBlY3RlZCcsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0ICsgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIERFTElNJDE6XG4gICAgICAgICAgICB2YXIgY29kZSA9IHRoaXMuc2Nhbm5lci5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLnNjYW5uZXIudG9rZW5TdGFydCk7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29kZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgUExVU1NJR04kMTpcbiAgICAgICAgICAgICAgICBjYXNlIEdSRUFURVJUSEFOU0lHTjpcbiAgICAgICAgICAgICAgICBjYXNlIFRJTERFOlxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNwYWNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5pZ25vcmVXU0FmdGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuQ29tYmluYXRvcigpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBTT0xJRFVTJDE6ICAvLyAvZGVlcC9cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuQ29tYmluYXRvcigpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBGVUxMU1RPUDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuQ2xhc3NTZWxlY3RvcigpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBBU1RFUklTSyQxOlxuICAgICAgICAgICAgICAgIGNhc2UgVkVSVElDQUxMSU5FOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5UeXBlU2VsZWN0b3IoKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgTlVNQkVSU0lHTiQyOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5JZFNlbGVjdG9yKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbnZhciBzZWxlY3RvciA9IHtcbiAgICBnZXROb2RlOiBnZXROb2RlXG59O1xuXG4vLyBsZWdhY3kgSUUgZnVuY3Rpb25cbi8vIGV4cHJlc3Npb24oIDxhbnktdmFsdWU+IClcbnZhciBleHByZXNzaW9uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU2luZ2xlTm9kZUxpc3QoXG4gICAgICAgIHRoaXMuUmF3KHRoaXMuc2Nhbm5lci50b2tlbkluZGV4LCBudWxsLCBmYWxzZSlcbiAgICApO1xufTtcblxudmFyIFRZUEUkNyA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgV2hpdGVTcGFjZSA9IFRZUEUkNy5XaGl0ZVNwYWNlO1xudmFyIFNlbWljb2xvbiA9IFRZUEUkNy5TZW1pY29sb247XG52YXIgTGVmdEN1cmx5QnJhY2tldCA9IFRZUEUkNy5MZWZ0Q3VybHlCcmFja2V0O1xudmFyIERlbGltID0gVFlQRSQ3LkRlbGltO1xudmFyIEVYQ0xBTUFUSU9OTUFSSyA9IDB4MDAyMTsgLy8gVSswMDIxIEVYQ0xBTUFUSU9OIE1BUksgKCEpXG5cbmZ1bmN0aW9uIGdldE9mZnNldEV4Y2x1ZGVXUygpIHtcbiAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuSW5kZXggPiAwKSB7XG4gICAgICAgIGlmICh0aGlzLnNjYW5uZXIubG9va3VwVHlwZSgtMSkgPT09IFdoaXRlU3BhY2UpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjYW5uZXIudG9rZW5JbmRleCA+IDFcbiAgICAgICAgICAgICAgICA/IHRoaXMuc2Nhbm5lci5nZXRUb2tlblN0YXJ0KHRoaXMuc2Nhbm5lci50b2tlbkluZGV4IC0gMSlcbiAgICAgICAgICAgICAgICA6IHRoaXMuc2Nhbm5lci5maXJzdENoYXJPZmZzZXQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG59XG5cbi8vIDAsIDAsIGZhbHNlXG5mdW5jdGlvbiBiYWxhbmNlRW5kKCkge1xuICAgIHJldHVybiAwO1xufVxuXG4vLyBMRUZUQ1VSTFlCUkFDS0VULCAwLCBmYWxzZVxuZnVuY3Rpb24gbGVmdEN1cmx5QnJhY2tldCh0b2tlblR5cGUpIHtcbiAgICByZXR1cm4gdG9rZW5UeXBlID09PSBMZWZ0Q3VybHlCcmFja2V0ID8gMSA6IDA7XG59XG5cbi8vIExFRlRDVVJMWUJSQUNLRVQsIFNFTUlDT0xPTiwgZmFsc2VcbmZ1bmN0aW9uIGxlZnRDdXJseUJyYWNrZXRPclNlbWljb2xvbih0b2tlblR5cGUpIHtcbiAgICByZXR1cm4gdG9rZW5UeXBlID09PSBMZWZ0Q3VybHlCcmFja2V0IHx8IHRva2VuVHlwZSA9PT0gU2VtaWNvbG9uID8gMSA6IDA7XG59XG5cbi8vIEVYQ0xBTUFUSU9OTUFSSywgU0VNSUNPTE9OLCBmYWxzZVxuZnVuY3Rpb24gZXhjbGFtYXRpb25NYXJrT3JTZW1pY29sb24odG9rZW5UeXBlLCBzb3VyY2UsIG9mZnNldCkge1xuICAgIGlmICh0b2tlblR5cGUgPT09IERlbGltICYmIHNvdXJjZS5jaGFyQ29kZUF0KG9mZnNldCkgPT09IEVYQ0xBTUFUSU9OTUFSSykge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG5cbiAgICByZXR1cm4gdG9rZW5UeXBlID09PSBTZW1pY29sb24gPyAxIDogMDtcbn1cblxuLy8gMCwgU0VNSUNPTE9OLCB0cnVlXG5mdW5jdGlvbiBzZW1pY29sb25JbmNsdWRlZCh0b2tlblR5cGUpIHtcbiAgICByZXR1cm4gdG9rZW5UeXBlID09PSBTZW1pY29sb24gPyAyIDogMDtcbn1cblxudmFyIFJhdyA9IHtcbiAgICBuYW1lOiAnUmF3JyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgdmFsdWU6IFN0cmluZ1xuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKHN0YXJ0VG9rZW4sIG1vZGUsIGV4Y2x1ZGVXaGl0ZVNwYWNlKSB7XG4gICAgICAgIHZhciBzdGFydE9mZnNldCA9IHRoaXMuc2Nhbm5lci5nZXRUb2tlblN0YXJ0KHN0YXJ0VG9rZW4pO1xuICAgICAgICB2YXIgZW5kT2Zmc2V0O1xuXG4gICAgICAgIHRoaXMuc2Nhbm5lci5za2lwKFxuICAgICAgICAgICAgdGhpcy5zY2FubmVyLmdldFJhd0xlbmd0aChzdGFydFRva2VuLCBtb2RlIHx8IGJhbGFuY2VFbmQpXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKGV4Y2x1ZGVXaGl0ZVNwYWNlICYmIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0ID4gc3RhcnRPZmZzZXQpIHtcbiAgICAgICAgICAgIGVuZE9mZnNldCA9IGdldE9mZnNldEV4Y2x1ZGVXUy5jYWxsKHRoaXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZW5kT2Zmc2V0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ1JhdycsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnRPZmZzZXQsIGVuZE9mZnNldCksXG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5zY2FubmVyLnNvdXJjZS5zdWJzdHJpbmcoc3RhcnRPZmZzZXQsIGVuZE9mZnNldClcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS52YWx1ZSk7XG4gICAgfSxcblxuICAgIG1vZGU6IHtcbiAgICAgICAgZGVmYXVsdDogYmFsYW5jZUVuZCxcbiAgICAgICAgbGVmdEN1cmx5QnJhY2tldDogbGVmdEN1cmx5QnJhY2tldCxcbiAgICAgICAgbGVmdEN1cmx5QnJhY2tldE9yU2VtaWNvbG9uOiBsZWZ0Q3VybHlCcmFja2V0T3JTZW1pY29sb24sXG4gICAgICAgIGV4Y2xhbWF0aW9uTWFya09yU2VtaWNvbG9uOiBleGNsYW1hdGlvbk1hcmtPclNlbWljb2xvbixcbiAgICAgICAgc2VtaWNvbG9uSW5jbHVkZWQ6IHNlbWljb2xvbkluY2x1ZGVkXG4gICAgfVxufTtcblxudmFyIFRZUEUkOCA9IHRva2VuaXplci5UWVBFO1xudmFyIHJhd01vZGUgPSBSYXcubW9kZTtcblxudmFyIENPTU1BJDEgPSBUWVBFJDguQ29tbWE7XG52YXIgV0hJVEVTUEFDRSQzID0gVFlQRSQ4LldoaXRlU3BhY2U7XG5cbi8vIHZhciggPGlkZW50PiAsIDx2YWx1ZT4/IClcbnZhciBfdmFyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jcmVhdGVMaXN0KCk7XG5cbiAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICAvLyBOT1RFOiBEb24ndCBjaGVjayBtb3JlIHRoYW4gYSBmaXJzdCBhcmd1bWVudCBpcyBhbiBpZGVudCwgcmVzdCBjaGVja3MgYXJlIGZvciBsZXhlclxuICAgIGNoaWxkcmVuLnB1c2godGhpcy5JZGVudGlmaWVyKCkpO1xuXG4gICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuXG4gICAgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgPT09IENPTU1BJDEpIHtcbiAgICAgICAgY2hpbGRyZW4ucHVzaCh0aGlzLk9wZXJhdG9yKCkpO1xuXG4gICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSB0aGlzLnNjYW5uZXIudG9rZW5JbmRleDtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLnBhcnNlQ3VzdG9tUHJvcGVydHlcbiAgICAgICAgICAgID8gdGhpcy5WYWx1ZShudWxsKVxuICAgICAgICAgICAgOiB0aGlzLlJhdyh0aGlzLnNjYW5uZXIudG9rZW5JbmRleCwgcmF3TW9kZS5leGNsYW1hdGlvbk1hcmtPclNlbWljb2xvbiwgZmFsc2UpO1xuXG4gICAgICAgIGlmICh2YWx1ZS50eXBlID09PSAnVmFsdWUnICYmIHZhbHVlLmNoaWxkcmVuLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgZm9yIChsZXQgb2Zmc2V0ID0gc3RhcnRJbmRleCAtIHRoaXMuc2Nhbm5lci50b2tlbkluZGV4OyBvZmZzZXQgPD0gMDsgb2Zmc2V0KyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zY2FubmVyLmxvb2t1cFR5cGUob2Zmc2V0KSA9PT0gV0hJVEVTUEFDRSQzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmNoaWxkcmVuLmFwcGVuZERhdGEoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1doaXRlU3BhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICcgJ1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY2hpbGRyZW4ucHVzaCh2YWx1ZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoaWxkcmVuO1xufTtcblxudmFyIHZhbHVlID0ge1xuICAgIGdldE5vZGU6IF9kZWZhdWx0LFxuICAgICdleHByZXNzaW9uJzogZXhwcmVzc2lvbixcbiAgICAndmFyJzogX3ZhclxufTtcblxudmFyIHNjb3BlID0ge1xuICAgIEF0cnVsZVByZWx1ZGU6IGF0cnVsZVByZWx1ZGUsXG4gICAgU2VsZWN0b3I6IHNlbGVjdG9yLFxuICAgIFZhbHVlOiB2YWx1ZVxufTtcblxudmFyIGZvbnRGYWNlID0ge1xuICAgIHBhcnNlOiB7XG4gICAgICAgIHByZWx1ZGU6IG51bGwsXG4gICAgICAgIGJsb2NrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkJsb2NrKHRydWUpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxudmFyIFRZUEUkOSA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgU1RSSU5HJDEgPSBUWVBFJDkuU3RyaW5nO1xudmFyIElERU5UJDMgPSBUWVBFJDkuSWRlbnQ7XG52YXIgVVJMJDMgPSBUWVBFJDkuVXJsO1xudmFyIEZVTkNUSU9OJDIgPSBUWVBFJDkuRnVuY3Rpb247XG52YXIgTEVGVFBBUkVOVEhFU0lTJDEgPSBUWVBFJDkuTGVmdFBhcmVudGhlc2lzO1xuXG52YXIgX2ltcG9ydCA9IHtcbiAgICBwYXJzZToge1xuICAgICAgICBwcmVsdWRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY3JlYXRlTGlzdCgpO1xuXG4gICAgICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5zY2FubmVyLnRva2VuVHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgU1RSSU5HJDE6XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godGhpcy5TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBVUkwkMzpcbiAgICAgICAgICAgICAgICBjYXNlIEZVTkNUSU9OJDI6XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godGhpcy5VcmwoKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvcignU3RyaW5nIG9yIHVybCgpIGlzIGV4cGVjdGVkJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmxvb2t1cE5vbldTVHlwZSgwKSA9PT0gSURFTlQkMyB8fFxuICAgICAgICAgICAgICAgIHRoaXMubG9va3VwTm9uV1NUeXBlKDApID09PSBMRUZUUEFSRU5USEVTSVMkMSkge1xuICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godGhpcy5XaGl0ZVNwYWNlKCkpO1xuICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godGhpcy5NZWRpYVF1ZXJ5TGlzdCgpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgICAgICB9LFxuICAgICAgICBibG9jazogbnVsbFxuICAgIH1cbn07XG5cbnZhciBtZWRpYSA9IHtcbiAgICBwYXJzZToge1xuICAgICAgICBwcmVsdWRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpbmdsZU5vZGVMaXN0KFxuICAgICAgICAgICAgICAgIHRoaXMuTWVkaWFRdWVyeUxpc3QoKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcbiAgICAgICAgYmxvY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuQmxvY2soZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxudmFyIHBhZ2UgPSB7XG4gICAgcGFyc2U6IHtcbiAgICAgICAgcHJlbHVkZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVTaW5nbGVOb2RlTGlzdChcbiAgICAgICAgICAgICAgICB0aGlzLlNlbGVjdG9yTGlzdCgpXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuICAgICAgICBibG9jazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5CbG9jayh0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbnZhciBUWVBFJGEgPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIFdISVRFU1BBQ0UkNCA9IFRZUEUkYS5XaGl0ZVNwYWNlO1xudmFyIENPTU1FTlQkMyA9IFRZUEUkYS5Db21tZW50O1xudmFyIElERU5UJDQgPSBUWVBFJGEuSWRlbnQ7XG52YXIgRlVOQ1RJT04kMyA9IFRZUEUkYS5GdW5jdGlvbjtcbnZhciBDT0xPTiQxID0gVFlQRSRhLkNvbG9uO1xudmFyIExFRlRQQVJFTlRIRVNJUyQyID0gVFlQRSRhLkxlZnRQYXJlbnRoZXNpcztcblxuZnVuY3Rpb24gY29uc3VtZVJhdygpIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaW5nbGVOb2RlTGlzdChcbiAgICAgICAgdGhpcy5SYXcodGhpcy5zY2FubmVyLnRva2VuSW5kZXgsIG51bGwsIGZhbHNlKVxuICAgICk7XG59XG5cbmZ1bmN0aW9uIHBhcmVudGhlc2VzKCkge1xuICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcblxuICAgIGlmICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlID09PSBJREVOVCQ0ICYmXG4gICAgICAgIHRoaXMubG9va3VwTm9uV1NUeXBlKDEpID09PSBDT0xPTiQxKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpbmdsZU5vZGVMaXN0KFxuICAgICAgICAgICAgdGhpcy5EZWNsYXJhdGlvbigpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlYWRTZXF1ZW5jZS5jYWxsKHRoaXMpO1xufVxuXG5mdW5jdGlvbiByZWFkU2VxdWVuY2UoKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jcmVhdGVMaXN0KCk7XG4gICAgdmFyIHNwYWNlID0gbnVsbDtcbiAgICB2YXIgY2hpbGQ7XG5cbiAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICBzY2FuOlxuICAgIHdoaWxlICghdGhpcy5zY2FubmVyLmVvZikge1xuICAgICAgICBzd2l0Y2ggKHRoaXMuc2Nhbm5lci50b2tlblR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgV0hJVEVTUEFDRSQ0OlxuICAgICAgICAgICAgICAgIHNwYWNlID0gdGhpcy5XaGl0ZVNwYWNlKCk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIGNhc2UgQ09NTUVOVCQzOlxuICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIGNhc2UgRlVOQ1RJT04kMzpcbiAgICAgICAgICAgICAgICBjaGlsZCA9IHRoaXMuRnVuY3Rpb24oY29uc3VtZVJhdywgdGhpcy5zY29wZS5BdHJ1bGVQcmVsdWRlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBJREVOVCQ0OlxuICAgICAgICAgICAgICAgIGNoaWxkID0gdGhpcy5JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgTEVGVFBBUkVOVEhFU0lTJDI6XG4gICAgICAgICAgICAgICAgY2hpbGQgPSB0aGlzLlBhcmVudGhlc2VzKHBhcmVudGhlc2VzLCB0aGlzLnNjb3BlLkF0cnVsZVByZWx1ZGUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrIHNjYW47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3BhY2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goc3BhY2UpO1xuICAgICAgICAgICAgc3BhY2UgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hpbGRyZW4ucHVzaChjaGlsZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoaWxkcmVuO1xufVxuXG52YXIgc3VwcG9ydHMgPSB7XG4gICAgcGFyc2U6IHtcbiAgICAgICAgcHJlbHVkZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgY2hpbGRyZW4gPSByZWFkU2VxdWVuY2UuY2FsbCh0aGlzKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0Rmlyc3RMaXN0Tm9kZShjaGlsZHJlbikgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yKCdDb25kaXRpb24gaXMgZXhwZWN0ZWQnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgICAgICB9LFxuICAgICAgICBibG9jazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5CbG9jayhmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG52YXIgYXRydWxlID0ge1xuICAgICdmb250LWZhY2UnOiBmb250RmFjZSxcbiAgICAnaW1wb3J0JzogX2ltcG9ydCxcbiAgICAnbWVkaWEnOiBtZWRpYSxcbiAgICAncGFnZSc6IHBhZ2UsXG4gICAgJ3N1cHBvcnRzJzogc3VwcG9ydHNcbn07XG5cbnZhciBkaXIgPSB7XG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVTaW5nbGVOb2RlTGlzdChcbiAgICAgICAgICAgIHRoaXMuSWRlbnRpZmllcigpXG4gICAgICAgICk7XG4gICAgfVxufTtcblxudmFyIGhhcyA9IHtcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpbmdsZU5vZGVMaXN0KFxuICAgICAgICAgICAgdGhpcy5TZWxlY3Rvckxpc3QoKVxuICAgICAgICApO1xuICAgIH1cbn07XG5cbnZhciBsYW5nID0ge1xuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlU2luZ2xlTm9kZUxpc3QoXG4gICAgICAgICAgICB0aGlzLklkZW50aWZpZXIoKVxuICAgICAgICApO1xuICAgIH1cbn07XG5cbnZhciBzZWxlY3Rvckxpc3QgPSB7XG4gICAgcGFyc2U6IGZ1bmN0aW9uIHNlbGVjdG9yTGlzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlU2luZ2xlTm9kZUxpc3QoXG4gICAgICAgICAgICB0aGlzLlNlbGVjdG9yTGlzdCgpXG4gICAgICAgICk7XG4gICAgfVxufTtcblxudmFyIG1hdGNoZXMgPSBzZWxlY3Rvckxpc3Q7XG5cbnZhciBub3QgPSBzZWxlY3Rvckxpc3Q7XG5cbnZhciBBTExPV19PRl9DTEFVU0UgPSB0cnVlO1xuXG52YXIgbnRoV2l0aE9mQ2xhdXNlID0ge1xuICAgIHBhcnNlOiBmdW5jdGlvbiBudGhXaXRoT2ZDbGF1c2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpbmdsZU5vZGVMaXN0KFxuICAgICAgICAgICAgdGhpcy5OdGgoQUxMT1dfT0ZfQ0xBVVNFKVxuICAgICAgICApO1xuICAgIH1cbn07XG5cbnZhciBudGhDaGlsZCA9IG50aFdpdGhPZkNsYXVzZTtcblxudmFyIG50aExhc3RDaGlsZCA9IG50aFdpdGhPZkNsYXVzZTtcblxudmFyIERJU0FMTE9XX09GX0NMQVVTRSA9IGZhbHNlO1xuXG52YXIgbnRoID0ge1xuICAgIHBhcnNlOiBmdW5jdGlvbiBudGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpbmdsZU5vZGVMaXN0KFxuICAgICAgICAgICAgdGhpcy5OdGgoRElTQUxMT1dfT0ZfQ0xBVVNFKVxuICAgICAgICApO1xuICAgIH1cbn07XG5cbnZhciBudGhMYXN0T2ZUeXBlID0gbnRoO1xuXG52YXIgbnRoT2ZUeXBlID0gbnRoO1xuXG52YXIgc2xvdHRlZCA9IHtcbiAgICBwYXJzZTogZnVuY3Rpb24gY29tcG91bmRTZWxlY3RvcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlU2luZ2xlTm9kZUxpc3QoXG4gICAgICAgICAgICB0aGlzLlNlbGVjdG9yKClcbiAgICAgICAgKTtcbiAgICB9XG59O1xuXG52YXIgcHNldWRvID0ge1xuICAgICdkaXInOiBkaXIsXG4gICAgJ2hhcyc6IGhhcyxcbiAgICAnbGFuZyc6IGxhbmcsXG4gICAgJ21hdGNoZXMnOiBtYXRjaGVzLFxuICAgICdub3QnOiBub3QsXG4gICAgJ250aC1jaGlsZCc6IG50aENoaWxkLFxuICAgICdudGgtbGFzdC1jaGlsZCc6IG50aExhc3RDaGlsZCxcbiAgICAnbnRoLWxhc3Qtb2YtdHlwZSc6IG50aExhc3RPZlR5cGUsXG4gICAgJ250aC1vZi10eXBlJzogbnRoT2ZUeXBlLFxuICAgICdzbG90dGVkJzogc2xvdHRlZFxufTtcblxudmFyIGNtcENoYXIkMiA9IHRva2VuaXplci5jbXBDaGFyO1xudmFyIGlzRGlnaXQkMiA9IHRva2VuaXplci5pc0RpZ2l0O1xudmFyIFRZUEUkYiA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgV0hJVEVTUEFDRSQ1ID0gVFlQRSRiLldoaXRlU3BhY2U7XG52YXIgQ09NTUVOVCQ0ID0gVFlQRSRiLkNvbW1lbnQ7XG52YXIgSURFTlQkNSA9IFRZUEUkYi5JZGVudDtcbnZhciBOVU1CRVIkMyA9IFRZUEUkYi5OdW1iZXI7XG52YXIgRElNRU5TSU9OJDIgPSBUWVBFJGIuRGltZW5zaW9uO1xudmFyIFBMVVNTSUdOJDIgPSAweDAwMkI7ICAgIC8vIFUrMDAyQiBQTFVTIFNJR04gKCspXG52YXIgSFlQSEVOTUlOVVMkMSA9IDB4MDAyRDsgLy8gVSswMDJEIEhZUEhFTi1NSU5VUyAoLSlcbnZhciBOJDEgPSAweDAwNkU7ICAgICAgICAgICAvLyBVKzAwNkUgTEFUSU4gU01BTEwgTEVUVEVSIE4gKG4pXG52YXIgRElTQUxMT1dfU0lHTiA9IHRydWU7XG52YXIgQUxMT1dfU0lHTiA9IGZhbHNlO1xuXG5mdW5jdGlvbiBjaGVja0ludGVnZXIob2Zmc2V0LCBkaXNhbGxvd1NpZ24pIHtcbiAgICB2YXIgcG9zID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQgKyBvZmZzZXQ7XG4gICAgdmFyIGNvZGUgPSB0aGlzLnNjYW5uZXIuc291cmNlLmNoYXJDb2RlQXQocG9zKTtcblxuICAgIGlmIChjb2RlID09PSBQTFVTU0lHTiQyIHx8IGNvZGUgPT09IEhZUEhFTk1JTlVTJDEpIHtcbiAgICAgICAgaWYgKGRpc2FsbG93U2lnbikge1xuICAgICAgICAgICAgdGhpcy5lcnJvcignTnVtYmVyIHNpZ24gaXMgbm90IGFsbG93ZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBwb3MrKztcbiAgICB9XG5cbiAgICBmb3IgKDsgcG9zIDwgdGhpcy5zY2FubmVyLnRva2VuRW5kOyBwb3MrKykge1xuICAgICAgICBpZiAoIWlzRGlnaXQkMih0aGlzLnNjYW5uZXIuc291cmNlLmNoYXJDb2RlQXQocG9zKSkpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoJ0ludGVnZXIgaXMgZXhwZWN0ZWQnLCBwb3MpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjaGVja1Rva2VuSXNJbnRlZ2VyKGRpc2FsbG93U2lnbikge1xuICAgIHJldHVybiBjaGVja0ludGVnZXIuY2FsbCh0aGlzLCAwLCBkaXNhbGxvd1NpZ24pO1xufVxuXG5mdW5jdGlvbiBleHBlY3RDaGFyQ29kZShvZmZzZXQsIGNvZGUpIHtcbiAgICBpZiAoIWNtcENoYXIkMih0aGlzLnNjYW5uZXIuc291cmNlLCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCArIG9mZnNldCwgY29kZSkpIHtcbiAgICAgICAgdmFyIG1zZyA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29kZSkge1xuICAgICAgICAgICAgY2FzZSBOJDE6XG4gICAgICAgICAgICAgICAgbXNnID0gJ04gaXMgZXhwZWN0ZWQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBIWVBIRU5NSU5VUyQxOlxuICAgICAgICAgICAgICAgIG1zZyA9ICdIeXBoZW5NaW51cyBpcyBleHBlY3RlZCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVycm9yKG1zZywgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQgKyBvZmZzZXQpO1xuICAgIH1cbn1cblxuLy8gLi4uIDxzaWduZWQtaW50ZWdlcj5cbi8vIC4uLiBbJysnIHwgJy0nXSA8c2lnbmxlc3MtaW50ZWdlcj5cbmZ1bmN0aW9uIGNvbnN1bWVCKCkge1xuICAgIHZhciBvZmZzZXQgPSAwO1xuICAgIHZhciBzaWduID0gMDtcbiAgICB2YXIgdHlwZSA9IHRoaXMuc2Nhbm5lci50b2tlblR5cGU7XG5cbiAgICB3aGlsZSAodHlwZSA9PT0gV0hJVEVTUEFDRSQ1IHx8IHR5cGUgPT09IENPTU1FTlQkNCkge1xuICAgICAgICB0eXBlID0gdGhpcy5zY2FubmVyLmxvb2t1cFR5cGUoKytvZmZzZXQpO1xuICAgIH1cblxuICAgIGlmICh0eXBlICE9PSBOVU1CRVIkMykge1xuICAgICAgICBpZiAodGhpcy5zY2FubmVyLmlzRGVsaW0oUExVU1NJR04kMiwgb2Zmc2V0KSB8fFxuICAgICAgICAgICAgdGhpcy5zY2FubmVyLmlzRGVsaW0oSFlQSEVOTUlOVVMkMSwgb2Zmc2V0KSkge1xuICAgICAgICAgICAgc2lnbiA9IHRoaXMuc2Nhbm5lci5pc0RlbGltKFBMVVNTSUdOJDIsIG9mZnNldCkgPyBQTFVTU0lHTiQyIDogSFlQSEVOTUlOVVMkMTtcblxuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIHR5cGUgPSB0aGlzLnNjYW5uZXIubG9va3VwVHlwZSgrK29mZnNldCk7XG4gICAgICAgICAgICB9IHdoaWxlICh0eXBlID09PSBXSElURVNQQUNFJDUgfHwgdHlwZSA9PT0gQ09NTUVOVCQ0KTtcblxuICAgICAgICAgICAgaWYgKHR5cGUgIT09IE5VTUJFUiQzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLnNraXAob2Zmc2V0KTtcbiAgICAgICAgICAgICAgICBjaGVja1Rva2VuSXNJbnRlZ2VyLmNhbGwodGhpcywgRElTQUxMT1dfU0lHTik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvZmZzZXQgPiAwKSB7XG4gICAgICAgIHRoaXMuc2Nhbm5lci5za2lwKG9mZnNldCk7XG4gICAgfVxuXG4gICAgaWYgKHNpZ24gPT09IDApIHtcbiAgICAgICAgdHlwZSA9IHRoaXMuc2Nhbm5lci5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLnNjYW5uZXIudG9rZW5TdGFydCk7XG4gICAgICAgIGlmICh0eXBlICE9PSBQTFVTU0lHTiQyICYmIHR5cGUgIT09IEhZUEhFTk1JTlVTJDEpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoJ051bWJlciBzaWduIGlzIGV4cGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjaGVja1Rva2VuSXNJbnRlZ2VyLmNhbGwodGhpcywgc2lnbiAhPT0gMCk7XG4gICAgcmV0dXJuIHNpZ24gPT09IEhZUEhFTk1JTlVTJDEgPyAnLScgKyB0aGlzLmNvbnN1bWUoTlVNQkVSJDMpIDogdGhpcy5jb25zdW1lKE5VTUJFUiQzKTtcbn1cblxuLy8gQW4rQiBtaWNyb3N5bnRheCBodHRwczovL3d3dy53My5vcmcvVFIvY3NzLXN5bnRheC0zLyNhbmJcbnZhciBBblBsdXNCID0ge1xuICAgIG5hbWU6ICdBblBsdXNCJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgYTogW1N0cmluZywgbnVsbF0sXG4gICAgICAgIGI6IFtTdHJpbmcsIG51bGxdXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8qIGVzbGludC1kaXNhYmxlIGJyYWNlLXN0eWxlKi9cbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG4gICAgICAgIHZhciBhID0gbnVsbDtcbiAgICAgICAgdmFyIGIgPSBudWxsO1xuXG4gICAgICAgIC8vIDxpbnRlZ2VyPlxuICAgICAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuVHlwZSA9PT0gTlVNQkVSJDMpIHtcbiAgICAgICAgICAgIGNoZWNrVG9rZW5Jc0ludGVnZXIuY2FsbCh0aGlzLCBBTExPV19TSUdOKTtcbiAgICAgICAgICAgIGIgPSB0aGlzLmNvbnN1bWUoTlVNQkVSJDMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gLW5cbiAgICAgICAgLy8gLW4gPHNpZ25lZC1pbnRlZ2VyPlxuICAgICAgICAvLyAtbiBbJysnIHwgJy0nXSA8c2lnbmxlc3MtaW50ZWdlcj5cbiAgICAgICAgLy8gLW4tIDxzaWdubGVzcy1pbnRlZ2VyPlxuICAgICAgICAvLyA8ZGFzaG5kYXNoZGlnaXQtaWRlbnQ+XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgPT09IElERU5UJDUgJiYgY21wQ2hhciQyKHRoaXMuc2Nhbm5lci5zb3VyY2UsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0LCBIWVBIRU5NSU5VUyQxKSkge1xuICAgICAgICAgICAgYSA9ICctMSc7XG5cbiAgICAgICAgICAgIGV4cGVjdENoYXJDb2RlLmNhbGwodGhpcywgMSwgTiQxKTtcblxuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnNjYW5uZXIuZ2V0VG9rZW5MZW5ndGgoKSkge1xuICAgICAgICAgICAgICAgIC8vIC1uXG4gICAgICAgICAgICAgICAgLy8gLW4gPHNpZ25lZC1pbnRlZ2VyPlxuICAgICAgICAgICAgICAgIC8vIC1uIFsnKycgfCAnLSddIDxzaWdubGVzcy1pbnRlZ2VyPlxuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYiA9IGNvbnN1bWVCLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgLy8gLW4tIDxzaWdubGVzcy1pbnRlZ2VyPlxuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0Q2hhckNvZGUuY2FsbCh0aGlzLCAyLCBIWVBIRU5NSU5VUyQxKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgY2hlY2tUb2tlbklzSW50ZWdlci5jYWxsKHRoaXMsIERJU0FMTE9XX1NJR04pO1xuXG4gICAgICAgICAgICAgICAgICAgIGIgPSAnLScgKyB0aGlzLmNvbnN1bWUoTlVNQkVSJDMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIC8vIDxkYXNobmRhc2hkaWdpdC1pZGVudD5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBleHBlY3RDaGFyQ29kZS5jYWxsKHRoaXMsIDIsIEhZUEhFTk1JTlVTJDEpO1xuICAgICAgICAgICAgICAgICAgICBjaGVja0ludGVnZXIuY2FsbCh0aGlzLCAzLCBESVNBTExPV19TSUdOKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcblxuICAgICAgICAgICAgICAgICAgICBiID0gdGhpcy5zY2FubmVyLnN1YnN0clRvQ3Vyc29yKHN0YXJ0ICsgMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyAnKyc/IG5cbiAgICAgICAgLy8gJysnPyBuIDxzaWduZWQtaW50ZWdlcj5cbiAgICAgICAgLy8gJysnPyBuIFsnKycgfCAnLSddIDxzaWdubGVzcy1pbnRlZ2VyPlxuICAgICAgICAvLyAnKyc/IG4tIDxzaWdubGVzcy1pbnRlZ2VyPlxuICAgICAgICAvLyAnKyc/IDxuZGFzaGRpZ2l0LWlkZW50PlxuICAgICAgICBlbHNlIGlmICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlID09PSBJREVOVCQ1IHx8ICh0aGlzLnNjYW5uZXIuaXNEZWxpbShQTFVTU0lHTiQyKSAmJiB0aGlzLnNjYW5uZXIubG9va3VwVHlwZSgxKSA9PT0gSURFTlQkNSkpIHtcbiAgICAgICAgICAgIHZhciBzaWduID0gMDtcbiAgICAgICAgICAgIGEgPSAnMSc7XG5cbiAgICAgICAgICAgIC8vIGp1c3QgaWdub3JlIGEgcGx1c1xuICAgICAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci5pc0RlbGltKFBMVVNTSUdOJDIpKSB7XG4gICAgICAgICAgICAgICAgc2lnbiA9IDE7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXhwZWN0Q2hhckNvZGUuY2FsbCh0aGlzLCAwLCBOJDEpO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMuc2Nhbm5lci5nZXRUb2tlbkxlbmd0aCgpKSB7XG4gICAgICAgICAgICAgICAgLy8gJysnPyBuXG4gICAgICAgICAgICAgICAgLy8gJysnPyBuIDxzaWduZWQtaW50ZWdlcj5cbiAgICAgICAgICAgICAgICAvLyAnKyc/IG4gWycrJyB8ICctJ10gPHNpZ25sZXNzLWludGVnZXI+XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICBiID0gY29uc3VtZUIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAvLyAnKyc/IG4tIDxzaWdubGVzcy1pbnRlZ2VyPlxuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0Q2hhckNvZGUuY2FsbCh0aGlzLCAxLCBIWVBIRU5NSU5VUyQxKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgY2hlY2tUb2tlbklzSW50ZWdlci5jYWxsKHRoaXMsIERJU0FMTE9XX1NJR04pO1xuXG4gICAgICAgICAgICAgICAgICAgIGIgPSAnLScgKyB0aGlzLmNvbnN1bWUoTlVNQkVSJDMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIC8vICcrJz8gPG5kYXNoZGlnaXQtaWRlbnQ+XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0Q2hhckNvZGUuY2FsbCh0aGlzLCAxLCBIWVBIRU5NSU5VUyQxKTtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tJbnRlZ2VyLmNhbGwodGhpcywgMiwgRElTQUxMT1dfU0lHTik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgYiA9IHRoaXMuc2Nhbm5lci5zdWJzdHJUb0N1cnNvcihzdGFydCArIHNpZ24gKyAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDxuZGFzaGRpZ2l0LWRpbWVuc2lvbj5cbiAgICAgICAgLy8gPG5kYXNoLWRpbWVuc2lvbj4gPHNpZ25sZXNzLWludGVnZXI+XG4gICAgICAgIC8vIDxuLWRpbWVuc2lvbj5cbiAgICAgICAgLy8gPG4tZGltZW5zaW9uPiA8c2lnbmVkLWludGVnZXI+XG4gICAgICAgIC8vIDxuLWRpbWVuc2lvbj4gWycrJyB8ICctJ10gPHNpZ25sZXNzLWludGVnZXI+XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgPT09IERJTUVOU0lPTiQyKSB7XG4gICAgICAgICAgICB2YXIgY29kZSA9IHRoaXMuc2Nhbm5lci5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLnNjYW5uZXIudG9rZW5TdGFydCk7XG4gICAgICAgICAgICB2YXIgc2lnbiA9IGNvZGUgPT09IFBMVVNTSUdOJDIgfHwgY29kZSA9PT0gSFlQSEVOTUlOVVMkMTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0ICsgc2lnbjsgaSA8IHRoaXMuc2Nhbm5lci50b2tlbkVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0RpZ2l0JDIodGhpcy5zY2FubmVyLnNvdXJjZS5jaGFyQ29kZUF0KGkpKSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpID09PSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCArIHNpZ24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yKCdJbnRlZ2VyIGlzIGV4cGVjdGVkJywgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQgKyBzaWduKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXhwZWN0Q2hhckNvZGUuY2FsbCh0aGlzLCBpIC0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQsIE4kMSk7XG4gICAgICAgICAgICBhID0gdGhpcy5zY2FubmVyLnNvdXJjZS5zdWJzdHJpbmcoc3RhcnQsIGkpO1xuXG4gICAgICAgICAgICAvLyA8bi1kaW1lbnNpb24+XG4gICAgICAgICAgICAvLyA8bi1kaW1lbnNpb24+IDxzaWduZWQtaW50ZWdlcj5cbiAgICAgICAgICAgIC8vIDxuLWRpbWVuc2lvbj4gWycrJyB8ICctJ10gPHNpZ25sZXNzLWludGVnZXI+XG4gICAgICAgICAgICBpZiAoaSArIDEgPT09IHRoaXMuc2Nhbm5lci50b2tlbkVuZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgYiA9IGNvbnN1bWVCLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGV4cGVjdENoYXJDb2RlLmNhbGwodGhpcywgaSAtIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0ICsgMSwgSFlQSEVOTUlOVVMkMSk7XG5cbiAgICAgICAgICAgICAgICAvLyA8bmRhc2gtZGltZW5zaW9uPiA8c2lnbmxlc3MtaW50ZWdlcj5cbiAgICAgICAgICAgICAgICBpZiAoaSArIDIgPT09IHRoaXMuc2Nhbm5lci50b2tlbkVuZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrVG9rZW5Jc0ludGVnZXIuY2FsbCh0aGlzLCBESVNBTExPV19TSUdOKTtcbiAgICAgICAgICAgICAgICAgICAgYiA9ICctJyArIHRoaXMuY29uc3VtZShOVU1CRVIkMyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIDxuZGFzaGRpZ2l0LWRpbWVuc2lvbj5cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tJbnRlZ2VyLmNhbGwodGhpcywgaSAtIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0ICsgMiwgRElTQUxMT1dfU0lHTik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIGIgPSB0aGlzLnNjYW5uZXIuc3Vic3RyVG9DdXJzb3IoaSArIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhICE9PSBudWxsICYmIGEuY2hhckNvZGVBdCgwKSA9PT0gUExVU1NJR04kMikge1xuICAgICAgICAgICAgYSA9IGEuc3Vic3RyKDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGIgIT09IG51bGwgJiYgYi5jaGFyQ29kZUF0KDApID09PSBQTFVTU0lHTiQyKSB7XG4gICAgICAgICAgICBiID0gYi5zdWJzdHIoMSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ0FuUGx1c0InLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCksXG4gICAgICAgICAgICBhOiBhLFxuICAgICAgICAgICAgYjogYlxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdmFyIGEgPSBub2RlLmEgIT09IG51bGwgJiYgbm9kZS5hICE9PSB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBiID0gbm9kZS5iICE9PSBudWxsICYmIG5vZGUuYiAhPT0gdW5kZWZpbmVkO1xuXG4gICAgICAgIGlmIChhKSB7XG4gICAgICAgICAgICB0aGlzLmNodW5rKFxuICAgICAgICAgICAgICAgIG5vZGUuYSA9PT0gJysxJyA/ICcrbicgOiAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG9wZXJhdG9yLWxpbmVicmVhaywgaW5kZW50XG4gICAgICAgICAgICAgICAgbm9kZS5hID09PSAgJzEnID8gICduJyA6IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgb3BlcmF0b3ItbGluZWJyZWFrLCBpbmRlbnRcbiAgICAgICAgICAgICAgICBub2RlLmEgPT09ICctMScgPyAnLW4nIDogLy8gZXNsaW50LWRpc2FibGUtbGluZSBvcGVyYXRvci1saW5lYnJlYWssIGluZGVudFxuICAgICAgICAgICAgICAgIG5vZGUuYSArICduJyAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG9wZXJhdG9yLWxpbmVicmVhaywgaW5kZW50XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoYikge1xuICAgICAgICAgICAgICAgIGIgPSBTdHJpbmcobm9kZS5iKTtcbiAgICAgICAgICAgICAgICBpZiAoYi5jaGFyQXQoMCkgPT09ICctJyB8fCBiLmNoYXJBdCgwKSA9PT0gJysnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2h1bmsoYi5jaGFyQXQoMCkpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNodW5rKGIuc3Vic3RyKDEpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNodW5rKCcrJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2h1bmsoYik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jaHVuayhTdHJpbmcobm9kZS5iKSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG52YXIgVFlQRSRjID0gdG9rZW5pemVyLlRZUEU7XG52YXIgcmF3TW9kZSQxID0gUmF3Lm1vZGU7XG5cbnZhciBBVEtFWVdPUkQgPSBUWVBFJGMuQXRLZXl3b3JkO1xudmFyIFNFTUlDT0xPTiA9IFRZUEUkYy5TZW1pY29sb247XG52YXIgTEVGVENVUkxZQlJBQ0tFVCA9IFRZUEUkYy5MZWZ0Q3VybHlCcmFja2V0O1xudmFyIFJJR0hUQ1VSTFlCUkFDS0VUID0gVFlQRSRjLlJpZ2h0Q3VybHlCcmFja2V0O1xuXG5mdW5jdGlvbiBjb25zdW1lUmF3JDEoc3RhcnRUb2tlbikge1xuICAgIHJldHVybiB0aGlzLlJhdyhzdGFydFRva2VuLCByYXdNb2RlJDEubGVmdEN1cmx5QnJhY2tldE9yU2VtaWNvbG9uLCB0cnVlKTtcbn1cblxuZnVuY3Rpb24gaXNEZWNsYXJhdGlvbkJsb2NrQXRydWxlKCkge1xuICAgIGZvciAodmFyIG9mZnNldCA9IDEsIHR5cGU7IHR5cGUgPSB0aGlzLnNjYW5uZXIubG9va3VwVHlwZShvZmZzZXQpOyBvZmZzZXQrKykge1xuICAgICAgICBpZiAodHlwZSA9PT0gUklHSFRDVVJMWUJSQUNLRVQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGUgPT09IExFRlRDVVJMWUJSQUNLRVQgfHxcbiAgICAgICAgICAgIHR5cGUgPT09IEFUS0VZV09SRCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG52YXIgQXRydWxlID0ge1xuICAgIG5hbWU6ICdBdHJ1bGUnLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBuYW1lOiBTdHJpbmcsXG4gICAgICAgIHByZWx1ZGU6IFsnQXRydWxlUHJlbHVkZScsICdSYXcnLCBudWxsXSxcbiAgICAgICAgYmxvY2s6IFsnQmxvY2snLCBudWxsXVxuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydDtcbiAgICAgICAgdmFyIG5hbWU7XG4gICAgICAgIHZhciBuYW1lTG93ZXJDYXNlO1xuICAgICAgICB2YXIgcHJlbHVkZSA9IG51bGw7XG4gICAgICAgIHZhciBibG9jayA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5lYXQoQVRLRVlXT1JEKTtcblxuICAgICAgICBuYW1lID0gdGhpcy5zY2FubmVyLnN1YnN0clRvQ3Vyc29yKHN0YXJ0ICsgMSk7XG4gICAgICAgIG5hbWVMb3dlckNhc2UgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcblxuICAgICAgICAvLyBwYXJzZSBwcmVsdWRlXG4gICAgICAgIGlmICh0aGlzLnNjYW5uZXIuZW9mID09PSBmYWxzZSAmJlxuICAgICAgICAgICAgdGhpcy5zY2FubmVyLnRva2VuVHlwZSAhPT0gTEVGVENVUkxZQlJBQ0tFVCAmJlxuICAgICAgICAgICAgdGhpcy5zY2FubmVyLnRva2VuVHlwZSAhPT0gU0VNSUNPTE9OKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJzZUF0cnVsZVByZWx1ZGUpIHtcbiAgICAgICAgICAgICAgICBwcmVsdWRlID0gdGhpcy5wYXJzZVdpdGhGYWxsYmFjayh0aGlzLkF0cnVsZVByZWx1ZGUuYmluZCh0aGlzLCBuYW1lKSwgY29uc3VtZVJhdyQxKTtcblxuICAgICAgICAgICAgICAgIC8vIHR1cm4gZW1wdHkgQXRydWxlUHJlbHVkZSBpbnRvIG51bGxcbiAgICAgICAgICAgICAgICBpZiAocHJlbHVkZS50eXBlID09PSAnQXRydWxlUHJlbHVkZScgJiYgcHJlbHVkZS5jaGlsZHJlbi5oZWFkID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHByZWx1ZGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJlbHVkZSA9IGNvbnN1bWVSYXckMS5jYWxsKHRoaXMsIHRoaXMuc2Nhbm5lci50b2tlbkluZGV4KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlKSB7XG4gICAgICAgICAgICBjYXNlIFNFTUlDT0xPTjpcbiAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIExFRlRDVVJMWUJSQUNLRVQ6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXRydWxlLmhhc093blByb3BlcnR5KG5hbWVMb3dlckNhc2UpICYmXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiB0aGlzLmF0cnVsZVtuYW1lTG93ZXJDYXNlXS5ibG9jayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBibG9jayA9IHRoaXMuYXRydWxlW25hbWVMb3dlckNhc2VdLmJsb2NrLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogc2hvdWxkIGNvbnN1bWUgYmxvY2sgY29udGVudCBhcyBSYXc/XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrID0gdGhpcy5CbG9jayhpc0RlY2xhcmF0aW9uQmxvY2tBdHJ1bGUuY2FsbCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ0F0cnVsZScsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSxcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBwcmVsdWRlOiBwcmVsdWRlLFxuICAgICAgICAgICAgYmxvY2s6IGJsb2NrXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNodW5rKCdAJyk7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS5uYW1lKTtcblxuICAgICAgICBpZiAobm9kZS5wcmVsdWRlICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmNodW5rKCcgJyk7XG4gICAgICAgICAgICB0aGlzLm5vZGUobm9kZS5wcmVsdWRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChub2RlLmJsb2NrKSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUobm9kZS5ibG9jayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNodW5rKCc7Jyk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHdhbGtDb250ZXh0OiAnYXRydWxlJ1xufTtcblxudmFyIFRZUEUkZCA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgU0VNSUNPTE9OJDEgPSBUWVBFJGQuU2VtaWNvbG9uO1xudmFyIExFRlRDVVJMWUJSQUNLRVQkMSA9IFRZUEUkZC5MZWZ0Q3VybHlCcmFja2V0O1xuXG52YXIgQXRydWxlUHJlbHVkZSA9IHtcbiAgICBuYW1lOiAnQXRydWxlUHJlbHVkZScsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIGNoaWxkcmVuOiBbW11dXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBudWxsO1xuXG4gICAgICAgIGlmIChuYW1lICE9PSBudWxsKSB7XG4gICAgICAgICAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuXG4gICAgICAgIGlmICh0aGlzLmF0cnVsZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSAmJlxuICAgICAgICAgICAgdHlwZW9mIHRoaXMuYXRydWxlW25hbWVdLnByZWx1ZGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIC8vIGN1c3RvbSBjb25zdW1lclxuICAgICAgICAgICAgY2hpbGRyZW4gPSB0aGlzLmF0cnVsZVtuYW1lXS5wcmVsdWRlLmNhbGwodGhpcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBkZWZhdWx0IGNvbnN1bWVyXG4gICAgICAgICAgICBjaGlsZHJlbiA9IHRoaXMucmVhZFNlcXVlbmNlKHRoaXMuc2NvcGUuQXRydWxlUHJlbHVkZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci5lb2YgIT09IHRydWUgJiZcbiAgICAgICAgICAgIHRoaXMuc2Nhbm5lci50b2tlblR5cGUgIT09IExFRlRDVVJMWUJSQUNLRVQkMSAmJlxuICAgICAgICAgICAgdGhpcy5zY2FubmVyLnRva2VuVHlwZSAhPT0gU0VNSUNPTE9OJDEpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoJ1NlbWljb2xvbiBvciBibG9jayBpcyBleHBlY3RlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNoaWxkcmVuID09PSBudWxsKSB7XG4gICAgICAgICAgICBjaGlsZHJlbiA9IHRoaXMuY3JlYXRlTGlzdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdBdHJ1bGVQcmVsdWRlJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbkZyb21MaXN0KGNoaWxkcmVuKSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBjaGlsZHJlblxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbihub2RlKTtcbiAgICB9LFxuICAgIHdhbGtDb250ZXh0OiAnYXRydWxlUHJlbHVkZSdcbn07XG5cbnZhciBUWVBFJGUgPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIElERU5UJDYgPSBUWVBFJGUuSWRlbnQ7XG52YXIgU1RSSU5HJDIgPSBUWVBFJGUuU3RyaW5nO1xudmFyIENPTE9OJDIgPSBUWVBFJGUuQ29sb247XG52YXIgTEVGVFNRVUFSRUJSQUNLRVQkMiA9IFRZUEUkZS5MZWZ0U3F1YXJlQnJhY2tldDtcbnZhciBSSUdIVFNRVUFSRUJSQUNLRVQgPSBUWVBFJGUuUmlnaHRTcXVhcmVCcmFja2V0O1xudmFyIERPTExBUlNJR04gPSAweDAwMjQ7ICAgICAgIC8vIFUrMDAyNCBET0xMQVIgU0lHTiAoJClcbnZhciBBU1RFUklTSyQyID0gMHgwMDJBOyAgICAgICAgIC8vIFUrMDAyQSBBU1RFUklTSyAoKilcbnZhciBFUVVBTFNTSUdOID0gMHgwMDNEOyAgICAgICAvLyBVKzAwM0QgRVFVQUxTIFNJR04gKD0pXG52YXIgQ0lSQ1VNRkxFWEFDQ0VOVCA9IDB4MDA1RTsgLy8gVSswMDVFICheKVxudmFyIFZFUlRJQ0FMTElORSQxID0gMHgwMDdDOyAgICAgLy8gVSswMDdDIFZFUlRJQ0FMIExJTkUgKHwpXG52YXIgVElMREUkMSA9IDB4MDA3RTsgICAgICAgICAgICAvLyBVKzAwN0UgVElMREUgKH4pXG5cbmZ1bmN0aW9uIGdldEF0dHJpYnV0ZU5hbWUoKSB7XG4gICAgaWYgKHRoaXMuc2Nhbm5lci5lb2YpIHtcbiAgICAgICAgdGhpcy5lcnJvcignVW5leHBlY3RlZCBlbmQgb2YgaW5wdXQnKTtcbiAgICB9XG5cbiAgICB2YXIgc3RhcnQgPSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydDtcbiAgICB2YXIgZXhwZWN0SWRlbnQgPSBmYWxzZTtcbiAgICB2YXIgY2hlY2tDb2xvbiA9IHRydWU7XG5cbiAgICBpZiAodGhpcy5zY2FubmVyLmlzRGVsaW0oQVNURVJJU0skMikpIHtcbiAgICAgICAgZXhwZWN0SWRlbnQgPSB0cnVlO1xuICAgICAgICBjaGVja0NvbG9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgfSBlbHNlIGlmICghdGhpcy5zY2FubmVyLmlzRGVsaW0oVkVSVElDQUxMSU5FJDEpKSB7XG4gICAgICAgIHRoaXMuZWF0KElERU5UJDYpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnNjYW5uZXIuaXNEZWxpbShWRVJUSUNBTExJTkUkMSkpIHtcbiAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLnNjYW5uZXIudG9rZW5TdGFydCArIDEpICE9PSBFUVVBTFNTSUdOKSB7XG4gICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgdGhpcy5lYXQoSURFTlQkNik7XG4gICAgICAgIH0gZWxzZSBpZiAoZXhwZWN0SWRlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoJ0lkZW50aWZpZXIgaXMgZXhwZWN0ZWQnLCB0aGlzLnNjYW5uZXIudG9rZW5FbmQpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChleHBlY3RJZGVudCkge1xuICAgICAgICB0aGlzLmVycm9yKCdWZXJ0aWNhbCBsaW5lIGlzIGV4cGVjdGVkJyk7XG4gICAgfVxuXG4gICAgaWYgKGNoZWNrQ29sb24gJiYgdGhpcy5zY2FubmVyLnRva2VuVHlwZSA9PT0gQ09MT04kMikge1xuICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICB0aGlzLmVhdChJREVOVCQ2KTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnSWRlbnRpZmllcicsXG4gICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICBuYW1lOiB0aGlzLnNjYW5uZXIuc3Vic3RyVG9DdXJzb3Ioc3RhcnQpXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gZ2V0T3BlcmF0b3IoKSB7XG4gICAgdmFyIHN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG4gICAgdmFyIGNvZGUgPSB0aGlzLnNjYW5uZXIuc291cmNlLmNoYXJDb2RlQXQoc3RhcnQpO1xuXG4gICAgaWYgKGNvZGUgIT09IEVRVUFMU1NJR04gJiYgICAgICAgIC8vID1cbiAgICAgICAgY29kZSAhPT0gVElMREUkMSAmJiAgICAgICAgICAgICAvLyB+PVxuICAgICAgICBjb2RlICE9PSBDSVJDVU1GTEVYQUNDRU5UICYmICAvLyBePVxuICAgICAgICBjb2RlICE9PSBET0xMQVJTSUdOICYmICAgICAgICAvLyAkPVxuICAgICAgICBjb2RlICE9PSBBU1RFUklTSyQyICYmICAgICAgICAgIC8vICo9XG4gICAgICAgIGNvZGUgIT09IFZFUlRJQ0FMTElORSQxICAgICAgICAgLy8gfD1cbiAgICApIHtcbiAgICAgICAgdGhpcy5lcnJvcignQXR0cmlidXRlIHNlbGVjdG9yICg9LCB+PSwgXj0sICQ9LCAqPSwgfD0pIGlzIGV4cGVjdGVkJyk7XG4gICAgfVxuXG4gICAgdGhpcy5zY2FubmVyLm5leHQoKTtcblxuICAgIGlmIChjb2RlICE9PSBFUVVBTFNTSUdOKSB7XG4gICAgICAgIGlmICghdGhpcy5zY2FubmVyLmlzRGVsaW0oRVFVQUxTU0lHTikpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoJ0VxdWFsIHNpZ24gaXMgZXhwZWN0ZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuc2Nhbm5lci5zdWJzdHJUb0N1cnNvcihzdGFydCk7XG59XG5cbi8vICdbJyA8d3EtbmFtZT4gJ10nXG4vLyAnWycgPHdxLW5hbWU+IDxhdHRyLW1hdGNoZXI+IFsgPHN0cmluZy10b2tlbj4gfCA8aWRlbnQtdG9rZW4+IF0gPGF0dHItbW9kaWZpZXI+PyAnXSdcbnZhciBBdHRyaWJ1dGVTZWxlY3RvciA9IHtcbiAgICBuYW1lOiAnQXR0cmlidXRlU2VsZWN0b3InLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBuYW1lOiAnSWRlbnRpZmllcicsXG4gICAgICAgIG1hdGNoZXI6IFtTdHJpbmcsIG51bGxdLFxuICAgICAgICB2YWx1ZTogWydTdHJpbmcnLCAnSWRlbnRpZmllcicsIG51bGxdLFxuICAgICAgICBmbGFnczogW1N0cmluZywgbnVsbF1cbiAgICB9LFxuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG4gICAgICAgIHZhciBuYW1lO1xuICAgICAgICB2YXIgbWF0Y2hlciA9IG51bGw7XG4gICAgICAgIHZhciB2YWx1ZSA9IG51bGw7XG4gICAgICAgIHZhciBmbGFncyA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5lYXQoTEVGVFNRVUFSRUJSQUNLRVQkMik7XG4gICAgICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcblxuICAgICAgICBuYW1lID0gZ2V0QXR0cmlidXRlTmFtZS5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgIT09IFJJR0hUU1FVQVJFQlJBQ0tFVCkge1xuICAgICAgICAgICAgLy8gYXZvaWQgY2FzZSBgW25hbWUgaV1gXG4gICAgICAgICAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuVHlwZSAhPT0gSURFTlQkNikge1xuICAgICAgICAgICAgICAgIG1hdGNoZXIgPSBnZXRPcGVyYXRvci5jYWxsKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuXG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLnNjYW5uZXIudG9rZW5UeXBlID09PSBTVFJJTkckMlxuICAgICAgICAgICAgICAgICAgICA/IHRoaXMuU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgOiB0aGlzLklkZW50aWZpZXIoKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYXR0cmlidXRlIGZsYWdzXG4gICAgICAgICAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuVHlwZSA9PT0gSURFTlQkNikge1xuICAgICAgICAgICAgICAgIGZsYWdzID0gdGhpcy5zY2FubmVyLmdldFRva2VuVmFsdWUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lYXQoUklHSFRTUVVBUkVCUkFDS0VUKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ0F0dHJpYnV0ZVNlbGVjdG9yJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIG1hdGNoZXI6IG1hdGNoZXIsXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgICAgICBmbGFnczogZmxhZ3NcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHZhciBmbGFnc1ByZWZpeCA9ICcgJztcblxuICAgICAgICB0aGlzLmNodW5rKCdbJyk7XG4gICAgICAgIHRoaXMubm9kZShub2RlLm5hbWUpO1xuXG4gICAgICAgIGlmIChub2RlLm1hdGNoZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2h1bmsobm9kZS5tYXRjaGVyKTtcblxuICAgICAgICAgICAgaWYgKG5vZGUudmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUobm9kZS52YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBzcGFjZSBiZXR3ZWVuIHN0cmluZyBhbmQgZmxhZ3MgaXMgbm90IHJlcXVpcmVkXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUudmFsdWUudHlwZSA9PT0gJ1N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3NQcmVmaXggPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobm9kZS5mbGFncyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5jaHVuayhmbGFnc1ByZWZpeCk7XG4gICAgICAgICAgICB0aGlzLmNodW5rKG5vZGUuZmxhZ3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jaHVuaygnXScpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJGYgPSB0b2tlbml6ZXIuVFlQRTtcbnZhciByYXdNb2RlJDIgPSBSYXcubW9kZTtcblxudmFyIFdISVRFU1BBQ0UkNiA9IFRZUEUkZi5XaGl0ZVNwYWNlO1xudmFyIENPTU1FTlQkNSA9IFRZUEUkZi5Db21tZW50O1xudmFyIFNFTUlDT0xPTiQyID0gVFlQRSRmLlNlbWljb2xvbjtcbnZhciBBVEtFWVdPUkQkMSA9IFRZUEUkZi5BdEtleXdvcmQ7XG52YXIgTEVGVENVUkxZQlJBQ0tFVCQyID0gVFlQRSRmLkxlZnRDdXJseUJyYWNrZXQ7XG52YXIgUklHSFRDVVJMWUJSQUNLRVQkMSA9IFRZUEUkZi5SaWdodEN1cmx5QnJhY2tldDtcblxuZnVuY3Rpb24gY29uc3VtZVJhdyQyKHN0YXJ0VG9rZW4pIHtcbiAgICByZXR1cm4gdGhpcy5SYXcoc3RhcnRUb2tlbiwgbnVsbCwgdHJ1ZSk7XG59XG5mdW5jdGlvbiBjb25zdW1lUnVsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5wYXJzZVdpdGhGYWxsYmFjayh0aGlzLlJ1bGUsIGNvbnN1bWVSYXckMik7XG59XG5mdW5jdGlvbiBjb25zdW1lUmF3RGVjbGFyYXRpb24oc3RhcnRUb2tlbikge1xuICAgIHJldHVybiB0aGlzLlJhdyhzdGFydFRva2VuLCByYXdNb2RlJDIuc2VtaWNvbG9uSW5jbHVkZWQsIHRydWUpO1xufVxuZnVuY3Rpb24gY29uc3VtZURlY2xhcmF0aW9uKCkge1xuICAgIGlmICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlID09PSBTRU1JQ09MT04kMikge1xuICAgICAgICByZXR1cm4gY29uc3VtZVJhd0RlY2xhcmF0aW9uLmNhbGwodGhpcywgdGhpcy5zY2FubmVyLnRva2VuSW5kZXgpO1xuICAgIH1cblxuICAgIHZhciBub2RlID0gdGhpcy5wYXJzZVdpdGhGYWxsYmFjayh0aGlzLkRlY2xhcmF0aW9uLCBjb25zdW1lUmF3RGVjbGFyYXRpb24pO1xuXG4gICAgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgPT09IFNFTUlDT0xPTiQyKSB7XG4gICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5vZGU7XG59XG5cbnZhciBCbG9jayA9IHtcbiAgICBuYW1lOiAnQmxvY2snLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBjaGlsZHJlbjogW1tcbiAgICAgICAgICAgICdBdHJ1bGUnLFxuICAgICAgICAgICAgJ1J1bGUnLFxuICAgICAgICAgICAgJ0RlY2xhcmF0aW9uJ1xuICAgICAgICBdXVxuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKGlzRGVjbGFyYXRpb24pIHtcbiAgICAgICAgdmFyIGNvbnN1bWVyID0gaXNEZWNsYXJhdGlvbiA/IGNvbnN1bWVEZWNsYXJhdGlvbiA6IGNvbnN1bWVSdWxlO1xuXG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNyZWF0ZUxpc3QoKTtcblxuICAgICAgICB0aGlzLmVhdChMRUZUQ1VSTFlCUkFDS0VUJDIpO1xuXG4gICAgICAgIHNjYW46XG4gICAgICAgIHdoaWxlICghdGhpcy5zY2FubmVyLmVvZikge1xuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBSSUdIVENVUkxZQlJBQ0tFVCQxOlxuICAgICAgICAgICAgICAgICAgICBicmVhayBzY2FuO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBXSElURVNQQUNFJDY6XG4gICAgICAgICAgICAgICAgY2FzZSBDT01NRU5UJDU6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBBVEtFWVdPUkQkMTpcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW4ucHVzaCh0aGlzLnBhcnNlV2l0aEZhbGxiYWNrKHRoaXMuQXRydWxlLCBjb25zdW1lUmF3JDIpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGNvbnN1bWVyLmNhbGwodGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLnNjYW5uZXIuZW9mKSB7XG4gICAgICAgICAgICB0aGlzLmVhdChSSUdIVENVUkxZQlJBQ0tFVCQxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnQmxvY2snLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCksXG4gICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsoJ3snKTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbihub2RlLCBmdW5jdGlvbihwcmV2KSB7XG4gICAgICAgICAgICBpZiAocHJldi50eXBlID09PSAnRGVjbGFyYXRpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaHVuaygnOycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jaHVuaygnfScpO1xuICAgIH0sXG4gICAgd2Fsa0NvbnRleHQ6ICdibG9jaydcbn07XG5cbnZhciBUWVBFJGcgPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIExFRlRTUVVBUkVCUkFDS0VUJDMgPSBUWVBFJGcuTGVmdFNxdWFyZUJyYWNrZXQ7XG52YXIgUklHSFRTUVVBUkVCUkFDS0VUJDEgPSBUWVBFJGcuUmlnaHRTcXVhcmVCcmFja2V0O1xuXG52YXIgQnJhY2tldHMgPSB7XG4gICAgbmFtZTogJ0JyYWNrZXRzJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgY2hpbGRyZW46IFtbXV1cbiAgICB9LFxuICAgIHBhcnNlOiBmdW5jdGlvbihyZWFkU2VxdWVuY2UsIHJlY29nbml6ZXIpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5lYXQoTEVGVFNRVUFSRUJSQUNLRVQkMyk7XG5cbiAgICAgICAgY2hpbGRyZW4gPSByZWFkU2VxdWVuY2UuY2FsbCh0aGlzLCByZWNvZ25pemVyKTtcblxuICAgICAgICBpZiAoIXRoaXMuc2Nhbm5lci5lb2YpIHtcbiAgICAgICAgICAgIHRoaXMuZWF0KFJJR0hUU1FVQVJFQlJBQ0tFVCQxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnQnJhY2tldHMnLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCksXG4gICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsoJ1snKTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbihub2RlKTtcbiAgICAgICAgdGhpcy5jaHVuaygnXScpO1xuICAgIH1cbn07XG5cbnZhciBDREMgPSB0b2tlbml6ZXIuVFlQRS5DREM7XG5cbnZhciBDRENfMSA9IHtcbiAgICBuYW1lOiAnQ0RDJyxcbiAgICBzdHJ1Y3R1cmU6IFtdLFxuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG5cbiAgICAgICAgdGhpcy5lYXQoQ0RDKTsgLy8gLS0+XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdDREMnLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydClcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5jaHVuaygnLS0+Jyk7XG4gICAgfVxufTtcblxudmFyIENETyA9IHRva2VuaXplci5UWVBFLkNETztcblxudmFyIENET18xID0ge1xuICAgIG5hbWU6ICdDRE8nLFxuICAgIHN0cnVjdHVyZTogW10sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydDtcblxuICAgICAgICB0aGlzLmVhdChDRE8pOyAvLyA8IS0tXG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdDRE8nLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydClcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5jaHVuaygnPCEtLScpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJGggPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIElERU5UJDcgPSBUWVBFJGguSWRlbnQ7XG52YXIgRlVMTFNUT1AkMSA9IDB4MDAyRTsgLy8gVSswMDJFIEZVTEwgU1RPUCAoLilcblxuLy8gJy4nIGlkZW50XG52YXIgQ2xhc3NTZWxlY3RvciA9IHtcbiAgICBuYW1lOiAnQ2xhc3NTZWxlY3RvcicsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIG5hbWU6IFN0cmluZ1xuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMuc2Nhbm5lci5pc0RlbGltKEZVTExTVE9QJDEpKSB7XG4gICAgICAgICAgICB0aGlzLmVycm9yKCdGdWxsIHN0b3AgaXMgZXhwZWN0ZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdDbGFzc1NlbGVjdG9yJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbih0aGlzLnNjYW5uZXIudG9rZW5TdGFydCAtIDEsIHRoaXMuc2Nhbm5lci50b2tlbkVuZCksXG4gICAgICAgICAgICBuYW1lOiB0aGlzLmNvbnN1bWUoSURFTlQkNylcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsoJy4nKTtcbiAgICAgICAgdGhpcy5jaHVuayhub2RlLm5hbWUpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJGkgPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIElERU5UJDggPSBUWVBFJGkuSWRlbnQ7XG52YXIgUExVU1NJR04kMyA9IDB4MDAyQjsgICAgICAgIC8vIFUrMDAyQiBQTFVTIFNJR04gKCspXG52YXIgU09MSURVUyQyID0gMHgwMDJGOyAgICAgICAgIC8vIFUrMDAyRiBTT0xJRFVTICgvKVxudmFyIEdSRUFURVJUSEFOU0lHTiQxID0gMHgwMDNFOyAvLyBVKzAwM0UgR1JFQVRFUi1USEFOIFNJR04gKD4pXG52YXIgVElMREUkMiA9IDB4MDA3RTsgICAgICAgICAgIC8vIFUrMDA3RSBUSUxERSAofilcblxuLy8gKyB8ID4gfCB+IHwgL2RlZXAvXG52YXIgQ29tYmluYXRvciA9IHtcbiAgICBuYW1lOiAnQ29tYmluYXRvcicsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIG5hbWU6IFN0cmluZ1xuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydDtcbiAgICAgICAgdmFyIGNvZGUgPSB0aGlzLnNjYW5uZXIuc291cmNlLmNoYXJDb2RlQXQodGhpcy5zY2FubmVyLnRva2VuU3RhcnQpO1xuXG4gICAgICAgIHN3aXRjaCAoY29kZSkge1xuICAgICAgICAgICAgY2FzZSBHUkVBVEVSVEhBTlNJR04kMTpcbiAgICAgICAgICAgIGNhc2UgUExVU1NJR04kMzpcbiAgICAgICAgICAgIGNhc2UgVElMREUkMjpcbiAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIFNPTElEVVMkMjpcbiAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgIT09IElERU5UJDggfHwgdGhpcy5zY2FubmVyLmxvb2t1cFZhbHVlKDAsICdkZWVwJykgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IoJ0lkZW50aWZpZXIgYGRlZXBgIGlzIGV4cGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zY2FubmVyLmlzRGVsaW0oU09MSURVUyQyKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yKCdTb2xpZHVzIGlzIGV4cGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yKCdDb21iaW5hdG9yIGlzIGV4cGVjdGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ0NvbWJpbmF0b3InLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCksXG4gICAgICAgICAgICBuYW1lOiB0aGlzLnNjYW5uZXIuc3Vic3RyVG9DdXJzb3Ioc3RhcnQpXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNodW5rKG5vZGUubmFtZSk7XG4gICAgfVxufTtcblxudmFyIFRZUEUkaiA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgQ09NTUVOVCQ2ID0gVFlQRSRqLkNvbW1lbnQ7XG52YXIgQVNURVJJU0skMyA9IDB4MDAyQTsgICAgICAgIC8vIFUrMDAyQSBBU1RFUklTSyAoKilcbnZhciBTT0xJRFVTJDMgPSAweDAwMkY7ICAgICAgICAgLy8gVSswMDJGIFNPTElEVVMgKC8pXG5cbi8vICcvKicgLiogJyovJ1xudmFyIENvbW1lbnQgPSB7XG4gICAgbmFtZTogJ0NvbW1lbnQnLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICB2YWx1ZTogU3RyaW5nXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuICAgICAgICB2YXIgZW5kID0gdGhpcy5zY2FubmVyLnRva2VuRW5kO1xuXG4gICAgICAgIHRoaXMuZWF0KENPTU1FTlQkNik7XG5cbiAgICAgICAgaWYgKChlbmQgLSBzdGFydCArIDIpID49IDIgJiZcbiAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5zb3VyY2UuY2hhckNvZGVBdChlbmQgLSAyKSA9PT0gQVNURVJJU0skMyAmJlxuICAgICAgICAgICAgdGhpcy5zY2FubmVyLnNvdXJjZS5jaGFyQ29kZUF0KGVuZCAtIDEpID09PSBTT0xJRFVTJDMpIHtcbiAgICAgICAgICAgIGVuZCAtPSAyO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdDb21tZW50JyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2Nhbm5lci5zb3VyY2Uuc3Vic3RyaW5nKHN0YXJ0ICsgMiwgZW5kKVxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5jaHVuaygnLyonKTtcbiAgICAgICAgdGhpcy5jaHVuayhub2RlLnZhbHVlKTtcbiAgICAgICAgdGhpcy5jaHVuaygnKi8nKTtcbiAgICB9XG59O1xuXG52YXIgaGFzT3duUHJvcGVydHkkMSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIga2V5d29yZHMkMiA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG52YXIgcHJvcGVydGllcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG52YXIgSFlQSEVOTUlOVVMkMiA9IDQ1OyAvLyAnLScuY2hhckNvZGVBdCgpXG5cbmZ1bmN0aW9uIGlzQ3VzdG9tUHJvcGVydHkoc3RyLCBvZmZzZXQpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgIHJldHVybiBzdHIubGVuZ3RoIC0gb2Zmc2V0ID49IDIgJiZcbiAgICAgICAgICAgc3RyLmNoYXJDb2RlQXQob2Zmc2V0KSA9PT0gSFlQSEVOTUlOVVMkMiAmJlxuICAgICAgICAgICBzdHIuY2hhckNvZGVBdChvZmZzZXQgKyAxKSA9PT0gSFlQSEVOTUlOVVMkMjtcbn1cblxuZnVuY3Rpb24gZ2V0VmVuZG9yUHJlZml4KHN0ciwgb2Zmc2V0KSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XG5cbiAgICAvLyB2ZXJkb3IgcHJlZml4IHNob3VsZCBiZSBhdCBsZWFzdCAzIGNoYXJzIGxlbmd0aFxuICAgIGlmIChzdHIubGVuZ3RoIC0gb2Zmc2V0ID49IDMpIHtcbiAgICAgICAgLy8gdmVuZG9yIHByZWZpeCBzdGFydHMgd2l0aCBoeXBlciBtaW51cyBmb2xsb3dpbmcgbm9uLWh5cGVyIG1pbnVzXG4gICAgICAgIGlmIChzdHIuY2hhckNvZGVBdChvZmZzZXQpID09PSBIWVBIRU5NSU5VUyQyICYmXG4gICAgICAgICAgICBzdHIuY2hhckNvZGVBdChvZmZzZXQgKyAxKSAhPT0gSFlQSEVOTUlOVVMkMikge1xuICAgICAgICAgICAgLy8gdmVuZG9yIHByZWZpeCBzaG91bGQgY29udGFpbiBhIGh5cGVyIG1pbnVzIGF0IHRoZSBlbmRpbmdcbiAgICAgICAgICAgIHZhciBzZWNvbmREYXNoSW5kZXggPSBzdHIuaW5kZXhPZignLScsIG9mZnNldCArIDIpO1xuXG4gICAgICAgICAgICBpZiAoc2Vjb25kRGFzaEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKG9mZnNldCwgc2Vjb25kRGFzaEluZGV4ICsgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gJyc7XG59XG5cbmZ1bmN0aW9uIGdldEtleXdvcmREZXNjcmlwdG9yKGtleXdvcmQpIHtcbiAgICBpZiAoaGFzT3duUHJvcGVydHkkMS5jYWxsKGtleXdvcmRzJDIsIGtleXdvcmQpKSB7XG4gICAgICAgIHJldHVybiBrZXl3b3JkcyQyW2tleXdvcmRdO1xuICAgIH1cblxuICAgIHZhciBuYW1lID0ga2V5d29yZC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgaWYgKGhhc093blByb3BlcnR5JDEuY2FsbChrZXl3b3JkcyQyLCBuYW1lKSkge1xuICAgICAgICByZXR1cm4ga2V5d29yZHMkMltrZXl3b3JkXSA9IGtleXdvcmRzJDJbbmFtZV07XG4gICAgfVxuXG4gICAgdmFyIGN1c3RvbSA9IGlzQ3VzdG9tUHJvcGVydHkobmFtZSwgMCk7XG4gICAgdmFyIHZlbmRvciA9ICFjdXN0b20gPyBnZXRWZW5kb3JQcmVmaXgobmFtZSwgMCkgOiAnJztcblxuICAgIHJldHVybiBrZXl3b3JkcyQyW2tleXdvcmRdID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgICAgIGJhc2VuYW1lOiBuYW1lLnN1YnN0cih2ZW5kb3IubGVuZ3RoKSxcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgdmVuZG9yOiB2ZW5kb3IsXG4gICAgICAgIHByZWZpeDogdmVuZG9yLFxuICAgICAgICBjdXN0b206IGN1c3RvbVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRQcm9wZXJ0eURlc2NyaXB0b3IocHJvcGVydHkpIHtcbiAgICBpZiAoaGFzT3duUHJvcGVydHkkMS5jYWxsKHByb3BlcnRpZXMsIHByb3BlcnR5KSkge1xuICAgICAgICByZXR1cm4gcHJvcGVydGllc1twcm9wZXJ0eV07XG4gICAgfVxuXG4gICAgdmFyIG5hbWUgPSBwcm9wZXJ0eTtcbiAgICB2YXIgaGFjayA9IHByb3BlcnR5WzBdO1xuXG4gICAgaWYgKGhhY2sgPT09ICcvJykge1xuICAgICAgICBoYWNrID0gcHJvcGVydHlbMV0gPT09ICcvJyA/ICcvLycgOiAnLyc7XG4gICAgfSBlbHNlIGlmIChoYWNrICE9PSAnXycgJiZcbiAgICAgICAgICAgICAgIGhhY2sgIT09ICcqJyAmJlxuICAgICAgICAgICAgICAgaGFjayAhPT0gJyQnICYmXG4gICAgICAgICAgICAgICBoYWNrICE9PSAnIycgJiZcbiAgICAgICAgICAgICAgIGhhY2sgIT09ICcrJyAmJlxuICAgICAgICAgICAgICAgaGFjayAhPT0gJyYnKSB7XG4gICAgICAgIGhhY2sgPSAnJztcbiAgICB9XG5cbiAgICB2YXIgY3VzdG9tID0gaXNDdXN0b21Qcm9wZXJ0eShuYW1lLCBoYWNrLmxlbmd0aCk7XG5cbiAgICAvLyByZS11c2UgcmVzdWx0IHdoZW4gcG9zc2libGUgKHRoZSBzYW1lIGFzIGZvciBsb3dlciBjYXNlKVxuICAgIGlmICghY3VzdG9tKSB7XG4gICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eSQxLmNhbGwocHJvcGVydGllcywgbmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9wZXJ0aWVzW3Byb3BlcnR5XSA9IHByb3BlcnRpZXNbbmFtZV07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgdmVuZG9yID0gIWN1c3RvbSA/IGdldFZlbmRvclByZWZpeChuYW1lLCBoYWNrLmxlbmd0aCkgOiAnJztcbiAgICB2YXIgcHJlZml4ID0gbmFtZS5zdWJzdHIoMCwgaGFjay5sZW5ndGggKyB2ZW5kb3IubGVuZ3RoKTtcblxuICAgIHJldHVybiBwcm9wZXJ0aWVzW3Byb3BlcnR5XSA9IE9iamVjdC5mcmVlemUoe1xuICAgICAgICBiYXNlbmFtZTogbmFtZS5zdWJzdHIocHJlZml4Lmxlbmd0aCksXG4gICAgICAgIG5hbWU6IG5hbWUuc3Vic3RyKGhhY2subGVuZ3RoKSxcbiAgICAgICAgaGFjazogaGFjayxcbiAgICAgICAgdmVuZG9yOiB2ZW5kb3IsXG4gICAgICAgIHByZWZpeDogcHJlZml4LFxuICAgICAgICBjdXN0b206IGN1c3RvbVxuICAgIH0pO1xufVxuXG52YXIgbmFtZXMgPSB7XG4gICAga2V5d29yZDogZ2V0S2V5d29yZERlc2NyaXB0b3IsXG4gICAgcHJvcGVydHk6IGdldFByb3BlcnR5RGVzY3JpcHRvcixcbiAgICBpc0N1c3RvbVByb3BlcnR5OiBpc0N1c3RvbVByb3BlcnR5LFxuICAgIHZlbmRvclByZWZpeDogZ2V0VmVuZG9yUHJlZml4XG59O1xuXG52YXIgaXNDdXN0b21Qcm9wZXJ0eSQxID0gbmFtZXMuaXNDdXN0b21Qcm9wZXJ0eTtcbnZhciBUWVBFJGsgPSB0b2tlbml6ZXIuVFlQRTtcbnZhciByYXdNb2RlJDMgPSBSYXcubW9kZTtcblxudmFyIElERU5UJDkgPSBUWVBFJGsuSWRlbnQ7XG52YXIgSEFTSCQzID0gVFlQRSRrLkhhc2g7XG52YXIgQ09MT04kMyA9IFRZUEUkay5Db2xvbjtcbnZhciBTRU1JQ09MT04kMyA9IFRZUEUkay5TZW1pY29sb247XG52YXIgREVMSU0kMiA9IFRZUEUkay5EZWxpbTtcbnZhciBXSElURVNQQUNFJDcgPSBUWVBFJGsuV2hpdGVTcGFjZTtcbnZhciBFWENMQU1BVElPTk1BUkskMSA9IDB4MDAyMTsgLy8gVSswMDIxIEVYQ0xBTUFUSU9OIE1BUksgKCEpXG52YXIgTlVNQkVSU0lHTiQzID0gMHgwMDIzOyAgICAgIC8vIFUrMDAyMyBOVU1CRVIgU0lHTiAoIylcbnZhciBET0xMQVJTSUdOJDEgPSAweDAwMjQ7ICAgICAgLy8gVSswMDI0IERPTExBUiBTSUdOICgkKVxudmFyIEFNUEVSU0FORCA9IDB4MDAyNjsgICAgICAgLy8gVSswMDI2IEFOUEVSU0FORCAoJilcbnZhciBBU1RFUklTSyQ0ID0gMHgwMDJBOyAgICAgICAgLy8gVSswMDJBIEFTVEVSSVNLICgqKVxudmFyIFBMVVNTSUdOJDQgPSAweDAwMkI7ICAgICAgICAvLyBVKzAwMkIgUExVUyBTSUdOICgrKVxudmFyIFNPTElEVVMkNCA9IDB4MDAyRjsgICAgICAgICAvLyBVKzAwMkYgU09MSURVUyAoLylcblxuZnVuY3Rpb24gY29uc3VtZVZhbHVlUmF3KHN0YXJ0VG9rZW4pIHtcbiAgICByZXR1cm4gdGhpcy5SYXcoc3RhcnRUb2tlbiwgcmF3TW9kZSQzLmV4Y2xhbWF0aW9uTWFya09yU2VtaWNvbG9uLCB0cnVlKTtcbn1cblxuZnVuY3Rpb24gY29uc3VtZUN1c3RvbVByb3BlcnR5UmF3KHN0YXJ0VG9rZW4pIHtcbiAgICByZXR1cm4gdGhpcy5SYXcoc3RhcnRUb2tlbiwgcmF3TW9kZSQzLmV4Y2xhbWF0aW9uTWFya09yU2VtaWNvbG9uLCBmYWxzZSk7XG59XG5cbmZ1bmN0aW9uIGNvbnN1bWVWYWx1ZSgpIHtcbiAgICB2YXIgc3RhcnRWYWx1ZVRva2VuID0gdGhpcy5zY2FubmVyLnRva2VuSW5kZXg7XG4gICAgdmFyIHZhbHVlID0gdGhpcy5WYWx1ZSgpO1xuXG4gICAgaWYgKHZhbHVlLnR5cGUgIT09ICdSYXcnICYmXG4gICAgICAgIHRoaXMuc2Nhbm5lci5lb2YgPT09IGZhbHNlICYmXG4gICAgICAgIHRoaXMuc2Nhbm5lci50b2tlblR5cGUgIT09IFNFTUlDT0xPTiQzICYmXG4gICAgICAgIHRoaXMuc2Nhbm5lci5pc0RlbGltKEVYQ0xBTUFUSU9OTUFSSyQxKSA9PT0gZmFsc2UgJiZcbiAgICAgICAgdGhpcy5zY2FubmVyLmlzQmFsYW5jZUVkZ2Uoc3RhcnRWYWx1ZVRva2VuKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5lcnJvcigpO1xuICAgIH1cblxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxudmFyIERlY2xhcmF0aW9uID0ge1xuICAgIG5hbWU6ICdEZWNsYXJhdGlvbicsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIGltcG9ydGFudDogW0Jvb2xlYW4sIFN0cmluZ10sXG4gICAgICAgIHByb3BlcnR5OiBTdHJpbmcsXG4gICAgICAgIHZhbHVlOiBbJ1ZhbHVlJywgJ1JhdyddXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuICAgICAgICB2YXIgc3RhcnRUb2tlbiA9IHRoaXMuc2Nhbm5lci50b2tlbkluZGV4O1xuICAgICAgICB2YXIgcHJvcGVydHkgPSByZWFkUHJvcGVydHkuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIGN1c3RvbVByb3BlcnR5ID0gaXNDdXN0b21Qcm9wZXJ0eSQxKHByb3BlcnR5KTtcbiAgICAgICAgdmFyIHBhcnNlVmFsdWUgPSBjdXN0b21Qcm9wZXJ0eSA/IHRoaXMucGFyc2VDdXN0b21Qcm9wZXJ0eSA6IHRoaXMucGFyc2VWYWx1ZTtcbiAgICAgICAgdmFyIGNvbnN1bWVSYXcgPSBjdXN0b21Qcm9wZXJ0eSA/IGNvbnN1bWVDdXN0b21Qcm9wZXJ0eVJhdyA6IGNvbnN1bWVWYWx1ZVJhdztcbiAgICAgICAgdmFyIGltcG9ydGFudCA9IGZhbHNlO1xuICAgICAgICB2YXIgdmFsdWU7XG5cbiAgICAgICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuICAgICAgICB0aGlzLmVhdChDT0xPTiQzKTtcblxuICAgICAgICBjb25zdCB2YWx1ZVN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuSW5kZXg7XG5cbiAgICAgICAgaWYgKCFjdXN0b21Qcm9wZXJ0eSkge1xuICAgICAgICAgICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcnNlVmFsdWUpIHtcbiAgICAgICAgICAgIHZhbHVlID0gdGhpcy5wYXJzZVdpdGhGYWxsYmFjayhjb25zdW1lVmFsdWUsIGNvbnN1bWVSYXcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUgPSBjb25zdW1lUmF3LmNhbGwodGhpcywgdGhpcy5zY2FubmVyLnRva2VuSW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGN1c3RvbVByb3BlcnR5ICYmIHZhbHVlLnR5cGUgPT09ICdWYWx1ZScgJiYgdmFsdWUuY2hpbGRyZW4uaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBvZmZzZXQgPSB2YWx1ZVN0YXJ0IC0gdGhpcy5zY2FubmVyLnRva2VuSW5kZXg7IG9mZnNldCA8PSAwOyBvZmZzZXQrKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjYW5uZXIubG9va3VwVHlwZShvZmZzZXQpID09PSBXSElURVNQQUNFJDcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUuY2hpbGRyZW4uYXBwZW5kRGF0YSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnV2hpdGVTcGFjZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2M6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJyAnXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zY2FubmVyLmlzRGVsaW0oRVhDTEFNQVRJT05NQVJLJDEpKSB7XG4gICAgICAgICAgICBpbXBvcnRhbnQgPSBnZXRJbXBvcnRhbnQuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERvIG5vdCBpbmNsdWRlIHNlbWljb2xvbiB0byByYW5nZSBwZXIgc3BlY1xuICAgICAgICAvLyBodHRwczovL2RyYWZ0cy5jc3N3Zy5vcmcvY3NzLXN5bnRheC8jZGVjbGFyYXRpb24tZGlhZ3JhbVxuXG4gICAgICAgIGlmICh0aGlzLnNjYW5uZXIuZW9mID09PSBmYWxzZSAmJlxuICAgICAgICAgICAgdGhpcy5zY2FubmVyLnRva2VuVHlwZSAhPT0gU0VNSUNPTE9OJDMgJiZcbiAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5pc0JhbGFuY2VFZGdlKHN0YXJ0VG9rZW4pID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5lcnJvcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdEZWNsYXJhdGlvbicsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSxcbiAgICAgICAgICAgIGltcG9ydGFudDogaW1wb3J0YW50LFxuICAgICAgICAgICAgcHJvcGVydHk6IHByb3BlcnR5LFxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNodW5rKG5vZGUucHJvcGVydHkpO1xuICAgICAgICB0aGlzLmNodW5rKCc6Jyk7XG4gICAgICAgIHRoaXMubm9kZShub2RlLnZhbHVlKTtcblxuICAgICAgICBpZiAobm9kZS5pbXBvcnRhbnQpIHtcbiAgICAgICAgICAgIHRoaXMuY2h1bmsobm9kZS5pbXBvcnRhbnQgPT09IHRydWUgPyAnIWltcG9ydGFudCcgOiAnIScgKyBub2RlLmltcG9ydGFudCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHdhbGtDb250ZXh0OiAnZGVjbGFyYXRpb24nXG59O1xuXG5mdW5jdGlvbiByZWFkUHJvcGVydHkoKSB7XG4gICAgdmFyIHN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG5cbiAgICAvLyBoYWNrc1xuICAgIGlmICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlID09PSBERUxJTSQyKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5zY2FubmVyLnNvdXJjZS5jaGFyQ29kZUF0KHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSkge1xuICAgICAgICAgICAgY2FzZSBBU1RFUklTSyQ0OlxuICAgICAgICAgICAgY2FzZSBET0xMQVJTSUdOJDE6XG4gICAgICAgICAgICBjYXNlIFBMVVNTSUdOJDQ6XG4gICAgICAgICAgICBjYXNlIE5VTUJFUlNJR04kMzpcbiAgICAgICAgICAgIGNhc2UgQU1QRVJTQU5EOlxuICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIFRPRE86IG5vdCBzdXJlIHdlIHNob3VsZCBzdXBwb3J0IHRoaXMgaGFja1xuICAgICAgICAgICAgY2FzZSBTT0xJRFVTJDQ6XG4gICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zY2FubmVyLmlzRGVsaW0oU09MSURVUyQ0KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlID09PSBIQVNIJDMpIHtcbiAgICAgICAgdGhpcy5lYXQoSEFTSCQzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmVhdChJREVOVCQ5KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5zY2FubmVyLnN1YnN0clRvQ3Vyc29yKHN0YXJ0KTtcbn1cblxuLy8gISB3cyogaW1wb3J0YW50XG5mdW5jdGlvbiBnZXRJbXBvcnRhbnQoKSB7XG4gICAgdGhpcy5lYXQoREVMSU0kMik7XG4gICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuXG4gICAgdmFyIGltcG9ydGFudCA9IHRoaXMuY29uc3VtZShJREVOVCQ5KTtcblxuICAgIC8vIHN0b3JlIG9yaWdpbmFsIHZhbHVlIGluIGNhc2UgaXQgZGlmZmVyIGZyb20gYGltcG9ydGFudGBcbiAgICAvLyBmb3IgYmV0dGVyIG9yaWdpbmFsIHNvdXJjZSByZXN0b3JpbmcgYW5kIGhhY2tzIGxpa2UgYCFpZWAgc3VwcG9ydFxuICAgIHJldHVybiBpbXBvcnRhbnQgPT09ICdpbXBvcnRhbnQnID8gdHJ1ZSA6IGltcG9ydGFudDtcbn1cblxudmFyIFRZUEUkbCA9IHRva2VuaXplci5UWVBFO1xudmFyIHJhd01vZGUkNCA9IFJhdy5tb2RlO1xuXG52YXIgV0hJVEVTUEFDRSQ4ID0gVFlQRSRsLldoaXRlU3BhY2U7XG52YXIgQ09NTUVOVCQ3ID0gVFlQRSRsLkNvbW1lbnQ7XG52YXIgU0VNSUNPTE9OJDQgPSBUWVBFJGwuU2VtaWNvbG9uO1xuXG5mdW5jdGlvbiBjb25zdW1lUmF3JDMoc3RhcnRUb2tlbikge1xuICAgIHJldHVybiB0aGlzLlJhdyhzdGFydFRva2VuLCByYXdNb2RlJDQuc2VtaWNvbG9uSW5jbHVkZWQsIHRydWUpO1xufVxuXG52YXIgRGVjbGFyYXRpb25MaXN0ID0ge1xuICAgIG5hbWU6ICdEZWNsYXJhdGlvbkxpc3QnLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBjaGlsZHJlbjogW1tcbiAgICAgICAgICAgICdEZWNsYXJhdGlvbidcbiAgICAgICAgXV1cbiAgICB9LFxuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jcmVhdGVMaXN0KCk7XG5cbiAgICAgICAgXG4gICAgICAgIHdoaWxlICghdGhpcy5zY2FubmVyLmVvZikge1xuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBXSElURVNQQUNFJDg6XG4gICAgICAgICAgICAgICAgY2FzZSBDT01NRU5UJDc6XG4gICAgICAgICAgICAgICAgY2FzZSBTRU1JQ09MT04kNDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKHRoaXMucGFyc2VXaXRoRmFsbGJhY2sodGhpcy5EZWNsYXJhdGlvbiwgY29uc3VtZVJhdyQzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ0RlY2xhcmF0aW9uTGlzdCcsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb25Gcm9tTGlzdChjaGlsZHJlbiksXG4gICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4obm9kZSwgZnVuY3Rpb24ocHJldikge1xuICAgICAgICAgICAgaWYgKHByZXYudHlwZSA9PT0gJ0RlY2xhcmF0aW9uJykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2h1bmsoJzsnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufTtcblxudmFyIGNvbnN1bWVOdW1iZXIkMiA9IHV0aWxzLmNvbnN1bWVOdW1iZXI7XG52YXIgVFlQRSRtID0gdG9rZW5pemVyLlRZUEU7XG5cbnZhciBESU1FTlNJT04kMyA9IFRZUEUkbS5EaW1lbnNpb247XG5cbnZhciBEaW1lbnNpb24gPSB7XG4gICAgbmFtZTogJ0RpbWVuc2lvbicsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIHZhbHVlOiBTdHJpbmcsXG4gICAgICAgIHVuaXQ6IFN0cmluZ1xuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydDtcbiAgICAgICAgdmFyIG51bWJlckVuZCA9IGNvbnN1bWVOdW1iZXIkMih0aGlzLnNjYW5uZXIuc291cmNlLCBzdGFydCk7XG5cbiAgICAgICAgdGhpcy5lYXQoRElNRU5TSU9OJDMpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnRGltZW5zaW9uJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2Nhbm5lci5zb3VyY2Uuc3Vic3RyaW5nKHN0YXJ0LCBudW1iZXJFbmQpLFxuICAgICAgICAgICAgdW5pdDogdGhpcy5zY2FubmVyLnNvdXJjZS5zdWJzdHJpbmcobnVtYmVyRW5kLCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydClcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS52YWx1ZSk7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS51bml0KTtcbiAgICB9XG59O1xuXG52YXIgVFlQRSRuID0gdG9rZW5pemVyLlRZUEU7XG5cbnZhciBSSUdIVFBBUkVOVEhFU0lTID0gVFlQRSRuLlJpZ2h0UGFyZW50aGVzaXM7XG5cbi8vIDxmdW5jdGlvbi10b2tlbj4gPHNlcXVlbmNlPiApXG52YXIgX0Z1bmN0aW9uID0ge1xuICAgIG5hbWU6ICdGdW5jdGlvbicsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIG5hbWU6IFN0cmluZyxcbiAgICAgICAgY2hpbGRyZW46IFtbXV1cbiAgICB9LFxuICAgIHBhcnNlOiBmdW5jdGlvbihyZWFkU2VxdWVuY2UsIHJlY29nbml6ZXIpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG4gICAgICAgIHZhciBuYW1lID0gdGhpcy5jb25zdW1lRnVuY3Rpb25OYW1lKCk7XG4gICAgICAgIHZhciBuYW1lTG93ZXJDYXNlID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB2YXIgY2hpbGRyZW47XG5cbiAgICAgICAgY2hpbGRyZW4gPSByZWNvZ25pemVyLmhhc093blByb3BlcnR5KG5hbWVMb3dlckNhc2UpXG4gICAgICAgICAgICA/IHJlY29nbml6ZXJbbmFtZUxvd2VyQ2FzZV0uY2FsbCh0aGlzLCByZWNvZ25pemVyKVxuICAgICAgICAgICAgOiByZWFkU2VxdWVuY2UuY2FsbCh0aGlzLCByZWNvZ25pemVyKTtcblxuICAgICAgICBpZiAoIXRoaXMuc2Nhbm5lci5lb2YpIHtcbiAgICAgICAgICAgIHRoaXMuZWF0KFJJR0hUUEFSRU5USEVTSVMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdGdW5jdGlvbicsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSxcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS5uYW1lKTtcbiAgICAgICAgdGhpcy5jaHVuaygnKCcpO1xuICAgICAgICB0aGlzLmNoaWxkcmVuKG5vZGUpO1xuICAgICAgICB0aGlzLmNodW5rKCcpJyk7XG4gICAgfSxcbiAgICB3YWxrQ29udGV4dDogJ2Z1bmN0aW9uJ1xufTtcblxudmFyIFRZUEUkbyA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgSEFTSCQ0ID0gVFlQRSRvLkhhc2g7XG5cbi8vICcjJyBpZGVudFxudmFyIEhhc2ggPSB7XG4gICAgbmFtZTogJ0hhc2gnLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICB2YWx1ZTogU3RyaW5nXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuXG4gICAgICAgIHRoaXMuZWF0KEhBU0gkNCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdIYXNoJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2Nhbm5lci5zdWJzdHJUb0N1cnNvcihzdGFydCArIDEpXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNodW5rKCcjJyk7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS52YWx1ZSk7XG4gICAgfVxufTtcblxudmFyIFRZUEUkcCA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgSURFTlQkYSA9IFRZUEUkcC5JZGVudDtcblxudmFyIElkZW50aWZpZXIgPSB7XG4gICAgbmFtZTogJ0lkZW50aWZpZXInLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBuYW1lOiBTdHJpbmdcbiAgICB9LFxuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdJZGVudGlmaWVyJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbih0aGlzLnNjYW5uZXIudG9rZW5TdGFydCwgdGhpcy5zY2FubmVyLnRva2VuRW5kKSxcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuY29uc3VtZShJREVOVCRhKVxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5jaHVuayhub2RlLm5hbWUpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJHEgPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIEhBU0gkNSA9IFRZUEUkcS5IYXNoO1xuXG4vLyA8aGFzaC10b2tlbj5cbnZhciBJZFNlbGVjdG9yID0ge1xuICAgIG5hbWU6ICdJZFNlbGVjdG9yJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgbmFtZTogU3RyaW5nXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuXG4gICAgICAgIC8vIFRPRE86IGNoZWNrIHZhbHVlIGlzIGFuIGlkZW50XG4gICAgICAgIHRoaXMuZWF0KEhBU0gkNSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdJZFNlbGVjdG9yJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgbmFtZTogdGhpcy5zY2FubmVyLnN1YnN0clRvQ3Vyc29yKHN0YXJ0ICsgMSlcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsoJyMnKTtcbiAgICAgICAgdGhpcy5jaHVuayhub2RlLm5hbWUpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJHIgPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIElERU5UJGIgPSBUWVBFJHIuSWRlbnQ7XG52YXIgTlVNQkVSJDQgPSBUWVBFJHIuTnVtYmVyO1xudmFyIERJTUVOU0lPTiQ0ID0gVFlQRSRyLkRpbWVuc2lvbjtcbnZhciBMRUZUUEFSRU5USEVTSVMkMyA9IFRZUEUkci5MZWZ0UGFyZW50aGVzaXM7XG52YXIgUklHSFRQQVJFTlRIRVNJUyQxID0gVFlQRSRyLlJpZ2h0UGFyZW50aGVzaXM7XG52YXIgQ09MT04kNCA9IFRZUEUkci5Db2xvbjtcbnZhciBERUxJTSQzID0gVFlQRSRyLkRlbGltO1xuXG52YXIgTWVkaWFGZWF0dXJlID0ge1xuICAgIG5hbWU6ICdNZWRpYUZlYXR1cmUnLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBuYW1lOiBTdHJpbmcsXG4gICAgICAgIHZhbHVlOiBbJ0lkZW50aWZpZXInLCAnTnVtYmVyJywgJ0RpbWVuc2lvbicsICdSYXRpbycsIG51bGxdXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuICAgICAgICB2YXIgbmFtZTtcbiAgICAgICAgdmFyIHZhbHVlID0gbnVsbDtcblxuICAgICAgICB0aGlzLmVhdChMRUZUUEFSRU5USEVTSVMkMyk7XG4gICAgICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcblxuICAgICAgICBuYW1lID0gdGhpcy5jb25zdW1lKElERU5UJGIpO1xuICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgIT09IFJJR0hUUEFSRU5USEVTSVMkMSkge1xuICAgICAgICAgICAgdGhpcy5lYXQoQ09MT04kNCk7XG4gICAgICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5zY2FubmVyLnRva2VuVHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgTlVNQkVSJDQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmxvb2t1cE5vbldTVHlwZSgxKSA9PT0gREVMSU0kMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLlJhdGlvKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuTnVtYmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgRElNRU5TSU9OJDQ6XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5EaW1lbnNpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIElERU5UJGI6XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5JZGVudGlmaWVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yKCdOdW1iZXIsIGRpbWVuc2lvbiwgcmF0aW8gb3IgaWRlbnRpZmllciBpcyBleHBlY3RlZCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVhdChSSUdIVFBBUkVOVEhFU0lTJDEpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnTWVkaWFGZWF0dXJlJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5jaHVuaygnKCcpO1xuICAgICAgICB0aGlzLmNodW5rKG5vZGUubmFtZSk7XG4gICAgICAgIGlmIChub2RlLnZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmNodW5rKCc6Jyk7XG4gICAgICAgICAgICB0aGlzLm5vZGUobm9kZS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jaHVuaygnKScpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJHMgPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIFdISVRFU1BBQ0UkOSA9IFRZUEUkcy5XaGl0ZVNwYWNlO1xudmFyIENPTU1FTlQkOCA9IFRZUEUkcy5Db21tZW50O1xudmFyIElERU5UJGMgPSBUWVBFJHMuSWRlbnQ7XG52YXIgTEVGVFBBUkVOVEhFU0lTJDQgPSBUWVBFJHMuTGVmdFBhcmVudGhlc2lzO1xuXG52YXIgTWVkaWFRdWVyeSA9IHtcbiAgICBuYW1lOiAnTWVkaWFRdWVyeScsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIGNoaWxkcmVuOiBbW1xuICAgICAgICAgICAgJ0lkZW50aWZpZXInLFxuICAgICAgICAgICAgJ01lZGlhRmVhdHVyZScsXG4gICAgICAgICAgICAnV2hpdGVTcGFjZSdcbiAgICAgICAgXV1cbiAgICB9LFxuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY3JlYXRlTGlzdCgpO1xuICAgICAgICB2YXIgY2hpbGQgPSBudWxsO1xuICAgICAgICB2YXIgc3BhY2UgPSBudWxsO1xuXG4gICAgICAgIHNjYW46XG4gICAgICAgIHdoaWxlICghdGhpcy5zY2FubmVyLmVvZikge1xuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBDT01NRU5UJDg6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBXSElURVNQQUNFJDk6XG4gICAgICAgICAgICAgICAgICAgIHNwYWNlID0gdGhpcy5XaGl0ZVNwYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBJREVOVCRjOlxuICAgICAgICAgICAgICAgICAgICBjaGlsZCA9IHRoaXMuSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgTEVGVFBBUkVOVEhFU0lTJDQ6XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkID0gdGhpcy5NZWRpYUZlYXR1cmUoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhayBzY2FuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc3BhY2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKHNwYWNlKTtcbiAgICAgICAgICAgICAgICBzcGFjZSA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNoaWxkID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmVycm9yKCdJZGVudGlmaWVyIG9yIHBhcmVudGhlc2lzIGlzIGV4cGVjdGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ01lZGlhUXVlcnknLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uRnJvbUxpc3QoY2hpbGRyZW4pLFxuICAgICAgICAgICAgY2hpbGRyZW46IGNoaWxkcmVuXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNoaWxkcmVuKG5vZGUpO1xuICAgIH1cbn07XG5cbnZhciBDT01NQSQyID0gdG9rZW5pemVyLlRZUEUuQ29tbWE7XG5cbnZhciBNZWRpYVF1ZXJ5TGlzdCA9IHtcbiAgICBuYW1lOiAnTWVkaWFRdWVyeUxpc3QnLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBjaGlsZHJlbjogW1tcbiAgICAgICAgICAgICdNZWRpYVF1ZXJ5J1xuICAgICAgICBdXVxuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKHJlbGF0aXZlKSB7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY3JlYXRlTGlzdCgpO1xuXG4gICAgICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcblxuICAgICAgICB3aGlsZSAoIXRoaXMuc2Nhbm5lci5lb2YpIHtcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godGhpcy5NZWRpYVF1ZXJ5KHJlbGF0aXZlKSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlICE9PSBDT01NQSQyKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ01lZGlhUXVlcnlMaXN0JyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbkZyb21MaXN0KGNoaWxkcmVuKSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBjaGlsZHJlblxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbihub2RlLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuY2h1bmsoJywnKTtcbiAgICAgICAgfSk7XG4gICAgfVxufTtcblxudmFyIE50aCA9IHtcbiAgICBuYW1lOiAnTnRoJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgbnRoOiBbJ0FuUGx1c0InLCAnSWRlbnRpZmllciddLFxuICAgICAgICBzZWxlY3RvcjogWydTZWxlY3Rvckxpc3QnLCBudWxsXVxuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKGFsbG93T2ZDbGF1c2UpIHtcbiAgICAgICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuXG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuICAgICAgICB2YXIgZW5kID0gc3RhcnQ7XG4gICAgICAgIHZhciBzZWxlY3RvciA9IG51bGw7XG4gICAgICAgIHZhciBxdWVyeTtcblxuICAgICAgICBpZiAodGhpcy5zY2FubmVyLmxvb2t1cFZhbHVlKDAsICdvZGQnKSB8fCB0aGlzLnNjYW5uZXIubG9va3VwVmFsdWUoMCwgJ2V2ZW4nKSkge1xuICAgICAgICAgICAgcXVlcnkgPSB0aGlzLklkZW50aWZpZXIoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gdGhpcy5BblBsdXNCKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG5cbiAgICAgICAgaWYgKGFsbG93T2ZDbGF1c2UgJiYgdGhpcy5zY2FubmVyLmxvb2t1cFZhbHVlKDAsICdvZicpKSB7XG4gICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuXG4gICAgICAgICAgICBzZWxlY3RvciA9IHRoaXMuU2VsZWN0b3JMaXN0KCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm5lZWRQb3NpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBlbmQgPSB0aGlzLmdldExhc3RMaXN0Tm9kZShzZWxlY3Rvci5jaGlsZHJlbikubG9jLmVuZC5vZmZzZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5uZWVkUG9zaXRpb25zKSB7XG4gICAgICAgICAgICAgICAgZW5kID0gcXVlcnkubG9jLmVuZC5vZmZzZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ050aCcsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnQsIGVuZCksXG4gICAgICAgICAgICBudGg6IHF1ZXJ5LFxuICAgICAgICAgICAgc2VsZWN0b3I6IHNlbGVjdG9yXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLm5vZGUobm9kZS5udGgpO1xuICAgICAgICBpZiAobm9kZS5zZWxlY3RvciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5jaHVuaygnIG9mICcpO1xuICAgICAgICAgICAgdGhpcy5ub2RlKG5vZGUuc2VsZWN0b3IpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxudmFyIE5VTUJFUiQ1ID0gdG9rZW5pemVyLlRZUEUuTnVtYmVyO1xuXG52YXIgX051bWJlciA9IHtcbiAgICBuYW1lOiAnTnVtYmVyJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgdmFsdWU6IFN0cmluZ1xuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ051bWJlcicsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24odGhpcy5zY2FubmVyLnRva2VuU3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlbkVuZCksXG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5jb25zdW1lKE5VTUJFUiQ1KVxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5jaHVuayhub2RlLnZhbHVlKTtcbiAgICB9XG59O1xuXG4vLyAnLycgfCAnKicgfCAnLCcgfCAnOicgfCAnKycgfCAnLSdcbnZhciBPcGVyYXRvciA9IHtcbiAgICBuYW1lOiAnT3BlcmF0b3InLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICB2YWx1ZTogU3RyaW5nXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuXG4gICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdPcGVyYXRvcicsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnNjYW5uZXIuc3Vic3RyVG9DdXJzb3Ioc3RhcnQpXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNodW5rKG5vZGUudmFsdWUpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJHQgPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIExFRlRQQVJFTlRIRVNJUyQ1ID0gVFlQRSR0LkxlZnRQYXJlbnRoZXNpcztcbnZhciBSSUdIVFBBUkVOVEhFU0lTJDIgPSBUWVBFJHQuUmlnaHRQYXJlbnRoZXNpcztcblxudmFyIFBhcmVudGhlc2VzID0ge1xuICAgIG5hbWU6ICdQYXJlbnRoZXNlcycsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIGNoaWxkcmVuOiBbW11dXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24ocmVhZFNlcXVlbmNlLCByZWNvZ25pemVyKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBudWxsO1xuXG4gICAgICAgIHRoaXMuZWF0KExFRlRQQVJFTlRIRVNJUyQ1KTtcblxuICAgICAgICBjaGlsZHJlbiA9IHJlYWRTZXF1ZW5jZS5jYWxsKHRoaXMsIHJlY29nbml6ZXIpO1xuXG4gICAgICAgIGlmICghdGhpcy5zY2FubmVyLmVvZikge1xuICAgICAgICAgICAgdGhpcy5lYXQoUklHSFRQQVJFTlRIRVNJUyQyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnUGFyZW50aGVzZXMnLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCksXG4gICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsoJygnKTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbihub2RlKTtcbiAgICAgICAgdGhpcy5jaHVuaygnKScpO1xuICAgIH1cbn07XG5cbnZhciBjb25zdW1lTnVtYmVyJDMgPSB1dGlscy5jb25zdW1lTnVtYmVyO1xudmFyIFRZUEUkdSA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgUEVSQ0VOVEFHRSQzID0gVFlQRSR1LlBlcmNlbnRhZ2U7XG5cbnZhciBQZXJjZW50YWdlID0ge1xuICAgIG5hbWU6ICdQZXJjZW50YWdlJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgdmFsdWU6IFN0cmluZ1xuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydDtcbiAgICAgICAgdmFyIG51bWJlckVuZCA9IGNvbnN1bWVOdW1iZXIkMyh0aGlzLnNjYW5uZXIuc291cmNlLCBzdGFydCk7XG5cbiAgICAgICAgdGhpcy5lYXQoUEVSQ0VOVEFHRSQzKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ1BlcmNlbnRhZ2UnLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCksXG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5zY2FubmVyLnNvdXJjZS5zdWJzdHJpbmcoc3RhcnQsIG51bWJlckVuZClcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS52YWx1ZSk7XG4gICAgICAgIHRoaXMuY2h1bmsoJyUnKTtcbiAgICB9XG59O1xuXG52YXIgVFlQRSR2ID0gdG9rZW5pemVyLlRZUEU7XG5cbnZhciBJREVOVCRkID0gVFlQRSR2LklkZW50O1xudmFyIEZVTkNUSU9OJDQgPSBUWVBFJHYuRnVuY3Rpb247XG52YXIgQ09MT04kNSA9IFRZUEUkdi5Db2xvbjtcbnZhciBSSUdIVFBBUkVOVEhFU0lTJDMgPSBUWVBFJHYuUmlnaHRQYXJlbnRoZXNpcztcblxuLy8gOiBbIDxpZGVudD4gfCA8ZnVuY3Rpb24tdG9rZW4+IDxhbnktdmFsdWU+PyApIF1cbnZhciBQc2V1ZG9DbGFzc1NlbGVjdG9yID0ge1xuICAgIG5hbWU6ICdQc2V1ZG9DbGFzc1NlbGVjdG9yJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgbmFtZTogU3RyaW5nLFxuICAgICAgICBjaGlsZHJlbjogW1snUmF3J10sIG51bGxdXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBudWxsO1xuICAgICAgICB2YXIgbmFtZTtcbiAgICAgICAgdmFyIG5hbWVMb3dlckNhc2U7XG5cbiAgICAgICAgdGhpcy5lYXQoQ09MT04kNSk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgPT09IEZVTkNUSU9OJDQpIHtcbiAgICAgICAgICAgIG5hbWUgPSB0aGlzLmNvbnN1bWVGdW5jdGlvbk5hbWUoKTtcbiAgICAgICAgICAgIG5hbWVMb3dlckNhc2UgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnBzZXVkby5oYXNPd25Qcm9wZXJ0eShuYW1lTG93ZXJDYXNlKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHRoaXMucHNldWRvW25hbWVMb3dlckNhc2VdLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLnNraXBTQygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHRoaXMuY3JlYXRlTGlzdCgpO1xuICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuUmF3KHRoaXMuc2Nhbm5lci50b2tlbkluZGV4LCBudWxsLCBmYWxzZSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmVhdChSSUdIVFBBUkVOVEhFU0lTJDMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmFtZSA9IHRoaXMuY29uc3VtZShJREVOVCRkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnUHNldWRvQ2xhc3NTZWxlY3RvcicsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSxcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsoJzonKTtcbiAgICAgICAgdGhpcy5jaHVuayhub2RlLm5hbWUpO1xuXG4gICAgICAgIGlmIChub2RlLmNoaWxkcmVuICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmNodW5rKCcoJyk7XG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuKG5vZGUpO1xuICAgICAgICAgICAgdGhpcy5jaHVuaygnKScpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB3YWxrQ29udGV4dDogJ2Z1bmN0aW9uJ1xufTtcblxudmFyIFRZUEUkdyA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgSURFTlQkZSA9IFRZUEUkdy5JZGVudDtcbnZhciBGVU5DVElPTiQ1ID0gVFlQRSR3LkZ1bmN0aW9uO1xudmFyIENPTE9OJDYgPSBUWVBFJHcuQ29sb247XG52YXIgUklHSFRQQVJFTlRIRVNJUyQ0ID0gVFlQRSR3LlJpZ2h0UGFyZW50aGVzaXM7XG5cbi8vIDo6IFsgPGlkZW50PiB8IDxmdW5jdGlvbi10b2tlbj4gPGFueS12YWx1ZT4/ICkgXVxudmFyIFBzZXVkb0VsZW1lbnRTZWxlY3RvciA9IHtcbiAgICBuYW1lOiAnUHNldWRvRWxlbWVudFNlbGVjdG9yJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgbmFtZTogU3RyaW5nLFxuICAgICAgICBjaGlsZHJlbjogW1snUmF3J10sIG51bGxdXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBudWxsO1xuICAgICAgICB2YXIgbmFtZTtcbiAgICAgICAgdmFyIG5hbWVMb3dlckNhc2U7XG5cbiAgICAgICAgdGhpcy5lYXQoQ09MT04kNik7XG4gICAgICAgIHRoaXMuZWF0KENPTE9OJDYpO1xuXG4gICAgICAgIGlmICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlID09PSBGVU5DVElPTiQ1KSB7XG4gICAgICAgICAgICBuYW1lID0gdGhpcy5jb25zdW1lRnVuY3Rpb25OYW1lKCk7XG4gICAgICAgICAgICBuYW1lTG93ZXJDYXNlID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5wc2V1ZG8uaGFzT3duUHJvcGVydHkobmFtZUxvd2VyQ2FzZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG4gICAgICAgICAgICAgICAgY2hpbGRyZW4gPSB0aGlzLnBzZXVkb1tuYW1lTG93ZXJDYXNlXS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2hpbGRyZW4gPSB0aGlzLmNyZWF0ZUxpc3QoKTtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLlJhdyh0aGlzLnNjYW5uZXIudG9rZW5JbmRleCwgbnVsbCwgZmFsc2UpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5lYXQoUklHSFRQQVJFTlRIRVNJUyQ0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5hbWUgPSB0aGlzLmNvbnN1bWUoSURFTlQkZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ1BzZXVkb0VsZW1lbnRTZWxlY3RvcicsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSxcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsoJzo6Jyk7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS5uYW1lKTtcblxuICAgICAgICBpZiAobm9kZS5jaGlsZHJlbiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5jaHVuaygnKCcpO1xuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbihub2RlKTtcbiAgICAgICAgICAgIHRoaXMuY2h1bmsoJyknKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgd2Fsa0NvbnRleHQ6ICdmdW5jdGlvbidcbn07XG5cbnZhciBpc0RpZ2l0JDMgPSB0b2tlbml6ZXIuaXNEaWdpdDtcbnZhciBUWVBFJHggPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIE5VTUJFUiQ2ID0gVFlQRSR4Lk51bWJlcjtcbnZhciBERUxJTSQ0ID0gVFlQRSR4LkRlbGltO1xudmFyIFNPTElEVVMkNSA9IDB4MDAyRjsgIC8vIFUrMDAyRiBTT0xJRFVTICgvKVxudmFyIEZVTExTVE9QJDIgPSAweDAwMkU7IC8vIFUrMDAyRSBGVUxMIFNUT1AgKC4pXG5cbi8vIFRlcm1zIG9mIDxyYXRpbz4gc2hvdWxkIGJlIGEgcG9zaXRpdmUgbnVtYmVycyAobm90IHplcm8gb3IgbmVnYXRpdmUpXG4vLyAoc2VlIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9tZWRpYXF1ZXJpZXMtMy8jdmFsdWVzKVxuLy8gSG93ZXZlciwgLW8tbWluLWRldmljZS1waXhlbC1yYXRpbyB0YWtlcyBmcmFjdGlvbmFsIHZhbHVlcyBhcyBhIHJhdGlvJ3MgdGVybVxuLy8gYW5kIHRoaXMgaXMgdXNpbmcgYnkgdmFyaW91cyBzaXRlcy4gVGhlcmVmb3JlIHdlIHJlbGF4IGNoZWNraW5nIG9uIHBhcnNlXG4vLyB0byB0ZXN0IGEgdGVybSBpcyB1bnNpZ25lZCBudW1iZXIgd2l0aG91dCBhbiBleHBvbmVudCBwYXJ0LlxuLy8gQWRkaXRpb25hbCBjaGVja2luZyBtYXkgYmUgYXBwbGllZCBvbiBsZXhlciB2YWxpZGF0aW9uLlxuZnVuY3Rpb24gY29uc3VtZU51bWJlciQ0KCkge1xuICAgIHRoaXMuc2Nhbm5lci5za2lwV1MoKTtcblxuICAgIHZhciB2YWx1ZSA9IHRoaXMuY29uc3VtZShOVU1CRVIkNik7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjb2RlID0gdmFsdWUuY2hhckNvZGVBdChpKTtcbiAgICAgICAgaWYgKCFpc0RpZ2l0JDMoY29kZSkgJiYgY29kZSAhPT0gRlVMTFNUT1AkMikge1xuICAgICAgICAgICAgdGhpcy5lcnJvcignVW5zaWduZWQgbnVtYmVyIGlzIGV4cGVjdGVkJywgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQgLSB2YWx1ZS5sZW5ndGggKyBpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChOdW1iZXIodmFsdWUpID09PSAwKSB7XG4gICAgICAgIHRoaXMuZXJyb3IoJ1plcm8gbnVtYmVyIGlzIG5vdCBhbGxvd2VkJywgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQgLSB2YWx1ZS5sZW5ndGgpO1xuICAgIH1cblxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxuLy8gPHBvc2l0aXZlLWludGVnZXI+IFMqICcvJyBTKiA8cG9zaXRpdmUtaW50ZWdlcj5cbnZhciBSYXRpbyA9IHtcbiAgICBuYW1lOiAnUmF0aW8nLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBsZWZ0OiBTdHJpbmcsXG4gICAgICAgIHJpZ2h0OiBTdHJpbmdcbiAgICB9LFxuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG4gICAgICAgIHZhciBsZWZ0ID0gY29uc3VtZU51bWJlciQ0LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciByaWdodDtcblxuICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFdTKCk7XG5cbiAgICAgICAgaWYgKCF0aGlzLnNjYW5uZXIuaXNEZWxpbShTT0xJRFVTJDUpKSB7XG4gICAgICAgICAgICB0aGlzLmVycm9yKCdTb2xpZHVzIGlzIGV4cGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lYXQoREVMSU0kNCk7XG4gICAgICAgIHJpZ2h0ID0gY29uc3VtZU51bWJlciQ0LmNhbGwodGhpcyk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdSYXRpbycsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSxcbiAgICAgICAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICAgICAgICByaWdodDogcmlnaHRcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS5sZWZ0KTtcbiAgICAgICAgdGhpcy5jaHVuaygnLycpO1xuICAgICAgICB0aGlzLmNodW5rKG5vZGUucmlnaHQpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJHkgPSB0b2tlbml6ZXIuVFlQRTtcbnZhciByYXdNb2RlJDUgPSBSYXcubW9kZTtcblxudmFyIExFRlRDVVJMWUJSQUNLRVQkMyA9IFRZUEUkeS5MZWZ0Q3VybHlCcmFja2V0O1xuXG5mdW5jdGlvbiBjb25zdW1lUmF3JDQoc3RhcnRUb2tlbikge1xuICAgIHJldHVybiB0aGlzLlJhdyhzdGFydFRva2VuLCByYXdNb2RlJDUubGVmdEN1cmx5QnJhY2tldCwgdHJ1ZSk7XG59XG5cbmZ1bmN0aW9uIGNvbnN1bWVQcmVsdWRlKCkge1xuICAgIHZhciBwcmVsdWRlID0gdGhpcy5TZWxlY3Rvckxpc3QoKTtcblxuICAgIGlmIChwcmVsdWRlLnR5cGUgIT09ICdSYXcnICYmXG4gICAgICAgIHRoaXMuc2Nhbm5lci5lb2YgPT09IGZhbHNlICYmXG4gICAgICAgIHRoaXMuc2Nhbm5lci50b2tlblR5cGUgIT09IExFRlRDVVJMWUJSQUNLRVQkMykge1xuICAgICAgICB0aGlzLmVycm9yKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByZWx1ZGU7XG59XG5cbnZhciBSdWxlID0ge1xuICAgIG5hbWU6ICdSdWxlJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgcHJlbHVkZTogWydTZWxlY3Rvckxpc3QnLCAnUmF3J10sXG4gICAgICAgIGJsb2NrOiBbJ0Jsb2NrJ11cbiAgICB9LFxuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXJ0VG9rZW4gPSB0aGlzLnNjYW5uZXIudG9rZW5JbmRleDtcbiAgICAgICAgdmFyIHN0YXJ0T2Zmc2V0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG4gICAgICAgIHZhciBwcmVsdWRlO1xuICAgICAgICB2YXIgYmxvY2s7XG5cbiAgICAgICAgaWYgKHRoaXMucGFyc2VSdWxlUHJlbHVkZSkge1xuICAgICAgICAgICAgcHJlbHVkZSA9IHRoaXMucGFyc2VXaXRoRmFsbGJhY2soY29uc3VtZVByZWx1ZGUsIGNvbnN1bWVSYXckNCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcmVsdWRlID0gY29uc3VtZVJhdyQ0LmNhbGwodGhpcywgc3RhcnRUb2tlbik7XG4gICAgICAgIH1cblxuICAgICAgICBibG9jayA9IHRoaXMuQmxvY2sodHJ1ZSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdSdWxlJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydE9mZnNldCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgcHJlbHVkZTogcHJlbHVkZSxcbiAgICAgICAgICAgIGJsb2NrOiBibG9ja1xuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5ub2RlKG5vZGUucHJlbHVkZSk7XG4gICAgICAgIHRoaXMubm9kZShub2RlLmJsb2NrKTtcbiAgICB9LFxuICAgIHdhbGtDb250ZXh0OiAncnVsZSdcbn07XG5cbnZhciBTZWxlY3RvciA9IHtcbiAgICBuYW1lOiAnU2VsZWN0b3InLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBjaGlsZHJlbjogW1tcbiAgICAgICAgICAgICdUeXBlU2VsZWN0b3InLFxuICAgICAgICAgICAgJ0lkU2VsZWN0b3InLFxuICAgICAgICAgICAgJ0NsYXNzU2VsZWN0b3InLFxuICAgICAgICAgICAgJ0F0dHJpYnV0ZVNlbGVjdG9yJyxcbiAgICAgICAgICAgICdQc2V1ZG9DbGFzc1NlbGVjdG9yJyxcbiAgICAgICAgICAgICdQc2V1ZG9FbGVtZW50U2VsZWN0b3InLFxuICAgICAgICAgICAgJ0NvbWJpbmF0b3InLFxuICAgICAgICAgICAgJ1doaXRlU3BhY2UnXG4gICAgICAgIF1dXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IHRoaXMucmVhZFNlcXVlbmNlKHRoaXMuc2NvcGUuU2VsZWN0b3IpO1xuXG4gICAgICAgIC8vIG5vdGhpbmcgd2VyZSBjb25zdW1lZFxuICAgICAgICBpZiAodGhpcy5nZXRGaXJzdExpc3ROb2RlKGNoaWxkcmVuKSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5lcnJvcignU2VsZWN0b3IgaXMgZXhwZWN0ZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnU2VsZWN0b3InLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uRnJvbUxpc3QoY2hpbGRyZW4pLFxuICAgICAgICAgICAgY2hpbGRyZW46IGNoaWxkcmVuXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNoaWxkcmVuKG5vZGUpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJHogPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIENPTU1BJDMgPSBUWVBFJHouQ29tbWE7XG5cbnZhciBTZWxlY3Rvckxpc3QgPSB7XG4gICAgbmFtZTogJ1NlbGVjdG9yTGlzdCcsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIGNoaWxkcmVuOiBbW1xuICAgICAgICAgICAgJ1NlbGVjdG9yJyxcbiAgICAgICAgICAgICdSYXcnXG4gICAgICAgIF1dXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY3JlYXRlTGlzdCgpO1xuXG4gICAgICAgIHdoaWxlICghdGhpcy5zY2FubmVyLmVvZikge1xuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaCh0aGlzLlNlbGVjdG9yKCkpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuVHlwZSA9PT0gQ09NTUEkMykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdTZWxlY3Rvckxpc3QnLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uRnJvbUxpc3QoY2hpbGRyZW4pLFxuICAgICAgICAgICAgY2hpbGRyZW46IGNoaWxkcmVuXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNoaWxkcmVuKG5vZGUsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5jaHVuaygnLCcpO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIHdhbGtDb250ZXh0OiAnc2VsZWN0b3InXG59O1xuXG52YXIgU1RSSU5HJDMgPSB0b2tlbml6ZXIuVFlQRS5TdHJpbmc7XG5cbnZhciBfU3RyaW5nID0ge1xuICAgIG5hbWU6ICdTdHJpbmcnLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICB2YWx1ZTogU3RyaW5nXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnU3RyaW5nJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbih0aGlzLnNjYW5uZXIudG9rZW5TdGFydCwgdGhpcy5zY2FubmVyLnRva2VuRW5kKSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLmNvbnN1bWUoU1RSSU5HJDMpXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNodW5rKG5vZGUudmFsdWUpO1xuICAgIH1cbn07XG5cbnZhciBUWVBFJEEgPSB0b2tlbml6ZXIuVFlQRTtcblxudmFyIFdISVRFU1BBQ0UkYSA9IFRZUEUkQS5XaGl0ZVNwYWNlO1xudmFyIENPTU1FTlQkOSA9IFRZUEUkQS5Db21tZW50O1xudmFyIEFUS0VZV09SRCQyID0gVFlQRSRBLkF0S2V5d29yZDtcbnZhciBDRE8kMSA9IFRZUEUkQS5DRE87XG52YXIgQ0RDJDEgPSBUWVBFJEEuQ0RDO1xudmFyIEVYQ0xBTUFUSU9OTUFSSyQyID0gMHgwMDIxOyAvLyBVKzAwMjEgRVhDTEFNQVRJT04gTUFSSyAoISlcblxuZnVuY3Rpb24gY29uc3VtZVJhdyQ1KHN0YXJ0VG9rZW4pIHtcbiAgICByZXR1cm4gdGhpcy5SYXcoc3RhcnRUb2tlbiwgbnVsbCwgZmFsc2UpO1xufVxuXG52YXIgU3R5bGVTaGVldCA9IHtcbiAgICBuYW1lOiAnU3R5bGVTaGVldCcsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIGNoaWxkcmVuOiBbW1xuICAgICAgICAgICAgJ0NvbW1lbnQnLFxuICAgICAgICAgICAgJ0NETycsXG4gICAgICAgICAgICAnQ0RDJyxcbiAgICAgICAgICAgICdBdHJ1bGUnLFxuICAgICAgICAgICAgJ1J1bGUnLFxuICAgICAgICAgICAgJ1JhdydcbiAgICAgICAgXV1cbiAgICB9LFxuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQ7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY3JlYXRlTGlzdCgpO1xuICAgICAgICB2YXIgY2hpbGQ7XG5cbiAgICAgICAgXG4gICAgICAgIHdoaWxlICghdGhpcy5zY2FubmVyLmVvZikge1xuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBXSElURVNQQUNFJGE6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgY2FzZSBDT01NRU5UJDk6XG4gICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBjb21tZW50cyBleGNlcHQgZXhjbGFtYXRpb24gY29tbWVudHMgKGkuZS4gLyohIC4uICovKSBvbiB0b3AgbGV2ZWxcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci5zb3VyY2UuY2hhckNvZGVBdCh0aGlzLnNjYW5uZXIudG9rZW5TdGFydCArIDIpICE9PSBFWENMQU1BVElPTk1BUkskMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSB0aGlzLkNvbW1lbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIENETyQxOiAvLyA8IS0tXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkID0gdGhpcy5DRE8oKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIENEQyQxOiAvLyAtLT5cbiAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSB0aGlzLkNEQygpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIC8vIENTUyBTeW50YXggTW9kdWxlIExldmVsIDNcbiAgICAgICAgICAgICAgICAvLyDCpzIuMiBFcnJvciBoYW5kbGluZ1xuICAgICAgICAgICAgICAgIC8vIEF0IHRoZSBcInRvcCBsZXZlbFwiIG9mIGEgc3R5bGVzaGVldCwgYW4gPGF0LWtleXdvcmQtdG9rZW4+IHN0YXJ0cyBhbiBhdC1ydWxlLlxuICAgICAgICAgICAgICAgIGNhc2UgQVRLRVlXT1JEJDI6XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkID0gdGhpcy5wYXJzZVdpdGhGYWxsYmFjayh0aGlzLkF0cnVsZSwgY29uc3VtZVJhdyQ1KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAvLyBBbnl0aGluZyBlbHNlIHN0YXJ0cyBhIHF1YWxpZmllZCBydWxlIC4uLlxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkID0gdGhpcy5wYXJzZVdpdGhGYWxsYmFjayh0aGlzLlJ1bGUsIGNvbnN1bWVSYXckNSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdTdHlsZVNoZWV0JyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgY2hpbGRyZW46IGNoaWxkcmVuXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBnZW5lcmF0ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICB0aGlzLmNoaWxkcmVuKG5vZGUpO1xuICAgIH0sXG4gICAgd2Fsa0NvbnRleHQ6ICdzdHlsZXNoZWV0J1xufTtcblxudmFyIFRZUEUkQiA9IHRva2VuaXplci5UWVBFO1xuXG52YXIgSURFTlQkZiA9IFRZUEUkQi5JZGVudDtcbnZhciBBU1RFUklTSyQ1ID0gMHgwMDJBOyAgICAgLy8gVSswMDJBIEFTVEVSSVNLICgqKVxudmFyIFZFUlRJQ0FMTElORSQyID0gMHgwMDdDOyAvLyBVKzAwN0MgVkVSVElDQUwgTElORSAofClcblxuZnVuY3Rpb24gZWF0SWRlbnRpZmllck9yQXN0ZXJpc2soKSB7XG4gICAgaWYgKHRoaXMuc2Nhbm5lci50b2tlblR5cGUgIT09IElERU5UJGYgJiZcbiAgICAgICAgdGhpcy5zY2FubmVyLmlzRGVsaW0oQVNURVJJU0skNSkgPT09IGZhbHNlKSB7XG4gICAgICAgIHRoaXMuZXJyb3IoJ0lkZW50aWZpZXIgb3IgYXN0ZXJpc2sgaXMgZXhwZWN0ZWQnKTtcbiAgICB9XG5cbiAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xufVxuXG4vLyBpZGVudFxuLy8gaWRlbnR8aWRlbnRcbi8vIGlkZW50fCpcbi8vICpcbi8vICp8aWRlbnRcbi8vICp8KlxuLy8gfGlkZW50XG4vLyB8KlxudmFyIFR5cGVTZWxlY3RvciA9IHtcbiAgICBuYW1lOiAnVHlwZVNlbGVjdG9yJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgbmFtZTogU3RyaW5nXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0O1xuXG4gICAgICAgIGlmICh0aGlzLnNjYW5uZXIuaXNEZWxpbShWRVJUSUNBTExJTkUkMikpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICBlYXRJZGVudGlmaWVyT3JBc3Rlcmlzay5jYWxsKHRoaXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWF0SWRlbnRpZmllck9yQXN0ZXJpc2suY2FsbCh0aGlzKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci5pc0RlbGltKFZFUlRJQ0FMTElORSQyKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgZWF0SWRlbnRpZmllck9yQXN0ZXJpc2suY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnVHlwZVNlbGVjdG9yJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgbmFtZTogdGhpcy5zY2FubmVyLnN1YnN0clRvQ3Vyc29yKHN0YXJ0KVxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5jaHVuayhub2RlLm5hbWUpO1xuICAgIH1cbn07XG5cbnZhciBpc0hleERpZ2l0JDMgPSB0b2tlbml6ZXIuaXNIZXhEaWdpdDtcbnZhciBjbXBDaGFyJDMgPSB0b2tlbml6ZXIuY21wQ2hhcjtcbnZhciBUWVBFJEMgPSB0b2tlbml6ZXIuVFlQRTtcbnZhciBOQU1FJDMgPSB0b2tlbml6ZXIuTkFNRTtcblxudmFyIElERU5UJGcgPSBUWVBFJEMuSWRlbnQ7XG52YXIgTlVNQkVSJDcgPSBUWVBFJEMuTnVtYmVyO1xudmFyIERJTUVOU0lPTiQ1ID0gVFlQRSRDLkRpbWVuc2lvbjtcbnZhciBQTFVTU0lHTiQ1ID0gMHgwMDJCOyAgICAgLy8gVSswMDJCIFBMVVMgU0lHTiAoKylcbnZhciBIWVBIRU5NSU5VUyQzID0gMHgwMDJEOyAgLy8gVSswMDJEIEhZUEhFTi1NSU5VUyAoLSlcbnZhciBRVUVTVElPTk1BUksgPSAweDAwM0Y7IC8vIFUrMDAzRiBRVUVTVElPTiBNQVJLICg/KVxudmFyIFUkMSA9IDB4MDA3NTsgICAgICAgICAgICAvLyBVKzAwNzUgTEFUSU4gU01BTEwgTEVUVEVSIFUgKHUpXG5cbmZ1bmN0aW9uIGVhdEhleFNlcXVlbmNlKG9mZnNldCwgYWxsb3dEYXNoKSB7XG4gICAgZm9yICh2YXIgcG9zID0gdGhpcy5zY2FubmVyLnRva2VuU3RhcnQgKyBvZmZzZXQsIGxlbiA9IDA7IHBvcyA8IHRoaXMuc2Nhbm5lci50b2tlbkVuZDsgcG9zKyspIHtcbiAgICAgICAgdmFyIGNvZGUgPSB0aGlzLnNjYW5uZXIuc291cmNlLmNoYXJDb2RlQXQocG9zKTtcblxuICAgICAgICBpZiAoY29kZSA9PT0gSFlQSEVOTUlOVVMkMyAmJiBhbGxvd0Rhc2ggJiYgbGVuICE9PSAwKSB7XG4gICAgICAgICAgICBpZiAoZWF0SGV4U2VxdWVuY2UuY2FsbCh0aGlzLCBvZmZzZXQgKyBsZW4gKyAxLCBmYWxzZSkgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNIZXhEaWdpdCQzKGNvZGUpKSB7XG4gICAgICAgICAgICB0aGlzLmVycm9yKFxuICAgICAgICAgICAgICAgIGFsbG93RGFzaCAmJiBsZW4gIT09IDBcbiAgICAgICAgICAgICAgICAgICAgPyAnSHlwaGVuTWludXMnICsgKGxlbiA8IDYgPyAnIG9yIGhleCBkaWdpdCcgOiAnJykgKyAnIGlzIGV4cGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICA6IChsZW4gPCA2ID8gJ0hleCBkaWdpdCBpcyBleHBlY3RlZCcgOiAnVW5leHBlY3RlZCBpbnB1dCcpLFxuICAgICAgICAgICAgICAgIHBvc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgrK2xlbiA+IDYpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoJ1RvbyBtYW55IGhleCBkaWdpdHMnLCBwb3MpO1xuICAgICAgICB9ICAgIH1cblxuICAgIHRoaXMuc2Nhbm5lci5uZXh0KCk7XG4gICAgcmV0dXJuIGxlbjtcbn1cblxuZnVuY3Rpb24gZWF0UXVlc3Rpb25NYXJrU2VxdWVuY2UobWF4KSB7XG4gICAgdmFyIGNvdW50ID0gMDtcblxuICAgIHdoaWxlICh0aGlzLnNjYW5uZXIuaXNEZWxpbShRVUVTVElPTk1BUkspKSB7XG4gICAgICAgIGlmICgrK2NvdW50ID4gbWF4KSB7XG4gICAgICAgICAgICB0aGlzLmVycm9yKCdUb28gbWFueSBxdWVzdGlvbiBtYXJrcycpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHN0YXJ0c1dpdGgoY29kZSkge1xuICAgIGlmICh0aGlzLnNjYW5uZXIuc291cmNlLmNoYXJDb2RlQXQodGhpcy5zY2FubmVyLnRva2VuU3RhcnQpICE9PSBjb2RlKSB7XG4gICAgICAgIHRoaXMuZXJyb3IoTkFNRSQzW2NvZGVdICsgJyBpcyBleHBlY3RlZCcpO1xuICAgIH1cbn1cblxuLy8gaHR0cHM6Ly9kcmFmdHMuY3Nzd2cub3JnL2Nzcy1zeW50YXgvI3VyYW5nZVxuLy8gSW5mb3JtYWxseSwgdGhlIDx1cmFuZ2U+IHByb2R1Y3Rpb24gaGFzIHRocmVlIGZvcm1zOlxuLy8gVSswMDAxXG4vLyAgICAgIERlZmluZXMgYSByYW5nZSBjb25zaXN0aW5nIG9mIGEgc2luZ2xlIGNvZGUgcG9pbnQsIGluIHRoaXMgY2FzZSB0aGUgY29kZSBwb2ludCBcIjFcIi5cbi8vIFUrMDAwMS0wMGZmXG4vLyAgICAgIERlZmluZXMgYSByYW5nZSBvZiBjb2RlcG9pbnRzIGJldHdlZW4gdGhlIGZpcnN0IGFuZCB0aGUgc2Vjb25kIHZhbHVlLCBpbiB0aGlzIGNhc2Vcbi8vICAgICAgdGhlIHJhbmdlIGJldHdlZW4gXCIxXCIgYW5kIFwiZmZcIiAoMjU1IGluIGRlY2ltYWwpIGluY2x1c2l2ZS5cbi8vIFUrMDA/P1xuLy8gICAgICBEZWZpbmVzIGEgcmFuZ2Ugb2YgY29kZXBvaW50cyB3aGVyZSB0aGUgXCI/XCIgY2hhcmFjdGVycyByYW5nZSBvdmVyIGFsbCBoZXggZGlnaXRzLFxuLy8gICAgICBpbiB0aGlzIGNhc2UgZGVmaW5pbmcgdGhlIHNhbWUgYXMgdGhlIHZhbHVlIFUrMDAwMC0wMGZmLlxuLy8gSW4gZWFjaCBmb3JtLCBhIG1heGltdW0gb2YgNiBkaWdpdHMgaXMgYWxsb3dlZCBmb3IgZWFjaCBoZXhhZGVjaW1hbCBudW1iZXIgKGlmIHlvdSB0cmVhdCBcIj9cIiBhcyBhIGhleGFkZWNpbWFsIGRpZ2l0KS5cbi8vXG4vLyA8dXJhbmdlPiA9XG4vLyAgIHUgJysnIDxpZGVudC10b2tlbj4gJz8nKiB8XG4vLyAgIHUgPGRpbWVuc2lvbi10b2tlbj4gJz8nKiB8XG4vLyAgIHUgPG51bWJlci10b2tlbj4gJz8nKiB8XG4vLyAgIHUgPG51bWJlci10b2tlbj4gPGRpbWVuc2lvbi10b2tlbj4gfFxuLy8gICB1IDxudW1iZXItdG9rZW4+IDxudW1iZXItdG9rZW4+IHxcbi8vICAgdSAnKycgJz8nK1xuZnVuY3Rpb24gc2NhblVuaWNvZGVSYW5nZSgpIHtcbiAgICB2YXIgaGV4TGVuZ3RoID0gMDtcblxuICAgIC8vIHUgJysnIDxpZGVudC10b2tlbj4gJz8nKlxuICAgIC8vIHUgJysnICc/JytcbiAgICBpZiAodGhpcy5zY2FubmVyLmlzRGVsaW0oUExVU1NJR04kNSkpIHtcbiAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcblxuICAgICAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuVHlwZSA9PT0gSURFTlQkZykge1xuICAgICAgICAgICAgaGV4TGVuZ3RoID0gZWF0SGV4U2VxdWVuY2UuY2FsbCh0aGlzLCAwLCB0cnVlKTtcbiAgICAgICAgICAgIGlmIChoZXhMZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZWF0UXVlc3Rpb25NYXJrU2VxdWVuY2UuY2FsbCh0aGlzLCA2IC0gaGV4TGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnNjYW5uZXIuaXNEZWxpbShRVUVTVElPTk1BUkspKSB7XG4gICAgICAgICAgICB0aGlzLnNjYW5uZXIubmV4dCgpO1xuICAgICAgICAgICAgZWF0UXVlc3Rpb25NYXJrU2VxdWVuY2UuY2FsbCh0aGlzLCA1KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZXJyb3IoJ0hleCBkaWdpdCBvciBxdWVzdGlvbiBtYXJrIGlzIGV4cGVjdGVkJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyB1IDxudW1iZXItdG9rZW4+ICc/JypcbiAgICAvLyB1IDxudW1iZXItdG9rZW4+IDxkaW1lbnNpb24tdG9rZW4+XG4gICAgLy8gdSA8bnVtYmVyLXRva2VuPiA8bnVtYmVyLXRva2VuPlxuICAgIGlmICh0aGlzLnNjYW5uZXIudG9rZW5UeXBlID09PSBOVU1CRVIkNykge1xuICAgICAgICBzdGFydHNXaXRoLmNhbGwodGhpcywgUExVU1NJR04kNSk7XG4gICAgICAgIGhleExlbmd0aCA9IGVhdEhleFNlcXVlbmNlLmNhbGwodGhpcywgMSwgdHJ1ZSk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2Nhbm5lci5pc0RlbGltKFFVRVNUSU9OTUFSSykpIHtcbiAgICAgICAgICAgIGVhdFF1ZXN0aW9uTWFya1NlcXVlbmNlLmNhbGwodGhpcywgNiAtIGhleExlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuVHlwZSA9PT0gRElNRU5TSU9OJDUgfHxcbiAgICAgICAgICAgIHRoaXMuc2Nhbm5lci50b2tlblR5cGUgPT09IE5VTUJFUiQ3KSB7XG4gICAgICAgICAgICBzdGFydHNXaXRoLmNhbGwodGhpcywgSFlQSEVOTUlOVVMkMyk7XG4gICAgICAgICAgICBlYXRIZXhTZXF1ZW5jZS5jYWxsKHRoaXMsIDEsIGZhbHNlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyB1IDxkaW1lbnNpb24tdG9rZW4+ICc/JypcbiAgICBpZiAodGhpcy5zY2FubmVyLnRva2VuVHlwZSA9PT0gRElNRU5TSU9OJDUpIHtcbiAgICAgICAgc3RhcnRzV2l0aC5jYWxsKHRoaXMsIFBMVVNTSUdOJDUpO1xuICAgICAgICBoZXhMZW5ndGggPSBlYXRIZXhTZXF1ZW5jZS5jYWxsKHRoaXMsIDEsIHRydWUpO1xuXG4gICAgICAgIGlmIChoZXhMZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBlYXRRdWVzdGlvbk1hcmtTZXF1ZW5jZS5jYWxsKHRoaXMsIDYgLSBoZXhMZW5ndGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZXJyb3IoKTtcbn1cblxudmFyIFVuaWNvZGVSYW5nZSA9IHtcbiAgICBuYW1lOiAnVW5pY29kZVJhbmdlJyxcbiAgICBzdHJ1Y3R1cmU6IHtcbiAgICAgICAgdmFsdWU6IFN0cmluZ1xuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydDtcblxuICAgICAgICAvLyBVIG9yIHVcbiAgICAgICAgaWYgKCFjbXBDaGFyJDModGhpcy5zY2FubmVyLnNvdXJjZSwgc3RhcnQsIFUkMSkpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoJ1UgaXMgZXhwZWN0ZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY21wQ2hhciQzKHRoaXMuc2Nhbm5lci5zb3VyY2UsIHN0YXJ0ICsgMSwgUExVU1NJR04kNSkpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoJ1BsdXMgc2lnbiBpcyBleHBlY3RlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zY2FubmVyLm5leHQoKTtcbiAgICAgICAgc2NhblVuaWNvZGVSYW5nZS5jYWxsKHRoaXMpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnVW5pY29kZVJhbmdlJyxcbiAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihzdGFydCwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQpLFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2Nhbm5lci5zdWJzdHJUb0N1cnNvcihzdGFydClcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsobm9kZS52YWx1ZSk7XG4gICAgfVxufTtcblxudmFyIGlzV2hpdGVTcGFjZSQyID0gdG9rZW5pemVyLmlzV2hpdGVTcGFjZTtcbnZhciBjbXBTdHIkNSA9IHRva2VuaXplci5jbXBTdHI7XG52YXIgVFlQRSREID0gdG9rZW5pemVyLlRZUEU7XG5cbnZhciBGVU5DVElPTiQ2ID0gVFlQRSRELkZ1bmN0aW9uO1xudmFyIFVSTCQ0ID0gVFlQRSRELlVybDtcbnZhciBSSUdIVFBBUkVOVEhFU0lTJDUgPSBUWVBFJEQuUmlnaHRQYXJlbnRoZXNpcztcblxuLy8gPHVybC10b2tlbj4gfCA8ZnVuY3Rpb24tdG9rZW4+IDxzdHJpbmc+IClcbnZhciBVcmwgPSB7XG4gICAgbmFtZTogJ1VybCcsXG4gICAgc3RydWN0dXJlOiB7XG4gICAgICAgIHZhbHVlOiBbJ1N0cmluZycsICdSYXcnXVxuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydDtcbiAgICAgICAgdmFyIHZhbHVlO1xuXG4gICAgICAgIHN3aXRjaCAodGhpcy5zY2FubmVyLnRva2VuVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBVUkwkNDpcbiAgICAgICAgICAgICAgICB2YXIgcmF3U3RhcnQgPSBzdGFydCArIDQ7XG4gICAgICAgICAgICAgICAgdmFyIHJhd0VuZCA9IHRoaXMuc2Nhbm5lci50b2tlbkVuZCAtIDE7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAocmF3U3RhcnQgPCByYXdFbmQgJiYgaXNXaGl0ZVNwYWNlJDIodGhpcy5zY2FubmVyLnNvdXJjZS5jaGFyQ29kZUF0KHJhd1N0YXJ0KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmF3U3RhcnQrKztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAocmF3U3RhcnQgPCByYXdFbmQgJiYgaXNXaGl0ZVNwYWNlJDIodGhpcy5zY2FubmVyLnNvdXJjZS5jaGFyQ29kZUF0KHJhd0VuZCAtIDEpKSkge1xuICAgICAgICAgICAgICAgICAgICByYXdFbmQtLTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1JhdycsXG4gICAgICAgICAgICAgICAgICAgIGxvYzogdGhpcy5nZXRMb2NhdGlvbihyYXdTdGFydCwgcmF3RW5kKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2Nhbm5lci5zb3VyY2Uuc3Vic3RyaW5nKHJhd1N0YXJ0LCByYXdFbmQpXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXMuZWF0KFVSTCQ0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBGVU5DVElPTiQ2OlxuICAgICAgICAgICAgICAgIGlmICghY21wU3RyJDUodGhpcy5zY2FubmVyLnNvdXJjZSwgdGhpcy5zY2FubmVyLnRva2VuU3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlbkVuZCwgJ3VybCgnKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yKCdGdW5jdGlvbiBuYW1lIG11c3QgYmUgYHVybGAnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmVhdChGVU5DVElPTiQ2KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNjYW5uZXIuc2tpcFNDKCk7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLlN0cmluZygpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nhbm5lci5za2lwU0MoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVhdChSSUdIVFBBUkVOVEhFU0lTJDUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IoJ1VybCBvciBGdW5jdGlvbiBpcyBleHBlY3RlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdVcmwnLFxuICAgICAgICAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5TdGFydCksXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGdlbmVyYXRlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHRoaXMuY2h1bmsoJ3VybCcpO1xuICAgICAgICB0aGlzLmNodW5rKCcoJyk7XG4gICAgICAgIHRoaXMubm9kZShub2RlLnZhbHVlKTtcbiAgICAgICAgdGhpcy5jaHVuaygnKScpO1xuICAgIH1cbn07XG5cbnZhciBWYWx1ZSA9IHtcbiAgICBuYW1lOiAnVmFsdWUnLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICBjaGlsZHJlbjogW1tdXVxuICAgIH0sXG4gICAgcGFyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnNjYW5uZXIudG9rZW5TdGFydDtcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gdGhpcy5yZWFkU2VxdWVuY2UodGhpcy5zY29wZS5WYWx1ZSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdWYWx1ZScsXG4gICAgICAgICAgICBsb2M6IHRoaXMuZ2V0TG9jYXRpb24oc3RhcnQsIHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0KSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBjaGlsZHJlblxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbihub2RlKTtcbiAgICB9XG59O1xuXG52YXIgV0hJVEVTUEFDRSRiID0gdG9rZW5pemVyLlRZUEUuV2hpdGVTcGFjZTtcbnZhciBTUEFDRSA9IE9iamVjdC5mcmVlemUoe1xuICAgIHR5cGU6ICdXaGl0ZVNwYWNlJyxcbiAgICBsb2M6IG51bGwsXG4gICAgdmFsdWU6ICcgJ1xufSk7XG5cbnZhciBXaGl0ZVNwYWNlJDEgPSB7XG4gICAgbmFtZTogJ1doaXRlU3BhY2UnLFxuICAgIHN0cnVjdHVyZToge1xuICAgICAgICB2YWx1ZTogU3RyaW5nXG4gICAgfSxcbiAgICBwYXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZWF0KFdISVRFU1BBQ0UkYik7XG4gICAgICAgIHJldHVybiBTUEFDRTtcblxuICAgICAgICAvLyByZXR1cm4ge1xuICAgICAgICAvLyAgICAgdHlwZTogJ1doaXRlU3BhY2UnLFxuICAgICAgICAvLyAgICAgbG9jOiB0aGlzLmdldExvY2F0aW9uKHRoaXMuc2Nhbm5lci50b2tlblN0YXJ0LCB0aGlzLnNjYW5uZXIudG9rZW5FbmQpLFxuICAgICAgICAvLyAgICAgdmFsdWU6IHRoaXMuY29uc3VtZShXSElURVNQQUNFKVxuICAgICAgICAvLyB9O1xuICAgIH0sXG4gICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5jaHVuayhub2RlLnZhbHVlKTtcbiAgICB9XG59O1xuXG52YXIgbm9kZSA9IHtcbiAgICBBblBsdXNCOiBBblBsdXNCLFxuICAgIEF0cnVsZTogQXRydWxlLFxuICAgIEF0cnVsZVByZWx1ZGU6IEF0cnVsZVByZWx1ZGUsXG4gICAgQXR0cmlidXRlU2VsZWN0b3I6IEF0dHJpYnV0ZVNlbGVjdG9yLFxuICAgIEJsb2NrOiBCbG9jayxcbiAgICBCcmFja2V0czogQnJhY2tldHMsXG4gICAgQ0RDOiBDRENfMSxcbiAgICBDRE86IENET18xLFxuICAgIENsYXNzU2VsZWN0b3I6IENsYXNzU2VsZWN0b3IsXG4gICAgQ29tYmluYXRvcjogQ29tYmluYXRvcixcbiAgICBDb21tZW50OiBDb21tZW50LFxuICAgIERlY2xhcmF0aW9uOiBEZWNsYXJhdGlvbixcbiAgICBEZWNsYXJhdGlvbkxpc3Q6IERlY2xhcmF0aW9uTGlzdCxcbiAgICBEaW1lbnNpb246IERpbWVuc2lvbixcbiAgICBGdW5jdGlvbjogX0Z1bmN0aW9uLFxuICAgIEhhc2g6IEhhc2gsXG4gICAgSWRlbnRpZmllcjogSWRlbnRpZmllcixcbiAgICBJZFNlbGVjdG9yOiBJZFNlbGVjdG9yLFxuICAgIE1lZGlhRmVhdHVyZTogTWVkaWFGZWF0dXJlLFxuICAgIE1lZGlhUXVlcnk6IE1lZGlhUXVlcnksXG4gICAgTWVkaWFRdWVyeUxpc3Q6IE1lZGlhUXVlcnlMaXN0LFxuICAgIE50aDogTnRoLFxuICAgIE51bWJlcjogX051bWJlcixcbiAgICBPcGVyYXRvcjogT3BlcmF0b3IsXG4gICAgUGFyZW50aGVzZXM6IFBhcmVudGhlc2VzLFxuICAgIFBlcmNlbnRhZ2U6IFBlcmNlbnRhZ2UsXG4gICAgUHNldWRvQ2xhc3NTZWxlY3RvcjogUHNldWRvQ2xhc3NTZWxlY3RvcixcbiAgICBQc2V1ZG9FbGVtZW50U2VsZWN0b3I6IFBzZXVkb0VsZW1lbnRTZWxlY3RvcixcbiAgICBSYXRpbzogUmF0aW8sXG4gICAgUmF3OiBSYXcsXG4gICAgUnVsZTogUnVsZSxcbiAgICBTZWxlY3RvcjogU2VsZWN0b3IsXG4gICAgU2VsZWN0b3JMaXN0OiBTZWxlY3Rvckxpc3QsXG4gICAgU3RyaW5nOiBfU3RyaW5nLFxuICAgIFN0eWxlU2hlZXQ6IFN0eWxlU2hlZXQsXG4gICAgVHlwZVNlbGVjdG9yOiBUeXBlU2VsZWN0b3IsXG4gICAgVW5pY29kZVJhbmdlOiBVbmljb2RlUmFuZ2UsXG4gICAgVXJsOiBVcmwsXG4gICAgVmFsdWU6IFZhbHVlLFxuICAgIFdoaXRlU3BhY2U6IFdoaXRlU3BhY2UkMVxufTtcblxudmFyIHBhcnNlciA9IHtcbiAgICBwYXJzZUNvbnRleHQ6IHtcbiAgICAgICAgZGVmYXVsdDogJ1N0eWxlU2hlZXQnLFxuICAgICAgICBzdHlsZXNoZWV0OiAnU3R5bGVTaGVldCcsXG4gICAgICAgIGF0cnVsZTogJ0F0cnVsZScsXG4gICAgICAgIGF0cnVsZVByZWx1ZGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkF0cnVsZVByZWx1ZGUob3B0aW9ucy5hdHJ1bGUgPyBTdHJpbmcob3B0aW9ucy5hdHJ1bGUpIDogbnVsbCk7XG4gICAgICAgIH0sXG4gICAgICAgIG1lZGlhUXVlcnlMaXN0OiAnTWVkaWFRdWVyeUxpc3QnLFxuICAgICAgICBtZWRpYVF1ZXJ5OiAnTWVkaWFRdWVyeScsXG4gICAgICAgIHJ1bGU6ICdSdWxlJyxcbiAgICAgICAgc2VsZWN0b3JMaXN0OiAnU2VsZWN0b3JMaXN0JyxcbiAgICAgICAgc2VsZWN0b3I6ICdTZWxlY3RvcicsXG4gICAgICAgIGJsb2NrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkJsb2NrKHRydWUpO1xuICAgICAgICB9LFxuICAgICAgICBkZWNsYXJhdGlvbkxpc3Q6ICdEZWNsYXJhdGlvbkxpc3QnLFxuICAgICAgICBkZWNsYXJhdGlvbjogJ0RlY2xhcmF0aW9uJyxcbiAgICAgICAgdmFsdWU6ICdWYWx1ZSdcbiAgICB9LFxuICAgIHNjb3BlOiBzY29wZSxcbiAgICBhdHJ1bGU6IGF0cnVsZSxcbiAgICBwc2V1ZG86IHBzZXVkbyxcbiAgICBub2RlOiBub2RlXG59O1xuXG52YXIgcGFyc2VyJDEgPSBjcmVhdGUocGFyc2VyKTtcblxuY29uc3QgcmVnZXhfY2xvc2luZ19zdHlsZV90YWcgPSAvPFxcL3N0eWxlXFxzKj4vO1xuZnVuY3Rpb24gcmVhZF9zdHlsZShwYXJzZXIsIHN0YXJ0LCBhdHRyaWJ1dGVzKSB7XG4gICAgY29uc3QgY29udGVudF9zdGFydCA9IHBhcnNlci5pbmRleDtcbiAgICBjb25zdCBzdHlsZXMgPSBwYXJzZXIucmVhZF91bnRpbChyZWdleF9jbG9zaW5nX3N0eWxlX3RhZywgcGFyc2VyX2Vycm9ycy51bmNsb3NlZF9zdHlsZSk7XG4gICAgaWYgKHBhcnNlci5pbmRleCA+PSBwYXJzZXIudGVtcGxhdGUubGVuZ3RoKSB7XG4gICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLnVuY2xvc2VkX3N0eWxlKTtcbiAgICB9XG4gICAgY29uc3QgY29udGVudF9lbmQgPSBwYXJzZXIuaW5kZXg7XG4gICAgbGV0IGFzdDtcbiAgICB0cnkge1xuICAgICAgICBhc3QgPSBwYXJzZXIkMShzdHlsZXMsIHtcbiAgICAgICAgICAgIHBvc2l0aW9uczogdHJ1ZSxcbiAgICAgICAgICAgIG9mZnNldDogY29udGVudF9zdGFydCxcbiAgICAgICAgICAgIG9uUGFyc2VFcnJvcihlcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoZXJyLm5hbWUgPT09ICdTeW50YXhFcnJvcicpIHtcbiAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmNzc19zeW50YXhfZXJyb3IoZXJyLm1lc3NhZ2UpLCBlcnIub2Zmc2V0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3QgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFzdCkpO1xuICAgIC8vIHRpZHkgdXAgQVNUXG4gICAgd2Fsayhhc3QsIHtcbiAgICAgICAgZW50ZXI6IChub2RlKSA9PiB7XG4gICAgICAgICAgICAvLyByZXBsYWNlIGByZWY6YWAgbm9kZXNcbiAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdTZWxlY3RvcicpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IG5vZGUuY2hpbGRyZW5baV07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGIgPSBub2RlLmNoaWxkcmVuW2kgKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzX3JlZl9zZWxlY3RvcihhLCBiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMuaW52YWxpZF9yZWZfc2VsZWN0b3IsIGEubG9jLnN0YXJ0Lm9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnRGVjbGFyYXRpb24nICYmIG5vZGUudmFsdWUudHlwZSA9PT0gJ1ZhbHVlJyAmJiBub2RlLnZhbHVlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmludmFsaWRfZGVjbGFyYXRpb24sIG5vZGUuc3RhcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ1BzZXVkb0NsYXNzU2VsZWN0b3InICYmIG5vZGUubmFtZSA9PT0gJ2dsb2JhbCcgJiYgbm9kZS5jaGlsZHJlbiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmVtcHR5X2dsb2JhbF9zZWxlY3Rvciwgbm9kZS5sb2Muc3RhcnQub2Zmc2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChub2RlLmxvYykge1xuICAgICAgICAgICAgICAgIG5vZGUuc3RhcnQgPSBub2RlLmxvYy5zdGFydC5vZmZzZXQ7XG4gICAgICAgICAgICAgICAgbm9kZS5lbmQgPSBub2RlLmxvYy5lbmQub2Zmc2V0O1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBub2RlLmxvYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHBhcnNlci5yZWFkKHJlZ2V4X2Nsb3Npbmdfc3R5bGVfdGFnKTtcbiAgICBjb25zdCBlbmQgPSBwYXJzZXIuaW5kZXg7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ1N0eWxlJyxcbiAgICAgICAgc3RhcnQsXG4gICAgICAgIGVuZCxcbiAgICAgICAgYXR0cmlidXRlcyxcbiAgICAgICAgY2hpbGRyZW46IGFzdC5jaGlsZHJlbixcbiAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgc3RhcnQ6IGNvbnRlbnRfc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IGNvbnRlbnRfZW5kLFxuICAgICAgICAgICAgc3R5bGVzXG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gaXNfcmVmX3NlbGVjdG9yKGEsIGIpIHtcbiAgICBpZiAoIWIpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gKGEudHlwZSA9PT0gJ1R5cGVTZWxlY3RvcicgJiZcbiAgICAgICAgYS5uYW1lID09PSAncmVmJyAmJlxuICAgICAgICBiLnR5cGUgPT09ICdQc2V1ZG9DbGFzc1NlbGVjdG9yJyk7XG59XG5cbi8vIGh0dHBzOi8vZGV2LnczLm9yZy9odG1sNS9odG1sLWF1dGhvci9jaGFycmVmXG52YXIgZW50aXRpZXMgPSB7XG4gICAgQ291bnRlckNsb2Nrd2lzZUNvbnRvdXJJbnRlZ3JhbDogODc1NSxcbiAgICBDbG9ja3dpc2VDb250b3VySW50ZWdyYWw6IDg3NTQsXG4gICAgRG91YmxlTG9uZ0xlZnRSaWdodEFycm93OiAxMDIzNCxcbiAgICBEaWFjcml0aWNhbERvdWJsZUFjdXRlOiA3MzMsXG4gICAgTm90U3F1YXJlU3VwZXJzZXRFcXVhbDogODkzMSxcbiAgICBDbG9zZUN1cmx5RG91YmxlUXVvdGU6IDgyMjEsXG4gICAgRG91YmxlQ29udG91ckludGVncmFsOiA4NzUxLFxuICAgIEZpbGxlZFZlcnlTbWFsbFNxdWFyZTogOTY0MixcbiAgICBOZWdhdGl2ZVZlcnlUaGluU3BhY2U6IDgyMDMsXG4gICAgTm90UHJlY2VkZXNTbGFudEVxdWFsOiA4OTI4LFxuICAgIE5vdFJpZ2h0VHJpYW5nbGVFcXVhbDogODk0MSxcbiAgICBOb3RTdWNjZWVkc1NsYW50RXF1YWw6IDg5MjksXG4gICAgQ2FwaXRhbERpZmZlcmVudGlhbEQ6IDg1MTcsXG4gICAgRG91YmxlTGVmdFJpZ2h0QXJyb3c6IDg2NjAsXG4gICAgRG91YmxlTG9uZ1JpZ2h0QXJyb3c6IDEwMjMzLFxuICAgIEVtcHR5VmVyeVNtYWxsU3F1YXJlOiA5NjQzLFxuICAgIE5lc3RlZEdyZWF0ZXJHcmVhdGVyOiA4ODExLFxuICAgIE5vdERvdWJsZVZlcnRpY2FsQmFyOiA4NzQyLFxuICAgIE5vdExlZnRUcmlhbmdsZUVxdWFsOiA4OTQwLFxuICAgIE5vdFNxdWFyZVN1YnNldEVxdWFsOiA4OTMwLFxuICAgIE9wZW5DdXJseURvdWJsZVF1b3RlOiA4MjIwLFxuICAgIFJldmVyc2VVcEVxdWlsaWJyaXVtOiAxMDYwNyxcbiAgICBEb3VibGVMb25nTGVmdEFycm93OiAxMDIzMixcbiAgICBEb3duTGVmdFJpZ2h0VmVjdG9yOiAxMDU3NixcbiAgICBMZWZ0QXJyb3dSaWdodEFycm93OiA4NjQ2LFxuICAgIE5lZ2F0aXZlTWVkaXVtU3BhY2U6IDgyMDMsXG4gICAgUmlnaHRBcnJvd0xlZnRBcnJvdzogODY0NCxcbiAgICBTcXVhcmVTdXBlcnNldEVxdWFsOiA4ODUwLFxuICAgIGxlZnRyaWdodHNxdWlnYXJyb3c6IDg2MjEsXG4gICAgRG93blJpZ2h0VGVlVmVjdG9yOiAxMDU5MSxcbiAgICBEb3duUmlnaHRWZWN0b3JCYXI6IDEwNTgzLFxuICAgIExvbmdMZWZ0UmlnaHRBcnJvdzogMTAyMzEsXG4gICAgTG9uZ2xlZnRyaWdodGFycm93OiAxMDIzNCxcbiAgICBOZWdhdGl2ZVRoaWNrU3BhY2U6IDgyMDMsXG4gICAgUHJlY2VkZXNTbGFudEVxdWFsOiA4ODI4LFxuICAgIFJldmVyc2VFcXVpbGlicml1bTogODY1MSxcbiAgICBSaWdodERvdWJsZUJyYWNrZXQ6IDEwMjE1LFxuICAgIFJpZ2h0RG93blRlZVZlY3RvcjogMTA1ODksXG4gICAgUmlnaHREb3duVmVjdG9yQmFyOiAxMDU4MSxcbiAgICBSaWdodFRyaWFuZ2xlRXF1YWw6IDg4ODUsXG4gICAgU3F1YXJlSW50ZXJzZWN0aW9uOiA4ODUxLFxuICAgIFN1Y2NlZWRzU2xhbnRFcXVhbDogODgyOSxcbiAgICBibGFja3RyaWFuZ2xlcmlnaHQ6IDk2NTYsXG4gICAgbG9uZ2xlZnRyaWdodGFycm93OiAxMDIzMSxcbiAgICBEb3VibGVVcERvd25BcnJvdzogODY2MSxcbiAgICBEb3VibGVWZXJ0aWNhbEJhcjogODc0MSxcbiAgICBEb3duTGVmdFRlZVZlY3RvcjogMTA1OTAsXG4gICAgRG93bkxlZnRWZWN0b3JCYXI6IDEwNTgyLFxuICAgIEZpbGxlZFNtYWxsU3F1YXJlOiA5NzI0LFxuICAgIEdyZWF0ZXJTbGFudEVxdWFsOiAxMDg3OCxcbiAgICBMZWZ0RG91YmxlQnJhY2tldDogMTAyMTQsXG4gICAgTGVmdERvd25UZWVWZWN0b3I6IDEwNTkzLFxuICAgIExlZnREb3duVmVjdG9yQmFyOiAxMDU4NSxcbiAgICBMZWZ0VHJpYW5nbGVFcXVhbDogODg4NCxcbiAgICBOZWdhdGl2ZVRoaW5TcGFjZTogODIwMyxcbiAgICBOb3RSZXZlcnNlRWxlbWVudDogODcxNixcbiAgICBOb3RUaWxkZUZ1bGxFcXVhbDogODc3NSxcbiAgICBSaWdodEFuZ2xlQnJhY2tldDogMTAyMTcsXG4gICAgUmlnaHRVcERvd25WZWN0b3I6IDEwNTc1LFxuICAgIFNxdWFyZVN1YnNldEVxdWFsOiA4ODQ5LFxuICAgIFZlcnRpY2FsU2VwYXJhdG9yOiAxMDA3MixcbiAgICBibGFja3RyaWFuZ2xlZG93bjogOTY2MixcbiAgICBibGFja3RyaWFuZ2xlbGVmdDogOTY2NixcbiAgICBsZWZ0cmlnaHRoYXJwb29uczogODY1MSxcbiAgICByaWdodGxlZnRoYXJwb29uczogODY1MixcbiAgICB0d29oZWFkcmlnaHRhcnJvdzogODYwOCxcbiAgICBEaWFjcml0aWNhbEFjdXRlOiAxODAsXG4gICAgRGlhY3JpdGljYWxHcmF2ZTogOTYsXG4gICAgRGlhY3JpdGljYWxUaWxkZTogNzMyLFxuICAgIERvdWJsZVJpZ2h0QXJyb3c6IDg2NTgsXG4gICAgRG93bkFycm93VXBBcnJvdzogODY5MyxcbiAgICBFbXB0eVNtYWxsU3F1YXJlOiA5NzIzLFxuICAgIEdyZWF0ZXJFcXVhbExlc3M6IDg5MjMsXG4gICAgR3JlYXRlckZ1bGxFcXVhbDogODgwNyxcbiAgICBMZWZ0QW5nbGVCcmFja2V0OiAxMDIxNixcbiAgICBMZWZ0VXBEb3duVmVjdG9yOiAxMDU3NyxcbiAgICBMZXNzRXF1YWxHcmVhdGVyOiA4OTIyLFxuICAgIE5vbkJyZWFraW5nU3BhY2U6IDE2MCxcbiAgICBOb3RSaWdodFRyaWFuZ2xlOiA4OTM5LFxuICAgIE5vdFN1cGVyc2V0RXF1YWw6IDg4NDEsXG4gICAgUmlnaHRUcmlhbmdsZUJhcjogMTA3MDQsXG4gICAgUmlnaHRVcFRlZVZlY3RvcjogMTA1ODgsXG4gICAgUmlnaHRVcFZlY3RvckJhcjogMTA1ODAsXG4gICAgVW5kZXJQYXJlbnRoZXNpczogOTE4MSxcbiAgICBVcEFycm93RG93bkFycm93OiA4NjQ1LFxuICAgIGNpcmNsZWFycm93cmlnaHQ6IDg2MzUsXG4gICAgZG93bmhhcnBvb25yaWdodDogODY0MixcbiAgICBudHJpYW5nbGVyaWdodGVxOiA4OTQxLFxuICAgIHJpZ2h0aGFycG9vbmRvd246IDg2NDEsXG4gICAgcmlnaHRyaWdodGFycm93czogODY0OSxcbiAgICB0d29oZWFkbGVmdGFycm93OiA4NjA2LFxuICAgIHZhcnRyaWFuZ2xlcmlnaHQ6IDg4ODMsXG4gICAgQ2xvc2VDdXJseVF1b3RlOiA4MjE3LFxuICAgIENvbnRvdXJJbnRlZ3JhbDogODc1MCxcbiAgICBEb3VibGVEb3duQXJyb3c6IDg2NTksXG4gICAgRG91YmxlTGVmdEFycm93OiA4NjU2LFxuICAgIERvd25SaWdodFZlY3RvcjogODY0MSxcbiAgICBMZWZ0UmlnaHRWZWN0b3I6IDEwNTc0LFxuICAgIExlZnRUcmlhbmdsZUJhcjogMTA3MDMsXG4gICAgTGVmdFVwVGVlVmVjdG9yOiAxMDU5MixcbiAgICBMZWZ0VXBWZWN0b3JCYXI6IDEwNTg0LFxuICAgIExvd2VyUmlnaHRBcnJvdzogODYwMCxcbiAgICBOb3RHcmVhdGVyRXF1YWw6IDg4MTcsXG4gICAgTm90R3JlYXRlclRpbGRlOiA4ODIxLFxuICAgIE5vdExlZnRUcmlhbmdsZTogODkzOCxcbiAgICBPdmVyUGFyZW50aGVzaXM6IDkxODAsXG4gICAgUmlnaHREb3duVmVjdG9yOiA4NjQyLFxuICAgIFNob3J0UmlnaHRBcnJvdzogODU5NCxcbiAgICBVcHBlclJpZ2h0QXJyb3c6IDg1OTksXG4gICAgYmlndHJpYW5nbGVkb3duOiA5NjYxLFxuICAgIGNpcmNsZWFycm93bGVmdDogODYzNCxcbiAgICBjdXJ2ZWFycm93cmlnaHQ6IDg2MzEsXG4gICAgZG93bmhhcnBvb25sZWZ0OiA4NjQzLFxuICAgIGxlZnRoYXJwb29uZG93bjogODYzNyxcbiAgICBsZWZ0cmlnaHRhcnJvd3M6IDg2NDYsXG4gICAgbkxlZnRyaWdodGFycm93OiA4NjU0LFxuICAgIG5sZWZ0cmlnaHRhcnJvdzogODYyMixcbiAgICBudHJpYW5nbGVsZWZ0ZXE6IDg5NDAsXG4gICAgcmlnaHRsZWZ0YXJyb3dzOiA4NjQ0LFxuICAgIHJpZ2h0c3F1aWdhcnJvdzogODYwNSxcbiAgICByaWdodHRocmVldGltZXM6IDg5MDgsXG4gICAgc3RyYWlnaHRlcHNpbG9uOiAxMDEzLFxuICAgIHRyaWFuZ2xlcmlnaHRlcTogODg4NSxcbiAgICB2YXJ0cmlhbmdsZWxlZnQ6IDg4ODIsXG4gICAgRGlhY3JpdGljYWxEb3Q6IDcyOSxcbiAgICBEb3VibGVSaWdodFRlZTogODg3MixcbiAgICBEb3duTGVmdFZlY3RvcjogODYzNyxcbiAgICBHcmVhdGVyR3JlYXRlcjogMTA5MTQsXG4gICAgSG9yaXpvbnRhbExpbmU6IDk0NzIsXG4gICAgSW52aXNpYmxlQ29tbWE6IDgyOTEsXG4gICAgSW52aXNpYmxlVGltZXM6IDgyOTAsXG4gICAgTGVmdERvd25WZWN0b3I6IDg2NDMsXG4gICAgTGVmdFJpZ2h0QXJyb3c6IDg1OTYsXG4gICAgTGVmdHJpZ2h0YXJyb3c6IDg2NjAsXG4gICAgTGVzc1NsYW50RXF1YWw6IDEwODc3LFxuICAgIExvbmdSaWdodEFycm93OiAxMDIzMCxcbiAgICBMb25ncmlnaHRhcnJvdzogMTAyMzMsXG4gICAgTG93ZXJMZWZ0QXJyb3c6IDg2MDEsXG4gICAgTmVzdGVkTGVzc0xlc3M6IDg4MTAsXG4gICAgTm90R3JlYXRlckxlc3M6IDg4MjUsXG4gICAgTm90TGVzc0dyZWF0ZXI6IDg4MjQsXG4gICAgTm90U3Vic2V0RXF1YWw6IDg4NDAsXG4gICAgTm90VmVydGljYWxCYXI6IDg3NDAsXG4gICAgT3BlbkN1cmx5UXVvdGU6IDgyMTYsXG4gICAgUmV2ZXJzZUVsZW1lbnQ6IDg3MTUsXG4gICAgUmlnaHRUZWVWZWN0b3I6IDEwNTg3LFxuICAgIFJpZ2h0VmVjdG9yQmFyOiAxMDU3OSxcbiAgICBTaG9ydERvd25BcnJvdzogODU5NSxcbiAgICBTaG9ydExlZnRBcnJvdzogODU5MixcbiAgICBTcXVhcmVTdXBlcnNldDogODg0OCxcbiAgICBUaWxkZUZ1bGxFcXVhbDogODc3MyxcbiAgICBVcHBlckxlZnRBcnJvdzogODU5OCxcbiAgICBaZXJvV2lkdGhTcGFjZTogODIwMyxcbiAgICBjdXJ2ZWFycm93bGVmdDogODYzMCxcbiAgICBkb3VibGViYXJ3ZWRnZTogODk2NixcbiAgICBkb3duZG93bmFycm93czogODY1MCxcbiAgICBob29rcmlnaHRhcnJvdzogODYxOCxcbiAgICBsZWZ0bGVmdGFycm93czogODY0NyxcbiAgICBsZWZ0cmlnaHRhcnJvdzogODU5NixcbiAgICBsZWZ0dGhyZWV0aW1lczogODkwNyxcbiAgICBsb25ncmlnaHRhcnJvdzogMTAyMzAsXG4gICAgbG9vcGFycm93cmlnaHQ6IDg2MjAsXG4gICAgbnNob3J0cGFyYWxsZWw6IDg3NDIsXG4gICAgbnRyaWFuZ2xlcmlnaHQ6IDg5MzksXG4gICAgcmlnaHRhcnJvd3RhaWw6IDg2MTEsXG4gICAgcmlnaHRoYXJwb29udXA6IDg2NDAsXG4gICAgdHJpYW5nbGVsZWZ0ZXE6IDg4ODQsXG4gICAgdXBoYXJwb29ucmlnaHQ6IDg2MzgsXG4gICAgQXBwbHlGdW5jdGlvbjogODI4OSxcbiAgICBEaWZmZXJlbnRpYWxEOiA4NTE4LFxuICAgIERvdWJsZUxlZnRUZWU6IDEwOTgwLFxuICAgIERvdWJsZVVwQXJyb3c6IDg2NTcsXG4gICAgTGVmdFRlZVZlY3RvcjogMTA1ODYsXG4gICAgTGVmdFZlY3RvckJhcjogMTA1NzgsXG4gICAgTGVzc0Z1bGxFcXVhbDogODgwNixcbiAgICBMb25nTGVmdEFycm93OiAxMDIyOSxcbiAgICBMb25nbGVmdGFycm93OiAxMDIzMixcbiAgICBOb3RUaWxkZUVxdWFsOiA4NzcyLFxuICAgIE5vdFRpbGRlVGlsZGU6IDg3NzcsXG4gICAgUG9pbmNhcmVwbGFuZTogODQ2MCxcbiAgICBQcmVjZWRlc0VxdWFsOiAxMDkyNyxcbiAgICBQcmVjZWRlc1RpbGRlOiA4ODMwLFxuICAgIFJpZ2h0QXJyb3dCYXI6IDg2NzcsXG4gICAgUmlnaHRUZWVBcnJvdzogODYxNCxcbiAgICBSaWdodFRyaWFuZ2xlOiA4ODgzLFxuICAgIFJpZ2h0VXBWZWN0b3I6IDg2MzgsXG4gICAgU3VjY2VlZHNFcXVhbDogMTA5MjgsXG4gICAgU3VjY2VlZHNUaWxkZTogODgzMSxcbiAgICBTdXBlcnNldEVxdWFsOiA4ODM5LFxuICAgIFVwRXF1aWxpYnJpdW06IDEwNjA2LFxuICAgIFZlcnRpY2FsVGlsZGU6IDg3NjgsXG4gICAgVmVyeVRoaW5TcGFjZTogODIwMixcbiAgICBiaWd0cmlhbmdsZXVwOiA5NjUxLFxuICAgIGJsYWNrdHJpYW5nbGU6IDk2NTIsXG4gICAgZGl2aWRlb250aW1lczogODkwMyxcbiAgICBmYWxsaW5nZG90c2VxOiA4Nzg2LFxuICAgIGhvb2tsZWZ0YXJyb3c6IDg2MTcsXG4gICAgbGVmdGFycm93dGFpbDogODYxMCxcbiAgICBsZWZ0aGFycG9vbnVwOiA4NjM2LFxuICAgIGxvbmdsZWZ0YXJyb3c6IDEwMjI5LFxuICAgIGxvb3BhcnJvd2xlZnQ6IDg2MTksXG4gICAgbWVhc3VyZWRhbmdsZTogODczNyxcbiAgICBudHJpYW5nbGVsZWZ0OiA4OTM4LFxuICAgIHNob3J0cGFyYWxsZWw6IDg3NDEsXG4gICAgc21hbGxzZXRtaW51czogODcyNixcbiAgICB0cmlhbmdsZXJpZ2h0OiA5NjU3LFxuICAgIHVwaGFycG9vbmxlZnQ6IDg2MzksXG4gICAgRG93bkFycm93QmFyOiAxMDUxNSxcbiAgICBEb3duVGVlQXJyb3c6IDg2MTUsXG4gICAgRXhwb25lbnRpYWxFOiA4NTE5LFxuICAgIEdyZWF0ZXJFcXVhbDogODgwNSxcbiAgICBHcmVhdGVyVGlsZGU6IDg4MTksXG4gICAgSGlsYmVydFNwYWNlOiA4NDU5LFxuICAgIEh1bXBEb3duSHVtcDogODc4MixcbiAgICBJbnRlcnNlY3Rpb246IDg4OTgsXG4gICAgTGVmdEFycm93QmFyOiA4Njc2LFxuICAgIExlZnRUZWVBcnJvdzogODYxMixcbiAgICBMZWZ0VHJpYW5nbGU6IDg4ODIsXG4gICAgTGVmdFVwVmVjdG9yOiA4NjM5LFxuICAgIE5vdENvbmdydWVudDogODgwMixcbiAgICBOb3RMZXNzRXF1YWw6IDg4MTYsXG4gICAgTm90TGVzc1RpbGRlOiA4ODIwLFxuICAgIFByb3BvcnRpb25hbDogODczMyxcbiAgICBSaWdodENlaWxpbmc6IDg5NjksXG4gICAgUm91bmRJbXBsaWVzOiAxMDYwOCxcbiAgICBTaG9ydFVwQXJyb3c6IDg1OTMsXG4gICAgU3F1YXJlU3Vic2V0OiA4ODQ3LFxuICAgIFVuZGVyQnJhY2tldDogOTE0MSxcbiAgICBWZXJ0aWNhbExpbmU6IDEyNCxcbiAgICBibGFja2xvemVuZ2U6IDEwNzMxLFxuICAgIGV4cG9uZW50aWFsZTogODUxOSxcbiAgICByaXNpbmdkb3RzZXE6IDg3ODcsXG4gICAgdHJpYW5nbGVkb3duOiA5NjYzLFxuICAgIHRyaWFuZ2xlbGVmdDogOTY2NyxcbiAgICBDaXJjbGVNaW51czogODg1NCxcbiAgICBDaXJjbGVUaW1lczogODg1NSxcbiAgICBFcXVpbGlicml1bTogODY1MixcbiAgICBHcmVhdGVyTGVzczogODgyMyxcbiAgICBMZWZ0Q2VpbGluZzogODk2OCxcbiAgICBMZXNzR3JlYXRlcjogODgyMixcbiAgICBNZWRpdW1TcGFjZTogODI4NyxcbiAgICBOb3RQcmVjZWRlczogODgzMixcbiAgICBOb3RTdWNjZWVkczogODgzMyxcbiAgICBPdmVyQnJhY2tldDogOTE0MCxcbiAgICBSaWdodFZlY3RvcjogODY0MCxcbiAgICBScmlnaHRhcnJvdzogODY2NyxcbiAgICBSdWxlRGVsYXllZDogMTA3NDAsXG4gICAgU21hbGxDaXJjbGU6IDg3MjgsXG4gICAgU3F1YXJlVW5pb246IDg4NTIsXG4gICAgU3Vic2V0RXF1YWw6IDg4MzgsXG4gICAgVXBEb3duQXJyb3c6IDg1OTcsXG4gICAgVXBkb3duYXJyb3c6IDg2NjEsXG4gICAgVmVydGljYWxCYXI6IDg3MzksXG4gICAgYmFja2Vwc2lsb246IDEwMTQsXG4gICAgYmxhY2tzcXVhcmU6IDk2NDIsXG4gICAgY2lyY2xlZGNpcmM6IDg4NTgsXG4gICAgY2lyY2xlZGRhc2g6IDg4NjEsXG4gICAgY3VybHllcXByZWM6IDg5MjYsXG4gICAgY3VybHllcXN1Y2M6IDg5MjcsXG4gICAgZGlhbW9uZHN1aXQ6IDk4MzAsXG4gICAgZXFzbGFudGxlc3M6IDEwOTAxLFxuICAgIGV4cGVjdGF0aW9uOiA4NDk2LFxuICAgIG5SaWdodGFycm93OiA4NjU1LFxuICAgIG5yaWdodGFycm93OiA4NjAzLFxuICAgIHByZWNjdXJseWVxOiA4ODI4LFxuICAgIHByZWNuYXBwcm94OiAxMDkzNyxcbiAgICBxdWF0ZXJuaW9uczogODQ2MSxcbiAgICBzdHJhaWdodHBoaTogOTgxLFxuICAgIHN1Y2NjdXJseWVxOiA4ODI5LFxuICAgIHN1Y2NuYXBwcm94OiAxMDkzOCxcbiAgICB0aGlja2FwcHJveDogODc3NixcbiAgICB1cGRvd25hcnJvdzogODU5NyxcbiAgICBCZXJub3VsbGlzOiA4NDkyLFxuICAgIENpcmNsZVBsdXM6IDg4NTMsXG4gICAgRXF1YWxUaWxkZTogODc3MCxcbiAgICBGb3VyaWVydHJmOiA4NDk3LFxuICAgIEltYWdpbmFyeUk6IDg1MjAsXG4gICAgTGFwbGFjZXRyZjogODQ2NixcbiAgICBMZWZ0VmVjdG9yOiA4NjM2LFxuICAgIExsZWZ0YXJyb3c6IDg2NjYsXG4gICAgTm90RWxlbWVudDogODcxMyxcbiAgICBOb3RHcmVhdGVyOiA4ODE1LFxuICAgIFByb3BvcnRpb246IDg3NTksXG4gICAgUmlnaHRBcnJvdzogODU5NCxcbiAgICBSaWdodEZsb29yOiA4OTcxLFxuICAgIFJpZ2h0YXJyb3c6IDg2NTgsXG4gICAgVGlsZGVFcXVhbDogODc3MSxcbiAgICBUaWxkZVRpbGRlOiA4Nzc2LFxuICAgIFVuZGVyQnJhY2U6IDkxODMsXG4gICAgVXBBcnJvd0JhcjogMTA1MTQsXG4gICAgVXBUZWVBcnJvdzogODYxMyxcbiAgICBjaXJjbGVkYXN0OiA4ODU5LFxuICAgIGNvbXBsZW1lbnQ6IDg3MDUsXG4gICAgY3VybHl3ZWRnZTogODkxMSxcbiAgICBlcXNsYW50Z3RyOiAxMDkwMixcbiAgICBndHJlcXFsZXNzOiAxMDg5MixcbiAgICBsZXNzYXBwcm94OiAxMDg4NSxcbiAgICBsZXNzZXFxZ3RyOiAxMDg5MSxcbiAgICBsbW91c3RhY2hlOiA5MTM2LFxuICAgIGxvbmdtYXBzdG86IDEwMjM2LFxuICAgIG1hcHN0b2Rvd246IDg2MTUsXG4gICAgbWFwc3RvbGVmdDogODYxMixcbiAgICBuTGVmdGFycm93OiA4NjUzLFxuICAgIG5sZWZ0YXJyb3c6IDg2MDIsXG4gICAgcHJlY2FwcHJveDogMTA5MzUsXG4gICAgcmlnaHRhcnJvdzogODU5NCxcbiAgICBybW91c3RhY2hlOiA5MTM3LFxuICAgIHNxc3Vic2V0ZXE6IDg4NDksXG4gICAgc3FzdXBzZXRlcTogODg1MCxcbiAgICBzdWJzZXRuZXFxOiAxMDk1NSxcbiAgICBzdWNjYXBwcm94OiAxMDkzNixcbiAgICBzdXBzZXRuZXFxOiAxMDk1NixcbiAgICB1cHVwYXJyb3dzOiA4NjQ4LFxuICAgIHZhcmVwc2lsb246IDk0OSxcbiAgICB2YXJub3RoaW5nOiA4NzA5LFxuICAgIEJhY2tzbGFzaDogODcyNixcbiAgICBDZW50ZXJEb3Q6IDE4MyxcbiAgICBDaXJjbGVEb3Q6IDg4NTcsXG4gICAgQ29uZ3J1ZW50OiA4ODAxLFxuICAgIENvcHJvZHVjdDogODcyMCxcbiAgICBEb3VibGVEb3Q6IDE2OCxcbiAgICBEb3duQXJyb3c6IDg1OTUsXG4gICAgRG93bkJyZXZlOiA3ODUsXG4gICAgRG93bmFycm93OiA4NjU5LFxuICAgIEh1bXBFcXVhbDogODc4MyxcbiAgICBMZWZ0QXJyb3c6IDg1OTIsXG4gICAgTGVmdEZsb29yOiA4OTcwLFxuICAgIExlZnRhcnJvdzogODY1NixcbiAgICBMZXNzVGlsZGU6IDg4MTgsXG4gICAgTWVsbGludHJmOiA4NDk5LFxuICAgIE1pbnVzUGx1czogODcyMyxcbiAgICBOb3RDdXBDYXA6IDg4MTMsXG4gICAgTm90RXhpc3RzOiA4NzA4LFxuICAgIE92ZXJCcmFjZTogOTE4MixcbiAgICBQbHVzTWludXM6IDE3NyxcbiAgICBUaGVyZWZvcmU6IDg3NTYsXG4gICAgVGhpblNwYWNlOiA4MjAxLFxuICAgIFRyaXBsZURvdDogODQxMSxcbiAgICBVbmlvblBsdXM6IDg4NDYsXG4gICAgYmFja3ByaW1lOiA4MjQ1LFxuICAgIGJhY2tzaW1lcTogODkwOSxcbiAgICBiaWdvdGltZXM6IDEwNzU0LFxuICAgIGNlbnRlcmRvdDogMTgzLFxuICAgIGNoZWNrbWFyazogMTAwMDMsXG4gICAgY29tcGxleGVzOiA4NDUwLFxuICAgIGRvdHNxdWFyZTogODg2NSxcbiAgICBkb3duYXJyb3c6IDg1OTUsXG4gICAgZ3RyYXBwcm94OiAxMDg4NixcbiAgICBndHJlcWxlc3M6IDg5MjMsXG4gICAgaGVhcnRzdWl0OiA5ODI5LFxuICAgIGxlZnRhcnJvdzogODU5MixcbiAgICBsZXNzZXFndHI6IDg5MjIsXG4gICAgbnBhcmFsbGVsOiA4NzQyLFxuICAgIG5zaG9ydG1pZDogODc0MCxcbiAgICBuc3Vic2V0ZXE6IDg4NDAsXG4gICAgbnN1cHNldGVxOiA4ODQxLFxuICAgIHBpdGNoZm9yazogODkxNixcbiAgICByYXRpb25hbHM6IDg0NzQsXG4gICAgc3BhZGVzdWl0OiA5ODI0LFxuICAgIHN1YnNldGVxcTogMTA5NDksXG4gICAgc3Vic2V0bmVxOiA4ODQyLFxuICAgIHN1cHNldGVxcTogMTA5NTAsXG4gICAgc3Vwc2V0bmVxOiA4ODQzLFxuICAgIHRoZXJlZm9yZTogODc1NixcbiAgICB0cmlhbmdsZXE6IDg3OTYsXG4gICAgdmFycHJvcHRvOiA4NzMzLFxuICAgIEREb3RyYWhkOiAxMDUxMyxcbiAgICBEb3RFcXVhbDogODc4NCxcbiAgICBJbnRlZ3JhbDogODc0NyxcbiAgICBMZXNzTGVzczogMTA5MTMsXG4gICAgTm90RXF1YWw6IDg4MDAsXG4gICAgTm90VGlsZGU6IDg3NjksXG4gICAgUGFydGlhbEQ6IDg3MDYsXG4gICAgUHJlY2VkZXM6IDg4MjYsXG4gICAgUmlnaHRUZWU6IDg4NjYsXG4gICAgU3VjY2VlZHM6IDg4MjcsXG4gICAgU3VjaFRoYXQ6IDg3MTUsXG4gICAgU3VwZXJzZXQ6IDg4MzUsXG4gICAgVWFycm9jaXI6IDEwNTY5LFxuICAgIFVuZGVyQmFyOiA4MTgsXG4gICAgYW5kc2xvcGU6IDEwODQwLFxuICAgIGFuZ21zZGFhOiAxMDY2NCxcbiAgICBhbmdtc2RhYjogMTA2NjUsXG4gICAgYW5nbXNkYWM6IDEwNjY2LFxuICAgIGFuZ21zZGFkOiAxMDY2NyxcbiAgICBhbmdtc2RhZTogMTA2NjgsXG4gICAgYW5nbXNkYWY6IDEwNjY5LFxuICAgIGFuZ21zZGFnOiAxMDY3MCxcbiAgICBhbmdtc2RhaDogMTA2NzEsXG4gICAgYW5ncnR2YmQ6IDEwNjUzLFxuICAgIGFwcHJveGVxOiA4Nzc4LFxuICAgIGF3Y29uaW50OiA4NzU1LFxuICAgIGJhY2tjb25nOiA4NzgwLFxuICAgIGJhcndlZGdlOiA4OTY1LFxuICAgIGJicmt0YnJrOiA5MTQyLFxuICAgIGJpZ29wbHVzOiAxMDc1MyxcbiAgICBiaWdzcWN1cDogMTA3NTgsXG4gICAgYmlndXBsdXM6IDEwNzU2LFxuICAgIGJpZ3dlZGdlOiA4ODk2LFxuICAgIGJveG1pbnVzOiA4ODYzLFxuICAgIGJveHRpbWVzOiA4ODY0LFxuICAgIGNhcGJyY3VwOiAxMDgyNSxcbiAgICBjaXJjbGVkUjogMTc0LFxuICAgIGNpcmNsZWRTOiA5NDE2LFxuICAgIGNpcmZuaW50OiAxMDc2OCxcbiAgICBjbHVic3VpdDogOTgyNyxcbiAgICBjdXBicmNhcDogMTA4MjQsXG4gICAgY3VybHl2ZWU6IDg5MTAsXG4gICAgY3djb25pbnQ6IDg3NTQsXG4gICAgZG90ZXFkb3Q6IDg3ODUsXG4gICAgZG90bWludXM6IDg3NjAsXG4gICAgZHJia2Fyb3c6IDEwNTEyLFxuICAgIGR6aWdyYXJyOiAxMDIzOSxcbiAgICBlbGludGVyczogOTE5MSxcbiAgICBlbXB0eXNldDogODcwOSxcbiAgICBlcXZwYXJzbDogMTA3MjUsXG4gICAgZnBhcnRpbnQ6IDEwNzY1LFxuICAgIGdlcXNsYW50OiAxMDg3OCxcbiAgICBnZXNkb3RvbDogMTA4ODQsXG4gICAgZ25hcHByb3g6IDEwODkwLFxuICAgIGhrc2Vhcm93OiAxMDUzMyxcbiAgICBoa3N3YXJvdzogMTA1MzQsXG4gICAgaW1hZ2xpbmU6IDg0NjQsXG4gICAgaW1hZ3BhcnQ6IDg0NjUsXG4gICAgaW5maW50aWU6IDEwNzE3LFxuICAgIGludGVnZXJzOiA4NDg0LFxuICAgIGludGVyY2FsOiA4ODkwLFxuICAgIGludGxhcmhrOiAxMDc3NSxcbiAgICBsYWVtcHR5djogMTA2NzYsXG4gICAgbGRydXNoYXI6IDEwNTcxLFxuICAgIGxlcXNsYW50OiAxMDg3NyxcbiAgICBsZXNkb3RvcjogMTA4ODMsXG4gICAgbGxjb3JuZXI6IDg5OTAsXG4gICAgbG5hcHByb3g6IDEwODg5LFxuICAgIGxyY29ybmVyOiA4OTkxLFxuICAgIGx1cmRzaGFyOiAxMDU3MCxcbiAgICBtYXBzdG91cDogODYxMyxcbiAgICBtdWx0aW1hcDogODg4OCxcbiAgICBuYXR1cmFsczogODQ2OSxcbiAgICBvdGltZXNhczogMTA4MDYsXG4gICAgcGFyYWxsZWw6IDg3NDEsXG4gICAgcGx1c2FjaXI6IDEwNzg3LFxuICAgIHBvaW50aW50OiAxMDc3MyxcbiAgICBwcmVjbmVxcTogMTA5MzMsXG4gICAgcHJlY25zaW06IDg5MzYsXG4gICAgcHJvZmFsYXI6IDkwMDYsXG4gICAgcHJvZmxpbmU6IDg5NzgsXG4gICAgcHJvZnN1cmY6IDg5NzksXG4gICAgcmFlbXB0eXY6IDEwNjc1LFxuICAgIHJlYWxwYXJ0OiA4NDc2LFxuICAgIHJwcG9saW50OiAxMDc3MCxcbiAgICBydHJpbHRyaTogMTA3MDIsXG4gICAgc2Nwb2xpbnQ6IDEwNzcxLFxuICAgIHNldG1pbnVzOiA4NzI2LFxuICAgIHNob3J0bWlkOiA4NzM5LFxuICAgIHNtZXBhcnNsOiAxMDcyNCxcbiAgICBzcXN1YnNldDogODg0NyxcbiAgICBzcXN1cHNldDogODg0OCxcbiAgICBzdWJzZXRlcTogODgzOCxcbiAgICBzdWNjbmVxcTogMTA5MzQsXG4gICAgc3VjY25zaW06IDg5MzcsXG4gICAgc3Vwc2V0ZXE6IDg4MzksXG4gICAgdGhldGFzeW06IDk3NyxcbiAgICB0aGlja3NpbTogODc2NCxcbiAgICB0aW1lc2JhcjogMTA4MDEsXG4gICAgdHJpYW5nbGU6IDk2NTMsXG4gICAgdHJpbWludXM6IDEwODEwLFxuICAgIHRycGV6aXVtOiA5MTg2LFxuICAgIHVsY29ybmVyOiA4OTg4LFxuICAgIHVyY29ybmVyOiA4OTg5LFxuICAgIHZhcmthcHBhOiAxMDA4LFxuICAgIHZhcnNpZ21hOiA5NjIsXG4gICAgdmFydGhldGE6IDk3NyxcbiAgICBCZWNhdXNlOiA4NzU3LFxuICAgIENheWxleXM6IDg0OTMsXG4gICAgQ2NvbmludDogODc1MixcbiAgICBDZWRpbGxhOiAxODQsXG4gICAgRGlhbW9uZDogODkwMCxcbiAgICBEb3duVGVlOiA4ODY4LFxuICAgIEVsZW1lbnQ6IDg3MTIsXG4gICAgRXBzaWxvbjogOTE3LFxuICAgIEltcGxpZXM6IDg2NTgsXG4gICAgTGVmdFRlZTogODg2NyxcbiAgICBOZXdMaW5lOiAxMCxcbiAgICBOb0JyZWFrOiA4Mjg4LFxuICAgIE5vdExlc3M6IDg4MTQsXG4gICAgT21pY3JvbjogOTI3LFxuICAgIE92ZXJCYXI6IDE3NSxcbiAgICBQcm9kdWN0OiA4NzE5LFxuICAgIFVwQXJyb3c6IDg1OTMsXG4gICAgVXBhcnJvdzogODY1NyxcbiAgICBVcHNpbG9uOiA5MzMsXG4gICAgYWxlZnN5bTogODUwMSxcbiAgICBhbmdydHZiOiA4ODk0LFxuICAgIGFuZ3phcnI6IDkwODQsXG4gICAgYXN5bXBlcTogODc4MSxcbiAgICBiYWNrc2ltOiA4NzY1LFxuICAgIGJlY2F1c2U6IDg3NTcsXG4gICAgYmVtcHR5djogMTA2NzIsXG4gICAgYmV0d2VlbjogODgxMixcbiAgICBiaWdjaXJjOiA5NzExLFxuICAgIGJpZ29kb3Q6IDEwNzUyLFxuICAgIGJpZ3N0YXI6IDk3MzMsXG4gICAgYm94cGx1czogODg2MixcbiAgICBjY3Vwc3NtOiAxMDgzMixcbiAgICBjZW1wdHl2OiAxMDY3NCxcbiAgICBjaXJzY2lyOiAxMDY5MCxcbiAgICBjb2xvbmVxOiA4Nzg4LFxuICAgIGNvbmdkb3Q6IDEwODYxLFxuICAgIGN1ZGFycmw6IDEwNTUyLFxuICAgIGN1ZGFycnI6IDEwNTQ5LFxuICAgIGN1bGFycnA6IDEwNTU3LFxuICAgIGN1cmFycm06IDEwNTU2LFxuICAgIGRia2Fyb3c6IDEwNTExLFxuICAgIGRkYWdnZXI6IDgyMjUsXG4gICAgZGRvdHNlcTogMTA4NzEsXG4gICAgZGVtcHR5djogMTA2NzMsXG4gICAgZGlhbW9uZDogODkwMCxcbiAgICBkaWdhbW1hOiA5ODksXG4gICAgZG90cGx1czogODcyNCxcbiAgICBkd2FuZ2xlOiAxMDY2MixcbiAgICBlcHNpbG9uOiA5NDksXG4gICAgZXFjb2xvbjogODc4OSxcbiAgICBlcXVpdkREOiAxMDg3MixcbiAgICBnZXNkb3RvOiAxMDg4MixcbiAgICBndHF1ZXN0OiAxMDg3NixcbiAgICBndHJsZXNzOiA4ODIzLFxuICAgIGhhcnJjaXI6IDEwNTY4LFxuICAgIGludHByb2Q6IDEwODEyLFxuICAgIGlzaW5kb3Q6IDg5NDksXG4gICAgbGFycmJmczogMTA1MjcsXG4gICAgbGFycnNpbTogMTA2MTEsXG4gICAgbGJya3NsZDogMTA2MzksXG4gICAgbGJya3NsdTogMTA2MzcsXG4gICAgbGRyZGhhcjogMTA1OTksXG4gICAgbGVzZG90bzogMTA4ODEsXG4gICAgbGVzc2RvdDogODkxOCxcbiAgICBsZXNzZ3RyOiA4ODIyLFxuICAgIGxlc3NzaW06IDg4MTgsXG4gICAgbG90aW1lczogMTA4MDQsXG4gICAgbG96ZW5nZTogOTY3NCxcbiAgICBsdHF1ZXN0OiAxMDg3NSxcbiAgICBsdXJ1aGFyOiAxMDU5OCxcbiAgICBtYWx0ZXNlOiAxMDAxNixcbiAgICBtaW51c2R1OiAxMDc5NCxcbiAgICBuYXBwcm94OiA4Nzc3LFxuICAgIG5hdHVyYWw6IDk4MzgsXG4gICAgbmVhcnJvdzogODU5OSxcbiAgICBuZXhpc3RzOiA4NzA4LFxuICAgIG5vdGludmE6IDg3MTMsXG4gICAgbm90aW52YjogODk1MSxcbiAgICBub3RpbnZjOiA4OTUwLFxuICAgIG5vdG5pdmE6IDg3MTYsXG4gICAgbm90bml2YjogODk1OCxcbiAgICBub3RuaXZjOiA4OTU3LFxuICAgIG5wb2xpbnQ6IDEwNzcyLFxuICAgIG5zcXN1YmU6IDg5MzAsXG4gICAgbnNxc3VwZTogODkzMSxcbiAgICBudmluZmluOiAxMDcxOCxcbiAgICBud2Fycm93OiA4NTk4LFxuICAgIG9sY3Jvc3M6IDEwNjgzLFxuICAgIG9taWNyb246IDk1OSxcbiAgICBvcmRlcm9mOiA4NTAwLFxuICAgIG9yc2xvcGU6IDEwODM5LFxuICAgIHBlcnRlbms6IDgyNDEsXG4gICAgcGxhbmNraDogODQ2MixcbiAgICBwbHVzY2lyOiAxMDc4NixcbiAgICBwbHVzc2ltOiAxMDc5MCxcbiAgICBwbHVzdHdvOiAxMDc5MSxcbiAgICBwcmVjc2ltOiA4ODMwLFxuICAgIHF1YXRpbnQ6IDEwNzc0LFxuICAgIHF1ZXN0ZXE6IDg3OTksXG4gICAgcmFycmJmczogMTA1MjgsXG4gICAgcmFycnNpbTogMTA2MTIsXG4gICAgcmJya3NsZDogMTA2MzgsXG4gICAgcmJya3NsdTogMTA2NDAsXG4gICAgcmRsZGhhcjogMTA2MDEsXG4gICAgcmVhbGluZTogODQ3NSxcbiAgICByb3RpbWVzOiAxMDgwNSxcbiAgICBydWx1aGFyOiAxMDYwMCxcbiAgICBzZWFycm93OiA4NjAwLFxuICAgIHNpbXBsdXM6IDEwNzg4LFxuICAgIHNpbXJhcnI6IDEwNjEwLFxuICAgIHN1YmVkb3Q6IDEwOTQ3LFxuICAgIHN1Ym11bHQ6IDEwOTQ1LFxuICAgIHN1YnBsdXM6IDEwOTQzLFxuICAgIHN1YnJhcnI6IDEwNjE3LFxuICAgIHN1Y2NzaW06IDg4MzEsXG4gICAgc3VwZHN1YjogMTA5NjgsXG4gICAgc3VwZWRvdDogMTA5NDgsXG4gICAgc3VwaHN1YjogMTA5NjcsXG4gICAgc3VwbGFycjogMTA2MTksXG4gICAgc3VwbXVsdDogMTA5NDYsXG4gICAgc3VwcGx1czogMTA5NDQsXG4gICAgc3dhcnJvdzogODYwMSxcbiAgICB0b3Bmb3JrOiAxMDk3MCxcbiAgICB0cmlwbHVzOiAxMDgwOSxcbiAgICB0cml0aW1lOiAxMDgxMSxcbiAgICB1cGFycm93OiA4NTkzLFxuICAgIHVwc2lsb246IDk2NSxcbiAgICB1d2FuZ2xlOiAxMDY2MyxcbiAgICB2emlnemFnOiAxMDY1MCxcbiAgICB6aWdyYXJyOiA4NjY5LFxuICAgIEFhY3V0ZTogMTkzLFxuICAgIEFicmV2ZTogMjU4LFxuICAgIEFncmF2ZTogMTkyLFxuICAgIEFzc2lnbjogODc4OCxcbiAgICBBdGlsZGU6IDE5NSxcbiAgICBCYXJ3ZWQ6IDg5NjYsXG4gICAgQnVtcGVxOiA4NzgyLFxuICAgIENhY3V0ZTogMjYyLFxuICAgIENjYXJvbjogMjY4LFxuICAgIENjZWRpbDogMTk5LFxuICAgIENvbG9uZTogMTA4NjgsXG4gICAgQ29uaW50OiA4NzUxLFxuICAgIEN1cENhcDogODc4MSxcbiAgICBEYWdnZXI6IDgyMjUsXG4gICAgRGNhcm9uOiAyNzAsXG4gICAgRG90RG90OiA4NDEyLFxuICAgIERzdHJvazogMjcyLFxuICAgIEVhY3V0ZTogMjAxLFxuICAgIEVjYXJvbjogMjgyLFxuICAgIEVncmF2ZTogMjAwLFxuICAgIEV4aXN0czogODcwNyxcbiAgICBGb3JBbGw6IDg3MDQsXG4gICAgR2FtbWFkOiA5ODgsXG4gICAgR2JyZXZlOiAyODYsXG4gICAgR2NlZGlsOiAyOTAsXG4gICAgSEFSRGN5OiAxMDY2LFxuICAgIEhzdHJvazogMjk0LFxuICAgIElhY3V0ZTogMjA1LFxuICAgIElncmF2ZTogMjA0LFxuICAgIEl0aWxkZTogMjk2LFxuICAgIEpzZXJjeTogMTAzMixcbiAgICBLY2VkaWw6IDMxMCxcbiAgICBMYWN1dGU6IDMxMyxcbiAgICBMYW1iZGE6IDkyMyxcbiAgICBMY2Fyb246IDMxNyxcbiAgICBMY2VkaWw6IDMxNSxcbiAgICBMbWlkb3Q6IDMxOSxcbiAgICBMc3Ryb2s6IDMyMSxcbiAgICBOYWN1dGU6IDMyMyxcbiAgICBOY2Fyb246IDMyNyxcbiAgICBOY2VkaWw6IDMyNSxcbiAgICBOdGlsZGU6IDIwOSxcbiAgICBPYWN1dGU6IDIxMSxcbiAgICBPZGJsYWM6IDMzNixcbiAgICBPZ3JhdmU6IDIxMCxcbiAgICBPc2xhc2g6IDIxNixcbiAgICBPdGlsZGU6IDIxMyxcbiAgICBPdGltZXM6IDEwODA3LFxuICAgIFJhY3V0ZTogMzQwLFxuICAgIFJhcnJ0bDogMTA1MTgsXG4gICAgUmNhcm9uOiAzNDQsXG4gICAgUmNlZGlsOiAzNDIsXG4gICAgU0hDSGN5OiAxMDY1LFxuICAgIFNPRlRjeTogMTA2OCxcbiAgICBTYWN1dGU6IDM0NixcbiAgICBTY2Fyb246IDM1MixcbiAgICBTY2VkaWw6IDM1MCxcbiAgICBTcXVhcmU6IDk2MzMsXG4gICAgU3Vic2V0OiA4OTEyLFxuICAgIFN1cHNldDogODkxMyxcbiAgICBUY2Fyb246IDM1NixcbiAgICBUY2VkaWw6IDM1NCxcbiAgICBUc3Ryb2s6IDM1OCxcbiAgICBVYWN1dGU6IDIxOCxcbiAgICBVYnJldmU6IDM2NCxcbiAgICBVZGJsYWM6IDM2OCxcbiAgICBVZ3JhdmU6IDIxNyxcbiAgICBVdGlsZGU6IDM2MCxcbiAgICBWZGFzaGw6IDEwOTgyLFxuICAgIFZlcmJhcjogODIxNCxcbiAgICBWdmRhc2g6IDg4NzQsXG4gICAgWWFjdXRlOiAyMjEsXG4gICAgWmFjdXRlOiAzNzcsXG4gICAgWmNhcm9uOiAzODEsXG4gICAgYWFjdXRlOiAyMjUsXG4gICAgYWJyZXZlOiAyNTksXG4gICAgYWdyYXZlOiAyMjQsXG4gICAgYW5kYW5kOiAxMDgzNyxcbiAgICBhbmdtc2Q6IDg3MzcsXG4gICAgYW5nc3BoOiA4NzM4LFxuICAgIGFwYWNpcjogMTA4NjMsXG4gICAgYXBwcm94OiA4Nzc2LFxuICAgIGF0aWxkZTogMjI3LFxuICAgIGJhcnZlZTogODg5MyxcbiAgICBiYXJ3ZWQ6IDg5NjUsXG4gICAgYmVjYXVzOiA4NzU3LFxuICAgIGJlcm5vdTogODQ5MixcbiAgICBiaWdjYXA6IDg4OTgsXG4gICAgYmlnY3VwOiA4ODk5LFxuICAgIGJpZ3ZlZTogODg5NyxcbiAgICBia2Fyb3c6IDEwNTA5LFxuICAgIGJvdHRvbTogODg2OSxcbiAgICBib3d0aWU6IDg5MDQsXG4gICAgYm94Ym94OiAxMDY5NyxcbiAgICBicHJpbWU6IDgyNDUsXG4gICAgYnJ2YmFyOiAxNjYsXG4gICAgYnVsbGV0OiA4MjI2LFxuICAgIGJ1bXBlcTogODc4MyxcbiAgICBjYWN1dGU6IDI2MyxcbiAgICBjYXBhbmQ6IDEwODIwLFxuICAgIGNhcGNhcDogMTA4MjcsXG4gICAgY2FwY3VwOiAxMDgyMyxcbiAgICBjYXBkb3Q6IDEwODE2LFxuICAgIGNjYXJvbjogMjY5LFxuICAgIGNjZWRpbDogMjMxLFxuICAgIGNpcmNlcTogODc5MSxcbiAgICBjaXJtaWQ6IDEwOTkxLFxuICAgIGNvbG9uZTogODc4OCxcbiAgICBjb21tYXQ6IDY0LFxuICAgIGNvbXBmbjogODcyOCxcbiAgICBjb25pbnQ6IDg3NTAsXG4gICAgY29wcm9kOiA4NzIwLFxuICAgIGNvcHlzcjogODQ3MSxcbiAgICBjdWxhcnI6IDg2MzAsXG4gICAgY3VwY2FwOiAxMDgyMixcbiAgICBjdXBjdXA6IDEwODI2LFxuICAgIGN1cGRvdDogODg0NSxcbiAgICBjdXJhcnI6IDg2MzEsXG4gICAgY3VycmVuOiAxNjQsXG4gICAgY3lsY3R5OiA5MDA1LFxuICAgIGRhZ2dlcjogODIyNCxcbiAgICBkYWxldGg6IDg1MDQsXG4gICAgZGNhcm9uOiAyNzEsXG4gICAgZGZpc2h0OiAxMDYyMyxcbiAgICBkaXZpZGU6IDI0NyxcbiAgICBkaXZvbng6IDg5MDMsXG4gICAgZGxjb3JuOiA4OTkwLFxuICAgIGRsY3JvcDogODk3MyxcbiAgICBkb2xsYXI6IDM2LFxuICAgIGRyY29ybjogODk5MSxcbiAgICBkcmNyb3A6IDg5NzIsXG4gICAgZHN0cm9rOiAyNzMsXG4gICAgZWFjdXRlOiAyMzMsXG4gICAgZWFzdGVyOiAxMDg2MixcbiAgICBlY2Fyb246IDI4MyxcbiAgICBlY29sb246IDg3ODksXG4gICAgZWdyYXZlOiAyMzIsXG4gICAgZWdzZG90OiAxMDkwNCxcbiAgICBlbHNkb3Q6IDEwOTAzLFxuICAgIGVtcHR5djogODcwOSxcbiAgICBlbXNwMTM6IDgxOTYsXG4gICAgZW1zcDE0OiA4MTk3LFxuICAgIGVwYXJzbDogMTA3MjMsXG4gICAgZXFjaXJjOiA4NzkwLFxuICAgIGVxdWFsczogNjEsXG4gICAgZXF1ZXN0OiA4Nzk5LFxuICAgIGZlbWFsZTogOTc5MixcbiAgICBmZmlsaWc6IDY0MjU5LFxuICAgIGZmbGxpZzogNjQyNjAsXG4gICAgZm9yYWxsOiA4NzA0LFxuICAgIGZyYWMxMjogMTg5LFxuICAgIGZyYWMxMzogODUzMSxcbiAgICBmcmFjMTQ6IDE4OCxcbiAgICBmcmFjMTU6IDg1MzMsXG4gICAgZnJhYzE2OiA4NTM3LFxuICAgIGZyYWMxODogODUzOSxcbiAgICBmcmFjMjM6IDg1MzIsXG4gICAgZnJhYzI1OiA4NTM0LFxuICAgIGZyYWMzNDogMTkwLFxuICAgIGZyYWMzNTogODUzNSxcbiAgICBmcmFjMzg6IDg1NDAsXG4gICAgZnJhYzQ1OiA4NTM2LFxuICAgIGZyYWM1NjogODUzOCxcbiAgICBmcmFjNTg6IDg1NDEsXG4gICAgZnJhYzc4OiA4NTQyLFxuICAgIGdhY3V0ZTogNTAxLFxuICAgIGdhbW1hZDogOTg5LFxuICAgIGdicmV2ZTogMjg3LFxuICAgIGdlc2RvdDogMTA4ODAsXG4gICAgZ2VzbGVzOiAxMDkwMCxcbiAgICBndGxQYXI6IDEwNjQ1LFxuICAgIGd0cmFycjogMTA2MTYsXG4gICAgZ3RyZG90OiA4OTE5LFxuICAgIGd0cnNpbTogODgxOSxcbiAgICBoYWlyc3A6IDgyMDIsXG4gICAgaGFtaWx0OiA4NDU5LFxuICAgIGhhcmRjeTogMTA5OCxcbiAgICBoZWFydHM6IDk4MjksXG4gICAgaGVsbGlwOiA4MjMwLFxuICAgIGhlcmNvbjogODg4OSxcbiAgICBob210aHQ6IDg3NjMsXG4gICAgaG9yYmFyOiA4MjEzLFxuICAgIGhzbGFzaDogODQ2MyxcbiAgICBoc3Ryb2s6IDI5NSxcbiAgICBoeWJ1bGw6IDgyNTksXG4gICAgaHlwaGVuOiA4MjA4LFxuICAgIGlhY3V0ZTogMjM3LFxuICAgIGlncmF2ZTogMjM2LFxuICAgIGlpaWludDogMTA3NjQsXG4gICAgaWluZmluOiAxMDcxNixcbiAgICBpbmNhcmU6IDg0NTMsXG4gICAgaW5vZG90OiAzMDUsXG4gICAgaW50Y2FsOiA4ODkwLFxuICAgIGlxdWVzdDogMTkxLFxuICAgIGlzaW5zdjogODk0NyxcbiAgICBpdGlsZGU6IDI5NyxcbiAgICBqc2VyY3k6IDExMTIsXG4gICAga2FwcGF2OiAxMDA4LFxuICAgIGtjZWRpbDogMzExLFxuICAgIGtncmVlbjogMzEyLFxuICAgIGxBdGFpbDogMTA1MjMsXG4gICAgbGFjdXRlOiAzMTQsXG4gICAgbGFncmFuOiA4NDY2LFxuICAgIGxhbWJkYTogOTU1LFxuICAgIGxhbmdsZTogMTAyMTYsXG4gICAgbGFycmZzOiAxMDUyNSxcbiAgICBsYXJyaGs6IDg2MTcsXG4gICAgbGFycmxwOiA4NjE5LFxuICAgIGxhcnJwbDogMTA1NTMsXG4gICAgbGFycnRsOiA4NjEwLFxuICAgIGxhdGFpbDogMTA1MjEsXG4gICAgbGJyYWNlOiAxMjMsXG4gICAgbGJyYWNrOiA5MSxcbiAgICBsY2Fyb246IDMxOCxcbiAgICBsY2VkaWw6IDMxNixcbiAgICBsZHF1b3I6IDgyMjIsXG4gICAgbGVzZG90OiAxMDg3OSxcbiAgICBsZXNnZXM6IDEwODk5LFxuICAgIGxmaXNodDogMTA2MjAsXG4gICAgbGZsb29yOiA4OTcwLFxuICAgIGxoYXJ1bDogMTA2MDIsXG4gICAgbGxoYXJkOiAxMDYwMyxcbiAgICBsbWlkb3Q6IDMyMCxcbiAgICBsbW91c3Q6IDkxMzYsXG4gICAgbG9wbHVzOiAxMDc5NyxcbiAgICBsb3dhc3Q6IDg3MjcsXG4gICAgbG93YmFyOiA5NSxcbiAgICBscGFybHQ6IDEwNjQzLFxuICAgIGxyaGFyZDogMTA2MDUsXG4gICAgbHNhcXVvOiA4MjQ5LFxuICAgIGxzcXVvcjogODIxOCxcbiAgICBsc3Ryb2s6IDMyMixcbiAgICBsdGhyZWU6IDg5MDcsXG4gICAgbHRpbWVzOiA4OTA1LFxuICAgIGx0bGFycjogMTA2MTQsXG4gICAgbHRyUGFyOiAxMDY0NixcbiAgICBtYXBzdG86IDg2MTQsXG4gICAgbWFya2VyOiA5NjQ2LFxuICAgIG1jb21tYTogMTA3OTMsXG4gICAgbWlkYXN0OiA0MixcbiAgICBtaWRjaXI6IDEwOTkyLFxuICAgIG1pZGRvdDogMTgzLFxuICAgIG1pbnVzYjogODg2MyxcbiAgICBtaW51c2Q6IDg3NjAsXG4gICAgbW5wbHVzOiA4NzIzLFxuICAgIG1vZGVsczogODg3MSxcbiAgICBtc3Rwb3M6IDg3NjYsXG4gICAgblZEYXNoOiA4ODc5LFxuICAgIG5WZGFzaDogODg3OCxcbiAgICBuYWN1dGU6IDMyNCxcbiAgICBuY2Fyb246IDMyOCxcbiAgICBuY2VkaWw6IDMyNixcbiAgICBuZWFyaGs6IDEwNTMyLFxuICAgIG5lcXVpdjogODgwMixcbiAgICBuZXNlYXI6IDEwNTM2LFxuICAgIG5leGlzdDogODcwOCxcbiAgICBubHRyaWU6IDg5NDAsXG4gICAgbnByY3VlOiA4OTI4LFxuICAgIG5ydHJpZTogODk0MSxcbiAgICBuc2NjdWU6IDg5MjksXG4gICAgbnNpbWVxOiA4NzcyLFxuICAgIG50aWxkZTogMjQxLFxuICAgIG51bWVybzogODQ3MCxcbiAgICBudkRhc2g6IDg4NzcsXG4gICAgbnZIYXJyOiAxMDUwMCxcbiAgICBudmRhc2g6IDg4NzYsXG4gICAgbnZsQXJyOiAxMDQ5OCxcbiAgICBudnJBcnI6IDEwNDk5LFxuICAgIG53YXJoazogMTA1MzEsXG4gICAgbnduZWFyOiAxMDUzNSxcbiAgICBvYWN1dGU6IDI0MyxcbiAgICBvZGJsYWM6IDMzNyxcbiAgICBvZHNvbGQ6IDEwNjg0LFxuICAgIG9ncmF2ZTogMjQyLFxuICAgIG9taW51czogODg1NCxcbiAgICBvcmlnb2Y6IDg4ODYsXG4gICAgb3NsYXNoOiAyNDgsXG4gICAgb3RpbGRlOiAyNDUsXG4gICAgb3RpbWVzOiA4ODU1LFxuICAgIHBhcnNpbTogMTA5OTUsXG4gICAgcGVyY250OiAzNyxcbiAgICBwZXJpb2Q6IDQ2LFxuICAgIHBlcm1pbDogODI0MCxcbiAgICBwaG1tYXQ6IDg0OTksXG4gICAgcGxhbmNrOiA4NDYzLFxuICAgIHBsYW5rdjogODQ2MyxcbiAgICBwbHVzZG86IDg3MjQsXG4gICAgcGx1c2R1OiAxMDc4OSxcbiAgICBwbHVzbW46IDE3NyxcbiAgICBwcmVjZXE6IDEwOTI3LFxuICAgIHByaW1lczogODQ3MyxcbiAgICBwcm5zaW06IDg5MzYsXG4gICAgcHJvcHRvOiA4NzMzLFxuICAgIHBydXJlbDogODg4MCxcbiAgICBwdW5jc3A6IDgyMDAsXG4gICAgcXByaW1lOiA4Mjc5LFxuICAgIHJBdGFpbDogMTA1MjQsXG4gICAgcmFjdXRlOiAzNDEsXG4gICAgcmFuZ2xlOiAxMDIxNyxcbiAgICByYXJyYXA6IDEwNjEzLFxuICAgIHJhcnJmczogMTA1MjYsXG4gICAgcmFycmhrOiA4NjE4LFxuICAgIHJhcnJscDogODYyMCxcbiAgICByYXJycGw6IDEwNTY1LFxuICAgIHJhcnJ0bDogODYxMSxcbiAgICByYXRhaWw6IDEwNTIyLFxuICAgIHJicmFjZTogMTI1LFxuICAgIHJicmFjazogOTMsXG4gICAgcmNhcm9uOiAzNDUsXG4gICAgcmNlZGlsOiAzNDMsXG4gICAgcmRxdW9yOiA4MjIxLFxuICAgIHJmaXNodDogMTA2MjEsXG4gICAgcmZsb29yOiA4OTcxLFxuICAgIHJoYXJ1bDogMTA2MDQsXG4gICAgcm1vdXN0OiA5MTM3LFxuICAgIHJvcGx1czogMTA3OTgsXG4gICAgcnBhcmd0OiAxMDY0NCxcbiAgICByc2FxdW86IDgyNTAsXG4gICAgcnNxdW9yOiA4MjE3LFxuICAgIHJ0aHJlZTogODkwOCxcbiAgICBydGltZXM6IDg5MDYsXG4gICAgc2FjdXRlOiAzNDcsXG4gICAgc2Nhcm9uOiAzNTMsXG4gICAgc2NlZGlsOiAzNTEsXG4gICAgc2Nuc2ltOiA4OTM3LFxuICAgIHNlYXJoazogMTA1MzMsXG4gICAgc2Vzd2FyOiAxMDUzNyxcbiAgICBzZnJvd246IDg5OTQsXG4gICAgc2hjaGN5OiAxMDk3LFxuICAgIHNpZ21hZjogOTYyLFxuICAgIHNpZ21hdjogOTYyLFxuICAgIHNpbWRvdDogMTA4NTgsXG4gICAgc21hc2hwOiAxMDgwMyxcbiAgICBzb2Z0Y3k6IDExMDAsXG4gICAgc29sYmFyOiA5MDIzLFxuICAgIHNwYWRlczogOTgyNCxcbiAgICBzcXN1YmU6IDg4NDksXG4gICAgc3FzdXBlOiA4ODUwLFxuICAgIHNxdWFyZTogOTYzMyxcbiAgICBzcXVhcmY6IDk2NDIsXG4gICAgc3NldG1uOiA4NzI2LFxuICAgIHNzbWlsZTogODk5NSxcbiAgICBzc3RhcmY6IDg5MDIsXG4gICAgc3ViZG90OiAxMDk0MSxcbiAgICBzdWJzZXQ6IDg4MzQsXG4gICAgc3Vic2ltOiAxMDk1MSxcbiAgICBzdWJzdWI6IDEwOTY1LFxuICAgIHN1YnN1cDogMTA5NjMsXG4gICAgc3VjY2VxOiAxMDkyOCxcbiAgICBzdXBkb3Q6IDEwOTQyLFxuICAgIHN1cHNldDogODgzNSxcbiAgICBzdXBzaW06IDEwOTUyLFxuICAgIHN1cHN1YjogMTA5NjQsXG4gICAgc3Vwc3VwOiAxMDk2NixcbiAgICBzd2FyaGs6IDEwNTM0LFxuICAgIHN3bndhcjogMTA1MzgsXG4gICAgdGFyZ2V0OiA4OTgyLFxuICAgIHRjYXJvbjogMzU3LFxuICAgIHRjZWRpbDogMzU1LFxuICAgIHRlbHJlYzogODk4MSxcbiAgICB0aGVyZTQ6IDg3NTYsXG4gICAgdGhldGF2OiA5NzcsXG4gICAgdGhpbnNwOiA4MjAxLFxuICAgIHRoa3NpbTogODc2NCxcbiAgICB0aW1lc2I6IDg4NjQsXG4gICAgdGltZXNkOiAxMDgwMCxcbiAgICB0b3Bib3Q6IDkwMTQsXG4gICAgdG9wY2lyOiAxMDk5MyxcbiAgICB0cHJpbWU6IDgyNDQsXG4gICAgdHJpZG90OiA5NzA4LFxuICAgIHRzdHJvazogMzU5LFxuICAgIHVhY3V0ZTogMjUwLFxuICAgIHVicmV2ZTogMzY1LFxuICAgIHVkYmxhYzogMzY5LFxuICAgIHVmaXNodDogMTA2MjIsXG4gICAgdWdyYXZlOiAyNDksXG4gICAgdWxjb3JuOiA4OTg4LFxuICAgIHVsY3JvcDogODk3NSxcbiAgICB1cmNvcm46IDg5ODksXG4gICAgdXJjcm9wOiA4OTc0LFxuICAgIHV0aWxkZTogMzYxLFxuICAgIHZhbmdydDogMTA2NTIsXG4gICAgdmFycGhpOiA5NjYsXG4gICAgdmFycmhvOiAxMDA5LFxuICAgIHZlZWJhcjogODg5MSxcbiAgICB2ZWxsaXA6IDg5NDIsXG4gICAgdmVyYmFyOiAxMjQsXG4gICAgd2VkYmFyOiAxMDg0NyxcbiAgICB3ZWRnZXE6IDg3OTMsXG4gICAgd2VpZXJwOiA4NDcyLFxuICAgIHdyZWF0aDogODc2OCxcbiAgICB4b3BsdXM6IDEwNzUzLFxuICAgIHhvdGltZTogMTA3NTQsXG4gICAgeHNxY3VwOiAxMDc1OCxcbiAgICB4dXBsdXM6IDEwNzU2LFxuICAgIHh3ZWRnZTogODg5NixcbiAgICB5YWN1dGU6IDI1MyxcbiAgICB6YWN1dGU6IDM3OCxcbiAgICB6Y2Fyb246IDM4MixcbiAgICB6ZWV0cmY6IDg0ODgsXG4gICAgQUVsaWc6IDE5OCxcbiAgICBBY2lyYzogMTk0LFxuICAgIEFscGhhOiA5MTMsXG4gICAgQW1hY3I6IDI1NixcbiAgICBBb2dvbjogMjYwLFxuICAgIEFyaW5nOiAxOTcsXG4gICAgQnJldmU6IDcyOCxcbiAgICBDY2lyYzogMjY0LFxuICAgIENvbG9uOiA4NzU5LFxuICAgIENyb3NzOiAxMDc5OSxcbiAgICBEYXNodjogMTA5ODAsXG4gICAgRGVsdGE6IDkxNixcbiAgICBFY2lyYzogMjAyLFxuICAgIEVtYWNyOiAyNzQsXG4gICAgRW9nb246IDI4MCxcbiAgICBFcXVhbDogMTA4NjksXG4gICAgR2FtbWE6IDkxNSxcbiAgICBHY2lyYzogMjg0LFxuICAgIEhhY2VrOiA3MTEsXG4gICAgSGNpcmM6IDI5MixcbiAgICBJSmxpZzogMzA2LFxuICAgIEljaXJjOiAyMDYsXG4gICAgSW1hY3I6IDI5OCxcbiAgICBJb2dvbjogMzAyLFxuICAgIEl1a2N5OiAxMDMwLFxuICAgIEpjaXJjOiAzMDgsXG4gICAgSnVrY3k6IDEwMjgsXG4gICAgS2FwcGE6IDkyMixcbiAgICBPRWxpZzogMzM4LFxuICAgIE9jaXJjOiAyMTIsXG4gICAgT21hY3I6IDMzMixcbiAgICBPbWVnYTogOTM3LFxuICAgIFByaW1lOiA4MjQzLFxuICAgIFJCYXJyOiAxMDUxMixcbiAgICBTY2lyYzogMzQ4LFxuICAgIFNpZ21hOiA5MzEsXG4gICAgVEhPUk46IDIyMixcbiAgICBUUkFERTogODQ4MixcbiAgICBUU0hjeTogMTAzNSxcbiAgICBUaGV0YTogOTIwLFxuICAgIFRpbGRlOiA4NzY0LFxuICAgIFVicmN5OiAxMDM4LFxuICAgIFVjaXJjOiAyMTksXG4gICAgVW1hY3I6IDM2MixcbiAgICBVbmlvbjogODg5OSxcbiAgICBVb2dvbjogMzcwLFxuICAgIFVwVGVlOiA4ODY5LFxuICAgIFVyaW5nOiAzNjYsXG4gICAgVkRhc2g6IDg4NzUsXG4gICAgVmRhc2g6IDg4NzMsXG4gICAgV2NpcmM6IDM3MixcbiAgICBXZWRnZTogODg5NixcbiAgICBZY2lyYzogMzc0LFxuICAgIGFjaXJjOiAyMjYsXG4gICAgYWN1dGU6IDE4MCxcbiAgICBhZWxpZzogMjMwLFxuICAgIGFsZXBoOiA4NTAxLFxuICAgIGFscGhhOiA5NDUsXG4gICAgYW1hY3I6IDI1NyxcbiAgICBhbWFsZzogMTA4MTUsXG4gICAgYW5nbGU6IDg3MzYsXG4gICAgYW5ncnQ6IDg3MzUsXG4gICAgYW5nc3Q6IDg0OTEsXG4gICAgYW9nb246IDI2MSxcbiAgICBhcmluZzogMjI5LFxuICAgIGFzeW1wOiA4Nzc2LFxuICAgIGF3aW50OiAxMDc2OSxcbiAgICBiY29uZzogODc4MCxcbiAgICBiZHF1bzogODIyMixcbiAgICBiZXBzaTogMTAxNCxcbiAgICBibGFuazogOTI1MSxcbiAgICBibGsxMjogOTYxOCxcbiAgICBibGsxNDogOTYxNyxcbiAgICBibGszNDogOTYxOSxcbiAgICBibG9jazogOTYwOCxcbiAgICBib3hETDogOTU1OSxcbiAgICBib3hEUjogOTU1NixcbiAgICBib3hEbDogOTU1OCxcbiAgICBib3hEcjogOTU1NSxcbiAgICBib3hIRDogOTU3NCxcbiAgICBib3hIVTogOTU3NyxcbiAgICBib3hIZDogOTU3MixcbiAgICBib3hIdTogOTU3NSxcbiAgICBib3hVTDogOTU2NSxcbiAgICBib3hVUjogOTU2MixcbiAgICBib3hVbDogOTU2NCxcbiAgICBib3hVcjogOTU2MSxcbiAgICBib3hWSDogOTU4MCxcbiAgICBib3hWTDogOTU3MSxcbiAgICBib3hWUjogOTU2OCxcbiAgICBib3hWaDogOTU3OSxcbiAgICBib3hWbDogOTU3MCxcbiAgICBib3hWcjogOTU2NyxcbiAgICBib3hkTDogOTU1NyxcbiAgICBib3hkUjogOTU1NCxcbiAgICBib3hkbDogOTQ4OCxcbiAgICBib3hkcjogOTQ4NCxcbiAgICBib3hoRDogOTU3MyxcbiAgICBib3hoVTogOTU3NixcbiAgICBib3hoZDogOTUxNixcbiAgICBib3hodTogOTUyNCxcbiAgICBib3h1TDogOTU2MyxcbiAgICBib3h1UjogOTU2MCxcbiAgICBib3h1bDogOTQ5NixcbiAgICBib3h1cjogOTQ5MixcbiAgICBib3h2SDogOTU3OCxcbiAgICBib3h2TDogOTU2OSxcbiAgICBib3h2UjogOTU2NixcbiAgICBib3h2aDogOTUzMixcbiAgICBib3h2bDogOTUwOCxcbiAgICBib3h2cjogOTUwMCxcbiAgICBicmV2ZTogNzI4LFxuICAgIGJzZW1pOiA4MjcxLFxuICAgIGJzaW1lOiA4OTA5LFxuICAgIGJzb2xiOiAxMDY5MyxcbiAgICBidW1wRTogMTA5MjYsXG4gICAgYnVtcGU6IDg3ODMsXG4gICAgY2FyZXQ6IDgyNTcsXG4gICAgY2Fyb246IDcxMSxcbiAgICBjY2FwczogMTA4MjksXG4gICAgY2NpcmM6IDI2NSxcbiAgICBjY3VwczogMTA4MjgsXG4gICAgY2VkaWw6IDE4NCxcbiAgICBjaGVjazogMTAwMDMsXG4gICAgY2x1YnM6IDk4MjcsXG4gICAgY29sb246IDU4LFxuICAgIGNvbW1hOiA0NCxcbiAgICBjcmFycjogODYyOSxcbiAgICBjcm9zczogMTAwMDcsXG4gICAgY3N1YmU6IDEwOTYxLFxuICAgIGNzdXBlOiAxMDk2MixcbiAgICBjdGRvdDogODk0MyxcbiAgICBjdWVwcjogODkyNixcbiAgICBjdWVzYzogODkyNyxcbiAgICBjdXBvcjogMTA4MjEsXG4gICAgY3V2ZWU6IDg5MTAsXG4gICAgY3V3ZWQ6IDg5MTEsXG4gICAgY3dpbnQ6IDg3NTMsXG4gICAgZGFzaHY6IDg4NjcsXG4gICAgZGJsYWM6IDczMyxcbiAgICBkZGFycjogODY1MCxcbiAgICBkZWx0YTogOTQ4LFxuICAgIGRoYXJsOiA4NjQzLFxuICAgIGRoYXJyOiA4NjQyLFxuICAgIGRpYW1zOiA5ODMwLFxuICAgIGRpc2luOiA4OTQ2LFxuICAgIGRvdGVxOiA4Nzg0LFxuICAgIGR0ZG90OiA4OTQ1LFxuICAgIGR0cmlmOiA5NjYyLFxuICAgIGR1YXJyOiA4NjkzLFxuICAgIGR1aGFyOiAxMDYwNyxcbiAgICBlRERvdDogMTA4NzEsXG4gICAgZWNpcmM6IDIzNCxcbiAgICBlZkRvdDogODc4NixcbiAgICBlbWFjcjogMjc1LFxuICAgIGVtcHR5OiA4NzA5LFxuICAgIGVvZ29uOiAyODEsXG4gICAgZXBsdXM6IDEwODY1LFxuICAgIGVwc2l2OiA5NDksXG4gICAgZXFzaW06IDg3NzAsXG4gICAgZXF1aXY6IDg4MDEsXG4gICAgZXJEb3Q6IDg3ODcsXG4gICAgZXJhcnI6IDEwNjA5LFxuICAgIGVzZG90OiA4Nzg0LFxuICAgIGV4aXN0OiA4NzA3LFxuICAgIGZmbGlnOiA2NDI1NixcbiAgICBmaWxpZzogNjQyNTcsXG4gICAgZmxsaWc6IDY0MjU4LFxuICAgIGZsdG5zOiA5NjQ5LFxuICAgIGZvcmt2OiAxMDk2OSxcbiAgICBmcmFzbDogODI2MCxcbiAgICBmcm93bjogODk5NCxcbiAgICBnYW1tYTogOTQ3LFxuICAgIGdjaXJjOiAyODUsXG4gICAgZ2VzY2M6IDEwOTIxLFxuICAgIGdpbWVsOiA4NTAzLFxuICAgIGduZXFxOiA4ODA5LFxuICAgIGduc2ltOiA4OTM1LFxuICAgIGdyYXZlOiA5NixcbiAgICBnc2ltZTogMTA4OTQsXG4gICAgZ3NpbWw6IDEwODk2LFxuICAgIGd0Y2lyOiAxMDg3NCxcbiAgICBndGRvdDogODkxOSxcbiAgICBoYXJydzogODYyMSxcbiAgICBoY2lyYzogMjkzLFxuICAgIGhvYXJyOiA4NzAzLFxuICAgIGljaXJjOiAyMzgsXG4gICAgaWV4Y2w6IDE2MSxcbiAgICBpaWludDogODc0OSxcbiAgICBpaW90YTogODQ4OSxcbiAgICBpamxpZzogMzA3LFxuICAgIGltYWNyOiAyOTksXG4gICAgaW1hZ2U6IDg0NjUsXG4gICAgaW1hdGg6IDMwNSxcbiAgICBpbXBlZDogNDM3LFxuICAgIGluZmluOiA4NzM0LFxuICAgIGlvZ29uOiAzMDMsXG4gICAgaXByb2Q6IDEwODEyLFxuICAgIGlzaW5FOiA4OTUzLFxuICAgIGlzaW5zOiA4OTQ4LFxuICAgIGlzaW52OiA4NzEyLFxuICAgIGl1a2N5OiAxMTEwLFxuICAgIGpjaXJjOiAzMDksXG4gICAgam1hdGg6IDU2NyxcbiAgICBqdWtjeTogMTEwOCxcbiAgICBrYXBwYTogOTU0LFxuICAgIGxBYXJyOiA4NjY2LFxuICAgIGxCYXJyOiAxMDUxMCxcbiAgICBsYW5nZDogMTA2NDEsXG4gICAgbGFxdW86IDE3MSxcbiAgICBsYXJyYjogODY3NixcbiAgICBsYmFycjogMTA1MDgsXG4gICAgbGJicms6IDEwMDk4LFxuICAgIGxicmtlOiAxMDYzNSxcbiAgICBsY2VpbDogODk2OCxcbiAgICBsZHF1bzogODIyMCxcbiAgICBsZXNjYzogMTA5MjAsXG4gICAgbGhhcmQ6IDg2MzcsXG4gICAgbGhhcnU6IDg2MzYsXG4gICAgbGhibGs6IDk2MDQsXG4gICAgbGxhcnI6IDg2NDcsXG4gICAgbGx0cmk6IDk3MjIsXG4gICAgbG5lcXE6IDg4MDgsXG4gICAgbG5zaW06IDg5MzQsXG4gICAgbG9hbmc6IDEwMjIwLFxuICAgIGxvYXJyOiA4NzAxLFxuICAgIGxvYnJrOiAxMDIxNCxcbiAgICBsb3BhcjogMTA2MjksXG4gICAgbHJhcnI6IDg2NDYsXG4gICAgbHJoYXI6IDg2NTEsXG4gICAgbHJ0cmk6IDg4OTUsXG4gICAgbHNpbWU6IDEwODkzLFxuICAgIGxzaW1nOiAxMDg5NSxcbiAgICBsc3F1bzogODIxNixcbiAgICBsdGNpcjogMTA4NzMsXG4gICAgbHRkb3Q6IDg5MTgsXG4gICAgbHRyaWU6IDg4ODQsXG4gICAgbHRyaWY6IDk2NjYsXG4gICAgbUREb3Q6IDg3NjIsXG4gICAgbWRhc2g6IDgyMTIsXG4gICAgbWljcm86IDE4MSxcbiAgICBtaW51czogODcyMixcbiAgICBtdW1hcDogODg4OCxcbiAgICBuYWJsYTogODcxMSxcbiAgICBuYXBvczogMzI5LFxuICAgIG5hdHVyOiA5ODM4LFxuICAgIG5jb25nOiA4Nzc1LFxuICAgIG5kYXNoOiA4MjExLFxuICAgIG5lQXJyOiA4NjYzLFxuICAgIG5lYXJyOiA4NTk5LFxuICAgIG5nc2ltOiA4ODIxLFxuICAgIG5oQXJyOiA4NjU0LFxuICAgIG5oYXJyOiA4NjIyLFxuICAgIG5ocGFyOiAxMDk5NCxcbiAgICBubEFycjogODY1MyxcbiAgICBubGFycjogODYwMixcbiAgICBubGVzczogODgxNCxcbiAgICBubHNpbTogODgyMCxcbiAgICBubHRyaTogODkzOCxcbiAgICBub3RpbjogODcxMyxcbiAgICBub3RuaTogODcxNixcbiAgICBucHJlYzogODgzMixcbiAgICBuckFycjogODY1NSxcbiAgICBucmFycjogODYwMyxcbiAgICBucnRyaTogODkzOSxcbiAgICBuc2ltZTogODc3MixcbiAgICBuc21pZDogODc0MCxcbiAgICBuc3BhcjogODc0MixcbiAgICBuc3ViZTogODg0MCxcbiAgICBuc3VjYzogODgzMyxcbiAgICBuc3VwZTogODg0MSxcbiAgICBudW1zcDogODE5OSxcbiAgICBud0FycjogODY2MixcbiAgICBud2FycjogODU5OCxcbiAgICBvY2lyYzogMjQ0LFxuICAgIG9kYXNoOiA4ODYxLFxuICAgIG9lbGlnOiAzMzksXG4gICAgb2ZjaXI6IDEwNjg3LFxuICAgIG9oYmFyOiAxMDY3NyxcbiAgICBvbGFycjogODYzNCxcbiAgICBvbGNpcjogMTA2ODYsXG4gICAgb2xpbmU6IDgyNTQsXG4gICAgb21hY3I6IDMzMyxcbiAgICBvbWVnYTogOTY5LFxuICAgIG9wZXJwOiAxMDY4MSxcbiAgICBvcGx1czogODg1MyxcbiAgICBvcmFycjogODYzNSxcbiAgICBvcmRlcjogODUwMCxcbiAgICBvdmJhcjogOTAyMSxcbiAgICBwYXJzbDogMTEwMDUsXG4gICAgcGhvbmU6IDk3NDIsXG4gICAgcGx1c2I6IDg4NjIsXG4gICAgcGx1c2U6IDEwODY2LFxuICAgIHBvdW5kOiAxNjMsXG4gICAgcHJjdWU6IDg4MjgsXG4gICAgcHJpbWU6IDgyNDIsXG4gICAgcHJuYXA6IDEwOTM3LFxuICAgIHByc2ltOiA4ODMwLFxuICAgIHF1ZXN0OiA2MyxcbiAgICByQWFycjogODY2NyxcbiAgICByQmFycjogMTA1MTEsXG4gICAgcmFkaWM6IDg3MzAsXG4gICAgcmFuZ2Q6IDEwNjQyLFxuICAgIHJhbmdlOiAxMDY2MSxcbiAgICByYXF1bzogMTg3LFxuICAgIHJhcnJiOiA4Njc3LFxuICAgIHJhcnJjOiAxMDU0NyxcbiAgICByYXJydzogODYwNSxcbiAgICByYXRpbzogODc1OCxcbiAgICByYmFycjogMTA1MDksXG4gICAgcmJicms6IDEwMDk5LFxuICAgIHJicmtlOiAxMDYzNixcbiAgICByY2VpbDogODk2OSxcbiAgICByZHF1bzogODIyMSxcbiAgICByZWFsczogODQ3NyxcbiAgICByaGFyZDogODY0MSxcbiAgICByaGFydTogODY0MCxcbiAgICBybGFycjogODY0NCxcbiAgICBybGhhcjogODY1MixcbiAgICBybm1pZDogMTA5OTAsXG4gICAgcm9hbmc6IDEwMjIxLFxuICAgIHJvYXJyOiA4NzAyLFxuICAgIHJvYnJrOiAxMDIxNSxcbiAgICByb3BhcjogMTA2MzAsXG4gICAgcnJhcnI6IDg2NDksXG4gICAgcnNxdW86IDgyMTcsXG4gICAgcnRyaWU6IDg4ODUsXG4gICAgcnRyaWY6IDk2NTYsXG4gICAgc2JxdW86IDgyMTgsXG4gICAgc2NjdWU6IDg4MjksXG4gICAgc2NpcmM6IDM0OSxcbiAgICBzY25hcDogMTA5MzgsXG4gICAgc2NzaW06IDg4MzEsXG4gICAgc2RvdGI6IDg4NjUsXG4gICAgc2RvdGU6IDEwODU0LFxuICAgIHNlQXJyOiA4NjY0LFxuICAgIHNlYXJyOiA4NjAwLFxuICAgIHNldG1uOiA4NzI2LFxuICAgIHNoYXJwOiA5ODM5LFxuICAgIHNpZ21hOiA5NjMsXG4gICAgc2ltZXE6IDg3NzEsXG4gICAgc2ltZ0U6IDEwOTEyLFxuICAgIHNpbWxFOiAxMDkxMSxcbiAgICBzaW1uZTogODc3NCxcbiAgICBzbGFycjogODU5MixcbiAgICBzbWlsZTogODk5NSxcbiAgICBzcWNhcDogODg1MSxcbiAgICBzcWN1cDogODg1MixcbiAgICBzcXN1YjogODg0NyxcbiAgICBzcXN1cDogODg0OCxcbiAgICBzcmFycjogODU5NCxcbiAgICBzdGFyZjogOTczMyxcbiAgICBzdHJuczogMTc1LFxuICAgIHN1Ym5FOiAxMDk1NSxcbiAgICBzdWJuZTogODg0MixcbiAgICBzdXBuRTogMTA5NTYsXG4gICAgc3VwbmU6IDg4NDMsXG4gICAgc3dBcnI6IDg2NjUsXG4gICAgc3dhcnI6IDg2MDEsXG4gICAgc3psaWc6IDIyMyxcbiAgICB0aGV0YTogOTUyLFxuICAgIHRoa2FwOiA4Nzc2LFxuICAgIHRob3JuOiAyNTQsXG4gICAgdGlsZGU6IDczMixcbiAgICB0aW1lczogMjE1LFxuICAgIHRyYWRlOiA4NDgyLFxuICAgIHRyaXNiOiAxMDcwMSxcbiAgICB0c2hjeTogMTExNSxcbiAgICB0d2l4dDogODgxMixcbiAgICB1YnJjeTogMTExOCxcbiAgICB1Y2lyYzogMjUxLFxuICAgIHVkYXJyOiA4NjQ1LFxuICAgIHVkaGFyOiAxMDYwNixcbiAgICB1aGFybDogODYzOSxcbiAgICB1aGFycjogODYzOCxcbiAgICB1aGJsazogOTYwMCxcbiAgICB1bHRyaTogOTcyMCxcbiAgICB1bWFjcjogMzYzLFxuICAgIHVvZ29uOiAzNzEsXG4gICAgdXBsdXM6IDg4NDYsXG4gICAgdXBzaWg6IDk3OCxcbiAgICB1cmluZzogMzY3LFxuICAgIHVydHJpOiA5NzIxLFxuICAgIHV0ZG90OiA4OTQ0LFxuICAgIHV0cmlmOiA5NjUyLFxuICAgIHV1YXJyOiA4NjQ4LFxuICAgIHZCYXJ2OiAxMDk4NSxcbiAgICB2RGFzaDogODg3MixcbiAgICB2YXJwaTogOTgyLFxuICAgIHZkYXNoOiA4ODY2LFxuICAgIHZlZWVxOiA4Nzk0LFxuICAgIHZsdHJpOiA4ODgyLFxuICAgIHZwcm9wOiA4NzMzLFxuICAgIHZydHJpOiA4ODgzLFxuICAgIHdjaXJjOiAzNzMsXG4gICAgd2VkZ2U6IDg3NDMsXG4gICAgeGNpcmM6IDk3MTEsXG4gICAgeGR0cmk6IDk2NjEsXG4gICAgeGhBcnI6IDEwMjM0LFxuICAgIHhoYXJyOiAxMDIzMSxcbiAgICB4bEFycjogMTAyMzIsXG4gICAgeGxhcnI6IDEwMjI5LFxuICAgIHhvZG90OiAxMDc1MixcbiAgICB4ckFycjogMTAyMzMsXG4gICAgeHJhcnI6IDEwMjMwLFxuICAgIHh1dHJpOiA5NjUxLFxuICAgIHljaXJjOiAzNzUsXG4gICAgQW9wZjogMTIwMTIwLFxuICAgIEFzY3I6IDExOTk2NCxcbiAgICBBdW1sOiAxOTYsXG4gICAgQmFydjogMTA5ODMsXG4gICAgQmV0YTogOTE0LFxuICAgIEJvcGY6IDEyMDEyMSxcbiAgICBCc2NyOiA4NDkyLFxuICAgIENIY3k6IDEwNjMsXG4gICAgQ09QWTogMTY5LFxuICAgIENkb3Q6IDI2NixcbiAgICBDb3BmOiA4NDUwLFxuICAgIENzY3I6IDExOTk2NixcbiAgICBESmN5OiAxMDI2LFxuICAgIERTY3k6IDEwMjksXG4gICAgRFpjeTogMTAzOSxcbiAgICBEYXJyOiA4NjA5LFxuICAgIERvcGY6IDEyMDEyMyxcbiAgICBEc2NyOiAxMTk5NjcsXG4gICAgRWRvdDogMjc4LFxuICAgIEVvcGY6IDEyMDEyNCxcbiAgICBFc2NyOiA4NDk2LFxuICAgIEVzaW06IDEwODY3LFxuICAgIEV1bWw6IDIwMyxcbiAgICBGb3BmOiAxMjAxMjUsXG4gICAgRnNjcjogODQ5NyxcbiAgICBHSmN5OiAxMDI3LFxuICAgIEdkb3Q6IDI4OCxcbiAgICBHb3BmOiAxMjAxMjYsXG4gICAgR3NjcjogMTE5OTcwLFxuICAgIEhvcGY6IDg0NjEsXG4gICAgSHNjcjogODQ1OSxcbiAgICBJRWN5OiAxMDQ1LFxuICAgIElPY3k6IDEwMjUsXG4gICAgSWRvdDogMzA0LFxuICAgIElvcGY6IDEyMDEyOCxcbiAgICBJb3RhOiA5MjEsXG4gICAgSXNjcjogODQ2NCxcbiAgICBJdW1sOiAyMDcsXG4gICAgSm9wZjogMTIwMTI5LFxuICAgIEpzY3I6IDExOTk3MyxcbiAgICBLSGN5OiAxMDYxLFxuICAgIEtKY3k6IDEwMzYsXG4gICAgS29wZjogMTIwMTMwLFxuICAgIEtzY3I6IDExOTk3NCxcbiAgICBMSmN5OiAxMDMzLFxuICAgIExhbmc6IDEwMjE4LFxuICAgIExhcnI6IDg2MDYsXG4gICAgTG9wZjogMTIwMTMxLFxuICAgIExzY3I6IDg0NjYsXG4gICAgTW9wZjogMTIwMTMyLFxuICAgIE1zY3I6IDg0OTksXG4gICAgTkpjeTogMTAzNCxcbiAgICBOb3BmOiA4NDY5LFxuICAgIE5zY3I6IDExOTk3NyxcbiAgICBPb3BmOiAxMjAxMzQsXG4gICAgT3NjcjogMTE5OTc4LFxuICAgIE91bWw6IDIxNCxcbiAgICBQb3BmOiA4NDczLFxuICAgIFBzY3I6IDExOTk3OSxcbiAgICBRVU9UOiAzNCxcbiAgICBRb3BmOiA4NDc0LFxuICAgIFFzY3I6IDExOTk4MCxcbiAgICBSYW5nOiAxMDIxOSxcbiAgICBSYXJyOiA4NjA4LFxuICAgIFJvcGY6IDg0NzcsXG4gICAgUnNjcjogODQ3NSxcbiAgICBTSGN5OiAxMDY0LFxuICAgIFNvcGY6IDEyMDEzOCxcbiAgICBTcXJ0OiA4NzMwLFxuICAgIFNzY3I6IDExOTk4MixcbiAgICBTdGFyOiA4OTAyLFxuICAgIFRTY3k6IDEwNjIsXG4gICAgVG9wZjogMTIwMTM5LFxuICAgIFRzY3I6IDExOTk4MyxcbiAgICBVYXJyOiA4NjA3LFxuICAgIFVvcGY6IDEyMDE0MCxcbiAgICBVcHNpOiA5NzgsXG4gICAgVXNjcjogMTE5OTg0LFxuICAgIFV1bWw6IDIyMCxcbiAgICBWYmFyOiAxMDk4NyxcbiAgICBWZXJ0OiA4MjE0LFxuICAgIFZvcGY6IDEyMDE0MSxcbiAgICBWc2NyOiAxMTk5ODUsXG4gICAgV29wZjogMTIwMTQyLFxuICAgIFdzY3I6IDExOTk4NixcbiAgICBYb3BmOiAxMjAxNDMsXG4gICAgWHNjcjogMTE5OTg3LFxuICAgIFlBY3k6IDEwNzEsXG4gICAgWUljeTogMTAzMSxcbiAgICBZVWN5OiAxMDcwLFxuICAgIFlvcGY6IDEyMDE0NCxcbiAgICBZc2NyOiAxMTk5ODgsXG4gICAgWXVtbDogMzc2LFxuICAgIFpIY3k6IDEwNDYsXG4gICAgWmRvdDogMzc5LFxuICAgIFpldGE6IDkxOCxcbiAgICBab3BmOiA4NDg0LFxuICAgIFpzY3I6IDExOTk4OSxcbiAgICBhbmRkOiAxMDg0NCxcbiAgICBhbmR2OiAxMDg0MixcbiAgICBhbmdlOiAxMDY2MCxcbiAgICBhb3BmOiAxMjAxNDYsXG4gICAgYXBpZDogODc3OSxcbiAgICBhcG9zOiAzOSxcbiAgICBhc2NyOiAxMTk5OTAsXG4gICAgYXVtbDogMjI4LFxuICAgIGJOb3Q6IDEwOTg5LFxuICAgIGJicms6IDkxNDEsXG4gICAgYmV0YTogOTQ2LFxuICAgIGJldGg6IDg1MDIsXG4gICAgYm5vdDogODk3NixcbiAgICBib3BmOiAxMjAxNDcsXG4gICAgYm94SDogOTU1MixcbiAgICBib3hWOiA5NTUzLFxuICAgIGJveGg6IDk0NzIsXG4gICAgYm94djogOTQ3NCxcbiAgICBic2NyOiAxMTk5OTEsXG4gICAgYnNpbTogODc2NSxcbiAgICBic29sOiA5MixcbiAgICBidWxsOiA4MjI2LFxuICAgIGJ1bXA6IDg3ODIsXG4gICAgY2RvdDogMjY3LFxuICAgIGNlbnQ6IDE2MixcbiAgICBjaGN5OiAxMDk1LFxuICAgIGNpckU6IDEwNjkxLFxuICAgIGNpcmM6IDcxMCxcbiAgICBjaXJlOiA4NzkxLFxuICAgIGNvbXA6IDg3MDUsXG4gICAgY29uZzogODc3MyxcbiAgICBjb3BmOiAxMjAxNDgsXG4gICAgY29weTogMTY5LFxuICAgIGNzY3I6IDExOTk5MixcbiAgICBjc3ViOiAxMDk1OSxcbiAgICBjc3VwOiAxMDk2MCxcbiAgICBkQXJyOiA4NjU5LFxuICAgIGRIYXI6IDEwNTk3LFxuICAgIGRhcnI6IDg1OTUsXG4gICAgZGFzaDogODIwOCxcbiAgICBkaWFtOiA4OTAwLFxuICAgIGRqY3k6IDExMDYsXG4gICAgZG9wZjogMTIwMTQ5LFxuICAgIGRzY3I6IDExOTk5MyxcbiAgICBkc2N5OiAxMTA5LFxuICAgIGRzb2w6IDEwNzQyLFxuICAgIGR0cmk6IDk2NjMsXG4gICAgZHpjeTogMTExOSxcbiAgICBlRG90OiA4Nzg1LFxuICAgIGVjaXI6IDg3OTAsXG4gICAgZWRvdDogMjc5LFxuICAgIGVtc3A6IDgxOTUsXG4gICAgZW5zcDogODE5NCxcbiAgICBlb3BmOiAxMjAxNTAsXG4gICAgZXBhcjogODkxNyxcbiAgICBlcHNpOiAxMDEzLFxuICAgIGVzY3I6IDg0OTUsXG4gICAgZXNpbTogODc3MCxcbiAgICBldW1sOiAyMzUsXG4gICAgZXVybzogODM2NCxcbiAgICBleGNsOiAzMyxcbiAgICBmbGF0OiA5ODM3LFxuICAgIGZub2Y6IDQwMixcbiAgICBmb3BmOiAxMjAxNTEsXG4gICAgZm9yazogODkxNixcbiAgICBmc2NyOiAxMTk5OTUsXG4gICAgZ2RvdDogMjg5LFxuICAgIGdlcXE6IDg4MDcsXG4gICAgZ2pjeTogMTEwNyxcbiAgICBnbmFwOiAxMDg5MCxcbiAgICBnbmVxOiAxMDg4OCxcbiAgICBnb3BmOiAxMjAxNTIsXG4gICAgZ3NjcjogODQ1OCxcbiAgICBnc2ltOiA4ODE5LFxuICAgIGd0Y2M6IDEwOTE5LFxuICAgIGhBcnI6IDg2NjAsXG4gICAgaGFsZjogMTg5LFxuICAgIGhhcnI6IDg1OTYsXG4gICAgaGJhcjogODQ2MyxcbiAgICBob3BmOiAxMjAxNTMsXG4gICAgaHNjcjogMTE5OTk3LFxuICAgIGllY3k6IDEwNzcsXG4gICAgaW1vZjogODg4NyxcbiAgICBpb2N5OiAxMTA1LFxuICAgIGlvcGY6IDEyMDE1NCxcbiAgICBpb3RhOiA5NTMsXG4gICAgaXNjcjogMTE5OTk4LFxuICAgIGlzaW46IDg3MTIsXG4gICAgaXVtbDogMjM5LFxuICAgIGpvcGY6IDEyMDE1NSxcbiAgICBqc2NyOiAxMTk5OTksXG4gICAga2hjeTogMTA5MyxcbiAgICBramN5OiAxMTE2LFxuICAgIGtvcGY6IDEyMDE1NixcbiAgICBrc2NyOiAxMjAwMDAsXG4gICAgbEFycjogODY1NixcbiAgICBsSGFyOiAxMDU5NCxcbiAgICBsYW5nOiAxMDIxNixcbiAgICBsYXJyOiA4NTkyLFxuICAgIGxhdGU6IDEwOTI1LFxuICAgIGxjdWI6IDEyMyxcbiAgICBsZGNhOiAxMDU1MCxcbiAgICBsZHNoOiA4NjI2LFxuICAgIGxlcXE6IDg4MDYsXG4gICAgbGpjeTogMTExMyxcbiAgICBsbmFwOiAxMDg4OSxcbiAgICBsbmVxOiAxMDg4NyxcbiAgICBsb3BmOiAxMjAxNTcsXG4gICAgbG96ZjogMTA3MzEsXG4gICAgbHBhcjogNDAsXG4gICAgbHNjcjogMTIwMDAxLFxuICAgIGxzaW06IDg4MTgsXG4gICAgbHNxYjogOTEsXG4gICAgbHRjYzogMTA5MTgsXG4gICAgbHRyaTogOTY2NyxcbiAgICBtYWNyOiAxNzUsXG4gICAgbWFsZTogOTc5NCxcbiAgICBtYWx0OiAxMDAxNixcbiAgICBtbGNwOiAxMDk3MSxcbiAgICBtbGRyOiA4MjMwLFxuICAgIG1vcGY6IDEyMDE1OCxcbiAgICBtc2NyOiAxMjAwMDIsXG4gICAgbmJzcDogMTYwLFxuICAgIG5jYXA6IDEwODE5LFxuICAgIG5jdXA6IDEwODE4LFxuICAgIG5nZXE6IDg4MTcsXG4gICAgbmd0cjogODgxNSxcbiAgICBuaXNkOiA4OTU0LFxuICAgIG5qY3k6IDExMTQsXG4gICAgbmxkcjogODIyOSxcbiAgICBubGVxOiA4ODE2LFxuICAgIG5taWQ6IDg3NDAsXG4gICAgbm9wZjogMTIwMTU5LFxuICAgIG5wYXI6IDg3NDIsXG4gICAgbnNjcjogMTIwMDAzLFxuICAgIG5zaW06IDg3NjksXG4gICAgbnN1YjogODgzNixcbiAgICBuc3VwOiA4ODM3LFxuICAgIG50Z2w6IDg4MjUsXG4gICAgbnRsZzogODgyNCxcbiAgICBvYXN0OiA4ODU5LFxuICAgIG9jaXI6IDg4NTgsXG4gICAgb2RpdjogMTA4MDgsXG4gICAgb2RvdDogODg1NyxcbiAgICBvZ29uOiA3MzEsXG4gICAgb2ludDogODc1MCxcbiAgICBvbWlkOiAxMDY3OCxcbiAgICBvb3BmOiAxMjAxNjAsXG4gICAgb3BhcjogMTA2NzksXG4gICAgb3JkZjogMTcwLFxuICAgIG9yZG06IDE4NixcbiAgICBvcm9yOiAxMDgzOCxcbiAgICBvc2NyOiA4NTAwLFxuICAgIG9zb2w6IDg4NTYsXG4gICAgb3VtbDogMjQ2LFxuICAgIHBhcmE6IDE4MixcbiAgICBwYXJ0OiA4NzA2LFxuICAgIHBlcnA6IDg4NjksXG4gICAgcGhpdjogOTY2LFxuICAgIHBsdXM6IDQzLFxuICAgIHBvcGY6IDEyMDE2MSxcbiAgICBwcmFwOiAxMDkzNSxcbiAgICBwcmVjOiA4ODI2LFxuICAgIHBybkU6IDEwOTMzLFxuICAgIHByb2Q6IDg3MTksXG4gICAgcHJvcDogODczMyxcbiAgICBwc2NyOiAxMjAwMDUsXG4gICAgcWludDogMTA3NjQsXG4gICAgcW9wZjogMTIwMTYyLFxuICAgIHFzY3I6IDEyMDAwNixcbiAgICBxdW90OiAzNCxcbiAgICByQXJyOiA4NjU4LFxuICAgIHJIYXI6IDEwNTk2LFxuICAgIHJhY2U6IDEwNzE0LFxuICAgIHJhbmc6IDEwMjE3LFxuICAgIHJhcnI6IDg1OTQsXG4gICAgcmN1YjogMTI1LFxuICAgIHJkY2E6IDEwNTUxLFxuICAgIHJkc2g6IDg2MjcsXG4gICAgcmVhbDogODQ3NixcbiAgICByZWN0OiA5NjQ1LFxuICAgIHJob3Y6IDEwMDksXG4gICAgcmluZzogNzMwLFxuICAgIHJvcGY6IDEyMDE2MyxcbiAgICBycGFyOiA0MSxcbiAgICByc2NyOiAxMjAwMDcsXG4gICAgcnNxYjogOTMsXG4gICAgcnRyaTogOTY1NyxcbiAgICBzY2FwOiAxMDkzNixcbiAgICBzY25FOiAxMDkzNCxcbiAgICBzZG90OiA4OTAxLFxuICAgIHNlY3Q6IDE2NyxcbiAgICBzZW1pOiA1OSxcbiAgICBzZXh0OiAxMDAzOCxcbiAgICBzaGN5OiAxMDk2LFxuICAgIHNpbWU6IDg3NzEsXG4gICAgc2ltZzogMTA5MTAsXG4gICAgc2ltbDogMTA5MDksXG4gICAgc21pZDogODczOSxcbiAgICBzbXRlOiAxMDkyNCxcbiAgICBzb2xiOiAxMDY5MixcbiAgICBzb3BmOiAxMjAxNjQsXG4gICAgc3BhcjogODc0MSxcbiAgICBzcXVmOiA5NjQyLFxuICAgIHNzY3I6IDEyMDAwOCxcbiAgICBzdGFyOiA5NzM0LFxuICAgIHN1YkU6IDEwOTQ5LFxuICAgIHN1YmU6IDg4MzgsXG4gICAgc3VjYzogODgyNyxcbiAgICBzdW5nOiA5ODM0LFxuICAgIHN1cDE6IDE4NSxcbiAgICBzdXAyOiAxNzgsXG4gICAgc3VwMzogMTc5LFxuICAgIHN1cEU6IDEwOTUwLFxuICAgIHN1cGU6IDg4MzksXG4gICAgdGJyazogOTE0MCxcbiAgICB0ZG90OiA4NDExLFxuICAgIHRpbnQ6IDg3NDksXG4gICAgdG9lYTogMTA1MzYsXG4gICAgdG9wZjogMTIwMTY1LFxuICAgIHRvc2E6IDEwNTM3LFxuICAgIHRyaWU6IDg3OTYsXG4gICAgdHNjcjogMTIwMDA5LFxuICAgIHRzY3k6IDEwOTQsXG4gICAgdUFycjogODY1NyxcbiAgICB1SGFyOiAxMDU5NSxcbiAgICB1YXJyOiA4NTkzLFxuICAgIHVvcGY6IDEyMDE2NixcbiAgICB1cHNpOiA5NjUsXG4gICAgdXNjcjogMTIwMDEwLFxuICAgIHV0cmk6IDk2NTMsXG4gICAgdXVtbDogMjUyLFxuICAgIHZBcnI6IDg2NjEsXG4gICAgdkJhcjogMTA5ODQsXG4gICAgdmFycjogODU5NyxcbiAgICB2ZXJ0OiAxMjQsXG4gICAgdm9wZjogMTIwMTY3LFxuICAgIHZzY3I6IDEyMDAxMSxcbiAgICB3b3BmOiAxMjAxNjgsXG4gICAgd3NjcjogMTIwMDEyLFxuICAgIHhjYXA6IDg4OTgsXG4gICAgeGN1cDogODg5OSxcbiAgICB4bWFwOiAxMDIzNixcbiAgICB4bmlzOiA4OTU1LFxuICAgIHhvcGY6IDEyMDE2OSxcbiAgICB4c2NyOiAxMjAwMTMsXG4gICAgeHZlZTogODg5NyxcbiAgICB5YWN5OiAxMTAzLFxuICAgIHlpY3k6IDExMTEsXG4gICAgeW9wZjogMTIwMTcwLFxuICAgIHlzY3I6IDEyMDAxNCxcbiAgICB5dWN5OiAxMTAyLFxuICAgIHl1bWw6IDI1NSxcbiAgICB6ZG90OiAzODAsXG4gICAgemV0YTogOTUwLFxuICAgIHpoY3k6IDEwNzgsXG4gICAgem9wZjogMTIwMTcxLFxuICAgIHpzY3I6IDEyMDAxNSxcbiAgICB6d25qOiA4MjA0LFxuICAgIEFNUDogMzgsXG4gICAgQWN5OiAxMDQwLFxuICAgIEFmcjogMTIwMDY4LFxuICAgIEFuZDogMTA4MzUsXG4gICAgQmN5OiAxMDQxLFxuICAgIEJmcjogMTIwMDY5LFxuICAgIENhcDogODkxNCxcbiAgICBDZnI6IDg0OTMsXG4gICAgQ2hpOiA5MzUsXG4gICAgQ3VwOiA4OTE1LFxuICAgIERjeTogMTA0NCxcbiAgICBEZWw6IDg3MTEsXG4gICAgRGZyOiAxMjAwNzEsXG4gICAgRG90OiAxNjgsXG4gICAgRU5HOiAzMzAsXG4gICAgRVRIOiAyMDgsXG4gICAgRWN5OiAxMDY5LFxuICAgIEVmcjogMTIwMDcyLFxuICAgIEV0YTogOTE5LFxuICAgIEZjeTogMTA2MCxcbiAgICBGZnI6IDEyMDA3MyxcbiAgICBHY3k6IDEwNDMsXG4gICAgR2ZyOiAxMjAwNzQsXG4gICAgSGF0OiA5NCxcbiAgICBIZnI6IDg0NjAsXG4gICAgSWN5OiAxMDQ4LFxuICAgIElmcjogODQ2NSxcbiAgICBJbnQ6IDg3NDgsXG4gICAgSmN5OiAxMDQ5LFxuICAgIEpmcjogMTIwMDc3LFxuICAgIEtjeTogMTA1MCxcbiAgICBLZnI6IDEyMDA3OCxcbiAgICBMY3k6IDEwNTEsXG4gICAgTGZyOiAxMjAwNzksXG4gICAgTHNoOiA4NjI0LFxuICAgIE1hcDogMTA1MDEsXG4gICAgTWN5OiAxMDUyLFxuICAgIE1mcjogMTIwMDgwLFxuICAgIE5jeTogMTA1MyxcbiAgICBOZnI6IDEyMDA4MSxcbiAgICBOb3Q6IDEwOTg4LFxuICAgIE9jeTogMTA1NCxcbiAgICBPZnI6IDEyMDA4MixcbiAgICBQY3k6IDEwNTUsXG4gICAgUGZyOiAxMjAwODMsXG4gICAgUGhpOiA5MzQsXG4gICAgUHNpOiA5MzYsXG4gICAgUWZyOiAxMjAwODQsXG4gICAgUkVHOiAxNzQsXG4gICAgUmN5OiAxMDU2LFxuICAgIFJmcjogODQ3NixcbiAgICBSaG86IDkyOSxcbiAgICBSc2g6IDg2MjUsXG4gICAgU2N5OiAxMDU3LFxuICAgIFNmcjogMTIwMDg2LFxuICAgIFN1YjogODkxMixcbiAgICBTdW06IDg3MjEsXG4gICAgU3VwOiA4OTEzLFxuICAgIFRhYjogOSxcbiAgICBUYXU6IDkzMixcbiAgICBUY3k6IDEwNTgsXG4gICAgVGZyOiAxMjAwODcsXG4gICAgVWN5OiAxMDU5LFxuICAgIFVmcjogMTIwMDg4LFxuICAgIFZjeTogMTA0MixcbiAgICBWZWU6IDg4OTcsXG4gICAgVmZyOiAxMjAwODksXG4gICAgV2ZyOiAxMjAwOTAsXG4gICAgWGZyOiAxMjAwOTEsXG4gICAgWWN5OiAxMDY3LFxuICAgIFlmcjogMTIwMDkyLFxuICAgIFpjeTogMTA0NyxcbiAgICBaZnI6IDg0ODgsXG4gICAgYWNkOiA4NzY3LFxuICAgIGFjeTogMTA3MixcbiAgICBhZnI6IDEyMDA5NCxcbiAgICBhbXA6IDM4LFxuICAgIGFuZDogODc0MyxcbiAgICBhbmc6IDg3MzYsXG4gICAgYXBFOiAxMDg2NCxcbiAgICBhcGU6IDg3NzgsXG4gICAgYXN0OiA0MixcbiAgICBiY3k6IDEwNzMsXG4gICAgYmZyOiAxMjAwOTUsXG4gICAgYm90OiA4ODY5LFxuICAgIGNhcDogODc0NSxcbiAgICBjZnI6IDEyMDA5NixcbiAgICBjaGk6IDk2NyxcbiAgICBjaXI6IDk2NzUsXG4gICAgY3VwOiA4NzQ2LFxuICAgIGRjeTogMTA3NixcbiAgICBkZWc6IDE3NixcbiAgICBkZnI6IDEyMDA5NyxcbiAgICBkaWU6IDE2OCxcbiAgICBkaXY6IDI0NyxcbiAgICBkb3Q6IDcyOSxcbiAgICBlY3k6IDExMDEsXG4gICAgZWZyOiAxMjAwOTgsXG4gICAgZWdzOiAxMDkwMixcbiAgICBlbGw6IDg0NjcsXG4gICAgZWxzOiAxMDkwMSxcbiAgICBlbmc6IDMzMSxcbiAgICBldGE6IDk1MSxcbiAgICBldGg6IDI0MCxcbiAgICBmY3k6IDEwOTIsXG4gICAgZmZyOiAxMjAwOTksXG4gICAgZ0VsOiAxMDg5MixcbiAgICBnYXA6IDEwODg2LFxuICAgIGdjeTogMTA3NSxcbiAgICBnZWw6IDg5MjMsXG4gICAgZ2VxOiA4ODA1LFxuICAgIGdlczogMTA4NzgsXG4gICAgZ2ZyOiAxMjAxMDAsXG4gICAgZ2dnOiA4OTIxLFxuICAgIGdsRTogMTA4OTgsXG4gICAgZ2xhOiAxMDkxNyxcbiAgICBnbGo6IDEwOTE2LFxuICAgIGduRTogODgwOSxcbiAgICBnbmU6IDEwODg4LFxuICAgIGhmcjogMTIwMTAxLFxuICAgIGljeTogMTA4MCxcbiAgICBpZmY6IDg2NjAsXG4gICAgaWZyOiAxMjAxMDIsXG4gICAgaW50OiA4NzQ3LFxuICAgIGpjeTogMTA4MSxcbiAgICBqZnI6IDEyMDEwMyxcbiAgICBrY3k6IDEwODIsXG4gICAga2ZyOiAxMjAxMDQsXG4gICAgbEVnOiAxMDg5MSxcbiAgICBsYXA6IDEwODg1LFxuICAgIGxhdDogMTA5MjMsXG4gICAgbGN5OiAxMDgzLFxuICAgIGxlZzogODkyMixcbiAgICBsZXE6IDg4MDQsXG4gICAgbGVzOiAxMDg3NyxcbiAgICBsZnI6IDEyMDEwNSxcbiAgICBsZ0U6IDEwODk3LFxuICAgIGxuRTogODgwOCxcbiAgICBsbmU6IDEwODg3LFxuICAgIGxvejogOTY3NCxcbiAgICBscm06IDgyMDYsXG4gICAgbHNoOiA4NjI0LFxuICAgIG1hcDogODYxNCxcbiAgICBtY3k6IDEwODQsXG4gICAgbWZyOiAxMjAxMDYsXG4gICAgbWhvOiA4NDg3LFxuICAgIG1pZDogODczOSxcbiAgICBuYXA6IDg3NzcsXG4gICAgbmN5OiAxMDg1LFxuICAgIG5mcjogMTIwMTA3LFxuICAgIG5nZTogODgxNyxcbiAgICBuZ3Q6IDg4MTUsXG4gICAgbmlzOiA4OTU2LFxuICAgIG5pdjogODcxNSxcbiAgICBubGU6IDg4MTYsXG4gICAgbmx0OiA4ODE0LFxuICAgIG5vdDogMTcyLFxuICAgIG5wcjogODgzMixcbiAgICBuc2M6IDg4MzMsXG4gICAgbnVtOiAzNSxcbiAgICBvY3k6IDEwODYsXG4gICAgb2ZyOiAxMjAxMDgsXG4gICAgb2d0OiAxMDY4OSxcbiAgICBvaG06IDg0ODYsXG4gICAgb2x0OiAxMDY4OCxcbiAgICBvcmQ6IDEwODQ1LFxuICAgIG9ydjogMTA4NDMsXG4gICAgcGFyOiA4NzQxLFxuICAgIHBjeTogMTA4NyxcbiAgICBwZnI6IDEyMDEwOSxcbiAgICBwaGk6IDk2NixcbiAgICBwaXY6IDk4MixcbiAgICBwckU6IDEwOTMxLFxuICAgIHByZTogMTA5MjcsXG4gICAgcHNpOiA5NjgsXG4gICAgcWZyOiAxMjAxMTAsXG4gICAgcmN5OiAxMDg4LFxuICAgIHJlZzogMTc0LFxuICAgIHJmcjogMTIwMTExLFxuICAgIHJobzogOTYxLFxuICAgIHJsbTogODIwNyxcbiAgICByc2g6IDg2MjUsXG4gICAgc2NFOiAxMDkzMixcbiAgICBzY2U6IDEwOTI4LFxuICAgIHNjeTogMTA4OSxcbiAgICBzZnI6IDEyMDExMixcbiAgICBzaHk6IDE3MyxcbiAgICBzaW06IDg3NjQsXG4gICAgc210OiAxMDkyMixcbiAgICBzb2w6IDQ3LFxuICAgIHNxdTogOTYzMyxcbiAgICBzdWI6IDg4MzQsXG4gICAgc3VtOiA4NzIxLFxuICAgIHN1cDogODgzNSxcbiAgICB0YXU6IDk2NCxcbiAgICB0Y3k6IDEwOTAsXG4gICAgdGZyOiAxMjAxMTMsXG4gICAgdG9wOiA4ODY4LFxuICAgIHVjeTogMTA5MSxcbiAgICB1ZnI6IDEyMDExNCxcbiAgICB1bWw6IDE2OCxcbiAgICB2Y3k6IDEwNzQsXG4gICAgdmVlOiA4NzQ0LFxuICAgIHZmcjogMTIwMTE1LFxuICAgIHdmcjogMTIwMTE2LFxuICAgIHhmcjogMTIwMTE3LFxuICAgIHljeTogMTA5OSxcbiAgICB5ZW46IDE2NSxcbiAgICB5ZnI6IDEyMDExOCxcbiAgICB6Y3k6IDEwNzksXG4gICAgemZyOiAxMjAxMTksXG4gICAgendqOiA4MjA1LFxuICAgIEREOiA4NTE3LFxuICAgIEdUOiA2MixcbiAgICBHZzogODkyMSxcbiAgICBHdDogODgxMSxcbiAgICBJbTogODQ2NSxcbiAgICBMVDogNjAsXG4gICAgTGw6IDg5MjAsXG4gICAgTHQ6IDg4MTAsXG4gICAgTXU6IDkyNCxcbiAgICBOdTogOTI1LFxuICAgIE9yOiAxMDgzNixcbiAgICBQaTogOTI4LFxuICAgIFByOiAxMDkzOSxcbiAgICBSZTogODQ3NixcbiAgICBTYzogMTA5NDAsXG4gICAgWGk6IDkyNixcbiAgICBhYzogODc2NixcbiAgICBhZjogODI4OSxcbiAgICBhcDogODc3NixcbiAgICBkZDogODUxOCxcbiAgICBlZTogODUxOSxcbiAgICBlZzogMTA5MDYsXG4gICAgZWw6IDEwOTA1LFxuICAgIGdFOiA4ODA3LFxuICAgIGdlOiA4ODA1LFxuICAgIGdnOiA4ODExLFxuICAgIGdsOiA4ODIzLFxuICAgIGd0OiA2MixcbiAgICBpYzogODI5MSxcbiAgICBpaTogODUyMCxcbiAgICBpbjogODcxMixcbiAgICBpdDogODI5MCxcbiAgICBsRTogODgwNixcbiAgICBsZTogODgwNCxcbiAgICBsZzogODgyMixcbiAgICBsbDogODgxMCxcbiAgICBsdDogNjAsXG4gICAgbXA6IDg3MjMsXG4gICAgbXU6IDk1NixcbiAgICBuZTogODgwMCxcbiAgICBuaTogODcxNSxcbiAgICBudTogOTU3LFxuICAgIG9TOiA5NDE2LFxuICAgIG9yOiA4NzQ0LFxuICAgIHBpOiA5NjAsXG4gICAgcG06IDE3NyxcbiAgICBwcjogODgyNixcbiAgICByeDogODQ3OCxcbiAgICBzYzogODgyNyxcbiAgICB3cDogODQ3MixcbiAgICB3cjogODc2OCxcbiAgICB4aTogOTU4XG59O1xuXG5jb25zdCB3aW5kb3dzXzEyNTIgPSBbXG4gICAgODM2NCxcbiAgICAxMjksXG4gICAgODIxOCxcbiAgICA0MDIsXG4gICAgODIyMixcbiAgICA4MjMwLFxuICAgIDgyMjQsXG4gICAgODIyNSxcbiAgICA3MTAsXG4gICAgODI0MCxcbiAgICAzNTIsXG4gICAgODI0OSxcbiAgICAzMzgsXG4gICAgMTQxLFxuICAgIDM4MSxcbiAgICAxNDMsXG4gICAgMTQ0LFxuICAgIDgyMTYsXG4gICAgODIxNyxcbiAgICA4MjIwLFxuICAgIDgyMjEsXG4gICAgODIyNixcbiAgICA4MjExLFxuICAgIDgyMTIsXG4gICAgNzMyLFxuICAgIDg0ODIsXG4gICAgMzUzLFxuICAgIDgyNTAsXG4gICAgMzM5LFxuICAgIDE1NyxcbiAgICAzODIsXG4gICAgMzc2XG5dO1xuY29uc3QgZW50aXR5X3BhdHRlcm4gPSBuZXcgUmVnRXhwKGAmKCM/KD86eFtcXFxcd1xcXFxkXSt8XFxcXGQrfCR7T2JqZWN0LmtleXMoZW50aXRpZXMpLmpvaW4oJ3wnKX0pKSg/Ojt8XFxcXGIpYCwgJ2cnKTtcbmZ1bmN0aW9uIGRlY29kZV9jaGFyYWN0ZXJfcmVmZXJlbmNlcyhodG1sKSB7XG4gICAgcmV0dXJuIGh0bWwucmVwbGFjZShlbnRpdHlfcGF0dGVybiwgKG1hdGNoLCBlbnRpdHkpID0+IHtcbiAgICAgICAgbGV0IGNvZGU7XG4gICAgICAgIC8vIEhhbmRsZSBuYW1lZCBlbnRpdGllc1xuICAgICAgICBpZiAoZW50aXR5WzBdICE9PSAnIycpIHtcbiAgICAgICAgICAgIGNvZGUgPSBlbnRpdGllc1tlbnRpdHldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGVudGl0eVsxXSA9PT0gJ3gnKSB7XG4gICAgICAgICAgICBjb2RlID0gcGFyc2VJbnQoZW50aXR5LnN1YnN0cmluZygyKSwgMTYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29kZSA9IHBhcnNlSW50KGVudGl0eS5zdWJzdHJpbmcoMSksIDEwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWNvZGUpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21Db2RlUG9pbnQodmFsaWRhdGVfY29kZShjb2RlKSk7XG4gICAgfSk7XG59XG5jb25zdCBOVUwgPSAwO1xuLy8gc29tZSBjb2RlIHBvaW50cyBhcmUgdmVyYm90ZW4uIElmIHdlIHdlcmUgaW5zZXJ0aW5nIEhUTUwsIHRoZSBicm93c2VyIHdvdWxkIHJlcGxhY2UgdGhlIGlsbGVnYWxcbi8vIGNvZGUgcG9pbnRzIHdpdGggYWx0ZXJuYXRpdmVzIGluIHNvbWUgY2FzZXMgLSBzaW5jZSB3ZSdyZSBieXBhc3NpbmcgdGhhdCBtZWNoYW5pc20sIHdlIG5lZWRcbi8vIHRvIHJlcGxhY2UgdGhlbSBvdXJzZWx2ZXNcbi8vXG4vLyBTb3VyY2U6IGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ2hhcmFjdGVyX2VuY29kaW5nc19pbl9IVE1MI0lsbGVnYWxfY2hhcmFjdGVyc1xuZnVuY3Rpb24gdmFsaWRhdGVfY29kZShjb2RlKSB7XG4gICAgLy8gbGluZSBmZWVkIGJlY29tZXMgZ2VuZXJpYyB3aGl0ZXNwYWNlXG4gICAgaWYgKGNvZGUgPT09IDEwKSB7XG4gICAgICAgIHJldHVybiAzMjtcbiAgICB9XG4gICAgLy8gQVNDSUkgcmFuZ2UuIChXaHkgc29tZW9uZSB3b3VsZCB1c2UgSFRNTCBlbnRpdGllcyBmb3IgQVNDSUkgY2hhcmFjdGVycyBJIGRvbid0IGtub3csIGJ1dC4uLilcbiAgICBpZiAoY29kZSA8IDEyOCkge1xuICAgICAgICByZXR1cm4gY29kZTtcbiAgICB9XG4gICAgLy8gY29kZSBwb2ludHMgMTI4LTE1OSBhcmUgZGVhbHQgd2l0aCBsZW5pZW50bHkgYnkgYnJvd3NlcnMsIGJ1dCB0aGV5J3JlIGluY29ycmVjdC4gV2UgbmVlZFxuICAgIC8vIHRvIGNvcnJlY3QgdGhlIG1pc3Rha2Ugb3Igd2UnbGwgZW5kIHVwIHdpdGggbWlzc2luZyDigqwgc2lnbnMgYW5kIHNvIG9uXG4gICAgaWYgKGNvZGUgPD0gMTU5KSB7XG4gICAgICAgIHJldHVybiB3aW5kb3dzXzEyNTJbY29kZSAtIDEyOF07XG4gICAgfVxuICAgIC8vIGJhc2ljIG11bHRpbGluZ3VhbCBwbGFuZVxuICAgIGlmIChjb2RlIDwgNTUyOTYpIHtcbiAgICAgICAgcmV0dXJuIGNvZGU7XG4gICAgfVxuICAgIC8vIFVURi0xNiBzdXJyb2dhdGUgaGFsdmVzXG4gICAgaWYgKGNvZGUgPD0gNTczNDMpIHtcbiAgICAgICAgcmV0dXJuIE5VTDtcbiAgICB9XG4gICAgLy8gcmVzdCBvZiB0aGUgYmFzaWMgbXVsdGlsaW5ndWFsIHBsYW5lXG4gICAgaWYgKGNvZGUgPD0gNjU1MzUpIHtcbiAgICAgICAgcmV0dXJuIGNvZGU7XG4gICAgfVxuICAgIC8vIHN1cHBsZW1lbnRhcnkgbXVsdGlsaW5ndWFsIHBsYW5lIDB4MTAwMDAgLSAweDFmZmZmXG4gICAgaWYgKGNvZGUgPj0gNjU1MzYgJiYgY29kZSA8PSAxMzEwNzEpIHtcbiAgICAgICAgcmV0dXJuIGNvZGU7XG4gICAgfVxuICAgIC8vIHN1cHBsZW1lbnRhcnkgaWRlb2dyYXBoaWMgcGxhbmUgMHgyMDAwMCAtIDB4MmZmZmZcbiAgICBpZiAoY29kZSA+PSAxMzEwNzIgJiYgY29kZSA8PSAxOTY2MDcpIHtcbiAgICAgICAgcmV0dXJuIGNvZGU7XG4gICAgfVxuICAgIHJldHVybiBOVUw7XG59XG4vLyBiYXNlZCBvbiBodHRwOi8vZGV2ZWxvcGVycy53aGF0d2cub3JnL3N5bnRheC5odG1sI3N5bnRheC10YWctb21pc3Npb25cbmNvbnN0IGRpc2FsbG93ZWRfY29udGVudHMgPSBuZXcgTWFwKFtcbiAgICBbJ2xpJywgbmV3IFNldChbJ2xpJ10pXSxcbiAgICBbJ2R0JywgbmV3IFNldChbJ2R0JywgJ2RkJ10pXSxcbiAgICBbJ2RkJywgbmV3IFNldChbJ2R0JywgJ2RkJ10pXSxcbiAgICBbXG4gICAgICAgICdwJyxcbiAgICAgICAgbmV3IFNldCgnYWRkcmVzcyBhcnRpY2xlIGFzaWRlIGJsb2NrcXVvdGUgZGl2IGRsIGZpZWxkc2V0IGZvb3RlciBmb3JtIGgxIGgyIGgzIGg0IGg1IGg2IGhlYWRlciBoZ3JvdXAgaHIgbWFpbiBtZW51IG5hdiBvbCBwIHByZSBzZWN0aW9uIHRhYmxlIHVsJy5zcGxpdCgnICcpKVxuICAgIF0sXG4gICAgWydydCcsIG5ldyBTZXQoWydydCcsICdycCddKV0sXG4gICAgWydycCcsIG5ldyBTZXQoWydydCcsICdycCddKV0sXG4gICAgWydvcHRncm91cCcsIG5ldyBTZXQoWydvcHRncm91cCddKV0sXG4gICAgWydvcHRpb24nLCBuZXcgU2V0KFsnb3B0aW9uJywgJ29wdGdyb3VwJ10pXSxcbiAgICBbJ3RoZWFkJywgbmV3IFNldChbJ3Rib2R5JywgJ3Rmb290J10pXSxcbiAgICBbJ3Rib2R5JywgbmV3IFNldChbJ3Rib2R5JywgJ3Rmb290J10pXSxcbiAgICBbJ3Rmb290JywgbmV3IFNldChbJ3Rib2R5J10pXSxcbiAgICBbJ3RyJywgbmV3IFNldChbJ3RyJywgJ3Rib2R5J10pXSxcbiAgICBbJ3RkJywgbmV3IFNldChbJ3RkJywgJ3RoJywgJ3RyJ10pXSxcbiAgICBbJ3RoJywgbmV3IFNldChbJ3RkJywgJ3RoJywgJ3RyJ10pXVxuXSk7XG4vLyBjYW4gdGhpcyBiZSBhIGNoaWxkIG9mIHRoZSBwYXJlbnQgZWxlbWVudCwgb3IgZG9lcyBpdCBpbXBsaWNpdGx5XG4vLyBjbG9zZSBpdCwgbGlrZSBgPGxpPm9uZTxsaT50d29gP1xuZnVuY3Rpb24gY2xvc2luZ190YWdfb21pdHRlZChjdXJyZW50LCBuZXh0KSB7XG4gICAgaWYgKGRpc2FsbG93ZWRfY29udGVudHMuaGFzKGN1cnJlbnQpKSB7XG4gICAgICAgIGlmICghbmV4dCB8fCBkaXNhbGxvd2VkX2NvbnRlbnRzLmdldChjdXJyZW50KS5oYXMobmV4dCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVzZWxlc3MtZXNjYXBlXG5jb25zdCB2YWxpZF90YWdfbmFtZSA9IC9eXFwhP1thLXpBLVpdezEsfTo/W2EtekEtWjAtOVxcLV0qLztcbmNvbnN0IG1ldGFfdGFncyA9IG5ldyBNYXAoW1xuICAgIFsnc3ZlbHRlOmhlYWQnLCAnSGVhZCddLFxuICAgIFsnc3ZlbHRlOm9wdGlvbnMnLCAnT3B0aW9ucyddLFxuICAgIFsnc3ZlbHRlOndpbmRvdycsICdXaW5kb3cnXSxcbiAgICBbJ3N2ZWx0ZTpib2R5JywgJ0JvZHknXVxuXSk7XG5jb25zdCB2YWxpZF9tZXRhX3RhZ3MgPSBBcnJheS5mcm9tKG1ldGFfdGFncy5rZXlzKCkpLmNvbmNhdCgnc3ZlbHRlOnNlbGYnLCAnc3ZlbHRlOmNvbXBvbmVudCcsICdzdmVsdGU6ZnJhZ21lbnQnLCAnc3ZlbHRlOmVsZW1lbnQnKTtcbmNvbnN0IHNwZWNpYWxzID0gbmV3IE1hcChbXG4gICAgW1xuICAgICAgICAnc2NyaXB0JyxcbiAgICAgICAge1xuICAgICAgICAgICAgcmVhZDogcmVhZF9zY3JpcHQsXG4gICAgICAgICAgICBwcm9wZXJ0eTogJ2pzJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICBbXG4gICAgICAgICdzdHlsZScsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlYWQ6IHJlYWRfc3R5bGUsXG4gICAgICAgICAgICBwcm9wZXJ0eTogJ2NzcydcbiAgICAgICAgfVxuICAgIF1cbl0pO1xuY29uc3QgU0VMRiA9IC9ec3ZlbHRlOnNlbGYoPz1bXFxzLz5dKS87XG5jb25zdCBDT01QT05FTlQgPSAvXnN2ZWx0ZTpjb21wb25lbnQoPz1bXFxzLz5dKS87XG5jb25zdCBTTE9UID0gL15zdmVsdGU6ZnJhZ21lbnQoPz1bXFxzLz5dKS87XG5jb25zdCBFTEVNRU5UID0gL15zdmVsdGU6ZWxlbWVudCg/PVtcXHMvPl0pLztcbmZ1bmN0aW9uIHBhcmVudF9pc19oZWFkKHN0YWNrKSB7XG4gICAgbGV0IGkgPSBzdGFjay5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb25zdCB7IHR5cGUgfSA9IHN0YWNrW2ldO1xuICAgICAgICBpZiAodHlwZSA9PT0gJ0hlYWQnKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmICh0eXBlID09PSAnRWxlbWVudCcgfHwgdHlwZSA9PT0gJ0lubGluZUNvbXBvbmVudCcpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmNvbnN0IHJlZ2V4X2Nsb3NpbmdfdGV4dGFyZWFfdGFnID0gL148XFwvdGV4dGFyZWEoXFxzW14+XSopPz4vaTtcbmNvbnN0IHJlZ2V4X2Nsb3NpbmdfY29tbWVudCA9IC8tLT4vO1xuY29uc3QgcmVnZXhfY2FwaXRhbF9sZXR0ZXIgPSAvW0EtWl0vO1xuZnVuY3Rpb24gdGFnKHBhcnNlcikge1xuICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VyLmluZGV4Kys7XG4gICAgbGV0IHBhcmVudCA9IHBhcnNlci5jdXJyZW50KCk7XG4gICAgaWYgKHBhcnNlci5lYXQoJyEtLScpKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBwYXJzZXIucmVhZF91bnRpbChyZWdleF9jbG9zaW5nX2NvbW1lbnQpO1xuICAgICAgICBwYXJzZXIuZWF0KCctLT4nLCB0cnVlLCBwYXJzZXJfZXJyb3JzLnVuY2xvc2VkX2NvbW1lbnQpO1xuICAgICAgICBwYXJzZXIuY3VycmVudCgpLmNoaWxkcmVuLnB1c2goe1xuICAgICAgICAgICAgc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IHBhcnNlci5pbmRleCxcbiAgICAgICAgICAgIHR5cGU6ICdDb21tZW50JyxcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICBpZ25vcmVzOiBleHRyYWN0X3N2ZWx0ZV9pZ25vcmUoZGF0YSlcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgaXNfY2xvc2luZ190YWcgPSBwYXJzZXIuZWF0KCcvJyk7XG4gICAgY29uc3QgbmFtZSA9IHJlYWRfdGFnX25hbWUocGFyc2VyKTtcbiAgICBpZiAobWV0YV90YWdzLmhhcyhuYW1lKSkge1xuICAgICAgICBjb25zdCBzbHVnID0gbWV0YV90YWdzLmdldChuYW1lKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAoaXNfY2xvc2luZ190YWcpIHtcbiAgICAgICAgICAgIGlmICgobmFtZSA9PT0gJ3N2ZWx0ZTp3aW5kb3cnIHx8IG5hbWUgPT09ICdzdmVsdGU6Ym9keScpICYmXG4gICAgICAgICAgICAgICAgcGFyc2VyLmN1cnJlbnQoKS5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy5pbnZhbGlkX2VsZW1lbnRfY29udGVudChzbHVnLCBuYW1lKSwgcGFyc2VyLmN1cnJlbnQoKS5jaGlsZHJlblswXS5zdGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAobmFtZSBpbiBwYXJzZXIubWV0YV90YWdzKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMuZHVwbGljYXRlX2VsZW1lbnQoc2x1ZywgbmFtZSksIHN0YXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXJzZXIuc3RhY2subGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmludmFsaWRfZWxlbWVudF9wbGFjZW1lbnQoc2x1ZywgbmFtZSksIHN0YXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhcnNlci5tZXRhX3RhZ3NbbmFtZV0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHR5cGUgPSBtZXRhX3RhZ3MuaGFzKG5hbWUpXG4gICAgICAgID8gbWV0YV90YWdzLmdldChuYW1lKVxuICAgICAgICA6IChyZWdleF9jYXBpdGFsX2xldHRlci50ZXN0KG5hbWVbMF0pIHx8IG5hbWUgPT09ICdzdmVsdGU6c2VsZicgfHwgbmFtZSA9PT0gJ3N2ZWx0ZTpjb21wb25lbnQnKSA/ICdJbmxpbmVDb21wb25lbnQnXG4gICAgICAgICAgICA6IG5hbWUgPT09ICdzdmVsdGU6ZnJhZ21lbnQnID8gJ1Nsb3RUZW1wbGF0ZSdcbiAgICAgICAgICAgICAgICA6IG5hbWUgPT09ICd0aXRsZScgJiYgcGFyZW50X2lzX2hlYWQocGFyc2VyLnN0YWNrKSA/ICdUaXRsZSdcbiAgICAgICAgICAgICAgICAgICAgOiBuYW1lID09PSAnc2xvdCcgJiYgIXBhcnNlci5jdXN0b21FbGVtZW50ID8gJ1Nsb3QnIDogJ0VsZW1lbnQnO1xuICAgIGNvbnN0IGVsZW1lbnQgPSB7XG4gICAgICAgIHN0YXJ0LFxuICAgICAgICBlbmQ6IG51bGwsXG4gICAgICAgIHR5cGUsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGF0dHJpYnV0ZXM6IFtdLFxuICAgICAgICBjaGlsZHJlbjogW11cbiAgICB9O1xuICAgIHBhcnNlci5hbGxvd193aGl0ZXNwYWNlKCk7XG4gICAgaWYgKGlzX2Nsb3NpbmdfdGFnKSB7XG4gICAgICAgIGlmIChpc192b2lkKG5hbWUpKSB7XG4gICAgICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy5pbnZhbGlkX3ZvaWRfY29udGVudChuYW1lKSwgc3RhcnQpO1xuICAgICAgICB9XG4gICAgICAgIHBhcnNlci5lYXQoJz4nLCB0cnVlKTtcbiAgICAgICAgLy8gY2xvc2UgYW55IGVsZW1lbnRzIHRoYXQgZG9uJ3QgaGF2ZSB0aGVpciBvd24gY2xvc2luZyB0YWdzLCBlLmcuIDxkaXY+PHA+PC9kaXY+XG4gICAgICAgIHdoaWxlIChwYXJlbnQubmFtZSAhPT0gbmFtZSkge1xuICAgICAgICAgICAgaWYgKHBhcmVudC50eXBlICE9PSAnRWxlbWVudCcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvciA9IHBhcnNlci5sYXN0X2F1dG9fY2xvc2VkX3RhZyAmJiBwYXJzZXIubGFzdF9hdXRvX2Nsb3NlZF90YWcudGFnID09PSBuYW1lXG4gICAgICAgICAgICAgICAgICAgID8gcGFyc2VyX2Vycm9ycy5pbnZhbGlkX2Nsb3NpbmdfdGFnX2F1dG9jbG9zZWQobmFtZSwgcGFyc2VyLmxhc3RfYXV0b19jbG9zZWRfdGFnLnJlYXNvbilcbiAgICAgICAgICAgICAgICAgICAgOiBwYXJzZXJfZXJyb3JzLmludmFsaWRfY2xvc2luZ190YWdfdW5vcGVuZWQobmFtZSk7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmVycm9yKGVycm9yLCBzdGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJlbnQuZW5kID0gc3RhcnQ7XG4gICAgICAgICAgICBwYXJzZXIuc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJzZXIuY3VycmVudCgpO1xuICAgICAgICB9XG4gICAgICAgIHBhcmVudC5lbmQgPSBwYXJzZXIuaW5kZXg7XG4gICAgICAgIHBhcnNlci5zdGFjay5wb3AoKTtcbiAgICAgICAgaWYgKHBhcnNlci5sYXN0X2F1dG9fY2xvc2VkX3RhZyAmJiBwYXJzZXIuc3RhY2subGVuZ3RoIDwgcGFyc2VyLmxhc3RfYXV0b19jbG9zZWRfdGFnLmRlcHRoKSB7XG4gICAgICAgICAgICBwYXJzZXIubGFzdF9hdXRvX2Nsb3NlZF90YWcgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZWxzZSBpZiAoY2xvc2luZ190YWdfb21pdHRlZChwYXJlbnQubmFtZSwgbmFtZSkpIHtcbiAgICAgICAgcGFyZW50LmVuZCA9IHN0YXJ0O1xuICAgICAgICBwYXJzZXIuc3RhY2sucG9wKCk7XG4gICAgICAgIHBhcnNlci5sYXN0X2F1dG9fY2xvc2VkX3RhZyA9IHtcbiAgICAgICAgICAgIHRhZzogcGFyZW50Lm5hbWUsXG4gICAgICAgICAgICByZWFzb246IG5hbWUsXG4gICAgICAgICAgICBkZXB0aDogcGFyc2VyLnN0YWNrLmxlbmd0aFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjb25zdCB1bmlxdWVfbmFtZXMgPSBuZXcgU2V0KCk7XG4gICAgbGV0IGF0dHJpYnV0ZTtcbiAgICB3aGlsZSAoKGF0dHJpYnV0ZSA9IHJlYWRfYXR0cmlidXRlKHBhcnNlciwgdW5pcXVlX25hbWVzKSkpIHtcbiAgICAgICAgZWxlbWVudC5hdHRyaWJ1dGVzLnB1c2goYXR0cmlidXRlKTtcbiAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICB9XG4gICAgaWYgKG5hbWUgPT09ICdzdmVsdGU6Y29tcG9uZW50Jykge1xuICAgICAgICBjb25zdCBpbmRleCA9IGVsZW1lbnQuYXR0cmlidXRlcy5maW5kSW5kZXgoYXR0ciA9PiBhdHRyLnR5cGUgPT09ICdBdHRyaWJ1dGUnICYmIGF0dHIubmFtZSA9PT0gJ3RoaXMnKTtcbiAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMubWlzc2luZ19jb21wb25lbnRfZGVmaW5pdGlvbiwgc3RhcnQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlZmluaXRpb24gPSBlbGVtZW50LmF0dHJpYnV0ZXMuc3BsaWNlKGluZGV4LCAxKVswXTtcbiAgICAgICAgaWYgKGRlZmluaXRpb24udmFsdWUgPT09IHRydWUgfHwgZGVmaW5pdGlvbi52YWx1ZS5sZW5ndGggIT09IDEgfHwgZGVmaW5pdGlvbi52YWx1ZVswXS50eXBlID09PSAnVGV4dCcpIHtcbiAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmludmFsaWRfY29tcG9uZW50X2RlZmluaXRpb24sIGRlZmluaXRpb24uc3RhcnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnQuZXhwcmVzc2lvbiA9IGRlZmluaXRpb24udmFsdWVbMF0uZXhwcmVzc2lvbjtcbiAgICB9XG4gICAgaWYgKG5hbWUgPT09ICdzdmVsdGU6ZWxlbWVudCcpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSBlbGVtZW50LmF0dHJpYnV0ZXMuZmluZEluZGV4KGF0dHIgPT4gYXR0ci50eXBlID09PSAnQXR0cmlidXRlJyAmJiBhdHRyLm5hbWUgPT09ICd0aGlzJyk7XG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLm1pc3NpbmdfZWxlbWVudF9kZWZpbml0aW9uLCBzdGFydCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGVmaW5pdGlvbiA9IGVsZW1lbnQuYXR0cmlidXRlcy5zcGxpY2UoaW5kZXgsIDEpWzBdO1xuICAgICAgICBpZiAoZGVmaW5pdGlvbi52YWx1ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMuaW52YWxpZF9lbGVtZW50X2RlZmluaXRpb24sIGRlZmluaXRpb24uc3RhcnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnQudGFnID0gZGVmaW5pdGlvbi52YWx1ZVswXS5kYXRhIHx8IGRlZmluaXRpb24udmFsdWVbMF0uZXhwcmVzc2lvbjtcbiAgICB9XG4gICAgLy8gc3BlY2lhbCBjYXNlcyDigJMgdG9wLWxldmVsIDxzY3JpcHQ+IGFuZCA8c3R5bGU+XG4gICAgaWYgKHNwZWNpYWxzLmhhcyhuYW1lKSAmJiBwYXJzZXIuc3RhY2subGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGNvbnN0IHNwZWNpYWwgPSBzcGVjaWFscy5nZXQobmFtZSk7XG4gICAgICAgIHBhcnNlci5lYXQoJz4nLCB0cnVlKTtcbiAgICAgICAgY29uc3QgY29udGVudCA9IHNwZWNpYWwucmVhZChwYXJzZXIsIHN0YXJ0LCBlbGVtZW50LmF0dHJpYnV0ZXMpO1xuICAgICAgICBpZiAoY29udGVudClcbiAgICAgICAgICAgIHBhcnNlcltzcGVjaWFsLnByb3BlcnR5XS5wdXNoKGNvbnRlbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHBhcnNlci5jdXJyZW50KCkuY2hpbGRyZW4ucHVzaChlbGVtZW50KTtcbiAgICBjb25zdCBzZWxmX2Nsb3NpbmcgPSBwYXJzZXIuZWF0KCcvJykgfHwgaXNfdm9pZChuYW1lKTtcbiAgICBwYXJzZXIuZWF0KCc+JywgdHJ1ZSk7XG4gICAgaWYgKHNlbGZfY2xvc2luZykge1xuICAgICAgICAvLyBkb24ndCBwdXNoIHNlbGYtY2xvc2luZyBlbGVtZW50cyBvbnRvIHRoZSBzdGFja1xuICAgICAgICBlbGVtZW50LmVuZCA9IHBhcnNlci5pbmRleDtcbiAgICB9XG4gICAgZWxzZSBpZiAobmFtZSA9PT0gJ3RleHRhcmVhJykge1xuICAgICAgICAvLyBzcGVjaWFsIGNhc2VcbiAgICAgICAgZWxlbWVudC5jaGlsZHJlbiA9IHJlYWRfc2VxdWVuY2UocGFyc2VyLCAoKSA9PiByZWdleF9jbG9zaW5nX3RleHRhcmVhX3RhZy50ZXN0KHBhcnNlci50ZW1wbGF0ZS5zbGljZShwYXJzZXIuaW5kZXgpKSwgJ2luc2lkZSA8dGV4dGFyZWE+Jyk7XG4gICAgICAgIHBhcnNlci5yZWFkKHJlZ2V4X2Nsb3NpbmdfdGV4dGFyZWFfdGFnKTtcbiAgICAgICAgZWxlbWVudC5lbmQgPSBwYXJzZXIuaW5kZXg7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5hbWUgPT09ICdzY3JpcHQnIHx8IG5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgLy8gc3BlY2lhbCBjYXNlXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VyLmluZGV4O1xuICAgICAgICBjb25zdCBkYXRhID0gcGFyc2VyLnJlYWRfdW50aWwobmV3IFJlZ0V4cChgPC8ke25hbWV9PmApKTtcbiAgICAgICAgY29uc3QgZW5kID0gcGFyc2VyLmluZGV4O1xuICAgICAgICBlbGVtZW50LmNoaWxkcmVuLnB1c2goeyBzdGFydCwgZW5kLCB0eXBlOiAnVGV4dCcsIGRhdGEgfSk7XG4gICAgICAgIHBhcnNlci5lYXQoYDwvJHtuYW1lfT5gLCB0cnVlKTtcbiAgICAgICAgZWxlbWVudC5lbmQgPSBwYXJzZXIuaW5kZXg7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBwYXJzZXIuc3RhY2sucHVzaChlbGVtZW50KTtcbiAgICB9XG59XG5jb25zdCByZWdleF93aGl0ZXNwYWNlX29yX3NsYXNoX29yX2Nsb3NpbmdfdGFnID0gLyhcXHN8XFwvfD4pLztcbmZ1bmN0aW9uIHJlYWRfdGFnX25hbWUocGFyc2VyKSB7XG4gICAgY29uc3Qgc3RhcnQgPSBwYXJzZXIuaW5kZXg7XG4gICAgaWYgKHBhcnNlci5yZWFkKFNFTEYpKSB7XG4gICAgICAgIC8vIGNoZWNrIHdlJ3JlIGluc2lkZSBhIGJsb2NrLCBvdGhlcndpc2UgdGhpc1xuICAgICAgICAvLyB3aWxsIGNhdXNlIGluZmluaXRlIHJlY3Vyc2lvblxuICAgICAgICBsZXQgaSA9IHBhcnNlci5zdGFjay5sZW5ndGg7XG4gICAgICAgIGxldCBsZWdhbCA9IGZhbHNlO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBmcmFnbWVudCA9IHBhcnNlci5zdGFja1tpXTtcbiAgICAgICAgICAgIGlmIChmcmFnbWVudC50eXBlID09PSAnSWZCbG9jaycgfHwgZnJhZ21lbnQudHlwZSA9PT0gJ0VhY2hCbG9jaycgfHwgZnJhZ21lbnQudHlwZSA9PT0gJ0lubGluZUNvbXBvbmVudCcpIHtcbiAgICAgICAgICAgICAgICBsZWdhbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFsZWdhbCkge1xuICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMuaW52YWxpZF9zZWxmX3BsYWNlbWVudCwgc3RhcnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnc3ZlbHRlOnNlbGYnO1xuICAgIH1cbiAgICBpZiAocGFyc2VyLnJlYWQoQ09NUE9ORU5UKSlcbiAgICAgICAgcmV0dXJuICdzdmVsdGU6Y29tcG9uZW50JztcbiAgICBpZiAocGFyc2VyLnJlYWQoRUxFTUVOVCkpXG4gICAgICAgIHJldHVybiAnc3ZlbHRlOmVsZW1lbnQnO1xuICAgIGlmIChwYXJzZXIucmVhZChTTE9UKSlcbiAgICAgICAgcmV0dXJuICdzdmVsdGU6ZnJhZ21lbnQnO1xuICAgIGNvbnN0IG5hbWUgPSBwYXJzZXIucmVhZF91bnRpbChyZWdleF93aGl0ZXNwYWNlX29yX3NsYXNoX29yX2Nsb3NpbmdfdGFnKTtcbiAgICBpZiAobWV0YV90YWdzLmhhcyhuYW1lKSlcbiAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgaWYgKG5hbWUuc3RhcnRzV2l0aCgnc3ZlbHRlOicpKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gZnV6enltYXRjaChuYW1lLnNsaWNlKDcpLCB2YWxpZF9tZXRhX3RhZ3MpO1xuICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy5pbnZhbGlkX3RhZ19uYW1lX3N2ZWx0ZV9lbGVtZW50KHZhbGlkX21ldGFfdGFncywgbWF0Y2gpLCBzdGFydCk7XG4gICAgfVxuICAgIGlmICghdmFsaWRfdGFnX25hbWUudGVzdChuYW1lKSkge1xuICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy5pbnZhbGlkX3RhZ19uYW1lLCBzdGFydCk7XG4gICAgfVxuICAgIHJldHVybiBuYW1lO1xufVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVzZWxlc3MtZXNjYXBlXG5jb25zdCByZWdleF90b2tlbl9lbmRpbmdfY2hhcmFjdGVyID0gL1tcXHM9XFwvPlwiJ10vO1xuY29uc3QgcmVnZXhfcXVvdGVfY2hhcmFjdGVycyA9IC9bXCInXS87XG5mdW5jdGlvbiByZWFkX2F0dHJpYnV0ZShwYXJzZXIsIHVuaXF1ZV9uYW1lcykge1xuICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VyLmluZGV4O1xuICAgIGZ1bmN0aW9uIGNoZWNrX3VuaXF1ZShuYW1lKSB7XG4gICAgICAgIGlmICh1bmlxdWVfbmFtZXMuaGFzKG5hbWUpKSB7XG4gICAgICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy5kdXBsaWNhdGVfYXR0cmlidXRlLCBzdGFydCk7XG4gICAgICAgIH1cbiAgICAgICAgdW5pcXVlX25hbWVzLmFkZChuYW1lKTtcbiAgICB9XG4gICAgaWYgKHBhcnNlci5lYXQoJ3snKSkge1xuICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICBpZiAocGFyc2VyLmVhdCgnLi4uJykpIHtcbiAgICAgICAgICAgIGNvbnN0IGV4cHJlc3Npb24gPSByZWFkX2V4cHJlc3Npb24ocGFyc2VyKTtcbiAgICAgICAgICAgIHBhcnNlci5hbGxvd193aGl0ZXNwYWNlKCk7XG4gICAgICAgICAgICBwYXJzZXIuZWF0KCd9JywgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXJ0LFxuICAgICAgICAgICAgICAgIGVuZDogcGFyc2VyLmluZGV4LFxuICAgICAgICAgICAgICAgIHR5cGU6ICdTcHJlYWQnLFxuICAgICAgICAgICAgICAgIGV4cHJlc3Npb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZV9zdGFydCA9IHBhcnNlci5pbmRleDtcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBwYXJzZXIucmVhZF9pZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgcGFyc2VyLmVhdCgnfScsIHRydWUpO1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy5lbXB0eV9hdHRyaWJ1dGVfc2hvcnRoYW5kLCBzdGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGVja191bmlxdWUobmFtZSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXJ0LFxuICAgICAgICAgICAgICAgIGVuZDogcGFyc2VyLmluZGV4LFxuICAgICAgICAgICAgICAgIHR5cGU6ICdBdHRyaWJ1dGUnLFxuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogdmFsdWVfc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IHZhbHVlX3N0YXJ0ICsgbmFtZS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQXR0cmlidXRlU2hvcnRoYW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogdmFsdWVfc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiB2YWx1ZV9zdGFydCArIG5hbWUubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdJZGVudGlmaWVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5hbWUgPSBwYXJzZXIucmVhZF91bnRpbChyZWdleF90b2tlbl9lbmRpbmdfY2hhcmFjdGVyKTtcbiAgICBpZiAoIW5hbWUpXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIGxldCBlbmQgPSBwYXJzZXIuaW5kZXg7XG4gICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICBjb25zdCBjb2xvbl9pbmRleCA9IG5hbWUuaW5kZXhPZignOicpO1xuICAgIGNvbnN0IHR5cGUgPSBjb2xvbl9pbmRleCAhPT0gLTEgJiYgZ2V0X2RpcmVjdGl2ZV90eXBlKG5hbWUuc2xpY2UoMCwgY29sb25faW5kZXgpKTtcbiAgICBsZXQgdmFsdWUgPSB0cnVlO1xuICAgIGlmIChwYXJzZXIuZWF0KCc9JykpIHtcbiAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgdmFsdWUgPSByZWFkX2F0dHJpYnV0ZV92YWx1ZShwYXJzZXIpO1xuICAgICAgICBlbmQgPSBwYXJzZXIuaW5kZXg7XG4gICAgfVxuICAgIGVsc2UgaWYgKHBhcnNlci5tYXRjaF9yZWdleChyZWdleF9xdW90ZV9jaGFyYWN0ZXJzKSkge1xuICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy51bmV4cGVjdGVkX3Rva2VuKCc9JyksIHBhcnNlci5pbmRleCk7XG4gICAgfVxuICAgIGlmICh0eXBlKSB7XG4gICAgICAgIGNvbnN0IFtkaXJlY3RpdmVfbmFtZSwgLi4ubW9kaWZpZXJzXSA9IG5hbWUuc2xpY2UoY29sb25faW5kZXggKyAxKS5zcGxpdCgnfCcpO1xuICAgICAgICBpZiAoZGlyZWN0aXZlX25hbWUgPT09ICcnKSB7XG4gICAgICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy5lbXB0eV9kaXJlY3RpdmVfbmFtZSh0eXBlKSwgc3RhcnQgKyBjb2xvbl9pbmRleCArIDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlID09PSAnQmluZGluZycgJiYgZGlyZWN0aXZlX25hbWUgIT09ICd0aGlzJykge1xuICAgICAgICAgICAgY2hlY2tfdW5pcXVlKGRpcmVjdGl2ZV9uYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlICE9PSAnRXZlbnRIYW5kbGVyJyAmJiB0eXBlICE9PSAnQWN0aW9uJykge1xuICAgICAgICAgICAgY2hlY2tfdW5pcXVlKG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlID09PSAnUmVmJykge1xuICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMuaW52YWxpZF9yZWZfZGlyZWN0aXZlKGRpcmVjdGl2ZV9uYW1lKSwgc3RhcnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlID09PSAnU3R5bGVEaXJlY3RpdmUnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXJ0LFxuICAgICAgICAgICAgICAgIGVuZCxcbiAgICAgICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgICAgIG5hbWU6IGRpcmVjdGl2ZV9uYW1lLFxuICAgICAgICAgICAgICAgIG1vZGlmaWVycyxcbiAgICAgICAgICAgICAgICB2YWx1ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaXJzdF92YWx1ZSA9IHZhbHVlWzBdO1xuICAgICAgICBsZXQgZXhwcmVzc2lvbiA9IG51bGw7XG4gICAgICAgIGlmIChmaXJzdF92YWx1ZSkge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlX2NvbnRhaW5zX3RleHQgPSB2YWx1ZS5sZW5ndGggPiAxIHx8IGZpcnN0X3ZhbHVlLnR5cGUgPT09ICdUZXh0JztcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVfY29udGFpbnNfdGV4dCkge1xuICAgICAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmludmFsaWRfZGlyZWN0aXZlX3ZhbHVlLCBmaXJzdF92YWx1ZS5zdGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uID0gZmlyc3RfdmFsdWUuZXhwcmVzc2lvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZCxcbiAgICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgICBuYW1lOiBkaXJlY3RpdmVfbmFtZSxcbiAgICAgICAgICAgIG1vZGlmaWVycyxcbiAgICAgICAgICAgIGV4cHJlc3Npb25cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHR5cGUgPT09ICdUcmFuc2l0aW9uJykge1xuICAgICAgICAgICAgY29uc3QgZGlyZWN0aW9uID0gbmFtZS5zbGljZSgwLCBjb2xvbl9pbmRleCk7XG4gICAgICAgICAgICBkaXJlY3RpdmUuaW50cm8gPSBkaXJlY3Rpb24gPT09ICdpbicgfHwgZGlyZWN0aW9uID09PSAndHJhbnNpdGlvbic7XG4gICAgICAgICAgICBkaXJlY3RpdmUub3V0cm8gPSBkaXJlY3Rpb24gPT09ICdvdXQnIHx8IGRpcmVjdGlvbiA9PT0gJ3RyYW5zaXRpb24nO1xuICAgICAgICB9XG4gICAgICAgIC8vIERpcmVjdGl2ZSBuYW1lIGlzIGV4cHJlc3Npb24sIGUuZy4gPHAgY2xhc3M6aXNSZWQgLz5cbiAgICAgICAgaWYgKCFkaXJlY3RpdmUuZXhwcmVzc2lvbiAmJiAodHlwZSA9PT0gJ0JpbmRpbmcnIHx8IHR5cGUgPT09ICdDbGFzcycpKSB7XG4gICAgICAgICAgICBkaXJlY3RpdmUuZXhwcmVzc2lvbiA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogZGlyZWN0aXZlLnN0YXJ0ICsgY29sb25faW5kZXggKyAxLFxuICAgICAgICAgICAgICAgIGVuZDogZGlyZWN0aXZlLmVuZCxcbiAgICAgICAgICAgICAgICB0eXBlOiAnSWRlbnRpZmllcicsXG4gICAgICAgICAgICAgICAgbmFtZTogZGlyZWN0aXZlLm5hbWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgICB9XG4gICAgY2hlY2tfdW5pcXVlKG5hbWUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0LFxuICAgICAgICBlbmQsXG4gICAgICAgIHR5cGU6ICdBdHRyaWJ1dGUnLFxuICAgICAgICBuYW1lLFxuICAgICAgICB2YWx1ZVxuICAgIH07XG59XG5mdW5jdGlvbiBnZXRfZGlyZWN0aXZlX3R5cGUobmFtZSkge1xuICAgIGlmIChuYW1lID09PSAndXNlJylcbiAgICAgICAgcmV0dXJuICdBY3Rpb24nO1xuICAgIGlmIChuYW1lID09PSAnYW5pbWF0ZScpXG4gICAgICAgIHJldHVybiAnQW5pbWF0aW9uJztcbiAgICBpZiAobmFtZSA9PT0gJ2JpbmQnKVxuICAgICAgICByZXR1cm4gJ0JpbmRpbmcnO1xuICAgIGlmIChuYW1lID09PSAnY2xhc3MnKVxuICAgICAgICByZXR1cm4gJ0NsYXNzJztcbiAgICBpZiAobmFtZSA9PT0gJ3N0eWxlJylcbiAgICAgICAgcmV0dXJuICdTdHlsZURpcmVjdGl2ZSc7XG4gICAgaWYgKG5hbWUgPT09ICdvbicpXG4gICAgICAgIHJldHVybiAnRXZlbnRIYW5kbGVyJztcbiAgICBpZiAobmFtZSA9PT0gJ2xldCcpXG4gICAgICAgIHJldHVybiAnTGV0JztcbiAgICBpZiAobmFtZSA9PT0gJ3JlZicpXG4gICAgICAgIHJldHVybiAnUmVmJztcbiAgICBpZiAobmFtZSA9PT0gJ2luJyB8fCBuYW1lID09PSAnb3V0JyB8fCBuYW1lID09PSAndHJhbnNpdGlvbicpXG4gICAgICAgIHJldHVybiAnVHJhbnNpdGlvbic7XG59XG5mdW5jdGlvbiByZWFkX2F0dHJpYnV0ZV92YWx1ZShwYXJzZXIpIHtcbiAgICBjb25zdCBxdW90ZV9tYXJrID0gcGFyc2VyLmVhdChcIidcIikgPyBcIidcIiA6IHBhcnNlci5lYXQoJ1wiJykgPyAnXCInIDogbnVsbDtcbiAgICBpZiAocXVvdGVfbWFyayAmJiBwYXJzZXIuZWF0KHF1b3RlX21hcmspKSB7XG4gICAgICAgIHJldHVybiBbe1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBwYXJzZXIuaW5kZXggLSAxLFxuICAgICAgICAgICAgICAgIGVuZDogcGFyc2VyLmluZGV4IC0gMSxcbiAgICAgICAgICAgICAgICB0eXBlOiAnVGV4dCcsXG4gICAgICAgICAgICAgICAgcmF3OiAnJyxcbiAgICAgICAgICAgICAgICBkYXRhOiAnJ1xuICAgICAgICAgICAgfV07XG4gICAgfVxuICAgIGNvbnN0IHJlZ2V4ID0gKHF1b3RlX21hcmsgPT09IFwiJ1wiID8gLycvIDpcbiAgICAgICAgcXVvdGVfbWFyayA9PT0gJ1wiJyA/IC9cIi8gOlxuICAgICAgICAgICAgLyhcXC8+fFtcXHNcIic9PD5gXSkvKTtcbiAgICBsZXQgdmFsdWU7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFsdWUgPSByZWFkX3NlcXVlbmNlKHBhcnNlciwgKCkgPT4gISFwYXJzZXIubWF0Y2hfcmVnZXgocmVnZXgpLCAnaW4gYXR0cmlidXRlIHZhbHVlJyk7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ3BhcnNlLWVycm9yJykge1xuICAgICAgICAgICAgLy8gaWYgdGhlIGF0dHJpYnV0ZSB2YWx1ZSBkaWRuJ3QgY2xvc2UgKyBzZWxmLWNsb3NpbmcgdGFnXG4gICAgICAgICAgICAvLyBlZzogYDxDb21wb25lbnQgdGVzdD17e2E6MX0gLz5gXG4gICAgICAgICAgICAvLyBhY29ybiBtYXkgdGhyb3cgYSBgVW50ZXJtaW5hdGVkIHJlZ3VsYXIgZXhwcmVzc2lvbmAgYmVjYXVzZSBvZiBgLz5gXG4gICAgICAgICAgICBpZiAocGFyc2VyLnRlbXBsYXRlLnNsaWNlKGVycm9yLnBvcyAtIDEsIGVycm9yLnBvcyArIDEpID09PSAnLz4nKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmluZGV4ID0gZXJyb3IucG9zO1xuICAgICAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLnVuY2xvc2VkX2F0dHJpYnV0ZV92YWx1ZShxdW90ZV9tYXJrIHx8ICd9JykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBpZiAodmFsdWUubGVuZ3RoID09PSAwICYmICFxdW90ZV9tYXJrKSB7XG4gICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLm1pc3NpbmdfYXR0cmlidXRlX3ZhbHVlKTtcbiAgICB9XG4gICAgaWYgKHF1b3RlX21hcmspXG4gICAgICAgIHBhcnNlci5pbmRleCArPSAxO1xuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHJlYWRfc2VxdWVuY2UocGFyc2VyLCBkb25lLCBsb2NhdGlvbikge1xuICAgIGxldCBjdXJyZW50X2NodW5rID0ge1xuICAgICAgICBzdGFydDogcGFyc2VyLmluZGV4LFxuICAgICAgICBlbmQ6IG51bGwsXG4gICAgICAgIHR5cGU6ICdUZXh0JyxcbiAgICAgICAgcmF3OiAnJyxcbiAgICAgICAgZGF0YTogbnVsbFxuICAgIH07XG4gICAgY29uc3QgY2h1bmtzID0gW107XG4gICAgZnVuY3Rpb24gZmx1c2goZW5kKSB7XG4gICAgICAgIGlmIChjdXJyZW50X2NodW5rLnJhdykge1xuICAgICAgICAgICAgY3VycmVudF9jaHVuay5kYXRhID0gZGVjb2RlX2NoYXJhY3Rlcl9yZWZlcmVuY2VzKGN1cnJlbnRfY2h1bmsucmF3KTtcbiAgICAgICAgICAgIGN1cnJlbnRfY2h1bmsuZW5kID0gZW5kO1xuICAgICAgICAgICAgY2h1bmtzLnB1c2goY3VycmVudF9jaHVuayk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgd2hpbGUgKHBhcnNlci5pbmRleCA8IHBhcnNlci50ZW1wbGF0ZS5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSBwYXJzZXIuaW5kZXg7XG4gICAgICAgIGlmIChkb25lKCkpIHtcbiAgICAgICAgICAgIGZsdXNoKHBhcnNlci5pbmRleCk7XG4gICAgICAgICAgICByZXR1cm4gY2h1bmtzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhcnNlci5lYXQoJ3snKSkge1xuICAgICAgICAgICAgaWYgKHBhcnNlci5tYXRjaCgnIycpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBwYXJzZXIuaW5kZXggLSAxO1xuICAgICAgICAgICAgICAgIHBhcnNlci5lYXQoJyMnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gcGFyc2VyLnJlYWRfdW50aWwoL1teYS16XS8pO1xuICAgICAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmludmFsaWRfbG9naWNfYmxvY2tfcGxhY2VtZW50KGxvY2F0aW9uLCBuYW1lKSwgaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyc2VyLm1hdGNoKCdAJykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlci5pbmRleCAtIDE7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmVhdCgnQCcpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBwYXJzZXIucmVhZF91bnRpbCgvW15hLXpdLyk7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMuaW52YWxpZF90YWdfcGxhY2VtZW50KGxvY2F0aW9uLCBuYW1lKSwgaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmx1c2gocGFyc2VyLmluZGV4IC0gMSk7XG4gICAgICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgY29uc3QgZXhwcmVzc2lvbiA9IHJlYWRfZXhwcmVzc2lvbihwYXJzZXIpO1xuICAgICAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIHBhcnNlci5lYXQoJ30nLCB0cnVlKTtcbiAgICAgICAgICAgIGNodW5rcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBzdGFydDogaW5kZXgsXG4gICAgICAgICAgICAgICAgZW5kOiBwYXJzZXIuaW5kZXgsXG4gICAgICAgICAgICAgICAgdHlwZTogJ011c3RhY2hlVGFnJyxcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGN1cnJlbnRfY2h1bmsgPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IHBhcnNlci5pbmRleCxcbiAgICAgICAgICAgICAgICBlbmQ6IG51bGwsXG4gICAgICAgICAgICAgICAgdHlwZTogJ1RleHQnLFxuICAgICAgICAgICAgICAgIHJhdzogJycsXG4gICAgICAgICAgICAgICAgZGF0YTogbnVsbFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGN1cnJlbnRfY2h1bmsucmF3ICs9IHBhcnNlci50ZW1wbGF0ZVtwYXJzZXIuaW5kZXgrK107XG4gICAgICAgIH1cbiAgICB9XG4gICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMudW5leHBlY3RlZF9lb2YpO1xufVxuXG4vLyBBZGFwdGVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2Fjb3JuanMvYWNvcm4vYmxvYi82NTg0ODE1ZGNhNzQ0MGUwMGRlODQxZDFkYWQxNTIzMDJmZGQ3Y2E1L3NyYy90b2tlbml6ZS5qc1xuLy8gUmVwcm9kdWNlZCB1bmRlciBNSVQgTGljZW5zZSBodHRwczovL2dpdGh1Yi5jb20vYWNvcm5qcy9hY29ybi9ibG9iL21hc3Rlci9MSUNFTlNFXG5mdW5jdGlvbiBmdWxsX2NoYXJfY29kZV9hdChzdHIsIGkpIHtcbiAgICBjb25zdCBjb2RlID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgaWYgKGNvZGUgPD0gMHhkN2ZmIHx8IGNvZGUgPj0gMHhlMDAwKVxuICAgICAgICByZXR1cm4gY29kZTtcbiAgICBjb25zdCBuZXh0ID0gc3RyLmNoYXJDb2RlQXQoaSArIDEpO1xuICAgIHJldHVybiAoY29kZSA8PCAxMCkgKyBuZXh0IC0gMHgzNWZkYzAwO1xufVxuXG5jb25zdCBTUVVBUkVfQlJBQ0tFVF9PUEVOID0gJ1snLmNoYXJDb2RlQXQoMCk7XG5jb25zdCBTUVVBUkVfQlJBQ0tFVF9DTE9TRSA9ICddJy5jaGFyQ29kZUF0KDApO1xuY29uc3QgQ1VSTFlfQlJBQ0tFVF9PUEVOID0gJ3snLmNoYXJDb2RlQXQoMCk7XG5jb25zdCBDVVJMWV9CUkFDS0VUX0NMT1NFID0gJ30nLmNoYXJDb2RlQXQoMCk7XG5mdW5jdGlvbiBpc19icmFja2V0X29wZW4oY29kZSkge1xuICAgIHJldHVybiBjb2RlID09PSBTUVVBUkVfQlJBQ0tFVF9PUEVOIHx8IGNvZGUgPT09IENVUkxZX0JSQUNLRVRfT1BFTjtcbn1cbmZ1bmN0aW9uIGlzX2JyYWNrZXRfY2xvc2UoY29kZSkge1xuICAgIHJldHVybiBjb2RlID09PSBTUVVBUkVfQlJBQ0tFVF9DTE9TRSB8fCBjb2RlID09PSBDVVJMWV9CUkFDS0VUX0NMT1NFO1xufVxuZnVuY3Rpb24gaXNfYnJhY2tldF9wYWlyKG9wZW4sIGNsb3NlKSB7XG4gICAgcmV0dXJuICgob3BlbiA9PT0gU1FVQVJFX0JSQUNLRVRfT1BFTiAmJiBjbG9zZSA9PT0gU1FVQVJFX0JSQUNLRVRfQ0xPU0UpIHx8XG4gICAgICAgIChvcGVuID09PSBDVVJMWV9CUkFDS0VUX09QRU4gJiYgY2xvc2UgPT09IENVUkxZX0JSQUNLRVRfQ0xPU0UpKTtcbn1cbmZ1bmN0aW9uIGdldF9icmFja2V0X2Nsb3NlKG9wZW4pIHtcbiAgICBpZiAob3BlbiA9PT0gU1FVQVJFX0JSQUNLRVRfT1BFTikge1xuICAgICAgICByZXR1cm4gU1FVQVJFX0JSQUNLRVRfQ0xPU0U7XG4gICAgfVxuICAgIGlmIChvcGVuID09PSBDVVJMWV9CUkFDS0VUX09QRU4pIHtcbiAgICAgICAgcmV0dXJuIENVUkxZX0JSQUNLRVRfQ0xPU0U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiByZWFkX2NvbnRleHQocGFyc2VyKSB7XG4gICAgY29uc3Qgc3RhcnQgPSBwYXJzZXIuaW5kZXg7XG4gICAgbGV0IGkgPSBwYXJzZXIuaW5kZXg7XG4gICAgY29uc3QgY29kZSA9IGZ1bGxfY2hhcl9jb2RlX2F0KHBhcnNlci50ZW1wbGF0ZSwgaSk7XG4gICAgaWYgKGlzSWRlbnRpZmllclN0YXJ0KGNvZGUsIHRydWUpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnSWRlbnRpZmllcicsXG4gICAgICAgICAgICBuYW1lOiBwYXJzZXIucmVhZF9pZGVudGlmaWVyKCksXG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZDogcGFyc2VyLmluZGV4XG4gICAgICAgIH07XG4gICAgfVxuICAgIGlmICghaXNfYnJhY2tldF9vcGVuKGNvZGUpKSB7XG4gICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLnVuZXhwZWN0ZWRfdG9rZW5fZGVzdHJ1Y3R1cmUpO1xuICAgIH1cbiAgICBjb25zdCBicmFja2V0X3N0YWNrID0gW2NvZGVdO1xuICAgIGkgKz0gY29kZSA8PSAweGZmZmYgPyAxIDogMjtcbiAgICB3aGlsZSAoaSA8IHBhcnNlci50ZW1wbGF0ZS5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgY29kZSA9IGZ1bGxfY2hhcl9jb2RlX2F0KHBhcnNlci50ZW1wbGF0ZSwgaSk7XG4gICAgICAgIGlmIChpc19icmFja2V0X29wZW4oY29kZSkpIHtcbiAgICAgICAgICAgIGJyYWNrZXRfc3RhY2sucHVzaChjb2RlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc19icmFja2V0X2Nsb3NlKGNvZGUpKSB7XG4gICAgICAgICAgICBpZiAoIWlzX2JyYWNrZXRfcGFpcihicmFja2V0X3N0YWNrW2JyYWNrZXRfc3RhY2subGVuZ3RoIC0gMV0sIGNvZGUpKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMudW5leHBlY3RlZF90b2tlbihTdHJpbmcuZnJvbUNoYXJDb2RlKGdldF9icmFja2V0X2Nsb3NlKGJyYWNrZXRfc3RhY2tbYnJhY2tldF9zdGFjay5sZW5ndGggLSAxXSkpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmFja2V0X3N0YWNrLnBvcCgpO1xuICAgICAgICAgICAgaWYgKGJyYWNrZXRfc3RhY2subGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgaSArPSBjb2RlIDw9IDB4ZmZmZiA/IDEgOiAyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGkgKz0gY29kZSA8PSAweGZmZmYgPyAxIDogMjtcbiAgICB9XG4gICAgcGFyc2VyLmluZGV4ID0gaTtcbiAgICBjb25zdCBwYXR0ZXJuX3N0cmluZyA9IHBhcnNlci50ZW1wbGF0ZS5zbGljZShzdGFydCwgaSk7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gdGhlIGxlbmd0aCBvZiB0aGUgYHNwYWNlX3dpdGhfbmV3bGluZWAgaGFzIHRvIGJlIHN0YXJ0IC0gMVxuICAgICAgICAvLyBiZWNhdXNlIHdlIGFkZGVkIGEgYChgIGluIGZyb250IG9mIHRoZSBwYXR0ZXJuX3N0cmluZyxcbiAgICAgICAgLy8gd2hpY2ggc2hpZnRlZCB0aGUgZW50aXJlIHN0cmluZyB0byByaWdodCBieSAxXG4gICAgICAgIC8vIHNvIHdlIG9mZnNldCBpdCBieSByZW1vdmluZyAxIGNoYXJhY3RlciBpbiB0aGUgYHNwYWNlX3dpdGhfbmV3bGluZWBcbiAgICAgICAgLy8gdG8gYWNoaWV2ZSB0aGF0LCB3ZSByZW1vdmUgdGhlIDFzdCBzcGFjZSBlbmNvdW50ZXJlZCxcbiAgICAgICAgLy8gc28gaXQgd2lsbCBub3QgYWZmZWN0IHRoZSBgY29sdW1uYCBvZiB0aGUgbm9kZVxuICAgICAgICBsZXQgc3BhY2Vfd2l0aF9uZXdsaW5lID0gcGFyc2VyLnRlbXBsYXRlLnNsaWNlKDAsIHN0YXJ0KS5yZXBsYWNlKHJlZ2V4X25vdF9uZXdsaW5lX2NoYXJhY3RlcnMsICcgJyk7XG4gICAgICAgIGNvbnN0IGZpcnN0X3NwYWNlID0gc3BhY2Vfd2l0aF9uZXdsaW5lLmluZGV4T2YoJyAnKTtcbiAgICAgICAgc3BhY2Vfd2l0aF9uZXdsaW5lID0gc3BhY2Vfd2l0aF9uZXdsaW5lLnNsaWNlKDAsIGZpcnN0X3NwYWNlKSArIHNwYWNlX3dpdGhfbmV3bGluZS5zbGljZShmaXJzdF9zcGFjZSArIDEpO1xuICAgICAgICByZXR1cm4gcGFyc2VfZXhwcmVzc2lvbl9hdChgJHtzcGFjZV93aXRoX25ld2xpbmV9KCR7cGF0dGVybl9zdHJpbmd9ID0gMSlgLCBzdGFydCAtIDEpLmxlZnQ7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBwYXJzZXIuYWNvcm5fZXJyb3IoZXJyb3IpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdHJpbV9zdGFydChzdHIpIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UocmVnZXhfc3RhcnRzX3dpdGhfd2hpdGVzcGFjZXMsICcnKTtcbn1cbmZ1bmN0aW9uIHRyaW1fZW5kKHN0cikge1xuICAgIHJldHVybiBzdHIucmVwbGFjZShyZWdleF9lbmRzX3dpdGhfd2hpdGVzcGFjZXMsICcnKTtcbn1cblxuZnVuY3Rpb24gdG9fc3RyaW5nKG5vZGUpIHtcbiAgICBzd2l0Y2ggKG5vZGUudHlwZSkge1xuICAgICAgICBjYXNlICdJZkJsb2NrJzpcbiAgICAgICAgICAgIHJldHVybiAneyNpZn0gYmxvY2snO1xuICAgICAgICBjYXNlICdUaGVuQmxvY2snOlxuICAgICAgICAgICAgcmV0dXJuICd7OnRoZW59IGJsb2NrJztcbiAgICAgICAgY2FzZSAnRWxzZUJsb2NrJzpcbiAgICAgICAgICAgIHJldHVybiAnezplbHNlfSBibG9jayc7XG4gICAgICAgIGNhc2UgJ1BlbmRpbmdCbG9jayc6XG4gICAgICAgIGNhc2UgJ0F3YWl0QmxvY2snOlxuICAgICAgICAgICAgcmV0dXJuICd7I2F3YWl0fSBibG9jayc7XG4gICAgICAgIGNhc2UgJ0NhdGNoQmxvY2snOlxuICAgICAgICAgICAgcmV0dXJuICd7OmNhdGNofSBibG9jayc7XG4gICAgICAgIGNhc2UgJ0VhY2hCbG9jayc6XG4gICAgICAgICAgICByZXR1cm4gJ3sjZWFjaH0gYmxvY2snO1xuICAgICAgICBjYXNlICdSYXdNdXN0YWNoZVRhZyc6XG4gICAgICAgICAgICByZXR1cm4gJ3tAaHRtbH0gYmxvY2snO1xuICAgICAgICBjYXNlICdEZWJ1Z1RhZyc6XG4gICAgICAgICAgICByZXR1cm4gJ3tAZGVidWd9IGJsb2NrJztcbiAgICAgICAgY2FzZSAnQ29uc3RUYWcnOlxuICAgICAgICAgICAgcmV0dXJuICd7QGNvbnN0fSB0YWcnO1xuICAgICAgICBjYXNlICdFbGVtZW50JzpcbiAgICAgICAgY2FzZSAnSW5saW5lQ29tcG9uZW50JzpcbiAgICAgICAgY2FzZSAnU2xvdCc6XG4gICAgICAgIGNhc2UgJ1RpdGxlJzpcbiAgICAgICAgICAgIHJldHVybiBgPCR7bm9kZS5uYW1lfT4gdGFnYDtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBub2RlLnR5cGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0cmltX3doaXRlc3BhY2UoYmxvY2ssIHRyaW1fYmVmb3JlLCB0cmltX2FmdGVyKSB7XG4gICAgaWYgKCFibG9jay5jaGlsZHJlbiB8fCBibG9jay5jaGlsZHJlbi5sZW5ndGggPT09IDApXG4gICAgICAgIHJldHVybjsgLy8gQXdhaXRCbG9ja1xuICAgIGNvbnN0IGZpcnN0X2NoaWxkID0gYmxvY2suY2hpbGRyZW5bMF07XG4gICAgY29uc3QgbGFzdF9jaGlsZCA9IGJsb2NrLmNoaWxkcmVuW2Jsb2NrLmNoaWxkcmVuLmxlbmd0aCAtIDFdO1xuICAgIGlmIChmaXJzdF9jaGlsZC50eXBlID09PSAnVGV4dCcgJiYgdHJpbV9iZWZvcmUpIHtcbiAgICAgICAgZmlyc3RfY2hpbGQuZGF0YSA9IHRyaW1fc3RhcnQoZmlyc3RfY2hpbGQuZGF0YSk7XG4gICAgICAgIGlmICghZmlyc3RfY2hpbGQuZGF0YSlcbiAgICAgICAgICAgIGJsb2NrLmNoaWxkcmVuLnNoaWZ0KCk7XG4gICAgfVxuICAgIGlmIChsYXN0X2NoaWxkLnR5cGUgPT09ICdUZXh0JyAmJiB0cmltX2FmdGVyKSB7XG4gICAgICAgIGxhc3RfY2hpbGQuZGF0YSA9IHRyaW1fZW5kKGxhc3RfY2hpbGQuZGF0YSk7XG4gICAgICAgIGlmICghbGFzdF9jaGlsZC5kYXRhKVxuICAgICAgICAgICAgYmxvY2suY2hpbGRyZW4ucG9wKCk7XG4gICAgfVxuICAgIGlmIChibG9jay5lbHNlKSB7XG4gICAgICAgIHRyaW1fd2hpdGVzcGFjZShibG9jay5lbHNlLCB0cmltX2JlZm9yZSwgdHJpbV9hZnRlcik7XG4gICAgfVxuICAgIGlmIChmaXJzdF9jaGlsZC5lbHNlaWYpIHtcbiAgICAgICAgdHJpbV93aGl0ZXNwYWNlKGZpcnN0X2NoaWxkLCB0cmltX2JlZm9yZSwgdHJpbV9hZnRlcik7XG4gICAgfVxufVxuY29uc3QgcmVnZXhfd2hpdGVzcGFjZV93aXRoX2Nsb3NpbmdfY3VybHlfYnJhY2UgPSAvXFxzKn0vO1xuZnVuY3Rpb24gbXVzdGFjaGUocGFyc2VyKSB7XG4gICAgY29uc3Qgc3RhcnQgPSBwYXJzZXIuaW5kZXg7XG4gICAgcGFyc2VyLmluZGV4ICs9IDE7XG4gICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAvLyB7L2lmfSwgey9lYWNofSwgey9hd2FpdH0gb3Igey9rZXl9XG4gICAgaWYgKHBhcnNlci5lYXQoJy8nKSkge1xuICAgICAgICBsZXQgYmxvY2sgPSBwYXJzZXIuY3VycmVudCgpO1xuICAgICAgICBsZXQgZXhwZWN0ZWQ7XG4gICAgICAgIGlmIChjbG9zaW5nX3RhZ19vbWl0dGVkKGJsb2NrLm5hbWUpKSB7XG4gICAgICAgICAgICBibG9jay5lbmQgPSBzdGFydDtcbiAgICAgICAgICAgIHBhcnNlci5zdGFjay5wb3AoKTtcbiAgICAgICAgICAgIGJsb2NrID0gcGFyc2VyLmN1cnJlbnQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmxvY2sudHlwZSA9PT0gJ0Vsc2VCbG9jaycgfHwgYmxvY2sudHlwZSA9PT0gJ1BlbmRpbmdCbG9jaycgfHwgYmxvY2sudHlwZSA9PT0gJ1RoZW5CbG9jaycgfHwgYmxvY2sudHlwZSA9PT0gJ0NhdGNoQmxvY2snKSB7XG4gICAgICAgICAgICBibG9jay5lbmQgPSBzdGFydDtcbiAgICAgICAgICAgIHBhcnNlci5zdGFjay5wb3AoKTtcbiAgICAgICAgICAgIGJsb2NrID0gcGFyc2VyLmN1cnJlbnQoKTtcbiAgICAgICAgICAgIGV4cGVjdGVkID0gJ2F3YWl0JztcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmxvY2sudHlwZSA9PT0gJ0lmQmxvY2snKSB7XG4gICAgICAgICAgICBleHBlY3RlZCA9ICdpZic7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYmxvY2sudHlwZSA9PT0gJ0VhY2hCbG9jaycpIHtcbiAgICAgICAgICAgIGV4cGVjdGVkID0gJ2VhY2gnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGJsb2NrLnR5cGUgPT09ICdBd2FpdEJsb2NrJykge1xuICAgICAgICAgICAgZXhwZWN0ZWQgPSAnYXdhaXQnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGJsb2NrLnR5cGUgPT09ICdLZXlCbG9jaycpIHtcbiAgICAgICAgICAgIGV4cGVjdGVkID0gJ2tleSc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy51bmV4cGVjdGVkX2Jsb2NrX2Nsb3NlKTtcbiAgICAgICAgfVxuICAgICAgICBwYXJzZXIuZWF0KGV4cGVjdGVkLCB0cnVlKTtcbiAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgcGFyc2VyLmVhdCgnfScsIHRydWUpO1xuICAgICAgICB3aGlsZSAoYmxvY2suZWxzZWlmKSB7XG4gICAgICAgICAgICBibG9jay5lbmQgPSBwYXJzZXIuaW5kZXg7XG4gICAgICAgICAgICBwYXJzZXIuc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBibG9jayA9IHBhcnNlci5jdXJyZW50KCk7XG4gICAgICAgICAgICBpZiAoYmxvY2suZWxzZSkge1xuICAgICAgICAgICAgICAgIGJsb2NrLmVsc2UuZW5kID0gc3RhcnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gc3RyaXAgbGVhZGluZy90cmFpbGluZyB3aGl0ZXNwYWNlIGFzIG5lY2Vzc2FyeVxuICAgICAgICBjb25zdCBjaGFyX2JlZm9yZSA9IHBhcnNlci50ZW1wbGF0ZVtibG9jay5zdGFydCAtIDFdO1xuICAgICAgICBjb25zdCBjaGFyX2FmdGVyID0gcGFyc2VyLnRlbXBsYXRlW3BhcnNlci5pbmRleF07XG4gICAgICAgIGNvbnN0IHRyaW1fYmVmb3JlID0gIWNoYXJfYmVmb3JlIHx8IHJlZ2V4X3doaXRlc3BhY2UudGVzdChjaGFyX2JlZm9yZSk7XG4gICAgICAgIGNvbnN0IHRyaW1fYWZ0ZXIgPSAhY2hhcl9hZnRlciB8fCByZWdleF93aGl0ZXNwYWNlLnRlc3QoY2hhcl9hZnRlcik7XG4gICAgICAgIHRyaW1fd2hpdGVzcGFjZShibG9jaywgdHJpbV9iZWZvcmUsIHRyaW1fYWZ0ZXIpO1xuICAgICAgICBibG9jay5lbmQgPSBwYXJzZXIuaW5kZXg7XG4gICAgICAgIHBhcnNlci5zdGFjay5wb3AoKTtcbiAgICB9XG4gICAgZWxzZSBpZiAocGFyc2VyLmVhdCgnOmVsc2UnKSkge1xuICAgICAgICBpZiAocGFyc2VyLmVhdCgnaWYnKSkge1xuICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMuaW52YWxpZF9lbHNlaWYpO1xuICAgICAgICB9XG4gICAgICAgIHBhcnNlci5hbGxvd193aGl0ZXNwYWNlKCk7XG4gICAgICAgIC8vIDplbHNlIGlmXG4gICAgICAgIGlmIChwYXJzZXIuZWF0KCdpZicpKSB7XG4gICAgICAgICAgICBjb25zdCBibG9jayA9IHBhcnNlci5jdXJyZW50KCk7XG4gICAgICAgICAgICBpZiAoYmxvY2sudHlwZSAhPT0gJ0lmQmxvY2snKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlci5zdGFjay5zb21lKGJsb2NrID0+IGJsb2NrLnR5cGUgPT09ICdJZkJsb2NrJylcbiAgICAgICAgICAgICAgICAgICAgPyBwYXJzZXJfZXJyb3JzLmludmFsaWRfZWxzZWlmX3BsYWNlbWVudF91bmNsb3NlZF9ibG9jayh0b19zdHJpbmcoYmxvY2spKVxuICAgICAgICAgICAgICAgICAgICA6IHBhcnNlcl9lcnJvcnMuaW52YWxpZF9lbHNlaWZfcGxhY2VtZW50X291dHNpZGVfaWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyc2VyLnJlcXVpcmVfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgY29uc3QgZXhwcmVzc2lvbiA9IHJlYWRfZXhwcmVzc2lvbihwYXJzZXIpO1xuICAgICAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIHBhcnNlci5lYXQoJ30nLCB0cnVlKTtcbiAgICAgICAgICAgIGJsb2NrLmVsc2UgPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IHBhcnNlci5pbmRleCxcbiAgICAgICAgICAgICAgICBlbmQ6IG51bGwsXG4gICAgICAgICAgICAgICAgdHlwZTogJ0Vsc2VCbG9jaycsXG4gICAgICAgICAgICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IHBhcnNlci5pbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdJZkJsb2NrJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW11cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBwYXJzZXIuc3RhY2sucHVzaChibG9jay5lbHNlLmNoaWxkcmVuWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIDplbHNlXG4gICAgICAgICAgICBjb25zdCBibG9jayA9IHBhcnNlci5jdXJyZW50KCk7XG4gICAgICAgICAgICBpZiAoYmxvY2sudHlwZSAhPT0gJ0lmQmxvY2snICYmIGJsb2NrLnR5cGUgIT09ICdFYWNoQmxvY2snKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlci5zdGFjay5zb21lKGJsb2NrID0+IGJsb2NrLnR5cGUgPT09ICdJZkJsb2NrJyB8fCBibG9jay50eXBlID09PSAnRWFjaEJsb2NrJylcbiAgICAgICAgICAgICAgICAgICAgPyBwYXJzZXJfZXJyb3JzLmludmFsaWRfZWxzZV9wbGFjZW1lbnRfdW5jbG9zZWRfYmxvY2sodG9fc3RyaW5nKGJsb2NrKSlcbiAgICAgICAgICAgICAgICAgICAgOiBwYXJzZXJfZXJyb3JzLmludmFsaWRfZWxzZV9wbGFjZW1lbnRfb3V0c2lkZV9pZik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgcGFyc2VyLmVhdCgnfScsIHRydWUpO1xuICAgICAgICAgICAgYmxvY2suZWxzZSA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogcGFyc2VyLmluZGV4LFxuICAgICAgICAgICAgICAgIGVuZDogbnVsbCxcbiAgICAgICAgICAgICAgICB0eXBlOiAnRWxzZUJsb2NrJyxcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogW11cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBwYXJzZXIuc3RhY2sucHVzaChibG9jay5lbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChwYXJzZXIubWF0Y2goJzp0aGVuJykgfHwgcGFyc2VyLm1hdGNoKCc6Y2F0Y2gnKSkge1xuICAgICAgICBjb25zdCBibG9jayA9IHBhcnNlci5jdXJyZW50KCk7XG4gICAgICAgIGNvbnN0IGlzX3RoZW4gPSBwYXJzZXIuZWF0KCc6dGhlbicpIHx8ICFwYXJzZXIuZWF0KCc6Y2F0Y2gnKTtcbiAgICAgICAgaWYgKGlzX3RoZW4pIHtcbiAgICAgICAgICAgIGlmIChibG9jay50eXBlICE9PSAnUGVuZGluZ0Jsb2NrJykge1xuICAgICAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXIuc3RhY2suc29tZShibG9jayA9PiBibG9jay50eXBlID09PSAnUGVuZGluZ0Jsb2NrJylcbiAgICAgICAgICAgICAgICAgICAgPyBwYXJzZXJfZXJyb3JzLmludmFsaWRfdGhlbl9wbGFjZW1lbnRfdW5jbG9zZWRfYmxvY2sodG9fc3RyaW5nKGJsb2NrKSlcbiAgICAgICAgICAgICAgICAgICAgOiBwYXJzZXJfZXJyb3JzLmludmFsaWRfdGhlbl9wbGFjZW1lbnRfd2l0aG91dF9hd2FpdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoYmxvY2sudHlwZSAhPT0gJ1RoZW5CbG9jaycgJiYgYmxvY2sudHlwZSAhPT0gJ1BlbmRpbmdCbG9jaycpIHtcbiAgICAgICAgICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyLnN0YWNrLnNvbWUoYmxvY2sgPT4gYmxvY2sudHlwZSA9PT0gJ1RoZW5CbG9jaycgfHwgYmxvY2sudHlwZSA9PT0gJ1BlbmRpbmdCbG9jaycpXG4gICAgICAgICAgICAgICAgICAgID8gcGFyc2VyX2Vycm9ycy5pbnZhbGlkX2NhdGNoX3BsYWNlbWVudF91bmNsb3NlZF9ibG9jayh0b19zdHJpbmcoYmxvY2spKVxuICAgICAgICAgICAgICAgICAgICA6IHBhcnNlcl9lcnJvcnMuaW52YWxpZF9jYXRjaF9wbGFjZW1lbnRfd2l0aG91dF9hd2FpdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2suZW5kID0gc3RhcnQ7XG4gICAgICAgIHBhcnNlci5zdGFjay5wb3AoKTtcbiAgICAgICAgY29uc3QgYXdhaXRfYmxvY2sgPSBwYXJzZXIuY3VycmVudCgpO1xuICAgICAgICBpZiAoIXBhcnNlci5lYXQoJ30nKSkge1xuICAgICAgICAgICAgcGFyc2VyLnJlcXVpcmVfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgYXdhaXRfYmxvY2tbaXNfdGhlbiA/ICd2YWx1ZScgOiAnZXJyb3InXSA9IHJlYWRfY29udGV4dChwYXJzZXIpO1xuICAgICAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIHBhcnNlci5lYXQoJ30nLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuZXdfYmxvY2sgPSB7XG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGlzX3RoZW4gPyAnVGhlbkJsb2NrJyA6ICdDYXRjaEJsb2NrJyxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcbiAgICAgICAgICAgIHNraXA6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIGF3YWl0X2Jsb2NrW2lzX3RoZW4gPyAndGhlbicgOiAnY2F0Y2gnXSA9IG5ld19ibG9jaztcbiAgICAgICAgcGFyc2VyLnN0YWNrLnB1c2gobmV3X2Jsb2NrKTtcbiAgICB9XG4gICAgZWxzZSBpZiAocGFyc2VyLmVhdCgnIycpKSB7XG4gICAgICAgIC8vIHsjaWYgZm9vfSwgeyNlYWNoIGZvb30gb3IgeyNhd2FpdCBmb299XG4gICAgICAgIGxldCB0eXBlO1xuICAgICAgICBpZiAocGFyc2VyLmVhdCgnaWYnKSkge1xuICAgICAgICAgICAgdHlwZSA9ICdJZkJsb2NrJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwYXJzZXIuZWF0KCdlYWNoJykpIHtcbiAgICAgICAgICAgIHR5cGUgPSAnRWFjaEJsb2NrJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwYXJzZXIuZWF0KCdhd2FpdCcpKSB7XG4gICAgICAgICAgICB0eXBlID0gJ0F3YWl0QmxvY2snO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhcnNlci5lYXQoJ2tleScpKSB7XG4gICAgICAgICAgICB0eXBlID0gJ0tleUJsb2NrJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmV4cGVjdGVkX2Jsb2NrX3R5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHBhcnNlci5yZXF1aXJlX3doaXRlc3BhY2UoKTtcbiAgICAgICAgY29uc3QgZXhwcmVzc2lvbiA9IHJlYWRfZXhwcmVzc2lvbihwYXJzZXIpO1xuICAgICAgICBjb25zdCBibG9jayA9IHR5cGUgPT09ICdBd2FpdEJsb2NrJyA/XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhcnQsXG4gICAgICAgICAgICAgICAgZW5kOiBudWxsLFxuICAgICAgICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgICAgICAgZXhwcmVzc2lvbixcbiAgICAgICAgICAgICAgICB2YWx1ZTogbnVsbCxcbiAgICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgICAgICBwZW5kaW5nOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBlbmQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQZW5kaW5nQmxvY2snLFxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW10sXG4gICAgICAgICAgICAgICAgICAgIHNraXA6IHRydWVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRoZW46IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGVuZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1RoZW5CbG9jaycsXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgc2tpcDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY2F0Y2g6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGVuZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0NhdGNoQmxvY2snLFxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW10sXG4gICAgICAgICAgICAgICAgICAgIHNraXA6IHRydWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgICAgICBlbmQ6IG51bGwsXG4gICAgICAgICAgICAgICAgdHlwZSxcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uLFxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgLy8geyNlYWNofSBibG9ja3MgbXVzdCBkZWNsYXJlIGEgY29udGV4dCDigJMgeyNlYWNoIGxpc3QgYXMgaXRlbX1cbiAgICAgICAgaWYgKHR5cGUgPT09ICdFYWNoQmxvY2snKSB7XG4gICAgICAgICAgICBwYXJzZXIuZWF0KCdhcycsIHRydWUpO1xuICAgICAgICAgICAgcGFyc2VyLnJlcXVpcmVfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgYmxvY2suY29udGV4dCA9IHJlYWRfY29udGV4dChwYXJzZXIpO1xuICAgICAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIGlmIChwYXJzZXIuZWF0KCcsJykpIHtcbiAgICAgICAgICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgICAgIGJsb2NrLmluZGV4ID0gcGFyc2VyLnJlYWRfaWRlbnRpZmllcigpO1xuICAgICAgICAgICAgICAgIGlmICghYmxvY2suaW5kZXgpXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmV4cGVjdGVkX25hbWUpO1xuICAgICAgICAgICAgICAgIHBhcnNlci5hbGxvd193aGl0ZXNwYWNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocGFyc2VyLmVhdCgnKCcpKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgICAgICAgICBibG9jay5rZXkgPSByZWFkX2V4cHJlc3Npb24ocGFyc2VyKTtcbiAgICAgICAgICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgICAgIHBhcnNlci5lYXQoJyknLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGF3YWl0X2Jsb2NrX3Nob3J0aGFuZCA9IHR5cGUgPT09ICdBd2FpdEJsb2NrJyAmJiBwYXJzZXIuZWF0KCd0aGVuJyk7XG4gICAgICAgIGlmIChhd2FpdF9ibG9ja19zaG9ydGhhbmQpIHtcbiAgICAgICAgICAgIGlmIChwYXJzZXIubWF0Y2hfcmVnZXgocmVnZXhfd2hpdGVzcGFjZV93aXRoX2Nsb3NpbmdfY3VybHlfYnJhY2UpKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhcnNlci5yZXF1aXJlX3doaXRlc3BhY2UoKTtcbiAgICAgICAgICAgICAgICBibG9jay52YWx1ZSA9IHJlYWRfY29udGV4dChwYXJzZXIpO1xuICAgICAgICAgICAgICAgIHBhcnNlci5hbGxvd193aGl0ZXNwYWNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXdhaXRfYmxvY2tfY2F0Y2hfc2hvcnRoYW5kID0gIWF3YWl0X2Jsb2NrX3Nob3J0aGFuZCAmJiB0eXBlID09PSAnQXdhaXRCbG9jaycgJiYgcGFyc2VyLmVhdCgnY2F0Y2gnKTtcbiAgICAgICAgaWYgKGF3YWl0X2Jsb2NrX2NhdGNoX3Nob3J0aGFuZCkge1xuICAgICAgICAgICAgaWYgKHBhcnNlci5tYXRjaF9yZWdleChyZWdleF93aGl0ZXNwYWNlX3dpdGhfY2xvc2luZ19jdXJseV9icmFjZSkpIHtcbiAgICAgICAgICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyc2VyLnJlcXVpcmVfd2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgICAgIGJsb2NrLmVycm9yID0gcmVhZF9jb250ZXh0KHBhcnNlcik7XG4gICAgICAgICAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBwYXJzZXIuZWF0KCd9JywgdHJ1ZSk7XG4gICAgICAgIHBhcnNlci5jdXJyZW50KCkuY2hpbGRyZW4ucHVzaChibG9jayk7XG4gICAgICAgIHBhcnNlci5zdGFjay5wdXNoKGJsb2NrKTtcbiAgICAgICAgaWYgKHR5cGUgPT09ICdBd2FpdEJsb2NrJykge1xuICAgICAgICAgICAgbGV0IGNoaWxkX2Jsb2NrO1xuICAgICAgICAgICAgaWYgKGF3YWl0X2Jsb2NrX3Nob3J0aGFuZCkge1xuICAgICAgICAgICAgICAgIGJsb2NrLnRoZW4uc2tpcCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNoaWxkX2Jsb2NrID0gYmxvY2sudGhlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGF3YWl0X2Jsb2NrX2NhdGNoX3Nob3J0aGFuZCkge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNhdGNoLnNraXAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjaGlsZF9ibG9jayA9IGJsb2NrLmNhdGNoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYmxvY2sucGVuZGluZy5za2lwID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgY2hpbGRfYmxvY2sgPSBibG9jay5wZW5kaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hpbGRfYmxvY2suc3RhcnQgPSBwYXJzZXIuaW5kZXg7XG4gICAgICAgICAgICBwYXJzZXIuc3RhY2sucHVzaChjaGlsZF9ibG9jayk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAocGFyc2VyLmVhdCgnQGh0bWwnKSkge1xuICAgICAgICAvLyB7QGh0bWwgY29udGVudH0gdGFnXG4gICAgICAgIHBhcnNlci5yZXF1aXJlX3doaXRlc3BhY2UoKTtcbiAgICAgICAgY29uc3QgZXhwcmVzc2lvbiA9IHJlYWRfZXhwcmVzc2lvbihwYXJzZXIpO1xuICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICBwYXJzZXIuZWF0KCd9JywgdHJ1ZSk7XG4gICAgICAgIHBhcnNlci5jdXJyZW50KCkuY2hpbGRyZW4ucHVzaCh7XG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZDogcGFyc2VyLmluZGV4LFxuICAgICAgICAgICAgdHlwZTogJ1Jhd011c3RhY2hlVGFnJyxcbiAgICAgICAgICAgIGV4cHJlc3Npb25cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHBhcnNlci5lYXQoJ0BkZWJ1ZycpKSB7XG4gICAgICAgIGxldCBpZGVudGlmaWVycztcbiAgICAgICAgLy8gSW1wbGllcyB7QGRlYnVnfSB3aGljaCBpbmRpY2F0ZXMgXCJkZWJ1ZyBhbGxcIlxuICAgICAgICBpZiAocGFyc2VyLnJlYWQocmVnZXhfd2hpdGVzcGFjZV93aXRoX2Nsb3NpbmdfY3VybHlfYnJhY2UpKSB7XG4gICAgICAgICAgICBpZGVudGlmaWVycyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZXhwcmVzc2lvbiA9IHJlYWRfZXhwcmVzc2lvbihwYXJzZXIpO1xuICAgICAgICAgICAgaWRlbnRpZmllcnMgPSBleHByZXNzaW9uLnR5cGUgPT09ICdTZXF1ZW5jZUV4cHJlc3Npb24nXG4gICAgICAgICAgICAgICAgPyBleHByZXNzaW9uLmV4cHJlc3Npb25zXG4gICAgICAgICAgICAgICAgOiBbZXhwcmVzc2lvbl07XG4gICAgICAgICAgICBpZGVudGlmaWVycy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgIT09ICdJZGVudGlmaWVyJykge1xuICAgICAgICAgICAgICAgICAgICBwYXJzZXIuZXJyb3IocGFyc2VyX2Vycm9ycy5pbnZhbGlkX2RlYnVnX2FyZ3MsIG5vZGUuc3RhcnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcGFyc2VyLmFsbG93X3doaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIHBhcnNlci5lYXQoJ30nLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBwYXJzZXIuY3VycmVudCgpLmNoaWxkcmVuLnB1c2goe1xuICAgICAgICAgICAgc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IHBhcnNlci5pbmRleCxcbiAgICAgICAgICAgIHR5cGU6ICdEZWJ1Z1RhZycsXG4gICAgICAgICAgICBpZGVudGlmaWVyc1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAocGFyc2VyLmVhdCgnQGNvbnN0JykpIHtcbiAgICAgICAgLy8ge0Bjb25zdCBhID0gYn1cbiAgICAgICAgcGFyc2VyLnJlcXVpcmVfd2hpdGVzcGFjZSgpO1xuICAgICAgICBjb25zdCBleHByZXNzaW9uID0gcmVhZF9leHByZXNzaW9uKHBhcnNlcik7XG4gICAgICAgIGlmICghKGV4cHJlc3Npb24udHlwZSA9PT0gJ0Fzc2lnbm1lbnRFeHByZXNzaW9uJyAmJiBleHByZXNzaW9uLm9wZXJhdG9yID09PSAnPScpKSB7XG4gICAgICAgICAgICBwYXJzZXIuZXJyb3Ioe1xuICAgICAgICAgICAgICAgIGNvZGU6ICdpbnZhbGlkLWNvbnN0LWFyZ3MnLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICd7QGNvbnN0IC4uLn0gbXVzdCBiZSBhbiBhc3NpZ25tZW50LidcbiAgICAgICAgICAgIH0sIHN0YXJ0KTtcbiAgICAgICAgfVxuICAgICAgICBwYXJzZXIuYWxsb3dfd2hpdGVzcGFjZSgpO1xuICAgICAgICBwYXJzZXIuZWF0KCd9JywgdHJ1ZSk7XG4gICAgICAgIHBhcnNlci5jdXJyZW50KCkuY2hpbGRyZW4ucHVzaCh7XG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZDogcGFyc2VyLmluZGV4LFxuICAgICAgICAgICAgdHlwZTogJ0NvbnN0VGFnJyxcbiAgICAgICAgICAgIGV4cHJlc3Npb25cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCBleHByZXNzaW9uID0gcmVhZF9leHByZXNzaW9uKHBhcnNlcik7XG4gICAgICAgIHBhcnNlci5hbGxvd193aGl0ZXNwYWNlKCk7XG4gICAgICAgIHBhcnNlci5lYXQoJ30nLCB0cnVlKTtcbiAgICAgICAgcGFyc2VyLmN1cnJlbnQoKS5jaGlsZHJlbi5wdXNoKHtcbiAgICAgICAgICAgIHN0YXJ0LFxuICAgICAgICAgICAgZW5kOiBwYXJzZXIuaW5kZXgsXG4gICAgICAgICAgICB0eXBlOiAnTXVzdGFjaGVUYWcnLFxuICAgICAgICAgICAgZXhwcmVzc2lvblxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRleHQocGFyc2VyKSB7XG4gICAgY29uc3Qgc3RhcnQgPSBwYXJzZXIuaW5kZXg7XG4gICAgbGV0IGRhdGEgPSAnJztcbiAgICB3aGlsZSAocGFyc2VyLmluZGV4IDwgcGFyc2VyLnRlbXBsYXRlLmxlbmd0aCAmJlxuICAgICAgICAhcGFyc2VyLm1hdGNoKCc8JykgJiZcbiAgICAgICAgIXBhcnNlci5tYXRjaCgneycpKSB7XG4gICAgICAgIGRhdGEgKz0gcGFyc2VyLnRlbXBsYXRlW3BhcnNlci5pbmRleCsrXTtcbiAgICB9XG4gICAgY29uc3Qgbm9kZSA9IHtcbiAgICAgICAgc3RhcnQsXG4gICAgICAgIGVuZDogcGFyc2VyLmluZGV4LFxuICAgICAgICB0eXBlOiAnVGV4dCcsXG4gICAgICAgIHJhdzogZGF0YSxcbiAgICAgICAgZGF0YTogZGVjb2RlX2NoYXJhY3Rlcl9yZWZlcmVuY2VzKGRhdGEpXG4gICAgfTtcbiAgICBwYXJzZXIuY3VycmVudCgpLmNoaWxkcmVuLnB1c2gobm9kZSk7XG59XG5cbmZ1bmN0aW9uIGZyYWdtZW50KHBhcnNlcikge1xuICAgIGlmIChwYXJzZXIubWF0Y2goJzwnKSkge1xuICAgICAgICByZXR1cm4gdGFnO1xuICAgIH1cbiAgICBpZiAocGFyc2VyLm1hdGNoKCd7JykpIHtcbiAgICAgICAgcmV0dXJuIG11c3RhY2hlO1xuICAgIH1cbiAgICByZXR1cm4gdGV4dDtcbn1cblxuY29uc3QgcmVzZXJ2ZWQgPSBuZXcgU2V0KFtcbiAgICAnYXJndW1lbnRzJyxcbiAgICAnYXdhaXQnLFxuICAgICdicmVhaycsXG4gICAgJ2Nhc2UnLFxuICAgICdjYXRjaCcsXG4gICAgJ2NsYXNzJyxcbiAgICAnY29uc3QnLFxuICAgICdjb250aW51ZScsXG4gICAgJ2RlYnVnZ2VyJyxcbiAgICAnZGVmYXVsdCcsXG4gICAgJ2RlbGV0ZScsXG4gICAgJ2RvJyxcbiAgICAnZWxzZScsXG4gICAgJ2VudW0nLFxuICAgICdldmFsJyxcbiAgICAnZXhwb3J0JyxcbiAgICAnZXh0ZW5kcycsXG4gICAgJ2ZhbHNlJyxcbiAgICAnZmluYWxseScsXG4gICAgJ2ZvcicsXG4gICAgJ2Z1bmN0aW9uJyxcbiAgICAnaWYnLFxuICAgICdpbXBsZW1lbnRzJyxcbiAgICAnaW1wb3J0JyxcbiAgICAnaW4nLFxuICAgICdpbnN0YW5jZW9mJyxcbiAgICAnaW50ZXJmYWNlJyxcbiAgICAnbGV0JyxcbiAgICAnbmV3JyxcbiAgICAnbnVsbCcsXG4gICAgJ3BhY2thZ2UnLFxuICAgICdwcml2YXRlJyxcbiAgICAncHJvdGVjdGVkJyxcbiAgICAncHVibGljJyxcbiAgICAncmV0dXJuJyxcbiAgICAnc3RhdGljJyxcbiAgICAnc3VwZXInLFxuICAgICdzd2l0Y2gnLFxuICAgICd0aGlzJyxcbiAgICAndGhyb3cnLFxuICAgICd0cnVlJyxcbiAgICAndHJ5JyxcbiAgICAndHlwZW9mJyxcbiAgICAndmFyJyxcbiAgICAndm9pZCcsXG4gICAgJ3doaWxlJyxcbiAgICAnd2l0aCcsXG4gICAgJ3lpZWxkJ1xuXSk7XG5mdW5jdGlvbiBpc192YWxpZChzdHIpIHtcbiAgICBsZXQgaSA9IDA7XG4gICAgd2hpbGUgKGkgPCBzdHIubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGNvZGUgPSBmdWxsX2NoYXJfY29kZV9hdChzdHIsIGkpO1xuICAgICAgICBpZiAoIShpID09PSAwID8gaXNJZGVudGlmaWVyU3RhcnQgOiBpc0lkZW50aWZpZXJDaGFyKShjb2RlLCB0cnVlKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgaSArPSBjb2RlIDw9IDB4ZmZmZiA/IDEgOiAyO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmNvbnN0IHJlZ2V4X25vbl9zdGFuZGFyZF9jaGFyYWN0ZXJzID0gL1teYS16QS1aMC05X10rL2c7XG5jb25zdCByZWdleF9zdGFydHNfd2l0aF9udW1iZXIgPSAvXlswLTldLztcbmZ1bmN0aW9uIHNhbml0aXplKG5hbWUpIHtcbiAgICByZXR1cm4gbmFtZVxuICAgICAgICAucmVwbGFjZShyZWdleF9ub25fc3RhbmRhcmRfY2hhcmFjdGVycywgJ18nKVxuICAgICAgICAucmVwbGFjZShyZWdleF9zdGFydHNfd2l0aF91bmRlcnNjb3JlLCAnJylcbiAgICAgICAgLnJlcGxhY2UocmVnZXhfZW5kc193aXRoX3VuZGVyc2NvcmUsICcnKVxuICAgICAgICAucmVwbGFjZShyZWdleF9zdGFydHNfd2l0aF9udW1iZXIsICdfJCYnKTtcbn1cblxuZnVuY3Rpb24gZ2V0TG9jYXRvcihzb3VyY2UsIG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxuICAgIHZhciBvZmZzZXRMaW5lID0gb3B0aW9ucy5vZmZzZXRMaW5lIHx8IDA7XG4gICAgdmFyIG9mZnNldENvbHVtbiA9IG9wdGlvbnMub2Zmc2V0Q29sdW1uIHx8IDA7XG4gICAgdmFyIG9yaWdpbmFsTGluZXMgPSBzb3VyY2Uuc3BsaXQoJ1xcbicpO1xuICAgIHZhciBzdGFydCA9IDA7XG4gICAgdmFyIGxpbmVSYW5nZXMgPSBvcmlnaW5hbExpbmVzLm1hcChmdW5jdGlvbiAobGluZSwgaSkge1xuICAgICAgICB2YXIgZW5kID0gc3RhcnQgKyBsaW5lLmxlbmd0aCArIDE7XG4gICAgICAgIHZhciByYW5nZSA9IHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgbGluZTogaSB9O1xuICAgICAgICBzdGFydCA9IGVuZDtcbiAgICAgICAgcmV0dXJuIHJhbmdlO1xuICAgIH0pO1xuICAgIHZhciBpID0gMDtcbiAgICBmdW5jdGlvbiByYW5nZUNvbnRhaW5zKHJhbmdlLCBpbmRleCkge1xuICAgICAgICByZXR1cm4gcmFuZ2Uuc3RhcnQgPD0gaW5kZXggJiYgaW5kZXggPCByYW5nZS5lbmQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldExvY2F0aW9uKHJhbmdlLCBpbmRleCkge1xuICAgICAgICByZXR1cm4geyBsaW5lOiBvZmZzZXRMaW5lICsgcmFuZ2UubGluZSwgY29sdW1uOiBvZmZzZXRDb2x1bW4gKyBpbmRleCAtIHJhbmdlLnN0YXJ0LCBjaGFyYWN0ZXI6IGluZGV4IH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGxvY2F0ZShzZWFyY2gsIHN0YXJ0SW5kZXgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZWFyY2ggPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBzZWFyY2ggPSBzb3VyY2UuaW5kZXhPZihzZWFyY2gsIHN0YXJ0SW5kZXggfHwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJhbmdlID0gbGluZVJhbmdlc1tpXTtcbiAgICAgICAgdmFyIGQgPSBzZWFyY2ggPj0gcmFuZ2UuZW5kID8gMSA6IC0xO1xuICAgICAgICB3aGlsZSAocmFuZ2UpIHtcbiAgICAgICAgICAgIGlmIChyYW5nZUNvbnRhaW5zKHJhbmdlLCBzZWFyY2gpKVxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRMb2NhdGlvbihyYW5nZSwgc2VhcmNoKTtcbiAgICAgICAgICAgIGkgKz0gZDtcbiAgICAgICAgICAgIHJhbmdlID0gbGluZVJhbmdlc1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbG9jYXRlO1xufVxuZnVuY3Rpb24gbG9jYXRlKHNvdXJjZSwgc2VhcmNoLCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnbnVtYmVyJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2xvY2F0ZSB0YWtlcyBhIHsgc3RhcnRJbmRleCwgb2Zmc2V0TGluZSwgb2Zmc2V0Q29sdW1uIH0gb2JqZWN0IGFzIHRoZSB0aGlyZCBhcmd1bWVudCcpO1xuICAgIH1cbiAgICByZXR1cm4gZ2V0TG9jYXRvcihzb3VyY2UsIG9wdGlvbnMpKHNlYXJjaCwgb3B0aW9ucyAmJiBvcHRpb25zLnN0YXJ0SW5kZXgpO1xufVxuXG5jb25zdCByZWdleF90YWJzID0gL15cXHQrLztcbmZ1bmN0aW9uIHRhYnNfdG9fc3BhY2VzKHN0cikge1xuICAgIHJldHVybiBzdHIucmVwbGFjZShyZWdleF90YWJzLCBtYXRjaCA9PiBtYXRjaC5zcGxpdCgnXFx0Jykuam9pbignICAnKSk7XG59XG5mdW5jdGlvbiBnZXRfY29kZV9mcmFtZShzb3VyY2UsIGxpbmUsIGNvbHVtbikge1xuICAgIGNvbnN0IGxpbmVzID0gc291cmNlLnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBmcmFtZV9zdGFydCA9IE1hdGgubWF4KDAsIGxpbmUgLSAyKTtcbiAgICBjb25zdCBmcmFtZV9lbmQgPSBNYXRoLm1pbihsaW5lICsgMywgbGluZXMubGVuZ3RoKTtcbiAgICBjb25zdCBkaWdpdHMgPSBTdHJpbmcoZnJhbWVfZW5kICsgMSkubGVuZ3RoO1xuICAgIHJldHVybiBsaW5lc1xuICAgICAgICAuc2xpY2UoZnJhbWVfc3RhcnQsIGZyYW1lX2VuZClcbiAgICAgICAgLm1hcCgoc3RyLCBpKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzRXJyb3JMaW5lID0gZnJhbWVfc3RhcnQgKyBpID09PSBsaW5lO1xuICAgICAgICBjb25zdCBsaW5lX251bSA9IFN0cmluZyhpICsgZnJhbWVfc3RhcnQgKyAxKS5wYWRTdGFydChkaWdpdHMsICcgJyk7XG4gICAgICAgIGlmIChpc0Vycm9yTGluZSkge1xuICAgICAgICAgICAgY29uc3QgaW5kaWNhdG9yID0gJyAnLnJlcGVhdChkaWdpdHMgKyAyICsgdGFic190b19zcGFjZXMoc3RyLnNsaWNlKDAsIGNvbHVtbikpLmxlbmd0aCkgKyAnXic7XG4gICAgICAgICAgICByZXR1cm4gYCR7bGluZV9udW19OiAke3RhYnNfdG9fc3BhY2VzKHN0cil9XFxuJHtpbmRpY2F0b3J9YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7bGluZV9udW19OiAke3RhYnNfdG9fc3BhY2VzKHN0cil9YDtcbiAgICB9KVxuICAgICAgICAuam9pbignXFxuJyk7XG59XG5cbmNsYXNzIENvbXBpbGVFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMubWVzc2FnZX0gKCR7dGhpcy5zdGFydC5saW5lfToke3RoaXMuc3RhcnQuY29sdW1ufSlcXG4ke3RoaXMuZnJhbWV9YDtcbiAgICB9XG59XG5mdW5jdGlvbiBlcnJvcihtZXNzYWdlLCBwcm9wcykge1xuICAgIGNvbnN0IGVycm9yID0gbmV3IENvbXBpbGVFcnJvcihtZXNzYWdlKTtcbiAgICBlcnJvci5uYW1lID0gcHJvcHMubmFtZTtcbiAgICBjb25zdCBzdGFydCA9IGxvY2F0ZShwcm9wcy5zb3VyY2UsIHByb3BzLnN0YXJ0LCB7IG9mZnNldExpbmU6IDEgfSk7XG4gICAgY29uc3QgZW5kID0gbG9jYXRlKHByb3BzLnNvdXJjZSwgcHJvcHMuZW5kIHx8IHByb3BzLnN0YXJ0LCB7IG9mZnNldExpbmU6IDEgfSk7XG4gICAgZXJyb3IuY29kZSA9IHByb3BzLmNvZGU7XG4gICAgZXJyb3Iuc3RhcnQgPSBzdGFydDtcbiAgICBlcnJvci5lbmQgPSBlbmQ7XG4gICAgZXJyb3IucG9zID0gcHJvcHMuc3RhcnQ7XG4gICAgZXJyb3IuZmlsZW5hbWUgPSBwcm9wcy5maWxlbmFtZTtcbiAgICBlcnJvci5mcmFtZSA9IGdldF9jb2RlX2ZyYW1lKHByb3BzLnNvdXJjZSwgc3RhcnQubGluZSAtIDEsIHN0YXJ0LmNvbHVtbik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG5cbmNvbnN0IHJlZ2V4X3Bvc2l0aW9uX2luZGljYXRvciA9IC8gXFwoXFxkKzpcXGQrXFwpJC87XG5jbGFzcyBQYXJzZXIkMSB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGUsIG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5pbmRleCA9IDA7XG4gICAgICAgIHRoaXMuc3RhY2sgPSBbXTtcbiAgICAgICAgdGhpcy5jc3MgPSBbXTtcbiAgICAgICAgdGhpcy5qcyA9IFtdO1xuICAgICAgICB0aGlzLm1ldGFfdGFncyA9IHt9O1xuICAgICAgICBpZiAodHlwZW9mIHRlbXBsYXRlICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGVtcGxhdGUgbXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudGVtcGxhdGUgPSB0ZW1wbGF0ZS50cmltUmlnaHQoKTtcbiAgICAgICAgdGhpcy5maWxlbmFtZSA9IG9wdGlvbnMuZmlsZW5hbWU7XG4gICAgICAgIHRoaXMuY3VzdG9tRWxlbWVudCA9IG9wdGlvbnMuY3VzdG9tRWxlbWVudDtcbiAgICAgICAgdGhpcy5odG1sID0ge1xuICAgICAgICAgICAgc3RhcnQ6IG51bGwsXG4gICAgICAgICAgICBlbmQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiAnRnJhZ21lbnQnLFxuICAgICAgICAgICAgY2hpbGRyZW46IFtdXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc3RhY2sucHVzaCh0aGlzLmh0bWwpO1xuICAgICAgICBsZXQgc3RhdGUgPSBmcmFnbWVudDtcbiAgICAgICAgd2hpbGUgKHRoaXMuaW5kZXggPCB0aGlzLnRlbXBsYXRlLmxlbmd0aCkge1xuICAgICAgICAgICAgc3RhdGUgPSBzdGF0ZSh0aGlzKSB8fCBmcmFnbWVudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5jdXJyZW50KCk7XG4gICAgICAgICAgICBjb25zdCB0eXBlID0gY3VycmVudC50eXBlID09PSAnRWxlbWVudCcgPyBgPCR7Y3VycmVudC5uYW1lfT5gIDogJ0Jsb2NrJztcbiAgICAgICAgICAgIGNvbnN0IHNsdWcgPSBjdXJyZW50LnR5cGUgPT09ICdFbGVtZW50JyA/ICdlbGVtZW50JyA6ICdibG9jayc7XG4gICAgICAgICAgICB0aGlzLmVycm9yKHtcbiAgICAgICAgICAgICAgICBjb2RlOiBgdW5jbG9zZWQtJHtzbHVnfWAsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYCR7dHlwZX0gd2FzIGxlZnQgb3BlbmBcbiAgICAgICAgICAgIH0sIGN1cnJlbnQuc3RhcnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGF0ZSAhPT0gZnJhZ21lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3Ioe1xuICAgICAgICAgICAgICAgIGNvZGU6ICd1bmV4cGVjdGVkLWVvZicsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1VuZXhwZWN0ZWQgZW5kIG9mIGlucHV0J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaHRtbC5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxldCBzdGFydCA9IHRoaXMuaHRtbC5jaGlsZHJlblswXS5zdGFydDtcbiAgICAgICAgICAgIHdoaWxlIChyZWdleF93aGl0ZXNwYWNlLnRlc3QodGVtcGxhdGVbc3RhcnRdKSlcbiAgICAgICAgICAgICAgICBzdGFydCArPSAxO1xuICAgICAgICAgICAgbGV0IGVuZCA9IHRoaXMuaHRtbC5jaGlsZHJlblt0aGlzLmh0bWwuY2hpbGRyZW4ubGVuZ3RoIC0gMV0uZW5kO1xuICAgICAgICAgICAgd2hpbGUgKHJlZ2V4X3doaXRlc3BhY2UudGVzdCh0ZW1wbGF0ZVtlbmQgLSAxXSkpXG4gICAgICAgICAgICAgICAgZW5kIC09IDE7XG4gICAgICAgICAgICB0aGlzLmh0bWwuc3RhcnQgPSBzdGFydDtcbiAgICAgICAgICAgIHRoaXMuaHRtbC5lbmQgPSBlbmQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmh0bWwuc3RhcnQgPSB0aGlzLmh0bWwuZW5kID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjdXJyZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdGFja1t0aGlzLnN0YWNrLmxlbmd0aCAtIDFdO1xuICAgIH1cbiAgICBhY29ybl9lcnJvcihlcnIpIHtcbiAgICAgICAgdGhpcy5lcnJvcih7XG4gICAgICAgICAgICBjb2RlOiAncGFyc2UtZXJyb3InLFxuICAgICAgICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UucmVwbGFjZShyZWdleF9wb3NpdGlvbl9pbmRpY2F0b3IsICcnKVxuICAgICAgICB9LCBlcnIucG9zKTtcbiAgICB9XG4gICAgZXJyb3IoeyBjb2RlLCBtZXNzYWdlIH0sIGluZGV4ID0gdGhpcy5pbmRleCkge1xuICAgICAgICBlcnJvcihtZXNzYWdlLCB7XG4gICAgICAgICAgICBuYW1lOiAnUGFyc2VFcnJvcicsXG4gICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgc291cmNlOiB0aGlzLnRlbXBsYXRlLFxuICAgICAgICAgICAgc3RhcnQ6IGluZGV4LFxuICAgICAgICAgICAgZmlsZW5hbWU6IHRoaXMuZmlsZW5hbWVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVhdChzdHIsIHJlcXVpcmVkLCBlcnJvcikge1xuICAgICAgICBpZiAodGhpcy5tYXRjaChzdHIpKSB7XG4gICAgICAgICAgICB0aGlzLmluZGV4ICs9IHN0ci5sZW5ndGg7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVxdWlyZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoZXJyb3IgfHxcbiAgICAgICAgICAgICAgICAodGhpcy5pbmRleCA9PT0gdGhpcy50ZW1wbGF0ZS5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgPyBwYXJzZXJfZXJyb3JzLnVuZXhwZWN0ZWRfZW9mX3Rva2VuKHN0cilcbiAgICAgICAgICAgICAgICAgICAgOiBwYXJzZXJfZXJyb3JzLnVuZXhwZWN0ZWRfdG9rZW4oc3RyKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbWF0Y2goc3RyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRlbXBsYXRlLnNsaWNlKHRoaXMuaW5kZXgsIHRoaXMuaW5kZXggKyBzdHIubGVuZ3RoKSA9PT0gc3RyO1xuICAgIH1cbiAgICBtYXRjaF9yZWdleChwYXR0ZXJuKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gcGF0dGVybi5leGVjKHRoaXMudGVtcGxhdGUuc2xpY2UodGhpcy5pbmRleCkpO1xuICAgICAgICBpZiAoIW1hdGNoIHx8IG1hdGNoLmluZGV4ICE9PSAwKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiBtYXRjaFswXTtcbiAgICB9XG4gICAgYWxsb3dfd2hpdGVzcGFjZSgpIHtcbiAgICAgICAgd2hpbGUgKHRoaXMuaW5kZXggPCB0aGlzLnRlbXBsYXRlLmxlbmd0aCAmJlxuICAgICAgICAgICAgcmVnZXhfd2hpdGVzcGFjZS50ZXN0KHRoaXMudGVtcGxhdGVbdGhpcy5pbmRleF0pKSB7XG4gICAgICAgICAgICB0aGlzLmluZGV4Kys7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVhZChwYXR0ZXJuKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMubWF0Y2hfcmVnZXgocGF0dGVybik7XG4gICAgICAgIGlmIChyZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmluZGV4ICs9IHJlc3VsdC5sZW5ndGg7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHJlYWRfaWRlbnRpZmllcihhbGxvd19yZXNlcnZlZCA9IGZhbHNlKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5pbmRleDtcbiAgICAgICAgbGV0IGkgPSB0aGlzLmluZGV4O1xuICAgICAgICBjb25zdCBjb2RlID0gZnVsbF9jaGFyX2NvZGVfYXQodGhpcy50ZW1wbGF0ZSwgaSk7XG4gICAgICAgIGlmICghaXNJZGVudGlmaWVyU3RhcnQoY29kZSwgdHJ1ZSkpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgaSArPSBjb2RlIDw9IDB4ZmZmZiA/IDEgOiAyO1xuICAgICAgICB3aGlsZSAoaSA8IHRoaXMudGVtcGxhdGUubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBjb2RlID0gZnVsbF9jaGFyX2NvZGVfYXQodGhpcy50ZW1wbGF0ZSwgaSk7XG4gICAgICAgICAgICBpZiAoIWlzSWRlbnRpZmllckNoYXIoY29kZSwgdHJ1ZSkpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBpICs9IGNvZGUgPD0gMHhmZmZmID8gMSA6IDI7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaWRlbnRpZmllciA9IHRoaXMudGVtcGxhdGUuc2xpY2UodGhpcy5pbmRleCwgdGhpcy5pbmRleCA9IGkpO1xuICAgICAgICBpZiAoIWFsbG93X3Jlc2VydmVkICYmIHJlc2VydmVkLmhhcyhpZGVudGlmaWVyKSkge1xuICAgICAgICAgICAgdGhpcy5lcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogJ3VuZXhwZWN0ZWQtcmVzZXJ2ZWQtd29yZCcsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYCcke2lkZW50aWZpZXJ9JyBpcyBhIHJlc2VydmVkIHdvcmQgaW4gSmF2YVNjcmlwdCBhbmQgY2Fubm90IGJlIHVzZWQgaGVyZWBcbiAgICAgICAgICAgIH0sIHN0YXJ0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaWRlbnRpZmllcjtcbiAgICB9XG4gICAgcmVhZF91bnRpbChwYXR0ZXJuLCBlcnJvcl9tZXNzYWdlKSB7XG4gICAgICAgIGlmICh0aGlzLmluZGV4ID49IHRoaXMudGVtcGxhdGUubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmVycm9yKGVycm9yX21lc3NhZ2UgfHwge1xuICAgICAgICAgICAgICAgIGNvZGU6ICd1bmV4cGVjdGVkLWVvZicsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1VuZXhwZWN0ZWQgZW5kIG9mIGlucHV0J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RhcnQgPSB0aGlzLmluZGV4O1xuICAgICAgICBjb25zdCBtYXRjaCA9IHBhdHRlcm4uZXhlYyh0aGlzLnRlbXBsYXRlLnNsaWNlKHN0YXJ0KSk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgdGhpcy5pbmRleCA9IHN0YXJ0ICsgbWF0Y2guaW5kZXg7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50ZW1wbGF0ZS5zbGljZShzdGFydCwgdGhpcy5pbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbmRleCA9IHRoaXMudGVtcGxhdGUubGVuZ3RoO1xuICAgICAgICByZXR1cm4gdGhpcy50ZW1wbGF0ZS5zbGljZShzdGFydCk7XG4gICAgfVxuICAgIHJlcXVpcmVfd2hpdGVzcGFjZSgpIHtcbiAgICAgICAgaWYgKCFyZWdleF93aGl0ZXNwYWNlLnRlc3QodGhpcy50ZW1wbGF0ZVt0aGlzLmluZGV4XSkpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3Ioe1xuICAgICAgICAgICAgICAgIGNvZGU6ICdtaXNzaW5nLXdoaXRlc3BhY2UnLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdFeHBlY3RlZCB3aGl0ZXNwYWNlJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hbGxvd193aGl0ZXNwYWNlKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2UkMyh0ZW1wbGF0ZSwgb3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgcGFyc2VyID0gbmV3IFBhcnNlciQxKHRlbXBsYXRlLCBvcHRpb25zKTtcbiAgICAvLyBUT0RPIHdlIG1heSB3YW50IHRvIGFsbG93IG11bHRpcGxlIDxzdHlsZT4gdGFncyDigJRcbiAgICAvLyBvbmUgc2NvcGVkLCBvbmUgZ2xvYmFsLiBmb3Igbm93LCBvbmx5IGFsbG93IG9uZVxuICAgIGlmIChwYXJzZXIuY3NzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMuZHVwbGljYXRlX3N0eWxlLCBwYXJzZXIuY3NzWzFdLnN0YXJ0KTtcbiAgICB9XG4gICAgY29uc3QgaW5zdGFuY2Vfc2NyaXB0cyA9IHBhcnNlci5qcy5maWx0ZXIoc2NyaXB0ID0+IHNjcmlwdC5jb250ZXh0ID09PSAnZGVmYXVsdCcpO1xuICAgIGNvbnN0IG1vZHVsZV9zY3JpcHRzID0gcGFyc2VyLmpzLmZpbHRlcihzY3JpcHQgPT4gc2NyaXB0LmNvbnRleHQgPT09ICdtb2R1bGUnKTtcbiAgICBpZiAoaW5zdGFuY2Vfc2NyaXB0cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIHBhcnNlci5lcnJvcihwYXJzZXJfZXJyb3JzLmludmFsaWRfc2NyaXB0X2luc3RhbmNlLCBpbnN0YW5jZV9zY3JpcHRzWzFdLnN0YXJ0KTtcbiAgICB9XG4gICAgaWYgKG1vZHVsZV9zY3JpcHRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgcGFyc2VyLmVycm9yKHBhcnNlcl9lcnJvcnMuaW52YWxpZF9zY3JpcHRfbW9kdWxlLCBtb2R1bGVfc2NyaXB0c1sxXS5zdGFydCk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGh0bWw6IHBhcnNlci5odG1sLFxuICAgICAgICBjc3M6IHBhcnNlci5jc3NbMF0sXG4gICAgICAgIGluc3RhbmNlOiBpbnN0YW5jZV9zY3JpcHRzWzBdLFxuICAgICAgICBtb2R1bGU6IG1vZHVsZV9zY3JpcHRzWzBdXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaXNfaGVhZChub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUgJiYgbm9kZS50eXBlID09PSAnTWVtYmVyRXhwcmVzc2lvbicgJiYgbm9kZS5vYmplY3RbJ25hbWUnXSA9PT0gJ0BfZG9jdW1lbnQnICYmIG5vZGUucHJvcGVydHlbJ25hbWUnXSA9PT0gJ2hlYWQnO1xufVxuXG5jbGFzcyBCbG9jayQxIHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLmJpbmRpbmdfZ3JvdXBfaW5pdGlhbGlzZWQgPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMuZXZlbnRfbGlzdGVuZXJzID0gW107XG4gICAgICAgIHRoaXMudmFyaWFibGVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmhhc191cGRhdGVfbWV0aG9kID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGFyZW50ID0gb3B0aW9ucy5wYXJlbnQ7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSBvcHRpb25zLnJlbmRlcmVyO1xuICAgICAgICB0aGlzLm5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZTtcbiAgICAgICAgdGhpcy5jb21tZW50ID0gb3B0aW9ucy5jb21tZW50O1xuICAgICAgICB0aGlzLndyYXBwZXJzID0gW107XG4gICAgICAgIC8vIGZvciBrZXllZCBlYWNoIGJsb2Nrc1xuICAgICAgICB0aGlzLmtleSA9IG9wdGlvbnMua2V5O1xuICAgICAgICB0aGlzLmZpcnN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5iaW5kaW5ncyA9IG9wdGlvbnMuYmluZGluZ3M7XG4gICAgICAgIHRoaXMuY2h1bmtzID0ge1xuICAgICAgICAgICAgZGVjbGFyYXRpb25zOiBbXSxcbiAgICAgICAgICAgIGluaXQ6IFtdLFxuICAgICAgICAgICAgY3JlYXRlOiBbXSxcbiAgICAgICAgICAgIGNsYWltOiBbXSxcbiAgICAgICAgICAgIGh5ZHJhdGU6IFtdLFxuICAgICAgICAgICAgbW91bnQ6IFtdLFxuICAgICAgICAgICAgbWVhc3VyZTogW10sXG4gICAgICAgICAgICByZXN0b3JlX21lYXN1cmVtZW50czogW10sXG4gICAgICAgICAgICBmaXg6IFtdLFxuICAgICAgICAgICAgYW5pbWF0ZTogW10sXG4gICAgICAgICAgICBpbnRybzogW10sXG4gICAgICAgICAgICB1cGRhdGU6IFtdLFxuICAgICAgICAgICAgb3V0cm86IFtdLFxuICAgICAgICAgICAgZGVzdHJveTogW11cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYXNfYW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaGFzX2ludHJvX21ldGhvZCA9IGZhbHNlOyAvLyBhIGJsb2NrIGNvdWxkIGhhdmUgYW4gaW50cm8gbWV0aG9kIGJ1dCBub3QgaW50cm8gdHJhbnNpdGlvbnMsIGUuZy4gaWYgYSBzaWJsaW5nIGJsb2NrIGhhcyBpbnRyb3NcbiAgICAgICAgdGhpcy5oYXNfb3V0cm9fbWV0aG9kID0gZmFsc2U7XG4gICAgICAgIHRoaXMub3V0cm9zID0gMDtcbiAgICAgICAgdGhpcy5nZXRfdW5pcXVlX25hbWUgPSB0aGlzLnJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWVfbWFrZXIoKTtcbiAgICAgICAgdGhpcy5hbGlhc2VzID0gbmV3IE1hcCgpO1xuICAgICAgICBpZiAodGhpcy5rZXkpXG4gICAgICAgICAgICB0aGlzLmFsaWFzZXMuc2V0KCdrZXknLCB0aGlzLmdldF91bmlxdWVfbmFtZSgna2V5JykpO1xuICAgIH1cbiAgICBhc3NpZ25fdmFyaWFibGVfbmFtZXMoKSB7XG4gICAgICAgIGNvbnN0IHNlZW4gPSBuZXcgU2V0KCk7XG4gICAgICAgIGNvbnN0IGR1cGVzID0gbmV3IFNldCgpO1xuICAgICAgICBsZXQgaSA9IHRoaXMud3JhcHBlcnMubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBjb25zdCB3cmFwcGVyID0gdGhpcy53cmFwcGVyc1tpXTtcbiAgICAgICAgICAgIGlmICghd3JhcHBlci52YXIpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICBpZiAoc2Vlbi5oYXMod3JhcHBlci52YXIubmFtZSkpIHtcbiAgICAgICAgICAgICAgICBkdXBlcy5hZGQod3JhcHBlci52YXIubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWVuLmFkZCh3cmFwcGVyLnZhci5uYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb3VudHMgPSBuZXcgTWFwKCk7XG4gICAgICAgIGkgPSB0aGlzLndyYXBwZXJzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgY29uc3Qgd3JhcHBlciA9IHRoaXMud3JhcHBlcnNbaV07XG4gICAgICAgICAgICBpZiAoIXdyYXBwZXIudmFyKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgbGV0IHN1ZmZpeCA9ICcnO1xuICAgICAgICAgICAgaWYgKGR1cGVzLmhhcyh3cmFwcGVyLnZhci5uYW1lKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBjb3VudHMuZ2V0KHdyYXBwZXIudmFyLm5hbWUpIHx8IDA7XG4gICAgICAgICAgICAgICAgY291bnRzLnNldCh3cmFwcGVyLnZhci5uYW1lLCBpICsgMSk7XG4gICAgICAgICAgICAgICAgc3VmZml4ID0gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdyYXBwZXIudmFyLm5hbWUgPSB0aGlzLmdldF91bmlxdWVfbmFtZSh3cmFwcGVyLnZhci5uYW1lICsgc3VmZml4KS5uYW1lO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFkZF9kZXBlbmRlbmNpZXMoZGVwZW5kZW5jaWVzKSB7XG4gICAgICAgIGRlcGVuZGVuY2llcy5mb3JFYWNoKGRlcGVuZGVuY3kgPT4ge1xuICAgICAgICAgICAgdGhpcy5kZXBlbmRlbmNpZXMuYWRkKGRlcGVuZGVuY3kpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5oYXNfdXBkYXRlX21ldGhvZCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuYWRkX2RlcGVuZGVuY2llcyhkZXBlbmRlbmNpZXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFkZF9lbGVtZW50KGlkLCByZW5kZXJfc3RhdGVtZW50LCBjbGFpbV9zdGF0ZW1lbnQsIHBhcmVudF9ub2RlLCBub19kZXRhY2gpIHtcbiAgICAgICAgdGhpcy5hZGRfdmFyaWFibGUoaWQpO1xuICAgICAgICB0aGlzLmNodW5rcy5jcmVhdGUucHVzaChiIGAke2lkfSA9ICR7cmVuZGVyX3N0YXRlbWVudH07YCk7XG4gICAgICAgIGlmICh0aGlzLnJlbmRlcmVyLm9wdGlvbnMuaHlkcmF0YWJsZSkge1xuICAgICAgICAgICAgdGhpcy5jaHVua3MuY2xhaW0ucHVzaChiIGAke2lkfSA9ICR7Y2xhaW1fc3RhdGVtZW50IHx8IHJlbmRlcl9zdGF0ZW1lbnR9O2ApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJlbnRfbm9kZSkge1xuICAgICAgICAgICAgdGhpcy5jaHVua3MubW91bnQucHVzaChiIGBAYXBwZW5kKCR7cGFyZW50X25vZGV9LCAke2lkfSk7YCk7XG4gICAgICAgICAgICBpZiAoaXNfaGVhZChwYXJlbnRfbm9kZSkgJiYgIW5vX2RldGFjaClcbiAgICAgICAgICAgICAgICB0aGlzLmNodW5rcy5kZXN0cm95LnB1c2goYiBgQGRldGFjaCgke2lkfSk7YCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNodW5rcy5tb3VudC5wdXNoKGIgYEBpbnNlcnQoI3RhcmdldCwgJHtpZH0sICNhbmNob3IpO2ApO1xuICAgICAgICAgICAgaWYgKCFub19kZXRhY2gpXG4gICAgICAgICAgICAgICAgdGhpcy5jaHVua3MuZGVzdHJveS5wdXNoKGIgYGlmIChkZXRhY2hpbmcpIEBkZXRhY2goJHtpZH0pO2ApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFkZF9pbnRybyhsb2NhbCkge1xuICAgICAgICB0aGlzLmhhc19pbnRyb3MgPSB0aGlzLmhhc19pbnRyb19tZXRob2QgPSB0cnVlO1xuICAgICAgICBpZiAoIWxvY2FsICYmIHRoaXMucGFyZW50KVxuICAgICAgICAgICAgdGhpcy5wYXJlbnQuYWRkX2ludHJvKCk7XG4gICAgfVxuICAgIGFkZF9vdXRybyhsb2NhbCkge1xuICAgICAgICB0aGlzLmhhc19vdXRyb3MgPSB0aGlzLmhhc19vdXRyb19tZXRob2QgPSB0cnVlO1xuICAgICAgICB0aGlzLm91dHJvcyArPSAxO1xuICAgICAgICBpZiAoIWxvY2FsICYmIHRoaXMucGFyZW50KVxuICAgICAgICAgICAgdGhpcy5wYXJlbnQuYWRkX291dHJvKCk7XG4gICAgfVxuICAgIGFkZF9hbmltYXRpb24oKSB7XG4gICAgICAgIHRoaXMuaGFzX2FuaW1hdGlvbiA9IHRydWU7XG4gICAgfVxuICAgIGFkZF92YXJpYWJsZShpZCwgaW5pdCkge1xuICAgICAgICBpZiAodGhpcy52YXJpYWJsZXMuaGFzKGlkLm5hbWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZhcmlhYmxlICcke2lkLm5hbWV9JyBhbHJlYWR5IGluaXRpYWxpc2VkIHdpdGggYSBkaWZmZXJlbnQgdmFsdWVgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhcmlhYmxlcy5zZXQoaWQubmFtZSwgeyBpZCwgaW5pdCB9KTtcbiAgICB9XG4gICAgYWxpYXMobmFtZSkge1xuICAgICAgICBpZiAoIXRoaXMuYWxpYXNlcy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgIHRoaXMuYWxpYXNlcy5zZXQobmFtZSwgdGhpcy5nZXRfdW5pcXVlX25hbWUobmFtZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmFsaWFzZXMuZ2V0KG5hbWUpO1xuICAgIH1cbiAgICBjaGlsZChvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBuZXcgQmxvY2skMShPYmplY3QuYXNzaWduKHt9LCB0aGlzLCB7IGtleTogbnVsbCB9LCBvcHRpb25zLCB7IHBhcmVudDogdGhpcyB9KSk7XG4gICAgfVxuICAgIGdldF9jb250ZW50cyhrZXkpIHtcbiAgICAgICAgY29uc3QgeyBkZXYgfSA9IHRoaXMucmVuZGVyZXIub3B0aW9ucztcbiAgICAgICAgaWYgKHRoaXMuaGFzX291dHJvcykge1xuICAgICAgICAgICAgdGhpcy5hZGRfdmFyaWFibGUoeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6ICcjY3VycmVudCcgfSk7XG4gICAgICAgICAgICBpZiAodGhpcy5jaHVua3MuaW50cm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2h1bmtzLmludHJvLnB1c2goYiBgI2N1cnJlbnQgPSB0cnVlO2ApO1xuICAgICAgICAgICAgICAgIHRoaXMuY2h1bmtzLm1vdW50LnB1c2goYiBgI2N1cnJlbnQgPSB0cnVlO2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuY2h1bmtzLm91dHJvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNodW5rcy5vdXRyby5wdXNoKGIgYCNjdXJyZW50ID0gZmFsc2U7YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXV0b2ZvY3VzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hdXRvZm9jdXMuY29uZGl0aW9uX2V4cHJlc3Npb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNodW5rcy5tb3VudC5wdXNoKGIgYGlmICgke3RoaXMuYXV0b2ZvY3VzLmNvbmRpdGlvbl9leHByZXNzaW9ufSkgJHt0aGlzLmF1dG9mb2N1cy5lbGVtZW50X3Zhcn0uZm9jdXMoKTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY2h1bmtzLm1vdW50LnB1c2goYiBgJHt0aGlzLmF1dG9mb2N1cy5lbGVtZW50X3Zhcn0uZm9jdXMoKTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlcl9saXN0ZW5lcnMoKTtcbiAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IHt9O1xuICAgICAgICBjb25zdCBub29wID0geCBgQG5vb3BgO1xuICAgICAgICBwcm9wZXJ0aWVzLmtleSA9IGtleTtcbiAgICAgICAgaWYgKHRoaXMuZmlyc3QpIHtcbiAgICAgICAgICAgIHByb3BlcnRpZXMuZmlyc3QgPSB4IGBudWxsYDtcbiAgICAgICAgICAgIHRoaXMuY2h1bmtzLmh5ZHJhdGUucHVzaChiIGB0aGlzLmZpcnN0ID0gJHt0aGlzLmZpcnN0fTtgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jaHVua3MuY3JlYXRlLmxlbmd0aCA9PT0gMCAmJiB0aGlzLmNodW5rcy5oeWRyYXRlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcHJvcGVydGllcy5jcmVhdGUgPSBub29wO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgaHlkcmF0ZSA9IHRoaXMuY2h1bmtzLmh5ZHJhdGUubGVuZ3RoID4gMCAmJiAodGhpcy5yZW5kZXJlci5vcHRpb25zLmh5ZHJhdGFibGVcbiAgICAgICAgICAgICAgICA/IGIgYHRoaXMuaCgpO2BcbiAgICAgICAgICAgICAgICA6IHRoaXMuY2h1bmtzLmh5ZHJhdGUpO1xuICAgICAgICAgICAgcHJvcGVydGllcy5jcmVhdGUgPSB4IGBmdW5jdGlvbiAjY3JlYXRlKCkge1xuXHRcdFx0XHQke3RoaXMuY2h1bmtzLmNyZWF0ZX1cblx0XHRcdFx0JHtoeWRyYXRlfVxuXHRcdFx0fWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVuZGVyZXIub3B0aW9ucy5oeWRyYXRhYmxlIHx8IHRoaXMuY2h1bmtzLmNsYWltLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNodW5rcy5jbGFpbS5sZW5ndGggPT09IDAgJiYgdGhpcy5jaHVua3MuaHlkcmF0ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLmNsYWltID0gbm9vcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb3BlcnRpZXMuY2xhaW0gPSB4IGBmdW5jdGlvbiAjY2xhaW0oI25vZGVzKSB7XG5cdFx0XHRcdFx0JHt0aGlzLmNodW5rcy5jbGFpbX1cblx0XHRcdFx0XHQke3RoaXMucmVuZGVyZXIub3B0aW9ucy5oeWRyYXRhYmxlICYmIHRoaXMuY2h1bmtzLmh5ZHJhdGUubGVuZ3RoID4gMCAmJiBiIGB0aGlzLmgoKTtgfVxuXHRcdFx0XHR9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZW5kZXJlci5vcHRpb25zLmh5ZHJhdGFibGUgJiYgdGhpcy5jaHVua3MuaHlkcmF0ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLmh5ZHJhdGUgPSB4IGBmdW5jdGlvbiAjaHlkcmF0ZSgpIHtcblx0XHRcdFx0JHt0aGlzLmNodW5rcy5oeWRyYXRlfVxuXHRcdFx0fWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2h1bmtzLm1vdW50Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcHJvcGVydGllcy5tb3VudCA9IG5vb3A7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5ldmVudF9saXN0ZW5lcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLm1vdW50ID0geCBgZnVuY3Rpb24gI21vdW50KCN0YXJnZXQsICNhbmNob3IpIHtcblx0XHRcdFx0JHt0aGlzLmNodW5rcy5tb3VudH1cblx0XHRcdH1gO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcHJvcGVydGllcy5tb3VudCA9IHggYGZ1bmN0aW9uICNtb3VudCgjdGFyZ2V0LCAjYW5jaG9yKSB7XG5cdFx0XHRcdCR7dGhpcy5jaHVua3MubW91bnR9XG5cdFx0XHR9YDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5oYXNfdXBkYXRlX21ldGhvZCB8fCB0aGlzLm1haW50YWluX2NvbnRleHQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNodW5rcy51cGRhdGUubGVuZ3RoID09PSAwICYmICF0aGlzLm1haW50YWluX2NvbnRleHQpIHtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnVwZGF0ZSA9IG5vb3A7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdHggPSB0aGlzLm1haW50YWluX2NvbnRleHQgPyB4IGAjbmV3X2N0eGAgOiB4IGAjY3R4YDtcbiAgICAgICAgICAgICAgICBsZXQgZGlydHkgPSB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogJyNkaXJ0eScgfTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVuZGVyZXIuY29udGV4dF9vdmVyZmxvdyAmJiAhdGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlydHkgPSB7IHR5cGU6ICdBcnJheVBhdHRlcm4nLCBlbGVtZW50czogW2RpcnR5XSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnVwZGF0ZSA9IHggYGZ1bmN0aW9uICN1cGRhdGUoJHtjdHh9LCAke2RpcnR5fSkge1xuXHRcdFx0XHRcdCR7dGhpcy5tYWludGFpbl9jb250ZXh0ICYmIGIgYCNjdHggPSAke2N0eH07YH1cblx0XHRcdFx0XHQke3RoaXMuY2h1bmtzLnVwZGF0ZX1cblx0XHRcdFx0fWA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaGFzX2FuaW1hdGlvbikge1xuICAgICAgICAgICAgcHJvcGVydGllcy5tZWFzdXJlID0geCBgZnVuY3Rpb24gI21lYXN1cmUoKSB7XG5cdFx0XHRcdCR7dGhpcy5jaHVua3MubWVhc3VyZX1cblx0XHRcdH1gO1xuICAgICAgICAgICAgaWYgKHRoaXMuY2h1bmtzLnJlc3RvcmVfbWVhc3VyZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucmVzdG9yZV9tZWFzdXJlbWVudHMgPSB4IGBmdW5jdGlvbiAjcmVzdG9yZV9tZWFzdXJlbWVudHMoI21lYXN1cmVtZW50KSB7XG5cdFx0XHRcdFx0JHt0aGlzLmNodW5rcy5yZXN0b3JlX21lYXN1cmVtZW50c31cblx0XHRcdFx0fWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLmZpeCA9IHggYGZ1bmN0aW9uICNmaXgoKSB7XG5cdFx0XHRcdCR7dGhpcy5jaHVua3MuZml4fVxuXHRcdFx0fWA7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLmFuaW1hdGUgPSB4IGBmdW5jdGlvbiAjYW5pbWF0ZSgpIHtcblx0XHRcdFx0JHt0aGlzLmNodW5rcy5hbmltYXRlfVxuXHRcdFx0fWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaGFzX2ludHJvX21ldGhvZCB8fCB0aGlzLmhhc19vdXRyb19tZXRob2QpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNodW5rcy5pbnRyby5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLmludHJvID0gbm9vcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb3BlcnRpZXMuaW50cm8gPSB4IGBmdW5jdGlvbiAjaW50cm8oI2xvY2FsKSB7XG5cdFx0XHRcdFx0JHt0aGlzLmhhc19vdXRyb3MgJiYgYiBgaWYgKCNjdXJyZW50KSByZXR1cm47YH1cblx0XHRcdFx0XHQke3RoaXMuY2h1bmtzLmludHJvfVxuXHRcdFx0XHR9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmNodW5rcy5vdXRyby5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLm91dHJvID0gbm9vcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb3BlcnRpZXMub3V0cm8gPSB4IGBmdW5jdGlvbiAjb3V0cm8oI2xvY2FsKSB7XG5cdFx0XHRcdFx0JHt0aGlzLmNodW5rcy5vdXRyb31cblx0XHRcdFx0fWA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2h1bmtzLmRlc3Ryb3kubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLmRlc3Ryb3kgPSBub29wO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcHJvcGVydGllcy5kZXN0cm95ID0geCBgZnVuY3Rpb24gI2Rlc3Ryb3koZGV0YWNoaW5nKSB7XG5cdFx0XHRcdCR7dGhpcy5jaHVua3MuZGVzdHJveX1cblx0XHRcdH1gO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5yZW5kZXJlci5jb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldikge1xuICAgICAgICAgICAgLy8gYWxsb3cgc2hvcnRoYW5kIG5hbWVzXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgaW4gcHJvcGVydGllcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5ID0gcHJvcGVydGllc1tuYW1lXTtcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHkpXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5LmlkID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXR1cm5fdmFsdWUgPSB4IGB7XG5cdFx0XHRrZXk6ICR7cHJvcGVydGllcy5rZXl9LFxuXHRcdFx0Zmlyc3Q6ICR7cHJvcGVydGllcy5maXJzdH0sXG5cdFx0XHRjOiAke3Byb3BlcnRpZXMuY3JlYXRlfSxcblx0XHRcdGw6ICR7cHJvcGVydGllcy5jbGFpbX0sXG5cdFx0XHRoOiAke3Byb3BlcnRpZXMuaHlkcmF0ZX0sXG5cdFx0XHRtOiAke3Byb3BlcnRpZXMubW91bnR9LFxuXHRcdFx0cDogJHtwcm9wZXJ0aWVzLnVwZGF0ZX0sXG5cdFx0XHRyOiAke3Byb3BlcnRpZXMubWVhc3VyZX0sXG5cdFx0XHRzOiAke3Byb3BlcnRpZXMucmVzdG9yZV9tZWFzdXJlbWVudHN9LFxuXHRcdFx0ZjogJHtwcm9wZXJ0aWVzLmZpeH0sXG5cdFx0XHRhOiAke3Byb3BlcnRpZXMuYW5pbWF0ZX0sXG5cdFx0XHRpOiAke3Byb3BlcnRpZXMuaW50cm99LFxuXHRcdFx0bzogJHtwcm9wZXJ0aWVzLm91dHJvfSxcblx0XHRcdGQ6ICR7cHJvcGVydGllcy5kZXN0cm95fVxuXHRcdH1gO1xuICAgICAgICBjb25zdCBibG9jayA9IGRldiAmJiB0aGlzLmdldF91bmlxdWVfbmFtZSgnYmxvY2snKTtcbiAgICAgICAgY29uc3QgYm9keSA9IGIgYFxuXHRcdFx0JHt0aGlzLmNodW5rcy5kZWNsYXJhdGlvbnN9XG5cblx0XHRcdCR7QXJyYXkuZnJvbSh0aGlzLnZhcmlhYmxlcy52YWx1ZXMoKSkubWFwKCh7IGlkLCBpbml0IH0pID0+IHtcbiAgICAgICAgICAgIHJldHVybiBpbml0XG4gICAgICAgICAgICAgICAgPyBiIGBsZXQgJHtpZH0gPSAke2luaXR9YFxuICAgICAgICAgICAgICAgIDogYiBgbGV0ICR7aWR9YDtcbiAgICAgICAgfSl9XG5cblx0XHRcdCR7dGhpcy5jaHVua3MuaW5pdH1cblxuXHRcdFx0JHtkZXZcbiAgICAgICAgICAgID8gYiBgXG5cdFx0XHRcdFx0Y29uc3QgJHtibG9ja30gPSAke3JldHVybl92YWx1ZX07XG5cdFx0XHRcdFx0QGRpc3BhdGNoX2RldihcIlN2ZWx0ZVJlZ2lzdGVyQmxvY2tcIiwge1xuXHRcdFx0XHRcdFx0YmxvY2s6ICR7YmxvY2t9LFxuXHRcdFx0XHRcdFx0aWQ6ICR7dGhpcy5uYW1lIHx8ICdjcmVhdGVfZnJhZ21lbnQnfS5uYW1lLFxuXHRcdFx0XHRcdFx0dHlwZTogXCIke3RoaXMudHlwZX1cIixcblx0XHRcdFx0XHRcdHNvdXJjZTogXCIke3RoaXMuY29tbWVudCA/IHRoaXMuY29tbWVudC5yZXBsYWNlKHJlZ2V4X2RvdWJsZV9xdW90ZXMsICdcXFxcXCInKSA6ICcnfVwiLFxuXHRcdFx0XHRcdFx0Y3R4OiAjY3R4XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0cmV0dXJuICR7YmxvY2t9O2BcbiAgICAgICAgICAgIDogYiBgXG5cdFx0XHRcdFx0cmV0dXJuICR7cmV0dXJuX3ZhbHVlfTtgfVxuXHRcdGA7XG4gICAgICAgIHJldHVybiBib2R5O1xuICAgIH1cbiAgICBoYXNfY29udGVudCgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5maXJzdCB8fFxuICAgICAgICAgICAgdGhpcy5ldmVudF9saXN0ZW5lcnMubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgdGhpcy5jaHVua3MuaW50cm8ubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgdGhpcy5jaHVua3Mub3V0cm8ubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgdGhpcy5jaHVua3MuY3JlYXRlLmxlbmd0aCA+IDAgfHxcbiAgICAgICAgICAgIHRoaXMuY2h1bmtzLmh5ZHJhdGUubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgdGhpcy5jaHVua3MuY2xhaW0ubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgdGhpcy5jaHVua3MubW91bnQubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgdGhpcy5jaHVua3MudXBkYXRlLmxlbmd0aCA+IDAgfHxcbiAgICAgICAgICAgIHRoaXMuY2h1bmtzLmRlc3Ryb3kubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgdGhpcy5oYXNfYW5pbWF0aW9uO1xuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IHRoaXMua2V5ICYmIHRoaXMuZ2V0X3VuaXF1ZV9uYW1lKCdrZXknKTtcbiAgICAgICAgY29uc3QgYXJncyA9IFt4IGAjY3R4YF07XG4gICAgICAgIGlmIChrZXkpXG4gICAgICAgICAgICBhcmdzLnVuc2hpZnQoa2V5KTtcbiAgICAgICAgY29uc3QgZm4gPSBiIGBmdW5jdGlvbiAke3RoaXMubmFtZX0oJHthcmdzfSkge1xuXHRcdFx0JHt0aGlzLmdldF9jb250ZW50cyhrZXkpfVxuXHRcdH1gO1xuICAgICAgICByZXR1cm4gdGhpcy5jb21tZW50XG4gICAgICAgICAgICA/IGIgYFxuXHRcdFx0XHQvLyAke3RoaXMuY29tbWVudH1cblx0XHRcdFx0JHtmbn1gXG4gICAgICAgICAgICA6IGZuO1xuICAgIH1cbiAgICByZW5kZXJfbGlzdGVuZXJzKGNodW5rID0gJycpIHtcbiAgICAgICAgaWYgKHRoaXMuZXZlbnRfbGlzdGVuZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuYWRkX3ZhcmlhYmxlKHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiAnI21vdW50ZWQnIH0pO1xuICAgICAgICAgICAgdGhpcy5jaHVua3MuZGVzdHJveS5wdXNoKGIgYCNtb3VudGVkID0gZmFsc2VgKTtcbiAgICAgICAgICAgIGNvbnN0IGRpc3Bvc2UgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0lkZW50aWZpZXInLFxuICAgICAgICAgICAgICAgIG5hbWU6IGAjZGlzcG9zZSR7Y2h1bmt9YFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuYWRkX3ZhcmlhYmxlKGRpc3Bvc2UpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZXZlbnRfbGlzdGVuZXJzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2h1bmtzLm1vdW50LnB1c2goYiBgXG5cdFx0XHRcdFx0XHRpZiAoISNtb3VudGVkKSB7XG5cdFx0XHRcdFx0XHRcdCR7ZGlzcG9zZX0gPSAke3RoaXMuZXZlbnRfbGlzdGVuZXJzWzBdfTtcblx0XHRcdFx0XHRcdFx0I21vdW50ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGApO1xuICAgICAgICAgICAgICAgIHRoaXMuY2h1bmtzLmRlc3Ryb3kucHVzaChiIGAke2Rpc3Bvc2V9KCk7YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNodW5rcy5tb3VudC5wdXNoKGIgYFxuXHRcdFx0XHRcdGlmICghI21vdW50ZWQpIHtcblx0XHRcdFx0XHRcdCR7ZGlzcG9zZX0gPSBbXG5cdFx0XHRcdFx0XHRcdCR7dGhpcy5ldmVudF9saXN0ZW5lcnN9XG5cdFx0XHRcdFx0XHRdO1xuXHRcdFx0XHRcdFx0I21vdW50ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jaHVua3MuZGVzdHJveS5wdXNoKGIgYEBydW5fYWxsKCR7ZGlzcG9zZX0pO2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5jbGFzcyBXcmFwcGVyIHtcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSkge1xuICAgICAgICB0aGlzLm5vZGUgPSBub2RlO1xuICAgICAgICAvLyBtYWtlIHRoZXNlIG5vbi1lbnVtZXJhYmxlIHNvIHRoYXQgdGhleSBjYW4gYmUgbG9nZ2VkIHNlbnNpYmx5XG4gICAgICAgIC8vIChUT0RPIGluIGRldiBvbmx5PylcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywge1xuICAgICAgICAgICAgcmVuZGVyZXI6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogcmVuZGVyZXJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwYXJlbnQ6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogcGFyZW50XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNhbl91c2VfaW5uZXJodG1sID0gIXJlbmRlcmVyLm9wdGlvbnMuaHlkcmF0YWJsZTtcbiAgICAgICAgdGhpcy5pc19zdGF0aWNfY29udGVudCA9ICFyZW5kZXJlci5vcHRpb25zLmh5ZHJhdGFibGU7XG4gICAgICAgIGJsb2NrLndyYXBwZXJzLnB1c2godGhpcyk7XG4gICAgfVxuICAgIGNhbm5vdF91c2VfaW5uZXJodG1sKCkge1xuICAgICAgICB0aGlzLmNhbl91c2VfaW5uZXJodG1sID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudClcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmNhbm5vdF91c2VfaW5uZXJodG1sKCk7XG4gICAgfVxuICAgIG5vdF9zdGF0aWNfY29udGVudCgpIHtcbiAgICAgICAgdGhpcy5pc19zdGF0aWNfY29udGVudCA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQpXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5ub3Rfc3RhdGljX2NvbnRlbnQoKTtcbiAgICB9XG4gICAgZ2V0X29yX2NyZWF0ZV9hbmNob3IoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpIHtcbiAgICAgICAgLy8gVE9ETyB1c2UgdGhpcyBpbiBFYWNoQmxvY2sgYW5kIElmQmxvY2sg4oCUIHRyaWNreSBiZWNhdXNlXG4gICAgICAgIC8vIGNoaWxkcmVuIG5lZWQgdG8gYmUgY3JlYXRlZCBmaXJzdFxuICAgICAgICBjb25zdCBuZWVkc19hbmNob3IgPSB0aGlzLm5leHQgPyAhdGhpcy5uZXh0LmlzX2RvbV9ub2RlKCkgOiAhcGFyZW50X25vZGUgfHwgIXRoaXMucGFyZW50LmlzX2RvbV9ub2RlKCk7XG4gICAgICAgIGNvbnN0IGFuY2hvciA9IG5lZWRzX2FuY2hvclxuICAgICAgICAgICAgPyBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7dGhpcy52YXIubmFtZX1fYW5jaG9yYClcbiAgICAgICAgICAgIDogKHRoaXMubmV4dCAmJiB0aGlzLm5leHQudmFyKSB8fCB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogJ251bGwnIH07XG4gICAgICAgIGlmIChuZWVkc19hbmNob3IpIHtcbiAgICAgICAgICAgIGJsb2NrLmFkZF9lbGVtZW50KGFuY2hvciwgeCBgQGVtcHR5KClgLCBwYXJlbnRfbm9kZXMgJiYgeCBgQGVtcHR5KClgLCBwYXJlbnRfbm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFuY2hvcjtcbiAgICB9XG4gICAgZ2V0X3VwZGF0ZV9tb3VudF9ub2RlKGFuY2hvcikge1xuICAgICAgICByZXR1cm4gKCh0aGlzLnBhcmVudCAmJiB0aGlzLnBhcmVudC5pc19kb21fbm9kZSgpKVxuICAgICAgICAgICAgPyB0aGlzLnBhcmVudC52YXJcbiAgICAgICAgICAgIDogeCBgJHthbmNob3J9LnBhcmVudE5vZGVgKTtcbiAgICB9XG4gICAgaXNfZG9tX25vZGUoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5ub2RlLnR5cGUgPT09ICdFbGVtZW50JyB8fFxuICAgICAgICAgICAgdGhpcy5ub2RlLnR5cGUgPT09ICdUZXh0JyB8fFxuICAgICAgICAgICAgdGhpcy5ub2RlLnR5cGUgPT09ICdNdXN0YWNoZVRhZycpO1xuICAgIH1cbiAgICByZW5kZXIoX2Jsb2NrLCBfcGFyZW50X25vZGUsIF9wYXJlbnRfbm9kZXMpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoJ1dyYXBwZXIgY2xhc3MgaXMgbm90IHJlbmRlcmFibGUnKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZV9kZWJ1Z2dpbmdfY29tbWVudChub2RlLCBjb21wb25lbnQpIHtcbiAgICBjb25zdCB7IGxvY2F0ZSwgc291cmNlIH0gPSBjb21wb25lbnQ7XG4gICAgbGV0IGMgPSBub2RlLnN0YXJ0O1xuICAgIGlmIChub2RlLnR5cGUgPT09ICdFbHNlQmxvY2snKSB7XG4gICAgICAgIHdoaWxlIChzb3VyY2VbYyAtIDFdICE9PSAneycpXG4gICAgICAgICAgICBjIC09IDE7XG4gICAgICAgIHdoaWxlIChzb3VyY2VbYyAtIDFdID09PSAneycpXG4gICAgICAgICAgICBjIC09IDE7XG4gICAgfVxuICAgIGxldCBkO1xuICAgIGlmIChub2RlLnR5cGUgPT09ICdJbmxpbmVDb21wb25lbnQnIHx8IG5vZGUudHlwZSA9PT0gJ0VsZW1lbnQnIHx8IG5vZGUudHlwZSA9PT0gJ1Nsb3RUZW1wbGF0ZScpIHtcbiAgICAgICAgaWYgKG5vZGUuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICBkID0gbm9kZS5jaGlsZHJlblswXS5zdGFydDtcbiAgICAgICAgICAgIHdoaWxlIChzb3VyY2VbZCAtIDFdICE9PSAnPicpXG4gICAgICAgICAgICAgICAgZCAtPSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZCA9IG5vZGUuc3RhcnQ7XG4gICAgICAgICAgICB3aGlsZSAoc291cmNlW2RdICE9PSAnPicpXG4gICAgICAgICAgICAgICAgZCArPSAxO1xuICAgICAgICAgICAgZCArPSAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ1RleHQnIHx8IG5vZGUudHlwZSA9PT0gJ0NvbW1lbnQnKSB7XG4gICAgICAgIGQgPSBub2RlLmVuZDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgZCA9IG5vZGUuZXhwcmVzc2lvbiA/IG5vZGUuZXhwcmVzc2lvbi5ub2RlLmVuZCA6IGM7XG4gICAgICAgIHdoaWxlIChzb3VyY2VbZF0gIT09ICd9JyAmJiBkIDw9IHNvdXJjZS5sZW5ndGgpXG4gICAgICAgICAgICBkICs9IDE7XG4gICAgICAgIHdoaWxlIChzb3VyY2VbZF0gPT09ICd9JylcbiAgICAgICAgICAgIGQgKz0gMTtcbiAgICB9XG4gICAgY29uc3Qgc3RhcnQgPSBsb2NhdGUoYyk7XG4gICAgY29uc3QgbG9jID0gYCgke3N0YXJ0LmxpbmV9OiR7c3RhcnQuY29sdW1ufSlgO1xuICAgIHJldHVybiBgJHtsb2N9ICR7c291cmNlLnNsaWNlKGMsIGQpfWAucmVwbGFjZShyZWdleF93aGl0ZXNwYWNlX2NoYXJhY3RlcnMsICcgJyk7XG59XG5cbmNsYXNzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIF9zY29wZSwgaW5mbykge1xuICAgICAgICB0aGlzLnN0YXJ0ID0gaW5mby5zdGFydDtcbiAgICAgICAgdGhpcy5lbmQgPSBpbmZvLmVuZDtcbiAgICAgICAgdGhpcy50eXBlID0gaW5mby50eXBlO1xuICAgICAgICAvLyB0aGlzIG1ha2VzIHByb3BlcnRpZXMgbm9uLWVudW1lcmFibGUsIHdoaWNoIG1ha2VzIGxvZ2dpbmdcbiAgICAgICAgLy8gYmVhcmFibGUuIG1pZ2h0IGhhdmUgYSBwZXJmb3JtYW5jZSBjb3N0LiBUT0RPIHJlbW92ZSBpbiBwcm9kP1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7XG4gICAgICAgICAgICBjb21wb25lbnQ6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogY29tcG9uZW50XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcGFyZW50OiB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHBhcmVudFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY2Fubm90X3VzZV9pbm5lcmh0bWwoKSB7XG4gICAgICAgIGlmICh0aGlzLmNhbl91c2VfaW5uZXJodG1sICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5jYW5fdXNlX2lubmVyaHRtbCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50KVxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNhbm5vdF91c2VfaW5uZXJodG1sKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmluZF9uZWFyZXN0KHNlbGVjdG9yKSB7XG4gICAgICAgIGlmIChzZWxlY3Rvci50ZXN0KHRoaXMudHlwZSkpXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgaWYgKHRoaXMucGFyZW50KVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50LmZpbmRfbmVhcmVzdChzZWxlY3Rvcik7XG4gICAgfVxuICAgIGdldF9zdGF0aWNfYXR0cmlidXRlX3ZhbHVlKG5hbWUpIHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlID0gdGhpcy5hdHRyaWJ1dGVzICYmIHRoaXMuYXR0cmlidXRlcy5maW5kKChhdHRyKSA9PiBhdHRyLnR5cGUgPT09ICdBdHRyaWJ1dGUnICYmIGF0dHIubmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lKTtcbiAgICAgICAgaWYgKCFhdHRyaWJ1dGUpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZS5pc190cnVlKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmIChhdHRyaWJ1dGUuY2h1bmtzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgaWYgKGF0dHJpYnV0ZS5jaHVua3MubGVuZ3RoID09PSAxICYmIGF0dHJpYnV0ZS5jaHVua3NbMF0udHlwZSA9PT0gJ1RleHQnKSB7XG4gICAgICAgICAgICByZXR1cm4gYXR0cmlidXRlLmNodW5rc1swXS5kYXRhO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBoYXNfYW5jZXN0b3IodHlwZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQgP1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQudHlwZSA9PT0gdHlwZSB8fCB0aGlzLnBhcmVudC5oYXNfYW5jZXN0b3IodHlwZSkgOlxuICAgICAgICAgICAgZmFsc2U7XG4gICAgfVxufVxuXG4vLyBBbGwgY29tcGlsZXIgd2FybmluZ3Mgc2hvdWxkIGJlIGxpc3RlZCBhbmQgYWNjZXNzZWQgZnJvbSBoZXJlXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG52YXIgY29tcGlsZXJfd2FybmluZ3MgPSB7XG4gICAgY3VzdG9tX2VsZW1lbnRfbm9fdGFnOiB7XG4gICAgICAgIGNvZGU6ICdjdXN0b20tZWxlbWVudC1uby10YWcnLFxuICAgICAgICBtZXNzYWdlOiAnTm8gY3VzdG9tIGVsZW1lbnQgXFwndGFnXFwnIG9wdGlvbiB3YXMgc3BlY2lmaWVkLiBUbyBhdXRvbWF0aWNhbGx5IHJlZ2lzdGVyIGEgY3VzdG9tIGVsZW1lbnQsIHNwZWNpZnkgYSBuYW1lIHdpdGggYSBoeXBoZW4gaW4gaXQsIGUuZy4gPHN2ZWx0ZTpvcHRpb25zIHRhZz1cIm15LXRoaW5nXCIvPi4gVG8gaGlkZSB0aGlzIHdhcm5pbmcsIHVzZSA8c3ZlbHRlOm9wdGlvbnMgdGFnPXtudWxsfS8+J1xuICAgIH0sXG4gICAgdW51c2VkX2V4cG9ydF9sZXQ6IChjb21wb25lbnQsIHByb3BlcnR5KSA9PiAoe1xuICAgICAgICBjb2RlOiAndW51c2VkLWV4cG9ydC1sZXQnLFxuICAgICAgICBtZXNzYWdlOiBgJHtjb21wb25lbnR9IGhhcyB1bnVzZWQgZXhwb3J0IHByb3BlcnR5ICcke3Byb3BlcnR5fScuIElmIGl0IGlzIGZvciBleHRlcm5hbCByZWZlcmVuY2Ugb25seSwgcGxlYXNlIGNvbnNpZGVyIHVzaW5nIFxcYGV4cG9ydCBjb25zdCAke3Byb3BlcnR5fVxcYGBcbiAgICB9KSxcbiAgICBtb2R1bGVfc2NyaXB0X3JlYWN0aXZlX2RlY2xhcmF0aW9uOiB7XG4gICAgICAgIGNvZGU6ICdtb2R1bGUtc2NyaXB0LXJlYWN0aXZlLWRlY2xhcmF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogJyQ6IGhhcyBubyBlZmZlY3QgaW4gYSBtb2R1bGUgc2NyaXB0J1xuICAgIH0sXG4gICAgbm9uX3RvcF9sZXZlbF9yZWFjdGl2ZV9kZWNsYXJhdGlvbjoge1xuICAgICAgICBjb2RlOiAnbm9uLXRvcC1sZXZlbC1yZWFjdGl2ZS1kZWNsYXJhdGlvbicsXG4gICAgICAgIG1lc3NhZ2U6ICckOiBoYXMgbm8gZWZmZWN0IG91dHNpZGUgb2YgdGhlIHRvcC1sZXZlbCdcbiAgICB9LFxuICAgIG1vZHVsZV9zY3JpcHRfdmFyaWFibGVfcmVhY3RpdmVfZGVjbGFyYXRpb246IChuYW1lcykgPT4gKHtcbiAgICAgICAgY29kZTogJ21vZHVsZS1zY3JpcHQtcmVhY3RpdmUtZGVjbGFyYXRpb24nLFxuICAgICAgICBtZXNzYWdlOiBgJHtuYW1lcy5tYXAobmFtZSA9PiBgXCIke25hbWV9XCJgKS5qb2luKCcsICcpfSAke25hbWVzLmxlbmd0aCA+IDEgPyAnYXJlJyA6ICdpcyd9IGRlY2xhcmVkIGluIGEgbW9kdWxlIHNjcmlwdCBhbmQgd2lsbCBub3QgYmUgcmVhY3RpdmVgXG4gICAgfSksXG4gICAgbWlzc2luZ19kZWNsYXJhdGlvbjogKG5hbWUsIGhhc19zY3JpcHQpID0+ICh7XG4gICAgICAgIGNvZGU6ICdtaXNzaW5nLWRlY2xhcmF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogYCcke25hbWV9JyBpcyBub3QgZGVmaW5lZGAgKyAoaGFzX3NjcmlwdCA/ICcnIDogYC4gQ29uc2lkZXIgYWRkaW5nIGEgPHNjcmlwdD4gYmxvY2sgd2l0aCAnZXhwb3J0IGxldCAke25hbWV9JyB0byBkZWNsYXJlIGEgcHJvcGApXG4gICAgfSksXG4gICAgbWlzc2luZ19jdXN0b21fZWxlbWVudF9jb21waWxlX29wdGlvbnM6IHtcbiAgICAgICAgY29kZTogJ21pc3NpbmctY3VzdG9tLWVsZW1lbnQtY29tcGlsZS1vcHRpb25zJyxcbiAgICAgICAgbWVzc2FnZTogXCJUaGUgJ3RhZycgb3B0aW9uIGlzIHVzZWQgd2hlbiBnZW5lcmF0aW5nIGEgY3VzdG9tIGVsZW1lbnQuIERpZCB5b3UgZm9yZ2V0IHRoZSAnY3VzdG9tRWxlbWVudDogdHJ1ZScgY29tcGlsZSBvcHRpb24/XCJcbiAgICB9LFxuICAgIGNzc191bnVzZWRfc2VsZWN0b3I6IChzZWxlY3RvcikgPT4gKHtcbiAgICAgICAgY29kZTogJ2Nzcy11bnVzZWQtc2VsZWN0b3InLFxuICAgICAgICBtZXNzYWdlOiBgVW51c2VkIENTUyBzZWxlY3RvciBcIiR7c2VsZWN0b3J9XCJgXG4gICAgfSksXG4gICAgZW1wdHlfYmxvY2s6IHtcbiAgICAgICAgY29kZTogJ2VtcHR5LWJsb2NrJyxcbiAgICAgICAgbWVzc2FnZTogJ0VtcHR5IGJsb2NrJ1xuICAgIH0sXG4gICAgcmVhY3RpdmVfY29tcG9uZW50OiAobmFtZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ3JlYWN0aXZlLWNvbXBvbmVudCcsXG4gICAgICAgIG1lc3NhZ2U6IGA8JHtuYW1lfS8+IHdpbGwgbm90IGJlIHJlYWN0aXZlIGlmICR7bmFtZX0gY2hhbmdlcy4gVXNlIDxzdmVsdGU6Y29tcG9uZW50IHRoaXM9eyR7bmFtZX19Lz4gaWYgeW91IHdhbnQgdGhpcyByZWFjdGl2aXR5LmBcbiAgICB9KSxcbiAgICBjb21wb25lbnRfbmFtZV9sb3dlcmNhc2U6IChuYW1lKSA9PiAoe1xuICAgICAgICBjb2RlOiAnY29tcG9uZW50LW5hbWUtbG93ZXJjYXNlJyxcbiAgICAgICAgbWVzc2FnZTogYDwke25hbWV9PiB3aWxsIGJlIHRyZWF0ZWQgYXMgYW4gSFRNTCBlbGVtZW50IHVubGVzcyBpdCBiZWdpbnMgd2l0aCBhIGNhcGl0YWwgbGV0dGVyYFxuICAgIH0pLFxuICAgIGF2b2lkX2lzOiB7XG4gICAgICAgIGNvZGU6ICdhdm9pZC1pcycsXG4gICAgICAgIG1lc3NhZ2U6ICdUaGUgXFwnaXNcXCcgYXR0cmlidXRlIGlzIG5vdCBzdXBwb3J0ZWQgY3Jvc3MtYnJvd3NlciBhbmQgc2hvdWxkIGJlIGF2b2lkZWQnXG4gICAgfSxcbiAgICBpbnZhbGlkX2h0bWxfYXR0cmlidXRlOiAobmFtZSwgc3VnZ2VzdGlvbikgPT4gKHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtaHRtbC1hdHRyaWJ1dGUnLFxuICAgICAgICBtZXNzYWdlOiBgJyR7bmFtZX0nIGlzIG5vdCBhIHZhbGlkIEhUTUwgYXR0cmlidXRlLiBEaWQgeW91IG1lYW4gJyR7c3VnZ2VzdGlvbn0nP2BcbiAgICB9KSxcbiAgICBhMTF5X2FyaWFfYXR0cmlidXRlczogKG5hbWUpID0+ICh7XG4gICAgICAgIGNvZGU6ICdhMTF5LWFyaWEtYXR0cmlidXRlcycsXG4gICAgICAgIG1lc3NhZ2U6IGBBMTF5OiA8JHtuYW1lfT4gc2hvdWxkIG5vdCBoYXZlIGFyaWEtKiBhdHRyaWJ1dGVzYFxuICAgIH0pLFxuICAgIGExMXlfaW5jb3JyZWN0X2F0dHJpYnV0ZV90eXBlOiAoc2NoZW1hLCBhdHRyaWJ1dGUpID0+IHtcbiAgICAgICAgbGV0IG1lc3NhZ2U7XG4gICAgICAgIHN3aXRjaCAoc2NoZW1hLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgVGhlIHZhbHVlIG9mICcke2F0dHJpYnV0ZX0nIG11c3QgYmUgZXhhY3RseSBvbmUgb2YgdHJ1ZSBvciBmYWxzZWA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdpZCc6XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IGBUaGUgdmFsdWUgb2YgJyR7YXR0cmlidXRlfScgbXVzdCBiZSBhIHN0cmluZyB0aGF0IHJlcHJlc2VudHMgYSBET00gZWxlbWVudCBJRGA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdpZGxpc3QnOlxuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgVGhlIHZhbHVlIG9mICcke2F0dHJpYnV0ZX0nIG11c3QgYmUgYSBzcGFjZS1zZXBhcmF0ZWQgbGlzdCBvZiBzdHJpbmdzIHRoYXQgcmVwcmVzZW50IERPTSBlbGVtZW50IElEc2A7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICd0cmlzdGF0ZSc6XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IGBUaGUgdmFsdWUgb2YgJyR7YXR0cmlidXRlfScgbXVzdCBiZSBleGFjdGx5IG9uZSBvZiB0cnVlLCBmYWxzZSwgb3IgbWl4ZWRgO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndG9rZW4nOlxuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgVGhlIHZhbHVlIG9mICcke2F0dHJpYnV0ZX0nIG11c3QgYmUgZXhhY3RseSBvbmUgb2YgJHsoc2NoZW1hLnZhbHVlcyB8fCBbXSkuam9pbignLCAnKX1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndG9rZW5saXN0JzpcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gYFRoZSB2YWx1ZSBvZiAnJHthdHRyaWJ1dGV9JyBtdXN0IGJlIGEgc3BhY2Utc2VwYXJhdGVkIGxpc3Qgb2Ygb25lIG9yIG1vcmUgb2YgJHsoc2NoZW1hLnZhbHVlcyB8fCBbXSkuam9pbignLCAnKX1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gYFRoZSB2YWx1ZSBvZiAnJHthdHRyaWJ1dGV9JyBtdXN0IGJlIG9mIHR5cGUgJHtzY2hlbWEudHlwZX1gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb2RlOiAnYTExeS1pbmNvcnJlY3QtYXJpYS1hdHRyaWJ1dGUtdHlwZScsXG4gICAgICAgICAgICBtZXNzYWdlOiBgQTExeTogJHttZXNzYWdlfWBcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGExMXlfdW5rbm93bl9hcmlhX2F0dHJpYnV0ZTogKGF0dHJpYnV0ZSwgc3VnZ2VzdGlvbikgPT4gKHtcbiAgICAgICAgY29kZTogJ2ExMXktdW5rbm93bi1hcmlhLWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6IGBBMTF5OiBVbmtub3duIGFyaWEgYXR0cmlidXRlICdhcmlhLSR7YXR0cmlidXRlfSdgICsgKHN1Z2dlc3Rpb24gPyBgIChkaWQgeW91IG1lYW4gJyR7c3VnZ2VzdGlvbn0nPylgIDogJycpXG4gICAgfSksXG4gICAgYTExeV9oaWRkZW46IChuYW1lKSA9PiAoe1xuICAgICAgICBjb2RlOiAnYTExeS1oaWRkZW4nLFxuICAgICAgICBtZXNzYWdlOiBgQTExeTogPCR7bmFtZX0+IGVsZW1lbnQgc2hvdWxkIG5vdCBiZSBoaWRkZW5gXG4gICAgfSksXG4gICAgYTExeV9taXNwbGFjZWRfcm9sZTogKG5hbWUpID0+ICh7XG4gICAgICAgIGNvZGU6ICdhMTF5LW1pc3BsYWNlZC1yb2xlJyxcbiAgICAgICAgbWVzc2FnZTogYEExMXk6IDwke25hbWV9PiBzaG91bGQgbm90IGhhdmUgcm9sZSBhdHRyaWJ1dGVgXG4gICAgfSksXG4gICAgYTExeV91bmtub3duX3JvbGU6IChyb2xlLCBzdWdnZXN0aW9uKSA9PiAoe1xuICAgICAgICBjb2RlOiAnYTExeS11bmtub3duLXJvbGUnLFxuICAgICAgICBtZXNzYWdlOiBgQTExeTogVW5rbm93biByb2xlICcke3JvbGV9J2AgKyAoc3VnZ2VzdGlvbiA/IGAgKGRpZCB5b3UgbWVhbiAnJHtzdWdnZXN0aW9ufSc/KWAgOiAnJylcbiAgICB9KSxcbiAgICBhMTF5X25vX2Fic3RyYWN0X3JvbGU6IChyb2xlKSA9PiAoe1xuICAgICAgICBjb2RlOiAnYTExeS1uby1hYnN0cmFjdC1yb2xlJyxcbiAgICAgICAgbWVzc2FnZTogYEExMXk6IEFic3RyYWN0IHJvbGUgJyR7cm9sZX0nIGlzIGZvcmJpZGRlbmBcbiAgICB9KSxcbiAgICBhMTF5X25vX3JlZHVuZGFudF9yb2xlczogKHJvbGUpID0+ICh7XG4gICAgICAgIGNvZGU6ICdhMTF5LW5vLXJlZHVuZGFudC1yb2xlcycsXG4gICAgICAgIG1lc3NhZ2U6IGBBMTF5OiBSZWR1bmRhbnQgcm9sZSAnJHtyb2xlfSdgXG4gICAgfSksXG4gICAgYTExeV9ub19pbnRlcmFjdGl2ZV9lbGVtZW50X3RvX25vbmludGVyYWN0aXZlX3JvbGU6IChyb2xlLCBlbGVtZW50KSA9PiAoe1xuICAgICAgICBjb2RlOiAnYTExeS1uby1pbnRlcmFjdGl2ZS1lbGVtZW50LXRvLW5vbmludGVyYWN0aXZlLXJvbGUnLFxuICAgICAgICBtZXNzYWdlOiBgQTExeTogPCR7ZWxlbWVudH0+IGNhbm5vdCBoYXZlIHJvbGUgJyR7cm9sZX0nYFxuICAgIH0pLFxuICAgIGExMXlfcm9sZV9oYXNfcmVxdWlyZWRfYXJpYV9wcm9wczogKHJvbGUsIHByb3BzKSA9PiAoe1xuICAgICAgICBjb2RlOiAnYTExeS1yb2xlLWhhcy1yZXF1aXJlZC1hcmlhLXByb3BzJyxcbiAgICAgICAgbWVzc2FnZTogYEExMXk6IEVsZW1lbnRzIHdpdGggdGhlIEFSSUEgcm9sZSBcIiR7cm9sZX1cIiBtdXN0IGhhdmUgdGhlIGZvbGxvd2luZyBhdHRyaWJ1dGVzIGRlZmluZWQ6ICR7cHJvcHMubWFwKG5hbWUgPT4gYFwiJHtuYW1lfVwiYCkuam9pbignLCAnKX1gXG4gICAgfSksXG4gICAgYTExeV9hY2Nlc3NrZXk6IHtcbiAgICAgICAgY29kZTogJ2ExMXktYWNjZXNza2V5JyxcbiAgICAgICAgbWVzc2FnZTogJ0ExMXk6IEF2b2lkIHVzaW5nIGFjY2Vzc2tleSdcbiAgICB9LFxuICAgIGExMXlfYXV0b2ZvY3VzOiB7XG4gICAgICAgIGNvZGU6ICdhMTF5LWF1dG9mb2N1cycsXG4gICAgICAgIG1lc3NhZ2U6ICdBMTF5OiBBdm9pZCB1c2luZyBhdXRvZm9jdXMnXG4gICAgfSxcbiAgICBhMTF5X21pc3BsYWNlZF9zY29wZToge1xuICAgICAgICBjb2RlOiAnYTExeS1taXNwbGFjZWQtc2NvcGUnLFxuICAgICAgICBtZXNzYWdlOiAnQTExeTogVGhlIHNjb3BlIGF0dHJpYnV0ZSBzaG91bGQgb25seSBiZSB1c2VkIHdpdGggPHRoPiBlbGVtZW50cydcbiAgICB9LFxuICAgIGExMXlfcG9zaXRpdmVfdGFiaW5kZXg6IHtcbiAgICAgICAgY29kZTogJ2ExMXktcG9zaXRpdmUtdGFiaW5kZXgnLFxuICAgICAgICBtZXNzYWdlOiAnQTExeTogYXZvaWQgdGFiaW5kZXggdmFsdWVzIGFib3ZlIHplcm8nXG4gICAgfSxcbiAgICBhMTF5X2ludmFsaWRfYXR0cmlidXRlOiAoaHJlZl9hdHRyaWJ1dGUsIGhyZWZfdmFsdWUpID0+ICh7XG4gICAgICAgIGNvZGU6ICdhMTF5LWludmFsaWQtYXR0cmlidXRlJyxcbiAgICAgICAgbWVzc2FnZTogYEExMXk6ICcke2hyZWZfdmFsdWV9JyBpcyBub3QgYSB2YWxpZCAke2hyZWZfYXR0cmlidXRlfSBhdHRyaWJ1dGVgXG4gICAgfSksXG4gICAgYTExeV9taXNzaW5nX2F0dHJpYnV0ZTogKG5hbWUsIGFydGljbGUsIHNlcXVlbmNlKSA9PiAoe1xuICAgICAgICBjb2RlOiAnYTExeS1taXNzaW5nLWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6IGBBMTF5OiA8JHtuYW1lfT4gZWxlbWVudCBzaG91bGQgaGF2ZSAke2FydGljbGV9ICR7c2VxdWVuY2V9IGF0dHJpYnV0ZWBcbiAgICB9KSxcbiAgICBhMTF5X2ltZ19yZWR1bmRhbnRfYWx0OiB7XG4gICAgICAgIGNvZGU6ICdhMTF5LWltZy1yZWR1bmRhbnQtYWx0JyxcbiAgICAgICAgbWVzc2FnZTogJ0ExMXk6IFNjcmVlbnJlYWRlcnMgYWxyZWFkeSBhbm5vdW5jZSA8aW1nPiBlbGVtZW50cyBhcyBhbiBpbWFnZS4nXG4gICAgfSxcbiAgICBhMTF5X2xhYmVsX2hhc19hc3NvY2lhdGVkX2NvbnRyb2w6IHtcbiAgICAgICAgY29kZTogJ2ExMXktbGFiZWwtaGFzLWFzc29jaWF0ZWQtY29udHJvbCcsXG4gICAgICAgIG1lc3NhZ2U6ICdBMTF5OiBBIGZvcm0gbGFiZWwgbXVzdCBiZSBhc3NvY2lhdGVkIHdpdGggYSBjb250cm9sLidcbiAgICB9LFxuICAgIGExMXlfbWVkaWFfaGFzX2NhcHRpb246IHtcbiAgICAgICAgY29kZTogJ2ExMXktbWVkaWEtaGFzLWNhcHRpb24nLFxuICAgICAgICBtZXNzYWdlOiAnQTExeTogPHZpZGVvPiBlbGVtZW50cyBtdXN0IGhhdmUgYSA8dHJhY2sga2luZD1cImNhcHRpb25zXCI+J1xuICAgIH0sXG4gICAgYTExeV9kaXN0cmFjdGluZ19lbGVtZW50czogKG5hbWUpID0+ICh7XG4gICAgICAgIGNvZGU6ICdhMTF5LWRpc3RyYWN0aW5nLWVsZW1lbnRzJyxcbiAgICAgICAgbWVzc2FnZTogYEExMXk6IEF2b2lkIDwke25hbWV9PiBlbGVtZW50c2BcbiAgICB9KSxcbiAgICBhMTF5X3N0cnVjdHVyZV9pbW1lZGlhdGU6IHtcbiAgICAgICAgY29kZTogJ2ExMXktc3RydWN0dXJlJyxcbiAgICAgICAgbWVzc2FnZTogJ0ExMXk6IDxmaWdjYXB0aW9uPiBtdXN0IGJlIGFuIGltbWVkaWF0ZSBjaGlsZCBvZiA8ZmlndXJlPidcbiAgICB9LFxuICAgIGExMXlfc3RydWN0dXJlX2ZpcnN0X29yX2xhc3Q6IHtcbiAgICAgICAgY29kZTogJ2ExMXktc3RydWN0dXJlJyxcbiAgICAgICAgbWVzc2FnZTogJ0ExMXk6IDxmaWdjYXB0aW9uPiBtdXN0IGJlIGZpcnN0IG9yIGxhc3QgY2hpbGQgb2YgPGZpZ3VyZT4nXG4gICAgfSxcbiAgICBhMTF5X21vdXNlX2V2ZW50c19oYXZlX2tleV9ldmVudHM6IChldmVudCwgYWNjb21wYW5pZWRfYnkpID0+ICh7XG4gICAgICAgIGNvZGU6ICdhMTF5LW1vdXNlLWV2ZW50cy1oYXZlLWtleS1ldmVudHMnLFxuICAgICAgICBtZXNzYWdlOiBgQTExeTogb246JHtldmVudH0gbXVzdCBiZSBhY2NvbXBhbmllZCBieSBvbjoke2FjY29tcGFuaWVkX2J5fWBcbiAgICB9KSxcbiAgICBhMTF5X2NsaWNrX2V2ZW50c19oYXZlX2tleV9ldmVudHM6ICgpID0+ICh7XG4gICAgICAgIGNvZGU6ICdhMTF5LWNsaWNrLWV2ZW50cy1oYXZlLWtleS1ldmVudHMnLFxuICAgICAgICBtZXNzYWdlOiAnQTExeTogdmlzaWJsZSwgbm9uLWludGVyYWN0aXZlIGVsZW1lbnRzIHdpdGggYW4gb246Y2xpY2sgZXZlbnQgbXVzdCBiZSBhY2NvbXBhbmllZCBieSBhbiBvbjprZXlkb3duLCBvbjprZXl1cCwgb3Igb246a2V5cHJlc3MgZXZlbnQuJ1xuICAgIH0pLFxuICAgIGExMXlfbWlzc2luZ19jb250ZW50OiAobmFtZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ2ExMXktbWlzc2luZy1jb250ZW50JyxcbiAgICAgICAgbWVzc2FnZTogYEExMXk6IDwke25hbWV9PiBlbGVtZW50IHNob3VsZCBoYXZlIGNoaWxkIGNvbnRlbnRgXG4gICAgfSksXG4gICAgYTExeV9ub19ub25pbnRlcmFjdGl2ZV90YWJpbmRleDoge1xuICAgICAgICBjb2RlOiAnYTExeS1uby1ub25pbnRlcmFjdGl2ZS10YWJpbmRleCcsXG4gICAgICAgIG1lc3NhZ2U6ICdBMTF5OiBub25pbnRlcmFjdGl2ZSBlbGVtZW50IGNhbm5vdCBoYXZlIHBvc2l0aXZlIHRhYkluZGV4IHZhbHVlJ1xuICAgIH0sXG4gICAgcmVkdW5kYW50X2V2ZW50X21vZGlmaWVyX2Zvcl90b3VjaDoge1xuICAgICAgICBjb2RlOiAncmVkdW5kYW50LWV2ZW50LW1vZGlmaWVyJyxcbiAgICAgICAgbWVzc2FnZTogJ1RvdWNoIGV2ZW50IGhhbmRsZXJzIHRoYXQgZG9uXFwndCB1c2UgdGhlIFxcJ2V2ZW50XFwnIG9iamVjdCBhcmUgcGFzc2l2ZSBieSBkZWZhdWx0J1xuICAgIH0sXG4gICAgcmVkdW5kYW50X2V2ZW50X21vZGlmaWVyX3Bhc3NpdmU6IHtcbiAgICAgICAgY29kZTogJ3JlZHVuZGFudC1ldmVudC1tb2RpZmllcicsXG4gICAgICAgIG1lc3NhZ2U6ICdUaGUgcGFzc2l2ZSBtb2RpZmllciBvbmx5IHdvcmtzIHdpdGggd2hlZWwgYW5kIHRvdWNoIGV2ZW50cydcbiAgICB9LFxuICAgIGludmFsaWRfcmVzdF9lYWNoYmxvY2tfYmluZGluZzogKHJlc3RfZWxlbWVudF9uYW1lKSA9PiAoe1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1yZXN0LWVhY2hibG9jay1iaW5kaW5nJyxcbiAgICAgICAgbWVzc2FnZTogYC4uLiR7cmVzdF9lbGVtZW50X25hbWV9IG9wZXJhdG9yIHdpbGwgY3JlYXRlIGEgbmV3IG9iamVjdCBhbmQgYmluZGluZyBwcm9wb2dhdGlvbiB3aXRoIG9yaWdpbmFsIG9iamVjdCB3aWxsIG5vdCB3b3JrYFxuICAgIH0pXG59O1xuXG5jb25zdCByZWdleF9ub25fd2hpdGVzcGFjZV9jaGFyYWN0ZXJzID0gL1teIFxcclxcblxcZlxcdlxcdF0vO1xuY2xhc3MgQWJzdHJhY3RCbG9jayBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgfVxuICAgIHdhcm5faWZfZW1wdHlfYmxvY2soKSB7XG4gICAgICAgIGlmICghdGhpcy5jaGlsZHJlbiB8fCB0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDEpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IGNoaWxkID0gdGhpcy5jaGlsZHJlblswXTtcbiAgICAgICAgaWYgKCFjaGlsZCB8fCAoY2hpbGQudHlwZSA9PT0gJ1RleHQnICYmICFyZWdleF9ub25fd2hpdGVzcGFjZV9jaGFyYWN0ZXJzLnRlc3QoY2hpbGQuZGF0YSkpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudC53YXJuKHRoaXMsIGNvbXBpbGVyX3dhcm5pbmdzLmVtcHR5X2Jsb2NrKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZmxhdHRlbl9yZWZlcmVuY2Uobm9kZSkge1xuICAgIGNvbnN0IG5vZGVzID0gW107XG4gICAgY29uc3QgcGFydHMgPSBbXTtcbiAgICB3aGlsZSAobm9kZS50eXBlID09PSAnTWVtYmVyRXhwcmVzc2lvbicpIHtcbiAgICAgICAgbm9kZXMudW5zaGlmdChub2RlLnByb3BlcnR5KTtcbiAgICAgICAgaWYgKCFub2RlLmNvbXB1dGVkKSB7XG4gICAgICAgICAgICBwYXJ0cy51bnNoaWZ0KG5vZGUucHJvcGVydHkubmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBjb21wdXRlZF9wcm9wZXJ0eSA9IHRvX3N0cmluZyQxKG5vZGUucHJvcGVydHkpO1xuICAgICAgICAgICAgaWYgKGNvbXB1dGVkX3Byb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgcGFydHMudW5zaGlmdChgWyR7Y29tcHV0ZWRfcHJvcGVydHl9XWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG5vZGUgPSBub2RlLm9iamVjdDtcbiAgICB9XG4gICAgY29uc3QgbmFtZSA9IG5vZGUudHlwZSA9PT0gJ0lkZW50aWZpZXInXG4gICAgICAgID8gbm9kZS5uYW1lXG4gICAgICAgIDogbm9kZS50eXBlID09PSAnVGhpc0V4cHJlc3Npb24nID8gJ3RoaXMnIDogbnVsbDtcbiAgICBub2Rlcy51bnNoaWZ0KG5vZGUpO1xuICAgIHBhcnRzLnVuc2hpZnQobmFtZSk7XG4gICAgcmV0dXJuIHsgbmFtZSwgbm9kZXMsIHBhcnRzIH07XG59XG5mdW5jdGlvbiB0b19zdHJpbmckMShub2RlKSB7XG4gICAgc3dpdGNoIChub2RlLnR5cGUpIHtcbiAgICAgICAgY2FzZSAnTGl0ZXJhbCc6XG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKG5vZGUudmFsdWUpO1xuICAgICAgICBjYXNlICdJZGVudGlmaWVyJzpcbiAgICAgICAgICAgIHJldHVybiBub2RlLm5hbWU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVfc2NvcGVzKGV4cHJlc3Npb24pIHtcbiAgICByZXR1cm4gYW5hbHl6ZShleHByZXNzaW9uKTtcbn1cblxuZnVuY3Rpb24gZ2V0X29iamVjdChub2RlKSB7XG4gICAgd2hpbGUgKG5vZGUudHlwZSA9PT0gJ01lbWJlckV4cHJlc3Npb24nKVxuICAgICAgICBub2RlID0gbm9kZS5vYmplY3Q7XG4gICAgcmV0dXJuIG5vZGU7XG59XG5cbmNvbnN0IHJlc2VydmVkX2tleXdvcmRzID0gbmV3IFNldChbJyQkcHJvcHMnLCAnJCRyZXN0UHJvcHMnLCAnJCRzbG90cyddKTtcbmZ1bmN0aW9uIGlzX3Jlc2VydmVkX2tleXdvcmQobmFtZSkge1xuICAgIHJldHVybiByZXNlcnZlZF9rZXl3b3Jkcy5oYXMobmFtZSk7XG59XG5cbmZ1bmN0aW9uIGlzX2R5bmFtaWModmFyaWFibGUpIHtcbiAgICBpZiAodmFyaWFibGUpIHtcbiAgICAgICAgaWYgKHZhcmlhYmxlLm11dGF0ZWQgfHwgdmFyaWFibGUucmVhc3NpZ25lZClcbiAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBkeW5hbWljIGludGVybmFsIHN0YXRlXG4gICAgICAgIGlmICghdmFyaWFibGUubW9kdWxlICYmIHZhcmlhYmxlLndyaXRhYmxlICYmIHZhcmlhYmxlLmV4cG9ydF9uYW1lKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIHdyaXRhYmxlIHByb3BzXG4gICAgICAgIGlmIChpc19yZXNlcnZlZF9rZXl3b3JkKHZhcmlhYmxlLm5hbWUpKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gbm9kZXNfbWF0Y2goYSwgYikge1xuICAgIGlmICghIWEgIT09ICEhYilcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChBcnJheS5pc0FycmF5KGEpICE9PSBBcnJheS5pc0FycmF5KGIpKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGEgJiYgdHlwZW9mIGEgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGEpKSB7XG4gICAgICAgICAgICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiBhLmV2ZXJ5KChjaGlsZCwgaSkgPT4gbm9kZXNfbWF0Y2goY2hpbGQsIGJbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhX2tleXMgPSBPYmplY3Qua2V5cyhhKS5zb3J0KCk7XG4gICAgICAgIGNvbnN0IGJfa2V5cyA9IE9iamVjdC5rZXlzKGIpLnNvcnQoKTtcbiAgICAgICAgaWYgKGFfa2V5cy5sZW5ndGggIT09IGJfa2V5cy5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGxldCBpID0gYV9rZXlzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgY29uc3Qga2V5ID0gYV9rZXlzW2ldO1xuICAgICAgICAgICAgaWYgKGJfa2V5c1tpXSAhPT0ga2V5KVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICdzdGFydCcgfHwga2V5ID09PSAnZW5kJylcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIGlmICghbm9kZXNfbWF0Y2goYVtrZXldLCBiW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gYSA9PT0gYjtcbn1cblxuZnVuY3Rpb24gaW52YWxpZGF0ZShyZW5kZXJlciwgc2NvcGUsIG5vZGUsIG5hbWVzLCBtYWluX2V4ZWN1dGlvbl9jb250ZXh0ID0gZmFsc2UpIHtcbiAgICBjb25zdCB7IGNvbXBvbmVudCB9ID0gcmVuZGVyZXI7XG4gICAgY29uc3QgW2hlYWQsIC4uLnRhaWxdID0gQXJyYXkuZnJvbShuYW1lcylcbiAgICAgICAgLmZpbHRlcihuYW1lID0+IHtcbiAgICAgICAgY29uc3Qgb3duZXIgPSBzY29wZS5maW5kX293bmVyKG5hbWUpO1xuICAgICAgICByZXR1cm4gIW93bmVyIHx8IG93bmVyID09PSBjb21wb25lbnQuaW5zdGFuY2Vfc2NvcGU7XG4gICAgfSlcbiAgICAgICAgLm1hcChuYW1lID0+IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChuYW1lKSlcbiAgICAgICAgLmZpbHRlcih2YXJpYWJsZSA9PiB7XG4gICAgICAgIHJldHVybiB2YXJpYWJsZSAmJiAoIXZhcmlhYmxlLmhvaXN0YWJsZSAmJlxuICAgICAgICAgICAgIXZhcmlhYmxlLmdsb2JhbCAmJlxuICAgICAgICAgICAgIXZhcmlhYmxlLm1vZHVsZSAmJlxuICAgICAgICAgICAgKHZhcmlhYmxlLnJlZmVyZW5jZWQgfHxcbiAgICAgICAgICAgICAgICB2YXJpYWJsZS5zdWJzY3JpYmFibGUgfHxcbiAgICAgICAgICAgICAgICB2YXJpYWJsZS5pc19yZWFjdGl2ZV9kZXBlbmRlbmN5IHx8XG4gICAgICAgICAgICAgICAgdmFyaWFibGUuZXhwb3J0X25hbWUgfHxcbiAgICAgICAgICAgICAgICB2YXJpYWJsZS5uYW1lWzBdID09PSAnJCcpKTtcbiAgICB9KTtcbiAgICBmdW5jdGlvbiBnZXRfaW52YWxpZGF0ZWQodmFyaWFibGUsIG5vZGUpIHtcbiAgICAgICAgaWYgKG1haW5fZXhlY3V0aW9uX2NvbnRleHQgJiYgIXZhcmlhYmxlLnN1YnNjcmliYWJsZSAmJiB2YXJpYWJsZS5uYW1lWzBdICE9PSAnJCcpIHtcbiAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZW5kZXJlcl9pbnZhbGlkYXRlKHJlbmRlcmVyLCB2YXJpYWJsZS5uYW1lLCB1bmRlZmluZWQsIG1haW5fZXhlY3V0aW9uX2NvbnRleHQpO1xuICAgIH1cbiAgICBpZiAoIWhlYWQpIHtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuICAgIGNvbXBvbmVudC5oYXNfcmVhY3RpdmVfYXNzaWdubWVudHMgPSB0cnVlO1xuICAgIGlmIChub2RlLnR5cGUgPT09ICdBc3NpZ25tZW50RXhwcmVzc2lvbicgJiYgbm9kZS5vcGVyYXRvciA9PT0gJz0nICYmIG5vZGVzX21hdGNoKG5vZGUubGVmdCwgbm9kZS5yaWdodCkgJiYgdGFpbC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGdldF9pbnZhbGlkYXRlZChoZWFkLCBub2RlKTtcbiAgICB9XG4gICAgY29uc3QgaXNfc3RvcmVfdmFsdWUgPSBoZWFkLm5hbWVbMF0gPT09ICckJyAmJiBoZWFkLm5hbWVbMV0gIT09ICckJztcbiAgICBjb25zdCBleHRyYV9hcmdzID0gdGFpbC5tYXAodmFyaWFibGUgPT4gZ2V0X2ludmFsaWRhdGVkKHZhcmlhYmxlKSkuZmlsdGVyKEJvb2xlYW4pO1xuICAgIGlmIChpc19zdG9yZV92YWx1ZSkge1xuICAgICAgICByZXR1cm4geCBgQHNldF9zdG9yZV92YWx1ZSgke2hlYWQubmFtZS5zbGljZSgxKX0sICR7bm9kZX0sICR7aGVhZC5uYW1lfSwgJHtleHRyYV9hcmdzfSlgO1xuICAgIH1cbiAgICBsZXQgaW52YWxpZGF0ZTtcbiAgICBpZiAoIW1haW5fZXhlY3V0aW9uX2NvbnRleHQpIHtcbiAgICAgICAgY29uc3QgcGFzc192YWx1ZSA9IChleHRyYV9hcmdzLmxlbmd0aCA+IDAgfHxcbiAgICAgICAgICAgIChub2RlLnR5cGUgPT09ICdBc3NpZ25tZW50RXhwcmVzc2lvbicgJiYgbm9kZS5sZWZ0LnR5cGUgIT09ICdJZGVudGlmaWVyJykgfHxcbiAgICAgICAgICAgIChub2RlLnR5cGUgPT09ICdVcGRhdGVFeHByZXNzaW9uJyAmJiAoIW5vZGUucHJlZml4IHx8IG5vZGUuYXJndW1lbnQudHlwZSAhPT0gJ0lkZW50aWZpZXInKSkpO1xuICAgICAgICBpZiAocGFzc192YWx1ZSkge1xuICAgICAgICAgICAgZXh0cmFfYXJncy51bnNoaWZ0KHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnSWRlbnRpZmllcicsXG4gICAgICAgICAgICAgICAgbmFtZTogaGVhZC5uYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpbnZhbGlkYXRlID0geCBgJCRpbnZhbGlkYXRlKCR7cmVuZGVyZXIuY29udGV4dF9sb29rdXAuZ2V0KGhlYWQubmFtZSkuaW5kZXh9LCAke25vZGV9LCAke2V4dHJhX2FyZ3N9KWA7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvLyBza2lwIGAkJGludmFsaWRhdGVgIGlmIGl0IGlzIGluIHRoZSBtYWluIGV4ZWN1dGlvbiBjb250ZXh0XG4gICAgICAgIGludmFsaWRhdGUgPSBleHRyYV9hcmdzLmxlbmd0aCA/IFtub2RlLCAuLi5leHRyYV9hcmdzXSA6IG5vZGU7XG4gICAgfVxuICAgIGlmIChoZWFkLnN1YnNjcmliYWJsZSAmJiBoZWFkLnJlYXNzaWduZWQpIHtcbiAgICAgICAgY29uc3Qgc3Vic2NyaWJlID0gYCQkc3Vic2NyaWJlXyR7aGVhZC5uYW1lfWA7XG4gICAgICAgIGludmFsaWRhdGUgPSB4IGAke3N1YnNjcmliZX0oJHtpbnZhbGlkYXRlfSlgO1xuICAgIH1cbiAgICByZXR1cm4gaW52YWxpZGF0ZTtcbn1cbmZ1bmN0aW9uIHJlbmRlcmVyX2ludmFsaWRhdGUocmVuZGVyZXIsIG5hbWUsIHZhbHVlLCBtYWluX2V4ZWN1dGlvbl9jb250ZXh0ID0gZmFsc2UpIHtcbiAgICBjb25zdCB2YXJpYWJsZSA9IHJlbmRlcmVyLmNvbXBvbmVudC52YXJfbG9va3VwLmdldChuYW1lKTtcbiAgICBpZiAodmFyaWFibGUgJiYgKHZhcmlhYmxlLnN1YnNjcmliYWJsZSAmJiAodmFyaWFibGUucmVhc3NpZ25lZCB8fCB2YXJpYWJsZS5leHBvcnRfbmFtZSkpKSB7XG4gICAgICAgIGlmIChtYWluX2V4ZWN1dGlvbl9jb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4geCBgJHtgJCRzdWJzY3JpYmVfJHtuYW1lfWB9KCR7dmFsdWUgfHwgbmFtZX0pYDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG1lbWJlciA9IHJlbmRlcmVyLmNvbnRleHRfbG9va3VwLmdldChuYW1lKTtcbiAgICAgICAgICAgIHJldHVybiB4IGAke2AkJHN1YnNjcmliZV8ke25hbWV9YH0oJCRpbnZhbGlkYXRlKCR7bWVtYmVyLmluZGV4fSwgJHt2YWx1ZSB8fCBuYW1lfSkpYDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAobmFtZVswXSA9PT0gJyQnICYmIG5hbWVbMV0gIT09ICckJykge1xuICAgICAgICByZXR1cm4geCBgJHtuYW1lLnNsaWNlKDEpfS5zZXQoJHt2YWx1ZSB8fCBuYW1lfSlgO1xuICAgIH1cbiAgICBpZiAodmFyaWFibGUgJiYgKHZhcmlhYmxlLm1vZHVsZSB8fCAoIXZhcmlhYmxlLnJlZmVyZW5jZWQgJiZcbiAgICAgICAgIXZhcmlhYmxlLmlzX3JlYWN0aXZlX2RlcGVuZGVuY3kgJiZcbiAgICAgICAgIXZhcmlhYmxlLmV4cG9ydF9uYW1lICYmXG4gICAgICAgICFuYW1lLnN0YXJ0c1dpdGgoJyQkJykpKSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgfHwgbmFtZTtcbiAgICB9XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIGlmIChtYWluX2V4ZWN1dGlvbl9jb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4geCBgJHt2YWx1ZX1gO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbWVtYmVyID0gcmVuZGVyZXIuY29udGV4dF9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIHggYCQkaW52YWxpZGF0ZSgke21lbWJlci5pbmRleH0sICR7dmFsdWV9KWA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1haW5fZXhlY3V0aW9uX2NvbnRleHQpXG4gICAgICAgIHJldHVybjtcbiAgICAvLyBpZiB0aGlzIGlzIGEgcmVhY3RpdmUgZGVjbGFyYXRpb24sIGludmFsaWRhdGUgZGVwZW5kZW5jaWVzIHJlY3Vyc2l2ZWx5XG4gICAgY29uc3QgZGVwcyA9IG5ldyBTZXQoW25hbWVdKTtcbiAgICBkZXBzLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgIGNvbnN0IHJlYWN0aXZlX2RlY2xhcmF0aW9ucyA9IHJlbmRlcmVyLmNvbXBvbmVudC5yZWFjdGl2ZV9kZWNsYXJhdGlvbnMuZmlsdGVyKHggPT4geC5hc3NpZ25lZXMuaGFzKG5hbWUpKTtcbiAgICAgICAgcmVhY3RpdmVfZGVjbGFyYXRpb25zLmZvckVhY2goZGVjbGFyYXRpb24gPT4ge1xuICAgICAgICAgICAgZGVjbGFyYXRpb24uZGVwZW5kZW5jaWVzLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgZGVwcy5hZGQobmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgLy8gVE9ETyBpZGVhbGx5IGdsb2JhbHMgZXRjIHdvdWxkbid0IGJlIGhlcmUgaW4gdGhlIGZpcnN0IHBsYWNlXG4gICAgY29uc3QgZmlsdGVyZWQgPSBBcnJheS5mcm9tKGRlcHMpLmZpbHRlcihuID0+IHJlbmRlcmVyLmNvbnRleHRfbG9va3VwLmhhcyhuKSk7XG4gICAgaWYgKCFmaWx0ZXJlZC5sZW5ndGgpXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIHJldHVybiBmaWx0ZXJlZFxuICAgICAgICAubWFwKG4gPT4geCBgJCRpbnZhbGlkYXRlKCR7cmVuZGVyZXIuY29udGV4dF9sb29rdXAuZ2V0KG4pLmluZGV4fSwgJHtufSlgKVxuICAgICAgICAucmVkdWNlKChsaHMsIHJocykgPT4geCBgJHtsaHN9LCAke3Joc31gKTtcbn1cblxuZnVuY3Rpb24gcmVwbGFjZV9vYmplY3Qobm9kZSwgcmVwbGFjZW1lbnQpIHtcbiAgICBpZiAobm9kZS50eXBlID09PSAnSWRlbnRpZmllcicpXG4gICAgICAgIHJldHVybiByZXBsYWNlbWVudDtcbiAgICBjb25zdCBhbmNlc3RvciA9IG5vZGU7XG4gICAgbGV0IHBhcmVudDtcbiAgICB3aGlsZSAobm9kZS50eXBlID09PSAnTWVtYmVyRXhwcmVzc2lvbicpIHtcbiAgICAgICAgcGFyZW50ID0gbm9kZTtcbiAgICAgICAgbm9kZSA9IG5vZGUub2JqZWN0O1xuICAgIH1cbiAgICBwYXJlbnQub2JqZWN0ID0gcmVwbGFjZW1lbnQ7XG4gICAgcmV0dXJuIGFuY2VzdG9yO1xufVxuXG5mdW5jdGlvbiBpc19jb250ZXh0dWFsKGNvbXBvbmVudCwgc2NvcGUsIG5hbWUpIHtcbiAgICBpZiAoaXNfcmVzZXJ2ZWRfa2V5d29yZChuYW1lKSlcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gaWYgaXQncyBhIG5hbWUgYmVsb3cgcm9vdCBzY29wZSwgaXQncyBjb250ZXh0dWFsXG4gICAgaWYgKCFzY29wZS5pc190b3BfbGV2ZWwobmFtZSkpXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIGNvbnN0IHZhcmlhYmxlID0gY29tcG9uZW50LnZhcl9sb29rdXAuZ2V0KG5hbWUpO1xuICAgIC8vIGhvaXN0YWJsZXMsIG1vZHVsZSBkZWNsYXJhdGlvbnMsIGFuZCBpbXBvcnRzIGFyZSBub24tY29udGV4dHVhbFxuICAgIGlmICghdmFyaWFibGUgfHwgdmFyaWFibGUuaG9pc3RhYmxlKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgLy8gYXNzdW1lIGNvbnRleHR1YWxcbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuLy8gYWRhcHRlZCBmcm9tIGtsb25hIHYyLjAuNCAtIGh0dHBzOi8vZ2l0aHViLmNvbS9sdWtlZWQva2xvbmFcbi8vIChjKSBMdWtlIEVkd2FyZHMsIHVuZGVyIE1JVCBMaWNlbnNlXG4vLyBUaGUgc29sZSBtb2RpZmljYXRpb24gaXMgdG8gc2tpcCBmdW5jdGlvbiB2YWx1ZXMgaW4gb2JqZWN0cyB3aGVuIGNsb25pbmcsIHNvIHdlIGRvbid0IGJyZWFrIHRlc3RzLlxuZnVuY3Rpb24gY2xvbmUodmFsKSB7XG4gICAgbGV0IGssIG91dCwgdG1wO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbCkpIHtcbiAgICAgICAgb3V0ID0gQXJyYXkoayA9IHZhbC5sZW5ndGgpO1xuICAgICAgICB3aGlsZSAoay0tKVxuICAgICAgICAgICAgb3V0W2tdID0gKHRtcCA9IHZhbFtrXSkgJiYgdHlwZW9mIHRtcCA9PT0gJ29iamVjdCcgPyBjbG9uZSh0bXApIDogdG1wO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH1cbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgICAgIG91dCA9IHt9OyAvLyBudWxsXG4gICAgICAgIGZvciAoayBpbiB2YWwpIHtcbiAgICAgICAgICAgIGlmIChrID09PSAnX19wcm90b19fJykge1xuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvdXQsIGssIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNsb25lKHZhbFtrXSksXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YWxba10gIT09ICdmdW5jdGlvbicpIHsgLy8gTU9ESUZJQ0FUSU9OOiBza2lwIGZ1bmN0aW9uc1xuICAgICAgICAgICAgICAgIG91dFtrXSA9ICh0bXAgPSB2YWxba10pICYmIHR5cGVvZiB0bXAgPT09ICdvYmplY3QnID8gY2xvbmUodG1wKSA6IHRtcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH1cbiAgICByZXR1cm4gdmFsO1xufVxuXG4vLyBBbGwgY29tcGlsZXIgZXJyb3JzIHNob3VsZCBiZSBsaXN0ZWQgYW5kIGFjY2Vzc2VkIGZyb20gaGVyZVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xudmFyIGNvbXBpbGVyX2Vycm9ycyA9IHtcbiAgICBpbnZhbGlkX2JpbmRpbmdfZWxlbWVudHM6IChlbGVtZW50LCBiaW5kaW5nKSA9PiAoe1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1iaW5kaW5nJyxcbiAgICAgICAgbWVzc2FnZTogYCcke2JpbmRpbmd9JyBpcyBub3QgYSB2YWxpZCBiaW5kaW5nIG9uIDwke2VsZW1lbnR9PiBlbGVtZW50c2BcbiAgICB9KSxcbiAgICBpbnZhbGlkX2JpbmRpbmdfZWxlbWVudF93aXRoOiAoZWxlbWVudHMsIGJpbmRpbmcpID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWJpbmRpbmcnLFxuICAgICAgICBtZXNzYWdlOiBgJyR7YmluZGluZ30nIGJpbmRpbmcgY2FuIG9ubHkgYmUgdXNlZCB3aXRoICR7ZWxlbWVudHN9YFxuICAgIH0pLFxuICAgIGludmFsaWRfYmluZGluZ19vbjogKGJpbmRpbmcsIGVsZW1lbnQsIHBvc3QpID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWJpbmRpbmcnLFxuICAgICAgICBtZXNzYWdlOiBgJyR7YmluZGluZ30nIGlzIG5vdCBhIHZhbGlkIGJpbmRpbmcgb24gJHtlbGVtZW50fWAgKyAocG9zdCB8fCAnJylcbiAgICB9KSxcbiAgICBpbnZhbGlkX2JpbmRpbmdfZm9yZWlnbjogKGJpbmRpbmcpID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWJpbmRpbmcnLFxuICAgICAgICBtZXNzYWdlOiBgJyR7YmluZGluZ30nIGlzIG5vdCBhIHZhbGlkIGJpbmRpbmcuIEZvcmVpZ24gZWxlbWVudHMgb25seSBzdXBwb3J0IGJpbmQ6dGhpc2BcbiAgICB9KSxcbiAgICBpbnZhbGlkX2JpbmRpbmdfbm9fY2hlY2tib3g6IChiaW5kaW5nLCBpc19yYWRpbykgPT4gKHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtYmluZGluZycsXG4gICAgICAgIG1lc3NhZ2U6IGAnJHtiaW5kaW5nfScgYmluZGluZyBjYW4gb25seSBiZSB1c2VkIHdpdGggPGlucHV0IHR5cGU9XCJjaGVja2JveFwiPmAgKyAoaXNfcmFkaW8gPyAnIOKAlCBmb3IgPGlucHV0IHR5cGU9XCJyYWRpb1wiPiwgdXNlIFxcJ2dyb3VwXFwnIGJpbmRpbmcnIDogJycpXG4gICAgfSksXG4gICAgaW52YWxpZF9iaW5kaW5nOiAoYmluZGluZykgPT4gKHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtYmluZGluZycsXG4gICAgICAgIG1lc3NhZ2U6IGAnJHtiaW5kaW5nfScgaXMgbm90IGEgdmFsaWQgYmluZGluZ2BcbiAgICB9KSxcbiAgICBpbnZhbGlkX2JpbmRpbmdfd2luZG93OiAocGFydHMpID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWJpbmRpbmcnLFxuICAgICAgICBtZXNzYWdlOiBgQmluZGluZ3Mgb24gPHN2ZWx0ZTp3aW5kb3c+IG11c3QgYmUgdG8gdG9wLWxldmVsIHByb3BlcnRpZXMsIGUuZy4gJyR7cGFydHNbcGFydHMubGVuZ3RoIC0gMV19JyByYXRoZXIgdGhhbiAnJHtwYXJ0cy5qb2luKCcuJyl9J2BcbiAgICB9KSxcbiAgICBpbnZhbGlkX2JpbmRpbmdfbGV0OiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWJpbmRpbmcnLFxuICAgICAgICBtZXNzYWdlOiAnQ2Fubm90IGJpbmQgdG8gYSB2YXJpYWJsZSBkZWNsYXJlZCB3aXRoIHRoZSBsZXQ6IGRpcmVjdGl2ZSdcbiAgICB9LFxuICAgIGludmFsaWRfYmluZGluZ19hd2FpdDoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1iaW5kaW5nJyxcbiAgICAgICAgbWVzc2FnZTogJ0Nhbm5vdCBiaW5kIHRvIGEgdmFyaWFibGUgZGVjbGFyZWQgd2l0aCB7I2F3YWl0IC4uLiB0aGVufSBvciB7OmNhdGNofSBibG9ja3MnXG4gICAgfSxcbiAgICBpbnZhbGlkX2JpbmRpbmdfY29uc3Q6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtYmluZGluZycsXG4gICAgICAgIG1lc3NhZ2U6ICdDYW5ub3QgYmluZCB0byBhIHZhcmlhYmxlIGRlY2xhcmVkIHdpdGgge0Bjb25zdCAuLi59J1xuICAgIH0sXG4gICAgaW52YWxpZF9iaW5kaW5nX3dyaXRpYmFsZToge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1iaW5kaW5nJyxcbiAgICAgICAgbWVzc2FnZTogJ0Nhbm5vdCBiaW5kIHRvIGEgdmFyaWFibGUgd2hpY2ggaXMgbm90IHdyaXRhYmxlJ1xuICAgIH0sXG4gICAgYmluZGluZ191bmRlY2xhcmVkOiAobmFtZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ2JpbmRpbmctdW5kZWNsYXJlZCcsXG4gICAgICAgIG1lc3NhZ2U6IGAke25hbWV9IGlzIG5vdCBkZWNsYXJlZGBcbiAgICB9KSxcbiAgICBpbnZhbGlkX3R5cGU6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtdHlwZScsXG4gICAgICAgIG1lc3NhZ2U6ICdcXCd0eXBlXFwnIGF0dHJpYnV0ZSBjYW5ub3QgYmUgZHluYW1pYyBpZiBpbnB1dCB1c2VzIHR3by13YXkgYmluZGluZydcbiAgICB9LFxuICAgIG1pc3NpbmdfdHlwZToge1xuICAgICAgICBjb2RlOiAnbWlzc2luZy10eXBlJyxcbiAgICAgICAgbWVzc2FnZTogJ1xcJ3R5cGVcXCcgYXR0cmlidXRlIG11c3QgYmUgc3BlY2lmaWVkJ1xuICAgIH0sXG4gICAgZHluYW1pY19tdWx0aXBsZV9hdHRyaWJ1dGU6IHtcbiAgICAgICAgY29kZTogJ2R5bmFtaWMtbXVsdGlwbGUtYXR0cmlidXRlJyxcbiAgICAgICAgbWVzc2FnZTogJ1xcJ211bHRpcGxlXFwnIGF0dHJpYnV0ZSBjYW5ub3QgYmUgZHluYW1pYyBpZiBzZWxlY3QgdXNlcyB0d28td2F5IGJpbmRpbmcnXG4gICAgfSxcbiAgICBtaXNzaW5nX2NvbnRlbnRlZGl0YWJsZV9hdHRyaWJ1dGU6IHtcbiAgICAgICAgY29kZTogJ21pc3NpbmctY29udGVudGVkaXRhYmxlLWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6ICdcXCdjb250ZW50ZWRpdGFibGVcXCcgYXR0cmlidXRlIGlzIHJlcXVpcmVkIGZvciB0ZXh0Q29udGVudCBhbmQgaW5uZXJIVE1MIHR3by13YXkgYmluZGluZ3MnXG4gICAgfSxcbiAgICBkeW5hbWljX2NvbnRlbnRlZGl0YWJsZV9hdHRyaWJ1dGU6IHtcbiAgICAgICAgY29kZTogJ2R5bmFtaWMtY29udGVudGVkaXRhYmxlLWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6ICdcXCdjb250ZW50ZWRpdGFibGVcXCcgYXR0cmlidXRlIGNhbm5vdCBiZSBkeW5hbWljIGlmIGVsZW1lbnQgdXNlcyB0d28td2F5IGJpbmRpbmcnXG4gICAgfSxcbiAgICBpbnZhbGlkX2V2ZW50X21vZGlmaWVyX2NvbWJpbmF0aW9uOiAobW9kaWZpZXIxLCBtb2RpZmllcjIpID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWV2ZW50LW1vZGlmaWVyJyxcbiAgICAgICAgbWVzc2FnZTogYFRoZSAnJHttb2RpZmllcjF9JyBhbmQgJyR7bW9kaWZpZXIyfScgbW9kaWZpZXJzIGNhbm5vdCBiZSB1c2VkIHRvZ2V0aGVyYFxuICAgIH0pLFxuICAgIGludmFsaWRfZXZlbnRfbW9kaWZpZXJfbGVnYWN5OiAobW9kaWZpZXIpID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWV2ZW50LW1vZGlmaWVyJyxcbiAgICAgICAgbWVzc2FnZTogYFRoZSAnJHttb2RpZmllcn0nIG1vZGlmaWVyIGNhbm5vdCBiZSB1c2VkIGluIGxlZ2FjeSBtb2RlYFxuICAgIH0pLFxuICAgIGludmFsaWRfZXZlbnRfbW9kaWZpZXI6ICh2YWxpZCkgPT4gKHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtZXZlbnQtbW9kaWZpZXInLFxuICAgICAgICBtZXNzYWdlOiBgVmFsaWQgZXZlbnQgbW9kaWZpZXJzIGFyZSAke3ZhbGlkfWBcbiAgICB9KSxcbiAgICBpbnZhbGlkX2V2ZW50X21vZGlmaWVyX2NvbXBvbmVudDoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1ldmVudC1tb2RpZmllcicsXG4gICAgICAgIG1lc3NhZ2U6IFwiRXZlbnQgbW9kaWZpZXJzIG90aGVyIHRoYW4gJ29uY2UnIGNhbiBvbmx5IGJlIHVzZWQgb24gRE9NIGVsZW1lbnRzXCJcbiAgICB9LFxuICAgIHRleHRhcmVhX2R1cGxpY2F0ZV92YWx1ZToge1xuICAgICAgICBjb2RlOiAndGV4dGFyZWEtZHVwbGljYXRlLXZhbHVlJyxcbiAgICAgICAgbWVzc2FnZTogJ0EgPHRleHRhcmVhPiBjYW4gaGF2ZSBlaXRoZXIgYSB2YWx1ZSBhdHRyaWJ1dGUgb3IgKGVxdWl2YWxlbnRseSkgY2hpbGQgY29udGVudCwgYnV0IG5vdCBib3RoJ1xuICAgIH0sXG4gICAgaWxsZWdhbF9hdHRyaWJ1dGU6IChuYW1lKSA9PiAoe1xuICAgICAgICBjb2RlOiAnaWxsZWdhbC1hdHRyaWJ1dGUnLFxuICAgICAgICBtZXNzYWdlOiBgJyR7bmFtZX0nIGlzIG5vdCBhIHZhbGlkIGF0dHJpYnV0ZSBuYW1lYFxuICAgIH0pLFxuICAgIGludmFsaWRfc2xvdF9hdHRyaWJ1dGU6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtc2xvdC1hdHRyaWJ1dGUnLFxuICAgICAgICBtZXNzYWdlOiAnc2xvdCBhdHRyaWJ1dGUgY2Fubm90IGhhdmUgYSBkeW5hbWljIHZhbHVlJ1xuICAgIH0sXG4gICAgZHVwbGljYXRlX3Nsb3RfYXR0cmlidXRlOiAobmFtZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ2R1cGxpY2F0ZS1zbG90LWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6IGBEdXBsaWNhdGUgJyR7bmFtZX0nIHNsb3RgXG4gICAgfSksXG4gICAgaW52YWxpZF9zbG90dGVkX2NvbnRlbnQ6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtc2xvdHRlZC1jb250ZW50JyxcbiAgICAgICAgbWVzc2FnZTogJ0VsZW1lbnQgd2l0aCBhIHNsb3Q9XFwnLi4uXFwnIGF0dHJpYnV0ZSBtdXN0IGJlIGEgY2hpbGQgb2YgYSBjb21wb25lbnQgb3IgYSBkZXNjZW5kYW50IG9mIGEgY3VzdG9tIGVsZW1lbnQnXG4gICAgfSxcbiAgICBpbnZhbGlkX2F0dHJpYnV0ZV9oZWFkOiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6ICc8c3ZlbHRlOmhlYWQ+IHNob3VsZCBub3QgaGF2ZSBhbnkgYXR0cmlidXRlcyBvciBkaXJlY3RpdmVzJ1xuICAgIH0sXG4gICAgaW52YWxpZF9hY3Rpb246IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtYWN0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogJ0FjdGlvbnMgY2FuIG9ubHkgYmUgYXBwbGllZCB0byBET00gZWxlbWVudHMsIG5vdCBjb21wb25lbnRzJ1xuICAgIH0sXG4gICAgaW52YWxpZF9jbGFzczoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1jbGFzcycsXG4gICAgICAgIG1lc3NhZ2U6ICdDbGFzc2VzIGNhbiBvbmx5IGJlIGFwcGxpZWQgdG8gRE9NIGVsZW1lbnRzLCBub3QgY29tcG9uZW50cydcbiAgICB9LFxuICAgIGludmFsaWRfdHJhbnNpdGlvbjoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC10cmFuc2l0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogJ1RyYW5zaXRpb25zIGNhbiBvbmx5IGJlIGFwcGxpZWQgdG8gRE9NIGVsZW1lbnRzLCBub3QgY29tcG9uZW50cydcbiAgICB9LFxuICAgIGludmFsaWRfbGV0OiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWxldCcsXG4gICAgICAgIG1lc3NhZ2U6ICdsZXQgZGlyZWN0aXZlIHZhbHVlIG11c3QgYmUgYW4gaWRlbnRpZmllciBvciBhbiBvYmplY3QvYXJyYXkgcGF0dGVybidcbiAgICB9LFxuICAgIGludmFsaWRfc2xvdF9kaXJlY3RpdmU6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtc2xvdC1kaXJlY3RpdmUnLFxuICAgICAgICBtZXNzYWdlOiAnPHNsb3Q+IGNhbm5vdCBoYXZlIGRpcmVjdGl2ZXMnXG4gICAgfSxcbiAgICBkeW5hbWljX3Nsb3RfbmFtZToge1xuICAgICAgICBjb2RlOiAnZHluYW1pYy1zbG90LW5hbWUnLFxuICAgICAgICBtZXNzYWdlOiAnPHNsb3Q+IG5hbWUgY2Fubm90IGJlIGR5bmFtaWMnXG4gICAgfSxcbiAgICBpbnZhbGlkX3Nsb3RfbmFtZToge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1zbG90LW5hbWUnLFxuICAgICAgICBtZXNzYWdlOiAnZGVmYXVsdCBpcyBhIHJlc2VydmVkIHdvcmQg4oCUIGl0IGNhbm5vdCBiZSB1c2VkIGFzIGEgc2xvdCBuYW1lJ1xuICAgIH0sXG4gICAgaW52YWxpZF9zbG90X2F0dHJpYnV0ZV92YWx1ZV9taXNzaW5nOiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLXNsb3QtYXR0cmlidXRlJyxcbiAgICAgICAgbWVzc2FnZTogJ3Nsb3QgYXR0cmlidXRlIHZhbHVlIGlzIG1pc3NpbmcnXG4gICAgfSxcbiAgICBpbnZhbGlkX3Nsb3R0ZWRfY29udGVudF9mcmFnbWVudDoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1zbG90dGVkLWNvbnRlbnQnLFxuICAgICAgICBtZXNzYWdlOiAnPHN2ZWx0ZTpmcmFnbWVudD4gbXVzdCBiZSBhIGNoaWxkIG9mIGEgY29tcG9uZW50J1xuICAgIH0sXG4gICAgaWxsZWdhbF9hdHRyaWJ1dGVfdGl0bGU6IHtcbiAgICAgICAgY29kZTogJ2lsbGVnYWwtYXR0cmlidXRlJyxcbiAgICAgICAgbWVzc2FnZTogJzx0aXRsZT4gY2Fubm90IGhhdmUgYXR0cmlidXRlcydcbiAgICB9LFxuICAgIGlsbGVnYWxfc3RydWN0dXJlX3RpdGxlOiB7XG4gICAgICAgIGNvZGU6ICdpbGxlZ2FsLXN0cnVjdHVyZScsXG4gICAgICAgIG1lc3NhZ2U6ICc8dGl0bGU+IGNhbiBvbmx5IGNvbnRhaW4gdGV4dCBhbmQge3RhZ3N9J1xuICAgIH0sXG4gICAgZHVwbGljYXRlX3RyYW5zaXRpb246IChkaXJlY3RpdmUsIHBhcmVudF9kaXJlY3RpdmUpID0+IHtcbiAgICAgICAgZnVuY3Rpb24gZGVzY3JpYmUoX2RpcmVjdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuIF9kaXJlY3RpdmUgPT09ICd0cmFuc2l0aW9uJ1xuICAgICAgICAgICAgICAgID8gXCJhICd0cmFuc2l0aW9uJ1wiXG4gICAgICAgICAgICAgICAgOiBgYW4gJyR7X2RpcmVjdGl2ZX0nYDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtZXNzYWdlID0gZGlyZWN0aXZlID09PSBwYXJlbnRfZGlyZWN0aXZlXG4gICAgICAgICAgICA/IGBBbiBlbGVtZW50IGNhbiBvbmx5IGhhdmUgb25lICcke2RpcmVjdGl2ZX0nIGRpcmVjdGl2ZWBcbiAgICAgICAgICAgIDogYEFuIGVsZW1lbnQgY2Fubm90IGhhdmUgYm90aCAke2Rlc2NyaWJlKHBhcmVudF9kaXJlY3RpdmUpfSBkaXJlY3RpdmUgYW5kICR7ZGVzY3JpYmUoZGlyZWN0aXZlKX0gZGlyZWN0aXZlYDtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvZGU6ICdkdXBsaWNhdGUtdHJhbnNpdGlvbicsXG4gICAgICAgICAgICBtZXNzYWdlXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBjb250ZXh0dWFsX3N0b3JlOiB7XG4gICAgICAgIGNvZGU6ICdjb250ZXh0dWFsLXN0b3JlJyxcbiAgICAgICAgbWVzc2FnZTogJ1N0b3JlcyBtdXN0IGJlIGRlY2xhcmVkIGF0IHRoZSB0b3AgbGV2ZWwgb2YgdGhlIGNvbXBvbmVudCAodGhpcyBtYXkgY2hhbmdlIGluIGEgZnV0dXJlIHZlcnNpb24gb2YgU3ZlbHRlKSdcbiAgICB9LFxuICAgIGRlZmF1bHRfZXhwb3J0OiB7XG4gICAgICAgIGNvZGU6ICdkZWZhdWx0LWV4cG9ydCcsXG4gICAgICAgIG1lc3NhZ2U6ICdBIGNvbXBvbmVudCBjYW5ub3QgaGF2ZSBhIGRlZmF1bHQgZXhwb3J0J1xuICAgIH0sXG4gICAgaWxsZWdhbF9kZWNsYXJhdGlvbjoge1xuICAgICAgICBjb2RlOiAnaWxsZWdhbC1kZWNsYXJhdGlvbicsXG4gICAgICAgIG1lc3NhZ2U6ICdUaGUgJCBwcmVmaXggaXMgcmVzZXJ2ZWQsIGFuZCBjYW5ub3QgYmUgdXNlZCBmb3IgdmFyaWFibGUgYW5kIGltcG9ydCBuYW1lcydcbiAgICB9LFxuICAgIGlsbGVnYWxfc3Vic2NyaXB0aW9uOiB7XG4gICAgICAgIGNvZGU6ICdpbGxlZ2FsLXN1YnNjcmlwdGlvbicsXG4gICAgICAgIG1lc3NhZ2U6ICdDYW5ub3QgcmVmZXJlbmNlIHN0b3JlIHZhbHVlIGluc2lkZSA8c2NyaXB0IGNvbnRleHQ9XCJtb2R1bGVcIj4nXG4gICAgfSxcbiAgICBpbGxlZ2FsX2dsb2JhbDogKG5hbWUpID0+ICh7XG4gICAgICAgIGNvZGU6ICdpbGxlZ2FsLWdsb2JhbCcsXG4gICAgICAgIG1lc3NhZ2U6IGAke25hbWV9IGlzIGFuIGlsbGVnYWwgdmFyaWFibGUgbmFtZWBcbiAgICB9KSxcbiAgICBpbGxlZ2FsX3ZhcmlhYmxlX2RlY2xhcmF0aW9uOiB7XG4gICAgICAgIGNvZGU6ICdpbGxlZ2FsLXZhcmlhYmxlLWRlY2xhcmF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogJ0Nhbm5vdCBkZWNsYXJlIHNhbWUgdmFyaWFibGUgbmFtZSB3aGljaCBpcyBpbXBvcnRlZCBpbnNpZGUgPHNjcmlwdCBjb250ZXh0PVwibW9kdWxlXCI+J1xuICAgIH0sXG4gICAgY3ljbGljYWxfcmVhY3RpdmVfZGVjbGFyYXRpb246IChjeWNsZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ2N5Y2xpY2FsLXJlYWN0aXZlLWRlY2xhcmF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogYEN5Y2xpY2FsIGRlcGVuZGVuY3kgZGV0ZWN0ZWQ6ICR7Y3ljbGUuam9pbignIOKGkiAnKX1gXG4gICAgfSksXG4gICAgaW52YWxpZF90YWdfcHJvcGVydHk6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtdGFnLXByb3BlcnR5JyxcbiAgICAgICAgbWVzc2FnZTogXCJ0YWcgbmFtZSBtdXN0IGJlIHR3byBvciBtb3JlIHdvcmRzIGpvaW5lZCBieSB0aGUgJy0nIGNoYXJhY3RlclwiXG4gICAgfSxcbiAgICBpbnZhbGlkX3RhZ19hdHRyaWJ1dGU6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtdGFnLWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6IFwiJ3RhZycgbXVzdCBiZSBhIHN0cmluZyBsaXRlcmFsXCJcbiAgICB9LFxuICAgIGludmFsaWRfbmFtZXNwYWNlX3Byb3BlcnR5OiAobmFtZXNwYWNlLCBzdWdnZXN0aW9uKSA9PiAoe1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1uYW1lc3BhY2UtcHJvcGVydHknLFxuICAgICAgICBtZXNzYWdlOiBgSW52YWxpZCBuYW1lc3BhY2UgJyR7bmFtZXNwYWNlfSdgICsgKHN1Z2dlc3Rpb24gPyBgIChkaWQgeW91IG1lYW4gJyR7c3VnZ2VzdGlvbn0nPylgIDogJycpXG4gICAgfSksXG4gICAgaW52YWxpZF9uYW1lc3BhY2VfYXR0cmlidXRlOiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLW5hbWVzcGFjZS1hdHRyaWJ1dGUnLFxuICAgICAgICBtZXNzYWdlOiBcIlRoZSAnbmFtZXNwYWNlJyBhdHRyaWJ1dGUgbXVzdCBiZSBhIHN0cmluZyBsaXRlcmFsIHJlcHJlc2VudGluZyBhIHZhbGlkIG5hbWVzcGFjZVwiXG4gICAgfSxcbiAgICBpbnZhbGlkX2F0dHJpYnV0ZV92YWx1ZTogKG5hbWUpID0+ICh7XG4gICAgICAgIGNvZGU6IGBpbnZhbGlkLSR7bmFtZX0tdmFsdWVgLFxuICAgICAgICBtZXNzYWdlOiBgJHtuYW1lfSBhdHRyaWJ1dGUgbXVzdCBiZSB0cnVlIG9yIGZhbHNlYFxuICAgIH0pLFxuICAgIGludmFsaWRfb3B0aW9uc19hdHRyaWJ1dGVfdW5rbm93bjoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1vcHRpb25zLWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6ICc8c3ZlbHRlOm9wdGlvbnM+IHVua25vd24gYXR0cmlidXRlJ1xuICAgIH0sXG4gICAgaW52YWxpZF9vcHRpb25zX2F0dHJpYnV0ZToge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1vcHRpb25zLWF0dHJpYnV0ZScsXG4gICAgICAgIG1lc3NhZ2U6IFwiPHN2ZWx0ZTpvcHRpb25zPiBjYW4gb25seSBoYXZlIHN0YXRpYyAndGFnJywgJ25hbWVzcGFjZScsICdhY2Nlc3NvcnMnLCAnaW1tdXRhYmxlJyBhbmQgJ3ByZXNlcnZlV2hpdGVzcGFjZScgYXR0cmlidXRlc1wiXG4gICAgfSxcbiAgICBjc3NfaW52YWxpZF9nbG9iYWw6IHtcbiAgICAgICAgY29kZTogJ2Nzcy1pbnZhbGlkLWdsb2JhbCcsXG4gICAgICAgIG1lc3NhZ2U6ICc6Z2xvYmFsKC4uLikgY2FuIGJlIGF0IHRoZSBzdGFydCBvciBlbmQgb2YgYSBzZWxlY3RvciBzZXF1ZW5jZSwgYnV0IG5vdCBpbiB0aGUgbWlkZGxlJ1xuICAgIH0sXG4gICAgY3NzX2ludmFsaWRfZ2xvYmFsX3NlbGVjdG9yOiB7XG4gICAgICAgIGNvZGU6ICdjc3MtaW52YWxpZC1nbG9iYWwtc2VsZWN0b3InLFxuICAgICAgICBtZXNzYWdlOiAnOmdsb2JhbCguLi4pIG11c3QgY29udGFpbiBhIHNpbmdsZSBzZWxlY3RvcidcbiAgICB9LFxuICAgIGNzc19pbnZhbGlkX3NlbGVjdG9yOiAoc2VsZWN0b3IpID0+ICh7XG4gICAgICAgIGNvZGU6ICdjc3MtaW52YWxpZC1zZWxlY3RvcicsXG4gICAgICAgIG1lc3NhZ2U6IGBJbnZhbGlkIHNlbGVjdG9yIFwiJHtzZWxlY3Rvcn1cImBcbiAgICB9KSxcbiAgICBkdXBsaWNhdGVfYW5pbWF0aW9uOiB7XG4gICAgICAgIGNvZGU6ICdkdXBsaWNhdGUtYW5pbWF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogXCJBbiBlbGVtZW50IGNhbiBvbmx5IGhhdmUgb25lICdhbmltYXRlJyBkaXJlY3RpdmVcIlxuICAgIH0sXG4gICAgaW52YWxpZF9hbmltYXRpb25faW1tZWRpYXRlOiB7XG4gICAgICAgIGNvZGU6ICdpbnZhbGlkLWFuaW1hdGlvbicsXG4gICAgICAgIG1lc3NhZ2U6ICdBbiBlbGVtZW50IHRoYXQgdXNlcyB0aGUgYW5pbWF0ZSBkaXJlY3RpdmUgbXVzdCBiZSB0aGUgaW1tZWRpYXRlIGNoaWxkIG9mIGEga2V5ZWQgZWFjaCBibG9jaydcbiAgICB9LFxuICAgIGludmFsaWRfYW5pbWF0aW9uX2tleToge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1hbmltYXRpb24nLFxuICAgICAgICBtZXNzYWdlOiAnQW4gZWxlbWVudCB0aGF0IHVzZXMgdGhlIGFuaW1hdGUgZGlyZWN0aXZlIG11c3QgYmUgdXNlZCBpbnNpZGUgYSBrZXllZCBlYWNoIGJsb2NrLiBEaWQgeW91IGZvcmdldCB0byBhZGQgYSBrZXkgdG8geW91ciBlYWNoIGJsb2NrPydcbiAgICB9LFxuICAgIGludmFsaWRfYW5pbWF0aW9uX3NvbGU6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtYW5pbWF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogJ0FuIGVsZW1lbnQgdGhhdCB1c2VzIHRoZSBhbmltYXRlIGRpcmVjdGl2ZSBtdXN0IGJlIHRoZSBzb2xlIGNoaWxkIG9mIGEga2V5ZWQgZWFjaCBibG9jaydcbiAgICB9LFxuICAgIGludmFsaWRfYW5pbWF0aW9uX2R5bmFtaWNfZWxlbWVudDoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1hbmltYXRpb24nLFxuICAgICAgICBtZXNzYWdlOiAnPHN2ZWx0ZTplbGVtZW50PiBjYW5ub3QgaGF2ZSBhIGFuaW1hdGUgZGlyZWN0aXZlJ1xuICAgIH0sXG4gICAgaW52YWxpZF9kaXJlY3RpdmVfdmFsdWU6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtZGlyZWN0aXZlLXZhbHVlJyxcbiAgICAgICAgbWVzc2FnZTogJ0NhbiBvbmx5IGJpbmQgdG8gYW4gaWRlbnRpZmllciAoZS5nLiBgZm9vYCkgb3IgYSBtZW1iZXIgZXhwcmVzc2lvbiAoZS5nLiBgZm9vLmJhcmAgb3IgYGZvb1tiYXpdYCknXG4gICAgfSxcbiAgICBpbnZhbGlkX2NvbnN0X3BsYWNlbWVudDoge1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1jb25zdC1wbGFjZW1lbnQnLFxuICAgICAgICBtZXNzYWdlOiAne0Bjb25zdH0gbXVzdCBiZSB0aGUgaW1tZWRpYXRlIGNoaWxkIG9mIHsjaWZ9LCB7OmVsc2UgaWZ9LCB7OmVsc2V9LCB7I2VhY2h9LCB7OnRoZW59LCB7OmNhdGNofSwgPHN2ZWx0ZTpmcmFnbWVudD4gb3IgPENvbXBvbmVudD4nXG4gICAgfSxcbiAgICBpbnZhbGlkX2NvbnN0X2RlY2xhcmF0aW9uOiAobmFtZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtY29uc3QtZGVjbGFyYXRpb24nLFxuICAgICAgICBtZXNzYWdlOiBgJyR7bmFtZX0nIGhhcyBhbHJlYWR5IGJlZW4gZGVjbGFyZWRgXG4gICAgfSksXG4gICAgaW52YWxpZF9jb25zdF91cGRhdGU6IChuYW1lKSA9PiAoe1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1jb25zdC11cGRhdGUnLFxuICAgICAgICBtZXNzYWdlOiBgJyR7bmFtZX0nIGlzIGRlY2xhcmVkIHVzaW5nIHtAY29uc3QgLi4ufSBhbmQgaXMgcmVhZC1vbmx5YFxuICAgIH0pLFxuICAgIGN5Y2xpY2FsX2NvbnN0X3RhZ3M6IChjeWNsZSkgPT4gKHtcbiAgICAgICAgY29kZTogJ2N5Y2xpY2FsLWNvbnN0LXRhZ3MnLFxuICAgICAgICBtZXNzYWdlOiBgQ3ljbGljYWwgZGVwZW5kZW5jeSBkZXRlY3RlZDogJHtjeWNsZS5qb2luKCcg4oaSICcpfWBcbiAgICB9KSxcbiAgICBpbnZhbGlkX2NvbXBvbmVudF9zdHlsZV9kaXJlY3RpdmU6IHtcbiAgICAgICAgY29kZTogJ2ludmFsaWQtY29tcG9uZW50LXN0eWxlLWRpcmVjdGl2ZScsXG4gICAgICAgIG1lc3NhZ2U6ICdTdHlsZSBkaXJlY3RpdmVzIGNhbm5vdCBiZSB1c2VkIG9uIGNvbXBvbmVudHMnXG4gICAgfSxcbiAgICBpbnZhbGlkX3N0eWxlX2RpcmVjdGl2ZV9tb2RpZmllcjogKHZhbGlkKSA9PiAoe1xuICAgICAgICBjb2RlOiAnaW52YWxpZC1zdHlsZS1kaXJlY3RpdmUtbW9kaWZpZXInLFxuICAgICAgICBtZXNzYWdlOiBgVmFsaWQgbW9kaWZpZXJzIGZvciBzdHlsZSBkaXJlY3RpdmVzIGFyZTogJHt2YWxpZH1gXG4gICAgfSlcbn07XG5cbmNvbnN0IHJlZ2V4X2NvbnRhaW5zX3Rlcm1fZnVuY3Rpb25fZXhwcmVzc2lvbiA9IC9GdW5jdGlvbkV4cHJlc3Npb24vO1xuY2xhc3MgRXhwcmVzc2lvbiB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBvd25lciwgdGVtcGxhdGVfc2NvcGUsIGluZm8sIGxhenkpIHtcbiAgICAgICAgdGhpcy50eXBlID0gJ0V4cHJlc3Npb24nO1xuICAgICAgICB0aGlzLnJlZmVyZW5jZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLmNvbnRleHR1YWxfZGVwZW5kZW5jaWVzID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLmRlY2xhcmF0aW9ucyA9IFtdO1xuICAgICAgICB0aGlzLnVzZXNfY29udGV4dCA9IGZhbHNlO1xuICAgICAgICAvLyBUT0RPIHJldmVydCB0byBkaXJlY3QgcHJvcGVydHkgYWNjZXNzIGluIHByb2Q/XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHtcbiAgICAgICAgICAgIGNvbXBvbmVudDoge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBjb21wb25lbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubm9kZSA9IGluZm87XG4gICAgICAgIHRoaXMudGVtcGxhdGVfc2NvcGUgPSB0ZW1wbGF0ZV9zY29wZTtcbiAgICAgICAgdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICBjb25zdCB7IGRlcGVuZGVuY2llcywgY29udGV4dHVhbF9kZXBlbmRlbmNpZXMsIHJlZmVyZW5jZXMgfSA9IHRoaXM7XG4gICAgICAgIGxldCB7IG1hcCwgc2NvcGUgfSA9IGNyZWF0ZV9zY29wZXMoaW5mbyk7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICAgICAgdGhpcy5zY29wZV9tYXAgPSBtYXA7XG4gICAgICAgIGNvbnN0IGV4cHJlc3Npb24gPSB0aGlzO1xuICAgICAgICBsZXQgZnVuY3Rpb25fZXhwcmVzc2lvbjtcbiAgICAgICAgLy8gZGlzY292ZXIgZGVwZW5kZW5jaWVzLCBidXQgZG9uJ3QgY2hhbmdlIHRoZSBjb2RlIHlldFxuICAgICAgICB3YWxrKGluZm8sIHtcbiAgICAgICAgICAgIGVudGVyKG5vZGUsIHBhcmVudCwga2V5KSB7XG4gICAgICAgICAgICAgICAgLy8gZG9uJ3QgbWFuaXB1bGF0ZSBzaG9ydGhhbmQgcHJvcHMgdHdpY2VcbiAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAna2V5JyAmJiBwYXJlbnQuc2hvcnRoYW5kKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgLy8gZG9uJ3QgbWFuaXB1bGF0ZSBgaW1wb3J0Lm1ldGFgLCBgbmV3LnRhcmdldGBcbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnTWV0YVByb3BlcnR5JylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2tpcCgpO1xuICAgICAgICAgICAgICAgIGlmIChtYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlID0gbWFwLmdldChub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFmdW5jdGlvbl9leHByZXNzaW9uICYmIHJlZ2V4X2NvbnRhaW5zX3Rlcm1fZnVuY3Rpb25fZXhwcmVzc2lvbi50ZXN0KG5vZGUudHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25fZXhwcmVzc2lvbiA9IG5vZGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpc19yZWZlcmVuY2Uobm9kZSwgcGFyZW50KSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IG5hbWUsIG5vZGVzIH0gPSBmbGF0dGVuX3JlZmVyZW5jZShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlcy5hZGQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5oYXMobmFtZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lWzBdID09PSAnJCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0b3JlX25hbWUgPSBuYW1lLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXBsYXRlX3Njb3BlLm5hbWVzLmhhcyhzdG9yZV9uYW1lKSB8fCBzY29wZS5oYXMoc3RvcmVfbmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKG5vZGUsIGNvbXBpbGVyX2Vycm9ycy5jb250ZXh0dWFsX3N0b3JlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGVtcGxhdGVfc2NvcGUuaXNfbGV0KG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxhenkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0dWFsX2RlcGVuZGVuY2llcy5hZGQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwZW5kZW5jaWVzLmFkZChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0ZW1wbGF0ZV9zY29wZS5uYW1lcy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb24udXNlc19jb250ZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLmFkZChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG93bmVyID0gdGVtcGxhdGVfc2NvcGUuZ2V0X293bmVyKG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNfaW5kZXggPSBvd25lci50eXBlID09PSAnRWFjaEJsb2NrJyAmJiBvd25lci5rZXkgJiYgbmFtZSA9PT0gb3duZXIuaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxhenkgfHwgaXNfaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9zY29wZS5kZXBlbmRlbmNpZXNfZm9yX25hbWUuZ2V0KG5hbWUpLmZvckVhY2gobmFtZSA9PiBkZXBlbmRlbmNpZXMuYWRkKG5hbWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGF6eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcGVuZGVuY2llcy5hZGQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQuYWRkX3JlZmVyZW5jZShub2RlLCBuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuX2lmX3VuZGVmaW5lZChuYW1lLCBub2Rlc1swXSwgdGVtcGxhdGVfc2NvcGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyB0cmFjayBhbnkgYXNzaWdubWVudHMgZnJvbSB0ZW1wbGF0ZSBleHByZXNzaW9ucyBhcyBtdXRhYmxlXG4gICAgICAgICAgICAgICAgbGV0IG5hbWVzO1xuICAgICAgICAgICAgICAgIGxldCBkZWVwID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGZ1bmN0aW9uX2V4cHJlc3Npb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ0Fzc2lnbm1lbnRFeHByZXNzaW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVlcCA9IG5vZGUubGVmdC50eXBlID09PSAnTWVtYmVyRXhwcmVzc2lvbic7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lcyA9IGV4dHJhY3RfbmFtZXMoZGVlcCA/IGdldF9vYmplY3Qobm9kZS5sZWZ0KSA6IG5vZGUubGVmdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobm9kZS50eXBlID09PSAnVXBkYXRlRXhwcmVzc2lvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZXAgPSBub2RlLmFyZ3VtZW50LnR5cGUgPT09ICdNZW1iZXJFeHByZXNzaW9uJztcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzID0gZXh0cmFjdF9uYW1lcyhnZXRfb2JqZWN0KG5vZGUuYXJndW1lbnQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobmFtZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXMuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZV9zY29wZS5uYW1lcy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGVtcGxhdGVfc2NvcGUuaXNfY29uc3QobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50LmVycm9yKG5vZGUsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2NvbnN0X3VwZGF0ZShuYW1lKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlX3Njb3BlLmRlcGVuZGVuY2llc19mb3JfbmFtZS5nZXQobmFtZSkuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSBjb21wb25lbnQudmFyX2xvb2t1cC5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlW2RlZXAgPyAnbXV0YXRlZCcgOiAncmVhc3NpZ25lZCddID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlYWNoX2Jsb2NrID0gdGVtcGxhdGVfc2NvcGUuZ2V0X293bmVyKG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVhY2hfYmxvY2suaGFzX2JpbmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50LmFkZF9yZWZlcmVuY2Uobm9kZSwgbmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSBjb21wb25lbnQudmFyX2xvb2t1cC5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlW2RlZXAgPyAnbXV0YXRlZCcgOiAncmVhc3NpZ25lZCddID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVjbGFyYXRpb24gPSAoX2EgPSBzY29wZS5maW5kX293bmVyKG5hbWUpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZGVjbGFyYXRpb25zLmdldChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVjbGFyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlY2xhcmF0aW9uLmtpbmQgPT09ICdjb25zdCcgJiYgIWRlZXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcihub2RlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogJ2Fzc2lnbm1lbnQtdG8tY29uc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdZb3UgYXJlIGFzc2lnbmluZyB0byBhIGNvbnN0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFyaWFibGUgJiYgdmFyaWFibGUud3JpdGFibGUgPT09IGZhbHNlICYmICFkZWVwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcihub2RlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiAnYXNzaWdubWVudC10by1jb25zdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnWW91IGFyZSBhc3NpZ25pbmcgdG8gYSBjb25zdCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGVhdmUobm9kZSkge1xuICAgICAgICAgICAgICAgIGlmIChtYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlID0gc2NvcGUucGFyZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm9kZSA9PT0gZnVuY3Rpb25fZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbl9leHByZXNzaW9uID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkeW5hbWljX2RlcGVuZGVuY2llcygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5kZXBlbmRlbmNpZXMpLmZpbHRlcihuYW1lID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRlbXBsYXRlX3Njb3BlLmlzX2xldChuYW1lKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChpc19yZXNlcnZlZF9rZXl3b3JkKG5hbWUpKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLmNvbXBvbmVudC52YXJfbG9va3VwLmdldChuYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBpc19keW5hbWljKHZhcmlhYmxlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIFRPRE8gbW92ZSB0aGlzIGludG8gYSByZW5kZXItZG9tIHdyYXBwZXI/XG4gICAgbWFuaXB1bGF0ZShibG9jaywgY3R4KSB7XG4gICAgICAgIC8vIFRPRE8gaWRlYWxseSB3ZSB3b3VsZG4ndCBlbmQgdXAgY2FsbGluZyB0aGlzIG1ldGhvZFxuICAgICAgICAvLyBtdWx0aXBsZSB0aW1lc1xuICAgICAgICBpZiAodGhpcy5tYW5pcHVsYXRlZClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hbmlwdWxhdGVkO1xuICAgICAgICBjb25zdCB7IGNvbXBvbmVudCwgZGVjbGFyYXRpb25zLCBzY29wZV9tYXA6IG1hcCwgdGVtcGxhdGVfc2NvcGUsIG93bmVyIH0gPSB0aGlzO1xuICAgICAgICBsZXQgc2NvcGUgPSB0aGlzLnNjb3BlO1xuICAgICAgICBsZXQgZnVuY3Rpb25fZXhwcmVzc2lvbjtcbiAgICAgICAgbGV0IGRlcGVuZGVuY2llcztcbiAgICAgICAgbGV0IGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzO1xuICAgICAgICBjb25zdCBub2RlID0gd2Fsayh0aGlzLm5vZGUsIHtcbiAgICAgICAgICAgIGVudGVyKG5vZGUsIHBhcmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdQcm9wZXJ0eScgJiYgbm9kZS5zaG9ydGhhbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS52YWx1ZSA9IGNsb25lKG5vZGUudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBub2RlLnNob3J0aGFuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobWFwLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZSA9IG1hcC5nZXQobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdJZGVudGlmaWVyJyAmJiBpc19yZWZlcmVuY2Uobm9kZSwgcGFyZW50KSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IGZsYXR0ZW5fcmVmZXJlbmNlKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuaGFzKG5hbWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnVuY3Rpb25fZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXBsYXRlX3Njb3BlLm5hbWVzLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLmFkZChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9zY29wZS5kZXBlbmRlbmNpZXNfZm9yX25hbWUuZ2V0KG5hbWUpLmZvckVhY2goZGVwZW5kZW5jeSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcGVuZGVuY2llcy5hZGQoZGVwZW5kZW5jeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbmNpZXMuYWRkKG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5hZGRfcmVmZXJlbmNlKG5vZGUsIG5hbWUpOyAvLyBUT0RPIGlzIHRoaXMgcmVkdW5kYW50L21pc3BsYWNlZD9cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpc19jb250ZXh0dWFsKGNvbXBvbmVudCwgdGVtcGxhdGVfc2NvcGUsIG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWZlcmVuY2UgPSBibG9jay5yZW5kZXJlci5yZWZlcmVuY2Uobm9kZSwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZShyZWZlcmVuY2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWZ1bmN0aW9uX2V4cHJlc3Npb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ0Fzc2lnbm1lbnRFeHByZXNzaW9uJykgO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnRnVuY3Rpb25FeHByZXNzaW9uJyB8fCBub2RlLnR5cGUgPT09ICdBcnJvd0Z1bmN0aW9uRXhwcmVzc2lvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uX2V4cHJlc3Npb24gPSBub2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVwZW5kZW5jaWVzID0gbmV3IFNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dHVhbF9kZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGVhdmUobm9kZSwgcGFyZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hcC5oYXMobm9kZSkpXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlID0gc2NvcGUucGFyZW50O1xuICAgICAgICAgICAgICAgIGlmIChub2RlID09PSBmdW5jdGlvbl9leHByZXNzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gY29tcG9uZW50LmdldF91bmlxdWVfbmFtZShzYW5pdGl6ZShnZXRfZnVuY3Rpb25fbmFtZShub2RlLCBvd25lcikpKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVjbGFyYXRpb24gPSBiIGBjb25zdCAke2lkfSA9ICR7bm9kZX1gO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3duZXIudHlwZSA9PT0gJ0NvbnN0VGFnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNoaWxkX3Njb3BlID0gc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YWxrKG5vZGUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRlcihub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcC5oYXMobm9kZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZSA9IG1hcC5nZXQobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdJZGVudGlmaWVyJyAmJiBpc19yZWZlcmVuY2Uobm9kZSwgcGFyZW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkX3Njb3BlLmhhcyhub2RlLm5hbWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZShibG9jay5yZW5kZXJlci5yZWZlcmVuY2Uobm9kZSwgY3R4KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlYXZlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcC5oYXMobm9kZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9zY29wZSA9IGNoaWxkX3Njb3BlLnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChkZXBlbmRlbmNpZXMuc2l6ZSA9PT0gMCAmJiBjb250ZXh0dWFsX2RlcGVuZGVuY2llcy5zaXplID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBjYW4gaG9pc3QgdGhpcyBvdXQgb2YgdGhlIGNvbXBvbmVudCBjb21wbGV0ZWx5XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQuZnVsbHlfaG9pc3RlZC5wdXNoKGRlY2xhcmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZShpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQuYWRkX3Zhcihub2RlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogaWQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcm5hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2lzdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoY29udGV4dHVhbF9kZXBlbmRlbmNpZXMuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZnVuY3Rpb24gY2FuIGJlIGhvaXN0ZWQgaW5zaWRlIHRoZSBjb21wb25lbnQgaW5pdFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50LnBhcnRseV9ob2lzdGVkLnB1c2goZGVjbGFyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sucmVuZGVyZXIuYWRkX3RvX2NvbnRleHQoaWQubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcGxhY2UoYmxvY2sucmVuZGVyZXIucmVmZXJlbmNlKGlkKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIGEgY29tYm8gYmxvY2svaW5pdCByZWNpcGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlcHMgPSBBcnJheS5mcm9tKGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uX2V4cHJlc3Npb24gPSBub2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFzX2FyZ3MgPSBmdW5jdGlvbl9leHByZXNzaW9uLnBhcmFtcy5sZW5ndGggPiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25fZXhwcmVzc2lvbi5wYXJhbXMgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uZGVwcy5tYXAobmFtZSA9PiAoeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWUgfSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmZ1bmN0aW9uX2V4cHJlc3Npb24ucGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGV4dF9hcmdzID0gZGVwcy5tYXAobmFtZSA9PiBibG9jay5yZW5kZXJlci5yZWZlcmVuY2UobmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50LnBhcnRseV9ob2lzdGVkLnB1c2goZGVjbGFyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sucmVuZGVyZXIuYWRkX3RvX2NvbnRleHQoaWQubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWxsZWUgPSBibG9jay5yZW5kZXJlci5yZWZlcmVuY2UoaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXBsYWNlKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ1bmNfZGVjbGFyYXRpb24gPSBoYXNfYXJnc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gYiBgZnVuY3Rpb24gJHtpZH0oLi4uYXJncykge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiAke2NhbGxlZX0oJHtjb250ZXh0X2FyZ3N9LCAuLi5hcmdzKTtcblx0XHRcdFx0XHRcdFx0fWBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGIgYGZ1bmN0aW9uICR7aWR9KCkge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiAke2NhbGxlZX0oJHtjb250ZXh0X2FyZ3N9KTtcblx0XHRcdFx0XHRcdFx0fWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3duZXIudHlwZSA9PT0gJ0F0dHJpYnV0ZScgJiYgb3duZXIucGFyZW50Lm5hbWUgPT09ICdzbG90Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlcF9zY29wZXMgPSBuZXcgU2V0KGRlcHMubWFwKG5hbWUgPT4gdGVtcGxhdGVfc2NvcGUuZ2V0X293bmVyKG5hbWUpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluZCB0aGUgbmVhcmVzdCBzY29wZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IG93bmVyLnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAobm9kZSAmJiAhZGVwX3Njb3Blcy5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmdW5jX2V4cHJlc3Npb24gPSBmdW5jX2RlY2xhcmF0aW9uWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdJbmxpbmVDb21wb25lbnQnIHx8IG5vZGUudHlwZSA9PT0gJ1Nsb3RUZW1wbGF0ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gPENvbXAgbGV0OmRhdGEgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXBsYWNlKGZ1bmNfZXhwcmVzc2lvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB7I2VhY2h9LCB7I2F3YWl0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmdW5jX2lkID0gY29tcG9uZW50LmdldF91bmlxdWVfbmFtZShpZC5uYW1lICsgJ19mdW5jJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrLnJlbmRlcmVyLmFkZF90b19jb250ZXh0KGZ1bmNfaWQubmFtZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbmFtZSAjY3R4IC0+IGNoaWxkX2N0eDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FsayhmdW5jX2V4cHJlc3Npb24sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudGVyKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnSWRlbnRpZmllcicgJiYgbm9kZS5uYW1lID09PSAnI2N0eCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5uYW1lID0gJ2NoaWxkX2N0eCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHRvIGdldF94eHhfY29udGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGlsZF9jdHhbeF0gPSBmdW5jdGlvbiAoKSB7IC4uLiB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlX3Njb3BlLmdldF9vd25lcihkZXBzWzBdKS5jb250ZXh0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleTogZnVuY19pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyOiAoKSA9PiBmdW5jX2V4cHJlc3Npb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0X21vZGlmaWVyOiBub2RlID0+IG5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZShibG9jay5yZW5kZXJlci5yZWZlcmVuY2UoZnVuY19pZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9ucy5wdXNoKGZ1bmNfZGVjbGFyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uX2V4cHJlc3Npb24gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbmNpZXMgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0dWFsX2RlcGVuZGVuY2llcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQgJiYgcGFyZW50LnR5cGUgPT09ICdQcm9wZXJ0eScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5tZXRob2QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnQXNzaWdubWVudEV4cHJlc3Npb24nIHx8IG5vZGUudHlwZSA9PT0gJ1VwZGF0ZUV4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFzc2lnbmVlID0gbm9kZS50eXBlID09PSAnQXNzaWdubWVudEV4cHJlc3Npb24nID8gbm9kZS5sZWZ0IDogbm9kZS5hcmd1bWVudDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2JqZWN0X25hbWUgPSBnZXRfb2JqZWN0KGFzc2lnbmVlKS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuaGFzKG9iamVjdF9uYW1lKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgLy8gbm9ybWFsbHkgKGBhID0gMWAsIGBiLmMgPSAyYCksIHRoZXJlJ2xsIGJlIGEgc2luZ2xlIG5hbWVcbiAgICAgICAgICAgICAgICAgICAgLy8gKGEgb3IgYikuIEluIGRlc3RydWN0dXJpbmcgY2FzZXMgKGBbZCwgZV0gPSBbZSwgZF1gKSB0aGVyZVxuICAgICAgICAgICAgICAgICAgICAvLyBtYXkgYmUgbW9yZSwgaW4gd2hpY2ggY2FzZSB3ZSBuZWVkIHRvIHRhY2sgdGhlIGV4dHJhIG9uZXNcbiAgICAgICAgICAgICAgICAgICAgLy8gb250byB0aGUgaW5pdGlhbCBmdW5jdGlvbiBjYWxsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVzID0gbmV3IFNldChleHRyYWN0X25hbWVzKGFzc2lnbmVlKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNlZCA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXMuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IHRlbXBsYXRlX3Njb3BlLmRlcGVuZGVuY2llc19mb3JfbmFtZS5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVwZW5kZW5jaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwZW5kZW5jaWVzLmZvckVhY2gobmFtZSA9PiB0cmFjZWQuYWRkKG5hbWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNlZC5hZGQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gYmxvY2suYmluZGluZ3MuZ2V0KG9iamVjdF9uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBgeyNlYWNoIGFycmF5IGFzIGl0ZW19YFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVwbGFjZSBgaXRlbSA9IDFgIHRvIGBlYWNoX2FycmF5W2VhY2hfaW5kZXhdID0gMWAsIHRoaXMgYWxsb3cgdXMgdG8gbXV0YXRlIHRoZSBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmF0aGVyIHRoYW4gbXV0YXRpbmcgdGhlIGxvY2FsIGBpdGVtYCB2YXJpYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBzbmlwcGV0LCBvYmplY3QsIHByb3BlcnR5IH0gPSBjb250ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZWQgPSByZXBsYWNlX29iamVjdChhc3NpZ25lZSwgc25pcHBldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnQXNzaWdubWVudEV4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5sZWZ0ID0gcmVwbGFjZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmFyZ3VtZW50ID0gcmVwbGFjZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0dWFsX2RlcGVuZGVuY2llcy5hZGQob2JqZWN0Lm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dHVhbF9kZXBlbmRlbmNpZXMuYWRkKHByb3BlcnR5Lm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZShpbnZhbGlkYXRlKGJsb2NrLnJlbmRlcmVyLCBzY29wZSwgbm9kZSwgdHJhY2VkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGRlY2xhcmF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBibG9jay5tYWludGFpbl9jb250ZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGRlY2xhcmF0aW9ucy5mb3JFYWNoKGRlY2xhcmF0aW9uID0+IHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGRlY2xhcmF0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAodGhpcy5tYW5pcHVsYXRlZCA9IG5vZGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldF9mdW5jdGlvbl9uYW1lKF9ub2RlLCBwYXJlbnQpIHtcbiAgICBpZiAocGFyZW50LnR5cGUgPT09ICdFdmVudEhhbmRsZXInKSB7XG4gICAgICAgIHJldHVybiBgJHtwYXJlbnQubmFtZX1faGFuZGxlcmA7XG4gICAgfVxuICAgIGlmIChwYXJlbnQudHlwZSA9PT0gJ0FjdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIGAke3BhcmVudC5uYW1lfV9mdW5jdGlvbmA7XG4gICAgfVxuICAgIHJldHVybiAnZnVuYyc7XG59XG5cbmZ1bmN0aW9uIHVucGFja19kZXN0cnVjdHVyaW5nKHsgY29udGV4dHMsIG5vZGUsIG1vZGlmaWVyID0gKG5vZGUpID0+IG5vZGUsIGRlZmF1bHRfbW9kaWZpZXIgPSAobm9kZSkgPT4gbm9kZSwgc2NvcGUsIGNvbXBvbmVudCwgY29udGV4dF9yZXN0X3Byb3BlcnRpZXMgfSkge1xuICAgIGlmICghbm9kZSlcbiAgICAgICAgcmV0dXJuO1xuICAgIGlmIChub2RlLnR5cGUgPT09ICdJZGVudGlmaWVyJykge1xuICAgICAgICBjb250ZXh0cy5wdXNoKHtcbiAgICAgICAgICAgIGtleTogbm9kZSxcbiAgICAgICAgICAgIG1vZGlmaWVyLFxuICAgICAgICAgICAgZGVmYXVsdF9tb2RpZmllclxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS50eXBlID09PSAnUmVzdEVsZW1lbnQnKSB7XG4gICAgICAgIGNvbnRleHRzLnB1c2goe1xuICAgICAgICAgICAga2V5OiBub2RlLmFyZ3VtZW50LFxuICAgICAgICAgICAgbW9kaWZpZXIsXG4gICAgICAgICAgICBkZWZhdWx0X21vZGlmaWVyXG4gICAgICAgIH0pO1xuICAgICAgICBjb250ZXh0X3Jlc3RfcHJvcGVydGllcy5zZXQobm9kZS5hcmd1bWVudC5uYW1lLCBub2RlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS50eXBlID09PSAnQXJyYXlQYXR0ZXJuJykge1xuICAgICAgICBub2RlLmVsZW1lbnRzLmZvckVhY2goKGVsZW1lbnQsIGkpID0+IHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQudHlwZSA9PT0gJ1Jlc3RFbGVtZW50Jykge1xuICAgICAgICAgICAgICAgIHVucGFja19kZXN0cnVjdHVyaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dHMsXG4gICAgICAgICAgICAgICAgICAgIG5vZGU6IGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyOiAobm9kZSkgPT4geCBgJHttb2RpZmllcihub2RlKX0uc2xpY2UoJHtpfSlgLFxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0X21vZGlmaWVyLFxuICAgICAgICAgICAgICAgICAgICBzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50LFxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0X3Jlc3RfcHJvcGVydGllc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzLnNldChlbGVtZW50LmFyZ3VtZW50Lm5hbWUsIGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZWxlbWVudCAmJiBlbGVtZW50LnR5cGUgPT09ICdBc3NpZ25tZW50UGF0dGVybicpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gY29udGV4dHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIG1hcmtfcmVmZXJlbmNlZChlbGVtZW50LnJpZ2h0LCBzY29wZSwgY29tcG9uZW50KTtcbiAgICAgICAgICAgICAgICB1bnBhY2tfZGVzdHJ1Y3R1cmluZyh7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRzLFxuICAgICAgICAgICAgICAgICAgICBub2RlOiBlbGVtZW50LmxlZnQsXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyOiAobm9kZSkgPT4geCBgJHttb2RpZmllcihub2RlKX1bJHtpfV1gLFxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0X21vZGlmaWVyOiAobm9kZSwgdG9fY3R4KSA9PiB4IGAke25vZGV9ICE9PSB1bmRlZmluZWQgPyAke25vZGV9IDogJHt1cGRhdGVfcmVmZXJlbmNlKGNvbnRleHRzLCBuLCBlbGVtZW50LnJpZ2h0LCB0b19jdHgpfWAsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1bnBhY2tfZGVzdHJ1Y3R1cmluZyh7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRzLFxuICAgICAgICAgICAgICAgICAgICBub2RlOiBlbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICBtb2RpZmllcjogKG5vZGUpID0+IHggYCR7bW9kaWZpZXIobm9kZSl9WyR7aX1dYCxcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdF9tb2RpZmllcixcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudCxcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dF9yZXN0X3Byb3BlcnRpZXNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ09iamVjdFBhdHRlcm4nKSB7XG4gICAgICAgIGNvbnN0IHVzZWRfcHJvcGVydGllcyA9IFtdO1xuICAgICAgICBub2RlLnByb3BlcnRpZXMuZm9yRWFjaCgocHJvcGVydHkpID0+IHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eS50eXBlID09PSAnUmVzdEVsZW1lbnQnKSB7XG4gICAgICAgICAgICAgICAgdW5wYWNrX2Rlc3RydWN0dXJpbmcoe1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0cyxcbiAgICAgICAgICAgICAgICAgICAgbm9kZTogcHJvcGVydHkuYXJndW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyOiAobm9kZSkgPT4geCBgQG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMoJHttb2RpZmllcihub2RlKX0sIFske3VzZWRfcHJvcGVydGllc31dKWAsXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHRfbW9kaWZpZXIsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29udGV4dF9yZXN0X3Byb3BlcnRpZXMuc2V0KHByb3BlcnR5LmFyZ3VtZW50Lm5hbWUsIHByb3BlcnR5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IHByb3BlcnR5LmtleTtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHByb3BlcnR5LnZhbHVlO1xuICAgICAgICAgICAgICAgIHVzZWRfcHJvcGVydGllcy5wdXNoKHggYFwiJHtrZXkubmFtZX1cImApO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS50eXBlID09PSAnQXNzaWdubWVudFBhdHRlcm4nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBjb250ZXh0cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtfcmVmZXJlbmNlZCh2YWx1ZS5yaWdodCwgc2NvcGUsIGNvbXBvbmVudCk7XG4gICAgICAgICAgICAgICAgICAgIHVucGFja19kZXN0cnVjdHVyaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZTogdmFsdWUubGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyOiAobm9kZSkgPT4geCBgJHttb2RpZmllcihub2RlKX0uJHtrZXkubmFtZX1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdF9tb2RpZmllcjogKG5vZGUsIHRvX2N0eCkgPT4geCBgJHtub2RlfSAhPT0gdW5kZWZpbmVkID8gJHtub2RlfSA6ICR7dXBkYXRlX3JlZmVyZW5jZShjb250ZXh0cywgbiwgdmFsdWUucmlnaHQsIHRvX2N0eCl9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dF9yZXN0X3Byb3BlcnRpZXNcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1bnBhY2tfZGVzdHJ1Y3R1cmluZyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGU6IHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXI6IChub2RlKSA9PiB4IGAke21vZGlmaWVyKG5vZGUpfS4ke2tleS5uYW1lfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0X21vZGlmaWVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0X3Jlc3RfcHJvcGVydGllc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVwZGF0ZV9yZWZlcmVuY2UoY29udGV4dHMsIG4sIGV4cHJlc3Npb24sIHRvX2N0eCkge1xuICAgIGNvbnN0IGZpbmRfZnJvbV9jb250ZXh0ID0gKG5vZGUpID0+IHtcbiAgICAgICAgZm9yIChsZXQgaSA9IG47IGkgPCBjb250ZXh0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgeyBrZXkgfSA9IGNvbnRleHRzW2ldO1xuICAgICAgICAgICAgaWYgKG5vZGUubmFtZSA9PT0ga2V5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBhY2Nlc3MgJyR7bm9kZS5uYW1lfScgYmVmb3JlIGluaXRpYWxpemF0aW9uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvX2N0eChub2RlLm5hbWUpO1xuICAgIH07XG4gICAgaWYgKGV4cHJlc3Npb24udHlwZSA9PT0gJ0lkZW50aWZpZXInKSB7XG4gICAgICAgIHJldHVybiBmaW5kX2Zyb21fY29udGV4dChleHByZXNzaW9uKTtcbiAgICB9XG4gICAgLy8gTk9URTogYXZvaWQgdW5uZWNlc3NhcnkgZGVlcCBjbG9uZT9cbiAgICBleHByZXNzaW9uID0gY2xvbmUoZXhwcmVzc2lvbik7XG4gICAgd2FsayhleHByZXNzaW9uLCB7XG4gICAgICAgIGVudGVyKG5vZGUsIHBhcmVudCkge1xuICAgICAgICAgICAgaWYgKGlzX3JlZmVyZW5jZShub2RlLCBwYXJlbnQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXBsYWNlKGZpbmRfZnJvbV9jb250ZXh0KG5vZGUpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNraXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBleHByZXNzaW9uO1xufVxuZnVuY3Rpb24gbWFya19yZWZlcmVuY2VkKG5vZGUsIHNjb3BlLCBjb21wb25lbnQpIHtcbiAgICB3YWxrKG5vZGUsIHtcbiAgICAgICAgZW50ZXIobm9kZSwgcGFyZW50KSB7XG4gICAgICAgICAgICBpZiAoaXNfcmVmZXJlbmNlKG5vZGUsIHBhcmVudCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IGZsYXR0ZW5fcmVmZXJlbmNlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmICghc2NvcGUuaXNfbGV0KG5hbWUpICYmICFzY29wZS5uYW1lcy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50LmFkZF9yZWZlcmVuY2Uobm9kZSwgbmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmNvbnN0IGFsbG93ZWRfcGFyZW50cyA9IG5ldyBTZXQoWydFYWNoQmxvY2snLCAnQ2F0Y2hCbG9jaycsICdUaGVuQmxvY2snLCAnSW5saW5lQ29tcG9uZW50JywgJ1Nsb3RUZW1wbGF0ZScsICdJZkJsb2NrJywgJ0Vsc2VCbG9jayddKTtcbmNsYXNzIENvbnN0VGFnIGV4dGVuZHMgTm9kZSQxIHtcbiAgICBjb25zdHJ1Y3Rvcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pIHtcbiAgICAgICAgc3VwZXIoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKTtcbiAgICAgICAgdGhpcy5jb250ZXh0cyA9IFtdO1xuICAgICAgICB0aGlzLmNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmFzc2lnbmVlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5kZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIGlmICghYWxsb3dlZF9wYXJlbnRzLmhhcyhwYXJlbnQudHlwZSkpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcihpbmZvLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9jb25zdF9wbGFjZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubm9kZSA9IGluZm87XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICAgICAgY29uc3QgeyBhc3NpZ25lZXMsIGRlcGVuZGVuY2llcyB9ID0gdGhpcztcbiAgICAgICAgZXh0cmFjdF9pZGVudGlmaWVycyhpbmZvLmV4cHJlc3Npb24ubGVmdCkuZm9yRWFjaCgoeyBuYW1lIH0pID0+IHtcbiAgICAgICAgICAgIGFzc2lnbmVlcy5hZGQobmFtZSk7XG4gICAgICAgICAgICBjb25zdCBvd25lciA9IHRoaXMuc2NvcGUuZ2V0X293bmVyKG5hbWUpO1xuICAgICAgICAgICAgaWYgKG93bmVyID09PSBwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuZXJyb3IoaW5mbywgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfY29uc3RfZGVjbGFyYXRpb24obmFtZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgd2FsayhpbmZvLmV4cHJlc3Npb24ucmlnaHQsIHtcbiAgICAgICAgICAgIGVudGVyKG5vZGUsIHBhcmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChpc19yZWZlcmVuY2Uobm9kZSwgcGFyZW50KSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpZGVudGlmaWVyID0gZ2V0X29iamVjdChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSBpZGVudGlmaWVyO1xuICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbmNpZXMuYWRkKG5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHBhcnNlX2V4cHJlc3Npb24oKSB7XG4gICAgICAgIHVucGFja19kZXN0cnVjdHVyaW5nKHtcbiAgICAgICAgICAgIGNvbnRleHRzOiB0aGlzLmNvbnRleHRzLFxuICAgICAgICAgICAgbm9kZTogdGhpcy5ub2RlLmV4cHJlc3Npb24ubGVmdCxcbiAgICAgICAgICAgIHNjb3BlOiB0aGlzLnNjb3BlLFxuICAgICAgICAgICAgY29tcG9uZW50OiB0aGlzLmNvbXBvbmVudCxcbiAgICAgICAgICAgIGNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzOiB0aGlzLmNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBuZXcgRXhwcmVzc2lvbih0aGlzLmNvbXBvbmVudCwgdGhpcywgdGhpcy5zY29wZSwgdGhpcy5ub2RlLmV4cHJlc3Npb24ucmlnaHQpO1xuICAgICAgICB0aGlzLmNvbnRleHRzLmZvckVhY2goY29udGV4dCA9PiB7XG4gICAgICAgICAgICBjb25zdCBvd25lciA9IHRoaXMuc2NvcGUuZ2V0X293bmVyKGNvbnRleHQua2V5Lm5hbWUpO1xuICAgICAgICAgICAgaWYgKG93bmVyICYmIG93bmVyLnR5cGUgPT09ICdDb25zdFRhZycgJiYgb3duZXIucGFyZW50ID09PSB0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50LmVycm9yKHRoaXMubm9kZSwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfY29uc3RfZGVjbGFyYXRpb24oY29udGV4dC5rZXkubmFtZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zY29wZS5hZGQoY29udGV4dC5rZXkubmFtZSwgdGhpcy5leHByZXNzaW9uLmRlcGVuZGVuY2llcywgdGhpcyk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuY2xhc3MgUGVuZGluZ0Jsb2NrIGV4dGVuZHMgQWJzdHJhY3RCbG9jayB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBtYXBfY2hpbGRyZW4oY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvLmNoaWxkcmVuKTtcbiAgICAgICAgaWYgKCFpbmZvLnNraXApIHtcbiAgICAgICAgICAgIHRoaXMud2Fybl9pZl9lbXB0eV9ibG9jaygpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5jbGFzcyBDYXRjaEJsb2NrIGV4dGVuZHMgQWJzdHJhY3RCbG9jayB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZS5jaGlsZCgpO1xuICAgICAgICBpZiAocGFyZW50LmNhdGNoX25vZGUpIHtcbiAgICAgICAgICAgIHBhcmVudC5jYXRjaF9jb250ZXh0cy5mb3JFYWNoKGNvbnRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2NvcGUuYWRkKGNvbnRleHQua2V5Lm5hbWUsIHBhcmVudC5leHByZXNzaW9uLmRlcGVuZGVuY2llcywgdGhpcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAoW3RoaXMuY29uc3RfdGFncywgdGhpcy5jaGlsZHJlbl0gPSBnZXRfY29uc3RfdGFncyhpbmZvLmNoaWxkcmVuLCBjb21wb25lbnQsIHRoaXMsIHBhcmVudCkpO1xuICAgICAgICBpZiAoIWluZm8uc2tpcCkge1xuICAgICAgICAgICAgdGhpcy53YXJuX2lmX2VtcHR5X2Jsb2NrKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIEF3YWl0QmxvY2sgZXh0ZW5kcyBOb2RlJDEge1xuICAgIGNvbnN0cnVjdG9yKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbykge1xuICAgICAgICBzdXBlcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pO1xuICAgICAgICB0aGlzLmNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBuZXcgRXhwcmVzc2lvbihjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpbmZvLmV4cHJlc3Npb24pO1xuICAgICAgICB0aGlzLnRoZW5fbm9kZSA9IGluZm8udmFsdWU7XG4gICAgICAgIHRoaXMuY2F0Y2hfbm9kZSA9IGluZm8uZXJyb3I7XG4gICAgICAgIGlmICh0aGlzLnRoZW5fbm9kZSkge1xuICAgICAgICAgICAgdGhpcy50aGVuX2NvbnRleHRzID0gW107XG4gICAgICAgICAgICB1bnBhY2tfZGVzdHJ1Y3R1cmluZyh7IGNvbnRleHRzOiB0aGlzLnRoZW5fY29udGV4dHMsIG5vZGU6IGluZm8udmFsdWUsIHNjb3BlLCBjb21wb25lbnQsIGNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzOiB0aGlzLmNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNhdGNoX25vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuY2F0Y2hfY29udGV4dHMgPSBbXTtcbiAgICAgICAgICAgIHVucGFja19kZXN0cnVjdHVyaW5nKHsgY29udGV4dHM6IHRoaXMuY2F0Y2hfY29udGV4dHMsIG5vZGU6IGluZm8uZXJyb3IsIHNjb3BlLCBjb21wb25lbnQsIGNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzOiB0aGlzLmNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGVuZGluZyA9IG5ldyBQZW5kaW5nQmxvY2soY29tcG9uZW50LCB0aGlzLCBzY29wZSwgaW5mby5wZW5kaW5nKTtcbiAgICAgICAgdGhpcy50aGVuID0gbmV3IFRoZW5CbG9jayhjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpbmZvLnRoZW4pO1xuICAgICAgICB0aGlzLmNhdGNoID0gbmV3IENhdGNoQmxvY2soY29tcG9uZW50LCB0aGlzLCBzY29wZSwgaW5mby5jYXRjaCk7XG4gICAgfVxufVxuXG5jb25zdCByZWdleF9jb250YWluc190ZXJtX2Z1bmN0aW9uX2V4cHJlc3Npb24kMSA9IC9GdW5jdGlvbkV4cHJlc3Npb24vO1xuY2xhc3MgRXZlbnRIYW5kbGVyIGV4dGVuZHMgTm9kZSQxIHtcbiAgICBjb25zdHJ1Y3Rvcihjb21wb25lbnQsIHBhcmVudCwgdGVtcGxhdGVfc2NvcGUsIGluZm8pIHtcbiAgICAgICAgc3VwZXIoY29tcG9uZW50LCBwYXJlbnQsIHRlbXBsYXRlX3Njb3BlLCBpbmZvKTtcbiAgICAgICAgdGhpcy51c2VzX2NvbnRleHQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jYW5fbWFrZV9wYXNzaXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMubmFtZSA9IGluZm8ubmFtZTtcbiAgICAgICAgdGhpcy5tb2RpZmllcnMgPSBuZXcgU2V0KGluZm8ubW9kaWZpZXJzKTtcbiAgICAgICAgaWYgKGluZm8uZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdGhpcy5leHByZXNzaW9uID0gbmV3IEV4cHJlc3Npb24oY29tcG9uZW50LCB0aGlzLCB0ZW1wbGF0ZV9zY29wZSwgaW5mby5leHByZXNzaW9uKTtcbiAgICAgICAgICAgIHRoaXMudXNlc19jb250ZXh0ID0gdGhpcy5leHByZXNzaW9uLnVzZXNfY29udGV4dDtcbiAgICAgICAgICAgIGlmIChyZWdleF9jb250YWluc190ZXJtX2Z1bmN0aW9uX2V4cHJlc3Npb24kMS50ZXN0KGluZm8uZXhwcmVzc2lvbi50eXBlKSAmJiBpbmZvLmV4cHJlc3Npb24ucGFyYW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vIFRPRE8gbWFrZSB0aGlzIGRldGVjdGlvbiBtb3JlIGFjY3VyYXRlIOKAlCBpZiBgZXZlbnQucHJldmVudERlZmF1bHRgIGlzbid0IGNhbGxlZCwgYW5kXG4gICAgICAgICAgICAgICAgLy8gYGV2ZW50YCBpcyBwYXNzZWQgdG8gYW5vdGhlciBmdW5jdGlvbiwgd2UgY2FuIG1ha2UgaXQgcGFzc2l2ZVxuICAgICAgICAgICAgICAgIHRoaXMuY2FuX21ha2VfcGFzc2l2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpbmZvLmV4cHJlc3Npb24udHlwZSA9PT0gJ0lkZW50aWZpZXInKSB7XG4gICAgICAgICAgICAgICAgbGV0IG5vZGUgPSBjb21wb25lbnQubm9kZV9mb3JfZGVjbGFyYXRpb24uZ2V0KGluZm8uZXhwcmVzc2lvbi5uYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnVmFyaWFibGVEZWNsYXJhdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBgY29uc3QgaGFuZGxlQ2xpY2sgPSAoKSA9PiB7Li4ufWAsIHdlIHdhbnQgdGhlIFthcnJvd10gZnVuY3Rpb24gZXhwcmVzc2lvbiBub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWNsYXJhdG9yID0gbm9kZS5kZWNsYXJhdGlvbnMuZmluZChkID0+IGQuaWQubmFtZSA9PT0gaW5mby5leHByZXNzaW9uLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGRlY2xhcmF0b3IgJiYgZGVjbGFyYXRvci5pbml0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlICYmIChub2RlLnR5cGUgPT09ICdGdW5jdGlvbkV4cHJlc3Npb24nIHx8IG5vZGUudHlwZSA9PT0gJ0Z1bmN0aW9uRGVjbGFyYXRpb24nIHx8IG5vZGUudHlwZSA9PT0gJ0Fycm93RnVuY3Rpb25FeHByZXNzaW9uJykgJiYgbm9kZS5wYXJhbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbl9tYWtlX3Bhc3NpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVyX25hbWUgPSBjb21wb25lbnQuZ2V0X3VuaXF1ZV9uYW1lKGAke3Nhbml0aXplKHRoaXMubmFtZSl9X2hhbmRsZXJgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgcmVhc3NpZ25lZCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBub2RlID0gdGhpcy5leHByZXNzaW9uLm5vZGU7XG4gICAgICAgIGlmIChyZWdleF9jb250YWluc190ZXJtX2Z1bmN0aW9uX2V4cHJlc3Npb24kMS50ZXN0KG5vZGUudHlwZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5leHByZXNzaW9uLmR5bmFtaWNfZGVwZW5kZW5jaWVzKCkubGVuZ3RoID4gMDtcbiAgICB9XG59XG5cbmNsYXNzIEFjdGlvbiBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IGluZm8ubmFtZS5zcGxpdCgnLicpWzBdO1xuICAgICAgICBjb21wb25lbnQud2Fybl9pZl91bmRlZmluZWQob2JqZWN0LCBpbmZvLCBzY29wZSk7XG4gICAgICAgIHRoaXMubmFtZSA9IGluZm8ubmFtZTtcbiAgICAgICAgY29tcG9uZW50LmFkZF9yZWZlcmVuY2UodGhpcywgb2JqZWN0KTtcbiAgICAgICAgdGhpcy5leHByZXNzaW9uID0gaW5mby5leHByZXNzaW9uXG4gICAgICAgICAgICA/IG5ldyBFeHByZXNzaW9uKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIGluZm8uZXhwcmVzc2lvbilcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZV9zY29wZSA9IHNjb3BlO1xuICAgICAgICB0aGlzLnVzZXNfY29udGV4dCA9IHRoaXMuZXhwcmVzc2lvbiAmJiB0aGlzLmV4cHJlc3Npb24udXNlc19jb250ZXh0O1xuICAgIH1cbn1cblxuY2xhc3MgQm9keSBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5hY3Rpb25zID0gW107XG4gICAgICAgIGluZm8uYXR0cmlidXRlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnRXZlbnRIYW5kbGVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlcnMucHVzaChuZXcgRXZlbnRIYW5kbGVyKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ0FjdGlvbicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbnMucHVzaChuZXcgQWN0aW9uKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5jbGFzcyBDb21tZW50JDEgZXh0ZW5kcyBOb2RlJDEge1xuICAgIGNvbnN0cnVjdG9yKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbykge1xuICAgICAgICBzdXBlcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pO1xuICAgICAgICB0aGlzLmRhdGEgPSBpbmZvLmRhdGE7XG4gICAgICAgIHRoaXMuaWdub3JlcyA9IGluZm8uaWdub3JlcztcbiAgICB9XG59XG5cbmNsYXNzIEVsc2VCbG9jayBleHRlbmRzIEFic3RyYWN0QmxvY2sge1xuICAgIGNvbnN0cnVjdG9yKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbykge1xuICAgICAgICBzdXBlcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pO1xuICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGUuY2hpbGQoKTtcbiAgICAgICAgKFt0aGlzLmNvbnN0X3RhZ3MsIHRoaXMuY2hpbGRyZW5dID0gZ2V0X2NvbnN0X3RhZ3MoaW5mby5jaGlsZHJlbiwgY29tcG9uZW50LCB0aGlzLCB0aGlzKSk7XG4gICAgICAgIHRoaXMud2Fybl9pZl9lbXB0eV9ibG9jaygpO1xuICAgIH1cbn1cblxuY2xhc3MgRWFjaEJsb2NrIGV4dGVuZHMgQWJzdHJhY3RCbG9jayB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuaGFzX2JpbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5oYXNfaW5kZXhfYmluZGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBuZXcgRXhwcmVzc2lvbihjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpbmZvLmV4cHJlc3Npb24pO1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBpbmZvLmNvbnRleHQubmFtZSB8fCAnZWFjaCc7IC8vIFRPRE8gdGhpcyBpcyB1c2VkIHRvIGZhY2lsaXRhdGUgYmluZGluZzsgY3VycmVudGx5IGZhaWxzIHdpdGggZGVzdHJ1Y3R1cmluZ1xuICAgICAgICB0aGlzLmNvbnRleHRfbm9kZSA9IGluZm8uY29udGV4dDtcbiAgICAgICAgdGhpcy5pbmRleCA9IGluZm8uaW5kZXg7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZS5jaGlsZCgpO1xuICAgICAgICB0aGlzLmNvbnRleHRfcmVzdF9wcm9wZXJ0aWVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmNvbnRleHRzID0gW107XG4gICAgICAgIHVucGFja19kZXN0cnVjdHVyaW5nKHsgY29udGV4dHM6IHRoaXMuY29udGV4dHMsIG5vZGU6IGluZm8uY29udGV4dCwgc2NvcGUsIGNvbXBvbmVudCwgY29udGV4dF9yZXN0X3Byb3BlcnRpZXM6IHRoaXMuY29udGV4dF9yZXN0X3Byb3BlcnRpZXMgfSk7XG4gICAgICAgIHRoaXMuY29udGV4dHMuZm9yRWFjaChjb250ZXh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2NvcGUuYWRkKGNvbnRleHQua2V5Lm5hbWUsIHRoaXMuZXhwcmVzc2lvbi5kZXBlbmRlbmNpZXMsIHRoaXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuaW5kZXgpIHtcbiAgICAgICAgICAgIC8vIGluZGV4IGNhbiBvbmx5IGNoYW5nZSBpZiB0aGlzIGlzIGEga2V5ZWQgZWFjaCBibG9ja1xuICAgICAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzID0gaW5mby5rZXkgPyB0aGlzLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzIDogbmV3IFNldChbXSk7XG4gICAgICAgICAgICB0aGlzLnNjb3BlLmFkZCh0aGlzLmluZGV4LCBkZXBlbmRlbmNpZXMsIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMua2V5ID0gaW5mby5rZXlcbiAgICAgICAgICAgID8gbmV3IEV4cHJlc3Npb24oY29tcG9uZW50LCB0aGlzLCB0aGlzLnNjb3BlLCBpbmZvLmtleSlcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgdGhpcy5oYXNfYW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgIChbdGhpcy5jb25zdF90YWdzLCB0aGlzLmNoaWxkcmVuXSA9IGdldF9jb25zdF90YWdzKGluZm8uY2hpbGRyZW4sIGNvbXBvbmVudCwgdGhpcywgdGhpcykpO1xuICAgICAgICBpZiAodGhpcy5oYXNfYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbi5maWx0ZXIoY2hpbGQgPT4gIWlzRW1wdHlOb2RlKGNoaWxkKSAmJiAhaXNDb21tZW50Tm9kZShjaGlsZCkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY2hpbGRyZW4ubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hpbGQgPSB0aGlzLmNoaWxkcmVuLmZpbmQoY2hpbGQgPT4gISFjaGlsZC5hbmltYXRpb24pO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcihjaGlsZC5hbmltYXRpb24sIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2FuaW1hdGlvbl9zb2xlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53YXJuX2lmX2VtcHR5X2Jsb2NrKCk7XG4gICAgICAgIHRoaXMuZWxzZSA9IGluZm8uZWxzZVxuICAgICAgICAgICAgPyBuZXcgRWxzZUJsb2NrKGNvbXBvbmVudCwgdGhpcywgdGhpcy5zY29wZSwgaW5mby5lbHNlKVxuICAgICAgICAgICAgOiBudWxsO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGlzRW1wdHlOb2RlKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS50eXBlID09PSAnVGV4dCcgJiYgbm9kZS5kYXRhLnRyaW0oKSA9PT0gJyc7XG59XG5mdW5jdGlvbiBpc0NvbW1lbnROb2RlKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS50eXBlID09PSAnQ29tbWVudCc7XG59XG5cbmZ1bmN0aW9uIHN0cmluZ19saXRlcmFsKGRhdGEpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnTGl0ZXJhbCcsXG4gICAgICAgIHZhbHVlOiBkYXRhXG4gICAgfTtcbn1cbmNvbnN0IGVzY2FwZWQgPSB7XG4gICAgJ1wiJzogJyZxdW90OycsXG4gICAgXCInXCI6ICcmIzM5OycsXG4gICAgJyYnOiAnJmFtcDsnLFxuICAgICc8JzogJyZsdDsnLFxuICAgICc+JzogJyZndDsnXG59O1xuY29uc3QgcmVnZXhfaHRtbF9jaGFyYWN0ZXJzX3RvX2VzY2FwZSA9IC9bXCInJjw+XS9nO1xuZnVuY3Rpb24gZXNjYXBlX2h0bWwoaHRtbCkge1xuICAgIHJldHVybiBTdHJpbmcoaHRtbCkucmVwbGFjZShyZWdleF9odG1sX2NoYXJhY3RlcnNfdG9fZXNjYXBlLCBtYXRjaCA9PiBlc2NhcGVkW21hdGNoXSk7XG59XG5jb25zdCByZWdleF90ZW1wbGF0ZV9jaGFyYWN0ZXJzX3RvX2VzY2FwZSA9IC8oXFwke3xgfFxcXFwpL2c7XG5mdW5jdGlvbiBlc2NhcGVfdGVtcGxhdGUoc3RyKSB7XG4gICAgcmV0dXJuIHN0ci5yZXBsYWNlKHJlZ2V4X3RlbXBsYXRlX2NoYXJhY3RlcnNfdG9fZXNjYXBlLCAnXFxcXCQxJyk7XG59XG5cbmZ1bmN0aW9uIGFkZF90b19zZXQoYSwgYikge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBiLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGEuYWRkKGl0ZW0pO1xuICAgIH0pO1xufVxuXG5jbGFzcyBBdHRyaWJ1dGUgZXh0ZW5kcyBOb2RlJDEge1xuICAgIGNvbnN0cnVjdG9yKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbykge1xuICAgICAgICBzdXBlcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pO1xuICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gICAgICAgIGlmIChpbmZvLnR5cGUgPT09ICdTcHJlYWQnKSB7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5pc19zcHJlYWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5pc190cnVlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBuZXcgRXhwcmVzc2lvbihjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpbmZvLmV4cHJlc3Npb24pO1xuICAgICAgICAgICAgdGhpcy5kZXBlbmRlbmNpZXMgPSB0aGlzLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzO1xuICAgICAgICAgICAgdGhpcy5jaHVua3MgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5pc19zdGF0aWMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IGluZm8ubmFtZTtcbiAgICAgICAgICAgIHRoaXMuaXNfdHJ1ZSA9IGluZm8udmFsdWUgPT09IHRydWU7XG4gICAgICAgICAgICB0aGlzLmlzX3N0YXRpYyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmRlcGVuZGVuY2llcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgIHRoaXMuY2h1bmtzID0gdGhpcy5pc190cnVlXG4gICAgICAgICAgICAgICAgPyBbXVxuICAgICAgICAgICAgICAgIDogaW5mby52YWx1ZS5tYXAobm9kZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdUZXh0JylcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzX3N0YXRpYyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBleHByZXNzaW9uID0gbmV3IEV4cHJlc3Npb24oY29tcG9uZW50LCB0aGlzLCBzY29wZSwgbm9kZS5leHByZXNzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgYWRkX3RvX3NldCh0aGlzLmRlcGVuZGVuY2llcywgZXhwcmVzc2lvbi5kZXBlbmRlbmNpZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhwcmVzc2lvbjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRfZGVwZW5kZW5jaWVzKCkge1xuICAgICAgICBpZiAodGhpcy5pc19zcHJlYWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5leHByZXNzaW9uLmR5bmFtaWNfZGVwZW5kZW5jaWVzKCk7XG4gICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5jaHVua3MuZm9yRWFjaChjaHVuayA9PiB7XG4gICAgICAgICAgICBpZiAoY2h1bmsudHlwZSA9PT0gJ0V4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICAgICAgYWRkX3RvX3NldChkZXBlbmRlbmNpZXMsIGNodW5rLmR5bmFtaWNfZGVwZW5kZW5jaWVzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oZGVwZW5kZW5jaWVzKTtcbiAgICB9XG4gICAgZ2V0X3ZhbHVlKGJsb2NrKSB7XG4gICAgICAgIGlmICh0aGlzLmlzX3RydWUpXG4gICAgICAgICAgICByZXR1cm4geCBgdHJ1ZWA7XG4gICAgICAgIGlmICh0aGlzLmNodW5rcy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICByZXR1cm4geCBgXCJcImA7XG4gICAgICAgIGlmICh0aGlzLmNodW5rcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNodW5rc1swXS50eXBlID09PSAnVGV4dCdcbiAgICAgICAgICAgICAgICA/IHN0cmluZ19saXRlcmFsKHRoaXMuY2h1bmtzWzBdLmRhdGEpXG4gICAgICAgICAgICAgICAgOiB0aGlzLmNodW5rc1swXS5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZXhwcmVzc2lvbiA9IHRoaXMuY2h1bmtzXG4gICAgICAgICAgICAubWFwKGNodW5rID0+IGNodW5rLnR5cGUgPT09ICdUZXh0JyA/IHN0cmluZ19saXRlcmFsKGNodW5rLmRhdGEpIDogY2h1bmsubWFuaXB1bGF0ZShibG9jaykpXG4gICAgICAgICAgICAucmVkdWNlKChsaHMsIHJocykgPT4geCBgJHtsaHN9ICsgJHtyaHN9YCk7XG4gICAgICAgIGlmICh0aGlzLmNodW5rc1swXS50eXBlICE9PSAnVGV4dCcpIHtcbiAgICAgICAgICAgIGV4cHJlc3Npb24gPSB4IGBcIlwiICsgJHtleHByZXNzaW9ufWA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb247XG4gICAgfVxuICAgIGdldF9zdGF0aWNfdmFsdWUoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc19zdGF0aWMpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNfdHJ1ZVxuICAgICAgICAgICAgPyB0cnVlXG4gICAgICAgICAgICA6IHRoaXMuY2h1bmtzWzBdXG4gICAgICAgICAgICAgICAgLy8gbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgb25seSB3aGVuIGBpc19zdGF0aWMgPSB0cnVlYFxuICAgICAgICAgICAgICAgID8gdGhpcy5jaHVua3NbMF0uZGF0YVxuICAgICAgICAgICAgICAgIDogJyc7XG4gICAgfVxuICAgIHNob3VsZF9jYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNfc3RhdGljXG4gICAgICAgICAgICA/IGZhbHNlXG4gICAgICAgICAgICA6IHRoaXMuY2h1bmtzLmxlbmd0aCA9PT0gMVxuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogcHJvYmFibHkgZXJyb3JcbiAgICAgICAgICAgICAgICA/IHRoaXMuY2h1bmtzWzBdLm5vZGUudHlwZSAhPT0gJ0lkZW50aWZpZXInIHx8IHRoaXMuc2NvcGUubmFtZXMuaGFzKHRoaXMuY2h1bmtzWzBdLm5vZGUubmFtZSlcbiAgICAgICAgICAgICAgICA6IHRydWU7XG4gICAgfVxufVxuXG4vLyBUT0RPIHRoaXMgc2hvdWxkIGxpdmUgaW4gYSBzcGVjaWZpYyBiaW5kaW5nXG5jb25zdCByZWFkX29ubHlfbWVkaWFfYXR0cmlidXRlcyA9IG5ldyBTZXQoW1xuICAgICdkdXJhdGlvbicsXG4gICAgJ2J1ZmZlcmVkJyxcbiAgICAnc2Vla2FibGUnLFxuICAgICdwbGF5ZWQnLFxuICAgICdzZWVraW5nJyxcbiAgICAnZW5kZWQnLFxuICAgICd2aWRlb0hlaWdodCcsXG4gICAgJ3ZpZGVvV2lkdGgnXG5dKTtcbmNsYXNzIEJpbmRpbmcgZXh0ZW5kcyBOb2RlJDEge1xuICAgIGNvbnN0cnVjdG9yKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbykge1xuICAgICAgICBzdXBlcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pO1xuICAgICAgICBpZiAoaW5mby5leHByZXNzaW9uLnR5cGUgIT09ICdJZGVudGlmaWVyJyAmJiBpbmZvLmV4cHJlc3Npb24udHlwZSAhPT0gJ01lbWJlckV4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICBjb21wb25lbnQuZXJyb3IoaW5mbywgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfZGlyZWN0aXZlX3ZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hbWUgPSBpbmZvLm5hbWU7XG4gICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IG5ldyBFeHByZXNzaW9uKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIGluZm8uZXhwcmVzc2lvbik7XG4gICAgICAgIHRoaXMucmF3X2V4cHJlc3Npb24gPSBjbG9uZShpbmZvLmV4cHJlc3Npb24pO1xuICAgICAgICBjb25zdCB7IG5hbWUgfSA9IGdldF9vYmplY3QodGhpcy5leHByZXNzaW9uLm5vZGUpO1xuICAgICAgICB0aGlzLmlzX2NvbnRleHR1YWwgPSBBcnJheS5mcm9tKHRoaXMuZXhwcmVzc2lvbi5yZWZlcmVuY2VzKS5zb21lKG5hbWUgPT4gc2NvcGUubmFtZXMuaGFzKG5hbWUpKTtcbiAgICAgICAgaWYgKHRoaXMuaXNfY29udGV4dHVhbClcbiAgICAgICAgICAgIHRoaXMudmFsaWRhdGVfYmluZGluZ19yZXN0X3Byb3BlcnRpZXMoc2NvcGUpO1xuICAgICAgICAvLyBtYWtlIHN1cmUgd2UgdHJhY2sgdGhpcyBhcyBhIG11dGFibGUgcmVmXG4gICAgICAgIGlmIChzY29wZS5pc19sZXQobmFtZSkpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcih0aGlzLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX2xldCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2NvcGUubmFtZXMuaGFzKG5hbWUpKSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUuaXNfYXdhaXQobmFtZSkpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuZXJyb3IodGhpcywgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfYmluZGluZ19hd2FpdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNjb3BlLmlzX2NvbnN0KG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50LmVycm9yKHRoaXMsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2JpbmRpbmdfY29uc3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NvcGUuZGVwZW5kZW5jaWVzX2Zvcl9uYW1lLmdldChuYW1lKS5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhcmlhYmxlID0gY29tcG9uZW50LnZhcl9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZS5tdXRhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHZhcmlhYmxlID0gY29tcG9uZW50LnZhcl9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgaWYgKCF2YXJpYWJsZSB8fCB2YXJpYWJsZS5nbG9iYWwpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuZXJyb3IodGhpcy5leHByZXNzaW9uLm5vZGUsIGNvbXBpbGVyX2Vycm9ycy5iaW5kaW5nX3VuZGVjbGFyZWQobmFtZSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhcmlhYmxlW3RoaXMuZXhwcmVzc2lvbi5ub2RlLnR5cGUgPT09ICdNZW1iZXJFeHByZXNzaW9uJyA/ICdtdXRhdGVkJyA6ICdyZWFzc2lnbmVkJ10gPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGluZm8uZXhwcmVzc2lvbi50eXBlID09PSAnSWRlbnRpZmllcicgJiYgIXZhcmlhYmxlLndyaXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50LmVycm9yKHRoaXMuZXhwcmVzc2lvbi5ub2RlLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX3dyaXRpYmFsZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHR5cGUgPSBwYXJlbnQuZ2V0X3N0YXRpY19hdHRyaWJ1dGVfdmFsdWUoJ3R5cGUnKTtcbiAgICAgICAgdGhpcy5pc19yZWFkb25seSA9XG4gICAgICAgICAgICByZWdleF9kaW1lbnNpb25zLnRlc3QodGhpcy5uYW1lKSB8fFxuICAgICAgICAgICAgICAgIChpc0VsZW1lbnQocGFyZW50KSAmJlxuICAgICAgICAgICAgICAgICAgICAoKHBhcmVudC5pc19tZWRpYV9ub2RlKCkgJiYgcmVhZF9vbmx5X21lZGlhX2F0dHJpYnV0ZXMuaGFzKHRoaXMubmFtZSkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAocGFyZW50Lm5hbWUgPT09ICdpbnB1dCcgJiYgdHlwZSA9PT0gJ2ZpbGUnKSkgLyogVE9ETyBvdGhlcnM/ICovKTtcbiAgICB9XG4gICAgaXNfcmVhZG9ubHlfbWVkaWFfYXR0cmlidXRlKCkge1xuICAgICAgICByZXR1cm4gcmVhZF9vbmx5X21lZGlhX2F0dHJpYnV0ZXMuaGFzKHRoaXMubmFtZSk7XG4gICAgfVxuICAgIHZhbGlkYXRlX2JpbmRpbmdfcmVzdF9wcm9wZXJ0aWVzKHNjb3BlKSB7XG4gICAgICAgIHRoaXMuZXhwcmVzc2lvbi5yZWZlcmVuY2VzLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlYWNoX2Jsb2NrID0gc2NvcGUuZ2V0X293bmVyKG5hbWUpO1xuICAgICAgICAgICAgaWYgKGVhY2hfYmxvY2sgJiYgZWFjaF9ibG9jay50eXBlID09PSAnRWFjaEJsb2NrJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3Rfbm9kZSA9IGVhY2hfYmxvY2suY29udGV4dF9yZXN0X3Byb3BlcnRpZXMuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXN0X25vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wb25lbnQud2FybihyZXN0X25vZGUsIGNvbXBpbGVyX3dhcm5pbmdzLmludmFsaWRfcmVzdF9lYWNoYmxvY2tfYmluZGluZyhuYW1lKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkge1xuICAgIHJldHVybiAhIW5vZGUuaXNfbWVkaWFfbm9kZTtcbn1cblxuY2xhc3MgVHJhbnNpdGlvbiBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIGNvbXBvbmVudC53YXJuX2lmX3VuZGVmaW5lZChpbmZvLm5hbWUsIGluZm8sIHNjb3BlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gaW5mby5uYW1lO1xuICAgICAgICBjb21wb25lbnQuYWRkX3JlZmVyZW5jZSh0aGlzLCBpbmZvLm5hbWUuc3BsaXQoJy4nKVswXSk7XG4gICAgICAgIHRoaXMuZGlyZWN0aXZlID0gaW5mby5pbnRybyAmJiBpbmZvLm91dHJvID8gJ3RyYW5zaXRpb24nIDogaW5mby5pbnRybyA/ICdpbicgOiAnb3V0JztcbiAgICAgICAgdGhpcy5pc19sb2NhbCA9IGluZm8ubW9kaWZpZXJzLmluY2x1ZGVzKCdsb2NhbCcpO1xuICAgICAgICBpZiAoKGluZm8uaW50cm8gJiYgcGFyZW50LmludHJvKSB8fCAoaW5mby5vdXRybyAmJiBwYXJlbnQub3V0cm8pKSB7XG4gICAgICAgICAgICBjb25zdCBwYXJlbnRfdHJhbnNpdGlvbiA9IChwYXJlbnQuaW50cm8gfHwgcGFyZW50Lm91dHJvKTtcbiAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcihpbmZvLCBjb21waWxlcl9lcnJvcnMuZHVwbGljYXRlX3RyYW5zaXRpb24odGhpcy5kaXJlY3RpdmUsIHBhcmVudF90cmFuc2l0aW9uLmRpcmVjdGl2ZSkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IGluZm8uZXhwcmVzc2lvblxuICAgICAgICAgICAgPyBuZXcgRXhwcmVzc2lvbihjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpbmZvLmV4cHJlc3Npb24pXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgfVxufVxuXG5jbGFzcyBBbmltYXRpb24gZXh0ZW5kcyBOb2RlJDEge1xuICAgIGNvbnN0cnVjdG9yKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbykge1xuICAgICAgICBzdXBlcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pO1xuICAgICAgICBjb21wb25lbnQud2Fybl9pZl91bmRlZmluZWQoaW5mby5uYW1lLCBpbmZvLCBzY29wZSk7XG4gICAgICAgIHRoaXMubmFtZSA9IGluZm8ubmFtZTtcbiAgICAgICAgY29tcG9uZW50LmFkZF9yZWZlcmVuY2UodGhpcywgaW5mby5uYW1lLnNwbGl0KCcuJylbMF0pO1xuICAgICAgICBpZiAocGFyZW50LmFuaW1hdGlvbikge1xuICAgICAgICAgICAgY29tcG9uZW50LmVycm9yKHRoaXMsIGNvbXBpbGVyX2Vycm9ycy5kdXBsaWNhdGVfYW5pbWF0aW9uKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBibG9jayA9IHBhcmVudC5wYXJlbnQ7XG4gICAgICAgIGlmICghYmxvY2sgfHwgYmxvY2sudHlwZSAhPT0gJ0VhY2hCbG9jaycpIHtcbiAgICAgICAgICAgIC8vIFRPRE8gY2FuIHdlIHJlbGF4IHRoZSAnaW1tZWRpYXRlIGNoaWxkJyBydWxlP1xuICAgICAgICAgICAgY29tcG9uZW50LmVycm9yKHRoaXMsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2FuaW1hdGlvbl9pbW1lZGlhdGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYmxvY2sua2V5KSB7XG4gICAgICAgICAgICBjb21wb25lbnQuZXJyb3IodGhpcywgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfYW5pbWF0aW9uX2tleSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2suaGFzX2FuaW1hdGlvbiA9IHRydWU7XG4gICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IGluZm8uZXhwcmVzc2lvblxuICAgICAgICAgICAgPyBuZXcgRXhwcmVzc2lvbihjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpbmZvLmV4cHJlc3Npb24sIHRydWUpXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgfVxufVxuXG5jbGFzcyBDbGFzcyBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMubmFtZSA9IGluZm8ubmFtZTtcbiAgICAgICAgdGhpcy5leHByZXNzaW9uID0gaW5mby5leHByZXNzaW9uXG4gICAgICAgICAgICA/IG5ldyBFeHByZXNzaW9uKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIGluZm8uZXhwcmVzc2lvbilcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICB9XG59XG5cbi8qKlxuICogVHJhbnNmb3JtcyBhIGxpc3Qgb2YgVGV4dCBhbmQgTXVzdGFjaGVUYWdzIGludG8gYSBUZW1wbGF0ZUxpdGVyYWwgZXhwcmVzc2lvbi5cbiAqIFN0YXJ0L0VuZCBwb3NpdGlvbnMgb24gdGhlIGVsZW1lbnRzIG9mIHRoZSBleHByZXNzaW9uIGFyZSBub3Qgc2V0LlxuICovXG5mdW5jdGlvbiBub2Rlc190b190ZW1wbGF0ZV9saXRlcmFsKHZhbHVlKSB7XG4gICAgY29uc3QgbGl0ZXJhbCA9IHtcbiAgICAgICAgdHlwZTogJ1RlbXBsYXRlTGl0ZXJhbCcsXG4gICAgICAgIGV4cHJlc3Npb25zOiBbXSxcbiAgICAgICAgcXVhc2lzOiBbXVxuICAgIH07XG4gICAgbGV0IHF1YXNpID0ge1xuICAgICAgICB0eXBlOiAnVGVtcGxhdGVFbGVtZW50JyxcbiAgICAgICAgdmFsdWU6IHsgcmF3OiAnJywgY29va2VkOiBudWxsIH0sXG4gICAgICAgIHRhaWw6IGZhbHNlXG4gICAgfTtcbiAgICB2YWx1ZS5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdUZXh0Jykge1xuICAgICAgICAgICAgcXVhc2kudmFsdWUucmF3ICs9IG5vZGUucmF3O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ011c3RhY2hlVGFnJykge1xuICAgICAgICAgICAgbGl0ZXJhbC5xdWFzaXMucHVzaChxdWFzaSk7XG4gICAgICAgICAgICBsaXRlcmFsLmV4cHJlc3Npb25zLnB1c2gobm9kZS5leHByZXNzaW9uKTtcbiAgICAgICAgICAgIHF1YXNpID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdUZW1wbGF0ZUVsZW1lbnQnLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB7IHJhdzogJycsIGNvb2tlZDogbnVsbCB9LFxuICAgICAgICAgICAgICAgIHRhaWw6IGZhbHNlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcXVhc2kudGFpbCA9IHRydWU7XG4gICAgbGl0ZXJhbC5xdWFzaXMucHVzaChxdWFzaSk7XG4gICAgcmV0dXJuIGxpdGVyYWw7XG59XG5cbmNvbnN0IHZhbGlkX21vZGlmaWVycyA9IG5ldyBTZXQoWydpbXBvcnRhbnQnXSk7XG5jbGFzcyBTdHlsZURpcmVjdGl2ZSBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMubmFtZSA9IGluZm8ubmFtZTtcbiAgICAgICAgdGhpcy5tb2RpZmllcnMgPSBuZXcgU2V0KGluZm8ubW9kaWZpZXJzKTtcbiAgICAgICAgZm9yIChjb25zdCBtb2RpZmllciBvZiB0aGlzLm1vZGlmaWVycykge1xuICAgICAgICAgICAgaWYgKCF2YWxpZF9tb2RpZmllcnMuaGFzKG1vZGlmaWVyKSkge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcih0aGlzLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9zdHlsZV9kaXJlY3RpdmVfbW9kaWZpZXIobGlzdCQxKFsuLi52YWxpZF9tb2RpZmllcnNdKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIENvbnZlcnQgdGhlIHZhbHVlIGFycmF5IHRvIGFuIGV4cHJlc3Npb24gc28gaXQncyBlYXNpZXIgdG8gaGFuZGxlXG4gICAgICAgIC8vIHRoZSBTdHlsZURpcmVjdGl2ZSBnb2luZyBmb3J3YXJkLlxuICAgICAgICBpZiAoaW5mby52YWx1ZSA9PT0gdHJ1ZSB8fCAoaW5mby52YWx1ZS5sZW5ndGggPT09IDEgJiYgaW5mby52YWx1ZVswXS50eXBlID09PSAnTXVzdGFjaGVUYWcnKSkge1xuICAgICAgICAgICAgY29uc3QgaWRlbnRpZmllciA9IGluZm8udmFsdWUgPT09IHRydWVcbiAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0lkZW50aWZpZXInLFxuICAgICAgICAgICAgICAgICAgICBzdGFydDogaW5mby5lbmQgLSBpbmZvLm5hbWUubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBlbmQ6IGluZm8uZW5kLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmZvLm5hbWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgOiBpbmZvLnZhbHVlWzBdLmV4cHJlc3Npb247XG4gICAgICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBuZXcgRXhwcmVzc2lvbihjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpZGVudGlmaWVyKTtcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkX2NhY2hlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCByYXdfZXhwcmVzc2lvbiA9IG5vZGVzX3RvX3RlbXBsYXRlX2xpdGVyYWwoaW5mby52YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBuZXcgRXhwcmVzc2lvbihjb21wb25lbnQsIHRoaXMsIHNjb3BlLCByYXdfZXhwcmVzc2lvbik7XG4gICAgICAgICAgICB0aGlzLnNob3VsZF9jYWNoZSA9IHJhd19leHByZXNzaW9uLmV4cHJlc3Npb25zLmxlbmd0aCA+IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGltcG9ydGFudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kaWZpZXJzLmhhcygnaW1wb3J0YW50Jyk7XG4gICAgfVxufVxuXG4vLyBXaGl0ZXNwYWNlIGluc2lkZSBvbmUgb2YgdGhlc2UgZWxlbWVudHMgd2lsbCBub3QgcmVzdWx0IGluXG4vLyBhIHdoaXRlc3BhY2Ugbm9kZSBiZWluZyBjcmVhdGVkIGluIGFueSBjaXJjdW1zdGFuY2VzLiAoVGhpc1xuLy8gbGlzdCBpcyBhbG1vc3QgY2VydGFpbmx5IHZlcnkgaW5jb21wbGV0ZSlcbmNvbnN0IGVsZW1lbnRzX3dpdGhvdXRfdGV4dCA9IG5ldyBTZXQoW1xuICAgICdhdWRpbycsXG4gICAgJ2RhdGFsaXN0JyxcbiAgICAnZGwnLFxuICAgICdvcHRncm91cCcsXG4gICAgJ3NlbGVjdCcsXG4gICAgJ3ZpZGVvJ1xuXSk7XG5jb25zdCByZWdleF9lbmRzX3dpdGhfc3ZnID0gL3N2ZyQvO1xuY2xhc3MgVGV4dCBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuZGF0YSA9IGluZm8uZGF0YTtcbiAgICAgICAgdGhpcy5zeW50aGV0aWMgPSBpbmZvLnN5bnRoZXRpYyB8fCBmYWxzZTtcbiAgICB9XG4gICAgc2hvdWxkX3NraXAoKSB7XG4gICAgICAgIGlmIChyZWdleF9ub25fd2hpdGVzcGFjZV9jaGFyYWN0ZXIudGVzdCh0aGlzLmRhdGEpKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICBjb25zdCBwYXJlbnRfZWxlbWVudCA9IHRoaXMuZmluZF9uZWFyZXN0KC8oPzpFbGVtZW50fElubGluZUNvbXBvbmVudHxTbG90VGVtcGxhdGV8SGVhZCkvKTtcbiAgICAgICAgaWYgKCFwYXJlbnRfZWxlbWVudClcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKHBhcmVudF9lbGVtZW50LnR5cGUgPT09ICdIZWFkJylcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAocGFyZW50X2VsZW1lbnQudHlwZSA9PT0gJ0lubGluZUNvbXBvbmVudCcpXG4gICAgICAgICAgICByZXR1cm4gcGFyZW50X2VsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoID09PSAxICYmIHRoaXMgPT09IHBhcmVudF9lbGVtZW50LmNoaWxkcmVuWzBdO1xuICAgICAgICAvLyBzdmcgbmFtZXNwYWNlIGV4Y2x1c2lvbnNcbiAgICAgICAgaWYgKHJlZ2V4X2VuZHNfd2l0aF9zdmcudGVzdChwYXJlbnRfZWxlbWVudC5uYW1lc3BhY2UpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2ICYmIHRoaXMucHJldi50eXBlID09PSAnRWxlbWVudCcgJiYgdGhpcy5wcmV2Lm5hbWUgPT09ICd0c3BhbicpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJlbnRfZWxlbWVudC5uYW1lc3BhY2UgfHwgZWxlbWVudHNfd2l0aG91dF90ZXh0LmhhcyhwYXJlbnRfZWxlbWVudC5uYW1lKTtcbiAgICB9XG4gICAga2VlcF9zcGFjZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50LmNvbXBvbmVudF9vcHRpb25zLnByZXNlcnZlV2hpdGVzcGFjZSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICByZXR1cm4gdGhpcy53aXRoaW5fcHJlKCk7XG4gICAgfVxuICAgIHdpdGhpbl9wcmUoKSB7XG4gICAgICAgIGxldCBub2RlID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHdoaWxlIChub2RlKSB7XG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnRWxlbWVudCcgJiYgbm9kZS5uYW1lID09PSAncHJlJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5cbi8vIFRoZSBgZm9yZWlnbmAgbmFtZXNwYWNlIGNvdmVycyBhbGwgRE9NIGltcGxlbWVudGF0aW9ucyB0aGF0IGFyZW4ndCBIVE1MNS5cbi8vIEl0IG9wdHMgb3V0IG9mIEhUTUw1LXNwZWNpZmljIGExMXkgY2hlY2tzIGFuZCBjYXNlLWluc2Vuc2l0aXZlIGF0dHJpYnV0ZSBuYW1lcy5cbmNvbnN0IGZvcmVpZ24gPSAnaHR0cHM6Ly9zdmVsdGUuZGV2L2RvY3MjdGVtcGxhdGUtc3ludGF4LXN2ZWx0ZS1vcHRpb25zJztcbmNvbnN0IGh0bWwgPSAnaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCc7XG5jb25zdCBtYXRobWwgPSAnaHR0cDovL3d3dy53My5vcmcvMTk5OC9NYXRoL01hdGhNTCc7XG5jb25zdCBzdmckMSA9ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc7XG5jb25zdCB4bGluayA9ICdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJztcbmNvbnN0IHhtbCA9ICdodHRwOi8vd3d3LnczLm9yZy9YTUwvMTk5OC9uYW1lc3BhY2UnO1xuY29uc3QgeG1sbnMgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC94bWxucyc7XG5jb25zdCB2YWxpZF9uYW1lc3BhY2VzID0gW1xuICAgICdmb3JlaWduJyxcbiAgICAnaHRtbCcsXG4gICAgJ21hdGhtbCcsXG4gICAgJ3N2ZycsXG4gICAgJ3hsaW5rJyxcbiAgICAneG1sJyxcbiAgICAneG1sbnMnLFxuICAgIGZvcmVpZ24sXG4gICAgaHRtbCxcbiAgICBtYXRobWwsXG4gICAgc3ZnJDEsXG4gICAgeGxpbmssXG4gICAgeG1sLFxuICAgIHhtbG5zXG5dO1xuY29uc3QgbmFtZXNwYWNlcyA9IHsgZm9yZWlnbiwgaHRtbCwgbWF0aG1sLCBzdmc6IHN2ZyQxLCB4bGluaywgeG1sLCB4bWxucyB9O1xuXG5jb25zdCBhcHBsaWNhYmxlID0gbmV3IFNldChbJ0lkZW50aWZpZXInLCAnT2JqZWN0RXhwcmVzc2lvbicsICdBcnJheUV4cHJlc3Npb24nLCAnUHJvcGVydHknXSk7XG5jbGFzcyBMZXQgZXh0ZW5kcyBOb2RlJDEge1xuICAgIGNvbnN0cnVjdG9yKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbykge1xuICAgICAgICBzdXBlcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pO1xuICAgICAgICB0aGlzLm5hbWVzID0gW107XG4gICAgICAgIHRoaXMubmFtZSA9IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiBpbmZvLm5hbWUgfTtcbiAgICAgICAgY29uc3QgeyBuYW1lcyB9ID0gdGhpcztcbiAgICAgICAgaWYgKGluZm8uZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGluZm8uZXhwcmVzc2lvbjtcbiAgICAgICAgICAgIHdhbGsoaW5mby5leHByZXNzaW9uLCB7XG4gICAgICAgICAgICAgICAgZW50ZXIobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFwcGxpY2FibGUuaGFzKG5vZGUudHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3Iobm9kZSwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfbGV0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnSWRlbnRpZmllcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzLnB1c2gobm9kZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBzbGlnaHRseSB1bmZvcnR1bmF0ZSBoYWNrXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdBcnJheUV4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnR5cGUgPSAnQXJyYXlQYXR0ZXJuJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnT2JqZWN0RXhwcmVzc2lvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUudHlwZSA9ICdPYmplY3RQYXR0ZXJuJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmFtZXMucHVzaCh0aGlzLm5hbWUubmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHVud3JhcEV4cG9ydHMgKHgpIHtcblx0cmV0dXJuIHggJiYgeC5fX2VzTW9kdWxlICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh4LCAnZGVmYXVsdCcpID8geFsnZGVmYXVsdCddIDogeDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29tbW9uanNNb2R1bGUoZm4sIG1vZHVsZSkge1xuXHRyZXR1cm4gbW9kdWxlID0geyBleHBvcnRzOiB7fSB9LCBmbihtb2R1bGUsIG1vZHVsZS5leHBvcnRzKSwgbW9kdWxlLmV4cG9ydHM7XG59XG5cbnZhciBhcmlhUHJvcHNNYXBfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxuZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH1cblxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTsgfVxuXG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH1cblxuZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9XG5cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9pID0gYXJyID09IG51bGwgPyBudWxsIDogdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBhcnJbU3ltYm9sLml0ZXJhdG9yXSB8fCBhcnJbXCJAQGl0ZXJhdG9yXCJdOyBpZiAoX2kgPT0gbnVsbCkgcmV0dXJuOyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9zLCBfZTsgdHJ5IHsgZm9yIChfaSA9IF9pLmNhbGwoYXJyKTsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbXCJyZXR1cm5cIl0gIT0gbnVsbCkgX2lbXCJyZXR1cm5cIl0oKTsgfSBmaW5hbGx5IHsgaWYgKF9kKSB0aHJvdyBfZTsgfSB9IHJldHVybiBfYXJyOyB9XG5cbmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfVxuXG52YXIgcHJvcGVydGllcyA9IFtbJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcsIHtcbiAgJ3R5cGUnOiAnaWQnXG59XSwgWydhcmlhLWF0b21pYycsIHtcbiAgJ3R5cGUnOiAnYm9vbGVhbidcbn1dLCBbJ2FyaWEtYXV0b2NvbXBsZXRlJywge1xuICAndHlwZSc6ICd0b2tlbicsXG4gICd2YWx1ZXMnOiBbJ2lubGluZScsICdsaXN0JywgJ2JvdGgnLCAnbm9uZSddXG59XSwgWydhcmlhLWJ1c3knLCB7XG4gICd0eXBlJzogJ2Jvb2xlYW4nXG59XSwgWydhcmlhLWNoZWNrZWQnLCB7XG4gICd0eXBlJzogJ3RyaXN0YXRlJ1xufV0sIFsnYXJpYS1jb2xjb3VudCcsIHtcbiAgdHlwZTogJ2ludGVnZXInXG59XSwgWydhcmlhLWNvbGluZGV4Jywge1xuICB0eXBlOiAnaW50ZWdlcidcbn1dLCBbJ2FyaWEtY29sc3BhbicsIHtcbiAgdHlwZTogJ2ludGVnZXInXG59XSwgWydhcmlhLWNvbnRyb2xzJywge1xuICAndHlwZSc6ICdpZGxpc3QnXG59XSwgWydhcmlhLWN1cnJlbnQnLCB7XG4gIHR5cGU6ICd0b2tlbicsXG4gIHZhbHVlczogWydwYWdlJywgJ3N0ZXAnLCAnbG9jYXRpb24nLCAnZGF0ZScsICd0aW1lJywgdHJ1ZSwgZmFsc2VdXG59XSwgWydhcmlhLWRlc2NyaWJlZGJ5Jywge1xuICAndHlwZSc6ICdpZGxpc3QnXG59XSwgWydhcmlhLWRldGFpbHMnLCB7XG4gICd0eXBlJzogJ2lkJ1xufV0sIFsnYXJpYS1kaXNhYmxlZCcsIHtcbiAgJ3R5cGUnOiAnYm9vbGVhbidcbn1dLCBbJ2FyaWEtZHJvcGVmZmVjdCcsIHtcbiAgJ3R5cGUnOiAndG9rZW5saXN0JyxcbiAgJ3ZhbHVlcyc6IFsnY29weScsICdleGVjdXRlJywgJ2xpbmsnLCAnbW92ZScsICdub25lJywgJ3BvcHVwJ11cbn1dLCBbJ2FyaWEtZXJyb3JtZXNzYWdlJywge1xuICAndHlwZSc6ICdpZCdcbn1dLCBbJ2FyaWEtZXhwYW5kZWQnLCB7XG4gICd0eXBlJzogJ2Jvb2xlYW4nLFxuICAnYWxsb3d1bmRlZmluZWQnOiB0cnVlXG59XSwgWydhcmlhLWZsb3d0bycsIHtcbiAgJ3R5cGUnOiAnaWRsaXN0J1xufV0sIFsnYXJpYS1ncmFiYmVkJywge1xuICAndHlwZSc6ICdib29sZWFuJyxcbiAgJ2FsbG93dW5kZWZpbmVkJzogdHJ1ZVxufV0sIFsnYXJpYS1oYXNwb3B1cCcsIHtcbiAgJ3R5cGUnOiAndG9rZW4nLFxuICAndmFsdWVzJzogW2ZhbHNlLCB0cnVlLCAnbWVudScsICdsaXN0Ym94JywgJ3RyZWUnLCAnZ3JpZCcsICdkaWFsb2cnXVxufV0sIFsnYXJpYS1oaWRkZW4nLCB7XG4gICd0eXBlJzogJ2Jvb2xlYW4nLFxuICAnYWxsb3d1bmRlZmluZWQnOiB0cnVlXG59XSwgWydhcmlhLWludmFsaWQnLCB7XG4gICd0eXBlJzogJ3Rva2VuJyxcbiAgJ3ZhbHVlcyc6IFsnZ3JhbW1hcicsIGZhbHNlLCAnc3BlbGxpbmcnLCB0cnVlXVxufV0sIFsnYXJpYS1rZXlzaG9ydGN1dHMnLCB7XG4gIHR5cGU6ICdzdHJpbmcnXG59XSwgWydhcmlhLWxhYmVsJywge1xuICAndHlwZSc6ICdzdHJpbmcnXG59XSwgWydhcmlhLWxhYmVsbGVkYnknLCB7XG4gICd0eXBlJzogJ2lkbGlzdCdcbn1dLCBbJ2FyaWEtbGV2ZWwnLCB7XG4gICd0eXBlJzogJ2ludGVnZXInXG59XSwgWydhcmlhLWxpdmUnLCB7XG4gICd0eXBlJzogJ3Rva2VuJyxcbiAgJ3ZhbHVlcyc6IFsnYXNzZXJ0aXZlJywgJ29mZicsICdwb2xpdGUnXVxufV0sIFsnYXJpYS1tb2RhbCcsIHtcbiAgdHlwZTogJ2Jvb2xlYW4nXG59XSwgWydhcmlhLW11bHRpbGluZScsIHtcbiAgJ3R5cGUnOiAnYm9vbGVhbidcbn1dLCBbJ2FyaWEtbXVsdGlzZWxlY3RhYmxlJywge1xuICAndHlwZSc6ICdib29sZWFuJ1xufV0sIFsnYXJpYS1vcmllbnRhdGlvbicsIHtcbiAgJ3R5cGUnOiAndG9rZW4nLFxuICAndmFsdWVzJzogWyd2ZXJ0aWNhbCcsICd1bmRlZmluZWQnLCAnaG9yaXpvbnRhbCddXG59XSwgWydhcmlhLW93bnMnLCB7XG4gICd0eXBlJzogJ2lkbGlzdCdcbn1dLCBbJ2FyaWEtcGxhY2Vob2xkZXInLCB7XG4gIHR5cGU6ICdzdHJpbmcnXG59XSwgWydhcmlhLXBvc2luc2V0Jywge1xuICAndHlwZSc6ICdpbnRlZ2VyJ1xufV0sIFsnYXJpYS1wcmVzc2VkJywge1xuICAndHlwZSc6ICd0cmlzdGF0ZSdcbn1dLCBbJ2FyaWEtcmVhZG9ubHknLCB7XG4gICd0eXBlJzogJ2Jvb2xlYW4nXG59XSwgWydhcmlhLXJlbGV2YW50Jywge1xuICAndHlwZSc6ICd0b2tlbmxpc3QnLFxuICAndmFsdWVzJzogWydhZGRpdGlvbnMnLCAnYWxsJywgJ3JlbW92YWxzJywgJ3RleHQnXVxufV0sIFsnYXJpYS1yZXF1aXJlZCcsIHtcbiAgJ3R5cGUnOiAnYm9vbGVhbidcbn1dLCBbJ2FyaWEtcm9sZWRlc2NyaXB0aW9uJywge1xuICB0eXBlOiAnc3RyaW5nJ1xufV0sIFsnYXJpYS1yb3djb3VudCcsIHtcbiAgdHlwZTogJ2ludGVnZXInXG59XSwgWydhcmlhLXJvd2luZGV4Jywge1xuICB0eXBlOiAnaW50ZWdlcidcbn1dLCBbJ2FyaWEtcm93c3BhbicsIHtcbiAgdHlwZTogJ2ludGVnZXInXG59XSwgWydhcmlhLXNlbGVjdGVkJywge1xuICAndHlwZSc6ICdib29sZWFuJyxcbiAgJ2FsbG93dW5kZWZpbmVkJzogdHJ1ZVxufV0sIFsnYXJpYS1zZXRzaXplJywge1xuICAndHlwZSc6ICdpbnRlZ2VyJ1xufV0sIFsnYXJpYS1zb3J0Jywge1xuICAndHlwZSc6ICd0b2tlbicsXG4gICd2YWx1ZXMnOiBbJ2FzY2VuZGluZycsICdkZXNjZW5kaW5nJywgJ25vbmUnLCAnb3RoZXInXVxufV0sIFsnYXJpYS12YWx1ZW1heCcsIHtcbiAgJ3R5cGUnOiAnbnVtYmVyJ1xufV0sIFsnYXJpYS12YWx1ZW1pbicsIHtcbiAgJ3R5cGUnOiAnbnVtYmVyJ1xufV0sIFsnYXJpYS12YWx1ZW5vdycsIHtcbiAgJ3R5cGUnOiAnbnVtYmVyJ1xufV0sIFsnYXJpYS12YWx1ZXRleHQnLCB7XG4gICd0eXBlJzogJ3N0cmluZydcbn1dXTtcbnZhciBhcmlhUHJvcHNNYXAgPSB7XG4gIGVudHJpZXM6IGZ1bmN0aW9uIGVudHJpZXMoKSB7XG4gICAgcmV0dXJuIHByb3BlcnRpZXM7XG4gIH0sXG4gIGdldDogZnVuY3Rpb24gZ2V0KGtleSkge1xuICAgIHZhciBpdGVtID0gcHJvcGVydGllcy5maW5kKGZ1bmN0aW9uICh0dXBsZSkge1xuICAgICAgcmV0dXJuIHR1cGxlWzBdID09PSBrZXkgPyB0cnVlIDogZmFsc2U7XG4gICAgfSk7XG4gICAgcmV0dXJuIGl0ZW0gJiYgaXRlbVsxXTtcbiAgfSxcbiAgaGFzOiBmdW5jdGlvbiBoYXMoa2V5KSB7XG4gICAgcmV0dXJuICEhdGhpcy5nZXQoa2V5KTtcbiAgfSxcbiAga2V5czogZnVuY3Rpb24ga2V5cygpIHtcbiAgICByZXR1cm4gcHJvcGVydGllcy5tYXAoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgIHZhciBfcmVmMiA9IF9zbGljZWRUb0FycmF5KF9yZWYsIDEpLFxuICAgICAgICAgIGtleSA9IF9yZWYyWzBdO1xuXG4gICAgICByZXR1cm4ga2V5O1xuICAgIH0pO1xuICB9LFxuICB2YWx1ZXM6IGZ1bmN0aW9uIHZhbHVlcygpIHtcbiAgICByZXR1cm4gcHJvcGVydGllcy5tYXAoZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgICB2YXIgX3JlZjQgPSBfc2xpY2VkVG9BcnJheShfcmVmMywgMiksXG4gICAgICAgICAgdmFsdWVzID0gX3JlZjRbMV07XG5cbiAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgfSk7XG4gIH1cbn07XG52YXIgX2RlZmF1bHQgPSBhcmlhUHJvcHNNYXA7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGFyaWFQcm9wc01hcF8xKTtcblxudmFyIGRvbU1hcF8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG5mdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsgfVxuXG5mdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpOyB9XG5cbmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfVxuXG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH1cblxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyB2YXIgX2kgPSBhcnIgPT0gbnVsbCA/IG51bGwgOiB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGFycltTeW1ib2wuaXRlcmF0b3JdIHx8IGFycltcIkBAaXRlcmF0b3JcIl07IGlmIChfaSA9PSBudWxsKSByZXR1cm47IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX3MsIF9lOyB0cnkgeyBmb3IgKF9pID0gX2kuY2FsbChhcnIpOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVtcInJldHVyblwiXSAhPSBudWxsKSBfaVtcInJldHVyblwiXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH1cblxuZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9XG5cbnZhciBkb20gPSBbWydhJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2FiYnInLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnYWNyb255bScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydhZGRyZXNzJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2FwcGxldCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydhcmVhJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2FydGljbGUnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnYXNpZGUnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnYXVkaW8nLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnYicsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydiYXNlJywge1xuICByZXNlcnZlZDogdHJ1ZVxufV0sIFsnYmRpJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2JkbycsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydiaWcnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnYmxpbmsnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnYmxvY2txdW90ZScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydib2R5Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2JyJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2J1dHRvbicsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydjYW52YXMnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnY2FwdGlvbicsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydjZW50ZXInLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnY2l0ZScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydjb2RlJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2NvbCcsIHtcbiAgcmVzZXJ2ZWQ6IHRydWVcbn1dLCBbJ2NvbGdyb3VwJywge1xuICByZXNlcnZlZDogdHJ1ZVxufV0sIFsnY29udGVudCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydkYXRhJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2RhdGFsaXN0Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2RkJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2RlbCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydkZXRhaWxzJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2RmbicsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydkaWFsb2cnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnZGlyJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2RpdicsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydkbCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydkdCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydlbScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydlbWJlZCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydmaWVsZHNldCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydmaWdjYXB0aW9uJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2ZpZ3VyZScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydmb250Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2Zvb3RlcicsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydmb3JtJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2ZyYW1lJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2ZyYW1lc2V0Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2gxJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2gyJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2gzJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2g0Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2g1Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2g2Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2hlYWQnLCB7XG4gIHJlc2VydmVkOiB0cnVlXG59XSwgWydoZWFkZXInLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnaGdyb3VwJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2hyJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2h0bWwnLCB7XG4gIHJlc2VydmVkOiB0cnVlXG59XSwgWydpJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2lmcmFtZScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydpbWcnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnaW5wdXQnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnaW5zJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2tiZCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydrZXlnZW4nLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnbGFiZWwnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnbGVnZW5kJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2xpJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ2xpbmsnLCB7XG4gIHJlc2VydmVkOiB0cnVlXG59XSwgWydtYWluJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ21hcCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydtYXJrJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ21hcnF1ZWUnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnbWVudScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydtZW51aXRlbScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydtZXRhJywge1xuICByZXNlcnZlZDogdHJ1ZVxufV0sIFsnbWV0ZXInLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnbmF2Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ25vZW1iZWQnLCB7XG4gIHJlc2VydmVkOiB0cnVlXG59XSwgWydub3NjcmlwdCcsIHtcbiAgcmVzZXJ2ZWQ6IHRydWVcbn1dLCBbJ29iamVjdCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydvbCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydvcHRncm91cCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydvcHRpb24nLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnb3V0cHV0Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3AnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsncGFyYW0nLCB7XG4gIHJlc2VydmVkOiB0cnVlXG59XSwgWydwaWN0dXJlJywge1xuICByZXNlcnZlZDogdHJ1ZVxufV0sIFsncHJlJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3Byb2dyZXNzJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3EnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsncnAnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsncnQnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsncnRjJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3J1YnknLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsncycsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydzYW1wJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3NjcmlwdCcsIHtcbiAgcmVzZXJ2ZWQ6IHRydWVcbn1dLCBbJ3NlY3Rpb24nLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnc2VsZWN0Jywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3NtYWxsJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3NvdXJjZScsIHtcbiAgcmVzZXJ2ZWQ6IHRydWVcbn1dLCBbJ3NwYWNlcicsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydzcGFuJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3N0cmlrZScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydzdHJvbmcnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnc3R5bGUnLCB7XG4gIHJlc2VydmVkOiB0cnVlXG59XSwgWydzdWInLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnc3VtbWFyeScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWydzdXAnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndGFibGUnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndGJvZHknLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndGQnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndGV4dGFyZWEnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndGZvb3QnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndGgnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndGhlYWQnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndGltZScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWyd0aXRsZScsIHtcbiAgcmVzZXJ2ZWQ6IHRydWVcbn1dLCBbJ3RyJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3RyYWNrJywge1xuICByZXNlcnZlZDogdHJ1ZVxufV0sIFsndHQnLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndScsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWyd1bCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XSwgWyd2YXInLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsndmlkZW8nLCB7XG4gIHJlc2VydmVkOiBmYWxzZVxufV0sIFsnd2JyJywge1xuICByZXNlcnZlZDogZmFsc2Vcbn1dLCBbJ3htcCcsIHtcbiAgcmVzZXJ2ZWQ6IGZhbHNlXG59XV07XG52YXIgZG9tTWFwID0ge1xuICBlbnRyaWVzOiBmdW5jdGlvbiBlbnRyaWVzKCkge1xuICAgIHJldHVybiBkb207XG4gIH0sXG4gIGdldDogZnVuY3Rpb24gZ2V0KGtleSkge1xuICAgIHZhciBpdGVtID0gZG9tLmZpbmQoZnVuY3Rpb24gKHR1cGxlKSB7XG4gICAgICByZXR1cm4gdHVwbGVbMF0gPT09IGtleSA/IHRydWUgOiBmYWxzZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaXRlbSAmJiBpdGVtWzFdO1xuICB9LFxuICBoYXM6IGZ1bmN0aW9uIGhhcyhrZXkpIHtcbiAgICByZXR1cm4gISF0aGlzLmdldChrZXkpO1xuICB9LFxuICBrZXlzOiBmdW5jdGlvbiBrZXlzKCkge1xuICAgIHJldHVybiBkb20ubWFwKGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAxKSxcbiAgICAgICAgICBrZXkgPSBfcmVmMlswXTtcblxuICAgICAgcmV0dXJuIGtleTtcbiAgICB9KTtcbiAgfSxcbiAgdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoKSB7XG4gICAgcmV0dXJuIGRvbS5tYXAoZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgICB2YXIgX3JlZjQgPSBfc2xpY2VkVG9BcnJheShfcmVmMywgMiksXG4gICAgICAgICAgdmFsdWVzID0gX3JlZjRbMV07XG5cbiAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgfSk7XG4gIH1cbn07XG52YXIgX2RlZmF1bHQgPSBkb21NYXA7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvbU1hcF8xKTtcblxudmFyIGNvbW1hbmRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgY29tbWFuZFJvbGUgPSB7XG4gIGFic3RyYWN0OiB0cnVlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWVudWl0ZW0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBjb21tYW5kUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoY29tbWFuZFJvbGVfMSk7XG5cbnZhciBjb21wb3NpdGVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgY29tcG9zaXRlUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IHRydWUsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCc6IG51bGwsXG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0J11dXG59O1xudmFyIF9kZWZhdWx0ID0gY29tcG9zaXRlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoY29tcG9zaXRlUm9sZV8xKTtcblxudmFyIGlucHV0Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGlucHV0Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IHRydWUsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdYRm9ybXMnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCddXVxufTtcbnZhciBfZGVmYXVsdCA9IGlucHV0Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoaW5wdXRSb2xlXzEpO1xuXG52YXIgbGFuZG1hcmtSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgbGFuZG1hcmtSb2xlID0ge1xuICBhYnN0cmFjdDogdHJ1ZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gbGFuZG1hcmtSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhsYW5kbWFya1JvbGVfMSk7XG5cbnZhciByYW5nZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciByYW5nZVJvbGUgPSB7XG4gIGFic3RyYWN0OiB0cnVlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLXZhbHVlbWF4JzogbnVsbCxcbiAgICAnYXJpYS12YWx1ZW1pbic6IG51bGwsXG4gICAgJ2FyaWEtdmFsdWVub3cnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gcmFuZ2VSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhyYW5nZVJvbGVfMSk7XG5cbnZhciByb2xldHlwZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciByb2xldHlwZVJvbGUgPSB7XG4gIGFic3RyYWN0OiB0cnVlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1hdG9taWMnOiBudWxsLFxuICAgICdhcmlhLWJ1c3knOiBudWxsLFxuICAgICdhcmlhLWNvbnRyb2xzJzogbnVsbCxcbiAgICAnYXJpYS1jdXJyZW50JzogbnVsbCxcbiAgICAnYXJpYS1kZXNjcmliZWRieSc6IG51bGwsXG4gICAgJ2FyaWEtZGV0YWlscyc6IG51bGwsXG4gICAgJ2FyaWEtZHJvcGVmZmVjdCc6IG51bGwsXG4gICAgJ2FyaWEtZmxvd3RvJzogbnVsbCxcbiAgICAnYXJpYS1ncmFiYmVkJzogbnVsbCxcbiAgICAnYXJpYS1oaWRkZW4nOiBudWxsLFxuICAgICdhcmlhLWtleXNob3J0Y3V0cyc6IG51bGwsXG4gICAgJ2FyaWEtbGFiZWwnOiBudWxsLFxuICAgICdhcmlhLWxhYmVsbGVkYnknOiBudWxsLFxuICAgICdhcmlhLWxpdmUnOiBudWxsLFxuICAgICdhcmlhLW93bnMnOiBudWxsLFxuICAgICdhcmlhLXJlbGV2YW50JzogbnVsbCxcbiAgICAnYXJpYS1yb2xlZGVzY3JpcHRpb24nOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAncmVsJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdyb2xlJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnWEhUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndHlwZSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0R1YmxpbiBDb3JlJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbXVxufTtcbnZhciBfZGVmYXVsdCA9IHJvbGV0eXBlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMocm9sZXR5cGVSb2xlXzEpO1xuXG52YXIgc2VjdGlvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBzZWN0aW9uUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IHRydWUsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFtdLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZnJvbnRtYXR0ZXInXG4gICAgfSxcbiAgICBtb2R1bGU6ICdEVEInXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbGV2ZWwnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdEVEInXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbGV2ZWwnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdTTUlMJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBzZWN0aW9uUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoc2VjdGlvblJvbGVfMSk7XG5cbnZhciBzZWN0aW9uaGVhZFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBzZWN0aW9uaGVhZFJvbGUgPSB7XG4gIGFic3RyYWN0OiB0cnVlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvcicsICdjb250ZW50cyddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gc2VjdGlvbmhlYWRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhzZWN0aW9uaGVhZFJvbGVfMSk7XG5cbnZhciBzZWxlY3RSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgc2VsZWN0Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IHRydWUsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtb3JpZW50YXRpb24nOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2NvbXBvc2l0ZSddLCBbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2dyb3VwJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gc2VsZWN0Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoc2VsZWN0Um9sZV8xKTtcblxudmFyIHN0cnVjdHVyZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBzdHJ1Y3R1cmVSb2xlID0ge1xuICBhYnN0cmFjdDogdHJ1ZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogW10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZSddXVxufTtcbnZhciBfZGVmYXVsdCA9IHN0cnVjdHVyZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHN0cnVjdHVyZVJvbGVfMSk7XG5cbnZhciB3aWRnZXRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgd2lkZ2V0Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IHRydWUsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFtdLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnXV1cbn07XG52YXIgX2RlZmF1bHQgPSB3aWRnZXRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyh3aWRnZXRSb2xlXzEpO1xuXG52YXIgd2luZG93Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHdpbmRvd1JvbGUgPSB7XG4gIGFic3RyYWN0OiB0cnVlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLW1vZGFsJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gd2luZG93Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMod2luZG93Um9sZV8xKTtcblxudmFyIGFyaWFBYnN0cmFjdFJvbGVzXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY29tbWFuZFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGNvbW1hbmRSb2xlXzEpO1xuXG52YXIgX2NvbXBvc2l0ZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGNvbXBvc2l0ZVJvbGVfMSk7XG5cbnZhciBfaW5wdXRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChpbnB1dFJvbGVfMSk7XG5cbnZhciBfbGFuZG1hcmtSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChsYW5kbWFya1JvbGVfMSk7XG5cbnZhciBfcmFuZ2VSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyYW5nZVJvbGVfMSk7XG5cbnZhciBfcm9sZXR5cGVSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyb2xldHlwZVJvbGVfMSk7XG5cbnZhciBfc2VjdGlvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHNlY3Rpb25Sb2xlXzEpO1xuXG52YXIgX3NlY3Rpb25oZWFkUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoc2VjdGlvbmhlYWRSb2xlXzEpO1xuXG52YXIgX3NlbGVjdFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHNlbGVjdFJvbGVfMSk7XG5cbnZhciBfc3RydWN0dXJlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoc3RydWN0dXJlUm9sZV8xKTtcblxudmFyIF93aWRnZXRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdCh3aWRnZXRSb2xlXzEpO1xuXG52YXIgX3dpbmRvd1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHdpbmRvd1JvbGVfMSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBhcmlhQWJzdHJhY3RSb2xlcyA9IFtbJ2NvbW1hbmQnLCBfY29tbWFuZFJvbGUuZGVmYXVsdF0sIFsnY29tcG9zaXRlJywgX2NvbXBvc2l0ZVJvbGUuZGVmYXVsdF0sIFsnaW5wdXQnLCBfaW5wdXRSb2xlLmRlZmF1bHRdLCBbJ2xhbmRtYXJrJywgX2xhbmRtYXJrUm9sZS5kZWZhdWx0XSwgWydyYW5nZScsIF9yYW5nZVJvbGUuZGVmYXVsdF0sIFsncm9sZXR5cGUnLCBfcm9sZXR5cGVSb2xlLmRlZmF1bHRdLCBbJ3NlY3Rpb24nLCBfc2VjdGlvblJvbGUuZGVmYXVsdF0sIFsnc2VjdGlvbmhlYWQnLCBfc2VjdGlvbmhlYWRSb2xlLmRlZmF1bHRdLCBbJ3NlbGVjdCcsIF9zZWxlY3RSb2xlLmRlZmF1bHRdLCBbJ3N0cnVjdHVyZScsIF9zdHJ1Y3R1cmVSb2xlLmRlZmF1bHRdLCBbJ3dpZGdldCcsIF93aWRnZXRSb2xlLmRlZmF1bHRdLCBbJ3dpbmRvdycsIF93aW5kb3dSb2xlLmRlZmF1bHRdXTtcbnZhciBfZGVmYXVsdCA9IGFyaWFBYnN0cmFjdFJvbGVzO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhhcmlhQWJzdHJhY3RSb2xlc18xKTtcblxudmFyIGFsZXJ0Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGFsZXJ0Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWF0b21pYyc6ICd0cnVlJyxcbiAgICAnYXJpYS1saXZlJzogJ2Fzc2VydGl2ZSdcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdhbGVydCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ1hGb3JtcydcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBhbGVydFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGFsZXJ0Um9sZV8xKTtcblxudmFyIGFsZXJ0ZGlhbG9nUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGFsZXJ0ZGlhbG9nUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdhbGVydCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ1hGb3JtcydcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnYWxlcnQnXSwgWydyb2xldHlwZScsICd3aW5kb3cnLCAnZGlhbG9nJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gYWxlcnRkaWFsb2dSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhhbGVydGRpYWxvZ1JvbGVfMSk7XG5cbnZhciBhcHBsaWNhdGlvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBhcHBsaWNhdGlvblJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnOiBudWxsLFxuICAgICdhcmlhLWRpc2FibGVkJzogbnVsbCxcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdEZXZpY2UgSW5kZXBlbmRlbmNlIERlbGl2ZXJ5IFVuaXQnXG4gICAgfVxuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBhcHBsaWNhdGlvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGFwcGxpY2F0aW9uUm9sZV8xKTtcblxudmFyIGFydGljbGVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgYXJ0aWNsZVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1wb3NpbnNldCc6IG51bGwsXG4gICAgJ2FyaWEtc2V0c2l6ZSc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdhcnRpY2xlJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ2RvY3VtZW50J11dXG59O1xudmFyIF9kZWZhdWx0ID0gYXJ0aWNsZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGFydGljbGVSb2xlXzEpO1xuXG52YXIgYmFubmVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGJhbm5lclJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgY29uc3RyYWludHM6IFsnZGlyZWN0IGRlc2NlbmRhbnQgb2YgZG9jdW1lbnQnXSxcbiAgICAgIG5hbWU6ICdoZWFkZXInXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGJhbm5lclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGJhbm5lclJvbGVfMSk7XG5cbnZhciBibG9ja3F1b3RlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGJsb2NrcXVvdGVSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGJsb2NrcXVvdGVSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhibG9ja3F1b3RlUm9sZV8xKTtcblxudmFyIGJ1dHRvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBidXR0b25Sb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IHRydWUsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvcicsICdjb250ZW50cyddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWRpc2FibGVkJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLXByZXNzZWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBjb25zdHJhaW50czogWydzZXQnXSxcbiAgICAgICAgbmFtZTogJ2FyaWEtcHJlc3NlZCdcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICB2YWx1ZTogJ2NoZWNrYm94J1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgbmFtZTogJ2FyaWEtZXhwYW5kZWQnLFxuICAgICAgICB2YWx1ZTogJ2ZhbHNlJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnc3VtbWFyeSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAnYXJpYS1leHBhbmRlZCcsXG4gICAgICAgIHZhbHVlOiAndHJ1ZSdcbiAgICAgIH1dLFxuICAgICAgY29uc3RyYWludHM6IFsnZGlyZWN0IGRlc2NlbmRhbnQgb2YgZGV0YWlscyBlbGVtZW50IHdpdGggdGhlIG9wZW4gYXR0cmlidXRlIGRlZmluZWQnXSxcbiAgICAgIG5hbWU6ICdzdW1tYXJ5J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICdidXR0b24nXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAnaW1hZ2UnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAncmVzZXQnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAnc3VibWl0J1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2J1dHRvbidcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndHJpZ2dlcidcbiAgICB9LFxuICAgIG1vZHVsZTogJ1hGb3JtcydcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2NvbW1hbmQnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBidXR0b25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhidXR0b25Sb2xlXzEpO1xuXG52YXIgY2FwdGlvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBjYXB0aW9uUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ3Byb2hpYml0ZWQnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbJ2FyaWEtbGFiZWwnLCAnYXJpYS1sYWJlbGxlZGJ5J10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbJ2ZpZ3VyZScsICdncmlkJywgJ3RhYmxlJ10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFsnZmlndXJlJywgJ2dyaWQnLCAndGFibGUnXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gY2FwdGlvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGNhcHRpb25Sb2xlXzEpO1xuXG52YXIgY2VsbFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBjZWxsUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvcicsICdjb250ZW50cyddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWNvbGluZGV4JzogbnVsbCxcbiAgICAnYXJpYS1jb2xzcGFuJzogbnVsbCxcbiAgICAnYXJpYS1yb3dpbmRleCc6IG51bGwsXG4gICAgJ2FyaWEtcm93c3Bhbic6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGNvbnN0cmFpbnRzOiBbJ2Rlc2NlbmRhbnQgb2YgdGFibGUnXSxcbiAgICAgIG5hbWU6ICd0ZCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFsncm93J10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFsncm93J10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGNlbGxSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhjZWxsUm9sZV8xKTtcblxudmFyIGNoZWNrYm94Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGNoZWNrYm94Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiB0cnVlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudHMnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1jaGVja2VkJzogbnVsbCxcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbCxcbiAgICAnYXJpYS1yZWFkb25seSc6IG51bGwsXG4gICAgJ2FyaWEtcmVxdWlyZWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAnY2hlY2tib3gnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnb3B0aW9uJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnQVJJQSdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7XG4gICAgJ2FyaWEtY2hlY2tlZCc6IG51bGxcbiAgfSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2lucHV0J11dXG59O1xudmFyIF9kZWZhdWx0ID0gY2hlY2tib3hSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhjaGVja2JveFJvbGVfMSk7XG5cbnZhciBjb2RlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGNvZGVSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsncHJvaGliaXRlZCddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFsnYXJpYS1sYWJlbCcsICdhcmlhLWxhYmVsbGVkYnknXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gY29kZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGNvZGVSb2xlXzEpO1xuXG52YXIgY29sdW1uaGVhZGVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGNvbHVtbmhlYWRlclJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvcicsICdjb250ZW50cyddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLXNvcnQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgbmFtZTogJ3Njb3BlJyxcbiAgICAgIHZhbHVlOiAnY29sJ1xuICAgIH1dLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0aCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFsncm93J10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFsncm93J10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdjZWxsJ10sIFsncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnY2VsbCcsICdncmlkY2VsbCddLCBbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdncmlkY2VsbCddLCBbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uaGVhZCddXVxufTtcbnZhciBfZGVmYXVsdCA9IGNvbHVtbmhlYWRlclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGNvbHVtbmhlYWRlclJvbGVfMSk7XG5cbnZhciBjb21ib2JveFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBjb21ib2JveFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnOiBudWxsLFxuICAgICdhcmlhLWF1dG9jb21wbGV0ZSc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbCxcbiAgICAnYXJpYS1yZWFkb25seSc6IG51bGwsXG4gICAgJ2FyaWEtcmVxdWlyZWQnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogJ2ZhbHNlJyxcbiAgICAnYXJpYS1oYXNwb3B1cCc6ICdsaXN0Ym94J1xuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgY29uc3RyYWludHM6IFsnc2V0J10sXG4gICAgICAgIG5hbWU6ICdsaXN0J1xuICAgICAgfSwge1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAnZW1haWwnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBjb25zdHJhaW50czogWydzZXQnXSxcbiAgICAgICAgbmFtZTogJ2xpc3QnXG4gICAgICB9LCB7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICdzZWFyY2gnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBjb25zdHJhaW50czogWydzZXQnXSxcbiAgICAgICAgbmFtZTogJ2xpc3QnXG4gICAgICB9LCB7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICd0ZWwnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBjb25zdHJhaW50czogWydzZXQnXSxcbiAgICAgICAgbmFtZTogJ2xpc3QnXG4gICAgICB9LCB7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICd0ZXh0J1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgY29uc3RyYWludHM6IFsnc2V0J10sXG4gICAgICAgIG5hbWU6ICdsaXN0J1xuICAgICAgfSwge1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAndXJsJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgY29uc3RyYWludHM6IFsnc2V0J10sXG4gICAgICAgIG5hbWU6ICdsaXN0J1xuICAgICAgfSwge1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAndXJsJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgY29uc3RyYWludHM6IFsndW5kZWZpbmVkJ10sXG4gICAgICAgIG5hbWU6ICdtdWx0aXBsZSdcbiAgICAgIH0sIHtcbiAgICAgICAgY29uc3RyYWludHM6IFsndW5kZWZpbmVkJ10sXG4gICAgICAgIG5hbWU6ICdzaXplJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnc2VsZWN0J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIGNvbnN0cmFpbnRzOiBbJ3VuZGVmaW5lZCddLFxuICAgICAgICBuYW1lOiAnbXVsdGlwbGUnXG4gICAgICB9LCB7XG4gICAgICAgIG5hbWU6ICdzaXplJyxcbiAgICAgICAgdmFsdWU6IDFcbiAgICAgIH1dLFxuICAgICAgbmFtZTogJ3NlbGVjdCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnc2VsZWN0J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnWEZvcm1zJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHtcbiAgICAnYXJpYS1jb250cm9scyc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiAnZmFsc2UnXG4gIH0sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdpbnB1dCddXVxufTtcbnZhciBfZGVmYXVsdCA9IGNvbWJvYm94Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoY29tYm9ib3hSb2xlXzEpO1xuXG52YXIgY29tcGxlbWVudGFyeVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBjb21wbGVtZW50YXJ5Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnYXNpZGUnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGNvbXBsZW1lbnRhcnlSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhjb21wbGVtZW50YXJ5Um9sZV8xKTtcblxudmFyIGNvbnRlbnRpbmZvUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGNvbnRlbnRpbmZvUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBjb25zdHJhaW50czogWydkaXJlY3QgZGVzY2VuZGFudCBvZiBkb2N1bWVudCddLFxuICAgICAgbmFtZTogJ2Zvb3RlcidcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2xhbmRtYXJrJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gY29udGVudGluZm9Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhjb250ZW50aW5mb1JvbGVfMSk7XG5cbnZhciBkZWZpbml0aW9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRlZmluaXRpb25Sb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdkZCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZGVmaW5pdGlvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRlZmluaXRpb25Sb2xlXzEpO1xuXG52YXIgZGVsZXRpb25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZGVsZXRpb25Sb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsncHJvaGliaXRlZCddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFsnYXJpYS1sYWJlbCcsICdhcmlhLWxhYmVsbGVkYnknXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZGVsZXRpb25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkZWxldGlvblJvbGVfMSk7XG5cbnZhciBkaWFsb2dSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZGlhbG9nUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdkaWFsb2cnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aW5kb3cnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkaWFsb2dSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkaWFsb2dSb2xlXzEpO1xuXG52YXIgZGlyZWN0b3J5Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRpcmVjdG9yeVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnREFJU1kgR3VpZGUnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2xpc3QnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkaXJlY3RvcnlSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkaXJlY3RvcnlSb2xlXzEpO1xuXG52YXIgZG9jdW1lbnRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jdW1lbnRSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdEZXZpY2UgSW5kZXBlbmRlbmNlIERlbGl2ZXJ5IFVuaXQnXG4gICAgfVxuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2JvZHknXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2N1bWVudFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY3VtZW50Um9sZV8xKTtcblxudmFyIGVtcGhhc2lzUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGVtcGhhc2lzUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ3Byb2hpYml0ZWQnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbJ2FyaWEtbGFiZWwnLCAnYXJpYS1sYWJlbGxlZGJ5J10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGVtcGhhc2lzUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZW1waGFzaXNSb2xlXzEpO1xuXG52YXIgZmVlZFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBmZWVkUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtbJ2FydGljbGUnXV0sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsaXN0J11dXG59O1xudmFyIF9kZWZhdWx0ID0gZmVlZFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGZlZWRSb2xlXzEpO1xuXG52YXIgZmlndXJlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGZpZ3VyZVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2ZpZ3VyZSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZmlndXJlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZmlndXJlUm9sZV8xKTtcblxudmFyIGZvcm1Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZm9ybVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgY29uc3RyYWludHM6IFsnc2V0J10sXG4gICAgICAgIG5hbWU6ICdhcmlhLWxhYmVsJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnZm9ybSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBjb25zdHJhaW50czogWydzZXQnXSxcbiAgICAgICAgbmFtZTogJ2FyaWEtbGFiZWxsZWRieSdcbiAgICAgIH1dLFxuICAgICAgbmFtZTogJ2Zvcm0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgY29uc3RyYWludHM6IFsnc2V0J10sXG4gICAgICAgIG5hbWU6ICduYW1lJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnZm9ybSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2xhbmRtYXJrJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZm9ybVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGZvcm1Sb2xlXzEpO1xuXG52YXIgZ2VuZXJpY1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBnZW5lcmljUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ3Byb2hpYml0ZWQnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbJ2FyaWEtbGFiZWwnLCAnYXJpYS1sYWJlbGxlZGJ5J10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdzcGFuJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdkaXYnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBnZW5lcmljUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZ2VuZXJpY1JvbGVfMSk7XG5cbnZhciBncmlkUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGdyaWRSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1tdWx0aXNlbGVjdGFibGUnOiBudWxsLFxuICAgICdhcmlhLXJlYWRvbmx5JzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgbmFtZTogJ3JvbGUnLFxuICAgICAgICB2YWx1ZTogJ2dyaWQnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICd0YWJsZSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbWydyb3cnXSwgWydyb3cnLCAncm93Z3JvdXAnXV0sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnLCAnY29tcG9zaXRlJ10sIFsncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAndGFibGUnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBncmlkUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZ3JpZFJvbGVfMSk7XG5cbnZhciBncmlkY2VsbFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBncmlkY2VsbFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudHMnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsLFxuICAgICdhcmlhLXJlYWRvbmx5JzogbnVsbCxcbiAgICAnYXJpYS1yZXF1aXJlZCc6IG51bGwsXG4gICAgJ2FyaWEtc2VsZWN0ZWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAncm9sZScsXG4gICAgICAgIHZhbHVlOiAnZ3JpZGNlbGwnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICd0ZCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFsncm93J10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFsncm93J10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdjZWxsJ10sIFsncm9sZXR5cGUnLCAnd2lkZ2V0J11dXG59O1xudmFyIF9kZWZhdWx0ID0gZ3JpZGNlbGxSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhncmlkY2VsbFJvbGVfMSk7XG5cbnZhciBncm91cFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBncm91cFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1hY3RpdmVkZXNjZW5kYW50JzogbnVsbCxcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdkZXRhaWxzJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdmaWVsZHNldCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnb3B0Z3JvdXAnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGdyb3VwUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZ3JvdXBSb2xlXzEpO1xuXG52YXIgaGVhZGluZ1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBoZWFkaW5nUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJywgJ2NvbnRlbnRzJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtbGV2ZWwnOiAnMidcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdoMSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaDInXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2gzJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdoNCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaDUnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2g2J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7XG4gICAgJ2FyaWEtbGV2ZWwnOiAnMidcbiAgfSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb25oZWFkJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gaGVhZGluZ1JvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGhlYWRpbmdSb2xlXzEpO1xuXG52YXIgaW1nUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGltZ1JvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogdHJ1ZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIGNvbnN0cmFpbnRzOiBbJ3NldCddLFxuICAgICAgICBuYW1lOiAnYWx0J1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW1nJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIGNvbnN0cmFpbnRzOiBbJ3VuZGVmaW5lZCddLFxuICAgICAgICBuYW1lOiAnYWx0J1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW1nJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpbWdncm91cCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0RUQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBpbWdSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhpbWdSb2xlXzEpO1xuXG52YXIgaW5zZXJ0aW9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGluc2VydGlvblJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydwcm9oaWJpdGVkJ10sXG4gIHByb2hpYml0ZWRQcm9wczogWydhcmlhLWxhYmVsJywgJ2FyaWEtbGFiZWxsZWRieSddLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBpbnNlcnRpb25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhpbnNlcnRpb25Sb2xlXzEpO1xuXG52YXIgbGlua1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBsaW5rUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJywgJ2NvbnRlbnRzJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICdocmVmJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnYSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAnaHJlZidcbiAgICAgIH1dLFxuICAgICAgbmFtZTogJ2FyZWEnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgbmFtZTogJ2hyZWYnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdsaW5rJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2NvbW1hbmQnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBsaW5rUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMobGlua1JvbGVfMSk7XG5cbnZhciBsaXN0Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGxpc3RSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdtZW51J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdvbCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndWwnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW1snbGlzdGl0ZW0nXV0sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGxpc3RSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhsaXN0Um9sZV8xKTtcblxudmFyIGxpc3Rib3hSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgbGlzdGJveFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsLFxuICAgICdhcmlhLW11bHRpc2VsZWN0YWJsZSc6IG51bGwsXG4gICAgJ2FyaWEtcmVhZG9ubHknOiBudWxsLFxuICAgICdhcmlhLXJlcXVpcmVkJzogbnVsbCxcbiAgICAnYXJpYS1vcmllbnRhdGlvbic6ICd2ZXJ0aWNhbCdcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIGNvbnN0cmFpbnRzOiBbJz4xJ10sXG4gICAgICAgIG5hbWU6ICdzaXplJ1xuICAgICAgfSwge1xuICAgICAgICBuYW1lOiAnbXVsdGlwbGUnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdzZWxlY3QnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgY29uc3RyYWludHM6IFsnPjEnXSxcbiAgICAgICAgbmFtZTogJ3NpemUnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdzZWxlY3QnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgbmFtZTogJ211bHRpcGxlJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnc2VsZWN0J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdkYXRhbGlzdCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbGlzdCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0FSSUEnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnc2VsZWN0J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnWEZvcm1zJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW1snb3B0aW9uJywgJ2dyb3VwJ10sIFsnb3B0aW9uJ11dLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2NvbXBvc2l0ZScsICdzZWxlY3QnXSwgWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdncm91cCcsICdzZWxlY3QnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBsaXN0Ym94Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMobGlzdGJveFJvbGVfMSk7XG5cbnZhciBsaXN0aXRlbVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBsaXN0aXRlbVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1sZXZlbCc6IG51bGwsXG4gICAgJ2FyaWEtcG9zaW5zZXQnOiBudWxsLFxuICAgICdhcmlhLXNldHNpemUnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBjb25zdHJhaW50czogWydkaXJlY3QgZGVzY2VuZGFudCBvZiBvbCwgdWwgb3IgbWVudSddLFxuICAgICAgbmFtZTogJ2xpJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpdGVtJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnWEZvcm1zJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbJ2RpcmVjdG9yeScsICdsaXN0J10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFsnZGlyZWN0b3J5JywgJ2xpc3QnXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gbGlzdGl0ZW1Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhsaXN0aXRlbVJvbGVfMSk7XG5cbnZhciBsb2dSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgbG9nUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWxpdmUnOiAncG9saXRlJ1xuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gbG9nUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMobG9nUm9sZV8xKTtcblxudmFyIG1haW5Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgbWFpblJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ21haW4nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IG1haW5Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhtYWluUm9sZV8xKTtcblxudmFyIG1hcnF1ZWVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgbWFycXVlZVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBtYXJxdWVlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMobWFycXVlZVJvbGVfMSk7XG5cbnZhciBtYXRoUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIG1hdGhSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdtYXRoJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBtYXRoUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMobWF0aFJvbGVfMSk7XG5cbnZhciBtZW51Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIG1lbnVSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtb3JpZW50YXRpb24nOiAndmVydGljYWwnXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnTUVOVSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0pBUEknXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbGlzdCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0FSSUEnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnc2VsZWN0J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnWEZvcm1zJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3NpZGViYXInXG4gICAgfSxcbiAgICBtb2R1bGU6ICdEVEInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbWydtZW51aXRlbScsICdncm91cCddLCBbJ21lbnVpdGVtcmFkaW8nLCAnZ3JvdXAnXSwgWydtZW51aXRlbWNoZWNrYm94JywgJ2dyb3VwJ10sIFsnbWVudWl0ZW0nXSwgWydtZW51aXRlbWNoZWNrYm94J10sIFsnbWVudWl0ZW1yYWRpbyddXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdjb21wb3NpdGUnLCAnc2VsZWN0J10sIFsncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnZ3JvdXAnLCAnc2VsZWN0J11dXG59O1xudmFyIF9kZWZhdWx0ID0gbWVudVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKG1lbnVSb2xlXzEpO1xuXG52YXIgbWVudWJhclJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBtZW51YmFyUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLW9yaWVudGF0aW9uJzogJ2hvcml6b250YWwnXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndG9vbGJhcidcbiAgICB9LFxuICAgIG1vZHVsZTogJ0FSSUEnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbWydtZW51aXRlbScsICdncm91cCddLCBbJ21lbnVpdGVtcmFkaW8nLCAnZ3JvdXAnXSwgWydtZW51aXRlbWNoZWNrYm94JywgJ2dyb3VwJ10sIFsnbWVudWl0ZW0nXSwgWydtZW51aXRlbWNoZWNrYm94J10sIFsnbWVudWl0ZW1yYWRpbyddXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdjb21wb3NpdGUnLCAnc2VsZWN0JywgJ21lbnUnXSwgWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdncm91cCcsICdzZWxlY3QnLCAnbWVudSddXVxufTtcbnZhciBfZGVmYXVsdCA9IG1lbnViYXJSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhtZW51YmFyUm9sZV8xKTtcblxudmFyIG1lbnVpdGVtUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIG1lbnVpdGVtUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJywgJ2NvbnRlbnRzJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtcG9zaW5zZXQnOiBudWxsLFxuICAgICdhcmlhLXNldHNpemUnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnTUVOVV9JVEVNJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSkFQSSdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdsaXN0aXRlbSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0FSSUEnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWVudWl0ZW0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ29wdGlvbidcbiAgICB9LFxuICAgIG1vZHVsZTogJ0FSSUEnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFsnZ3JvdXAnLCAnbWVudScsICdtZW51YmFyJ10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFsnZ3JvdXAnLCAnbWVudScsICdtZW51YmFyJ10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnLCAnY29tbWFuZCddXVxufTtcbnZhciBfZGVmYXVsdCA9IG1lbnVpdGVtUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMobWVudWl0ZW1Sb2xlXzEpO1xuXG52YXIgbWVudWl0ZW1jaGVja2JveFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBtZW51aXRlbWNoZWNrYm94Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiB0cnVlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudHMnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ21lbnVpdGVtJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnQVJJQSdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogWydncm91cCcsICdtZW51JywgJ21lbnViYXInXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogWydncm91cCcsICdtZW51JywgJ21lbnViYXInXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge1xuICAgICdhcmlhLWNoZWNrZWQnOiBudWxsXG4gIH0sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdpbnB1dCcsICdjaGVja2JveCddLCBbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdjb21tYW5kJywgJ21lbnVpdGVtJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gbWVudWl0ZW1jaGVja2JveFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKG1lbnVpdGVtY2hlY2tib3hSb2xlXzEpO1xuXG52YXIgbWVudWl0ZW1yYWRpb1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBtZW51aXRlbXJhZGlvUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiB0cnVlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudHMnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ21lbnVpdGVtJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnQVJJQSdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogWydncm91cCcsICdtZW51JywgJ21lbnViYXInXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogWydncm91cCcsICdtZW51JywgJ21lbnViYXInXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge1xuICAgICdhcmlhLWNoZWNrZWQnOiBudWxsXG4gIH0sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdpbnB1dCcsICdjaGVja2JveCcsICdtZW51aXRlbWNoZWNrYm94J10sIFsncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2NvbW1hbmQnLCAnbWVudWl0ZW0nLCAnbWVudWl0ZW1jaGVja2JveCddLCBbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdpbnB1dCcsICdyYWRpbyddXVxufTtcbnZhciBfZGVmYXVsdCA9IG1lbnVpdGVtcmFkaW9Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhtZW51aXRlbXJhZGlvUm9sZV8xKTtcblxudmFyIG1ldGVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIG1ldGVyUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiB0cnVlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS12YWx1ZXRleHQnOiBudWxsLFxuICAgICdhcmlhLXZhbHVlbWF4JzogJzEwMCcsXG4gICAgJ2FyaWEtdmFsdWVtaW4nOiAnMCdcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHtcbiAgICAnYXJpYS12YWx1ZW5vdyc6IG51bGxcbiAgfSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3JhbmdlJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gbWV0ZXJSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhtZXRlclJvbGVfMSk7XG5cbnZhciBuYXZpZ2F0aW9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIG5hdmlnYXRpb25Sb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICduYXYnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IG5hdmlnYXRpb25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhuYXZpZ2F0aW9uUm9sZV8xKTtcblxudmFyIG5vbmVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgbm9uZVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogW10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbXVxufTtcbnZhciBfZGVmYXVsdCA9IG5vbmVSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhub25lUm9sZV8xKTtcblxudmFyIG5vdGVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgbm90ZVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gbm90ZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKG5vdGVSb2xlXzEpO1xuXG52YXIgb3B0aW9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIG9wdGlvblJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogdHJ1ZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJywgJ2NvbnRlbnRzJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtY2hlY2tlZCc6IG51bGwsXG4gICAgJ2FyaWEtcG9zaW5zZXQnOiBudWxsLFxuICAgICdhcmlhLXNldHNpemUnOiBudWxsLFxuICAgICdhcmlhLXNlbGVjdGVkJzogJ2ZhbHNlJ1xuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2l0ZW0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdYRm9ybXMnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbGlzdGl0ZW0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdBUklBJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ29wdGlvbidcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge1xuICAgICdhcmlhLXNlbGVjdGVkJzogJ2ZhbHNlJ1xuICB9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnLCAnaW5wdXQnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBvcHRpb25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhvcHRpb25Sb2xlXzEpO1xuXG52YXIgcGFyYWdyYXBoUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHBhcmFncmFwaFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydwcm9oaWJpdGVkJ10sXG4gIHByb2hpYml0ZWRQcm9wczogWydhcmlhLWxhYmVsJywgJ2FyaWEtbGFiZWxsZWRieSddLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBwYXJhZ3JhcGhSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhwYXJhZ3JhcGhSb2xlXzEpO1xuXG52YXIgcHJlc2VudGF0aW9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHByZXNlbnRhdGlvblJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydwcm9oaWJpdGVkJ10sXG4gIHByb2hpYml0ZWRQcm9wczogWydhcmlhLWxhYmVsJywgJ2FyaWEtbGFiZWxsZWRieSddLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gcHJlc2VudGF0aW9uUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMocHJlc2VudGF0aW9uUm9sZV8xKTtcblxudmFyIHByb2dyZXNzYmFyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHByb2dyZXNzYmFyUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiB0cnVlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS12YWx1ZXRleHQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAncHJvZ3Jlc3MnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3N0YXR1cydcbiAgICB9LFxuICAgIG1vZHVsZTogJ0FSSUEnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdyYW5nZSddLCBbJ3JvbGV0eXBlJywgJ3dpZGdldCddXVxufTtcbnZhciBfZGVmYXVsdCA9IHByb2dyZXNzYmFyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMocHJvZ3Jlc3NiYXJSb2xlXzEpO1xuXG52YXIgcmFkaW9Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgcmFkaW9Sb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IHRydWUsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvcicsICdjb250ZW50cyddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWNoZWNrZWQnOiBudWxsLFxuICAgICdhcmlhLXBvc2luc2V0JzogbnVsbCxcbiAgICAnYXJpYS1zZXRzaXplJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICB2YWx1ZTogJ3JhZGlvJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHtcbiAgICAnYXJpYS1jaGVja2VkJzogbnVsbFxuICB9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnLCAnaW5wdXQnXV1cbn07XG52YXIgX2RlZmF1bHQgPSByYWRpb1JvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHJhZGlvUm9sZV8xKTtcblxudmFyIHJhZGlvZ3JvdXBSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgcmFkaW9ncm91cFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGwsXG4gICAgJ2FyaWEtcmVhZG9ubHknOiBudWxsLFxuICAgICdhcmlhLXJlcXVpcmVkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2xpc3QnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdBUklBJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW1sncmFkaW8nXV0sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnLCAnY29tcG9zaXRlJywgJ3NlbGVjdCddLCBbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2dyb3VwJywgJ3NlbGVjdCddXVxufTtcbnZhciBfZGVmYXVsdCA9IHJhZGlvZ3JvdXBSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhyYWRpb2dyb3VwUm9sZV8xKTtcblxudmFyIHJlZ2lvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciByZWdpb25Sb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgY29uc3RyYWludHM6IFsnc2V0J10sXG4gICAgICAgIG5hbWU6ICdhcmlhLWxhYmVsJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnc2VjdGlvbidcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBjb25zdHJhaW50czogWydzZXQnXSxcbiAgICAgICAgbmFtZTogJ2FyaWEtbGFiZWxsZWRieSdcbiAgICAgIH1dLFxuICAgICAgbmFtZTogJ3NlY3Rpb24nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ0RldmljZSBJbmRlcGVuZGVuY2UgR2xvc3NhcnQgcGVyY2VpdmFibGUgdW5pdCdcbiAgICB9XG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZnJhbWUnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IHJlZ2lvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHJlZ2lvblJvbGVfMSk7XG5cbnZhciByb3dSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgcm93Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvcicsICdjb250ZW50cyddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWNvbGluZGV4JzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtbGV2ZWwnOiBudWxsLFxuICAgICdhcmlhLXBvc2luc2V0JzogbnVsbCxcbiAgICAnYXJpYS1yb3dpbmRleCc6IG51bGwsXG4gICAgJ2FyaWEtc2VsZWN0ZWQnOiBudWxsLFxuICAgICdhcmlhLXNldHNpemUnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndHInXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbJ2dyaWQnLCAncm93Z3JvdXAnLCAndGFibGUnLCAndHJlZWdyaWQnXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogWydncmlkJywgJ3Jvd2dyb3VwJywgJ3RhYmxlJywgJ3RyZWVncmlkJ10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW1snY2VsbCddLCBbJ2NvbHVtbmhlYWRlciddLCBbJ2dyaWRjZWxsJ10sIFsncm93aGVhZGVyJ11dLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnZ3JvdXAnXSwgWydyb2xldHlwZScsICd3aWRnZXQnXV1cbn07XG52YXIgX2RlZmF1bHQgPSByb3dSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhyb3dSb2xlXzEpO1xuXG52YXIgcm93Z3JvdXBSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgcm93Z3JvdXBSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJywgJ2NvbnRlbnRzJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0Ym9keSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndGZvb3QnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9LCB7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3RoZWFkJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogWydncmlkJywgJ3RhYmxlJywgJ3RyZWVncmlkJ10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFsnZ3JpZCcsICd0YWJsZScsICd0cmVlZ3JpZCddLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtbJ3JvdyddXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZSddXVxufTtcbnZhciBfZGVmYXVsdCA9IHJvd2dyb3VwUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMocm93Z3JvdXBSb2xlXzEpO1xuXG52YXIgcm93aGVhZGVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHJvd2hlYWRlclJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvcicsICdjb250ZW50cyddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLXNvcnQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAnc2NvcGUnLFxuICAgICAgICB2YWx1ZTogJ3JvdydcbiAgICAgIH1dLFxuICAgICAgbmFtZTogJ3RoJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogWydyb3cnXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogWydyb3cnXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2NlbGwnXSwgWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdjZWxsJywgJ2dyaWRjZWxsJ10sIFsncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2dyaWRjZWxsJ10sIFsncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb25oZWFkJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gcm93aGVhZGVyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMocm93aGVhZGVyUm9sZV8xKTtcblxudmFyIHNjcm9sbGJhclJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBzY3JvbGxiYXJSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiB0cnVlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtdmFsdWV0ZXh0JzogbnVsbCxcbiAgICAnYXJpYS1vcmllbnRhdGlvbic6ICd2ZXJ0aWNhbCcsXG4gICAgJ2FyaWEtdmFsdWVtYXgnOiAnMTAwJyxcbiAgICAnYXJpYS12YWx1ZW1pbic6ICcwJ1xuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge1xuICAgICdhcmlhLWNvbnRyb2xzJzogbnVsbCxcbiAgICAnYXJpYS12YWx1ZW5vdyc6IG51bGxcbiAgfSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3JhbmdlJ10sIFsncm9sZXR5cGUnLCAnd2lkZ2V0J11dXG59O1xudmFyIF9kZWZhdWx0ID0gc2Nyb2xsYmFyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoc2Nyb2xsYmFyUm9sZV8xKTtcblxudmFyIHNlYXJjaFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBzZWFyY2hSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IHNlYXJjaFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHNlYXJjaFJvbGVfMSk7XG5cbnZhciBzZWFyY2hib3hSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgc2VhcmNoYm94Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIGNvbnN0cmFpbnRzOiBbJ3VuZGVmaW5lZCddLFxuICAgICAgICBuYW1lOiAnbGlzdCdcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICB2YWx1ZTogJ3NlYXJjaCdcbiAgICAgIH1dLFxuICAgICAgbmFtZTogJ2lucHV0J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2lucHV0JywgJ3RleHRib3gnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBzZWFyY2hib3hSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhzZWFyY2hib3hSb2xlXzEpO1xuXG52YXIgc2VwYXJhdG9yUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHNlcGFyYXRvclJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IHRydWUsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWRpc2FibGVkJzogbnVsbCxcbiAgICAnYXJpYS1vcmllbnRhdGlvbic6ICdob3Jpem9udGFsJyxcbiAgICAnYXJpYS12YWx1ZW1heCc6ICcxMDAnLFxuICAgICdhcmlhLXZhbHVlbWluJzogJzAnLFxuICAgICdhcmlhLXZhbHVlbm93JzogbnVsbCxcbiAgICAnYXJpYS12YWx1ZXRleHQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaHInXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBzZXBhcmF0b3JSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhzZXBhcmF0b3JSb2xlXzEpO1xuXG52YXIgc2xpZGVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHNsaWRlclJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogdHJ1ZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGwsXG4gICAgJ2FyaWEtcmVhZG9ubHknOiBudWxsLFxuICAgICdhcmlhLXZhbHVldGV4dCc6IG51bGwsXG4gICAgJ2FyaWEtb3JpZW50YXRpb24nOiAnaG9yaXpvbnRhbCcsXG4gICAgJ2FyaWEtdmFsdWVtYXgnOiAnMTAwJyxcbiAgICAnYXJpYS12YWx1ZW1pbic6ICcwJ1xuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICB2YWx1ZTogJ3JhbmdlJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHtcbiAgICAnYXJpYS12YWx1ZW5vdyc6IG51bGxcbiAgfSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2lucHV0J10sIFsncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3JhbmdlJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gc2xpZGVyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoc2xpZGVyUm9sZV8xKTtcblxudmFyIHNwaW5idXR0b25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgc3BpbmJ1dHRvblJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGwsXG4gICAgJ2FyaWEtcmVhZG9ubHknOiBudWxsLFxuICAgICdhcmlhLXJlcXVpcmVkJzogbnVsbCxcbiAgICAnYXJpYS12YWx1ZXRleHQnOiBudWxsLFxuICAgICdhcmlhLXZhbHVlbm93JzogJzAnXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAnbnVtYmVyJ1xuICAgICAgfV0sXG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnLCAnY29tcG9zaXRlJ10sIFsncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2lucHV0J10sIFsncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3JhbmdlJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gc3BpbmJ1dHRvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHNwaW5idXR0b25Sb2xlXzEpO1xuXG52YXIgc3RhdHVzUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHN0YXR1c1JvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1hdG9taWMnOiAndHJ1ZScsXG4gICAgJ2FyaWEtbGl2ZSc6ICdwb2xpdGUnXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnb3V0cHV0J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBzdGF0dXNSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhzdGF0dXNSb2xlXzEpO1xuXG52YXIgc3Ryb25nUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHN0cm9uZ1JvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydwcm9oaWJpdGVkJ10sXG4gIHByb2hpYml0ZWRQcm9wczogWydhcmlhLWxhYmVsJywgJ2FyaWEtbGFiZWxsZWRieSddLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBzdHJvbmdSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhzdHJvbmdSb2xlXzEpO1xuXG52YXIgc3Vic2NyaXB0Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHN1YnNjcmlwdFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydwcm9oaWJpdGVkJ10sXG4gIHByb2hpYml0ZWRQcm9wczogWydhcmlhLWxhYmVsJywgJ2FyaWEtbGFiZWxsZWRieSddLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBzdWJzY3JpcHRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhzdWJzY3JpcHRSb2xlXzEpO1xuXG52YXIgc3VwZXJzY3JpcHRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgc3VwZXJzY3JpcHRSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsncHJvaGliaXRlZCddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFsnYXJpYS1sYWJlbCcsICdhcmlhLWxhYmVsbGVkYnknXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gc3VwZXJzY3JpcHRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhzdXBlcnNjcmlwdFJvbGVfMSk7XG5cbnZhciBzd2l0Y2hSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgc3dpdGNoUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiB0cnVlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudHMnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2J1dHRvbidcbiAgICB9LFxuICAgIG1vZHVsZTogJ0FSSUEnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge1xuICAgICdhcmlhLWNoZWNrZWQnOiBudWxsXG4gIH0sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdpbnB1dCcsICdjaGVja2JveCddXVxufTtcbnZhciBfZGVmYXVsdCA9IHN3aXRjaFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHN3aXRjaFJvbGVfMSk7XG5cbnZhciB0YWJSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgdGFiUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogdHJ1ZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJywgJ2NvbnRlbnRzJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtcG9zaW5zZXQnOiBudWxsLFxuICAgICdhcmlhLXNldHNpemUnOiBudWxsLFxuICAgICdhcmlhLXNlbGVjdGVkJzogJ2ZhbHNlJ1xuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFsndGFibGlzdCddLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbJ3RhYmxpc3QnXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uaGVhZCddLCBbJ3JvbGV0eXBlJywgJ3dpZGdldCddXVxufTtcbnZhciBfZGVmYXVsdCA9IHRhYlJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHRhYlJvbGVfMSk7XG5cbnZhciB0YWJsZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciB0YWJsZVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWNvbGNvdW50JzogbnVsbCxcbiAgICAnYXJpYS1yb3djb3VudCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0YWJsZSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbWydyb3cnXSwgWydyb3cnLCAncm93Z3JvdXAnXV0sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IHRhYmxlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHModGFibGVSb2xlXzEpO1xuXG52YXIgdGFibGlzdFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciB0YWJsaXN0Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWxldmVsJzogbnVsbCxcbiAgICAnYXJpYS1tdWx0aXNlbGVjdGFibGUnOiBudWxsLFxuICAgICdhcmlhLW9yaWVudGF0aW9uJzogJ2hvcml6b250YWwnXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdEQUlTWScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2d1aWRlJ1xuICAgIH1cbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtbJ3RhYiddXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdjb21wb3NpdGUnXV1cbn07XG52YXIgX2RlZmF1bHQgPSB0YWJsaXN0Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHModGFibGlzdFJvbGVfMSk7XG5cbnZhciB0YWJwYW5lbFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciB0YWJwYW5lbFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSB0YWJwYW5lbFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHRhYnBhbmVsUm9sZV8xKTtcblxudmFyIHRlcm1Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgdGVybVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RmbidcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZHQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IHRlcm1Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyh0ZXJtUm9sZV8xKTtcblxudmFyIHRleHRib3hSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgdGV4dGJveFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnOiBudWxsLFxuICAgICdhcmlhLWF1dG9jb21wbGV0ZSc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGwsXG4gICAgJ2FyaWEtbXVsdGlsaW5lJzogbnVsbCxcbiAgICAnYXJpYS1wbGFjZWhvbGRlcic6IG51bGwsXG4gICAgJ2FyaWEtcmVhZG9ubHknOiBudWxsLFxuICAgICdhcmlhLXJlcXVpcmVkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgY29uc3RyYWludHM6IFsndW5kZWZpbmVkJ10sXG4gICAgICAgIG5hbWU6ICd0eXBlJ1xuICAgICAgfSwge1xuICAgICAgICBjb25zdHJhaW50czogWyd1bmRlZmluZWQnXSxcbiAgICAgICAgbmFtZTogJ2xpc3QnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBjb25zdHJhaW50czogWyd1bmRlZmluZWQnXSxcbiAgICAgICAgbmFtZTogJ2xpc3QnXG4gICAgICB9LCB7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICdlbWFpbCdcbiAgICAgIH1dLFxuICAgICAgbmFtZTogJ2lucHV0J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIGNvbnN0cmFpbnRzOiBbJ3VuZGVmaW5lZCddLFxuICAgICAgICBuYW1lOiAnbGlzdCdcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICB2YWx1ZTogJ3RlbCdcbiAgICAgIH1dLFxuICAgICAgbmFtZTogJ2lucHV0J1xuICAgIH0sXG4gICAgbW9kdWxlOiAnSFRNTCdcbiAgfSwge1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIGNvbnN0cmFpbnRzOiBbJ3VuZGVmaW5lZCddLFxuICAgICAgICBuYW1lOiAnbGlzdCdcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICB2YWx1ZTogJ3RleHQnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBjb25zdHJhaW50czogWyd1bmRlZmluZWQnXSxcbiAgICAgICAgbmFtZTogJ2xpc3QnXG4gICAgICB9LCB7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICd1cmwnXG4gICAgICB9XSxcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0hUTUwnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdYRm9ybXMnXG4gIH0sIHtcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndGV4dGFyZWEnXG4gICAgfSxcbiAgICBtb2R1bGU6ICdIVE1MJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnLCAnaW5wdXQnXV1cbn07XG52YXIgX2RlZmF1bHQgPSB0ZXh0Ym94Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHModGV4dGJveFJvbGVfMSk7XG5cbnZhciB0aW1lUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHRpbWVSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IHRpbWVSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyh0aW1lUm9sZV8xKTtcblxudmFyIHRpbWVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHRpbWVyUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge30sXG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnc3RhdHVzJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gdGltZXJSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyh0aW1lclJvbGVfMSk7XG5cbnZhciB0b29sYmFyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHRvb2xiYXJSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtb3JpZW50YXRpb24nOiAnaG9yaXpvbnRhbCdcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdtZW51YmFyJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnQVJJQSdcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnZ3JvdXAnXV1cbn07XG52YXIgX2RlZmF1bHQgPSB0b29sYmFyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHModG9vbGJhclJvbGVfMSk7XG5cbnZhciB0b29sdGlwUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIHRvb2x0aXBSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudHMnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gdG9vbHRpcFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHRvb2x0aXBSb2xlXzEpO1xuXG52YXIgdHJlZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciB0cmVlUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbCxcbiAgICAnYXJpYS1tdWx0aXNlbGVjdGFibGUnOiBudWxsLFxuICAgICdhcmlhLXJlcXVpcmVkJzogbnVsbCxcbiAgICAnYXJpYS1vcmllbnRhdGlvbic6ICd2ZXJ0aWNhbCdcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW1sndHJlZWl0ZW0nLCAnZ3JvdXAnXSwgWyd0cmVlaXRlbSddXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdjb21wb3NpdGUnLCAnc2VsZWN0J10sIFsncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnZ3JvdXAnLCAnc2VsZWN0J11dXG59O1xudmFyIF9kZWZhdWx0ID0gdHJlZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHRyZWVSb2xlXzEpO1xuXG52YXIgdHJlZWdyaWRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgdHJlZWdyaWRSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHt9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbWydyb3cnXSwgWydyb3cnLCAncm93Z3JvdXAnXV0sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnLCAnY29tcG9zaXRlJywgJ2dyaWQnXSwgWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICd0YWJsZScsICdncmlkJ10sIFsncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2NvbXBvc2l0ZScsICdzZWxlY3QnLCAndHJlZSddLCBbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2dyb3VwJywgJ3NlbGVjdCcsICd0cmVlJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gdHJlZWdyaWRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyh0cmVlZ3JpZFJvbGVfMSk7XG5cbnZhciB0cmVlaXRlbVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciB0cmVlaXRlbVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogdHJ1ZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvcicsICdjb250ZW50cyddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbJ2dyb3VwJywgJ3RyZWUnXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogWydncm91cCcsICd0cmVlJ10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHtcbiAgICAnYXJpYS1zZWxlY3RlZCc6IG51bGxcbiAgfSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbGlzdGl0ZW0nXSwgWydyb2xldHlwZScsICd3aWRnZXQnLCAnaW5wdXQnLCAnb3B0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gdHJlZWl0ZW1Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyh0cmVlaXRlbVJvbGVfMSk7XG5cbnZhciBhcmlhTGl0ZXJhbFJvbGVzXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfYWxlcnRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChhbGVydFJvbGVfMSk7XG5cbnZhciBfYWxlcnRkaWFsb2dSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChhbGVydGRpYWxvZ1JvbGVfMSk7XG5cbnZhciBfYXBwbGljYXRpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChhcHBsaWNhdGlvblJvbGVfMSk7XG5cbnZhciBfYXJ0aWNsZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGFydGljbGVSb2xlXzEpO1xuXG52YXIgX2Jhbm5lclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGJhbm5lclJvbGVfMSk7XG5cbnZhciBfYmxvY2txdW90ZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGJsb2NrcXVvdGVSb2xlXzEpO1xuXG52YXIgX2J1dHRvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGJ1dHRvblJvbGVfMSk7XG5cbnZhciBfY2FwdGlvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGNhcHRpb25Sb2xlXzEpO1xuXG52YXIgX2NlbGxSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChjZWxsUm9sZV8xKTtcblxudmFyIF9jaGVja2JveFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGNoZWNrYm94Um9sZV8xKTtcblxudmFyIF9jb2RlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoY29kZVJvbGVfMSk7XG5cbnZhciBfY29sdW1uaGVhZGVyUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoY29sdW1uaGVhZGVyUm9sZV8xKTtcblxudmFyIF9jb21ib2JveFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGNvbWJvYm94Um9sZV8xKTtcblxudmFyIF9jb21wbGVtZW50YXJ5Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoY29tcGxlbWVudGFyeVJvbGVfMSk7XG5cbnZhciBfY29udGVudGluZm9Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChjb250ZW50aW5mb1JvbGVfMSk7XG5cbnZhciBfZGVmaW5pdGlvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRlZmluaXRpb25Sb2xlXzEpO1xuXG52YXIgX2RlbGV0aW9uUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZGVsZXRpb25Sb2xlXzEpO1xuXG52YXIgX2RpYWxvZ1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRpYWxvZ1JvbGVfMSk7XG5cbnZhciBfZGlyZWN0b3J5Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZGlyZWN0b3J5Um9sZV8xKTtcblxudmFyIF9kb2N1bWVudFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY3VtZW50Um9sZV8xKTtcblxudmFyIF9lbXBoYXNpc1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGVtcGhhc2lzUm9sZV8xKTtcblxudmFyIF9mZWVkUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZmVlZFJvbGVfMSk7XG5cbnZhciBfZmlndXJlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZmlndXJlUm9sZV8xKTtcblxudmFyIF9mb3JtUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZm9ybVJvbGVfMSk7XG5cbnZhciBfZ2VuZXJpY1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGdlbmVyaWNSb2xlXzEpO1xuXG52YXIgX2dyaWRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChncmlkUm9sZV8xKTtcblxudmFyIF9ncmlkY2VsbFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGdyaWRjZWxsUm9sZV8xKTtcblxudmFyIF9ncm91cFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGdyb3VwUm9sZV8xKTtcblxudmFyIF9oZWFkaW5nUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoaGVhZGluZ1JvbGVfMSk7XG5cbnZhciBfaW1nUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoaW1nUm9sZV8xKTtcblxudmFyIF9pbnNlcnRpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChpbnNlcnRpb25Sb2xlXzEpO1xuXG52YXIgX2xpbmtSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChsaW5rUm9sZV8xKTtcblxudmFyIF9saXN0Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQobGlzdFJvbGVfMSk7XG5cbnZhciBfbGlzdGJveFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGxpc3Rib3hSb2xlXzEpO1xuXG52YXIgX2xpc3RpdGVtUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQobGlzdGl0ZW1Sb2xlXzEpO1xuXG52YXIgX2xvZ1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGxvZ1JvbGVfMSk7XG5cbnZhciBfbWFpblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG1haW5Sb2xlXzEpO1xuXG52YXIgX21hcnF1ZWVSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChtYXJxdWVlUm9sZV8xKTtcblxudmFyIF9tYXRoUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQobWF0aFJvbGVfMSk7XG5cbnZhciBfbWVudVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG1lbnVSb2xlXzEpO1xuXG52YXIgX21lbnViYXJSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChtZW51YmFyUm9sZV8xKTtcblxudmFyIF9tZW51aXRlbVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG1lbnVpdGVtUm9sZV8xKTtcblxudmFyIF9tZW51aXRlbWNoZWNrYm94Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQobWVudWl0ZW1jaGVja2JveFJvbGVfMSk7XG5cbnZhciBfbWVudWl0ZW1yYWRpb1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG1lbnVpdGVtcmFkaW9Sb2xlXzEpO1xuXG52YXIgX21ldGVyUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQobWV0ZXJSb2xlXzEpO1xuXG52YXIgX25hdmlnYXRpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChuYXZpZ2F0aW9uUm9sZV8xKTtcblxudmFyIF9ub25lUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQobm9uZVJvbGVfMSk7XG5cbnZhciBfbm90ZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG5vdGVSb2xlXzEpO1xuXG52YXIgX29wdGlvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9wdGlvblJvbGVfMSk7XG5cbnZhciBfcGFyYWdyYXBoUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocGFyYWdyYXBoUm9sZV8xKTtcblxudmFyIF9wcmVzZW50YXRpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChwcmVzZW50YXRpb25Sb2xlXzEpO1xuXG52YXIgX3Byb2dyZXNzYmFyUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocHJvZ3Jlc3NiYXJSb2xlXzEpO1xuXG52YXIgX3JhZGlvUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmFkaW9Sb2xlXzEpO1xuXG52YXIgX3JhZGlvZ3JvdXBSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyYWRpb2dyb3VwUm9sZV8xKTtcblxudmFyIF9yZWdpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZWdpb25Sb2xlXzEpO1xuXG52YXIgX3Jvd1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJvd1JvbGVfMSk7XG5cbnZhciBfcm93Z3JvdXBSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyb3dncm91cFJvbGVfMSk7XG5cbnZhciBfcm93aGVhZGVyUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocm93aGVhZGVyUm9sZV8xKTtcblxudmFyIF9zY3JvbGxiYXJSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChzY3JvbGxiYXJSb2xlXzEpO1xuXG52YXIgX3NlYXJjaFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHNlYXJjaFJvbGVfMSk7XG5cbnZhciBfc2VhcmNoYm94Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoc2VhcmNoYm94Um9sZV8xKTtcblxudmFyIF9zZXBhcmF0b3JSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChzZXBhcmF0b3JSb2xlXzEpO1xuXG52YXIgX3NsaWRlclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHNsaWRlclJvbGVfMSk7XG5cbnZhciBfc3BpbmJ1dHRvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHNwaW5idXR0b25Sb2xlXzEpO1xuXG52YXIgX3N0YXR1c1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHN0YXR1c1JvbGVfMSk7XG5cbnZhciBfc3Ryb25nUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoc3Ryb25nUm9sZV8xKTtcblxudmFyIF9zdWJzY3JpcHRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChzdWJzY3JpcHRSb2xlXzEpO1xuXG52YXIgX3N1cGVyc2NyaXB0Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoc3VwZXJzY3JpcHRSb2xlXzEpO1xuXG52YXIgX3N3aXRjaFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHN3aXRjaFJvbGVfMSk7XG5cbnZhciBfdGFiUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQodGFiUm9sZV8xKTtcblxudmFyIF90YWJsZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHRhYmxlUm9sZV8xKTtcblxudmFyIF90YWJsaXN0Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQodGFibGlzdFJvbGVfMSk7XG5cbnZhciBfdGFicGFuZWxSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdCh0YWJwYW5lbFJvbGVfMSk7XG5cbnZhciBfdGVybVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHRlcm1Sb2xlXzEpO1xuXG52YXIgX3RleHRib3hSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdCh0ZXh0Ym94Um9sZV8xKTtcblxudmFyIF90aW1lUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQodGltZVJvbGVfMSk7XG5cbnZhciBfdGltZXJSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdCh0aW1lclJvbGVfMSk7XG5cbnZhciBfdG9vbGJhclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHRvb2xiYXJSb2xlXzEpO1xuXG52YXIgX3Rvb2x0aXBSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdCh0b29sdGlwUm9sZV8xKTtcblxudmFyIF90cmVlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQodHJlZVJvbGVfMSk7XG5cbnZhciBfdHJlZWdyaWRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdCh0cmVlZ3JpZFJvbGVfMSk7XG5cbnZhciBfdHJlZWl0ZW1Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdCh0cmVlaXRlbVJvbGVfMSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBhcmlhTGl0ZXJhbFJvbGVzID0gW1snYWxlcnQnLCBfYWxlcnRSb2xlLmRlZmF1bHRdLCBbJ2FsZXJ0ZGlhbG9nJywgX2FsZXJ0ZGlhbG9nUm9sZS5kZWZhdWx0XSwgWydhcHBsaWNhdGlvbicsIF9hcHBsaWNhdGlvblJvbGUuZGVmYXVsdF0sIFsnYXJ0aWNsZScsIF9hcnRpY2xlUm9sZS5kZWZhdWx0XSwgWydiYW5uZXInLCBfYmFubmVyUm9sZS5kZWZhdWx0XSwgWydibG9ja3F1b3RlJywgX2Jsb2NrcXVvdGVSb2xlLmRlZmF1bHRdLCBbJ2J1dHRvbicsIF9idXR0b25Sb2xlLmRlZmF1bHRdLCBbJ2NhcHRpb24nLCBfY2FwdGlvblJvbGUuZGVmYXVsdF0sIFsnY2VsbCcsIF9jZWxsUm9sZS5kZWZhdWx0XSwgWydjaGVja2JveCcsIF9jaGVja2JveFJvbGUuZGVmYXVsdF0sIFsnY29kZScsIF9jb2RlUm9sZS5kZWZhdWx0XSwgWydjb2x1bW5oZWFkZXInLCBfY29sdW1uaGVhZGVyUm9sZS5kZWZhdWx0XSwgWydjb21ib2JveCcsIF9jb21ib2JveFJvbGUuZGVmYXVsdF0sIFsnY29tcGxlbWVudGFyeScsIF9jb21wbGVtZW50YXJ5Um9sZS5kZWZhdWx0XSwgWydjb250ZW50aW5mbycsIF9jb250ZW50aW5mb1JvbGUuZGVmYXVsdF0sIFsnZGVmaW5pdGlvbicsIF9kZWZpbml0aW9uUm9sZS5kZWZhdWx0XSwgWydkZWxldGlvbicsIF9kZWxldGlvblJvbGUuZGVmYXVsdF0sIFsnZGlhbG9nJywgX2RpYWxvZ1JvbGUuZGVmYXVsdF0sIFsnZGlyZWN0b3J5JywgX2RpcmVjdG9yeVJvbGUuZGVmYXVsdF0sIFsnZG9jdW1lbnQnLCBfZG9jdW1lbnRSb2xlLmRlZmF1bHRdLCBbJ2VtcGhhc2lzJywgX2VtcGhhc2lzUm9sZS5kZWZhdWx0XSwgWydmZWVkJywgX2ZlZWRSb2xlLmRlZmF1bHRdLCBbJ2ZpZ3VyZScsIF9maWd1cmVSb2xlLmRlZmF1bHRdLCBbJ2Zvcm0nLCBfZm9ybVJvbGUuZGVmYXVsdF0sIFsnZ2VuZXJpYycsIF9nZW5lcmljUm9sZS5kZWZhdWx0XSwgWydncmlkJywgX2dyaWRSb2xlLmRlZmF1bHRdLCBbJ2dyaWRjZWxsJywgX2dyaWRjZWxsUm9sZS5kZWZhdWx0XSwgWydncm91cCcsIF9ncm91cFJvbGUuZGVmYXVsdF0sIFsnaGVhZGluZycsIF9oZWFkaW5nUm9sZS5kZWZhdWx0XSwgWydpbWcnLCBfaW1nUm9sZS5kZWZhdWx0XSwgWydpbnNlcnRpb24nLCBfaW5zZXJ0aW9uUm9sZS5kZWZhdWx0XSwgWydsaW5rJywgX2xpbmtSb2xlLmRlZmF1bHRdLCBbJ2xpc3QnLCBfbGlzdFJvbGUuZGVmYXVsdF0sIFsnbGlzdGJveCcsIF9saXN0Ym94Um9sZS5kZWZhdWx0XSwgWydsaXN0aXRlbScsIF9saXN0aXRlbVJvbGUuZGVmYXVsdF0sIFsnbG9nJywgX2xvZ1JvbGUuZGVmYXVsdF0sIFsnbWFpbicsIF9tYWluUm9sZS5kZWZhdWx0XSwgWydtYXJxdWVlJywgX21hcnF1ZWVSb2xlLmRlZmF1bHRdLCBbJ21hdGgnLCBfbWF0aFJvbGUuZGVmYXVsdF0sIFsnbWVudScsIF9tZW51Um9sZS5kZWZhdWx0XSwgWydtZW51YmFyJywgX21lbnViYXJSb2xlLmRlZmF1bHRdLCBbJ21lbnVpdGVtJywgX21lbnVpdGVtUm9sZS5kZWZhdWx0XSwgWydtZW51aXRlbWNoZWNrYm94JywgX21lbnVpdGVtY2hlY2tib3hSb2xlLmRlZmF1bHRdLCBbJ21lbnVpdGVtcmFkaW8nLCBfbWVudWl0ZW1yYWRpb1JvbGUuZGVmYXVsdF0sIFsnbWV0ZXInLCBfbWV0ZXJSb2xlLmRlZmF1bHRdLCBbJ25hdmlnYXRpb24nLCBfbmF2aWdhdGlvblJvbGUuZGVmYXVsdF0sIFsnbm9uZScsIF9ub25lUm9sZS5kZWZhdWx0XSwgWydub3RlJywgX25vdGVSb2xlLmRlZmF1bHRdLCBbJ29wdGlvbicsIF9vcHRpb25Sb2xlLmRlZmF1bHRdLCBbJ3BhcmFncmFwaCcsIF9wYXJhZ3JhcGhSb2xlLmRlZmF1bHRdLCBbJ3ByZXNlbnRhdGlvbicsIF9wcmVzZW50YXRpb25Sb2xlLmRlZmF1bHRdLCBbJ3Byb2dyZXNzYmFyJywgX3Byb2dyZXNzYmFyUm9sZS5kZWZhdWx0XSwgWydyYWRpbycsIF9yYWRpb1JvbGUuZGVmYXVsdF0sIFsncmFkaW9ncm91cCcsIF9yYWRpb2dyb3VwUm9sZS5kZWZhdWx0XSwgWydyZWdpb24nLCBfcmVnaW9uUm9sZS5kZWZhdWx0XSwgWydyb3cnLCBfcm93Um9sZS5kZWZhdWx0XSwgWydyb3dncm91cCcsIF9yb3dncm91cFJvbGUuZGVmYXVsdF0sIFsncm93aGVhZGVyJywgX3Jvd2hlYWRlclJvbGUuZGVmYXVsdF0sIFsnc2Nyb2xsYmFyJywgX3Njcm9sbGJhclJvbGUuZGVmYXVsdF0sIFsnc2VhcmNoJywgX3NlYXJjaFJvbGUuZGVmYXVsdF0sIFsnc2VhcmNoYm94JywgX3NlYXJjaGJveFJvbGUuZGVmYXVsdF0sIFsnc2VwYXJhdG9yJywgX3NlcGFyYXRvclJvbGUuZGVmYXVsdF0sIFsnc2xpZGVyJywgX3NsaWRlclJvbGUuZGVmYXVsdF0sIFsnc3BpbmJ1dHRvbicsIF9zcGluYnV0dG9uUm9sZS5kZWZhdWx0XSwgWydzdGF0dXMnLCBfc3RhdHVzUm9sZS5kZWZhdWx0XSwgWydzdHJvbmcnLCBfc3Ryb25nUm9sZS5kZWZhdWx0XSwgWydzdWJzY3JpcHQnLCBfc3Vic2NyaXB0Um9sZS5kZWZhdWx0XSwgWydzdXBlcnNjcmlwdCcsIF9zdXBlcnNjcmlwdFJvbGUuZGVmYXVsdF0sIFsnc3dpdGNoJywgX3N3aXRjaFJvbGUuZGVmYXVsdF0sIFsndGFiJywgX3RhYlJvbGUuZGVmYXVsdF0sIFsndGFibGUnLCBfdGFibGVSb2xlLmRlZmF1bHRdLCBbJ3RhYmxpc3QnLCBfdGFibGlzdFJvbGUuZGVmYXVsdF0sIFsndGFicGFuZWwnLCBfdGFicGFuZWxSb2xlLmRlZmF1bHRdLCBbJ3Rlcm0nLCBfdGVybVJvbGUuZGVmYXVsdF0sIFsndGV4dGJveCcsIF90ZXh0Ym94Um9sZS5kZWZhdWx0XSwgWyd0aW1lJywgX3RpbWVSb2xlLmRlZmF1bHRdLCBbJ3RpbWVyJywgX3RpbWVyUm9sZS5kZWZhdWx0XSwgWyd0b29sYmFyJywgX3Rvb2xiYXJSb2xlLmRlZmF1bHRdLCBbJ3Rvb2x0aXAnLCBfdG9vbHRpcFJvbGUuZGVmYXVsdF0sIFsndHJlZScsIF90cmVlUm9sZS5kZWZhdWx0XSwgWyd0cmVlZ3JpZCcsIF90cmVlZ3JpZFJvbGUuZGVmYXVsdF0sIFsndHJlZWl0ZW0nLCBfdHJlZWl0ZW1Sb2xlLmRlZmF1bHRdXTtcbnZhciBfZGVmYXVsdCA9IGFyaWFMaXRlcmFsUm9sZXM7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGFyaWFMaXRlcmFsUm9sZXNfMSk7XG5cbnZhciBkb2NBYnN0cmFjdFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NBYnN0cmFjdFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnYWJzdHJhY3QgW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZG9jQWJzdHJhY3RSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NBYnN0cmFjdFJvbGVfMSk7XG5cbnZhciBkb2NBY2tub3dsZWRnbWVudHNSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jQWNrbm93bGVkZ21lbnRzUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWRpc2FibGVkJzogbnVsbCxcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdhY2tub3dsZWRnbWVudHMgW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2xhbmRtYXJrJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZG9jQWNrbm93bGVkZ21lbnRzUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jQWNrbm93bGVkZ21lbnRzUm9sZV8xKTtcblxudmFyIGRvY0FmdGVyd29yZFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NBZnRlcndvcmRSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2FmdGVyd29yZCBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbGFuZG1hcmsnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NBZnRlcndvcmRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NBZnRlcndvcmRSb2xlXzEpO1xuXG52YXIgZG9jQXBwZW5kaXhSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jQXBwZW5kaXhSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2FwcGVuZGl4IFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0FwcGVuZGl4Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jQXBwZW5kaXhSb2xlXzEpO1xuXG52YXIgZG9jQmFja2xpbmtSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jQmFja2xpbmtSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudCddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdyZWZlcnJlciBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2NvbW1hbmQnLCAnbGluayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0JhY2tsaW5rUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jQmFja2xpbmtSb2xlXzEpO1xuXG52YXIgZG9jQmlibGlvZW50cnlSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jQmlibGlvZW50cnlSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnRVBVQiBiaWJsaW9lbnRyeSBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogWydkb2MtYmlibGlvZ3JhcGh5J10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFsnZG9jLWJpYmxpb2dyYXBoeSddLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbGlzdGl0ZW0nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NCaWJsaW9lbnRyeVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY0JpYmxpb2VudHJ5Um9sZV8xKTtcblxudmFyIGRvY0JpYmxpb2dyYXBoeVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NCaWJsaW9ncmFwaHlSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2JpYmxpb2dyYXBoeSBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtbJ2RvYy1iaWJsaW9lbnRyeSddXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2xhbmRtYXJrJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZG9jQmlibGlvZ3JhcGh5Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jQmlibGlvZ3JhcGh5Um9sZV8xKTtcblxudmFyIGRvY0JpYmxpb3JlZlJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NCaWJsaW9yZWZSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudHMnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnYmlibGlvcmVmIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICd3aWRnZXQnLCAnY29tbWFuZCcsICdsaW5rJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZG9jQmlibGlvcmVmUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jQmlibGlvcmVmUm9sZV8xKTtcblxudmFyIGRvY0NoYXB0ZXJSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jQ2hhcHRlclJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnY2hhcHRlciBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbGFuZG1hcmsnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NDaGFwdGVyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jQ2hhcHRlclJvbGVfMSk7XG5cbnZhciBkb2NDb2xvcGhvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NDb2xvcGhvblJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnY29sb3Bob24gW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZG9jQ29sb3Bob25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NDb2xvcGhvblJvbGVfMSk7XG5cbnZhciBkb2NDb25jbHVzaW9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY0NvbmNsdXNpb25Sb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2NvbmNsdXNpb24gW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2xhbmRtYXJrJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZG9jQ29uY2x1c2lvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY0NvbmNsdXNpb25Sb2xlXzEpO1xuXG52YXIgZG9jQ292ZXJSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jQ292ZXJSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2NvdmVyIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdpbWcnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NDb3ZlclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY0NvdmVyUm9sZV8xKTtcblxudmFyIGRvY0NyZWRpdFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NDcmVkaXRSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2NyZWRpdCBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NDcmVkaXRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NDcmVkaXRSb2xlXzEpO1xuXG52YXIgZG9jQ3JlZGl0c1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NDcmVkaXRzUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWRpc2FibGVkJzogbnVsbCxcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdjcmVkaXRzIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0NyZWRpdHNSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NDcmVkaXRzUm9sZV8xKTtcblxudmFyIGRvY0RlZGljYXRpb25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jRGVkaWNhdGlvblJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZGVkaWNhdGlvbiBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NEZWRpY2F0aW9uUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jRGVkaWNhdGlvblJvbGVfMSk7XG5cbnZhciBkb2NFbmRub3RlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY0VuZG5vdGVSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3JlYXJub3RlIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbJ2RvYy1lbmRub3RlcyddLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbJ2RvYy1lbmRub3RlcyddLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbGlzdGl0ZW0nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NFbmRub3RlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jRW5kbm90ZVJvbGVfMSk7XG5cbnZhciBkb2NFbmRub3Rlc1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NFbmRub3Rlc1JvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAncmVhcm5vdGVzIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW1snZG9jLWVuZG5vdGUnXV0sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0VuZG5vdGVzUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jRW5kbm90ZXNSb2xlXzEpO1xuXG52YXIgZG9jRXBpZ3JhcGhSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jRXBpZ3JhcGhSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2VwaWdyYXBoIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0VwaWdyYXBoUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jRXBpZ3JhcGhSb2xlXzEpO1xuXG52YXIgZG9jRXBpbG9ndWVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jRXBpbG9ndWVSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2VwaWxvZ3VlIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0VwaWxvZ3VlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jRXBpbG9ndWVSb2xlXzEpO1xuXG52YXIgZG9jRXJyYXRhUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY0VycmF0YVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZXJyYXRhIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0VycmF0YVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY0VycmF0YVJvbGVfMSk7XG5cbnZhciBkb2NFeGFtcGxlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY0V4YW1wbGVSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZG9jRXhhbXBsZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY0V4YW1wbGVSb2xlXzEpO1xuXG52YXIgZG9jRm9vdG5vdGVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jRm9vdG5vdGVSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2Zvb3Rub3RlIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0Zvb3Rub3RlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jRm9vdG5vdGVSb2xlXzEpO1xuXG52YXIgZG9jRm9yZXdvcmRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jRm9yZXdvcmRSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2ZvcmV3b3JkIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0ZvcmV3b3JkUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jRm9yZXdvcmRSb2xlXzEpO1xuXG52YXIgZG9jR2xvc3NhcnlSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jR2xvc3NhcnlSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2dsb3NzYXJ5IFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW1snZGVmaW5pdGlvbiddLCBbJ3Rlcm0nXV0sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0dsb3NzYXJ5Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jR2xvc3NhcnlSb2xlXzEpO1xuXG52YXIgZG9jR2xvc3NyZWZSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jR2xvc3NyZWZSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudHMnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZ2xvc3NyZWYgW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3dpZGdldCcsICdjb21tYW5kJywgJ2xpbmsnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NHbG9zc3JlZlJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY0dsb3NzcmVmUm9sZV8xKTtcblxudmFyIGRvY0luZGV4Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY0luZGV4Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWRpc2FibGVkJzogbnVsbCxcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpbmRleCBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbGFuZG1hcmsnLCAnbmF2aWdhdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0luZGV4Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jSW5kZXhSb2xlXzEpO1xuXG52YXIgZG9jSW50cm9kdWN0aW9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY0ludHJvZHVjdGlvblJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaW50cm9kdWN0aW9uIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY0ludHJvZHVjdGlvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY0ludHJvZHVjdGlvblJvbGVfMSk7XG5cbnZhciBkb2NOb3RlcmVmUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY05vdGVyZWZSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IHRydWUsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InLCAnY29udGVudHMnXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbm90ZXJlZiBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnd2lkZ2V0JywgJ2NvbW1hbmQnLCAnbGluayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY05vdGVyZWZSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NOb3RlcmVmUm9sZV8xKTtcblxudmFyIGRvY05vdGljZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NOb3RpY2VSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ25vdGljZSBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbm90ZSddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY05vdGljZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY05vdGljZVJvbGVfMSk7XG5cbnZhciBkb2NQYWdlYnJlYWtSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jUGFnZWJyZWFrUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiB0cnVlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdwYWdlYnJlYWsgW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZXBhcmF0b3InXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NQYWdlYnJlYWtSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NQYWdlYnJlYWtSb2xlXzEpO1xuXG52YXIgZG9jUGFnZWxpc3RSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jUGFnZWxpc3RSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3BhZ2UtbGlzdCBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbGFuZG1hcmsnLCAnbmF2aWdhdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY1BhZ2VsaXN0Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jUGFnZWxpc3RSb2xlXzEpO1xuXG52YXIgZG9jUGFydFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NQYXJ0Um9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiB0cnVlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7XG4gICAgJ2FyaWEtZGlzYWJsZWQnOiBudWxsLFxuICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IG51bGwsXG4gICAgJ2FyaWEtZXhwYW5kZWQnOiBudWxsLFxuICAgICdhcmlhLWhhc3BvcHVwJzogbnVsbCxcbiAgICAnYXJpYS1pbnZhbGlkJzogbnVsbFxuICB9LFxuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3BhcnQgW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2xhbmRtYXJrJ11dXG59O1xudmFyIF9kZWZhdWx0ID0gZG9jUGFydFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY1BhcnRSb2xlXzEpO1xuXG52YXIgZG9jUHJlZmFjZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NQcmVmYWNlUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWRpc2FibGVkJzogbnVsbCxcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdwcmVmYWNlIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbicsICdsYW5kbWFyayddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY1ByZWZhY2VSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NQcmVmYWNlUm9sZV8xKTtcblxudmFyIGRvY1Byb2xvZ3VlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY1Byb2xvZ3VlUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWRpc2FibGVkJzogbnVsbCxcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdwcm9sb2d1ZSBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbGFuZG1hcmsnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NQcm9sb2d1ZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY1Byb2xvZ3VlUm9sZV8xKTtcblxudmFyIGRvY1B1bGxxdW90ZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NQdWxscXVvdGVSb2xlID0ge1xuICBhYnN0cmFjdDogZmFsc2UsXG4gIGFjY2Vzc2libGVOYW1lUmVxdWlyZWQ6IGZhbHNlLFxuICBiYXNlQ29uY2VwdHM6IFtdLFxuICBjaGlsZHJlblByZXNlbnRhdGlvbmFsOiBmYWxzZSxcbiAgbmFtZUZyb206IFsnYXV0aG9yJ10sXG4gIHByb2hpYml0ZWRQcm9wczogW10sXG4gIHByb3BzOiB7fSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdwdWxscXVvdGUgW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ25vbmUnXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NQdWxscXVvdGVSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NQdWxscXVvdGVSb2xlXzEpO1xuXG52YXIgZG9jUW5hUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY1FuYVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAncW5hIFtFUFVCLVNTVl0nXG4gICAgfSxcbiAgICBtb2R1bGU6ICdFUFVCJ1xuICB9XSxcbiAgcmVxdWlyZUNvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkT3duZWRFbGVtZW50czogW10sXG4gIHJlcXVpcmVkUHJvcHM6IHt9LFxuICBzdXBlckNsYXNzOiBbWydyb2xldHlwZScsICdzdHJ1Y3R1cmUnLCAnc2VjdGlvbiddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY1FuYVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY1FuYVJvbGVfMSk7XG5cbnZhciBkb2NTdWJ0aXRsZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBkb2NTdWJ0aXRsZVJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnc3VidGl0bGUgW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uaGVhZCddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY1N1YnRpdGxlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZG9jU3VidGl0bGVSb2xlXzEpO1xuXG52YXIgZG9jVGlwUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIGRvY1RpcFJvbGUgPSB7XG4gIGFic3RyYWN0OiBmYWxzZSxcbiAgYWNjZXNzaWJsZU5hbWVSZXF1aXJlZDogZmFsc2UsXG4gIGJhc2VDb25jZXB0czogW10sXG4gIGNoaWxkcmVuUHJlc2VudGF0aW9uYWw6IGZhbHNlLFxuICBuYW1lRnJvbTogWydhdXRob3InXSxcbiAgcHJvaGliaXRlZFByb3BzOiBbXSxcbiAgcHJvcHM6IHtcbiAgICAnYXJpYS1kaXNhYmxlZCc6IG51bGwsXG4gICAgJ2FyaWEtZXJyb3JtZXNzYWdlJzogbnVsbCxcbiAgICAnYXJpYS1leHBhbmRlZCc6IG51bGwsXG4gICAgJ2FyaWEtaGFzcG9wdXAnOiBudWxsLFxuICAgICdhcmlhLWludmFsaWQnOiBudWxsXG4gIH0sXG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaGVscCBbRVBVQi1TU1ZdJ1xuICAgIH0sXG4gICAgbW9kdWxlOiAnRVBVQidcbiAgfV0sXG4gIHJlcXVpcmVDb250ZXh0Um9sZTogW10sXG4gIHJlcXVpcmVkQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZE93bmVkRWxlbWVudHM6IFtdLFxuICByZXF1aXJlZFByb3BzOiB7fSxcbiAgc3VwZXJDbGFzczogW1sncm9sZXR5cGUnLCAnc3RydWN0dXJlJywgJ3NlY3Rpb24nLCAnbm90ZSddXVxufTtcbnZhciBfZGVmYXVsdCA9IGRvY1RpcFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKGRvY1RpcFJvbGVfMSk7XG5cbnZhciBkb2NUb2NSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgZG9jVG9jUm9sZSA9IHtcbiAgYWJzdHJhY3Q6IGZhbHNlLFxuICBhY2Nlc3NpYmxlTmFtZVJlcXVpcmVkOiBmYWxzZSxcbiAgYmFzZUNvbmNlcHRzOiBbXSxcbiAgY2hpbGRyZW5QcmVzZW50YXRpb25hbDogZmFsc2UsXG4gIG5hbWVGcm9tOiBbJ2F1dGhvciddLFxuICBwcm9oaWJpdGVkUHJvcHM6IFtdLFxuICBwcm9wczoge1xuICAgICdhcmlhLWRpc2FibGVkJzogbnVsbCxcbiAgICAnYXJpYS1lcnJvcm1lc3NhZ2UnOiBudWxsLFxuICAgICdhcmlhLWV4cGFuZGVkJzogbnVsbCxcbiAgICAnYXJpYS1oYXNwb3B1cCc6IG51bGwsXG4gICAgJ2FyaWEtaW52YWxpZCc6IG51bGxcbiAgfSxcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0b2MgW0VQVUItU1NWXSdcbiAgICB9LFxuICAgIG1vZHVsZTogJ0VQVUInXG4gIH1dLFxuICByZXF1aXJlQ29udGV4dFJvbGU6IFtdLFxuICByZXF1aXJlZENvbnRleHRSb2xlOiBbXSxcbiAgcmVxdWlyZWRPd25lZEVsZW1lbnRzOiBbXSxcbiAgcmVxdWlyZWRQcm9wczoge30sXG4gIHN1cGVyQ2xhc3M6IFtbJ3JvbGV0eXBlJywgJ3N0cnVjdHVyZScsICdzZWN0aW9uJywgJ2xhbmRtYXJrJywgJ25hdmlnYXRpb24nXV1cbn07XG52YXIgX2RlZmF1bHQgPSBkb2NUb2NSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhkb2NUb2NSb2xlXzEpO1xuXG52YXIgYXJpYURwdWJSb2xlc18xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2RvY0Fic3RyYWN0Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jQWJzdHJhY3RSb2xlXzEpO1xuXG52YXIgX2RvY0Fja25vd2xlZGdtZW50c1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0Fja25vd2xlZGdtZW50c1JvbGVfMSk7XG5cbnZhciBfZG9jQWZ0ZXJ3b3JkUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jQWZ0ZXJ3b3JkUm9sZV8xKTtcblxudmFyIF9kb2NBcHBlbmRpeFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0FwcGVuZGl4Um9sZV8xKTtcblxudmFyIF9kb2NCYWNrbGlua1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0JhY2tsaW5rUm9sZV8xKTtcblxudmFyIF9kb2NCaWJsaW9lbnRyeVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0JpYmxpb2VudHJ5Um9sZV8xKTtcblxudmFyIF9kb2NCaWJsaW9ncmFwaHlSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChkb2NCaWJsaW9ncmFwaHlSb2xlXzEpO1xuXG52YXIgX2RvY0JpYmxpb3JlZlJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0JpYmxpb3JlZlJvbGVfMSk7XG5cbnZhciBfZG9jQ2hhcHRlclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0NoYXB0ZXJSb2xlXzEpO1xuXG52YXIgX2RvY0NvbG9waG9uUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jQ29sb3Bob25Sb2xlXzEpO1xuXG52YXIgX2RvY0NvbmNsdXNpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChkb2NDb25jbHVzaW9uUm9sZV8xKTtcblxudmFyIF9kb2NDb3ZlclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0NvdmVyUm9sZV8xKTtcblxudmFyIF9kb2NDcmVkaXRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChkb2NDcmVkaXRSb2xlXzEpO1xuXG52YXIgX2RvY0NyZWRpdHNSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChkb2NDcmVkaXRzUm9sZV8xKTtcblxudmFyIF9kb2NEZWRpY2F0aW9uUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jRGVkaWNhdGlvblJvbGVfMSk7XG5cbnZhciBfZG9jRW5kbm90ZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0VuZG5vdGVSb2xlXzEpO1xuXG52YXIgX2RvY0VuZG5vdGVzUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jRW5kbm90ZXNSb2xlXzEpO1xuXG52YXIgX2RvY0VwaWdyYXBoUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jRXBpZ3JhcGhSb2xlXzEpO1xuXG52YXIgX2RvY0VwaWxvZ3VlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jRXBpbG9ndWVSb2xlXzEpO1xuXG52YXIgX2RvY0VycmF0YVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0VycmF0YVJvbGVfMSk7XG5cbnZhciBfZG9jRXhhbXBsZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0V4YW1wbGVSb2xlXzEpO1xuXG52YXIgX2RvY0Zvb3Rub3RlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jRm9vdG5vdGVSb2xlXzEpO1xuXG52YXIgX2RvY0ZvcmV3b3JkUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jRm9yZXdvcmRSb2xlXzEpO1xuXG52YXIgX2RvY0dsb3NzYXJ5Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jR2xvc3NhcnlSb2xlXzEpO1xuXG52YXIgX2RvY0dsb3NzcmVmUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jR2xvc3NyZWZSb2xlXzEpO1xuXG52YXIgX2RvY0luZGV4Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jSW5kZXhSb2xlXzEpO1xuXG52YXIgX2RvY0ludHJvZHVjdGlvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY0ludHJvZHVjdGlvblJvbGVfMSk7XG5cbnZhciBfZG9jTm90ZXJlZlJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY05vdGVyZWZSb2xlXzEpO1xuXG52YXIgX2RvY05vdGljZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY05vdGljZVJvbGVfMSk7XG5cbnZhciBfZG9jUGFnZWJyZWFrUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jUGFnZWJyZWFrUm9sZV8xKTtcblxudmFyIF9kb2NQYWdlbGlzdFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY1BhZ2VsaXN0Um9sZV8xKTtcblxudmFyIF9kb2NQYXJ0Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jUGFydFJvbGVfMSk7XG5cbnZhciBfZG9jUHJlZmFjZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY1ByZWZhY2VSb2xlXzEpO1xuXG52YXIgX2RvY1Byb2xvZ3VlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jUHJvbG9ndWVSb2xlXzEpO1xuXG52YXIgX2RvY1B1bGxxdW90ZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY1B1bGxxdW90ZVJvbGVfMSk7XG5cbnZhciBfZG9jUW5hUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZG9jUW5hUm9sZV8xKTtcblxudmFyIF9kb2NTdWJ0aXRsZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY1N1YnRpdGxlUm9sZV8xKTtcblxudmFyIF9kb2NUaXBSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChkb2NUaXBSb2xlXzEpO1xuXG52YXIgX2RvY1RvY1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvY1RvY1JvbGVfMSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBhcmlhRHB1YlJvbGVzID0gW1snZG9jLWFic3RyYWN0JywgX2RvY0Fic3RyYWN0Um9sZS5kZWZhdWx0XSwgWydkb2MtYWNrbm93bGVkZ21lbnRzJywgX2RvY0Fja25vd2xlZGdtZW50c1JvbGUuZGVmYXVsdF0sIFsnZG9jLWFmdGVyd29yZCcsIF9kb2NBZnRlcndvcmRSb2xlLmRlZmF1bHRdLCBbJ2RvYy1hcHBlbmRpeCcsIF9kb2NBcHBlbmRpeFJvbGUuZGVmYXVsdF0sIFsnZG9jLWJhY2tsaW5rJywgX2RvY0JhY2tsaW5rUm9sZS5kZWZhdWx0XSwgWydkb2MtYmlibGlvZW50cnknLCBfZG9jQmlibGlvZW50cnlSb2xlLmRlZmF1bHRdLCBbJ2RvYy1iaWJsaW9ncmFwaHknLCBfZG9jQmlibGlvZ3JhcGh5Um9sZS5kZWZhdWx0XSwgWydkb2MtYmlibGlvcmVmJywgX2RvY0JpYmxpb3JlZlJvbGUuZGVmYXVsdF0sIFsnZG9jLWNoYXB0ZXInLCBfZG9jQ2hhcHRlclJvbGUuZGVmYXVsdF0sIFsnZG9jLWNvbG9waG9uJywgX2RvY0NvbG9waG9uUm9sZS5kZWZhdWx0XSwgWydkb2MtY29uY2x1c2lvbicsIF9kb2NDb25jbHVzaW9uUm9sZS5kZWZhdWx0XSwgWydkb2MtY292ZXInLCBfZG9jQ292ZXJSb2xlLmRlZmF1bHRdLCBbJ2RvYy1jcmVkaXQnLCBfZG9jQ3JlZGl0Um9sZS5kZWZhdWx0XSwgWydkb2MtY3JlZGl0cycsIF9kb2NDcmVkaXRzUm9sZS5kZWZhdWx0XSwgWydkb2MtZGVkaWNhdGlvbicsIF9kb2NEZWRpY2F0aW9uUm9sZS5kZWZhdWx0XSwgWydkb2MtZW5kbm90ZScsIF9kb2NFbmRub3RlUm9sZS5kZWZhdWx0XSwgWydkb2MtZW5kbm90ZXMnLCBfZG9jRW5kbm90ZXNSb2xlLmRlZmF1bHRdLCBbJ2RvYy1lcGlncmFwaCcsIF9kb2NFcGlncmFwaFJvbGUuZGVmYXVsdF0sIFsnZG9jLWVwaWxvZ3VlJywgX2RvY0VwaWxvZ3VlUm9sZS5kZWZhdWx0XSwgWydkb2MtZXJyYXRhJywgX2RvY0VycmF0YVJvbGUuZGVmYXVsdF0sIFsnZG9jLWV4YW1wbGUnLCBfZG9jRXhhbXBsZVJvbGUuZGVmYXVsdF0sIFsnZG9jLWZvb3Rub3RlJywgX2RvY0Zvb3Rub3RlUm9sZS5kZWZhdWx0XSwgWydkb2MtZm9yZXdvcmQnLCBfZG9jRm9yZXdvcmRSb2xlLmRlZmF1bHRdLCBbJ2RvYy1nbG9zc2FyeScsIF9kb2NHbG9zc2FyeVJvbGUuZGVmYXVsdF0sIFsnZG9jLWdsb3NzcmVmJywgX2RvY0dsb3NzcmVmUm9sZS5kZWZhdWx0XSwgWydkb2MtaW5kZXgnLCBfZG9jSW5kZXhSb2xlLmRlZmF1bHRdLCBbJ2RvYy1pbnRyb2R1Y3Rpb24nLCBfZG9jSW50cm9kdWN0aW9uUm9sZS5kZWZhdWx0XSwgWydkb2Mtbm90ZXJlZicsIF9kb2NOb3RlcmVmUm9sZS5kZWZhdWx0XSwgWydkb2Mtbm90aWNlJywgX2RvY05vdGljZVJvbGUuZGVmYXVsdF0sIFsnZG9jLXBhZ2VicmVhaycsIF9kb2NQYWdlYnJlYWtSb2xlLmRlZmF1bHRdLCBbJ2RvYy1wYWdlbGlzdCcsIF9kb2NQYWdlbGlzdFJvbGUuZGVmYXVsdF0sIFsnZG9jLXBhcnQnLCBfZG9jUGFydFJvbGUuZGVmYXVsdF0sIFsnZG9jLXByZWZhY2UnLCBfZG9jUHJlZmFjZVJvbGUuZGVmYXVsdF0sIFsnZG9jLXByb2xvZ3VlJywgX2RvY1Byb2xvZ3VlUm9sZS5kZWZhdWx0XSwgWydkb2MtcHVsbHF1b3RlJywgX2RvY1B1bGxxdW90ZVJvbGUuZGVmYXVsdF0sIFsnZG9jLXFuYScsIF9kb2NRbmFSb2xlLmRlZmF1bHRdLCBbJ2RvYy1zdWJ0aXRsZScsIF9kb2NTdWJ0aXRsZVJvbGUuZGVmYXVsdF0sIFsnZG9jLXRpcCcsIF9kb2NUaXBSb2xlLmRlZmF1bHRdLCBbJ2RvYy10b2MnLCBfZG9jVG9jUm9sZS5kZWZhdWx0XV07XG52YXIgX2RlZmF1bHQgPSBhcmlhRHB1YlJvbGVzO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhhcmlhRHB1YlJvbGVzXzEpO1xuXG52YXIgcm9sZXNNYXBfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9hcmlhQWJzdHJhY3RSb2xlcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoYXJpYUFic3RyYWN0Um9sZXNfMSk7XG5cbnZhciBfYXJpYUxpdGVyYWxSb2xlcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoYXJpYUxpdGVyYWxSb2xlc18xKTtcblxudmFyIF9hcmlhRHB1YlJvbGVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChhcmlhRHB1YlJvbGVzXzEpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfVxuXG5mdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihvLCBhbGxvd0FycmF5TGlrZSkgeyB2YXIgaXQgPSB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSB8fCBvW1wiQEBpdGVyYXRvclwiXTsgaWYgKCFpdCkgeyBpZiAoQXJyYXkuaXNBcnJheShvKSB8fCAoaXQgPSBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobykpIHx8IGFsbG93QXJyYXlMaWtlICYmIG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSB7IGlmIChpdCkgbyA9IGl0OyB2YXIgaSA9IDA7IHZhciBGID0gZnVuY3Rpb24gRigpIHt9OyByZXR1cm4geyBzOiBGLCBuOiBmdW5jdGlvbiBuKCkgeyBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHsgZG9uZTogdHJ1ZSB9OyByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IG9baSsrXSB9OyB9LCBlOiBmdW5jdGlvbiBlKF9lMikgeyB0aHJvdyBfZTI7IH0sIGY6IEYgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7IH0gdmFyIG5vcm1hbENvbXBsZXRpb24gPSB0cnVlLCBkaWRFcnIgPSBmYWxzZSwgZXJyOyByZXR1cm4geyBzOiBmdW5jdGlvbiBzKCkgeyBpdCA9IGl0LmNhbGwobyk7IH0sIG46IGZ1bmN0aW9uIG4oKSB7IHZhciBzdGVwID0gaXQubmV4dCgpOyBub3JtYWxDb21wbGV0aW9uID0gc3RlcC5kb25lOyByZXR1cm4gc3RlcDsgfSwgZTogZnVuY3Rpb24gZShfZTMpIHsgZGlkRXJyID0gdHJ1ZTsgZXJyID0gX2UzOyB9LCBmOiBmdW5jdGlvbiBmKCkgeyB0cnkgeyBpZiAoIW5vcm1hbENvbXBsZXRpb24gJiYgaXQucmV0dXJuICE9IG51bGwpIGl0LnJldHVybigpOyB9IGZpbmFsbHkgeyBpZiAoZGlkRXJyKSB0aHJvdyBlcnI7IH0gfSB9OyB9XG5cbmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9XG5cbmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7IH1cblxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9XG5cbmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfVxuXG5mdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7IHZhciBfaSA9IGFyciA9PSBudWxsID8gbnVsbCA6IHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgYXJyW1N5bWJvbC5pdGVyYXRvcl0gfHwgYXJyW1wiQEBpdGVyYXRvclwiXTsgaWYgKF9pID09IG51bGwpIHJldHVybjsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfcywgX2U7IHRyeSB7IGZvciAoX2kgPSBfaS5jYWxsKGFycik7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsgX2Fyci5wdXNoKF9zLnZhbHVlKTsgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOyB9IH0gY2F0Y2ggKGVycikgeyBfZCA9IHRydWU7IF9lID0gZXJyOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIV9uICYmIF9pW1wicmV0dXJuXCJdICE9IG51bGwpIF9pW1wicmV0dXJuXCJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfVxuXG5mdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7IH1cblxudmFyIHJvbGVzID0gW10uY29uY2F0KF9hcmlhQWJzdHJhY3RSb2xlcy5kZWZhdWx0LCBfYXJpYUxpdGVyYWxSb2xlcy5kZWZhdWx0LCBfYXJpYURwdWJSb2xlcy5kZWZhdWx0KTtcbnJvbGVzLmZvckVhY2goZnVuY3Rpb24gKF9yZWYpIHtcbiAgdmFyIF9yZWYyID0gX3NsaWNlZFRvQXJyYXkoX3JlZiwgMiksXG4gICAgICByb2xlRGVmaW5pdGlvbiA9IF9yZWYyWzFdO1xuXG4gIC8vIENvbmdsb21lcmF0ZSB0aGUgcHJvcGVydGllc1xuICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocm9sZURlZmluaXRpb24uc3VwZXJDbGFzcyksXG4gICAgICBfc3RlcDtcblxuICB0cnkge1xuICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7XG4gICAgICB2YXIgc3VwZXJDbGFzc0l0ZXIgPSBfc3RlcC52YWx1ZTtcblxuICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihzdXBlckNsYXNzSXRlciksXG4gICAgICAgICAgX3N0ZXAyO1xuXG4gICAgICB0cnkge1xuICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHtcbiAgICAgICAgICB2YXIgc3VwZXJDbGFzc05hbWUgPSBfc3RlcDIudmFsdWU7XG4gICAgICAgICAgdmFyIHN1cGVyQ2xhc3NSb2xlVHVwbGUgPSByb2xlcy5maW5kKGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgICAgICAgdmFyIF9yZWY0ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjMsIDEpLFxuICAgICAgICAgICAgICAgIG5hbWUgPSBfcmVmNFswXTtcblxuICAgICAgICAgICAgcmV0dXJuIG5hbWUgPT09IHN1cGVyQ2xhc3NOYW1lO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYgKHN1cGVyQ2xhc3NSb2xlVHVwbGUpIHtcbiAgICAgICAgICAgIHZhciBzdXBlckNsYXNzRGVmaW5pdGlvbiA9IHN1cGVyQ2xhc3NSb2xlVHVwbGVbMV07XG5cbiAgICAgICAgICAgIGZvciAodmFyIF9pMiA9IDAsIF9PYmplY3Qka2V5cyA9IE9iamVjdC5rZXlzKHN1cGVyQ2xhc3NEZWZpbml0aW9uLnByb3BzKTsgX2kyIDwgX09iamVjdCRrZXlzLmxlbmd0aDsgX2kyKyspIHtcbiAgICAgICAgICAgICAgdmFyIHByb3AgPSBfT2JqZWN0JGtleXNbX2kyXTtcblxuICAgICAgICAgICAgICBpZiAoIC8vICRGbG93SXNzdWUgQWNjZXNzaW5nIHRoZSBoYXNPd25Qcm9wZXJ0eSBvbiB0aGUgT2JqZWN0IHByb3RvdHlwZSBpcyBmaW5lLlxuICAgICAgICAgICAgICAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHJvbGVEZWZpbml0aW9uLnByb3BzLCBwcm9wKSkge1xuICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocm9sZURlZmluaXRpb24ucHJvcHMsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgcHJvcCwgc3VwZXJDbGFzc0RlZmluaXRpb24ucHJvcHNbcHJvcF0pKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKF9pdGVyYXRvcjIucygpOyAhKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lOykge1xuICAgICAgICAgIF9sb29wKCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIF9pdGVyYXRvcjIuZigpO1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgX2l0ZXJhdG9yLmUoZXJyKTtcbiAgfSBmaW5hbGx5IHtcbiAgICBfaXRlcmF0b3IuZigpO1xuICB9XG59KTtcbnZhciByb2xlc01hcCA9IHtcbiAgZW50cmllczogZnVuY3Rpb24gZW50cmllcygpIHtcbiAgICByZXR1cm4gcm9sZXM7XG4gIH0sXG4gIGdldDogZnVuY3Rpb24gZ2V0KGtleSkge1xuICAgIHZhciBpdGVtID0gcm9sZXMuZmluZChmdW5jdGlvbiAodHVwbGUpIHtcbiAgICAgIHJldHVybiB0dXBsZVswXSA9PT0ga2V5ID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH0pO1xuICAgIHJldHVybiBpdGVtICYmIGl0ZW1bMV07XG4gIH0sXG4gIGhhczogZnVuY3Rpb24gaGFzKGtleSkge1xuICAgIHJldHVybiAhIXRoaXMuZ2V0KGtleSk7XG4gIH0sXG4gIGtleXM6IGZ1bmN0aW9uIGtleXMoKSB7XG4gICAgcmV0dXJuIHJvbGVzLm1hcChmdW5jdGlvbiAoX3JlZjUpIHtcbiAgICAgIHZhciBfcmVmNiA9IF9zbGljZWRUb0FycmF5KF9yZWY1LCAxKSxcbiAgICAgICAgICBrZXkgPSBfcmVmNlswXTtcblxuICAgICAgcmV0dXJuIGtleTtcbiAgICB9KTtcbiAgfSxcbiAgdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoKSB7XG4gICAgcmV0dXJuIHJvbGVzLm1hcChmdW5jdGlvbiAoX3JlZjcpIHtcbiAgICAgIHZhciBfcmVmOCA9IF9zbGljZWRUb0FycmF5KF9yZWY3LCAyKSxcbiAgICAgICAgICB2YWx1ZXMgPSBfcmVmOFsxXTtcblxuICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICB9KTtcbiAgfVxufTtcbnZhciBfZGVmYXVsdCA9IHJvbGVzTWFwO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhyb2xlc01hcF8xKTtcblxudmFyIGVsZW1lbnRSb2xlTWFwXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfcm9sZXNNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJvbGVzTWFwXzEpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsgfVxuXG5mdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpOyB9XG5cbmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfVxuXG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH1cblxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyB2YXIgX2kgPSBhcnIgPT0gbnVsbCA/IG51bGwgOiB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGFycltTeW1ib2wuaXRlcmF0b3JdIHx8IGFycltcIkBAaXRlcmF0b3JcIl07IGlmIChfaSA9PSBudWxsKSByZXR1cm47IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX3MsIF9lOyB0cnkgeyBmb3IgKF9pID0gX2kuY2FsbChhcnIpOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVtcInJldHVyblwiXSAhPSBudWxsKSBfaVtcInJldHVyblwiXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH1cblxuZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9XG5cbnZhciBlbGVtZW50Um9sZXMgPSBbXTtcblxudmFyIGtleXMgPSBfcm9sZXNNYXAuZGVmYXVsdC5rZXlzKCk7XG5cbmZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICB2YXIgX2tleSA9IGtleXNbaV07XG5cbiAgdmFyIHJvbGUgPSBfcm9sZXNNYXAuZGVmYXVsdC5nZXQoX2tleSk7XG5cbiAgaWYgKHJvbGUpIHtcbiAgICB2YXIgY29uY2VwdHMgPSBbXS5jb25jYXQocm9sZS5iYXNlQ29uY2VwdHMsIHJvbGUucmVsYXRlZENvbmNlcHRzKTtcblxuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY29uY2VwdHMubGVuZ3RoOyBrKyspIHtcbiAgICAgIHZhciByZWxhdGlvbiA9IGNvbmNlcHRzW2tdO1xuXG4gICAgICBpZiAocmVsYXRpb24ubW9kdWxlID09PSAnSFRNTCcpIHtcbiAgICAgICAgdmFyIGNvbmNlcHQgPSByZWxhdGlvbi5jb25jZXB0O1xuXG4gICAgICAgIGlmIChjb25jZXB0KSB7XG4gICAgICAgICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjb25jZXB0U3RyID0gSlNPTi5zdHJpbmdpZnkoY29uY2VwdCk7XG4gICAgICAgICAgICB2YXIgZWxlbWVudFJvbGVSZWxhdGlvbiA9IGVsZW1lbnRSb2xlcy5maW5kKGZ1bmN0aW9uIChyZWxhdGlvbikge1xuICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkocmVsYXRpb25bMF0pID09PSBjb25jZXB0U3RyO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgcm9sZXMgPSB2b2lkIDA7XG5cbiAgICAgICAgICAgIGlmIChlbGVtZW50Um9sZVJlbGF0aW9uKSB7XG4gICAgICAgICAgICAgIHJvbGVzID0gZWxlbWVudFJvbGVSZWxhdGlvblsxXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJvbGVzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpc1VuaXF1ZSA9IHRydWU7XG5cbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCByb2xlcy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgaWYgKHJvbGVzW19pXSA9PT0gX2tleSkge1xuICAgICAgICAgICAgICAgIGlzVW5pcXVlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGlzVW5pcXVlKSB7XG4gICAgICAgICAgICAgIHJvbGVzLnB1c2goX2tleSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGVsZW1lbnRSb2xlcy5wdXNoKFtjb25jZXB0LCByb2xlc10pO1xuICAgICAgICAgIH0pKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxudmFyIGVsZW1lbnRSb2xlTWFwID0ge1xuICBlbnRyaWVzOiBmdW5jdGlvbiBlbnRyaWVzKCkge1xuICAgIHJldHVybiBlbGVtZW50Um9sZXM7XG4gIH0sXG4gIGdldDogZnVuY3Rpb24gZ2V0KGtleSkge1xuICAgIHZhciBpdGVtID0gZWxlbWVudFJvbGVzLmZpbmQoZnVuY3Rpb24gKHR1cGxlKSB7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodHVwbGVbMF0pID09PSBKU09OLnN0cmluZ2lmeShrZXkpID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH0pO1xuICAgIHJldHVybiBpdGVtICYmIGl0ZW1bMV07XG4gIH0sXG4gIGhhczogZnVuY3Rpb24gaGFzKGtleSkge1xuICAgIHJldHVybiAhIXRoaXMuZ2V0KGtleSk7XG4gIH0sXG4gIGtleXM6IGZ1bmN0aW9uIGtleXMoKSB7XG4gICAgcmV0dXJuIGVsZW1lbnRSb2xlcy5tYXAoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgIHZhciBfcmVmMiA9IF9zbGljZWRUb0FycmF5KF9yZWYsIDEpLFxuICAgICAgICAgIGtleSA9IF9yZWYyWzBdO1xuXG4gICAgICByZXR1cm4ga2V5O1xuICAgIH0pO1xuICB9LFxuICB2YWx1ZXM6IGZ1bmN0aW9uIHZhbHVlcygpIHtcbiAgICByZXR1cm4gZWxlbWVudFJvbGVzLm1hcChmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgIHZhciBfcmVmNCA9IF9zbGljZWRUb0FycmF5KF9yZWYzLCAyKSxcbiAgICAgICAgICB2YWx1ZXMgPSBfcmVmNFsxXTtcblxuICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICB9KTtcbiAgfVxufTtcbnZhciBfZGVmYXVsdCA9IGVsZW1lbnRSb2xlTWFwO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhlbGVtZW50Um9sZU1hcF8xKTtcblxudmFyIHJvbGVFbGVtZW50TWFwXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfcm9sZXNNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJvbGVzTWFwXzEpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsgfVxuXG5mdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpOyB9XG5cbmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfVxuXG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH1cblxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyB2YXIgX2kgPSBhcnIgPT0gbnVsbCA/IG51bGwgOiB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGFycltTeW1ib2wuaXRlcmF0b3JdIHx8IGFycltcIkBAaXRlcmF0b3JcIl07IGlmIChfaSA9PSBudWxsKSByZXR1cm47IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX3MsIF9lOyB0cnkgeyBmb3IgKF9pID0gX2kuY2FsbChhcnIpOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVtcInJldHVyblwiXSAhPSBudWxsKSBfaVtcInJldHVyblwiXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH1cblxuZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9XG5cbnZhciByb2xlRWxlbWVudCA9IFtdO1xuXG52YXIga2V5cyA9IF9yb2xlc01hcC5kZWZhdWx0LmtleXMoKTtcblxudmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoaSkge1xuICB2YXIga2V5ID0ga2V5c1tpXTtcblxuICB2YXIgcm9sZSA9IF9yb2xlc01hcC5kZWZhdWx0LmdldChrZXkpO1xuXG4gIGlmIChyb2xlKSB7XG4gICAgdmFyIGNvbmNlcHRzID0gW10uY29uY2F0KHJvbGUuYmFzZUNvbmNlcHRzLCByb2xlLnJlbGF0ZWRDb25jZXB0cyk7XG5cbiAgICBmb3IgKHZhciBrID0gMDsgayA8IGNvbmNlcHRzLmxlbmd0aDsgaysrKSB7XG4gICAgICB2YXIgcmVsYXRpb24gPSBjb25jZXB0c1trXTtcblxuICAgICAgaWYgKHJlbGF0aW9uLm1vZHVsZSA9PT0gJ0hUTUwnKSB7XG4gICAgICAgIHZhciBjb25jZXB0ID0gcmVsYXRpb24uY29uY2VwdDtcblxuICAgICAgICBpZiAoY29uY2VwdCkge1xuICAgICAgICAgIHZhciByb2xlRWxlbWVudFJlbGF0aW9uID0gcm9sZUVsZW1lbnQuZmluZChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IGtleTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YXIgcmVsYXRpb25Db25jZXB0cyA9IHZvaWQgMDtcblxuICAgICAgICAgIGlmIChyb2xlRWxlbWVudFJlbGF0aW9uKSB7XG4gICAgICAgICAgICByZWxhdGlvbkNvbmNlcHRzID0gcm9sZUVsZW1lbnRSZWxhdGlvblsxXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVsYXRpb25Db25jZXB0cyA9IFtdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJlbGF0aW9uQ29uY2VwdHMucHVzaChjb25jZXB0KTtcbiAgICAgICAgICByb2xlRWxlbWVudC5wdXNoKFtrZXksIHJlbGF0aW9uQ29uY2VwdHNdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gIF9sb29wKGkpO1xufVxuXG52YXIgcm9sZUVsZW1lbnRNYXAgPSB7XG4gIGVudHJpZXM6IGZ1bmN0aW9uIGVudHJpZXMoKSB7XG4gICAgcmV0dXJuIHJvbGVFbGVtZW50O1xuICB9LFxuICBnZXQ6IGZ1bmN0aW9uIGdldChrZXkpIHtcbiAgICB2YXIgaXRlbSA9IHJvbGVFbGVtZW50LmZpbmQoZnVuY3Rpb24gKHR1cGxlKSB7XG4gICAgICByZXR1cm4gdHVwbGVbMF0gPT09IGtleSA/IHRydWUgOiBmYWxzZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaXRlbSAmJiBpdGVtWzFdO1xuICB9LFxuICBoYXM6IGZ1bmN0aW9uIGhhcyhrZXkpIHtcbiAgICByZXR1cm4gISF0aGlzLmdldChrZXkpO1xuICB9LFxuICBrZXlzOiBmdW5jdGlvbiBrZXlzKCkge1xuICAgIHJldHVybiByb2xlRWxlbWVudC5tYXAoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgIHZhciBfcmVmMiA9IF9zbGljZWRUb0FycmF5KF9yZWYsIDEpLFxuICAgICAgICAgIGtleSA9IF9yZWYyWzBdO1xuXG4gICAgICByZXR1cm4ga2V5O1xuICAgIH0pO1xuICB9LFxuICB2YWx1ZXM6IGZ1bmN0aW9uIHZhbHVlcygpIHtcbiAgICByZXR1cm4gcm9sZUVsZW1lbnQubWFwKGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgdmFyIF9yZWY0ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjMsIDIpLFxuICAgICAgICAgIHZhbHVlcyA9IF9yZWY0WzFdO1xuXG4gICAgICByZXR1cm4gdmFsdWVzO1xuICAgIH0pO1xuICB9XG59O1xudmFyIF9kZWZhdWx0ID0gcm9sZUVsZW1lbnRNYXA7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKHJvbGVFbGVtZW50TWFwXzEpO1xuXG52YXIgbGliID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5yb2xlRWxlbWVudHMgPSBleHBvcnRzLmVsZW1lbnRSb2xlcyA9IGV4cG9ydHMucm9sZXMgPSBleHBvcnRzLmRvbSA9IGV4cG9ydHMuYXJpYSA9IHZvaWQgMDtcblxudmFyIF9hcmlhUHJvcHNNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGFyaWFQcm9wc01hcF8xKTtcblxudmFyIF9kb21NYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGRvbU1hcF8xKTtcblxudmFyIF9yb2xlc01hcCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocm9sZXNNYXBfMSk7XG5cbnZhciBfZWxlbWVudFJvbGVNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGVsZW1lbnRSb2xlTWFwXzEpO1xuXG52YXIgX3JvbGVFbGVtZW50TWFwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyb2xlRWxlbWVudE1hcF8xKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIGFyaWEgPSBfYXJpYVByb3BzTWFwLmRlZmF1bHQ7XG5leHBvcnRzLmFyaWEgPSBhcmlhO1xudmFyIGRvbSA9IF9kb21NYXAuZGVmYXVsdDtcbmV4cG9ydHMuZG9tID0gZG9tO1xudmFyIHJvbGVzID0gX3JvbGVzTWFwLmRlZmF1bHQ7XG5leHBvcnRzLnJvbGVzID0gcm9sZXM7XG52YXIgZWxlbWVudFJvbGVzID0gX2VsZW1lbnRSb2xlTWFwLmRlZmF1bHQ7XG5leHBvcnRzLmVsZW1lbnRSb2xlcyA9IGVsZW1lbnRSb2xlcztcbnZhciByb2xlRWxlbWVudHMgPSBfcm9sZUVsZW1lbnRNYXAuZGVmYXVsdDtcbmV4cG9ydHMucm9sZUVsZW1lbnRzID0gcm9sZUVsZW1lbnRzO1xufSk7XG5cbnVud3JhcEV4cG9ydHMobGliKTtcbnZhciBsaWJfMSA9IGxpYi5yb2xlRWxlbWVudHM7XG52YXIgbGliXzIgPSBsaWIuZWxlbWVudFJvbGVzO1xudmFyIGxpYl8zID0gbGliLnJvbGVzO1xudmFyIGxpYl80ID0gbGliLmRvbTtcbnZhciBsaWJfNSA9IGxpYi5hcmlhO1xuXG52YXIgQWJiclJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBBYmJyUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdhYmJyJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gQWJiclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEFiYnJSb2xlXzEpO1xuXG52YXIgQWxlcnREaWFsb2dSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgQWxlcnREaWFsb2dSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2FsZXJ0ZGlhbG9nJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICd3aW5kb3cnXG59O1xudmFyIF9kZWZhdWx0ID0gQWxlcnREaWFsb2dSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhBbGVydERpYWxvZ1JvbGVfMSk7XG5cbnZhciBBbGVydFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBBbGVydFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnYWxlcnQnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBBbGVydFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEFsZXJ0Um9sZV8xKTtcblxudmFyIEFubm90YXRpb25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgQW5ub3RhdGlvblJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gQW5ub3RhdGlvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEFubm90YXRpb25Sb2xlXzEpO1xuXG52YXIgQXBwbGljYXRpb25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgQXBwbGljYXRpb25Sb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2FwcGxpY2F0aW9uJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICd3aW5kb3cnXG59O1xudmFyIF9kZWZhdWx0ID0gQXBwbGljYXRpb25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhBcHBsaWNhdGlvblJvbGVfMSk7XG5cbnZhciBBcnRpY2xlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIEFydGljbGVSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2FydGljbGUnXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2FydGljbGUnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBBcnRpY2xlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoQXJ0aWNsZVJvbGVfMSk7XG5cbnZhciBBdWRpb1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBBdWRpb1JvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnYXVkaW8nXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBBdWRpb1JvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEF1ZGlvUm9sZV8xKTtcblxudmFyIEJhbm5lclJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBCYW5uZXJSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2Jhbm5lcidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IEJhbm5lclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEJhbm5lclJvbGVfMSk7XG5cbnZhciBCbG9ja3F1b3RlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIEJsb2NrcXVvdGVSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2Jsb2NrcXVvdGUnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBCbG9ja3F1b3RlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoQmxvY2txdW90ZVJvbGVfMSk7XG5cbnZhciBCdXN5SW5kaWNhdG9yUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIEJ1c3lJbmRpY2F0b3JSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgbmFtZTogJ2FyaWEtYnVzeScsXG4gICAgICAgIHZhbHVlOiAndHJ1ZSdcbiAgICAgIH1dXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBCdXN5SW5kaWNhdG9yUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoQnVzeUluZGljYXRvclJvbGVfMSk7XG5cbnZhciBCdXR0b25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgQnV0dG9uUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdidXR0b24nXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2J1dHRvbidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IEJ1dHRvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEJ1dHRvblJvbGVfMSk7XG5cbnZhciBDYW52YXNSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgQ2FudmFzUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdjYW52YXMnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBDYW52YXNSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhDYW52YXNSb2xlXzEpO1xuXG52YXIgQ2FwdGlvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBDYXB0aW9uUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdjYXB0aW9uJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gQ2FwdGlvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKENhcHRpb25Sb2xlXzEpO1xuXG52YXIgQ2VsbFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBDZWxsUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdjZWxsJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdncmlkY2VsbCdcbiAgICB9XG4gIH0sIHtcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndGQnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBDZWxsUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoQ2VsbFJvbGVfMSk7XG5cbnZhciBDaGVja0JveFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBDaGVja0JveFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnY2hlY2tib3gnXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2lucHV0JyxcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICdjaGVja2JveCdcbiAgICAgIH1dXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBDaGVja0JveFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKENoZWNrQm94Um9sZV8xKTtcblxudmFyIENvbG9yV2VsbFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBDb2xvcldlbGxSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2lucHV0JyxcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICdjb2xvcidcbiAgICAgIH1dXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBDb2xvcldlbGxSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhDb2xvcldlbGxSb2xlXzEpO1xuXG52YXIgQ29sdW1uSGVhZGVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIENvbHVtbkhlYWRlclJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnY29sdW1uaGVhZGVyJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0aCdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IENvbHVtbkhlYWRlclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKENvbHVtbkhlYWRlclJvbGVfMSk7XG5cbnZhciBDb2x1bW5Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgQ29sdW1uUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBDb2x1bW5Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhDb2x1bW5Sb2xlXzEpO1xuXG52YXIgQ29tYm9Cb3hSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgQ29tYm9Cb3hSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2NvbWJvYm94J1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdzZWxlY3QnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBDb21ib0JveFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKENvbWJvQm94Um9sZV8xKTtcblxudmFyIENvbXBsZW1lbnRhcnlSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgQ29tcGxlbWVudGFyeVJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnY29tcGxlbWVudGFyeSdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IENvbXBsZW1lbnRhcnlSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhDb21wbGVtZW50YXJ5Um9sZV8xKTtcblxudmFyIENvbnRlbnRJbmZvUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIENvbnRlbnRJbmZvUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdzdHJ1Y3R1cmVpbmZvJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gQ29udGVudEluZm9Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhDb250ZW50SW5mb1JvbGVfMSk7XG5cbnZhciBEYXRlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIERhdGVSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2lucHV0JyxcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICdkYXRlJ1xuICAgICAgfV1cbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IERhdGVSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhEYXRlUm9sZV8xKTtcblxudmFyIERhdGVUaW1lUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIERhdGVUaW1lUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpbnB1dCcsXG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAnZGF0ZXRpbWUnXG4gICAgICB9XVxuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICd3aWRnZXQnXG59O1xudmFyIF9kZWZhdWx0ID0gRGF0ZVRpbWVSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhEYXRlVGltZVJvbGVfMSk7XG5cbnZhciBEZWZpbml0aW9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIERlZmluaXRpb25Sb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RmbidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IERlZmluaXRpb25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhEZWZpbml0aW9uUm9sZV8xKTtcblxudmFyIERlc2NyaXB0aW9uTGlzdERldGFpbFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBEZXNjcmlwdGlvbkxpc3REZXRhaWxSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RkJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gRGVzY3JpcHRpb25MaXN0RGV0YWlsUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoRGVzY3JpcHRpb25MaXN0RGV0YWlsUm9sZV8xKTtcblxudmFyIERlc2NyaXB0aW9uTGlzdFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBEZXNjcmlwdGlvbkxpc3RSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RsJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gRGVzY3JpcHRpb25MaXN0Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoRGVzY3JpcHRpb25MaXN0Um9sZV8xKTtcblxudmFyIERlc2NyaXB0aW9uTGlzdFRlcm1Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgRGVzY3JpcHRpb25MaXN0VGVybVJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZHQnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBEZXNjcmlwdGlvbkxpc3RUZXJtUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoRGVzY3JpcHRpb25MaXN0VGVybVJvbGVfMSk7XG5cbnZhciBEZXRhaWxzUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIERldGFpbHNSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RldGFpbHMnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBEZXRhaWxzUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoRGV0YWlsc1JvbGVfMSk7XG5cbnZhciBEaWFsb2dSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgRGlhbG9nUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdkaWFsb2cnXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RpYWxvZydcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2luZG93J1xufTtcbnZhciBfZGVmYXVsdCA9IERpYWxvZ1JvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKERpYWxvZ1JvbGVfMSk7XG5cbnZhciBEaXJlY3RvcnlSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgRGlyZWN0b3J5Um9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdkaXJlY3RvcnknXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RpcidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IERpcmVjdG9yeVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKERpcmVjdG9yeVJvbGVfMSk7XG5cbnZhciBEaXNjbG9zdXJlVHJpYW5nbGVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgRGlzY2xvc3VyZVRyaWFuZ2xlUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdzdW1tYXJ5J1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICd3aWRnZXQnXG59O1xudmFyIF9kZWZhdWx0ID0gRGlzY2xvc3VyZVRyaWFuZ2xlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoRGlzY2xvc3VyZVRyaWFuZ2xlUm9sZV8xKTtcblxudmFyIERpdlJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBEaXZSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RpdidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnZ2VuZXJpYydcbn07XG52YXIgX2RlZmF1bHQgPSBEaXZSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhEaXZSb2xlXzEpO1xuXG52YXIgRG9jdW1lbnRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgRG9jdW1lbnRSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RvY3VtZW50J1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gRG9jdW1lbnRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhEb2N1bWVudFJvbGVfMSk7XG5cbnZhciBFbWJlZGRlZE9iamVjdFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBFbWJlZGRlZE9iamVjdFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZW1iZWQnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBFbWJlZGRlZE9iamVjdFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEVtYmVkZGVkT2JqZWN0Um9sZV8xKTtcblxudmFyIEZlZWRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgRmVlZFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZmVlZCdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IEZlZWRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhGZWVkUm9sZV8xKTtcblxudmFyIEZpZ2NhcHRpb25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgRmlnY2FwdGlvblJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZmlnY2FwdGlvbidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IEZpZ2NhcHRpb25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhGaWdjYXB0aW9uUm9sZV8xKTtcblxudmFyIEZpZ3VyZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBGaWd1cmVSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2ZpZ3VyZSdcbiAgICB9XG4gIH0sIHtcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZmlndXJlJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gRmlndXJlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoRmlndXJlUm9sZV8xKTtcblxudmFyIEZvb3RlclJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBGb290ZXJSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2Zvb3RlcidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IEZvb3RlclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEZvb3RlclJvbGVfMSk7XG5cbnZhciBGb3JtUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIEZvcm1Sb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2Zvcm0nXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2Zvcm0nXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBGb3JtUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoRm9ybVJvbGVfMSk7XG5cbnZhciBHcmlkUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIEdyaWRSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2dyaWQnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBHcmlkUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoR3JpZFJvbGVfMSk7XG5cbnZhciBHcm91cFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBHcm91cFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnZ3JvdXAnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBHcm91cFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEdyb3VwUm9sZV8xKTtcblxudmFyIEhlYWRpbmdSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgSGVhZGluZ1JvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaGVhZGluZydcbiAgICB9XG4gIH0sIHtcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaDEnXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2gyJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdoMydcbiAgICB9XG4gIH0sIHtcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaDQnXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2g1J1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdoNidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IEhlYWRpbmdSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhIZWFkaW5nUm9sZV8xKTtcblxudmFyIElmcmFtZVByZXNlbnRhdGlvbmFsUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIElmcmFtZVByZXNlbnRhdGlvbmFsUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgdHlwZTogJ3dpbmRvdydcbn07XG52YXIgX2RlZmF1bHQgPSBJZnJhbWVQcmVzZW50YXRpb25hbFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKElmcmFtZVByZXNlbnRhdGlvbmFsUm9sZV8xKTtcblxudmFyIElmcmFtZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBJZnJhbWVSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2lmcmFtZSdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2luZG93J1xufTtcbnZhciBfZGVmYXVsdCA9IElmcmFtZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKElmcmFtZVJvbGVfMSk7XG5cbnZhciBJZ25vcmVkUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIElnbm9yZWRSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IElnbm9yZWRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhJZ25vcmVkUm9sZV8xKTtcblxudmFyIEltYWdlTWFwTGlua1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBJbWFnZU1hcExpbmtSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IEltYWdlTWFwTGlua1JvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEltYWdlTWFwTGlua1JvbGVfMSk7XG5cbnZhciBJbWFnZU1hcFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBJbWFnZU1hcFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaW1nJyxcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICd1c2VtYXAnXG4gICAgICB9XVxuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gSW1hZ2VNYXBSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhJbWFnZU1hcFJvbGVfMSk7XG5cbnZhciBJbWFnZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBJbWFnZVJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaW1nJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpbWcnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBJbWFnZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEltYWdlUm9sZV8xKTtcblxudmFyIElubGluZVRleHRCb3hSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgSW5saW5lVGV4dEJveFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaW5wdXQnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBJbmxpbmVUZXh0Qm94Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoSW5saW5lVGV4dEJveFJvbGVfMSk7XG5cbnZhciBJbnB1dFRpbWVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgSW5wdXRUaW1lUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpbnB1dCcsXG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAndGltZSdcbiAgICAgIH1dXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBJbnB1dFRpbWVSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhJbnB1dFRpbWVSb2xlXzEpO1xuXG52YXIgTGFiZWxSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTGFiZWxSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2xhYmVsJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gTGFiZWxSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhMYWJlbFJvbGVfMSk7XG5cbnZhciBMZWdlbmRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTGVnZW5kUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdsZWdlbmQnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBMZWdlbmRSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhMZWdlbmRSb2xlXzEpO1xuXG52YXIgTGluZUJyZWFrUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIExpbmVCcmVha1JvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnYnInXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBMaW5lQnJlYWtSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhMaW5lQnJlYWtSb2xlXzEpO1xuXG52YXIgTGlua1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBMaW5rUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdsaW5rJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdhJyxcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICdocmVmJ1xuICAgICAgfV1cbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IExpbmtSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhMaW5rUm9sZV8xKTtcblxudmFyIExpc3RCb3hPcHRpb25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTGlzdEJveE9wdGlvblJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnb3B0aW9uJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdvcHRpb24nXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBMaXN0Qm94T3B0aW9uUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoTGlzdEJveE9wdGlvblJvbGVfMSk7XG5cbnZhciBMaXN0Qm94Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIExpc3RCb3hSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2xpc3Rib3gnXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2RhdGFsaXN0J1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdzZWxlY3QnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBMaXN0Qm94Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoTGlzdEJveFJvbGVfMSk7XG5cbnZhciBMaXN0SXRlbVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBMaXN0SXRlbVJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbGlzdGl0ZW0nXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2xpJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gTGlzdEl0ZW1Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhMaXN0SXRlbVJvbGVfMSk7XG5cbnZhciBMaXN0TWFya2VyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIExpc3RNYXJrZXJSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IExpc3RNYXJrZXJSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhMaXN0TWFya2VyUm9sZV8xKTtcblxudmFyIExpc3RSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTGlzdFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbGlzdCdcbiAgICB9XG4gIH0sIHtcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndWwnXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ29sJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gTGlzdFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKExpc3RSb2xlXzEpO1xuXG52YXIgTG9nUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIExvZ1JvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbG9nJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gTG9nUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoTG9nUm9sZV8xKTtcblxudmFyIE1haW5Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTWFpblJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWFpbidcbiAgICB9XG4gIH0sIHtcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWFpbidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IE1haW5Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhNYWluUm9sZV8xKTtcblxudmFyIE1hcmtSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTWFya1JvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWFyaydcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IE1hcmtSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhNYXJrUm9sZV8xKTtcblxudmFyIE1hcnF1ZWVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTWFycXVlZVJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWFycXVlZSdcbiAgICB9XG4gIH0sIHtcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWFycXVlZSdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IE1hcnF1ZWVSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhNYXJxdWVlUm9sZV8xKTtcblxudmFyIE1hdGhSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTWF0aFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWF0aCdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IE1hdGhSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhNYXRoUm9sZV8xKTtcblxudmFyIE1lbnVCYXJSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTWVudUJhclJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWVudWJhcidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IE1lbnVCYXJSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhNZW51QmFyUm9sZV8xKTtcblxudmFyIE1lbnVCdXR0b25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTWVudUJ1dHRvblJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHR5cGU6ICd3aWRnZXQnXG59O1xudmFyIF9kZWZhdWx0ID0gTWVudUJ1dHRvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKE1lbnVCdXR0b25Sb2xlXzEpO1xuXG52YXIgTWVudUl0ZW1Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTWVudUl0ZW1Sb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ21lbnVpdGVtJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdtZW51aXRlbSdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IE1lbnVJdGVtUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoTWVudUl0ZW1Sb2xlXzEpO1xuXG52YXIgTWVudUl0ZW1DaGVja0JveFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBNZW51SXRlbUNoZWNrQm94Um9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdtZW51aXRlbWNoZWNrYm94J1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICd3aWRnZXQnXG59O1xudmFyIF9kZWZhdWx0ID0gTWVudUl0ZW1DaGVja0JveFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKE1lbnVJdGVtQ2hlY2tCb3hSb2xlXzEpO1xuXG52YXIgTWVudUl0ZW1SYWRpb1JvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBNZW51SXRlbVJhZGlvUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdtZW51aXRlbXJhZGlvJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICd3aWRnZXQnXG59O1xudmFyIF9kZWZhdWx0ID0gTWVudUl0ZW1SYWRpb1JvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKE1lbnVJdGVtUmFkaW9Sb2xlXzEpO1xuXG52YXIgTWVudUxpc3RPcHRpb25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTWVudUxpc3RPcHRpb25Sb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IE1lbnVMaXN0T3B0aW9uUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoTWVudUxpc3RPcHRpb25Sb2xlXzEpO1xuXG52YXIgTWVudUxpc3RQb3B1cFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBNZW51TGlzdFBvcHVwUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBNZW51TGlzdFBvcHVwUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoTWVudUxpc3RQb3B1cFJvbGVfMSk7XG5cbnZhciBNZW51Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIE1lbnVSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ21lbnUnXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ21lbnUnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBNZW51Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoTWVudVJvbGVfMSk7XG5cbnZhciBNZXRlclJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBNZXRlclJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbWV0ZXInXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBNZXRlclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKE1ldGVyUm9sZV8xKTtcblxudmFyIE5hdmlnYXRpb25Sb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgTmF2aWdhdGlvblJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbmF2aWdhdGlvbidcbiAgICB9XG4gIH0sIHtcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnbmF2J1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gTmF2aWdhdGlvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKE5hdmlnYXRpb25Sb2xlXzEpO1xuXG52YXIgTm9uZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBOb25lUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdub25lJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gTm9uZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKE5vbmVSb2xlXzEpO1xuXG52YXIgTm90ZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBOb3RlUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdub3RlJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gTm90ZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKE5vdGVSb2xlXzEpO1xuXG52YXIgT3V0bGluZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBPdXRsaW5lUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBPdXRsaW5lUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoT3V0bGluZVJvbGVfMSk7XG5cbnZhciBQYXJhZ3JhcGhSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgUGFyYWdyYXBoUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdwJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gUGFyYWdyYXBoUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoUGFyYWdyYXBoUm9sZV8xKTtcblxudmFyIFBvcFVwQnV0dG9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFBvcFVwQnV0dG9uUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBQb3BVcEJ1dHRvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFBvcFVwQnV0dG9uUm9sZV8xKTtcblxudmFyIFByZVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBQcmVSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3ByZSdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFByZVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFByZVJvbGVfMSk7XG5cbnZhciBQcmVzZW50YXRpb25hbFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBQcmVzZW50YXRpb25hbFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAncHJlc2VudGF0aW9uJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gUHJlc2VudGF0aW9uYWxSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhQcmVzZW50YXRpb25hbFJvbGVfMSk7XG5cbnZhciBQcm9ncmVzc0luZGljYXRvclJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBQcm9ncmVzc0luZGljYXRvclJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAncHJvZ3Jlc3NiYXInXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3Byb2dyZXNzJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gUHJvZ3Jlc3NJbmRpY2F0b3JSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhQcm9ncmVzc0luZGljYXRvclJvbGVfMSk7XG5cbnZhciBSYWRpb0J1dHRvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBSYWRpb0J1dHRvblJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAncmFkaW8nXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2lucHV0JyxcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICdyYWRpbydcbiAgICAgIH1dXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBSYWRpb0J1dHRvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFJhZGlvQnV0dG9uUm9sZV8xKTtcblxudmFyIFJhZGlvR3JvdXBSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgUmFkaW9Hcm91cFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAncmFkaW9ncm91cCdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFJhZGlvR3JvdXBSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhSYWRpb0dyb3VwUm9sZV8xKTtcblxudmFyIFJlZ2lvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBSZWdpb25Sb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3JlZ2lvbidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFJlZ2lvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFJlZ2lvblJvbGVfMSk7XG5cbnZhciBSb290V2ViQXJlYVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBSb290V2ViQXJlYVJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gUm9vdFdlYkFyZWFSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhSb290V2ViQXJlYVJvbGVfMSk7XG5cbnZhciBSb3dIZWFkZXJSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgUm93SGVhZGVyUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdyb3doZWFkZXInXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3RoJyxcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICdzY29wZScsXG4gICAgICAgIHZhbHVlOiAncm93J1xuICAgICAgfV1cbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IFJvd0hlYWRlclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFJvd0hlYWRlclJvbGVfMSk7XG5cbnZhciBSb3dSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgUm93Um9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdyb3cnXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3RyJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gUm93Um9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoUm93Um9sZV8xKTtcblxudmFyIFJ1YnlSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgUnVieVJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAncnVieSdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFJ1YnlSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhSdWJ5Um9sZV8xKTtcblxudmFyIFJ1bGVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFJ1bGVyUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBSdWxlclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFJ1bGVyUm9sZV8xKTtcblxudmFyIFNjcm9sbEFyZWFSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgU2Nyb2xsQXJlYVJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gU2Nyb2xsQXJlYVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFNjcm9sbEFyZWFSb2xlXzEpO1xuXG52YXIgU2Nyb2xsQmFyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFNjcm9sbEJhclJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnc2Nyb2xsYmFyJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICd3aWRnZXQnXG59O1xudmFyIF9kZWZhdWx0ID0gU2Nyb2xsQmFyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoU2Nyb2xsQmFyUm9sZV8xKTtcblxudmFyIFNlYW1sZXNzV2ViQXJlYVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBTZWFtbGVzc1dlYkFyZWFSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFNlYW1sZXNzV2ViQXJlYVJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFNlYW1sZXNzV2ViQXJlYVJvbGVfMSk7XG5cbnZhciBTZWFyY2hSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgU2VhcmNoUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdzZWFyY2gnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBTZWFyY2hSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhTZWFyY2hSb2xlXzEpO1xuXG52YXIgU2VhcmNoQm94Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFNlYXJjaEJveFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnc2VhcmNoYm94J1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpbnB1dCcsXG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAnc2VhcmNoJ1xuICAgICAgfV1cbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IFNlYXJjaEJveFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFNlYXJjaEJveFJvbGVfMSk7XG5cbnZhciBTbGlkZXJSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgU2xpZGVyUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdzbGlkZXInXG4gICAgfVxuICB9LCB7XG4gICAgbW9kdWxlOiAnSFRNTCcsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ2lucHV0JyxcbiAgICAgIGF0dHJpYnV0ZXM6IFt7XG4gICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgdmFsdWU6ICdyYW5nZSdcbiAgICAgIH1dXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBTbGlkZXJSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhTbGlkZXJSb2xlXzEpO1xuXG52YXIgU2xpZGVyVGh1bWJSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgU2xpZGVyVGh1bWJSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFNsaWRlclRodW1iUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoU2xpZGVyVGh1bWJSb2xlXzEpO1xuXG52YXIgU3BpbkJ1dHRvblJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBTcGluQnV0dG9uUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdzcGluYnV0dG9uJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpbnB1dCcsXG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAnbnVtYmVyJ1xuICAgICAgfV1cbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IFNwaW5CdXR0b25Sb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhTcGluQnV0dG9uUm9sZV8xKTtcblxudmFyIFNwaW5CdXR0b25QYXJ0Um9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFNwaW5CdXR0b25QYXJ0Um9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBTcGluQnV0dG9uUGFydFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFNwaW5CdXR0b25QYXJ0Um9sZV8xKTtcblxudmFyIFNwbGl0dGVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFNwbGl0dGVyUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdzZXBhcmF0b3InXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBTcGxpdHRlclJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFNwbGl0dGVyUm9sZV8xKTtcblxudmFyIFN0YXRpY1RleHRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgU3RhdGljVGV4dFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gU3RhdGljVGV4dFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFN0YXRpY1RleHRSb2xlXzEpO1xuXG52YXIgU3RhdHVzUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFN0YXR1c1JvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnc3RhdHVzJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gU3RhdHVzUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoU3RhdHVzUm9sZV8xKTtcblxudmFyIFNWR1Jvb3RSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgU1ZHUm9vdFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW10sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gU1ZHUm9vdFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFNWR1Jvb3RSb2xlXzEpO1xuXG52YXIgU3dpdGNoUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFN3aXRjaFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnc3dpdGNoJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpbnB1dCcsXG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgIHZhbHVlOiAnY2hlY2tib3gnXG4gICAgICB9XVxuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICd3aWRnZXQnXG59O1xudmFyIF9kZWZhdWx0ID0gU3dpdGNoUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoU3dpdGNoUm9sZV8xKTtcblxudmFyIFRhYkdyb3VwUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFRhYkdyb3VwUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0YWJsaXN0J1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gVGFiR3JvdXBSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhUYWJHcm91cFJvbGVfMSk7XG5cbnZhciBUYWJSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgVGFiUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0YWInXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBUYWJSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhUYWJSb2xlXzEpO1xuXG52YXIgVGFibGVIZWFkZXJDb250YWluZXJSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgVGFibGVIZWFkZXJDb250YWluZXJSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFtdLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFRhYmxlSGVhZGVyQ29udGFpbmVyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoVGFibGVIZWFkZXJDb250YWluZXJSb2xlXzEpO1xuXG52YXIgVGFibGVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgVGFibGVSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3RhYmxlJ1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0YWJsZSdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFRhYmxlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoVGFibGVSb2xlXzEpO1xuXG52YXIgVGFiTGlzdFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBUYWJMaXN0Um9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0YWJsaXN0J1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gVGFiTGlzdFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFRhYkxpc3RSb2xlXzEpO1xuXG52YXIgVGFiUGFuZWxSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgVGFiUGFuZWxSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3RhYnBhbmVsJ1xuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICdzdHJ1Y3R1cmUnXG59O1xudmFyIF9kZWZhdWx0ID0gVGFiUGFuZWxSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhUYWJQYW5lbFJvbGVfMSk7XG5cbnZhciBUZXJtUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFRlcm1Sb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3Rlcm0nXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBUZXJtUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoVGVybVJvbGVfMSk7XG5cbnZhciBUZXh0RmllbGRSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgVGV4dEZpZWxkUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0ZXh0Ym94J1xuICAgIH1cbiAgfSwge1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICdpbnB1dCdcbiAgICB9XG4gIH0sIHtcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAnaW5wdXQnLFxuICAgICAgYXR0cmlidXRlczogW3tcbiAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICB2YWx1ZTogJ3RleHQnXG4gICAgICB9XVxuICAgIH1cbiAgfV0sXG4gIHR5cGU6ICd3aWRnZXQnXG59O1xudmFyIF9kZWZhdWx0ID0gVGV4dEZpZWxkUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoVGV4dEZpZWxkUm9sZV8xKTtcblxudmFyIFRpbWVSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgVGltZVJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdIVE1MJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndGltZSdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFRpbWVSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhUaW1lUm9sZV8xKTtcblxudmFyIFRpbWVyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFRpbWVyUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0aW1lcidcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnc3RydWN0dXJlJ1xufTtcbnZhciBfZGVmYXVsdCA9IFRpbWVyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoVGltZXJSb2xlXzEpO1xuXG52YXIgVG9nZ2xlQnV0dG9uUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFRvZ2dsZUJ1dHRvblJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBhdHRyaWJ1dGVzOiBbe1xuICAgICAgICBuYW1lOiAnYXJpYS1wcmVzc2VkJ1xuICAgICAgfV1cbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IFRvZ2dsZUJ1dHRvblJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFRvZ2dsZUJ1dHRvblJvbGVfMSk7XG5cbnZhciBUb29sYmFyUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFRvb2xiYXJSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3Rvb2xiYXInXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBUb29sYmFyUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoVG9vbGJhclJvbGVfMSk7XG5cbnZhciBUcmVlUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFRyZWVSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3RyZWUnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBUcmVlUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoVHJlZVJvbGVfMSk7XG5cbnZhciBUcmVlR3JpZFJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBUcmVlR3JpZFJvbGUgPSB7XG4gIHJlbGF0ZWRDb25jZXB0czogW3tcbiAgICBtb2R1bGU6ICdBUklBJyxcbiAgICBjb25jZXB0OiB7XG4gICAgICBuYW1lOiAndHJlZWdyaWQnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3dpZGdldCdcbn07XG52YXIgX2RlZmF1bHQgPSBUcmVlR3JpZFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFRyZWVHcmlkUm9sZV8xKTtcblxudmFyIFRyZWVJdGVtUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFRyZWVJdGVtUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0FSSUEnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd0cmVlaXRlbSdcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IFRyZWVJdGVtUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoVHJlZUl0ZW1Sb2xlXzEpO1xuXG52YXIgVXNlckludGVyZmFjZVRvb2x0aXBSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgVXNlckludGVyZmFjZVRvb2x0aXBSb2xlID0ge1xuICByZWxhdGVkQ29uY2VwdHM6IFt7XG4gICAgbW9kdWxlOiAnQVJJQScsXG4gICAgY29uY2VwdDoge1xuICAgICAgbmFtZTogJ3Rvb2x0aXAnXG4gICAgfVxuICB9XSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBVc2VySW50ZXJmYWNlVG9vbHRpcFJvbGU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKFVzZXJJbnRlcmZhY2VUb29sdGlwUm9sZV8xKTtcblxudmFyIFZpZGVvUm9sZV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIFZpZGVvUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbe1xuICAgIG1vZHVsZTogJ0hUTUwnLFxuICAgIGNvbmNlcHQ6IHtcbiAgICAgIG5hbWU6ICd2aWRlbydcbiAgICB9XG4gIH1dLFxuICB0eXBlOiAnd2lkZ2V0J1xufTtcbnZhciBfZGVmYXVsdCA9IFZpZGVvUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoVmlkZW9Sb2xlXzEpO1xuXG52YXIgV2ViQXJlYVJvbGVfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBXZWJBcmVhUm9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgdHlwZTogJ3N0cnVjdHVyZSdcbn07XG52YXIgX2RlZmF1bHQgPSBXZWJBcmVhUm9sZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoV2ViQXJlYVJvbGVfMSk7XG5cbnZhciBXaW5kb3dSb2xlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgV2luZG93Um9sZSA9IHtcbiAgcmVsYXRlZENvbmNlcHRzOiBbXSxcbiAgdHlwZTogJ3dpbmRvdydcbn07XG52YXIgX2RlZmF1bHQgPSBXaW5kb3dSb2xlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhXaW5kb3dSb2xlXzEpO1xuXG52YXIgQVhPYmplY3RzTWFwXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfQWJiclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEFiYnJSb2xlXzEpO1xuXG52YXIgX0FsZXJ0RGlhbG9nUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQWxlcnREaWFsb2dSb2xlXzEpO1xuXG52YXIgX0FsZXJ0Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQWxlcnRSb2xlXzEpO1xuXG52YXIgX0Fubm90YXRpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChBbm5vdGF0aW9uUm9sZV8xKTtcblxudmFyIF9BcHBsaWNhdGlvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEFwcGxpY2F0aW9uUm9sZV8xKTtcblxudmFyIF9BcnRpY2xlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQXJ0aWNsZVJvbGVfMSk7XG5cbnZhciBfQXVkaW9Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChBdWRpb1JvbGVfMSk7XG5cbnZhciBfQmFubmVyUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQmFubmVyUm9sZV8xKTtcblxudmFyIF9CbG9ja3F1b3RlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQmxvY2txdW90ZVJvbGVfMSk7XG5cbnZhciBfQnVzeUluZGljYXRvclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEJ1c3lJbmRpY2F0b3JSb2xlXzEpO1xuXG52YXIgX0J1dHRvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEJ1dHRvblJvbGVfMSk7XG5cbnZhciBfQ2FudmFzUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQ2FudmFzUm9sZV8xKTtcblxudmFyIF9DYXB0aW9uUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQ2FwdGlvblJvbGVfMSk7XG5cbnZhciBfQ2VsbFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KENlbGxSb2xlXzEpO1xuXG52YXIgX0NoZWNrQm94Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQ2hlY2tCb3hSb2xlXzEpO1xuXG52YXIgX0NvbG9yV2VsbFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KENvbG9yV2VsbFJvbGVfMSk7XG5cbnZhciBfQ29sdW1uSGVhZGVyUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQ29sdW1uSGVhZGVyUm9sZV8xKTtcblxudmFyIF9Db2x1bW5Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChDb2x1bW5Sb2xlXzEpO1xuXG52YXIgX0NvbWJvQm94Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQ29tYm9Cb3hSb2xlXzEpO1xuXG52YXIgX0NvbXBsZW1lbnRhcnlSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChDb21wbGVtZW50YXJ5Um9sZV8xKTtcblxudmFyIF9Db250ZW50SW5mb1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KENvbnRlbnRJbmZvUm9sZV8xKTtcblxudmFyIF9EYXRlUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoRGF0ZVJvbGVfMSk7XG5cbnZhciBfRGF0ZVRpbWVSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChEYXRlVGltZVJvbGVfMSk7XG5cbnZhciBfRGVmaW5pdGlvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KERlZmluaXRpb25Sb2xlXzEpO1xuXG52YXIgX0Rlc2NyaXB0aW9uTGlzdERldGFpbFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KERlc2NyaXB0aW9uTGlzdERldGFpbFJvbGVfMSk7XG5cbnZhciBfRGVzY3JpcHRpb25MaXN0Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoRGVzY3JpcHRpb25MaXN0Um9sZV8xKTtcblxudmFyIF9EZXNjcmlwdGlvbkxpc3RUZXJtUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoRGVzY3JpcHRpb25MaXN0VGVybVJvbGVfMSk7XG5cbnZhciBfRGV0YWlsc1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KERldGFpbHNSb2xlXzEpO1xuXG52YXIgX0RpYWxvZ1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KERpYWxvZ1JvbGVfMSk7XG5cbnZhciBfRGlyZWN0b3J5Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoRGlyZWN0b3J5Um9sZV8xKTtcblxudmFyIF9EaXNjbG9zdXJlVHJpYW5nbGVSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChEaXNjbG9zdXJlVHJpYW5nbGVSb2xlXzEpO1xuXG52YXIgX0RpdlJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KERpdlJvbGVfMSk7XG5cbnZhciBfRG9jdW1lbnRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChEb2N1bWVudFJvbGVfMSk7XG5cbnZhciBfRW1iZWRkZWRPYmplY3RSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChFbWJlZGRlZE9iamVjdFJvbGVfMSk7XG5cbnZhciBfRmVlZFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEZlZWRSb2xlXzEpO1xuXG52YXIgX0ZpZ2NhcHRpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChGaWdjYXB0aW9uUm9sZV8xKTtcblxudmFyIF9GaWd1cmVSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChGaWd1cmVSb2xlXzEpO1xuXG52YXIgX0Zvb3RlclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEZvb3RlclJvbGVfMSk7XG5cbnZhciBfRm9ybVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEZvcm1Sb2xlXzEpO1xuXG52YXIgX0dyaWRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChHcmlkUm9sZV8xKTtcblxudmFyIF9Hcm91cFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEdyb3VwUm9sZV8xKTtcblxudmFyIF9IZWFkaW5nUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoSGVhZGluZ1JvbGVfMSk7XG5cbnZhciBfSWZyYW1lUHJlc2VudGF0aW9uYWxSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChJZnJhbWVQcmVzZW50YXRpb25hbFJvbGVfMSk7XG5cbnZhciBfSWZyYW1lUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoSWZyYW1lUm9sZV8xKTtcblxudmFyIF9JZ25vcmVkUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoSWdub3JlZFJvbGVfMSk7XG5cbnZhciBfSW1hZ2VNYXBMaW5rUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoSW1hZ2VNYXBMaW5rUm9sZV8xKTtcblxudmFyIF9JbWFnZU1hcFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEltYWdlTWFwUm9sZV8xKTtcblxudmFyIF9JbWFnZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEltYWdlUm9sZV8xKTtcblxudmFyIF9JbmxpbmVUZXh0Qm94Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoSW5saW5lVGV4dEJveFJvbGVfMSk7XG5cbnZhciBfSW5wdXRUaW1lUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoSW5wdXRUaW1lUm9sZV8xKTtcblxudmFyIF9MYWJlbFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KExhYmVsUm9sZV8xKTtcblxudmFyIF9MZWdlbmRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChMZWdlbmRSb2xlXzEpO1xuXG52YXIgX0xpbmVCcmVha1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KExpbmVCcmVha1JvbGVfMSk7XG5cbnZhciBfTGlua1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KExpbmtSb2xlXzEpO1xuXG52YXIgX0xpc3RCb3hPcHRpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChMaXN0Qm94T3B0aW9uUm9sZV8xKTtcblxudmFyIF9MaXN0Qm94Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoTGlzdEJveFJvbGVfMSk7XG5cbnZhciBfTGlzdEl0ZW1Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChMaXN0SXRlbVJvbGVfMSk7XG5cbnZhciBfTGlzdE1hcmtlclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KExpc3RNYXJrZXJSb2xlXzEpO1xuXG52YXIgX0xpc3RSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChMaXN0Um9sZV8xKTtcblxudmFyIF9Mb2dSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChMb2dSb2xlXzEpO1xuXG52YXIgX01haW5Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChNYWluUm9sZV8xKTtcblxudmFyIF9NYXJrUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoTWFya1JvbGVfMSk7XG5cbnZhciBfTWFycXVlZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KE1hcnF1ZWVSb2xlXzEpO1xuXG52YXIgX01hdGhSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChNYXRoUm9sZV8xKTtcblxudmFyIF9NZW51QmFyUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoTWVudUJhclJvbGVfMSk7XG5cbnZhciBfTWVudUJ1dHRvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KE1lbnVCdXR0b25Sb2xlXzEpO1xuXG52YXIgX01lbnVJdGVtUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoTWVudUl0ZW1Sb2xlXzEpO1xuXG52YXIgX01lbnVJdGVtQ2hlY2tCb3hSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChNZW51SXRlbUNoZWNrQm94Um9sZV8xKTtcblxudmFyIF9NZW51SXRlbVJhZGlvUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoTWVudUl0ZW1SYWRpb1JvbGVfMSk7XG5cbnZhciBfTWVudUxpc3RPcHRpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChNZW51TGlzdE9wdGlvblJvbGVfMSk7XG5cbnZhciBfTWVudUxpc3RQb3B1cFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KE1lbnVMaXN0UG9wdXBSb2xlXzEpO1xuXG52YXIgX01lbnVSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChNZW51Um9sZV8xKTtcblxudmFyIF9NZXRlclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KE1ldGVyUm9sZV8xKTtcblxudmFyIF9OYXZpZ2F0aW9uUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoTmF2aWdhdGlvblJvbGVfMSk7XG5cbnZhciBfTm9uZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KE5vbmVSb2xlXzEpO1xuXG52YXIgX05vdGVSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChOb3RlUm9sZV8xKTtcblxudmFyIF9PdXRsaW5lUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoT3V0bGluZVJvbGVfMSk7XG5cbnZhciBfUGFyYWdyYXBoUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoUGFyYWdyYXBoUm9sZV8xKTtcblxudmFyIF9Qb3BVcEJ1dHRvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFBvcFVwQnV0dG9uUm9sZV8xKTtcblxudmFyIF9QcmVSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChQcmVSb2xlXzEpO1xuXG52YXIgX1ByZXNlbnRhdGlvbmFsUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoUHJlc2VudGF0aW9uYWxSb2xlXzEpO1xuXG52YXIgX1Byb2dyZXNzSW5kaWNhdG9yUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoUHJvZ3Jlc3NJbmRpY2F0b3JSb2xlXzEpO1xuXG52YXIgX1JhZGlvQnV0dG9uUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoUmFkaW9CdXR0b25Sb2xlXzEpO1xuXG52YXIgX1JhZGlvR3JvdXBSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChSYWRpb0dyb3VwUm9sZV8xKTtcblxudmFyIF9SZWdpb25Sb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChSZWdpb25Sb2xlXzEpO1xuXG52YXIgX1Jvb3RXZWJBcmVhUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoUm9vdFdlYkFyZWFSb2xlXzEpO1xuXG52YXIgX1Jvd0hlYWRlclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFJvd0hlYWRlclJvbGVfMSk7XG5cbnZhciBfUm93Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoUm93Um9sZV8xKTtcblxudmFyIF9SdWJ5Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoUnVieVJvbGVfMSk7XG5cbnZhciBfUnVsZXJSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChSdWxlclJvbGVfMSk7XG5cbnZhciBfU2Nyb2xsQXJlYVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFNjcm9sbEFyZWFSb2xlXzEpO1xuXG52YXIgX1Njcm9sbEJhclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFNjcm9sbEJhclJvbGVfMSk7XG5cbnZhciBfU2VhbWxlc3NXZWJBcmVhUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoU2VhbWxlc3NXZWJBcmVhUm9sZV8xKTtcblxudmFyIF9TZWFyY2hSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChTZWFyY2hSb2xlXzEpO1xuXG52YXIgX1NlYXJjaEJveFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFNlYXJjaEJveFJvbGVfMSk7XG5cbnZhciBfU2xpZGVyUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoU2xpZGVyUm9sZV8xKTtcblxudmFyIF9TbGlkZXJUaHVtYlJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFNsaWRlclRodW1iUm9sZV8xKTtcblxudmFyIF9TcGluQnV0dG9uUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoU3BpbkJ1dHRvblJvbGVfMSk7XG5cbnZhciBfU3BpbkJ1dHRvblBhcnRSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChTcGluQnV0dG9uUGFydFJvbGVfMSk7XG5cbnZhciBfU3BsaXR0ZXJSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChTcGxpdHRlclJvbGVfMSk7XG5cbnZhciBfU3RhdGljVGV4dFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFN0YXRpY1RleHRSb2xlXzEpO1xuXG52YXIgX1N0YXR1c1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFN0YXR1c1JvbGVfMSk7XG5cbnZhciBfU1ZHUm9vdFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFNWR1Jvb3RSb2xlXzEpO1xuXG52YXIgX1N3aXRjaFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFN3aXRjaFJvbGVfMSk7XG5cbnZhciBfVGFiR3JvdXBSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChUYWJHcm91cFJvbGVfMSk7XG5cbnZhciBfVGFiUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoVGFiUm9sZV8xKTtcblxudmFyIF9UYWJsZUhlYWRlckNvbnRhaW5lclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFRhYmxlSGVhZGVyQ29udGFpbmVyUm9sZV8xKTtcblxudmFyIF9UYWJsZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFRhYmxlUm9sZV8xKTtcblxudmFyIF9UYWJMaXN0Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoVGFiTGlzdFJvbGVfMSk7XG5cbnZhciBfVGFiUGFuZWxSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChUYWJQYW5lbFJvbGVfMSk7XG5cbnZhciBfVGVybVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFRlcm1Sb2xlXzEpO1xuXG52YXIgX1RleHRGaWVsZFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFRleHRGaWVsZFJvbGVfMSk7XG5cbnZhciBfVGltZVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFRpbWVSb2xlXzEpO1xuXG52YXIgX1RpbWVyUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoVGltZXJSb2xlXzEpO1xuXG52YXIgX1RvZ2dsZUJ1dHRvblJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFRvZ2dsZUJ1dHRvblJvbGVfMSk7XG5cbnZhciBfVG9vbGJhclJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFRvb2xiYXJSb2xlXzEpO1xuXG52YXIgX1RyZWVSb2xlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChUcmVlUm9sZV8xKTtcblxudmFyIF9UcmVlR3JpZFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFRyZWVHcmlkUm9sZV8xKTtcblxudmFyIF9UcmVlSXRlbVJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFRyZWVJdGVtUm9sZV8xKTtcblxudmFyIF9Vc2VySW50ZXJmYWNlVG9vbHRpcFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFVzZXJJbnRlcmZhY2VUb29sdGlwUm9sZV8xKTtcblxudmFyIF9WaWRlb1JvbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KFZpZGVvUm9sZV8xKTtcblxudmFyIF9XZWJBcmVhUm9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoV2ViQXJlYVJvbGVfMSk7XG5cbnZhciBfV2luZG93Um9sZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoV2luZG93Um9sZV8xKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH1cblxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTsgfVxuXG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH1cblxuZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9XG5cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9pID0gYXJyID09IG51bGwgPyBudWxsIDogdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBhcnJbU3ltYm9sLml0ZXJhdG9yXSB8fCBhcnJbXCJAQGl0ZXJhdG9yXCJdOyBpZiAoX2kgPT0gbnVsbCkgcmV0dXJuOyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9zLCBfZTsgdHJ5IHsgZm9yIChfaSA9IF9pLmNhbGwoYXJyKTsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbXCJyZXR1cm5cIl0gIT0gbnVsbCkgX2lbXCJyZXR1cm5cIl0oKTsgfSBmaW5hbGx5IHsgaWYgKF9kKSB0aHJvdyBfZTsgfSB9IHJldHVybiBfYXJyOyB9XG5cbmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfVxuXG52YXIgQVhPYmplY3RzID0gW1snQWJiclJvbGUnLCBfQWJiclJvbGUuZGVmYXVsdF0sIFsnQWxlcnREaWFsb2dSb2xlJywgX0FsZXJ0RGlhbG9nUm9sZS5kZWZhdWx0XSwgWydBbGVydFJvbGUnLCBfQWxlcnRSb2xlLmRlZmF1bHRdLCBbJ0Fubm90YXRpb25Sb2xlJywgX0Fubm90YXRpb25Sb2xlLmRlZmF1bHRdLCBbJ0FwcGxpY2F0aW9uUm9sZScsIF9BcHBsaWNhdGlvblJvbGUuZGVmYXVsdF0sIFsnQXJ0aWNsZVJvbGUnLCBfQXJ0aWNsZVJvbGUuZGVmYXVsdF0sIFsnQXVkaW9Sb2xlJywgX0F1ZGlvUm9sZS5kZWZhdWx0XSwgWydCYW5uZXJSb2xlJywgX0Jhbm5lclJvbGUuZGVmYXVsdF0sIFsnQmxvY2txdW90ZVJvbGUnLCBfQmxvY2txdW90ZVJvbGUuZGVmYXVsdF0sIFsnQnVzeUluZGljYXRvclJvbGUnLCBfQnVzeUluZGljYXRvclJvbGUuZGVmYXVsdF0sIFsnQnV0dG9uUm9sZScsIF9CdXR0b25Sb2xlLmRlZmF1bHRdLCBbJ0NhbnZhc1JvbGUnLCBfQ2FudmFzUm9sZS5kZWZhdWx0XSwgWydDYXB0aW9uUm9sZScsIF9DYXB0aW9uUm9sZS5kZWZhdWx0XSwgWydDZWxsUm9sZScsIF9DZWxsUm9sZS5kZWZhdWx0XSwgWydDaGVja0JveFJvbGUnLCBfQ2hlY2tCb3hSb2xlLmRlZmF1bHRdLCBbJ0NvbG9yV2VsbFJvbGUnLCBfQ29sb3JXZWxsUm9sZS5kZWZhdWx0XSwgWydDb2x1bW5IZWFkZXJSb2xlJywgX0NvbHVtbkhlYWRlclJvbGUuZGVmYXVsdF0sIFsnQ29sdW1uUm9sZScsIF9Db2x1bW5Sb2xlLmRlZmF1bHRdLCBbJ0NvbWJvQm94Um9sZScsIF9Db21ib0JveFJvbGUuZGVmYXVsdF0sIFsnQ29tcGxlbWVudGFyeVJvbGUnLCBfQ29tcGxlbWVudGFyeVJvbGUuZGVmYXVsdF0sIFsnQ29udGVudEluZm9Sb2xlJywgX0NvbnRlbnRJbmZvUm9sZS5kZWZhdWx0XSwgWydEYXRlUm9sZScsIF9EYXRlUm9sZS5kZWZhdWx0XSwgWydEYXRlVGltZVJvbGUnLCBfRGF0ZVRpbWVSb2xlLmRlZmF1bHRdLCBbJ0RlZmluaXRpb25Sb2xlJywgX0RlZmluaXRpb25Sb2xlLmRlZmF1bHRdLCBbJ0Rlc2NyaXB0aW9uTGlzdERldGFpbFJvbGUnLCBfRGVzY3JpcHRpb25MaXN0RGV0YWlsUm9sZS5kZWZhdWx0XSwgWydEZXNjcmlwdGlvbkxpc3RSb2xlJywgX0Rlc2NyaXB0aW9uTGlzdFJvbGUuZGVmYXVsdF0sIFsnRGVzY3JpcHRpb25MaXN0VGVybVJvbGUnLCBfRGVzY3JpcHRpb25MaXN0VGVybVJvbGUuZGVmYXVsdF0sIFsnRGV0YWlsc1JvbGUnLCBfRGV0YWlsc1JvbGUuZGVmYXVsdF0sIFsnRGlhbG9nUm9sZScsIF9EaWFsb2dSb2xlLmRlZmF1bHRdLCBbJ0RpcmVjdG9yeVJvbGUnLCBfRGlyZWN0b3J5Um9sZS5kZWZhdWx0XSwgWydEaXNjbG9zdXJlVHJpYW5nbGVSb2xlJywgX0Rpc2Nsb3N1cmVUcmlhbmdsZVJvbGUuZGVmYXVsdF0sIFsnRGl2Um9sZScsIF9EaXZSb2xlLmRlZmF1bHRdLCBbJ0RvY3VtZW50Um9sZScsIF9Eb2N1bWVudFJvbGUuZGVmYXVsdF0sIFsnRW1iZWRkZWRPYmplY3RSb2xlJywgX0VtYmVkZGVkT2JqZWN0Um9sZS5kZWZhdWx0XSwgWydGZWVkUm9sZScsIF9GZWVkUm9sZS5kZWZhdWx0XSwgWydGaWdjYXB0aW9uUm9sZScsIF9GaWdjYXB0aW9uUm9sZS5kZWZhdWx0XSwgWydGaWd1cmVSb2xlJywgX0ZpZ3VyZVJvbGUuZGVmYXVsdF0sIFsnRm9vdGVyUm9sZScsIF9Gb290ZXJSb2xlLmRlZmF1bHRdLCBbJ0Zvcm1Sb2xlJywgX0Zvcm1Sb2xlLmRlZmF1bHRdLCBbJ0dyaWRSb2xlJywgX0dyaWRSb2xlLmRlZmF1bHRdLCBbJ0dyb3VwUm9sZScsIF9Hcm91cFJvbGUuZGVmYXVsdF0sIFsnSGVhZGluZ1JvbGUnLCBfSGVhZGluZ1JvbGUuZGVmYXVsdF0sIFsnSWZyYW1lUHJlc2VudGF0aW9uYWxSb2xlJywgX0lmcmFtZVByZXNlbnRhdGlvbmFsUm9sZS5kZWZhdWx0XSwgWydJZnJhbWVSb2xlJywgX0lmcmFtZVJvbGUuZGVmYXVsdF0sIFsnSWdub3JlZFJvbGUnLCBfSWdub3JlZFJvbGUuZGVmYXVsdF0sIFsnSW1hZ2VNYXBMaW5rUm9sZScsIF9JbWFnZU1hcExpbmtSb2xlLmRlZmF1bHRdLCBbJ0ltYWdlTWFwUm9sZScsIF9JbWFnZU1hcFJvbGUuZGVmYXVsdF0sIFsnSW1hZ2VSb2xlJywgX0ltYWdlUm9sZS5kZWZhdWx0XSwgWydJbmxpbmVUZXh0Qm94Um9sZScsIF9JbmxpbmVUZXh0Qm94Um9sZS5kZWZhdWx0XSwgWydJbnB1dFRpbWVSb2xlJywgX0lucHV0VGltZVJvbGUuZGVmYXVsdF0sIFsnTGFiZWxSb2xlJywgX0xhYmVsUm9sZS5kZWZhdWx0XSwgWydMZWdlbmRSb2xlJywgX0xlZ2VuZFJvbGUuZGVmYXVsdF0sIFsnTGluZUJyZWFrUm9sZScsIF9MaW5lQnJlYWtSb2xlLmRlZmF1bHRdLCBbJ0xpbmtSb2xlJywgX0xpbmtSb2xlLmRlZmF1bHRdLCBbJ0xpc3RCb3hPcHRpb25Sb2xlJywgX0xpc3RCb3hPcHRpb25Sb2xlLmRlZmF1bHRdLCBbJ0xpc3RCb3hSb2xlJywgX0xpc3RCb3hSb2xlLmRlZmF1bHRdLCBbJ0xpc3RJdGVtUm9sZScsIF9MaXN0SXRlbVJvbGUuZGVmYXVsdF0sIFsnTGlzdE1hcmtlclJvbGUnLCBfTGlzdE1hcmtlclJvbGUuZGVmYXVsdF0sIFsnTGlzdFJvbGUnLCBfTGlzdFJvbGUuZGVmYXVsdF0sIFsnTG9nUm9sZScsIF9Mb2dSb2xlLmRlZmF1bHRdLCBbJ01haW5Sb2xlJywgX01haW5Sb2xlLmRlZmF1bHRdLCBbJ01hcmtSb2xlJywgX01hcmtSb2xlLmRlZmF1bHRdLCBbJ01hcnF1ZWVSb2xlJywgX01hcnF1ZWVSb2xlLmRlZmF1bHRdLCBbJ01hdGhSb2xlJywgX01hdGhSb2xlLmRlZmF1bHRdLCBbJ01lbnVCYXJSb2xlJywgX01lbnVCYXJSb2xlLmRlZmF1bHRdLCBbJ01lbnVCdXR0b25Sb2xlJywgX01lbnVCdXR0b25Sb2xlLmRlZmF1bHRdLCBbJ01lbnVJdGVtUm9sZScsIF9NZW51SXRlbVJvbGUuZGVmYXVsdF0sIFsnTWVudUl0ZW1DaGVja0JveFJvbGUnLCBfTWVudUl0ZW1DaGVja0JveFJvbGUuZGVmYXVsdF0sIFsnTWVudUl0ZW1SYWRpb1JvbGUnLCBfTWVudUl0ZW1SYWRpb1JvbGUuZGVmYXVsdF0sIFsnTWVudUxpc3RPcHRpb25Sb2xlJywgX01lbnVMaXN0T3B0aW9uUm9sZS5kZWZhdWx0XSwgWydNZW51TGlzdFBvcHVwUm9sZScsIF9NZW51TGlzdFBvcHVwUm9sZS5kZWZhdWx0XSwgWydNZW51Um9sZScsIF9NZW51Um9sZS5kZWZhdWx0XSwgWydNZXRlclJvbGUnLCBfTWV0ZXJSb2xlLmRlZmF1bHRdLCBbJ05hdmlnYXRpb25Sb2xlJywgX05hdmlnYXRpb25Sb2xlLmRlZmF1bHRdLCBbJ05vbmVSb2xlJywgX05vbmVSb2xlLmRlZmF1bHRdLCBbJ05vdGVSb2xlJywgX05vdGVSb2xlLmRlZmF1bHRdLCBbJ091dGxpbmVSb2xlJywgX091dGxpbmVSb2xlLmRlZmF1bHRdLCBbJ1BhcmFncmFwaFJvbGUnLCBfUGFyYWdyYXBoUm9sZS5kZWZhdWx0XSwgWydQb3BVcEJ1dHRvblJvbGUnLCBfUG9wVXBCdXR0b25Sb2xlLmRlZmF1bHRdLCBbJ1ByZVJvbGUnLCBfUHJlUm9sZS5kZWZhdWx0XSwgWydQcmVzZW50YXRpb25hbFJvbGUnLCBfUHJlc2VudGF0aW9uYWxSb2xlLmRlZmF1bHRdLCBbJ1Byb2dyZXNzSW5kaWNhdG9yUm9sZScsIF9Qcm9ncmVzc0luZGljYXRvclJvbGUuZGVmYXVsdF0sIFsnUmFkaW9CdXR0b25Sb2xlJywgX1JhZGlvQnV0dG9uUm9sZS5kZWZhdWx0XSwgWydSYWRpb0dyb3VwUm9sZScsIF9SYWRpb0dyb3VwUm9sZS5kZWZhdWx0XSwgWydSZWdpb25Sb2xlJywgX1JlZ2lvblJvbGUuZGVmYXVsdF0sIFsnUm9vdFdlYkFyZWFSb2xlJywgX1Jvb3RXZWJBcmVhUm9sZS5kZWZhdWx0XSwgWydSb3dIZWFkZXJSb2xlJywgX1Jvd0hlYWRlclJvbGUuZGVmYXVsdF0sIFsnUm93Um9sZScsIF9Sb3dSb2xlLmRlZmF1bHRdLCBbJ1J1YnlSb2xlJywgX1J1YnlSb2xlLmRlZmF1bHRdLCBbJ1J1bGVyUm9sZScsIF9SdWxlclJvbGUuZGVmYXVsdF0sIFsnU2Nyb2xsQXJlYVJvbGUnLCBfU2Nyb2xsQXJlYVJvbGUuZGVmYXVsdF0sIFsnU2Nyb2xsQmFyUm9sZScsIF9TY3JvbGxCYXJSb2xlLmRlZmF1bHRdLCBbJ1NlYW1sZXNzV2ViQXJlYVJvbGUnLCBfU2VhbWxlc3NXZWJBcmVhUm9sZS5kZWZhdWx0XSwgWydTZWFyY2hSb2xlJywgX1NlYXJjaFJvbGUuZGVmYXVsdF0sIFsnU2VhcmNoQm94Um9sZScsIF9TZWFyY2hCb3hSb2xlLmRlZmF1bHRdLCBbJ1NsaWRlclJvbGUnLCBfU2xpZGVyUm9sZS5kZWZhdWx0XSwgWydTbGlkZXJUaHVtYlJvbGUnLCBfU2xpZGVyVGh1bWJSb2xlLmRlZmF1bHRdLCBbJ1NwaW5CdXR0b25Sb2xlJywgX1NwaW5CdXR0b25Sb2xlLmRlZmF1bHRdLCBbJ1NwaW5CdXR0b25QYXJ0Um9sZScsIF9TcGluQnV0dG9uUGFydFJvbGUuZGVmYXVsdF0sIFsnU3BsaXR0ZXJSb2xlJywgX1NwbGl0dGVyUm9sZS5kZWZhdWx0XSwgWydTdGF0aWNUZXh0Um9sZScsIF9TdGF0aWNUZXh0Um9sZS5kZWZhdWx0XSwgWydTdGF0dXNSb2xlJywgX1N0YXR1c1JvbGUuZGVmYXVsdF0sIFsnU1ZHUm9vdFJvbGUnLCBfU1ZHUm9vdFJvbGUuZGVmYXVsdF0sIFsnU3dpdGNoUm9sZScsIF9Td2l0Y2hSb2xlLmRlZmF1bHRdLCBbJ1RhYkdyb3VwUm9sZScsIF9UYWJHcm91cFJvbGUuZGVmYXVsdF0sIFsnVGFiUm9sZScsIF9UYWJSb2xlLmRlZmF1bHRdLCBbJ1RhYmxlSGVhZGVyQ29udGFpbmVyUm9sZScsIF9UYWJsZUhlYWRlckNvbnRhaW5lclJvbGUuZGVmYXVsdF0sIFsnVGFibGVSb2xlJywgX1RhYmxlUm9sZS5kZWZhdWx0XSwgWydUYWJMaXN0Um9sZScsIF9UYWJMaXN0Um9sZS5kZWZhdWx0XSwgWydUYWJQYW5lbFJvbGUnLCBfVGFiUGFuZWxSb2xlLmRlZmF1bHRdLCBbJ1Rlcm1Sb2xlJywgX1Rlcm1Sb2xlLmRlZmF1bHRdLCBbJ1RleHRGaWVsZFJvbGUnLCBfVGV4dEZpZWxkUm9sZS5kZWZhdWx0XSwgWydUaW1lUm9sZScsIF9UaW1lUm9sZS5kZWZhdWx0XSwgWydUaW1lclJvbGUnLCBfVGltZXJSb2xlLmRlZmF1bHRdLCBbJ1RvZ2dsZUJ1dHRvblJvbGUnLCBfVG9nZ2xlQnV0dG9uUm9sZS5kZWZhdWx0XSwgWydUb29sYmFyUm9sZScsIF9Ub29sYmFyUm9sZS5kZWZhdWx0XSwgWydUcmVlUm9sZScsIF9UcmVlUm9sZS5kZWZhdWx0XSwgWydUcmVlR3JpZFJvbGUnLCBfVHJlZUdyaWRSb2xlLmRlZmF1bHRdLCBbJ1RyZWVJdGVtUm9sZScsIF9UcmVlSXRlbVJvbGUuZGVmYXVsdF0sIFsnVXNlckludGVyZmFjZVRvb2x0aXBSb2xlJywgX1VzZXJJbnRlcmZhY2VUb29sdGlwUm9sZS5kZWZhdWx0XSwgWydWaWRlb1JvbGUnLCBfVmlkZW9Sb2xlLmRlZmF1bHRdLCBbJ1dlYkFyZWFSb2xlJywgX1dlYkFyZWFSb2xlLmRlZmF1bHRdLCBbJ1dpbmRvd1JvbGUnLCBfV2luZG93Um9sZS5kZWZhdWx0XV07XG52YXIgQVhPYmplY3RzTWFwID0ge1xuICBlbnRyaWVzOiBmdW5jdGlvbiBlbnRyaWVzKCkge1xuICAgIHJldHVybiBBWE9iamVjdHM7XG4gIH0sXG4gIGdldDogZnVuY3Rpb24gZ2V0KGtleSkge1xuICAgIHZhciBpdGVtID0gQVhPYmplY3RzLmZpbmQoZnVuY3Rpb24gKHR1cGxlKSB7XG4gICAgICByZXR1cm4gdHVwbGVbMF0gPT09IGtleSA/IHRydWUgOiBmYWxzZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaXRlbSAmJiBpdGVtWzFdO1xuICB9LFxuICBoYXM6IGZ1bmN0aW9uIGhhcyhrZXkpIHtcbiAgICByZXR1cm4gISF0aGlzLmdldChrZXkpO1xuICB9LFxuICBrZXlzOiBmdW5jdGlvbiBrZXlzKCkge1xuICAgIHJldHVybiBBWE9iamVjdHMubWFwKGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAxKSxcbiAgICAgICAgICBrZXkgPSBfcmVmMlswXTtcblxuICAgICAgcmV0dXJuIGtleTtcbiAgICB9KTtcbiAgfSxcbiAgdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoKSB7XG4gICAgcmV0dXJuIEFYT2JqZWN0cy5tYXAoZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgICB2YXIgX3JlZjQgPSBfc2xpY2VkVG9BcnJheShfcmVmMywgMiksXG4gICAgICAgICAgdmFsdWVzID0gX3JlZjRbMV07XG5cbiAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgfSk7XG4gIH1cbn07XG52YXIgX2RlZmF1bHQgPSBBWE9iamVjdHNNYXA7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbn0pO1xuXG51bndyYXBFeHBvcnRzKEFYT2JqZWN0c01hcF8xKTtcblxudmFyIEFYT2JqZWN0RWxlbWVudE1hcF8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX0FYT2JqZWN0c01hcCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoQVhPYmplY3RzTWFwXzEpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsgfVxuXG5mdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpOyB9XG5cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9pID0gYXJyID09IG51bGwgPyBudWxsIDogdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBhcnJbU3ltYm9sLml0ZXJhdG9yXSB8fCBhcnJbXCJAQGl0ZXJhdG9yXCJdOyBpZiAoX2kgPT0gbnVsbCkgcmV0dXJuOyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9zLCBfZTsgdHJ5IHsgZm9yIChfaSA9IF9pLmNhbGwoYXJyKTsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbXCJyZXR1cm5cIl0gIT0gbnVsbCkgX2lbXCJyZXR1cm5cIl0oKTsgfSBmaW5hbGx5IHsgaWYgKF9kKSB0aHJvdyBfZTsgfSB9IHJldHVybiBfYXJyOyB9XG5cbmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfVxuXG5mdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihvLCBhbGxvd0FycmF5TGlrZSkgeyB2YXIgaXQgPSB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSB8fCBvW1wiQEBpdGVyYXRvclwiXTsgaWYgKCFpdCkgeyBpZiAoQXJyYXkuaXNBcnJheShvKSB8fCAoaXQgPSBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobykpIHx8IGFsbG93QXJyYXlMaWtlICYmIG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSB7IGlmIChpdCkgbyA9IGl0OyB2YXIgaSA9IDA7IHZhciBGID0gZnVuY3Rpb24gRigpIHt9OyByZXR1cm4geyBzOiBGLCBuOiBmdW5jdGlvbiBuKCkgeyBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHsgZG9uZTogdHJ1ZSB9OyByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IG9baSsrXSB9OyB9LCBlOiBmdW5jdGlvbiBlKF9lMikgeyB0aHJvdyBfZTI7IH0sIGY6IEYgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7IH0gdmFyIG5vcm1hbENvbXBsZXRpb24gPSB0cnVlLCBkaWRFcnIgPSBmYWxzZSwgZXJyOyByZXR1cm4geyBzOiBmdW5jdGlvbiBzKCkgeyBpdCA9IGl0LmNhbGwobyk7IH0sIG46IGZ1bmN0aW9uIG4oKSB7IHZhciBzdGVwID0gaXQubmV4dCgpOyBub3JtYWxDb21wbGV0aW9uID0gc3RlcC5kb25lOyByZXR1cm4gc3RlcDsgfSwgZTogZnVuY3Rpb24gZShfZTMpIHsgZGlkRXJyID0gdHJ1ZTsgZXJyID0gX2UzOyB9LCBmOiBmdW5jdGlvbiBmKCkgeyB0cnkgeyBpZiAoIW5vcm1hbENvbXBsZXRpb24gJiYgaXQucmV0dXJuICE9IG51bGwpIGl0LnJldHVybigpOyB9IGZpbmFsbHkgeyBpZiAoZGlkRXJyKSB0aHJvdyBlcnI7IH0gfSB9OyB9XG5cbmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfVxuXG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH1cblxudmFyIEFYT2JqZWN0RWxlbWVudHMgPSBbXTtcblxudmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKF9BWE9iamVjdHNNYXAuZGVmYXVsdC5lbnRyaWVzKCkpLFxuICAgIF9zdGVwO1xuXG50cnkge1xuICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHtcbiAgICB2YXIgX3N0ZXAkdmFsdWUgPSBfc2xpY2VkVG9BcnJheShfc3RlcC52YWx1ZSwgMiksXG4gICAgICAgIG5hbWUgPSBfc3RlcCR2YWx1ZVswXSxcbiAgICAgICAgZGVmID0gX3N0ZXAkdmFsdWVbMV07XG5cbiAgICB2YXIgcmVsYXRlZENvbmNlcHRzID0gZGVmLnJlbGF0ZWRDb25jZXB0cztcblxuICAgIGlmIChBcnJheS5pc0FycmF5KHJlbGF0ZWRDb25jZXB0cykpIHtcbiAgICAgIHJlbGF0ZWRDb25jZXB0cy5mb3JFYWNoKGZ1bmN0aW9uIChyZWxhdGlvbikge1xuICAgICAgICBpZiAocmVsYXRpb24ubW9kdWxlID09PSAnSFRNTCcpIHtcbiAgICAgICAgICB2YXIgY29uY2VwdCA9IHJlbGF0aW9uLmNvbmNlcHQ7XG5cbiAgICAgICAgICBpZiAoY29uY2VwdCkge1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gQVhPYmplY3RFbGVtZW50cy5maW5kSW5kZXgoZnVuY3Rpb24gKF9yZWY1KSB7XG4gICAgICAgICAgICAgIHZhciBfcmVmNiA9IF9zbGljZWRUb0FycmF5KF9yZWY1LCAxKSxcbiAgICAgICAgICAgICAgICAgIGtleSA9IF9yZWY2WzBdO1xuXG4gICAgICAgICAgICAgIHJldHVybiBrZXkgPT09IG5hbWU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICBBWE9iamVjdEVsZW1lbnRzLnB1c2goW25hbWUsIFtdXSk7XG4gICAgICAgICAgICAgIGluZGV4ID0gQVhPYmplY3RFbGVtZW50cy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBBWE9iamVjdEVsZW1lbnRzW2luZGV4XVsxXS5wdXNoKGNvbmNlcHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7XG4gICAgX2xvb3AoKTtcbiAgfVxufSBjYXRjaCAoZXJyKSB7XG4gIF9pdGVyYXRvci5lKGVycik7XG59IGZpbmFsbHkge1xuICBfaXRlcmF0b3IuZigpO1xufVxuXG52YXIgQVhPYmplY3RFbGVtZW50TWFwID0ge1xuICBlbnRyaWVzOiBmdW5jdGlvbiBlbnRyaWVzKCkge1xuICAgIHJldHVybiBBWE9iamVjdEVsZW1lbnRzO1xuICB9LFxuICBnZXQ6IGZ1bmN0aW9uIGdldChrZXkpIHtcbiAgICB2YXIgaXRlbSA9IEFYT2JqZWN0RWxlbWVudHMuZmluZChmdW5jdGlvbiAodHVwbGUpIHtcbiAgICAgIHJldHVybiB0dXBsZVswXSA9PT0ga2V5ID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH0pO1xuICAgIHJldHVybiBpdGVtICYmIGl0ZW1bMV07XG4gIH0sXG4gIGhhczogZnVuY3Rpb24gaGFzKGtleSkge1xuICAgIHJldHVybiAhIXRoaXMuZ2V0KGtleSk7XG4gIH0sXG4gIGtleXM6IGZ1bmN0aW9uIGtleXMoKSB7XG4gICAgcmV0dXJuIEFYT2JqZWN0RWxlbWVudHMubWFwKGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAxKSxcbiAgICAgICAgICBrZXkgPSBfcmVmMlswXTtcblxuICAgICAgcmV0dXJuIGtleTtcbiAgICB9KTtcbiAgfSxcbiAgdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoKSB7XG4gICAgcmV0dXJuIEFYT2JqZWN0RWxlbWVudHMubWFwKGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgdmFyIF9yZWY0ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjMsIDIpLFxuICAgICAgICAgIHZhbHVlcyA9IF9yZWY0WzFdO1xuXG4gICAgICByZXR1cm4gdmFsdWVzO1xuICAgIH0pO1xuICB9XG59O1xudmFyIF9kZWZhdWx0ID0gQVhPYmplY3RFbGVtZW50TWFwO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG59KTtcblxudW53cmFwRXhwb3J0cyhBWE9iamVjdEVsZW1lbnRNYXBfMSk7XG5cbnZhciBBWE9iamVjdFJvbGVNYXBfMSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9BWE9iamVjdHNNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEFYT2JqZWN0c01hcF8xKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH1cblxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTsgfVxuXG5mdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7IHZhciBfaSA9IGFyciA9PSBudWxsID8gbnVsbCA6IHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgYXJyW1N5bWJvbC5pdGVyYXRvcl0gfHwgYXJyW1wiQEBpdGVyYXRvclwiXTsgaWYgKF9pID09IG51bGwpIHJldHVybjsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfcywgX2U7IHRyeSB7IGZvciAoX2kgPSBfaS5jYWxsKGFycik7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsgX2Fyci5wdXNoKF9zLnZhbHVlKTsgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOyB9IH0gY2F0Y2ggKGVycikgeyBfZCA9IHRydWU7IF9lID0gZXJyOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIV9uICYmIF9pW1wicmV0dXJuXCJdICE9IG51bGwpIF9pW1wicmV0dXJuXCJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfVxuXG5mdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobywgYWxsb3dBcnJheUxpa2UpIHsgdmFyIGl0ID0gdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0gfHwgb1tcIkBAaXRlcmF0b3JcIl07IGlmICghaXQpIHsgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgeyBpZiAoaXQpIG8gPSBpdDsgdmFyIGkgPSAwOyB2YXIgRiA9IGZ1bmN0aW9uIEYoKSB7fTsgcmV0dXJuIHsgczogRiwgbjogZnVuY3Rpb24gbigpIHsgaWYgKGkgPj0gby5sZW5ndGgpIHJldHVybiB7IGRvbmU6IHRydWUgfTsgcmV0dXJuIHsgZG9uZTogZmFsc2UsIHZhbHVlOiBvW2krK10gfTsgfSwgZTogZnVuY3Rpb24gZShfZTIpIHsgdGhyb3cgX2UyOyB9LCBmOiBGIH07IH0gdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBpdGVyYXRlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpOyB9IHZhciBub3JtYWxDb21wbGV0aW9uID0gdHJ1ZSwgZGlkRXJyID0gZmFsc2UsIGVycjsgcmV0dXJuIHsgczogZnVuY3Rpb24gcygpIHsgaXQgPSBpdC5jYWxsKG8pOyB9LCBuOiBmdW5jdGlvbiBuKCkgeyB2YXIgc3RlcCA9IGl0Lm5leHQoKTsgbm9ybWFsQ29tcGxldGlvbiA9IHN0ZXAuZG9uZTsgcmV0dXJuIHN0ZXA7IH0sIGU6IGZ1bmN0aW9uIGUoX2UzKSB7IGRpZEVyciA9IHRydWU7IGVyciA9IF9lMzsgfSwgZjogZnVuY3Rpb24gZigpIHsgdHJ5IHsgaWYgKCFub3JtYWxDb21wbGV0aW9uICYmIGl0LnJldHVybiAhPSBudWxsKSBpdC5yZXR1cm4oKTsgfSBmaW5hbGx5IHsgaWYgKGRpZEVycikgdGhyb3cgZXJyOyB9IH0gfTsgfVxuXG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH1cblxuZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9XG5cbnZhciBBWE9iamVjdFJvbGVFbGVtZW50cyA9IFtdO1xuXG52YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoX0FYT2JqZWN0c01hcC5kZWZhdWx0LmVudHJpZXMoKSksXG4gICAgX3N0ZXA7XG5cbnRyeSB7XG4gIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKCkge1xuICAgIHZhciBfc3RlcCR2YWx1ZSA9IF9zbGljZWRUb0FycmF5KF9zdGVwLnZhbHVlLCAyKSxcbiAgICAgICAgbmFtZSA9IF9zdGVwJHZhbHVlWzBdLFxuICAgICAgICBkZWYgPSBfc3RlcCR2YWx1ZVsxXTtcblxuICAgIHZhciByZWxhdGVkQ29uY2VwdHMgPSBkZWYucmVsYXRlZENvbmNlcHRzO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkocmVsYXRlZENvbmNlcHRzKSkge1xuICAgICAgcmVsYXRlZENvbmNlcHRzLmZvckVhY2goZnVuY3Rpb24gKHJlbGF0aW9uKSB7XG4gICAgICAgIGlmIChyZWxhdGlvbi5tb2R1bGUgPT09ICdBUklBJykge1xuICAgICAgICAgIHZhciBjb25jZXB0ID0gcmVsYXRpb24uY29uY2VwdDtcblxuICAgICAgICAgIGlmIChjb25jZXB0KSB7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSBBWE9iamVjdFJvbGVFbGVtZW50cy5maW5kSW5kZXgoZnVuY3Rpb24gKF9yZWY1KSB7XG4gICAgICAgICAgICAgIHZhciBfcmVmNiA9IF9zbGljZWRUb0FycmF5KF9yZWY1LCAxKSxcbiAgICAgICAgICAgICAgICAgIGtleSA9IF9yZWY2WzBdO1xuXG4gICAgICAgICAgICAgIHJldHVybiBrZXkgPT09IG5hbWU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICBBWE9iamVjdFJvbGVFbGVtZW50cy5wdXNoKFtuYW1lLCBbXV0pO1xuICAgICAgICAgICAgICBpbmRleCA9IEFYT2JqZWN0Um9sZUVsZW1lbnRzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIEFYT2JqZWN0Um9sZUVsZW1lbnRzW2luZGV4XVsxXS5wdXNoKGNvbmNlcHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7XG4gICAgX2xvb3AoKTtcbiAgfVxufSBjYXRjaCAoZXJyKSB7XG4gIF9pdGVyYXRvci5lKGVycik7XG59IGZpbmFsbHkge1xuICBfaXRlcmF0b3IuZigpO1xufVxuXG52YXIgQVhPYmplY3RSb2xlTWFwID0ge1xuICBlbnRyaWVzOiBmdW5jdGlvbiBlbnRyaWVzKCkge1xuICAgIHJldHVybiBBWE9iamVjdFJvbGVFbGVtZW50cztcbiAgfSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoa2V5KSB7XG4gICAgdmFyIGl0ZW0gPSBBWE9iamVjdFJvbGVFbGVtZW50cy5maW5kKGZ1bmN0aW9uICh0dXBsZSkge1xuICAgICAgcmV0dXJuIHR1cGxlWzBdID09PSBrZXkgPyB0cnVlIDogZmFsc2U7XG4gICAgfSk7XG4gICAgcmV0dXJuIGl0ZW0gJiYgaXRlbVsxXTtcbiAgfSxcbiAgaGFzOiBmdW5jdGlvbiBoYXMoa2V5KSB7XG4gICAgcmV0dXJuICEhdGhpcy5nZXQoa2V5KTtcbiAgfSxcbiAga2V5czogZnVuY3Rpb24ga2V5cygpIHtcbiAgICByZXR1cm4gQVhPYmplY3RSb2xlRWxlbWVudHMubWFwKGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAxKSxcbiAgICAgICAgICBrZXkgPSBfcmVmMlswXTtcblxuICAgICAgcmV0dXJuIGtleTtcbiAgICB9KTtcbiAgfSxcbiAgdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoKSB7XG4gICAgcmV0dXJuIEFYT2JqZWN0Um9sZUVsZW1lbnRzLm1hcChmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgIHZhciBfcmVmNCA9IF9zbGljZWRUb0FycmF5KF9yZWYzLCAyKSxcbiAgICAgICAgICB2YWx1ZXMgPSBfcmVmNFsxXTtcblxuICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICB9KTtcbiAgfVxufTtcbnZhciBfZGVmYXVsdCA9IEFYT2JqZWN0Um9sZU1hcDtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoQVhPYmplY3RSb2xlTWFwXzEpO1xuXG52YXIgZWxlbWVudEFYT2JqZWN0TWFwXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfQVhPYmplY3RzTWFwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChBWE9iamVjdHNNYXBfMSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9XG5cbmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7IH1cblxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyB2YXIgX2kgPSBhcnIgPT0gbnVsbCA/IG51bGwgOiB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGFycltTeW1ib2wuaXRlcmF0b3JdIHx8IGFycltcIkBAaXRlcmF0b3JcIl07IGlmIChfaSA9PSBudWxsKSByZXR1cm47IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX3MsIF9lOyB0cnkgeyBmb3IgKF9pID0gX2kuY2FsbChhcnIpOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVtcInJldHVyblwiXSAhPSBudWxsKSBfaVtcInJldHVyblwiXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH1cblxuZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG8sIGFsbG93QXJyYXlMaWtlKSB7IHZhciBpdCA9IHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdIHx8IG9bXCJAQGl0ZXJhdG9yXCJdOyBpZiAoIWl0KSB7IGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHsgaWYgKGl0KSBvID0gaXQ7IHZhciBpID0gMDsgdmFyIEYgPSBmdW5jdGlvbiBGKCkge307IHJldHVybiB7IHM6IEYsIG46IGZ1bmN0aW9uIG4oKSB7IGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4geyBkb25lOiB0cnVlIH07IHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogb1tpKytdIH07IH0sIGU6IGZ1bmN0aW9uIGUoX2UyKSB7IHRocm93IF9lMjsgfSwgZjogRiB9OyB9IHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTsgfSB2YXIgbm9ybWFsQ29tcGxldGlvbiA9IHRydWUsIGRpZEVyciA9IGZhbHNlLCBlcnI7IHJldHVybiB7IHM6IGZ1bmN0aW9uIHMoKSB7IGl0ID0gaXQuY2FsbChvKTsgfSwgbjogZnVuY3Rpb24gbigpIHsgdmFyIHN0ZXAgPSBpdC5uZXh0KCk7IG5vcm1hbENvbXBsZXRpb24gPSBzdGVwLmRvbmU7IHJldHVybiBzdGVwOyB9LCBlOiBmdW5jdGlvbiBlKF9lMykgeyBkaWRFcnIgPSB0cnVlOyBlcnIgPSBfZTM7IH0sIGY6IGZ1bmN0aW9uIGYoKSB7IHRyeSB7IGlmICghbm9ybWFsQ29tcGxldGlvbiAmJiBpdC5yZXR1cm4gIT0gbnVsbCkgaXQucmV0dXJuKCk7IH0gZmluYWxseSB7IGlmIChkaWRFcnIpIHRocm93IGVycjsgfSB9IH07IH1cblxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9XG5cbmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfVxuXG52YXIgZWxlbWVudEFYT2JqZWN0cyA9IFtdO1xuXG52YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoX0FYT2JqZWN0c01hcC5kZWZhdWx0LmVudHJpZXMoKSksXG4gICAgX3N0ZXA7XG5cbnRyeSB7XG4gIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKCkge1xuICAgIHZhciBfc3RlcCR2YWx1ZSA9IF9zbGljZWRUb0FycmF5KF9zdGVwLnZhbHVlLCAyKSxcbiAgICAgICAgbmFtZSA9IF9zdGVwJHZhbHVlWzBdLFxuICAgICAgICBkZWYgPSBfc3RlcCR2YWx1ZVsxXTtcblxuICAgIHZhciByZWxhdGVkQ29uY2VwdHMgPSBkZWYucmVsYXRlZENvbmNlcHRzO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkocmVsYXRlZENvbmNlcHRzKSkge1xuICAgICAgcmVsYXRlZENvbmNlcHRzLmZvckVhY2goZnVuY3Rpb24gKHJlbGF0aW9uKSB7XG4gICAgICAgIGlmIChyZWxhdGlvbi5tb2R1bGUgPT09ICdIVE1MJykge1xuICAgICAgICAgIHZhciBjb25jZXB0ID0gcmVsYXRpb24uY29uY2VwdDtcblxuICAgICAgICAgIGlmIChjb25jZXB0KSB7XG4gICAgICAgICAgICB2YXIgY29uY2VwdFN0ciA9IEpTT04uc3RyaW5naWZ5KGNvbmNlcHQpO1xuICAgICAgICAgICAgdmFyIGF4T2JqZWN0cztcbiAgICAgICAgICAgIHZhciBpbmRleCA9IDA7XG5cbiAgICAgICAgICAgIGZvciAoOyBpbmRleCA8IGVsZW1lbnRBWE9iamVjdHMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgIHZhciBfa2V5ID0gZWxlbWVudEFYT2JqZWN0c1tpbmRleF1bMF07XG5cbiAgICAgICAgICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KF9rZXkpID09PSBjb25jZXB0U3RyKSB7XG4gICAgICAgICAgICAgICAgYXhPYmplY3RzID0gZWxlbWVudEFYT2JqZWN0c1tpbmRleF1bMV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFheE9iamVjdHMpIHtcbiAgICAgICAgICAgICAgYXhPYmplY3RzID0gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsb2MgPSBheE9iamVjdHMuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgIHJldHVybiBpdGVtID09PSBuYW1lO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChsb2MgPT09IC0xKSB7XG4gICAgICAgICAgICAgIGF4T2JqZWN0cy5wdXNoKG5hbWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaW5kZXggPCBlbGVtZW50QVhPYmplY3RzLmxlbmd0aCkge1xuICAgICAgICAgICAgICBlbGVtZW50QVhPYmplY3RzLnNwbGljZShpbmRleCwgMSwgW2NvbmNlcHQsIGF4T2JqZWN0c10pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZWxlbWVudEFYT2JqZWN0cy5wdXNoKFtjb25jZXB0LCBheE9iamVjdHNdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykge1xuICAgIF9sb29wKCk7XG4gIH1cbn0gY2F0Y2ggKGVycikge1xuICBfaXRlcmF0b3IuZShlcnIpO1xufSBmaW5hbGx5IHtcbiAgX2l0ZXJhdG9yLmYoKTtcbn1cblxudmFyIGVsZW1lbnRBWE9iamVjdE1hcCA9IHtcbiAgZW50cmllczogZnVuY3Rpb24gZW50cmllcygpIHtcbiAgICByZXR1cm4gZWxlbWVudEFYT2JqZWN0cztcbiAgfSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoa2V5KSB7XG4gICAgdmFyIGl0ZW0gPSBlbGVtZW50QVhPYmplY3RzLmZpbmQoZnVuY3Rpb24gKHR1cGxlKSB7XG4gICAgICByZXR1cm4gdHVwbGVbMF0gPT09IGtleSA/IHRydWUgOiBmYWxzZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaXRlbSAmJiBpdGVtWzFdO1xuICB9LFxuICBoYXM6IGZ1bmN0aW9uIGhhcyhrZXkpIHtcbiAgICByZXR1cm4gISF0aGlzLmdldChrZXkpO1xuICB9LFxuICBrZXlzOiBmdW5jdGlvbiBrZXlzKCkge1xuICAgIHJldHVybiBlbGVtZW50QVhPYmplY3RzLm1hcChmdW5jdGlvbiAoX3JlZikge1xuICAgICAgdmFyIF9yZWYyID0gX3NsaWNlZFRvQXJyYXkoX3JlZiwgMSksXG4gICAgICAgICAga2V5ID0gX3JlZjJbMF07XG5cbiAgICAgIHJldHVybiBrZXk7XG4gICAgfSk7XG4gIH0sXG4gIHZhbHVlczogZnVuY3Rpb24gdmFsdWVzKCkge1xuICAgIHJldHVybiBlbGVtZW50QVhPYmplY3RzLm1hcChmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgIHZhciBfcmVmNCA9IF9zbGljZWRUb0FycmF5KF9yZWYzLCAyKSxcbiAgICAgICAgICB2YWx1ZXMgPSBfcmVmNFsxXTtcblxuICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICB9KTtcbiAgfVxufTtcbnZhciBfZGVmYXVsdCA9IGVsZW1lbnRBWE9iamVjdE1hcDtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xufSk7XG5cbnVud3JhcEV4cG9ydHMoZWxlbWVudEFYT2JqZWN0TWFwXzEpO1xuXG52YXIgbGliJDEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmVsZW1lbnRBWE9iamVjdHMgPSBleHBvcnRzLkFYT2JqZWN0cyA9IGV4cG9ydHMuQVhPYmplY3RSb2xlcyA9IGV4cG9ydHMuQVhPYmplY3RFbGVtZW50cyA9IHZvaWQgMDtcblxudmFyIF9BWE9iamVjdEVsZW1lbnRNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEFYT2JqZWN0RWxlbWVudE1hcF8xKTtcblxudmFyIF9BWE9iamVjdFJvbGVNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEFYT2JqZWN0Um9sZU1hcF8xKTtcblxudmFyIF9BWE9iamVjdHNNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KEFYT2JqZWN0c01hcF8xKTtcblxudmFyIF9lbGVtZW50QVhPYmplY3RNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGVsZW1lbnRBWE9iamVjdE1hcF8xKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIEFYT2JqZWN0RWxlbWVudHMgPSBfQVhPYmplY3RFbGVtZW50TWFwLmRlZmF1bHQ7XG5leHBvcnRzLkFYT2JqZWN0RWxlbWVudHMgPSBBWE9iamVjdEVsZW1lbnRzO1xudmFyIEFYT2JqZWN0Um9sZXMgPSBfQVhPYmplY3RSb2xlTWFwLmRlZmF1bHQ7XG5leHBvcnRzLkFYT2JqZWN0Um9sZXMgPSBBWE9iamVjdFJvbGVzO1xudmFyIEFYT2JqZWN0cyA9IF9BWE9iamVjdHNNYXAuZGVmYXVsdDtcbmV4cG9ydHMuQVhPYmplY3RzID0gQVhPYmplY3RzO1xudmFyIGVsZW1lbnRBWE9iamVjdHMgPSBfZWxlbWVudEFYT2JqZWN0TWFwLmRlZmF1bHQ7XG5leHBvcnRzLmVsZW1lbnRBWE9iamVjdHMgPSBlbGVtZW50QVhPYmplY3RzO1xufSk7XG5cbnVud3JhcEV4cG9ydHMobGliJDEpO1xudmFyIGxpYl8xJDEgPSBsaWIkMS5lbGVtZW50QVhPYmplY3RzO1xudmFyIGxpYl8yJDEgPSBsaWIkMS5BWE9iamVjdHM7XG52YXIgbGliXzMkMSA9IGxpYiQxLkFYT2JqZWN0Um9sZXM7XG52YXIgbGliXzQkMSA9IGxpYiQxLkFYT2JqZWN0RWxlbWVudHM7XG5cbmNvbnN0IHJvbGVzID0gWy4uLmxpYl8zLmtleXMoKV07XG5jb25zdCBub25faW50ZXJhY3RpdmVfcm9sZXMgPSBuZXcgU2V0KHJvbGVzXG4gICAgLmZpbHRlcigobmFtZSkgPT4ge1xuICAgIGNvbnN0IHJvbGUgPSBsaWJfMy5nZXQobmFtZSk7XG4gICAgcmV0dXJuICghbGliXzMuZ2V0KG5hbWUpLmFic3RyYWN0ICYmXG4gICAgICAgIC8vICd0b29sYmFyJyBkb2VzIG5vdCBkZXNjZW5kIGZyb20gd2lkZ2V0LCBidXQgaXQgZG9lcyBzdXBwb3J0XG4gICAgICAgIC8vIGFyaWEtYWN0aXZlZGVzY2VuZGFudCwgdGh1cyBpbiBwcmFjdGljZSB3ZSB0cmVhdCBpdCBhcyBhIHdpZGdldC5cbiAgICAgICAgbmFtZSAhPT0gJ3Rvb2xiYXInICYmXG4gICAgICAgICFyb2xlLnN1cGVyQ2xhc3Muc29tZSgoY2xhc3NlcykgPT4gY2xhc3Nlcy5pbmNsdWRlcygnd2lkZ2V0JykpKTtcbn0pXG4gICAgLmNvbmNhdChcbi8vIFRoZSBgcHJvZ3Jlc3NiYXJgIGlzIGRlc2NlbmRlZCBmcm9tIGB3aWRnZXRgLCBidXQgaW4gcHJhY3RpY2UsIGl0c1xuLy8gdmFsdWUgaXMgYWx3YXlzIGByZWFkb25seWAsIHNvIHdlIHRyZWF0IGl0IGFzIGEgbm9uLWludGVyYWN0aXZlIHJvbGUuXG4ncHJvZ3Jlc3NiYXInKSk7XG5jb25zdCBpbnRlcmFjdGl2ZV9yb2xlcyA9IG5ldyBTZXQocm9sZXNcbiAgICAuZmlsdGVyKChuYW1lKSA9PiB7XG4gICAgY29uc3Qgcm9sZSA9IGxpYl8zLmdldChuYW1lKTtcbiAgICByZXR1cm4gKCFyb2xlLmFic3RyYWN0ICYmXG4gICAgICAgIC8vIFRoZSBgcHJvZ3Jlc3NiYXJgIGlzIGRlc2NlbmRlZCBmcm9tIGB3aWRnZXRgLCBidXQgaW4gcHJhY3RpY2UsIGl0c1xuICAgICAgICAvLyB2YWx1ZSBpcyBhbHdheXMgYHJlYWRvbmx5YCwgc28gd2UgdHJlYXQgaXQgYXMgYSBub24taW50ZXJhY3RpdmUgcm9sZS5cbiAgICAgICAgbmFtZSAhPT0gJ3Byb2dyZXNzYmFyJyAmJlxuICAgICAgICByb2xlLnN1cGVyQ2xhc3Muc29tZSgoY2xhc3NlcykgPT4gY2xhc3Nlcy5pbmNsdWRlcygnd2lkZ2V0JykpKTtcbn0pXG4gICAgLmNvbmNhdChcbi8vICd0b29sYmFyJyBkb2VzIG5vdCBkZXNjZW5kIGZyb20gd2lkZ2V0LCBidXQgaXQgZG9lcyBzdXBwb3J0XG4vLyBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQsIHRodXMgaW4gcHJhY3RpY2Ugd2UgdHJlYXQgaXQgYXMgYSB3aWRnZXQuXG4ndG9vbGJhcicpKTtcbmZ1bmN0aW9uIGlzX25vbl9pbnRlcmFjdGl2ZV9yb2xlcyhyb2xlKSB7XG4gICAgcmV0dXJuIG5vbl9pbnRlcmFjdGl2ZV9yb2xlcy5oYXMocm9sZSk7XG59XG5mdW5jdGlvbiBpc19pbnRlcmFjdGl2ZV9yb2xlcyhyb2xlKSB7XG4gICAgcmV0dXJuIGludGVyYWN0aXZlX3JvbGVzLmhhcyhyb2xlKTtcbn1cbmNvbnN0IHByZXNlbnRhdGlvbl9yb2xlcyA9IG5ldyBTZXQoWydwcmVzZW50YXRpb24nLCAnbm9uZSddKTtcbmZ1bmN0aW9uIGlzX3ByZXNlbnRhdGlvbl9yb2xlKHJvbGUpIHtcbiAgICByZXR1cm4gcHJlc2VudGF0aW9uX3JvbGVzLmhhcyhyb2xlKTtcbn1cbmZ1bmN0aW9uIGlzX2hpZGRlbl9mcm9tX3NjcmVlbl9yZWFkZXIodGFnX25hbWUsIGF0dHJpYnV0ZV9tYXApIHtcbiAgICB2YXIgX2E7XG4gICAgaWYgKHRhZ19uYW1lID09PSAnaW5wdXQnKSB7XG4gICAgICAgIGNvbnN0IHR5cGUgPSAoX2EgPSBhdHRyaWJ1dGVfbWFwLmdldCgndHlwZScpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZ2V0X3N0YXRpY192YWx1ZSgpO1xuICAgICAgICBpZiAodHlwZSAmJiB0eXBlID09PSAnaGlkZGVuJykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgYXJpYV9oaWRkZW4gPSBhdHRyaWJ1dGVfbWFwLmdldCgnYXJpYS1oaWRkZW4nKTtcbiAgICBpZiAoIWFyaWFfaGlkZGVuKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgaWYgKCFhcmlhX2hpZGRlbi5pc19zdGF0aWMpXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIGNvbnN0IGFyaWFfaGlkZGVuX3ZhbHVlID0gYXJpYV9oaWRkZW4uZ2V0X3N0YXRpY192YWx1ZSgpO1xuICAgIHJldHVybiBhcmlhX2hpZGRlbl92YWx1ZSA9PT0gdHJ1ZSB8fCBhcmlhX2hpZGRlbl92YWx1ZSA9PT0gJ3RydWUnO1xufVxuY29uc3Qgbm9uX2ludGVyYWN0aXZlX2VsZW1lbnRfcm9sZV9zY2hlbWFzID0gW107XG5saWJfMi5lbnRyaWVzKCkuZm9yRWFjaCgoW3NjaGVtYSwgcm9sZXNdKSA9PiB7XG4gICAgaWYgKFsuLi5yb2xlc10uZXZlcnkoKHJvbGUpID0+IG5vbl9pbnRlcmFjdGl2ZV9yb2xlcy5oYXMocm9sZSkpKSB7XG4gICAgICAgIG5vbl9pbnRlcmFjdGl2ZV9lbGVtZW50X3JvbGVfc2NoZW1hcy5wdXNoKHNjaGVtYSk7XG4gICAgfVxufSk7XG5jb25zdCBpbnRlcmFjdGl2ZV9lbGVtZW50X3JvbGVfc2NoZW1hcyA9IFtdO1xubGliXzIuZW50cmllcygpLmZvckVhY2goKFtzY2hlbWEsIHJvbGVzXSkgPT4ge1xuICAgIGlmIChbLi4ucm9sZXNdLmV2ZXJ5KChyb2xlKSA9PiBpbnRlcmFjdGl2ZV9yb2xlcy5oYXMocm9sZSkpKSB7XG4gICAgICAgIGludGVyYWN0aXZlX2VsZW1lbnRfcm9sZV9zY2hlbWFzLnB1c2goc2NoZW1hKTtcbiAgICB9XG59KTtcbmNvbnN0IGludGVyYWN0aXZlX2F4X29iamVjdHMgPSBuZXcgU2V0KFsuLi5saWJfMiQxLmtleXMoKV0uZmlsdGVyKChuYW1lKSA9PiBsaWJfMiQxLmdldChuYW1lKS50eXBlID09PSAnd2lkZ2V0JykpO1xuY29uc3QgaW50ZXJhY3RpdmVfZWxlbWVudF9heF9vYmplY3Rfc2NoZW1hcyA9IFtdO1xubGliXzEkMS5lbnRyaWVzKCkuZm9yRWFjaCgoW3NjaGVtYSwgYXhfb2JqZWN0XSkgPT4ge1xuICAgIGlmIChbLi4uYXhfb2JqZWN0XS5ldmVyeSgocm9sZSkgPT4gaW50ZXJhY3RpdmVfYXhfb2JqZWN0cy5oYXMocm9sZSkpKSB7XG4gICAgICAgIGludGVyYWN0aXZlX2VsZW1lbnRfYXhfb2JqZWN0X3NjaGVtYXMucHVzaChzY2hlbWEpO1xuICAgIH1cbn0pO1xuZnVuY3Rpb24gbWF0Y2hfc2NoZW1hKHNjaGVtYSwgdGFnX25hbWUsIGF0dHJpYnV0ZV9tYXApIHtcbiAgICBpZiAoc2NoZW1hLm5hbWUgIT09IHRhZ19uYW1lKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgaWYgKCFzY2hlbWEuYXR0cmlidXRlcylcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgcmV0dXJuIHNjaGVtYS5hdHRyaWJ1dGVzLmV2ZXJ5KChzY2hlbWFfYXR0cmlidXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZV9tYXAuZ2V0KHNjaGVtYV9hdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgIGlmICghYXR0cmlidXRlKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoc2NoZW1hX2F0dHJpYnV0ZS52YWx1ZSAmJlxuICAgICAgICAgICAgc2NoZW1hX2F0dHJpYnV0ZS52YWx1ZSAhPT0gYXR0cmlidXRlLmdldF9zdGF0aWNfdmFsdWUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gaXNfaW50ZXJhY3RpdmVfZWxlbWVudCh0YWdfbmFtZSwgYXR0cmlidXRlX21hcCkge1xuICAgIGlmIChpbnRlcmFjdGl2ZV9lbGVtZW50X3JvbGVfc2NoZW1hcy5zb21lKChzY2hlbWEpID0+IG1hdGNoX3NjaGVtYShzY2hlbWEsIHRhZ19uYW1lLCBhdHRyaWJ1dGVfbWFwKSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmIChub25faW50ZXJhY3RpdmVfZWxlbWVudF9yb2xlX3NjaGVtYXMuc29tZSgoc2NoZW1hKSA9PiBtYXRjaF9zY2hlbWEoc2NoZW1hLCB0YWdfbmFtZSwgYXR0cmlidXRlX21hcCkpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGludGVyYWN0aXZlX2VsZW1lbnRfYXhfb2JqZWN0X3NjaGVtYXMuc29tZSgoc2NoZW1hKSA9PiBtYXRjaF9zY2hlbWEoc2NoZW1hLCB0YWdfbmFtZSwgYXR0cmlidXRlX21hcCkpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBpc19zZW1hbnRpY19yb2xlX2VsZW1lbnQocm9sZSwgdGFnX25hbWUsIGF0dHJpYnV0ZV9tYXApIHtcbiAgICBmb3IgKGNvbnN0IFtzY2hlbWEsIGF4X29iamVjdF0gb2YgbGliXzEkMS5lbnRyaWVzKCkpIHtcbiAgICAgICAgaWYgKHNjaGVtYS5uYW1lID09PSB0YWdfbmFtZSAmJiAoIXNjaGVtYS5hdHRyaWJ1dGVzIHx8IHNjaGVtYS5hdHRyaWJ1dGVzLmV2ZXJ5KChhdHRyKSA9PiBhdHRyaWJ1dGVfbWFwLmhhcyhhdHRyLm5hbWUpICYmIGF0dHJpYnV0ZV9tYXAuZ2V0KGF0dHIubmFtZSkuZ2V0X3N0YXRpY192YWx1ZSgpID09PSBhdHRyLnZhbHVlKSkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBheF9vYmplY3QpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByb2xlcyA9IGxpYl8zJDEuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChyb2xlcykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHsgbmFtZSB9IG9mIHJvbGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gcm9sZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuY29uc3QgYXJpYV9hdHRyaWJ1dGVzID0gJ2FjdGl2ZWRlc2NlbmRhbnQgYXRvbWljIGF1dG9jb21wbGV0ZSBidXN5IGNoZWNrZWQgY29sY291bnQgY29saW5kZXggY29sc3BhbiBjb250cm9scyBjdXJyZW50IGRlc2NyaWJlZGJ5IGRlc2NyaXB0aW9uIGRldGFpbHMgZGlzYWJsZWQgZHJvcGVmZmVjdCBlcnJvcm1lc3NhZ2UgZXhwYW5kZWQgZmxvd3RvIGdyYWJiZWQgaGFzcG9wdXAgaGlkZGVuIGludmFsaWQga2V5c2hvcnRjdXRzIGxhYmVsIGxhYmVsbGVkYnkgbGV2ZWwgbGl2ZSBtb2RhbCBtdWx0aWxpbmUgbXVsdGlzZWxlY3RhYmxlIG9yaWVudGF0aW9uIG93bnMgcGxhY2Vob2xkZXIgcG9zaW5zZXQgcHJlc3NlZCByZWFkb25seSByZWxldmFudCByZXF1aXJlZCByb2xlZGVzY3JpcHRpb24gcm93Y291bnQgcm93aW5kZXggcm93c3BhbiBzZWxlY3RlZCBzZXRzaXplIHNvcnQgdmFsdWVtYXggdmFsdWVtaW4gdmFsdWVub3cgdmFsdWV0ZXh0Jy5zcGxpdCgnICcpO1xuY29uc3QgYXJpYV9hdHRyaWJ1dGVfc2V0ID0gbmV3IFNldChhcmlhX2F0dHJpYnV0ZXMpO1xuY29uc3QgYXJpYV9yb2xlcyA9IGxpYl8zLmtleXMoKTtcbmNvbnN0IGFyaWFfcm9sZV9zZXQgPSBuZXcgU2V0KGFyaWFfcm9sZXMpO1xuY29uc3QgYXJpYV9yb2xlX2Fic3RyYWN0X3NldCA9IG5ldyBTZXQobGliXzMua2V5cygpLmZpbHRlcihyb2xlID0+IGxpYl8zLmdldChyb2xlKS5hYnN0cmFjdCkpO1xuY29uc3QgYTExeV9yZXF1aXJlZF9hdHRyaWJ1dGVzID0ge1xuICAgIGE6IFsnaHJlZiddLFxuICAgIGFyZWE6IFsnYWx0JywgJ2FyaWEtbGFiZWwnLCAnYXJpYS1sYWJlbGxlZGJ5J10sXG4gICAgLy8gaHRtbC1oYXMtbGFuZ1xuICAgIGh0bWw6IFsnbGFuZyddLFxuICAgIC8vIGlmcmFtZS1oYXMtdGl0bGVcbiAgICBpZnJhbWU6IFsndGl0bGUnXSxcbiAgICBpbWc6IFsnYWx0J10sXG4gICAgb2JqZWN0OiBbJ3RpdGxlJywgJ2FyaWEtbGFiZWwnLCAnYXJpYS1sYWJlbGxlZGJ5J11cbn07XG5jb25zdCBhMTF5X2Rpc3RyYWN0aW5nX2VsZW1lbnRzID0gbmV3IFNldChbXG4gICAgJ2JsaW5rJyxcbiAgICAnbWFycXVlZSdcbl0pO1xuY29uc3QgYTExeV9yZXF1aXJlZF9jb250ZW50ID0gbmV3IFNldChbXG4gICAgLy8gYW5jaG9yLWhhcy1jb250ZW50XG4gICAgJ2EnLFxuICAgIC8vIGhlYWRpbmctaGFzLWNvbnRlbnRcbiAgICAnaDEnLFxuICAgICdoMicsXG4gICAgJ2gzJyxcbiAgICAnaDQnLFxuICAgICdoNScsXG4gICAgJ2g2J1xuXSk7XG5jb25zdCBhMTF5X2xhYmVsYWJsZSA9IG5ldyBTZXQoW1xuICAgICdidXR0b24nLFxuICAgICdpbnB1dCcsXG4gICAgJ2tleWdlbicsXG4gICAgJ21ldGVyJyxcbiAgICAnb3V0cHV0JyxcbiAgICAncHJvZ3Jlc3MnLFxuICAgICdzZWxlY3QnLFxuICAgICd0ZXh0YXJlYSdcbl0pO1xuY29uc3QgYTExeV9uZXN0ZWRfaW1wbGljaXRfc2VtYW50aWNzID0gbmV3IE1hcChbXG4gICAgWydoZWFkZXInLCAnYmFubmVyJ10sXG4gICAgWydmb290ZXInLCAnY29udGVudGluZm8nXVxuXSk7XG5jb25zdCBhMTF5X2ltcGxpY2l0X3NlbWFudGljcyA9IG5ldyBNYXAoW1xuICAgIFsnYScsICdsaW5rJ10sXG4gICAgWydhc2lkZScsICdjb21wbGVtZW50YXJ5J10sXG4gICAgWydib2R5JywgJ2RvY3VtZW50J10sXG4gICAgWydkYXRhbGlzdCcsICdsaXN0Ym94J10sXG4gICAgWydkZCcsICdkZWZpbml0aW9uJ10sXG4gICAgWydkZm4nLCAndGVybSddLFxuICAgIFsnZGV0YWlscycsICdncm91cCddLFxuICAgIFsnZHQnLCAndGVybSddLFxuICAgIFsnZmllbGRzZXQnLCAnZ3JvdXAnXSxcbiAgICBbJ2Zvcm0nLCAnZm9ybSddLFxuICAgIFsnaDEnLCAnaGVhZGluZyddLFxuICAgIFsnaDInLCAnaGVhZGluZyddLFxuICAgIFsnaDMnLCAnaGVhZGluZyddLFxuICAgIFsnaDQnLCAnaGVhZGluZyddLFxuICAgIFsnaDUnLCAnaGVhZGluZyddLFxuICAgIFsnaDYnLCAnaGVhZGluZyddLFxuICAgIFsnaHInLCAnc2VwYXJhdG9yJ10sXG4gICAgWydsaScsICdsaXN0aXRlbSddLFxuICAgIFsnbWVudScsICdsaXN0J10sXG4gICAgWyduYXYnLCAnbmF2aWdhdGlvbiddLFxuICAgIFsnb2wnLCAnbGlzdCddLFxuICAgIFsnb3B0Z3JvdXAnLCAnZ3JvdXAnXSxcbiAgICBbJ291dHB1dCcsICdzdGF0dXMnXSxcbiAgICBbJ3Byb2dyZXNzJywgJ3Byb2dyZXNzYmFyJ10sXG4gICAgWydzZWN0aW9uJywgJ3JlZ2lvbiddLFxuICAgIFsnc3VtbWFyeScsICdidXR0b24nXSxcbiAgICBbJ3Rib2R5JywgJ3Jvd2dyb3VwJ10sXG4gICAgWyd0ZXh0YXJlYScsICd0ZXh0Ym94J10sXG4gICAgWyd0Zm9vdCcsICdyb3dncm91cCddLFxuICAgIFsndGhlYWQnLCAncm93Z3JvdXAnXSxcbiAgICBbJ3RyJywgJ3JvdyddLFxuICAgIFsndWwnLCAnbGlzdCddXG5dKTtcbmNvbnN0IGludmlzaWJsZV9lbGVtZW50cyA9IG5ldyBTZXQoWydtZXRhJywgJ2h0bWwnLCAnc2NyaXB0JywgJ3N0eWxlJ10pO1xuY29uc3QgdmFsaWRfbW9kaWZpZXJzJDEgPSBuZXcgU2V0KFtcbiAgICAncHJldmVudERlZmF1bHQnLFxuICAgICdzdG9wUHJvcGFnYXRpb24nLFxuICAgICdjYXB0dXJlJyxcbiAgICAnb25jZScsXG4gICAgJ3Bhc3NpdmUnLFxuICAgICdub25wYXNzaXZlJyxcbiAgICAnc2VsZicsXG4gICAgJ3RydXN0ZWQnXG5dKTtcbmNvbnN0IHBhc3NpdmVfZXZlbnRzID0gbmV3IFNldChbXG4gICAgJ3doZWVsJyxcbiAgICAndG91Y2hzdGFydCcsXG4gICAgJ3RvdWNobW92ZScsXG4gICAgJ3RvdWNoZW5kJyxcbiAgICAndG91Y2hjYW5jZWwnXG5dKTtcbmNvbnN0IHJlYWN0X2F0dHJpYnV0ZXMgPSBuZXcgTWFwKFtcbiAgICBbJ2NsYXNzTmFtZScsICdjbGFzcyddLFxuICAgIFsnaHRtbEZvcicsICdmb3InXVxuXSk7XG5jb25zdCBhdHRyaWJ1dGVzX3RvX2NvbXBhY3Rfd2hpdGVzcGFjZSA9IFsnY2xhc3MnLCAnc3R5bGUnXTtcbmZ1bmN0aW9uIGlzX3BhcmVudChwYXJlbnQsIGVsZW1lbnRzKSB7XG4gICAgbGV0IGNoZWNrID0gZmFsc2U7XG4gICAgd2hpbGUgKHBhcmVudCkge1xuICAgICAgICBjb25zdCBwYXJlbnRfbmFtZSA9IHBhcmVudC5uYW1lO1xuICAgICAgICBpZiAoZWxlbWVudHMuaW5jbHVkZXMocGFyZW50X25hbWUpKSB7XG4gICAgICAgICAgICBjaGVjayA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyZW50LnR5cGUgPT09ICdFbGVtZW50Jykge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcbiAgICB9XG4gICAgcmV0dXJuIGNoZWNrO1xufVxuZnVuY3Rpb24gZ2V0X25hbWVzcGFjZShwYXJlbnQsIGVsZW1lbnQsIGV4cGxpY2l0X25hbWVzcGFjZSkge1xuICAgIGNvbnN0IHBhcmVudF9lbGVtZW50ID0gcGFyZW50LmZpbmRfbmVhcmVzdCgvXkVsZW1lbnQvKTtcbiAgICBpZiAoIXBhcmVudF9lbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBleHBsaWNpdF9uYW1lc3BhY2UgfHwgKGlzX3N2ZyhlbGVtZW50Lm5hbWUpXG4gICAgICAgICAgICA/IG5hbWVzcGFjZXMuc3ZnXG4gICAgICAgICAgICA6IG51bGwpO1xuICAgIH1cbiAgICBpZiAocGFyZW50X2VsZW1lbnQubmFtZXNwYWNlICE9PSBuYW1lc3BhY2VzLmZvcmVpZ24pIHtcbiAgICAgICAgaWYgKGlzX3N2ZyhlbGVtZW50Lm5hbWUudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgICAgICByZXR1cm4gbmFtZXNwYWNlcy5zdmc7XG4gICAgICAgIGlmIChwYXJlbnRfZWxlbWVudC5uYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdmb3JlaWdub2JqZWN0JylcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gcGFyZW50X2VsZW1lbnQubmFtZXNwYWNlO1xufVxuZnVuY3Rpb24gaXNfdmFsaWRfYXJpYV9hdHRyaWJ1dGVfdmFsdWUoc2NoZW1hLCB2YWx1ZSkge1xuICAgIHN3aXRjaCAoc2NoZW1hLnR5cGUpIHtcbiAgICAgICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbic7XG4gICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgIGNhc2UgJ2lkJzpcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnO1xuICAgICAgICBjYXNlICd0cmlzdGF0ZSc6XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicgfHwgdmFsdWUgPT09ICdtaXhlZCc7XG4gICAgICAgIGNhc2UgJ2ludGVnZXInOlxuICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSAhPT0gJ2Jvb2xlYW4nICYmIGlzTmFOKE51bWJlcih2YWx1ZSkpID09PSBmYWxzZTtcbiAgICAgICAgY2FzZSAndG9rZW4nOiAvLyBzaW5nbGUgdG9rZW5cbiAgICAgICAgICAgIHJldHVybiAoc2NoZW1hLnZhbHVlcyB8fCBbXSlcbiAgICAgICAgICAgICAgICAuaW5kZXhPZih0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gdmFsdWUudG9Mb3dlckNhc2UoKSA6IHZhbHVlKSA+IC0xO1xuICAgICAgICBjYXNlICdpZGxpc3QnOiAvLyBpZiBsaXN0IG9mIGlkcywgc3BsaXQgZWFjaFxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZydcbiAgICAgICAgICAgICAgICAmJiB2YWx1ZS5zcGxpdCgnICcpLmV2ZXJ5KChpZCkgPT4gdHlwZW9mIGlkID09PSAnc3RyaW5nJyk7XG4gICAgICAgIGNhc2UgJ3Rva2VubGlzdCc6IC8vIGlmIGxpc3Qgb2YgdG9rZW5zLCBzcGxpdCBlYWNoXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgICAgICYmIHZhbHVlLnNwbGl0KCcgJykuZXZlcnkoKHRva2VuKSA9PiAoc2NoZW1hLnZhbHVlcyB8fCBbXSkuaW5kZXhPZih0b2tlbi50b0xvd2VyQ2FzZSgpKSA+IC0xKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5jb25zdCByZWdleF9hbnlfcmVwZWF0ZWRfd2hpdGVzcGFjZXMgPSAvW1xcc10rL2c7XG5jb25zdCByZWdleF9oZWFkaW5nX3RhZ3MgPSAvXmhbMS02XSQvO1xuY29uc3QgcmVnZXhfaWxsZWdhbF9hdHRyaWJ1dGVfY2hhcmFjdGVyID0gLyheWzAtOS0uXSl8W1xcXiRAJSYjPyF8KClbXFxde31eKit+O10vO1xuY2xhc3MgRWxlbWVudCBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xuICAgICAgICB0aGlzLmFjdGlvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5iaW5kaW5ncyA9IFtdO1xuICAgICAgICB0aGlzLmNsYXNzZXMgPSBbXTtcbiAgICAgICAgdGhpcy5zdHlsZXMgPSBbXTtcbiAgICAgICAgdGhpcy5oYW5kbGVycyA9IFtdO1xuICAgICAgICB0aGlzLmxldHMgPSBbXTtcbiAgICAgICAgdGhpcy5pbnRybyA9IG51bGw7XG4gICAgICAgIHRoaXMub3V0cm8gPSBudWxsO1xuICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IG51bGw7XG4gICAgICAgIHRoaXMubmFtZSA9IGluZm8ubmFtZTtcbiAgICAgICAgaWYgKGluZm8ubmFtZSA9PT0gJ3N2ZWx0ZTplbGVtZW50Jykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbmZvLnRhZyAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRhZ19leHByID0gbmV3IEV4cHJlc3Npb24oY29tcG9uZW50LCB0aGlzLCBzY29wZSwgaW5mby50YWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy50YWdfZXhwciA9IG5ldyBFeHByZXNzaW9uKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIHN0cmluZ19saXRlcmFsKGluZm8udGFnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRhZ19leHByID0gbmV3IEV4cHJlc3Npb24oY29tcG9uZW50LCB0aGlzLCBzY29wZSwgc3RyaW5nX2xpdGVyYWwodGhpcy5uYW1lKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYW1lc3BhY2UgPSBnZXRfbmFtZXNwYWNlKHBhcmVudCwgdGhpcywgY29tcG9uZW50Lm5hbWVzcGFjZSk7XG4gICAgICAgIGlmICh0aGlzLm5hbWVzcGFjZSAhPT0gbmFtZXNwYWNlcy5mb3JlaWduKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5uYW1lID09PSAncHJlJyB8fCB0aGlzLm5hbWUgPT09ICd0ZXh0YXJlYScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaXJzdCA9IGluZm8uY2hpbGRyZW5bMF07XG4gICAgICAgICAgICAgICAgaWYgKGZpcnN0ICYmIGZpcnN0LnR5cGUgPT09ICdUZXh0Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgbGVhZGluZyBuZXdsaW5lIGNoYXJhY3RlciBuZWVkcyB0byBiZSBzdHJpcHBlZCBiZWNhdXNlIG9mIGEgcWlyayxcbiAgICAgICAgICAgICAgICAgICAgLy8gaXQgaXMgaWdub3JlZCBieSBicm93c2VycyBpZiB0aGUgdGFnIGFuZCBpdHMgY29udGVudHMgYXJlIHNldCB0aHJvdWdoXG4gICAgICAgICAgICAgICAgICAgIC8vIGlubmVySFRNTCAoTk9UIGlmIHNldCB0aHJvdWdoIHRoZSBpbm5lckhUTUwgb2YgdGhlIHRhZyBvciBkeW5hbWljYWxseSkuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlZm9yZSBzdHJpcCBpdCBoZXJlIGJ1dCBhZGQgaXQgYmFjayBpbiB0aGUgYXBwcm9wcmlhdGVcbiAgICAgICAgICAgICAgICAgICAgLy8gcGxhY2VzIGlmIHRoZXJlJ3MgYW5vdGhlciBuZXdsaW5lIGFmdGVyd2FyZHMuXG4gICAgICAgICAgICAgICAgICAgIC8vIHNlZSBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNlbGVtZW50LXJlc3RyaWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAvLyBzZWUgaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvZ3JvdXBpbmctY29udGVudC5odG1sI3RoZS1wcmUtZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICBmaXJzdC5kYXRhID0gZmlyc3QuZGF0YS5yZXBsYWNlKHJlZ2V4X3N0YXJ0c193aXRoX25ld2xpbmUsICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5uYW1lID09PSAndGV4dGFyZWEnKSB7XG4gICAgICAgICAgICAgICAgaWYgKGluZm8uY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZV9hdHRyaWJ1dGUgPSBpbmZvLmF0dHJpYnV0ZXMuZmluZChub2RlID0+IG5vZGUubmFtZSA9PT0gJ3ZhbHVlJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZV9hdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcih2YWx1ZV9hdHRyaWJ1dGUsIGNvbXBpbGVyX2Vycm9ycy50ZXh0YXJlYV9kdXBsaWNhdGVfdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgYW4gZWdyZWdpb3VzIGhhY2ssIGJ1dCBpdCdzIHRoZSBlYXNpZXN0IHdheSB0byBnZXQgPHRleHRhcmVhPlxuICAgICAgICAgICAgICAgICAgICAvLyBjaGlsZHJlbiB0cmVhdGVkIHRoZSBzYW1lIHdheSBhcyBhIHZhbHVlIGF0dHJpYnV0ZVxuICAgICAgICAgICAgICAgICAgICBpbmZvLmF0dHJpYnV0ZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQXR0cmlidXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICd2YWx1ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogaW5mby5jaGlsZHJlblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaW5mby5jaGlsZHJlbiA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgPT09ICdvcHRpb24nKSB7XG4gICAgICAgICAgICAgICAgLy8gU3BlY2lhbCBjYXNlIOKAlCB0cmVhdCB0aGVzZSB0aGUgc2FtZSB3YXk6XG4gICAgICAgICAgICAgICAgLy8gICA8b3B0aW9uPntmb299PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgLy8gICA8b3B0aW9uIHZhbHVlPXtmb299Pntmb299PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWVfYXR0cmlidXRlID0gaW5mby5hdHRyaWJ1dGVzLmZpbmQoYXR0cmlidXRlID0+IGF0dHJpYnV0ZS5uYW1lID09PSAndmFsdWUnKTtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlX2F0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgICAgICBpbmZvLmF0dHJpYnV0ZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQXR0cmlidXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICd2YWx1ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogaW5mby5jaGlsZHJlbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5bnRoZXRpYzogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGFzX2xldCA9IGluZm8uYXR0cmlidXRlcy5zb21lKG5vZGUgPT4gbm9kZS50eXBlID09PSAnTGV0Jyk7XG4gICAgICAgIGlmIChoYXNfbGV0KSB7XG4gICAgICAgICAgICBzY29wZSA9IHNjb3BlLmNoaWxkKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQmluZGluZyByZWxpZXMgb24gQXR0cmlidXRlLCBkZWZlciBpdHMgZXZhbHVhdGlvblxuICAgICAgICBjb25zdCBvcmRlciA9IFsnQmluZGluZyddOyAvLyBldmVyeXRoaW5nIGVsc2UgaXMgLTFcbiAgICAgICAgaW5mby5hdHRyaWJ1dGVzLnNvcnQoKGEsIGIpID0+IG9yZGVyLmluZGV4T2YoYS50eXBlKSAtIG9yZGVyLmluZGV4T2YoYi50eXBlKSk7XG4gICAgICAgIGluZm8uYXR0cmlidXRlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChub2RlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdBY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbnMucHVzaChuZXcgQWN0aW9uKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQXR0cmlidXRlJzpcbiAgICAgICAgICAgICAgICBjYXNlICdTcHJlYWQnOlxuICAgICAgICAgICAgICAgICAgICAvLyBzcGVjaWFsIGNhc2VcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubmFtZSA9PT0gJ3htbG5zJylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmFtZXNwYWNlID0gbm9kZS52YWx1ZVswXS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMucHVzaChuZXcgQXR0cmlidXRlKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQmluZGluZyc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZGluZ3MucHVzaChuZXcgQmluZGluZyhjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBub2RlKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0NsYXNzJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGFzc2VzLnB1c2gobmV3IENsYXNzKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnU3R5bGVEaXJlY3RpdmUnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0eWxlcy5wdXNoKG5ldyBTdHlsZURpcmVjdGl2ZShjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBub2RlKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0V2ZW50SGFuZGxlcic6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlcnMucHVzaChuZXcgRXZlbnRIYW5kbGVyKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnTGV0Jzoge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsID0gbmV3IExldChjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sZXRzLnB1c2gobCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IG5ldyBTZXQoW2wubmFtZS5uYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgIGwubmFtZXMuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmFkZChuYW1lLCBkZXBlbmRlbmNpZXMsIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgJ1RyYW5zaXRpb24nOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmFuc2l0aW9uID0gbmV3IFRyYW5zaXRpb24oY29tcG9uZW50LCB0aGlzLCBzY29wZSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pbnRybylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludHJvID0gdHJhbnNpdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm91dHJvKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cm8gPSB0cmFuc2l0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlICdBbmltYXRpb24nOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IG5ldyBBbmltYXRpb24oY29tcG9uZW50LCB0aGlzLCBzY29wZSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm90IGltcGxlbWVudGVkOiAke25vZGUudHlwZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IG1hcF9jaGlsZHJlbihjb21wb25lbnQsIHRoaXMsIHRoaXMuc2NvcGUsIGluZm8uY2hpbGRyZW4pO1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgICAgIHRoaXMub3B0aW1pc2UoKTtcbiAgICAgICAgY29tcG9uZW50LmFwcGx5X3N0eWxlc2hlZXQodGhpcyk7XG4gICAgfVxuICAgIGdldCBpc19keW5hbWljX2VsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWUgPT09ICdzdmVsdGU6ZWxlbWVudCc7XG4gICAgfVxuICAgIHZhbGlkYXRlKCkge1xuICAgICAgICBpZiAodGhpcy5jb21wb25lbnQudmFyX2xvb2t1cC5oYXModGhpcy5uYW1lKSAmJiB0aGlzLmNvbXBvbmVudC52YXJfbG9va3VwLmdldCh0aGlzLm5hbWUpLmltcG9ydGVkICYmICFpc19zdmcodGhpcy5uYW1lKSAmJiAhaXNfaHRtbCh0aGlzLm5hbWUpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudC53YXJuKHRoaXMsIGNvbXBpbGVyX3dhcm5pbmdzLmNvbXBvbmVudF9uYW1lX2xvd2VyY2FzZSh0aGlzLm5hbWUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbGlkYXRlX2F0dHJpYnV0ZXMoKTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZV9ldmVudF9oYW5kbGVycygpO1xuICAgICAgICBpZiAodGhpcy5uYW1lc3BhY2UgPT09IG5hbWVzcGFjZXMuZm9yZWlnbikge1xuICAgICAgICAgICAgdGhpcy52YWxpZGF0ZV9iaW5kaW5nc19mb3JlaWduKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlX2F0dHJpYnV0ZXNfYTExeSgpO1xuICAgICAgICAgICAgdGhpcy52YWxpZGF0ZV9zcGVjaWFsX2Nhc2VzKCk7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlX2JpbmRpbmdzKCk7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlX2NvbnRlbnQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YWxpZGF0ZV9hdHRyaWJ1dGVzKCkge1xuICAgICAgICBjb25zdCB7IGNvbXBvbmVudCwgcGFyZW50IH0gPSB0aGlzO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuZm9yRWFjaChhdHRyaWJ1dGUgPT4ge1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5pc19zcHJlYWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgbmFtZSA9IGF0dHJpYnV0ZS5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAvLyBFcnJvcnNcbiAgICAgICAgICAgIGlmIChyZWdleF9pbGxlZ2FsX2F0dHJpYnV0ZV9jaGFyYWN0ZXIudGVzdChuYW1lKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYXR0cmlidXRlLCBjb21waWxlcl9lcnJvcnMuaWxsZWdhbF9hdHRyaWJ1dGUobmFtZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdzbG90Jykge1xuICAgICAgICAgICAgICAgIGlmICghYXR0cmlidXRlLmlzX3N0YXRpYykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGF0dHJpYnV0ZSwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfc2xvdF9hdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50LnNsb3Rfb3V0bGV0cy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihhdHRyaWJ1dGUsIGNvbXBpbGVyX2Vycm9ycy5kdXBsaWNhdGVfc2xvdF9hdHRyaWJ1dGUobmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGNvZGUgd2FzIHVucmVhY2hhYmxlLiBTdGlsbCBuZWVkZWQ/XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbXBvbmVudC5zbG90X291dGxldHMuYWRkKG5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIShwYXJlbnQudHlwZSA9PT0gJ1Nsb3RUZW1wbGF0ZScgfHwgd2l0aGluX2N1c3RvbV9lbGVtZW50KHBhcmVudCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYXR0cmlidXRlLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9zbG90dGVkX2NvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFdhcm5pbmdzXG4gICAgICAgICAgICBpZiAodGhpcy5uYW1lc3BhY2UgIT09IG5hbWVzcGFjZXMuZm9yZWlnbikge1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnaXMnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKGF0dHJpYnV0ZSwgY29tcGlsZXJfd2FybmluZ3MuYXZvaWRfaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmVhY3RfYXR0cmlidXRlcy5oYXMoYXR0cmlidXRlLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKGF0dHJpYnV0ZSwgY29tcGlsZXJfd2FybmluZ3MuaW52YWxpZF9odG1sX2F0dHJpYnV0ZShhdHRyaWJ1dGUubmFtZSwgcmVhY3RfYXR0cmlidXRlcy5nZXQoYXR0cmlidXRlLm5hbWUpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdmFsaWRhdGVfYXR0cmlidXRlc19hMTF5KCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IHsgY29tcG9uZW50LCBhdHRyaWJ1dGVzLCBoYW5kbGVycyB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgYXR0cmlidXRlX21hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgY29uc3QgaGFuZGxlcnNfbWFwID0gbmV3IE1hcCgpO1xuICAgICAgICBhdHRyaWJ1dGVzLmZvckVhY2goYXR0cmlidXRlID0+IChhdHRyaWJ1dGVfbWFwLnNldChhdHRyaWJ1dGUubmFtZSwgYXR0cmlidXRlKSkpO1xuICAgICAgICBoYW5kbGVycy5mb3JFYWNoKGhhbmRsZXIgPT4gKGhhbmRsZXJzX21hcC5zZXQoaGFuZGxlci5uYW1lLCBoYW5kbGVyKSkpO1xuICAgICAgICBhdHRyaWJ1dGVzLmZvckVhY2goYXR0cmlidXRlID0+IHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUuaXNfc3ByZWFkKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBhdHRyaWJ1dGUubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgLy8gYXJpYS1wcm9wc1xuICAgICAgICAgICAgaWYgKG5hbWUuc3RhcnRzV2l0aCgnYXJpYS0nKSkge1xuICAgICAgICAgICAgICAgIGlmIChpbnZpc2libGVfZWxlbWVudHMuaGFzKHRoaXMubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYXJpYS11bnN1cHBvcnRlZC1lbGVtZW50c1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQud2FybihhdHRyaWJ1dGUsIGNvbXBpbGVyX3dhcm5pbmdzLmExMXlfYXJpYV9hdHRyaWJ1dGVzKHRoaXMubmFtZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gbmFtZS5zbGljZSg1KTtcbiAgICAgICAgICAgICAgICBpZiAoIWFyaWFfYXR0cmlidXRlX3NldC5oYXModHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBmdXp6eW1hdGNoKHR5cGUsIGFyaWFfYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKGF0dHJpYnV0ZSwgY29tcGlsZXJfd2FybmluZ3MuYTExeV91bmtub3duX2FyaWFfYXR0cmlidXRlKHR5cGUsIG1hdGNoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnYXJpYS1oaWRkZW4nICYmIHJlZ2V4X2hlYWRpbmdfdGFncy50ZXN0KHRoaXMubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4oYXR0cmlidXRlLCBjb21waWxlcl93YXJuaW5ncy5hMTF5X2hpZGRlbih0aGlzLm5hbWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gYXJpYS1wcm9wdHlwZXNcbiAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBhdHRyaWJ1dGUuZ2V0X3N0YXRpY192YWx1ZSgpO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJ3RydWUnKVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnZmFsc2UnKVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIGxpYl81LmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzY2hlbWEgPSBsaWJfNS5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNfdmFsaWRfYXJpYV9hdHRyaWJ1dGVfdmFsdWUoc2NoZW1hLCB2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKGF0dHJpYnV0ZSwgY29tcGlsZXJfd2FybmluZ3MuYTExeV9pbmNvcnJlY3RfYXR0cmlidXRlX3R5cGUoc2NoZW1hLCBuYW1lKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBhcmlhLXJvbGVcbiAgICAgICAgICAgIGlmIChuYW1lID09PSAncm9sZScpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW52aXNpYmxlX2VsZW1lbnRzLmhhcyh0aGlzLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFyaWEtdW5zdXBwb3J0ZWQtZWxlbWVudHNcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4oYXR0cmlidXRlLCBjb21waWxlcl93YXJuaW5ncy5hMTF5X21pc3BsYWNlZF9yb2xlKHRoaXMubmFtZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGF0dHJpYnV0ZS5nZXRfc3RhdGljX3ZhbHVlKCk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICYmIGFyaWFfcm9sZV9hYnN0cmFjdF9zZXQuaGFzKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQud2FybihhdHRyaWJ1dGUsIGNvbXBpbGVyX3dhcm5pbmdzLmExMXlfbm9fYWJzdHJhY3Rfcm9sZSh2YWx1ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSAmJiAhYXJpYV9yb2xlX3NldC5oYXModmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gZnV6enltYXRjaCh2YWx1ZSwgYXJpYV9yb2xlcyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKGF0dHJpYnV0ZSwgY29tcGlsZXJfd2FybmluZ3MuYTExeV91bmtub3duX3JvbGUodmFsdWUsIG1hdGNoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIG5vLXJlZHVuZGFudC1yb2xlc1xuICAgICAgICAgICAgICAgIGNvbnN0IGhhc19yZWR1bmRhbnRfcm9sZSA9IHZhbHVlID09PSBhMTF5X2ltcGxpY2l0X3NlbWFudGljcy5nZXQodGhpcy5uYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5uYW1lID09PSB2YWx1ZSB8fCBoYXNfcmVkdW5kYW50X3JvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4oYXR0cmlidXRlLCBjb21waWxlcl93YXJuaW5ncy5hMTF5X25vX3JlZHVuZGFudF9yb2xlcyh2YWx1ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBGb290ZXJzIGFuZCBoZWFkZXJzIGFyZSBzcGVjaWFsIGNhc2VzLCBhbmQgc2hvdWxkIG5vdCBoYXZlIHJlZHVuZGFudCByb2xlcyB1bmxlc3MgdGhleSBhcmUgdGhlIGNoaWxkcmVuIG9mIHNlY3Rpb25zIG9yIGFydGljbGVzLlxuICAgICAgICAgICAgICAgIGNvbnN0IGlzX3BhcmVudF9zZWN0aW9uX29yX2FydGljbGUgPSBpc19wYXJlbnQodGhpcy5wYXJlbnQsIFsnc2VjdGlvbicsICdhcnRpY2xlJ10pO1xuICAgICAgICAgICAgICAgIGlmICghaXNfcGFyZW50X3NlY3Rpb25fb3JfYXJ0aWNsZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBoYXNfbmVzdGVkX3JlZHVuZGFudF9yb2xlID0gdmFsdWUgPT09IGExMXlfbmVzdGVkX2ltcGxpY2l0X3NlbWFudGljcy5nZXQodGhpcy5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc19uZXN0ZWRfcmVkdW5kYW50X3JvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKGF0dHJpYnV0ZSwgY29tcGlsZXJfd2FybmluZ3MuYTExeV9ub19yZWR1bmRhbnRfcm9sZXModmFsdWUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyByb2xlLWhhcy1yZXF1aXJlZC1hcmlhLXByb3BzXG4gICAgICAgICAgICAgICAgaWYgKCFpc19zZW1hbnRpY19yb2xlX2VsZW1lbnQodmFsdWUsIHRoaXMubmFtZSwgYXR0cmlidXRlX21hcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm9sZSA9IGxpYl8zLmdldCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXF1aXJlZF9yb2xlX3Byb3BzID0gT2JqZWN0LmtleXMocm9sZS5yZXF1aXJlZFByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhc19taXNzaW5nX3Byb3BzID0gcmVxdWlyZWRfcm9sZV9wcm9wcy5zb21lKHByb3AgPT4gIWF0dHJpYnV0ZXMuZmluZChhID0+IGEubmFtZSA9PT0gcHJvcCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc19taXNzaW5nX3Byb3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4oYXR0cmlidXRlLCBjb21waWxlcl93YXJuaW5ncy5hMTF5X3JvbGVfaGFzX3JlcXVpcmVkX2FyaWFfcHJvcHModmFsdWUsIHJlcXVpcmVkX3JvbGVfcHJvcHMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBuby1pbnRlcmFjdGl2ZS1lbGVtZW50LXRvLW5vbmludGVyYWN0aXZlLXJvbGVcbiAgICAgICAgICAgICAgICBpZiAoaXNfaW50ZXJhY3RpdmVfZWxlbWVudCh0aGlzLm5hbWUsIGF0dHJpYnV0ZV9tYXApICYmIChpc19ub25faW50ZXJhY3RpdmVfcm9sZXModmFsdWUpIHx8IGlzX3ByZXNlbnRhdGlvbl9yb2xlKHZhbHVlKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4odGhpcywgY29tcGlsZXJfd2FybmluZ3MuYTExeV9ub19pbnRlcmFjdGl2ZV9lbGVtZW50X3RvX25vbmludGVyYWN0aXZlX3JvbGUodmFsdWUsIHRoaXMubmFtZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIG5vLWFjY2Vzcy1rZXlcbiAgICAgICAgICAgIGlmIChuYW1lID09PSAnYWNjZXNza2V5Jykge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKGF0dHJpYnV0ZSwgY29tcGlsZXJfd2FybmluZ3MuYTExeV9hY2Nlc3NrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gbm8tYXV0b2ZvY3VzXG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJ2F1dG9mb2N1cycpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQud2FybihhdHRyaWJ1dGUsIGNvbXBpbGVyX3dhcm5pbmdzLmExMXlfYXV0b2ZvY3VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHNjb3BlXG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJ3Njb3BlJyAmJiB0aGlzLm5hbWUgIT09ICd0aCcpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQud2FybihhdHRyaWJ1dGUsIGNvbXBpbGVyX3dhcm5pbmdzLmExMXlfbWlzcGxhY2VkX3Njb3BlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHRhYmluZGV4LW5vLXBvc2l0aXZlXG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJ3RhYmluZGV4Jykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXR0cmlidXRlLmdldF9zdGF0aWNfdmFsdWUoKTtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG8gaXMgdGFiaW5kZXg9dHJ1ZSBjb3JyZWN0IGNhc2U/XG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTih2YWx1ZSkgJiYgK3ZhbHVlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQud2FybihhdHRyaWJ1dGUsIGNvbXBpbGVyX3dhcm5pbmdzLmExMXlfcG9zaXRpdmVfdGFiaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGNsaWNrLWV2ZW50cy1oYXZlLWtleS1ldmVudHNcbiAgICAgICAgaWYgKGhhbmRsZXJzX21hcC5oYXMoJ2NsaWNrJykpIHtcbiAgICAgICAgICAgIGNvbnN0IHJvbGUgPSBhdHRyaWJ1dGVfbWFwLmdldCgncm9sZScpO1xuICAgICAgICAgICAgY29uc3QgaXNfbm9uX3ByZXNlbnRhdGlvbl9yb2xlID0gKHJvbGUgPT09IG51bGwgfHwgcm9sZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcm9sZS5pc19zdGF0aWMpICYmICFpc19wcmVzZW50YXRpb25fcm9sZShyb2xlLmdldF9zdGF0aWNfdmFsdWUoKSk7XG4gICAgICAgICAgICBpZiAoIWlzX2hpZGRlbl9mcm9tX3NjcmVlbl9yZWFkZXIodGhpcy5uYW1lLCBhdHRyaWJ1dGVfbWFwKSAmJlxuICAgICAgICAgICAgICAgICghcm9sZSB8fCBpc19ub25fcHJlc2VudGF0aW9uX3JvbGUpICYmXG4gICAgICAgICAgICAgICAgIWlzX2ludGVyYWN0aXZlX2VsZW1lbnQodGhpcy5uYW1lLCBhdHRyaWJ1dGVfbWFwKSAmJlxuICAgICAgICAgICAgICAgICF0aGlzLmF0dHJpYnV0ZXMuZmluZChhdHRyID0+IGF0dHIuaXNfc3ByZWFkKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhhc19rZXlfZXZlbnQgPSBoYW5kbGVyc19tYXAuaGFzKCdrZXlkb3duJykgfHxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlcnNfbWFwLmhhcygna2V5dXAnKSB8fFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVyc19tYXAuaGFzKCdrZXlwcmVzcycpO1xuICAgICAgICAgICAgICAgIGlmICghaGFzX2tleV9ldmVudCkge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQud2Fybih0aGlzLCBjb21waWxlcl93YXJuaW5ncy5hMTF5X2NsaWNrX2V2ZW50c19oYXZlX2tleV9ldmVudHMoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIG5vLW5vbmludGVyYWN0aXZlLXRhYmluZGV4XG4gICAgICAgIGlmICghaXNfaW50ZXJhY3RpdmVfZWxlbWVudCh0aGlzLm5hbWUsIGF0dHJpYnV0ZV9tYXApICYmICFpc19pbnRlcmFjdGl2ZV9yb2xlcygoX2EgPSBhdHRyaWJ1dGVfbWFwLmdldCgncm9sZScpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZ2V0X3N0YXRpY192YWx1ZSgpKSkge1xuICAgICAgICAgICAgY29uc3QgdGFiX2luZGV4ID0gYXR0cmlidXRlX21hcC5nZXQoJ3RhYmluZGV4Jyk7XG4gICAgICAgICAgICBpZiAodGFiX2luZGV4ICYmICghdGFiX2luZGV4LmlzX3N0YXRpYyB8fCBOdW1iZXIodGFiX2luZGV4LmdldF9zdGF0aWNfdmFsdWUoKSkgPj0gMCkpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQud2Fybih0aGlzLCBjb21waWxlcl93YXJuaW5ncy5hMTF5X25vX25vbmludGVyYWN0aXZlX3RhYmluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB2YWxpZGF0ZV9zcGVjaWFsX2Nhc2VzKCkge1xuICAgICAgICBjb25zdCB7IGNvbXBvbmVudCwgYXR0cmlidXRlcywgaGFuZGxlcnMgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZV9tYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIGNvbnN0IGhhbmRsZXJzX21hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgYXR0cmlidXRlcy5mb3JFYWNoKGF0dHJpYnV0ZSA9PiAoYXR0cmlidXRlX21hcC5zZXQoYXR0cmlidXRlLm5hbWUsIGF0dHJpYnV0ZSkpKTtcbiAgICAgICAgaGFuZGxlcnMuZm9yRWFjaChoYW5kbGVyID0+IChoYW5kbGVyc19tYXAuc2V0KGhhbmRsZXIubmFtZSwgaGFuZGxlcikpKTtcbiAgICAgICAgaWYgKHRoaXMubmFtZSA9PT0gJ2EnKSB7XG4gICAgICAgICAgICBjb25zdCBocmVmX2F0dHJpYnV0ZSA9IGF0dHJpYnV0ZV9tYXAuZ2V0KCdocmVmJykgfHwgYXR0cmlidXRlX21hcC5nZXQoJ3hsaW5rOmhyZWYnKTtcbiAgICAgICAgICAgIGNvbnN0IGlkX2F0dHJpYnV0ZSA9IGF0dHJpYnV0ZV9tYXAuZ2V0KCdpZCcpO1xuICAgICAgICAgICAgY29uc3QgbmFtZV9hdHRyaWJ1dGUgPSBhdHRyaWJ1dGVfbWFwLmdldCgnbmFtZScpO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0X2F0dHJpYnV0ZSA9IGF0dHJpYnV0ZV9tYXAuZ2V0KCd0YXJnZXQnKTtcbiAgICAgICAgICAgIGlmICh0YXJnZXRfYXR0cmlidXRlICYmIHRhcmdldF9hdHRyaWJ1dGUuZ2V0X3N0YXRpY192YWx1ZSgpID09PSAnX2JsYW5rJyAmJiBocmVmX2F0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhyZWZfc3RhdGljX3ZhbHVlID0gaHJlZl9hdHRyaWJ1dGUuZ2V0X3N0YXRpY192YWx1ZSgpID8gaHJlZl9hdHRyaWJ1dGUuZ2V0X3N0YXRpY192YWx1ZSgpLnRvTG93ZXJDYXNlKCkgOiBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChocmVmX3N0YXRpY192YWx1ZSA9PT0gbnVsbCB8fCBocmVmX3N0YXRpY192YWx1ZS5tYXRjaCgvXihodHRwcz86KT9cXC9cXC8vaSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVsID0gYXR0cmlidXRlX21hcC5nZXQoJ3JlbCcpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZWxfdmFsdWVzID0gcmVsID8gcmVsLmdldF9zdGF0aWNfdmFsdWUoKS5zcGxpdCgnICcpIDogW107XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkX3ZhbHVlcyA9IFsnbm9yZWZlcnJlciddO1xuICAgICAgICAgICAgICAgICAgICBleHBlY3RlZF92YWx1ZXMuZm9yRWFjaChleHBlY3RlZF92YWx1ZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlbCB8fCByZWwgJiYgcmVsX3ZhbHVlcy5pbmRleE9mKGV4cGVjdGVkX3ZhbHVlKSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQud2Fybih0aGlzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IGBzZWN1cml0eS1hbmNob3ItcmVsLSR7ZXhwZWN0ZWRfdmFsdWV9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogYFNlY3VyaXR5OiBBbmNob3Igd2l0aCBcInRhcmdldD1fYmxhbmtcIiBzaG91bGQgaGF2ZSByZWwgYXR0cmlidXRlIGNvbnRhaW5pbmcgdGhlIHZhbHVlIFwiJHtleHBlY3RlZF92YWx1ZX1cImBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhyZWZfYXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaHJlZl92YWx1ZSA9IGhyZWZfYXR0cmlidXRlLmdldF9zdGF0aWNfdmFsdWUoKTtcbiAgICAgICAgICAgICAgICBpZiAoaHJlZl92YWx1ZSA9PT0gJycgfHwgaHJlZl92YWx1ZSA9PT0gJyMnIHx8IC9eXFxXKmphdmFzY3JpcHQ6L2kudGVzdChocmVmX3ZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQud2FybihocmVmX2F0dHJpYnV0ZSwgY29tcGlsZXJfd2FybmluZ3MuYTExeV9pbnZhbGlkX2F0dHJpYnV0ZShocmVmX2F0dHJpYnV0ZS5uYW1lLCBocmVmX3ZhbHVlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaWRfYXR0cmlidXRlX3ZhbGlkID0gaWRfYXR0cmlidXRlICYmIGlkX2F0dHJpYnV0ZS5nZXRfc3RhdGljX3ZhbHVlKCkgIT09ICcnO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVfYXR0cmlidXRlX3ZhbGlkID0gbmFtZV9hdHRyaWJ1dGUgJiYgbmFtZV9hdHRyaWJ1dGUuZ2V0X3N0YXRpY192YWx1ZSgpICE9PSAnJztcbiAgICAgICAgICAgICAgICBpZiAoIWlkX2F0dHJpYnV0ZV92YWxpZCAmJiAhbmFtZV9hdHRyaWJ1dGVfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4odGhpcywgY29tcGlsZXJfd2FybmluZ3MuYTExeV9taXNzaW5nX2F0dHJpYnV0ZSgnYScsICdhbicsICdocmVmJykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVpcmVkX2F0dHJpYnV0ZXMgPSBhMTF5X3JlcXVpcmVkX2F0dHJpYnV0ZXNbdGhpcy5uYW1lXTtcbiAgICAgICAgICAgIGlmIChyZXF1aXJlZF9hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGFzX2F0dHJpYnV0ZSA9IHJlcXVpcmVkX2F0dHJpYnV0ZXMuc29tZShuYW1lID0+IGF0dHJpYnV0ZV9tYXAuaGFzKG5hbWUpKTtcbiAgICAgICAgICAgICAgICBpZiAoIWhhc19hdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2hhdmVfYXR0cmlidXRlKHRoaXMsIHJlcXVpcmVkX2F0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uYW1lID09PSAnaW5wdXQnKSB7XG4gICAgICAgICAgICBjb25zdCB0eXBlID0gYXR0cmlidXRlX21hcC5nZXQoJ3R5cGUnKTtcbiAgICAgICAgICAgIGlmICh0eXBlICYmIHR5cGUuZ2V0X3N0YXRpY192YWx1ZSgpID09PSAnaW1hZ2UnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVxdWlyZWRfYXR0cmlidXRlcyA9IFsnYWx0JywgJ2FyaWEtbGFiZWwnLCAnYXJpYS1sYWJlbGxlZGJ5J107XG4gICAgICAgICAgICAgICAgY29uc3QgaGFzX2F0dHJpYnV0ZSA9IHJlcXVpcmVkX2F0dHJpYnV0ZXMuc29tZShuYW1lID0+IGF0dHJpYnV0ZV9tYXAuaGFzKG5hbWUpKTtcbiAgICAgICAgICAgICAgICBpZiAoIWhhc19hdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2hhdmVfYXR0cmlidXRlKHRoaXMsIHJlcXVpcmVkX2F0dHJpYnV0ZXMsICdpbnB1dCB0eXBlPVwiaW1hZ2VcIicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uYW1lID09PSAnaW1nJykge1xuICAgICAgICAgICAgY29uc3QgYWx0X2F0dHJpYnV0ZSA9IGF0dHJpYnV0ZV9tYXAuZ2V0KCdhbHQnKTtcbiAgICAgICAgICAgIGNvbnN0IGFyaWFfaGlkZGVuX2F0dHJpYnV0ZSA9IGF0dHJpYnV0ZV9tYXAuZ2V0KCdhcmlhLWhpZGRlbicpO1xuICAgICAgICAgICAgY29uc3QgYXJpYV9oaWRkZW5fZXhpc3QgPSBhcmlhX2hpZGRlbl9hdHRyaWJ1dGUgJiYgYXJpYV9oaWRkZW5fYXR0cmlidXRlLmdldF9zdGF0aWNfdmFsdWUoKTtcbiAgICAgICAgICAgIGlmIChhbHRfYXR0cmlidXRlICYmICFhcmlhX2hpZGRlbl9leGlzdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsdF92YWx1ZSA9IGFsdF9hdHRyaWJ1dGUuZ2V0X3N0YXRpY192YWx1ZSgpO1xuICAgICAgICAgICAgICAgIGlmICgvXFxiKGltYWdlfHBpY3R1cmV8cGhvdG8pXFxiL2kudGVzdChhbHRfdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKHRoaXMsIGNvbXBpbGVyX3dhcm5pbmdzLmExMXlfaW1nX3JlZHVuZGFudF9hbHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uYW1lID09PSAnbGFiZWwnKSB7XG4gICAgICAgICAgICBjb25zdCBoYXNfaW5wdXRfY2hpbGQgPSAoY2hpbGRyZW4pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW4uc29tZShjaGlsZCA9PiAoY2hpbGQgaW5zdGFuY2VvZiBFbGVtZW50ICYmIChhMTF5X2xhYmVsYWJsZS5oYXMoY2hpbGQubmFtZSkgfHwgY2hpbGQubmFtZSA9PT0gJ3Nsb3QnKSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKCdjaGlsZHJlbicgaW4gY2hpbGQpIHx8IGNoaWxkLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc19pbnB1dF9jaGlsZChjaGlsZC5jaGlsZHJlbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoIWF0dHJpYnV0ZV9tYXAuaGFzKCdmb3InKSAmJiAhaGFzX2lucHV0X2NoaWxkKHRoaXMuY2hpbGRyZW4pKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4odGhpcywgY29tcGlsZXJfd2FybmluZ3MuYTExeV9sYWJlbF9oYXNfYXNzb2NpYXRlZF9jb250cm9sKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uYW1lID09PSAndmlkZW8nKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlX21hcC5oYXMoJ211dGVkJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgaGFzX2NhcHRpb247XG4gICAgICAgICAgICBjb25zdCB0cmFjayA9IHRoaXMuY2hpbGRyZW4uZmluZCgoaSkgPT4gaS5uYW1lID09PSAndHJhY2snKTtcbiAgICAgICAgICAgIGlmICh0cmFjaykge1xuICAgICAgICAgICAgICAgIGhhc19jYXB0aW9uID0gdHJhY2suYXR0cmlidXRlcy5maW5kKGEgPT4gYS5uYW1lID09PSAna2luZCcgJiYgYS5nZXRfc3RhdGljX3ZhbHVlKCkgPT09ICdjYXB0aW9ucycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFoYXNfY2FwdGlvbikge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKHRoaXMsIGNvbXBpbGVyX3dhcm5pbmdzLmExMXlfbWVkaWFfaGFzX2NhcHRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChhMTF5X2Rpc3RyYWN0aW5nX2VsZW1lbnRzLmhhcyh0aGlzLm5hbWUpKSB7XG4gICAgICAgICAgICAvLyBuby1kaXN0cmFjdGluZy1lbGVtZW50c1xuICAgICAgICAgICAgY29tcG9uZW50Lndhcm4odGhpcywgY29tcGlsZXJfd2FybmluZ3MuYTExeV9kaXN0cmFjdGluZ19lbGVtZW50cyh0aGlzLm5hbWUpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uYW1lID09PSAnZmlnY2FwdGlvbicpIHtcbiAgICAgICAgICAgIGxldCB7IHBhcmVudCB9ID0gdGhpcztcbiAgICAgICAgICAgIGxldCBpc19maWd1cmVfcGFyZW50ID0gZmFsc2U7XG4gICAgICAgICAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudC5uYW1lID09PSAnZmlndXJlJykge1xuICAgICAgICAgICAgICAgICAgICBpc19maWd1cmVfcGFyZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQudHlwZSA9PT0gJ0VsZW1lbnQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc19maWd1cmVfcGFyZW50KSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4odGhpcywgY29tcGlsZXJfd2FybmluZ3MuYTExeV9zdHJ1Y3R1cmVfaW1tZWRpYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uYW1lID09PSAnZmlndXJlJykge1xuICAgICAgICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLmZpbHRlcihub2RlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnQ29tbWVudCcpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnVGV4dCcpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdleF9ub25fd2hpdGVzcGFjZV9jaGFyYWN0ZXIudGVzdChub2RlLmRhdGEpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGNoaWxkcmVuLmZpbmRJbmRleChjaGlsZCA9PiBjaGlsZC5uYW1lID09PSAnZmlnY2FwdGlvbicpO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSAmJiAoaW5kZXggIT09IDAgJiYgaW5kZXggIT09IGNoaWxkcmVuLmxlbmd0aCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4oY2hpbGRyZW5baW5kZXhdLCBjb21waWxlcl93YXJuaW5ncy5hMTF5X3N0cnVjdHVyZV9maXJzdF9vcl9sYXN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFuZGxlcnNfbWFwLmhhcygnbW91c2VvdmVyJykgJiYgIWhhbmRsZXJzX21hcC5oYXMoJ2ZvY3VzJykpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKHRoaXMsIGNvbXBpbGVyX3dhcm5pbmdzLmExMXlfbW91c2VfZXZlbnRzX2hhdmVfa2V5X2V2ZW50cygnbW91c2VvdmVyJywgJ2ZvY3VzJykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoYW5kbGVyc19tYXAuaGFzKCdtb3VzZW91dCcpICYmICFoYW5kbGVyc19tYXAuaGFzKCdibHVyJykpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKHRoaXMsIGNvbXBpbGVyX3dhcm5pbmdzLmExMXlfbW91c2VfZXZlbnRzX2hhdmVfa2V5X2V2ZW50cygnbW91c2VvdXQnLCAnYmx1cicpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YWxpZGF0ZV9iaW5kaW5nc19mb3JlaWduKCkge1xuICAgICAgICB0aGlzLmJpbmRpbmdzLmZvckVhY2goYmluZGluZyA9PiB7XG4gICAgICAgICAgICBpZiAoYmluZGluZy5uYW1lICE9PSAndGhpcycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQuZXJyb3IoYmluZGluZywgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfYmluZGluZ19mb3JlaWduKGJpbmRpbmcubmFtZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdmFsaWRhdGVfYmluZGluZ3MoKSB7XG4gICAgICAgIGNvbnN0IHsgY29tcG9uZW50IH0gPSB0aGlzO1xuICAgICAgICBjb25zdCBjaGVja190eXBlX2F0dHJpYnV0ZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IHRoaXMuYXR0cmlidXRlcy5maW5kKChhdHRyaWJ1dGUpID0+IGF0dHJpYnV0ZS5uYW1lID09PSAndHlwZScpO1xuICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICBpZiAoIWF0dHJpYnV0ZS5pc19zdGF0aWMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGF0dHJpYnV0ZSwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfdHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGF0dHJpYnV0ZS5nZXRfc3RhdGljX3ZhbHVlKCk7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGF0dHJpYnV0ZSwgY29tcGlsZXJfZXJyb3JzLm1pc3NpbmdfdHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuYmluZGluZ3MuZm9yRWFjaChiaW5kaW5nID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgbmFtZSB9ID0gYmluZGluZztcbiAgICAgICAgICAgIGlmIChuYW1lID09PSAndmFsdWUnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubmFtZSAhPT0gJ2lucHV0JyAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hbWUgIT09ICd0ZXh0YXJlYScgJiZcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYW1lICE9PSAnc2VsZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGJpbmRpbmcsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2JpbmRpbmdfZWxlbWVudHModGhpcy5uYW1lLCAndmFsdWUnKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgPT09ICdzZWxlY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IHRoaXMuYXR0cmlidXRlcy5maW5kKChhdHRyaWJ1dGUpID0+IGF0dHJpYnV0ZS5uYW1lID09PSAnbXVsdGlwbGUnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZSAmJiAhYXR0cmlidXRlLmlzX3N0YXRpYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihhdHRyaWJ1dGUsIGNvbXBpbGVyX2Vycm9ycy5keW5hbWljX211bHRpcGxlX2F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrX3R5cGVfYXR0cmlidXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gJ2NoZWNrZWQnIHx8IG5hbWUgPT09ICdpbmRldGVybWluYXRlJykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgIT09ICdpbnB1dCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihiaW5kaW5nLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX2VsZW1lbnRzKHRoaXMubmFtZSwgbmFtZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gY2hlY2tfdHlwZV9hdHRyaWJ1dGUoKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSAhPT0gJ2NoZWNrYm94Jykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGJpbmRpbmcsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2JpbmRpbmdfbm9fY2hlY2tib3gobmFtZSwgdHlwZSA9PT0gJ3JhZGlvJykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5hbWUgPT09ICdncm91cCcpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5uYW1lICE9PSAnaW5wdXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYmluZGluZywgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfYmluZGluZ19lbGVtZW50cyh0aGlzLm5hbWUsICdncm91cCcpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgdHlwZSA9IGNoZWNrX3R5cGVfYXR0cmlidXRlKCk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgIT09ICdjaGVja2JveCcgJiYgdHlwZSAhPT0gJ3JhZGlvJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGJpbmRpbmcsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2JpbmRpbmdfZWxlbWVudF93aXRoKCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCI+IG9yIDxpbnB1dCB0eXBlPVwicmFkaW9cIj4nLCAnZ3JvdXAnKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gJ2ZpbGVzJykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgIT09ICdpbnB1dCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihiaW5kaW5nLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX2VsZW1lbnRzKHRoaXMubmFtZSwgJ2ZpbGVzJykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gY2hlY2tfdHlwZV9hdHRyaWJ1dGUoKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSAhPT0gJ2ZpbGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYmluZGluZywgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfYmluZGluZ19lbGVtZW50X3dpdGgoJzxpbnB1dCB0eXBlPVwiZmlsZVwiPicsICdmaWxlcycpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChuYW1lID09PSAnb3BlbicpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5uYW1lICE9PSAnZGV0YWlscycpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihiaW5kaW5nLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX2VsZW1lbnRfd2l0aCgnPGRldGFpbHM+JywgbmFtZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5hbWUgPT09ICdjdXJyZW50VGltZScgfHxcbiAgICAgICAgICAgICAgICBuYW1lID09PSAnZHVyYXRpb24nIHx8XG4gICAgICAgICAgICAgICAgbmFtZSA9PT0gJ3BhdXNlZCcgfHxcbiAgICAgICAgICAgICAgICBuYW1lID09PSAnYnVmZmVyZWQnIHx8XG4gICAgICAgICAgICAgICAgbmFtZSA9PT0gJ3NlZWthYmxlJyB8fFxuICAgICAgICAgICAgICAgIG5hbWUgPT09ICdwbGF5ZWQnIHx8XG4gICAgICAgICAgICAgICAgbmFtZSA9PT0gJ3ZvbHVtZScgfHxcbiAgICAgICAgICAgICAgICBuYW1lID09PSAnbXV0ZWQnIHx8XG4gICAgICAgICAgICAgICAgbmFtZSA9PT0gJ3BsYXliYWNrUmF0ZScgfHxcbiAgICAgICAgICAgICAgICBuYW1lID09PSAnc2Vla2luZycgfHxcbiAgICAgICAgICAgICAgICBuYW1lID09PSAnZW5kZWQnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubmFtZSAhPT0gJ2F1ZGlvJyAmJiB0aGlzLm5hbWUgIT09ICd2aWRlbycpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihiaW5kaW5nLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX2VsZW1lbnRfd2l0aCgnYXVkaW8+IG9yIDx2aWRlbz4nLCBuYW1lKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gJ3ZpZGVvSGVpZ2h0JyB8fFxuICAgICAgICAgICAgICAgIG5hbWUgPT09ICd2aWRlb1dpZHRoJykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgIT09ICd2aWRlbycpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihiaW5kaW5nLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX2VsZW1lbnRfd2l0aCgnPHZpZGVvPicsIG5hbWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChyZWdleF9kaW1lbnNpb25zLnRlc3QobmFtZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5uYW1lID09PSAnc3ZnJyAmJiAobmFtZSA9PT0gJ29mZnNldFdpZHRoJyB8fCBuYW1lID09PSAnb2Zmc2V0SGVpZ2h0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihiaW5kaW5nLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX29uKGJpbmRpbmcubmFtZSwgYDxzdmc+LiBVc2UgJyR7bmFtZS5yZXBsYWNlKCdvZmZzZXQnLCAnY2xpZW50Jyl9JyBpbnN0ZWFkYCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc19zdmcodGhpcy5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGJpbmRpbmcsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2JpbmRpbmdfb24oYmluZGluZy5uYW1lLCAnU1ZHIGVsZW1lbnRzJykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc192b2lkKHRoaXMubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihiaW5kaW5nLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX29uKGJpbmRpbmcubmFtZSwgYHZvaWQgZWxlbWVudHMgbGlrZSA8JHt0aGlzLm5hbWV9Pi4gVXNlIGEgd3JhcHBlciBlbGVtZW50IGluc3RlYWRgKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gJ3RleHRDb250ZW50JyB8fFxuICAgICAgICAgICAgICAgIG5hbWUgPT09ICdpbm5lckhUTUwnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudGVkaXRhYmxlID0gdGhpcy5hdHRyaWJ1dGVzLmZpbmQoKGF0dHJpYnV0ZSkgPT4gYXR0cmlidXRlLm5hbWUgPT09ICdjb250ZW50ZWRpdGFibGUnKTtcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnRlZGl0YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGJpbmRpbmcsIGNvbXBpbGVyX2Vycm9ycy5taXNzaW5nX2NvbnRlbnRlZGl0YWJsZV9hdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjb250ZW50ZWRpdGFibGUgJiYgIWNvbnRlbnRlZGl0YWJsZS5pc19zdGF0aWMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihjb250ZW50ZWRpdGFibGUsIGNvbXBpbGVyX2Vycm9ycy5keW5hbWljX2NvbnRlbnRlZGl0YWJsZV9hdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5hbWUgIT09ICd0aGlzJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYmluZGluZywgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfYmluZGluZyhiaW5kaW5nLm5hbWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHZhbGlkYXRlX2NvbnRlbnQoKSB7XG4gICAgICAgIGlmICghYTExeV9yZXF1aXJlZF9jb250ZW50Lmhhcyh0aGlzLm5hbWUpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAodGhpcy5iaW5kaW5nc1xuICAgICAgICAgICAgLnNvbWUoKGJpbmRpbmcpID0+IFsndGV4dENvbnRlbnQnLCAnaW5uZXJIVE1MJ10uaW5jbHVkZXMoYmluZGluZy5uYW1lKSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5jb21wb25lbnQud2Fybih0aGlzLCBjb21waWxlcl93YXJuaW5ncy5hMTF5X21pc3NpbmdfY29udGVudCh0aGlzLm5hbWUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YWxpZGF0ZV9ldmVudF9oYW5kbGVycygpIHtcbiAgICAgICAgY29uc3QgeyBjb21wb25lbnQgfSA9IHRoaXM7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuZm9yRWFjaChoYW5kbGVyID0+IHtcbiAgICAgICAgICAgIGlmIChoYW5kbGVyLm1vZGlmaWVycy5oYXMoJ3Bhc3NpdmUnKSAmJiBoYW5kbGVyLm1vZGlmaWVycy5oYXMoJ3ByZXZlbnREZWZhdWx0JykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGhhbmRsZXIsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2V2ZW50X21vZGlmaWVyX2NvbWJpbmF0aW9uKCdwYXNzaXZlJywgJ3ByZXZlbnREZWZhdWx0JykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhhbmRsZXIubW9kaWZpZXJzLmhhcygncGFzc2l2ZScpICYmIGhhbmRsZXIubW9kaWZpZXJzLmhhcygnbm9ucGFzc2l2ZScpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihoYW5kbGVyLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9ldmVudF9tb2RpZmllcl9jb21iaW5hdGlvbigncGFzc2l2ZScsICdub25wYXNzaXZlJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGFuZGxlci5tb2RpZmllcnMuZm9yRWFjaChtb2RpZmllciA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCF2YWxpZF9tb2RpZmllcnMkMS5oYXMobW9kaWZpZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoaGFuZGxlciwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfZXZlbnRfbW9kaWZpZXIobGlzdCQxKEFycmF5LmZyb20odmFsaWRfbW9kaWZpZXJzJDEpKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobW9kaWZpZXIgPT09ICdwYXNzaXZlJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFzc2l2ZV9ldmVudHMuaGFzKGhhbmRsZXIubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyLmNhbl9tYWtlX3Bhc3NpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQud2FybihoYW5kbGVyLCBjb21waWxlcl93YXJuaW5ncy5yZWR1bmRhbnRfZXZlbnRfbW9kaWZpZXJfZm9yX3RvdWNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKGhhbmRsZXIsIGNvbXBpbGVyX3dhcm5pbmdzLnJlZHVuZGFudF9ldmVudF9tb2RpZmllcl9wYXNzaXZlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5sZWdhY3kgJiYgKG1vZGlmaWVyID09PSAnb25jZScgfHwgbW9kaWZpZXIgPT09ICdwYXNzaXZlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyB0aGlzIGNvdWxkIGJlIHN1cHBvcnRlZCwgYnV0IGl0IHdvdWxkIG5lZWQgYSBmZXcgY2hhbmdlcyB0b1xuICAgICAgICAgICAgICAgICAgICAvLyBob3cgZXZlbnQgbGlzdGVuZXJzIHdvcmtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihoYW5kbGVyLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9ldmVudF9tb2RpZmllcl9sZWdhY3kobW9kaWZpZXIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChwYXNzaXZlX2V2ZW50cy5oYXMoaGFuZGxlci5uYW1lKSAmJiBoYW5kbGVyLmNhbl9tYWtlX3Bhc3NpdmUgJiYgIWhhbmRsZXIubW9kaWZpZXJzLmhhcygncHJldmVudERlZmF1bHQnKSAmJiAhaGFuZGxlci5tb2RpZmllcnMuaGFzKCdub25wYXNzaXZlJykpIHtcbiAgICAgICAgICAgICAgICAvLyB0b3VjaC93aGVlbCBldmVudHMgc2hvdWxkIGJlIHBhc3NpdmUgYnkgZGVmYXVsdFxuICAgICAgICAgICAgICAgIGhhbmRsZXIubW9kaWZpZXJzLmFkZCgncGFzc2l2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaXNfbWVkaWFfbm9kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZSA9PT0gJ2F1ZGlvJyB8fCB0aGlzLm5hbWUgPT09ICd2aWRlbyc7XG4gICAgfVxuICAgIGFkZF9jc3NfY2xhc3MoKSB7XG4gICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMuc29tZShhdHRyID0+IGF0dHIuaXNfc3ByZWFkKSkge1xuICAgICAgICAgICAgdGhpcy5uZWVkc19tYW51YWxfc3R5bGVfc2NvcGluZyA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBpZCB9ID0gdGhpcy5jb21wb25lbnQuc3R5bGVzaGVldDtcbiAgICAgICAgY29uc3QgY2xhc3NfYXR0cmlidXRlID0gdGhpcy5hdHRyaWJ1dGVzLmZpbmQoYSA9PiBhLm5hbWUgPT09ICdjbGFzcycpO1xuICAgICAgICBpZiAoY2xhc3NfYXR0cmlidXRlICYmICFjbGFzc19hdHRyaWJ1dGUuaXNfdHJ1ZSkge1xuICAgICAgICAgICAgaWYgKGNsYXNzX2F0dHJpYnV0ZS5jaHVua3MubGVuZ3RoID09PSAxICYmIGNsYXNzX2F0dHJpYnV0ZS5jaHVua3NbMF0udHlwZSA9PT0gJ1RleHQnKSB7XG4gICAgICAgICAgICAgICAgY2xhc3NfYXR0cmlidXRlLmNodW5rc1swXS5kYXRhICs9IGAgJHtpZH1gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2xhc3NfYXR0cmlidXRlLmNodW5rcy5wdXNoKG5ldyBUZXh0KHRoaXMuY29tcG9uZW50LCB0aGlzLCB0aGlzLnNjb3BlLCB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdUZXh0JyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogYCAke2lkfWAsXG4gICAgICAgICAgICAgICAgICAgIHN5bnRoZXRpYzogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5wdXNoKG5ldyBBdHRyaWJ1dGUodGhpcy5jb21wb25lbnQsIHRoaXMsIHRoaXMuc2NvcGUsIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnQXR0cmlidXRlJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnY2xhc3MnLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbeyB0eXBlOiAnVGV4dCcsIGRhdGE6IGlkLCBzeW50aGV0aWM6IHRydWUgfV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgc2xvdF90ZW1wbGF0ZV9uYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLmZpbmQoYXR0cmlidXRlID0+IGF0dHJpYnV0ZS5uYW1lID09PSAnc2xvdCcpLmdldF9zdGF0aWNfdmFsdWUoKTtcbiAgICB9XG4gICAgb3B0aW1pc2UoKSB7XG4gICAgICAgIGF0dHJpYnV0ZXNfdG9fY29tcGFjdF93aGl0ZXNwYWNlLmZvckVhY2goYXR0cmlidXRlX25hbWUgPT4ge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gdGhpcy5hdHRyaWJ1dGVzLmZpbmQoYSA9PiBhLm5hbWUgPT09IGF0dHJpYnV0ZV9uYW1lKTtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUgJiYgIWF0dHJpYnV0ZS5pc190cnVlKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlLmNodW5rcy5mb3JFYWNoKChjaHVuaywgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNodW5rLnR5cGUgPT09ICdUZXh0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSBjaHVuay5kYXRhLnJlcGxhY2UocmVnZXhfYW55X3JlcGVhdGVkX3doaXRlc3BhY2VzLCAnICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGRhdGEudHJpbUxlZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGluZGV4ID09PSBhdHRyaWJ1dGUuY2h1bmtzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZGF0YS50cmltUmlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmNvbnN0IHJlZ2V4X3N0YXJ0c193aXRoX3ZvdmVsID0gL15bYWVpb3VdLztcbmZ1bmN0aW9uIHNob3VsZF9oYXZlX2F0dHJpYnV0ZShub2RlLCBhdHRyaWJ1dGVzLCBuYW1lID0gbm9kZS5uYW1lKSB7XG4gICAgY29uc3QgYXJ0aWNsZSA9IHJlZ2V4X3N0YXJ0c193aXRoX3ZvdmVsLnRlc3QoYXR0cmlidXRlc1swXSkgPyAnYW4nIDogJ2EnO1xuICAgIGNvbnN0IHNlcXVlbmNlID0gYXR0cmlidXRlcy5sZW5ndGggPiAxID9cbiAgICAgICAgYXR0cmlidXRlcy5zbGljZSgwLCAtMSkuam9pbignLCAnKSArIGAgb3IgJHthdHRyaWJ1dGVzW2F0dHJpYnV0ZXMubGVuZ3RoIC0gMV19YCA6XG4gICAgICAgIGF0dHJpYnV0ZXNbMF07XG4gICAgbm9kZS5jb21wb25lbnQud2Fybihub2RlLCBjb21waWxlcl93YXJuaW5ncy5hMTF5X21pc3NpbmdfYXR0cmlidXRlKG5hbWUsIGFydGljbGUsIHNlcXVlbmNlKSk7XG59XG5jb25zdCByZWdleF9taW51c19zaWduID0gLy0vO1xuZnVuY3Rpb24gd2l0aGluX2N1c3RvbV9lbGVtZW50KHBhcmVudCkge1xuICAgIHdoaWxlIChwYXJlbnQpIHtcbiAgICAgICAgaWYgKHBhcmVudC50eXBlID09PSAnSW5saW5lQ29tcG9uZW50JylcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKHBhcmVudC50eXBlID09PSAnRWxlbWVudCcgJiYgcmVnZXhfbWludXNfc2lnbi50ZXN0KHBhcmVudC5uYW1lKSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kYXJrc2t5YXBwL3N0cmluZy1oYXNoL2Jsb2IvbWFzdGVyL2luZGV4LmpzXG5jb25zdCByZWdleF9yZXR1cm5fY2hhcmFjdGVycyA9IC9cXHIvZztcbmZ1bmN0aW9uIGhhc2goc3RyKSB7XG4gICAgc3RyID0gc3RyLnJlcGxhY2UocmVnZXhfcmV0dXJuX2NoYXJhY3RlcnMsICcnKTtcbiAgICBsZXQgaGFzaCA9IDUzODE7XG4gICAgbGV0IGkgPSBzdHIubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSBeIHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIHJldHVybiAoaGFzaCA+Pj4gMCkudG9TdHJpbmcoMzYpO1xufVxuXG5jbGFzcyBIZWFkIGV4dGVuZHMgTm9kZSQxIHtcbiAgICBjb25zdHJ1Y3Rvcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pIHtcbiAgICAgICAgc3VwZXIoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKTtcbiAgICAgICAgaWYgKGluZm8uYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcihpbmZvLmF0dHJpYnV0ZXNbMF0sIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2F0dHJpYnV0ZV9oZWFkKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoaWxkcmVuID0gbWFwX2NoaWxkcmVuKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mby5jaGlsZHJlbi5maWx0ZXIoY2hpbGQgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIChjaGlsZC50eXBlICE9PSAnVGV4dCcgfHwgcmVnZXhfbm9uX3doaXRlc3BhY2VfY2hhcmFjdGVyLnRlc3QoY2hpbGQuZGF0YSkpO1xuICAgICAgICB9KSk7XG4gICAgICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBgc3ZlbHRlLSR7aGFzaCh0aGlzLmNvbXBvbmVudC5zb3VyY2Uuc2xpY2UodGhpcy5zdGFydCwgdGhpcy5lbmQpKX1gO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5jbGFzcyBJZkJsb2NrIGV4dGVuZHMgQWJzdHJhY3RCbG9jayB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZS5jaGlsZCgpO1xuICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBuZXcgRXhwcmVzc2lvbihjb21wb25lbnQsIHRoaXMsIHRoaXMuc2NvcGUsIGluZm8uZXhwcmVzc2lvbik7XG4gICAgICAgIChbdGhpcy5jb25zdF90YWdzLCB0aGlzLmNoaWxkcmVuXSA9IGdldF9jb25zdF90YWdzKGluZm8uY2hpbGRyZW4sIGNvbXBvbmVudCwgdGhpcywgdGhpcykpO1xuICAgICAgICB0aGlzLmVsc2UgPSBpbmZvLmVsc2VcbiAgICAgICAgICAgID8gbmV3IEVsc2VCbG9jayhjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpbmZvLmVsc2UpXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIHRoaXMud2Fybl9pZl9lbXB0eV9ibG9jaygpO1xuICAgIH1cbn1cblxuY2xhc3MgSW5saW5lQ29tcG9uZW50IGV4dGVuZHMgTm9kZSQxIHtcbiAgICBjb25zdHJ1Y3Rvcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pIHtcbiAgICAgICAgc3VwZXIoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gW107XG4gICAgICAgIHRoaXMuYmluZGluZ3MgPSBbXTtcbiAgICAgICAgdGhpcy5oYW5kbGVycyA9IFtdO1xuICAgICAgICB0aGlzLmxldHMgPSBbXTtcbiAgICAgICAgdGhpcy5jc3NfY3VzdG9tX3Byb3BlcnRpZXMgPSBbXTtcbiAgICAgICAgaWYgKGluZm8ubmFtZSAhPT0gJ3N2ZWx0ZTpjb21wb25lbnQnICYmIGluZm8ubmFtZSAhPT0gJ3N2ZWx0ZTpzZWxmJykge1xuICAgICAgICAgICAgY29uc3QgbmFtZSA9IGluZm8ubmFtZS5zcGxpdCgnLicpWzBdOyAvLyBhY2NvbW1vZGF0ZSBuYW1lc3BhY2VzXG4gICAgICAgICAgICBjb21wb25lbnQud2Fybl9pZl91bmRlZmluZWQobmFtZSwgaW5mbywgc2NvcGUpO1xuICAgICAgICAgICAgY29tcG9uZW50LmFkZF9yZWZlcmVuY2UodGhpcywgbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYW1lID0gaW5mby5uYW1lO1xuICAgICAgICB0aGlzLm5hbWVzcGFjZSA9IGdldF9uYW1lc3BhY2UkMShwYXJlbnQsIGNvbXBvbmVudC5uYW1lc3BhY2UpO1xuICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSB0aGlzLm5hbWUgPT09ICdzdmVsdGU6Y29tcG9uZW50J1xuICAgICAgICAgICAgPyBuZXcgRXhwcmVzc2lvbihjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpbmZvLmV4cHJlc3Npb24pXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIGluZm8uYXR0cmlidXRlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZmFsbHRocm91Z2ggKi9cbiAgICAgICAgICAgIHN3aXRjaCAobm9kZS50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnQWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihub2RlLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9hY3Rpb24pO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0F0dHJpYnV0ZSc6XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm5hbWUuc3RhcnRzV2l0aCgnLS0nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jc3NfY3VzdG9tX3Byb3BlcnRpZXMucHVzaChuZXcgQXR0cmlidXRlKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZmFsbHRocm91Z2hcbiAgICAgICAgICAgICAgICBjYXNlICdTcHJlYWQnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMucHVzaChuZXcgQXR0cmlidXRlKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQmluZGluZyc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZGluZ3MucHVzaChuZXcgQmluZGluZyhjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBub2RlKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0NsYXNzJzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihub2RlLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9jbGFzcyk7XG4gICAgICAgICAgICAgICAgY2FzZSAnRXZlbnRIYW5kbGVyJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVycy5wdXNoKG5ldyBFdmVudEhhbmRsZXIoY29tcG9uZW50LCB0aGlzLCBzY29wZSwgbm9kZSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdMZXQnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxldHMucHVzaChuZXcgTGV0KGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnVHJhbnNpdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3Iobm9kZSwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfdHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgY2FzZSAnU3R5bGVEaXJlY3RpdmUnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKG5vZGUsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2NvbXBvbmVudF9zdHlsZV9kaXJlY3RpdmUpO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm90IGltcGxlbWVudGVkOiAke25vZGUudHlwZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGVzbGludC1lbmFibGUgbm8tZmFsbHRocm91Z2ggKi9cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLmxldHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlLmNoaWxkKCk7XG4gICAgICAgICAgICB0aGlzLmxldHMuZm9yRWFjaChsID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBuZXcgU2V0KFtsLm5hbWUubmFtZV0pO1xuICAgICAgICAgICAgICAgIGwubmFtZXMuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY29wZS5hZGQobmFtZSwgZGVwZW5kZW5jaWVzLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuZm9yRWFjaChoYW5kbGVyID0+IHtcbiAgICAgICAgICAgIGhhbmRsZXIubW9kaWZpZXJzLmZvckVhY2gobW9kaWZpZXIgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChtb2RpZmllciAhPT0gJ29uY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoaGFuZGxlciwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfZXZlbnRfbW9kaWZpZXJfY29tcG9uZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSBpbmZvLmNoaWxkcmVuLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IGluZm8uY2hpbGRyZW5baV07XG4gICAgICAgICAgICBpZiAoY2hpbGQudHlwZSA9PT0gJ1Nsb3RUZW1wbGF0ZScpIHtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGNoaWxkKTtcbiAgICAgICAgICAgICAgICBpbmZvLmNoaWxkcmVuLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKChjaGlsZC50eXBlID09PSAnRWxlbWVudCcgfHwgY2hpbGQudHlwZSA9PT0gJ0lubGluZUNvbXBvbmVudCcgfHwgY2hpbGQudHlwZSA9PT0gJ1Nsb3QnKSAmJiBjaGlsZC5hdHRyaWJ1dGVzLmZpbmQoYXR0cmlidXRlID0+IGF0dHJpYnV0ZS5uYW1lID09PSAnc2xvdCcpKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2xvdF90ZW1wbGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGNoaWxkLnN0YXJ0LFxuICAgICAgICAgICAgICAgICAgICBlbmQ6IGNoaWxkLmVuZCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1Nsb3RUZW1wbGF0ZScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdzdmVsdGU6ZnJhZ21lbnQnLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtjaGlsZF1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIC8vIHRyYW5zZmVyIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gY2hpbGQuYXR0cmlidXRlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSBjaGlsZC5hdHRyaWJ1dGVzW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLnR5cGUgPT09ICdMZXQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzbG90X3RlbXBsYXRlLmF0dHJpYnV0ZXMucHVzaChhdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuYXR0cmlidXRlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYXR0cmlidXRlLnR5cGUgPT09ICdBdHRyaWJ1dGUnICYmIGF0dHJpYnV0ZS5uYW1lID09PSAnc2xvdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsb3RfdGVtcGxhdGUuYXR0cmlidXRlcy5wdXNoKGF0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gdHJhbnNmZXIgY29uc3RcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gY2hpbGQuY2hpbGRyZW4ubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGRfY2hpbGQgPSBjaGlsZC5jaGlsZHJlbltpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkX2NoaWxkLnR5cGUgPT09ICdDb25zdFRhZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsb3RfdGVtcGxhdGUuY2hpbGRyZW4ucHVzaChjaGlsZF9jaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5jaGlsZHJlbi5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2hpbGRyZW4ucHVzaChzbG90X3RlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICBpbmZvLmNoaWxkcmVuLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5mby5jaGlsZHJlbi5zb21lKG5vZGUgPT4gbm90X3doaXRlc3BhY2VfdGV4dChub2RlKSkpIHtcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goe1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBpbmZvLnN0YXJ0LFxuICAgICAgICAgICAgICAgIGVuZDogaW5mby5lbmQsXG4gICAgICAgICAgICAgICAgdHlwZTogJ1Nsb3RUZW1wbGF0ZScsXG4gICAgICAgICAgICAgICAgbmFtZTogJ3N2ZWx0ZTpmcmFnbWVudCcsXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogW10sXG4gICAgICAgICAgICAgICAgY2hpbGRyZW46IGluZm8uY2hpbGRyZW5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBtYXBfY2hpbGRyZW4oY29tcG9uZW50LCB0aGlzLCB0aGlzLnNjb3BlLCBjaGlsZHJlbik7XG4gICAgfVxuICAgIGdldCBzbG90X3RlbXBsYXRlX25hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZXMuZmluZChhdHRyaWJ1dGUgPT4gYXR0cmlidXRlLm5hbWUgPT09ICdzbG90JykuZ2V0X3N0YXRpY192YWx1ZSgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG5vdF93aGl0ZXNwYWNlX3RleHQobm9kZSkge1xuICAgIHJldHVybiAhKG5vZGUudHlwZSA9PT0gJ1RleHQnICYmIHJlZ2V4X29ubHlfd2hpdGVzcGFjZXMudGVzdChub2RlLmRhdGEpKTtcbn1cbmZ1bmN0aW9uIGdldF9uYW1lc3BhY2UkMShwYXJlbnQsIGV4cGxpY2l0X25hbWVzcGFjZSkge1xuICAgIGNvbnN0IHBhcmVudF9lbGVtZW50ID0gcGFyZW50LmZpbmRfbmVhcmVzdCgvXkVsZW1lbnQvKTtcbiAgICBpZiAoIXBhcmVudF9lbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBleHBsaWNpdF9uYW1lc3BhY2U7XG4gICAgfVxuICAgIHJldHVybiBwYXJlbnRfZWxlbWVudC5uYW1lc3BhY2U7XG59XG5cbmNsYXNzIEtleUJsb2NrIGV4dGVuZHMgQWJzdHJhY3RCbG9jayB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IG5ldyBFeHByZXNzaW9uKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIGluZm8uZXhwcmVzc2lvbik7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBtYXBfY2hpbGRyZW4oY29tcG9uZW50LCB0aGlzLCBzY29wZSwgaW5mby5jaGlsZHJlbik7XG4gICAgICAgIHRoaXMud2Fybl9pZl9lbXB0eV9ibG9jaygpO1xuICAgIH1cbn1cblxuY2xhc3MgVGFnIGV4dGVuZHMgTm9kZSQxIHtcbiAgICBjb25zdHJ1Y3Rvcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pIHtcbiAgICAgICAgc3VwZXIoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKTtcbiAgICAgICAgdGhpcy5leHByZXNzaW9uID0gbmV3IEV4cHJlc3Npb24oY29tcG9uZW50LCB0aGlzLCBzY29wZSwgaW5mby5leHByZXNzaW9uKTtcbiAgICAgICAgdGhpcy5zaG91bGRfY2FjaGUgPSAoaW5mby5leHByZXNzaW9uLnR5cGUgIT09ICdJZGVudGlmaWVyJyB8fFxuICAgICAgICAgICAgKHRoaXMuZXhwcmVzc2lvbi5kZXBlbmRlbmNpZXMuc2l6ZSAmJiBzY29wZS5uYW1lcy5oYXMoaW5mby5leHByZXNzaW9uLm5hbWUpKSk7XG4gICAgfVxufVxuXG5jbGFzcyBNdXN0YWNoZVRhZyBleHRlbmRzIFRhZyB7XG59XG5cbmNsYXNzIE9wdGlvbnMgZXh0ZW5kcyBOb2RlJDEge1xufVxuXG5jbGFzcyBSYXdNdXN0YWNoZVRhZyBleHRlbmRzIFRhZyB7XG59XG5cbmNsYXNzIERlYnVnVGFnIGV4dGVuZHMgTm9kZSQxIHtcbiAgICBjb25zdHJ1Y3Rvcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pIHtcbiAgICAgICAgc3VwZXIoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKTtcbiAgICAgICAgdGhpcy5leHByZXNzaW9ucyA9IGluZm8uaWRlbnRpZmllcnMubWFwKChub2RlKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEV4cHJlc3Npb24oY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBub2RlKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5jbGFzcyBTbG90IGV4dGVuZHMgRWxlbWVudCB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMudmFsdWVzID0gbmV3IE1hcCgpO1xuICAgICAgICBpbmZvLmF0dHJpYnV0ZXMuZm9yRWFjaChhdHRyID0+IHtcbiAgICAgICAgICAgIGlmIChhdHRyLnR5cGUgIT09ICdBdHRyaWJ1dGUnICYmIGF0dHIudHlwZSAhPT0gJ1NwcmVhZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGF0dHIsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX3Nsb3RfZGlyZWN0aXZlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhdHRyLm5hbWUgPT09ICduYW1lJykge1xuICAgICAgICAgICAgICAgIGlmIChhdHRyLnZhbHVlLmxlbmd0aCAhPT0gMSB8fCBhdHRyLnZhbHVlWzBdLnR5cGUgIT09ICdUZXh0Jykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGF0dHIsIGNvbXBpbGVyX2Vycm9ycy5keW5hbWljX3Nsb3RfbmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2xvdF9uYW1lID0gYXR0ci52YWx1ZVswXS5kYXRhO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNsb3RfbmFtZSA9PT0gJ2RlZmF1bHQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYXR0ciwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfc2xvdF9uYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnZhbHVlcy5zZXQoYXR0ci5uYW1lLCBuZXcgQXR0cmlidXRlKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIGF0dHIpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghdGhpcy5zbG90X25hbWUpXG4gICAgICAgICAgICB0aGlzLnNsb3RfbmFtZSA9ICdkZWZhdWx0JztcbiAgICAgICAgaWYgKHRoaXMuc2xvdF9uYW1lID09PSAnZGVmYXVsdCcpIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgdGhlIGRlZmF1bHQgc2xvdCwgYWRkIG91ciBkZXBlbmRlbmNpZXMgdG8gYW55XG4gICAgICAgICAgICAvLyBvdGhlciBzbG90cyAod2hpY2ggaW5oZXJpdCBvdXIgc2xvdCB2YWx1ZXMpIHRoYXQgd2VyZVxuICAgICAgICAgICAgLy8gcHJldmlvdXNseSBlbmNvdW50ZXJlZFxuICAgICAgICAgICAgY29tcG9uZW50LnNsb3RzLmZvckVhY2goKHNsb3QpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlcy5mb3JFYWNoKChhdHRyaWJ1dGUsIG5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzbG90LnZhbHVlcy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsb3QudmFsdWVzLnNldChuYW1lLCBhdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb21wb25lbnQuc2xvdHMuaGFzKCdkZWZhdWx0JykpIHtcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSwgZ28gdGhlIG90aGVyIHdheSDigJQgaW5oZXJpdCB2YWx1ZXMgZnJvbVxuICAgICAgICAgICAgLy8gYSBwcmV2aW91c2x5IGVuY291bnRlcmVkIGRlZmF1bHQgc2xvdFxuICAgICAgICAgICAgY29uc3QgZGVmYXVsdF9zbG90ID0gY29tcG9uZW50LnNsb3RzLmdldCgnZGVmYXVsdCcpO1xuICAgICAgICAgICAgZGVmYXVsdF9zbG90LnZhbHVlcy5mb3JFYWNoKChhdHRyaWJ1dGUsIG5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudmFsdWVzLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlcy5zZXQobmFtZSwgYXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb21wb25lbnQuc2xvdHMuc2V0KHRoaXMuc2xvdF9uYW1lLCB0aGlzKTtcbiAgICB9XG59XG5cbmNsYXNzIFNsb3RUZW1wbGF0ZSBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMubGV0cyA9IFtdO1xuICAgICAgICB0aGlzLnNsb3RfdGVtcGxhdGVfbmFtZSA9ICdkZWZhdWx0JztcbiAgICAgICAgdGhpcy52YWxpZGF0ZV9zbG90X3RlbXBsYXRlX3BsYWNlbWVudCgpO1xuICAgICAgICBzY29wZSA9IHNjb3BlLmNoaWxkKCk7XG4gICAgICAgIGluZm8uYXR0cmlidXRlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKG5vZGUudHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ0xldCc6IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbCA9IG5ldyBMZXQoY29tcG9uZW50LCB0aGlzLCBzY29wZSwgbm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGV0cy5wdXNoKGwpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBuZXcgU2V0KFtsLm5hbWUubmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICBsLm5hbWVzLmZvckVhY2goKG5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmFkZChuYW1lLCBkZXBlbmRlbmNpZXMsIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgJ0F0dHJpYnV0ZSc6IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubmFtZSA9PT0gJ3Nsb3QnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNsb3RfYXR0cmlidXRlID0gbmV3IEF0dHJpYnV0ZShjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zbG90X2F0dHJpYnV0ZS5pc19zdGF0aWMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKG5vZGUsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX3Nsb3RfYXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5zbG90X2F0dHJpYnV0ZS5nZXRfc3RhdGljX3ZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKG5vZGUsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX3Nsb3RfYXR0cmlidXRlX3ZhbHVlX21pc3NpbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zbG90X3RlbXBsYXRlX25hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBhdHRyaWJ1dGUgJyR7bm9kZS5uYW1lfScgaW4gPHN2ZWx0ZTpmcmFnbWVudD5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBOb3QgaW1wbGVtZW50ZWQ6ICR7bm9kZS50eXBlfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgICAgICAoW3RoaXMuY29uc3RfdGFncywgdGhpcy5jaGlsZHJlbl0gPSBnZXRfY29uc3RfdGFncyhpbmZvLmNoaWxkcmVuLCBjb21wb25lbnQsIHRoaXMsIHRoaXMpKTtcbiAgICB9XG4gICAgdmFsaWRhdGVfc2xvdF90ZW1wbGF0ZV9wbGFjZW1lbnQoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC50eXBlICE9PSAnSW5saW5lQ29tcG9uZW50Jykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50LmVycm9yKHRoaXMsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX3Nsb3R0ZWRfY29udGVudF9mcmFnbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIFRpdGxlIGV4dGVuZHMgTm9kZSQxIHtcbiAgICBjb25zdHJ1Y3Rvcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pIHtcbiAgICAgICAgc3VwZXIoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IG1hcF9jaGlsZHJlbihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8uY2hpbGRyZW4pO1xuICAgICAgICBpZiAoaW5mby5hdHRyaWJ1dGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcihpbmZvLmF0dHJpYnV0ZXNbMF0sIGNvbXBpbGVyX2Vycm9ycy5pbGxlZ2FsX2F0dHJpYnV0ZV90aXRsZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaW5mby5jaGlsZHJlbi5mb3JFYWNoKGNoaWxkID0+IHtcbiAgICAgICAgICAgIGlmIChjaGlsZC50eXBlICE9PSAnVGV4dCcgJiYgY2hpbGQudHlwZSAhPT0gJ011c3RhY2hlVGFnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoY2hpbGQsIGNvbXBpbGVyX2Vycm9ycy5pbGxlZ2FsX3N0cnVjdHVyZV90aXRsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNob3VsZF9jYWNoZSA9IGluZm8uY2hpbGRyZW4ubGVuZ3RoID09PSAxXG4gICAgICAgICAgICA/IChpbmZvLmNoaWxkcmVuWzBdLnR5cGUgIT09ICdJZGVudGlmaWVyJyB8fFxuICAgICAgICAgICAgICAgIHNjb3BlLm5hbWVzLmhhcyhpbmZvLmNoaWxkcmVuWzBdLm5hbWUpKVxuICAgICAgICAgICAgOiB0cnVlO1xuICAgIH1cbn1cblxuY29uc3QgdmFsaWRfYmluZGluZ3MgPSBbXG4gICAgJ2lubmVyV2lkdGgnLFxuICAgICdpbm5lckhlaWdodCcsXG4gICAgJ291dGVyV2lkdGgnLFxuICAgICdvdXRlckhlaWdodCcsXG4gICAgJ3Njcm9sbFgnLFxuICAgICdzY3JvbGxZJyxcbiAgICAnb25saW5lJ1xuXTtcbmNsYXNzIFdpbmRvdyBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBpbmZvKSB7XG4gICAgICAgIHN1cGVyKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5iaW5kaW5ncyA9IFtdO1xuICAgICAgICB0aGlzLmFjdGlvbnMgPSBbXTtcbiAgICAgICAgaW5mby5hdHRyaWJ1dGVzLmZvckVhY2gobm9kZSA9PiB7XG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnRXZlbnRIYW5kbGVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlcnMucHVzaChuZXcgRXZlbnRIYW5kbGVyKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ0JpbmRpbmcnKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuZXhwcmVzc2lvbi50eXBlICE9PSAnSWRlbnRpZmllcicpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBwYXJ0cyB9ID0gZmxhdHRlbl9yZWZlcmVuY2Uobm9kZS5leHByZXNzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyBpcyB0aGlzIGNvbnN0cmFpbnQgbmVjZXNzYXJ5P1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKG5vZGUuZXhwcmVzc2lvbiwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfYmluZGluZ193aW5kb3cocGFydHMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCF+dmFsaWRfYmluZGluZ3MuaW5kZXhPZihub2RlLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gKG5vZGUubmFtZSA9PT0gJ3dpZHRoJyA/ICdpbm5lcldpZHRoJyA6XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLm5hbWUgPT09ICdoZWlnaHQnID8gJ2lubmVySGVpZ2h0JyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnV6enltYXRjaChub2RlLm5hbWUsIHZhbGlkX2JpbmRpbmdzKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihub2RlLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9iaW5kaW5nX29uKG5vZGUubmFtZSwgJzxzdmVsdGU6d2luZG93PicsIGAgKGRpZCB5b3UgbWVhbiAnJHttYXRjaH0nPylgKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKG5vZGUsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX2JpbmRpbmdfb24obm9kZS5uYW1lLCAnPHN2ZWx0ZTp3aW5kb3c+JywgYCDigJQgdmFsaWQgYmluZGluZ3MgYXJlICR7bGlzdCQxKHZhbGlkX2JpbmRpbmdzKX1gKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kaW5ncy5wdXNoKG5ldyBCaW5kaW5nKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ0FjdGlvbicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbnMucHVzaChuZXcgQWN0aW9uKGNvbXBvbmVudCwgdGhpcywgc2NvcGUsIG5vZGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFB1c2hlcyBhbGwgYGl0ZW1zYCBpbnRvIGBhcnJheWAgdXNpbmcgYHB1c2hgLCB0aGVyZWZvcmUgbXV0YXRpbmcgdGhlIGFycmF5LlxuICogV2UgZG8gdGhpcyBmb3IgbWVtb3J5IGFuZCBwZXJmIHJlYXNvbnMsIGFuZCBiZWNhdXNlIGBhcnJheS5wdXNoKC4uLml0ZW1zKWAgd291bGRcbiAqIHJ1biBpbnRvIGEgXCJtYXggY2FsbCBzdGFjayBzaXplIGV4Y2VlZGVkXCIgZXJyb3Igd2l0aCB0b28gbWFueSBpdGVtcyAofjY1aykuXG4gKiBAcGFyYW0gYXJyYXlcbiAqIEBwYXJhbSBpdGVtc1xuICovXG5mdW5jdGlvbiBwdXNoX2FycmF5JDEoYXJyYXksIGl0ZW1zKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBhcnJheS5wdXNoKGl0ZW1zW2ldKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldF9jb25zdHJ1Y3Rvcih0eXBlKSB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgJ0F3YWl0QmxvY2snOiByZXR1cm4gQXdhaXRCbG9jaztcbiAgICAgICAgY2FzZSAnQm9keSc6IHJldHVybiBCb2R5O1xuICAgICAgICBjYXNlICdDb21tZW50JzogcmV0dXJuIENvbW1lbnQkMTtcbiAgICAgICAgY2FzZSAnQ29uc3RUYWcnOiByZXR1cm4gQ29uc3RUYWc7XG4gICAgICAgIGNhc2UgJ0VhY2hCbG9jayc6IHJldHVybiBFYWNoQmxvY2s7XG4gICAgICAgIGNhc2UgJ0VsZW1lbnQnOiByZXR1cm4gRWxlbWVudDtcbiAgICAgICAgY2FzZSAnSGVhZCc6IHJldHVybiBIZWFkO1xuICAgICAgICBjYXNlICdJZkJsb2NrJzogcmV0dXJuIElmQmxvY2s7XG4gICAgICAgIGNhc2UgJ0lubGluZUNvbXBvbmVudCc6IHJldHVybiBJbmxpbmVDb21wb25lbnQ7XG4gICAgICAgIGNhc2UgJ0tleUJsb2NrJzogcmV0dXJuIEtleUJsb2NrO1xuICAgICAgICBjYXNlICdNdXN0YWNoZVRhZyc6IHJldHVybiBNdXN0YWNoZVRhZztcbiAgICAgICAgY2FzZSAnT3B0aW9ucyc6IHJldHVybiBPcHRpb25zO1xuICAgICAgICBjYXNlICdSYXdNdXN0YWNoZVRhZyc6IHJldHVybiBSYXdNdXN0YWNoZVRhZztcbiAgICAgICAgY2FzZSAnRGVidWdUYWcnOiByZXR1cm4gRGVidWdUYWc7XG4gICAgICAgIGNhc2UgJ1Nsb3QnOiByZXR1cm4gU2xvdDtcbiAgICAgICAgY2FzZSAnU2xvdFRlbXBsYXRlJzogcmV0dXJuIFNsb3RUZW1wbGF0ZTtcbiAgICAgICAgY2FzZSAnVGV4dCc6IHJldHVybiBUZXh0O1xuICAgICAgICBjYXNlICdUaXRsZSc6IHJldHVybiBUaXRsZTtcbiAgICAgICAgY2FzZSAnV2luZG93JzogcmV0dXJuIFdpbmRvdztcbiAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEVycm9yKGBOb3QgaW1wbGVtZW50ZWQ6ICR7dHlwZX1gKTtcbiAgICB9XG59XG5mdW5jdGlvbiBtYXBfY2hpbGRyZW4oY29tcG9uZW50LCBwYXJlbnQsIHNjb3BlLCBjaGlsZHJlbikge1xuICAgIGxldCBsYXN0ID0gbnVsbDtcbiAgICBsZXQgaWdub3JlcyA9IFtdO1xuICAgIHJldHVybiBjaGlsZHJlbi5tYXAoY2hpbGQgPT4ge1xuICAgICAgICBjb25zdCBjb25zdHJ1Y3RvciA9IGdldF9jb25zdHJ1Y3RvcihjaGlsZC50eXBlKTtcbiAgICAgICAgY29uc3QgdXNlX2lnbm9yZXMgPSBjaGlsZC50eXBlICE9PSAnVGV4dCcgJiYgY2hpbGQudHlwZSAhPT0gJ0NvbW1lbnQnICYmIGlnbm9yZXMubGVuZ3RoO1xuICAgICAgICBpZiAodXNlX2lnbm9yZXMpXG4gICAgICAgICAgICBjb21wb25lbnQucHVzaF9pZ25vcmVzKGlnbm9yZXMpO1xuICAgICAgICBjb25zdCBub2RlID0gbmV3IGNvbnN0cnVjdG9yKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgY2hpbGQpO1xuICAgICAgICBpZiAodXNlX2lnbm9yZXMpXG4gICAgICAgICAgICBjb21wb25lbnQucG9wX2lnbm9yZXMoKSwgaWdub3JlcyA9IFtdO1xuICAgICAgICBpZiAobm9kZS50eXBlID09PSAnQ29tbWVudCcgJiYgbm9kZS5pZ25vcmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgcHVzaF9hcnJheSQxKGlnbm9yZXMsIG5vZGUuaWdub3Jlcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxhc3QpXG4gICAgICAgICAgICBsYXN0Lm5leHQgPSBub2RlO1xuICAgICAgICBub2RlLnByZXYgPSBsYXN0O1xuICAgICAgICBsYXN0ID0gbm9kZTtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrX2dyYXBoX2Zvcl9jeWNsZXMoZWRnZXMpIHtcbiAgICBjb25zdCBncmFwaCA9IGVkZ2VzLnJlZHVjZSgoZywgZWRnZSkgPT4ge1xuICAgICAgICBjb25zdCBbdSwgdl0gPSBlZGdlO1xuICAgICAgICBpZiAoIWcuaGFzKHUpKVxuICAgICAgICAgICAgZy5zZXQodSwgW10pO1xuICAgICAgICBpZiAoIWcuaGFzKHYpKVxuICAgICAgICAgICAgZy5zZXQodiwgW10pO1xuICAgICAgICBnLmdldCh1KS5wdXNoKHYpO1xuICAgICAgICByZXR1cm4gZztcbiAgICB9LCBuZXcgTWFwKCkpO1xuICAgIGNvbnN0IHZpc2l0ZWQgPSBuZXcgU2V0KCk7XG4gICAgY29uc3Qgb25fc3RhY2sgPSBuZXcgU2V0KCk7XG4gICAgY29uc3QgY3ljbGVzID0gW107XG4gICAgZnVuY3Rpb24gdmlzaXQodikge1xuICAgICAgICB2aXNpdGVkLmFkZCh2KTtcbiAgICAgICAgb25fc3RhY2suYWRkKHYpO1xuICAgICAgICBncmFwaC5nZXQodikuZm9yRWFjaCh3ID0+IHtcbiAgICAgICAgICAgIGlmICghdmlzaXRlZC5oYXModykpIHtcbiAgICAgICAgICAgICAgICB2aXNpdCh3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9uX3N0YWNrLmhhcyh3KSkge1xuICAgICAgICAgICAgICAgIGN5Y2xlcy5wdXNoKFsuLi5vbl9zdGFjaywgd10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgb25fc3RhY2suZGVsZXRlKHYpO1xuICAgIH1cbiAgICBncmFwaC5mb3JFYWNoKChfLCB2KSA9PiB7XG4gICAgICAgIGlmICghdmlzaXRlZC5oYXModikpIHtcbiAgICAgICAgICAgIHZpc2l0KHYpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGN5Y2xlc1swXTtcbn1cblxuZnVuY3Rpb24gZ2V0X2NvbnN0X3RhZ3MoY2hpbGRyZW4sIGNvbXBvbmVudCwgbm9kZSwgcGFyZW50KSB7XG4gICAgY29uc3QgY29uc3RfdGFncyA9IFtdO1xuICAgIGNvbnN0IG90aGVycyA9IFtdO1xuICAgIGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcbiAgICAgICAgaWYgKGNoaWxkLnR5cGUgPT09ICdDb25zdFRhZycpIHtcbiAgICAgICAgICAgIGNvbnN0X3RhZ3MucHVzaChjaGlsZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvdGhlcnMucHVzaChjaGlsZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY29uc3RzX25vZGVzID0gY29uc3RfdGFncy5tYXAodGFnID0+IG5ldyBDb25zdFRhZyhjb21wb25lbnQsIG5vZGUsIG5vZGUuc2NvcGUsIHRhZykpO1xuICAgIGNvbnN0IHNvcnRlZF9jb25zdHNfbm9kZXMgPSBzb3J0X2NvbnN0c19ub2Rlcyhjb25zdHNfbm9kZXMsIGNvbXBvbmVudCk7XG4gICAgc29ydGVkX2NvbnN0c19ub2Rlcy5mb3JFYWNoKG5vZGUgPT4gbm9kZS5wYXJzZV9leHByZXNzaW9uKCkpO1xuICAgIGNvbnN0IGNoaWxkcmVuX25vZGVzID0gbWFwX2NoaWxkcmVuKGNvbXBvbmVudCwgcGFyZW50LCBub2RlLnNjb3BlLCBvdGhlcnMpO1xuICAgIHJldHVybiBbc29ydGVkX2NvbnN0c19ub2RlcywgY2hpbGRyZW5fbm9kZXNdO1xufVxuZnVuY3Rpb24gc29ydF9jb25zdHNfbm9kZXMoY29uc3RzX25vZGVzLCBjb21wb25lbnQpIHtcbiAgICBjb25zdCBzb3J0ZWRfY29uc3RzX25vZGVzID0gW107XG4gICAgY29uc3QgdW5zb3J0ZWRfY29uc3RzX25vZGVzID0gY29uc3RzX25vZGVzLm1hcChub2RlID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFzc2lnbmVlczogbm9kZS5hc3NpZ25lZXMsXG4gICAgICAgICAgICBkZXBlbmRlbmNpZXM6IG5vZGUuZGVwZW5kZW5jaWVzLFxuICAgICAgICAgICAgbm9kZVxuICAgICAgICB9O1xuICAgIH0pO1xuICAgIGNvbnN0IGxvb2t1cCA9IG5ldyBNYXAoKTtcbiAgICB1bnNvcnRlZF9jb25zdHNfbm9kZXMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgbm9kZS5hc3NpZ25lZXMuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgIGlmICghbG9va3VwLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgIGxvb2t1cC5zZXQobmFtZSwgW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbG9va3VwLmdldChuYW1lKS5wdXNoKG5vZGUpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjb25zdCBjeWNsZSA9IGNoZWNrX2dyYXBoX2Zvcl9jeWNsZXModW5zb3J0ZWRfY29uc3RzX25vZGVzLnJlZHVjZSgoYWNjLCBub2RlKSA9PiB7XG4gICAgICAgIG5vZGUuYXNzaWduZWVzLmZvckVhY2godiA9PiB7XG4gICAgICAgICAgICBub2RlLmRlcGVuZGVuY2llcy5mb3JFYWNoKHcgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghbm9kZS5hc3NpZ25lZXMuaGFzKHcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjYy5wdXNoKFt2LCB3XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgIH0sIFtdKSk7XG4gICAgaWYgKGN5Y2xlICYmIGN5Y2xlLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBub2RlTGlzdCA9IGxvb2t1cC5nZXQoY3ljbGVbMF0pO1xuICAgICAgICBjb25zdCBub2RlID0gbm9kZUxpc3RbMF07XG4gICAgICAgIGNvbXBvbmVudC5lcnJvcihub2RlLm5vZGUsIGNvbXBpbGVyX2Vycm9ycy5jeWNsaWNhbF9jb25zdF90YWdzKGN5Y2xlKSk7XG4gICAgfVxuICAgIGNvbnN0IGFkZF9ub2RlID0gKG5vZGUpID0+IHtcbiAgICAgICAgaWYgKHNvcnRlZF9jb25zdHNfbm9kZXMuaW5jbHVkZXMobm9kZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIG5vZGUuZGVwZW5kZW5jaWVzLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgICAgICBpZiAobm9kZS5hc3NpZ25lZXMuaGFzKG5hbWUpKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IGVhcmxpZXJfbm9kZXMgPSBsb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgaWYgKGVhcmxpZXJfbm9kZXMpIHtcbiAgICAgICAgICAgICAgICBlYXJsaWVyX25vZGVzLmZvckVhY2goYWRkX25vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgc29ydGVkX2NvbnN0c19ub2Rlcy5wdXNoKG5vZGUpO1xuICAgIH07XG4gICAgdW5zb3J0ZWRfY29uc3RzX25vZGVzLmZvckVhY2goYWRkX25vZGUpO1xuICAgIHJldHVybiBzb3J0ZWRfY29uc3RzX25vZGVzLm1hcChub2RlID0+IG5vZGUubm9kZSk7XG59XG5cbmNsYXNzIFRoZW5CbG9jayBleHRlbmRzIEFic3RyYWN0QmxvY2sge1xuICAgIGNvbnN0cnVjdG9yKGNvbXBvbmVudCwgcGFyZW50LCBzY29wZSwgaW5mbykge1xuICAgICAgICBzdXBlcihjb21wb25lbnQsIHBhcmVudCwgc2NvcGUsIGluZm8pO1xuICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGUuY2hpbGQoKTtcbiAgICAgICAgaWYgKHBhcmVudC50aGVuX25vZGUpIHtcbiAgICAgICAgICAgIHBhcmVudC50aGVuX2NvbnRleHRzLmZvckVhY2goY29udGV4dCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY29wZS5hZGQoY29udGV4dC5rZXkubmFtZSwgcGFyZW50LmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzLCB0aGlzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIChbdGhpcy5jb25zdF90YWdzLCB0aGlzLmNoaWxkcmVuXSA9IGdldF9jb25zdF90YWdzKGluZm8uY2hpbGRyZW4sIGNvbXBvbmVudCwgdGhpcywgcGFyZW50KSk7XG4gICAgICAgIGlmICghaW5mby5za2lwKSB7XG4gICAgICAgICAgICB0aGlzLndhcm5faWZfZW1wdHlfYmxvY2soKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gYWRkX2NvbnN0X3RhZ3MoYmxvY2ssIGNvbnN0X3RhZ3MsIGN0eCkge1xuICAgIGNvbnN0IGNvbnN0X3RhZ3NfcHJvcHMgPSBbXTtcbiAgICBjb25zdF90YWdzLmZvckVhY2goKGNvbnN0X3RhZywgaSkgPT4ge1xuICAgICAgICBjb25zdCBuYW1lID0gYCNjb25zdGFudHNfJHtpfWA7XG4gICAgICAgIGNvbnN0X3RhZ3NfcHJvcHMucHVzaChiIGBjb25zdCAke25hbWV9ID0gJHtjb25zdF90YWcuZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrLCBjdHgpfWApO1xuICAgICAgICBjb25zdF90YWcuY29udGV4dHMuZm9yRWFjaChjb250ZXh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0X3RhZ3NfcHJvcHMucHVzaChiIGAke2N0eH1bJHtibG9jay5yZW5kZXJlci5jb250ZXh0X2xvb2t1cC5nZXQoY29udGV4dC5rZXkubmFtZSkuaW5kZXh9XSA9ICR7Y29udGV4dC5kZWZhdWx0X21vZGlmaWVyKGNvbnRleHQubW9kaWZpZXIoeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWUgfSksIG5hbWUgPT4gYmxvY2sucmVuZGVyZXIuY29udGV4dF9sb29rdXAuaGFzKG5hbWUpID8geCBgJHtjdHh9WyR7YmxvY2sucmVuZGVyZXIuY29udGV4dF9sb29rdXAuZ2V0KG5hbWUpLmluZGV4fV1gIDogeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWUgfSl9O2ApO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gY29uc3RfdGFnc19wcm9wcztcbn1cbmZ1bmN0aW9uIGFkZF9jb25zdF90YWdzX2NvbnRleHQocmVuZGVyZXIsIGNvbnN0X3RhZ3MpIHtcbiAgICBjb25zdF90YWdzLmZvckVhY2goY29uc3RfdGFnID0+IHtcbiAgICAgICAgY29uc3RfdGFnLmNvbnRleHRzLmZvckVhY2goY29udGV4dCA9PiB7XG4gICAgICAgICAgICByZW5kZXJlci5hZGRfdG9fY29udGV4dChjb250ZXh0LmtleS5uYW1lLCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5cbmNsYXNzIEF3YWl0QmxvY2tCcmFuY2ggZXh0ZW5kcyBXcmFwcGVyIHtcbiAgICBjb25zdHJ1Y3RvcihzdGF0dXMsIHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlLCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUpO1xuICAgICAgICB0aGlzLnZhciA9IG51bGw7XG4gICAgICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzO1xuICAgICAgICB0aGlzLmJsb2NrID0gYmxvY2suY2hpbGQoe1xuICAgICAgICAgICAgY29tbWVudDogY3JlYXRlX2RlYnVnZ2luZ19jb21tZW50KG5vZGUsIHRoaXMucmVuZGVyZXIuY29tcG9uZW50KSxcbiAgICAgICAgICAgIG5hbWU6IHRoaXMucmVuZGVyZXIuY29tcG9uZW50LmdldF91bmlxdWVfbmFtZShgY3JlYXRlXyR7c3RhdHVzfV9ibG9ja2ApLFxuICAgICAgICAgICAgdHlwZTogc3RhdHVzXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmFkZF9jb250ZXh0KHBhcmVudC5ub2RlW3N0YXR1cyArICdfbm9kZSddLCBwYXJlbnQubm9kZVtzdGF0dXMgKyAnX2NvbnRleHRzJ10pO1xuICAgICAgICB0aGlzLmZyYWdtZW50ID0gbmV3IEZyYWdtZW50V3JhcHBlcihyZW5kZXJlciwgdGhpcy5ibG9jaywgdGhpcy5ub2RlLmNoaWxkcmVuLCBwYXJlbnQsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZyk7XG4gICAgICAgIHRoaXMuaXNfZHluYW1pYyA9IHRoaXMuYmxvY2suZGVwZW5kZW5jaWVzLnNpemUgPiAwO1xuICAgIH1cbiAgICBhZGRfY29udGV4dChub2RlLCBjb250ZXh0cykge1xuICAgICAgICBpZiAoIW5vZGUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdJZGVudGlmaWVyJykge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5vZGUubmFtZTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkX3RvX2NvbnRleHQodGhpcy52YWx1ZSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb250ZXh0cy5mb3JFYWNoKGNvbnRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkX3RvX2NvbnRleHQoY29udGV4dC5rZXkubmFtZSwgdHJ1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLmJsb2NrLnBhcmVudC5nZXRfdW5pcXVlX25hbWUoJ3ZhbHVlJykubmFtZTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVfY29udGV4dHMgPSBjb250ZXh0cztcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkX3RvX2NvbnRleHQodGhpcy52YWx1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmlzX2Rlc3RydWN0dXJlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52YWx1ZV9pbmRleCA9IHRoaXMucmVuZGVyZXIuY29udGV4dF9sb29rdXAuZ2V0KHRoaXMudmFsdWUpLmluZGV4O1xuICAgICAgICBpZiAodGhpcy5oYXNfY29uc3RzKHRoaXMubm9kZSkpIHtcbiAgICAgICAgICAgIGFkZF9jb25zdF90YWdzX2NvbnRleHQodGhpcy5yZW5kZXJlciwgdGhpcy5ub2RlLmNvbnN0X3RhZ3MpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhhc19jb25zdHMobm9kZSkge1xuICAgICAgICByZXR1cm4gbm9kZSBpbnN0YW5jZW9mIFRoZW5CbG9jayB8fCBub2RlIGluc3RhbmNlb2YgQ2F0Y2hCbG9jaztcbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKSB7XG4gICAgICAgIHRoaXMuZnJhZ21lbnQucmVuZGVyKGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKTtcbiAgICAgICAgaWYgKHRoaXMuaXNfZGVzdHJ1Y3R1cmVkIHx8ICh0aGlzLmhhc19jb25zdHModGhpcy5ub2RlKSAmJiB0aGlzLm5vZGUuY29uc3RfdGFncy5sZW5ndGggPiAwKSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJfZ2V0X2NvbnRleHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXJfZ2V0X2NvbnRleHQoKSB7XG4gICAgICAgIGNvbnN0IHByb3BzID0gdGhpcy5pc19kZXN0cnVjdHVyZWQgPyB0aGlzLnZhbHVlX2NvbnRleHRzLm1hcChwcm9wID0+IGIgYCNjdHhbJHt0aGlzLmJsb2NrLnJlbmRlcmVyLmNvbnRleHRfbG9va3VwLmdldChwcm9wLmtleS5uYW1lKS5pbmRleH1dID0gJHtwcm9wLmRlZmF1bHRfbW9kaWZpZXIocHJvcC5tb2RpZmllcih4IGAjY3R4WyR7dGhpcy52YWx1ZV9pbmRleH1dYCksIG5hbWUgPT4gdGhpcy5yZW5kZXJlci5yZWZlcmVuY2UobmFtZSkpfTtgKSA6IG51bGw7XG4gICAgICAgIGNvbnN0IGNvbnN0X3RhZ3NfcHJvcHMgPSB0aGlzLmhhc19jb25zdHModGhpcy5ub2RlKSA/IGFkZF9jb25zdF90YWdzKHRoaXMuYmxvY2ssIHRoaXMubm9kZS5jb25zdF90YWdzLCAnI2N0eCcpIDogbnVsbDtcbiAgICAgICAgY29uc3QgZ2V0X2NvbnRleHQgPSB0aGlzLmJsb2NrLnJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoYGdldF8ke3RoaXMuc3RhdHVzfV9jb250ZXh0YCk7XG4gICAgICAgIHRoaXMuYmxvY2sucmVuZGVyZXIuYmxvY2tzLnB1c2goYiBgXG5cdFx0XHRmdW5jdGlvbiAke2dldF9jb250ZXh0fSgjY3R4KSB7XG5cdFx0XHRcdCR7cHJvcHN9XG5cdFx0XHRcdCR7Y29uc3RfdGFnc19wcm9wc31cblx0XHRcdH1cblx0XHRgKTtcbiAgICAgICAgdGhpcy5ibG9jay5jaHVua3MuZGVjbGFyYXRpb25zLnB1c2goYiBgJHtnZXRfY29udGV4dH0oI2N0eClgKTtcbiAgICAgICAgaWYgKHRoaXMuYmxvY2suaGFzX3VwZGF0ZV9tZXRob2QpIHtcbiAgICAgICAgICAgIHRoaXMuYmxvY2suY2h1bmtzLnVwZGF0ZS51bnNoaWZ0KGIgYCR7Z2V0X2NvbnRleHR9KCNjdHgpYCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5jbGFzcyBBd2FpdEJsb2NrV3JhcHBlciBleHRlbmRzIFdyYXBwZXIge1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlLCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUpO1xuICAgICAgICB0aGlzLnZhciA9IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiAnYXdhaXRfYmxvY2snIH07XG4gICAgICAgIHRoaXMuY2Fubm90X3VzZV9pbm5lcmh0bWwoKTtcbiAgICAgICAgdGhpcy5ub3Rfc3RhdGljX2NvbnRlbnQoKTtcbiAgICAgICAgYmxvY2suYWRkX2RlcGVuZGVuY2llcyh0aGlzLm5vZGUuZXhwcmVzc2lvbi5kZXBlbmRlbmNpZXMpO1xuICAgICAgICBsZXQgaXNfZHluYW1pYyA9IGZhbHNlO1xuICAgICAgICBsZXQgaGFzX2ludHJvcyA9IGZhbHNlO1xuICAgICAgICBsZXQgaGFzX291dHJvcyA9IGZhbHNlO1xuICAgICAgICBbJ3BlbmRpbmcnLCAndGhlbicsICdjYXRjaCddLmZvckVhY2goKHN0YXR1cykgPT4ge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSB0aGlzLm5vZGVbc3RhdHVzXTtcbiAgICAgICAgICAgIGNvbnN0IGJyYW5jaCA9IG5ldyBBd2FpdEJsb2NrQnJhbmNoKHN0YXR1cywgcmVuZGVyZXIsIGJsb2NrLCB0aGlzLCBjaGlsZCwgc3RyaXBfd2hpdGVzcGFjZSwgbmV4dF9zaWJsaW5nKTtcbiAgICAgICAgICAgIHJlbmRlcmVyLmJsb2Nrcy5wdXNoKGJyYW5jaC5ibG9jayk7XG4gICAgICAgICAgICBpZiAoYnJhbmNoLmlzX2R5bmFtaWMpIHtcbiAgICAgICAgICAgICAgICBpc19keW5hbWljID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyBUT0RPIHNob3VsZCBibG9ja3MgdXBkYXRlIHRoZWlyIG93biBwYXJlbnRzP1xuICAgICAgICAgICAgICAgIGJsb2NrLmFkZF9kZXBlbmRlbmNpZXMoYnJhbmNoLmJsb2NrLmRlcGVuZGVuY2llcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYnJhbmNoLmJsb2NrLmhhc19pbnRyb3MpXG4gICAgICAgICAgICAgICAgaGFzX2ludHJvcyA9IHRydWU7XG4gICAgICAgICAgICBpZiAoYnJhbmNoLmJsb2NrLmhhc19vdXRyb3MpXG4gICAgICAgICAgICAgICAgaGFzX291dHJvcyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzW3N0YXR1c10gPSBicmFuY2g7XG4gICAgICAgIH0pO1xuICAgICAgICBbJ3BlbmRpbmcnLCAndGhlbicsICdjYXRjaCddLmZvckVhY2goc3RhdHVzID0+IHtcbiAgICAgICAgICAgIHRoaXNbc3RhdHVzXS5ibG9jay5oYXNfdXBkYXRlX21ldGhvZCA9IGlzX2R5bmFtaWM7XG4gICAgICAgICAgICB0aGlzW3N0YXR1c10uYmxvY2suaGFzX2ludHJvX21ldGhvZCA9IGhhc19pbnRyb3M7XG4gICAgICAgICAgICB0aGlzW3N0YXR1c10uYmxvY2suaGFzX291dHJvX21ldGhvZCA9IGhhc19vdXRyb3M7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoaGFzX291dHJvcykge1xuICAgICAgICAgICAgYmxvY2suYWRkX291dHJvKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKSB7XG4gICAgICAgIGNvbnN0IGFuY2hvciA9IHRoaXMuZ2V0X29yX2NyZWF0ZV9hbmNob3IoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpO1xuICAgICAgICBjb25zdCB1cGRhdGVfbW91bnRfbm9kZSA9IHRoaXMuZ2V0X3VwZGF0ZV9tb3VudF9ub2RlKGFuY2hvcik7XG4gICAgICAgIGNvbnN0IHNuaXBwZXQgPSB0aGlzLm5vZGUuZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgY29uc3QgaW5mbyA9IGJsb2NrLmdldF91bmlxdWVfbmFtZSgnaW5mbycpO1xuICAgICAgICBjb25zdCBwcm9taXNlID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdwcm9taXNlJyk7XG4gICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShwcm9taXNlKTtcbiAgICAgICAgYmxvY2subWFpbnRhaW5fY29udGV4dCA9IHRydWU7XG4gICAgICAgIGNvbnN0IGluZm9fcHJvcHMgPSB4IGB7XG5cdFx0XHRjdHg6ICNjdHgsXG5cdFx0XHRjdXJyZW50OiBudWxsLFxuXHRcdFx0dG9rZW46IG51bGwsXG5cdFx0XHRoYXNDYXRjaDogJHt0aGlzLmNhdGNoLm5vZGUuc3RhcnQgIT09IG51bGwgPyAndHJ1ZScgOiAnZmFsc2UnfSxcblx0XHRcdHBlbmRpbmc6ICR7dGhpcy5wZW5kaW5nLmJsb2NrLm5hbWV9LFxuXHRcdFx0dGhlbjogJHt0aGlzLnRoZW4uYmxvY2submFtZX0sXG5cdFx0XHRjYXRjaDogJHt0aGlzLmNhdGNoLmJsb2NrLm5hbWV9LFxuXHRcdFx0dmFsdWU6ICR7dGhpcy50aGVuLnZhbHVlX2luZGV4fSxcblx0XHRcdGVycm9yOiAke3RoaXMuY2F0Y2gudmFsdWVfaW5kZXh9LFxuXHRcdFx0YmxvY2tzOiAke3RoaXMucGVuZGluZy5ibG9jay5oYXNfb3V0cm9fbWV0aG9kICYmIHggYFssLCxdYH1cblx0XHR9YDtcbiAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdGxldCAke2luZm99ID0gJHtpbmZvX3Byb3BzfTtcblx0XHRgKTtcbiAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdEBoYW5kbGVfcHJvbWlzZSgke3Byb21pc2V9ID0gJHtzbmlwcGV0fSwgJHtpbmZvfSk7XG5cdFx0YCk7XG4gICAgICAgIGJsb2NrLmNodW5rcy5jcmVhdGUucHVzaChiIGBcblx0XHRcdCR7aW5mb30uYmxvY2suYygpO1xuXHRcdGApO1xuICAgICAgICBpZiAocGFyZW50X25vZGVzICYmIHRoaXMucmVuZGVyZXIub3B0aW9ucy5oeWRyYXRhYmxlKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuY2xhaW0ucHVzaChiIGBcblx0XHRcdFx0JHtpbmZvfS5ibG9jay5sKCR7cGFyZW50X25vZGVzfSk7XG5cdFx0XHRgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbml0aWFsX21vdW50X25vZGUgPSBwYXJlbnRfbm9kZSB8fCAnI3RhcmdldCc7XG4gICAgICAgIGNvbnN0IGFuY2hvcl9ub2RlID0gcGFyZW50X25vZGUgPyAnbnVsbCcgOiAnI2FuY2hvcic7XG4gICAgICAgIGNvbnN0IGhhc190cmFuc2l0aW9ucyA9IHRoaXMucGVuZGluZy5ibG9jay5oYXNfaW50cm9fbWV0aG9kIHx8IHRoaXMucGVuZGluZy5ibG9jay5oYXNfb3V0cm9fbWV0aG9kO1xuICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGBcblx0XHRcdCR7aW5mb30uYmxvY2subSgke2luaXRpYWxfbW91bnRfbm9kZX0sICR7aW5mb30uYW5jaG9yID0gJHthbmNob3Jfbm9kZX0pO1xuXHRcdFx0JHtpbmZvfS5tb3VudCA9ICgpID0+ICR7dXBkYXRlX21vdW50X25vZGV9O1xuXHRcdFx0JHtpbmZvfS5hbmNob3IgPSAke2FuY2hvcn07XG5cdFx0YCk7XG4gICAgICAgIGlmIChoYXNfdHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbnRyby5wdXNoKGIgYEB0cmFuc2l0aW9uX2luKCR7aW5mb30uYmxvY2spO2ApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IHRoaXMubm9kZS5leHByZXNzaW9uLmR5bmFtaWNfZGVwZW5kZW5jaWVzKCk7XG4gICAgICAgIGNvbnN0IHVwZGF0ZV9hd2FpdF9ibG9ja19icmFuY2ggPSBiIGBAdXBkYXRlX2F3YWl0X2Jsb2NrX2JyYW5jaCgke2luZm99LCAjY3R4LCAjZGlydHkpYDtcbiAgICAgICAgaWYgKGRlcGVuZGVuY2llcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBjb25kaXRpb24gPSB4IGBcblx0XHRcdFx0JHtibG9jay5yZW5kZXJlci5kaXJ0eShkZXBlbmRlbmNpZXMpfSAmJlxuXHRcdFx0XHQke3Byb21pc2V9ICE9PSAoJHtwcm9taXNlfSA9ICR7c25pcHBldH0pICYmXG5cdFx0XHRcdEBoYW5kbGVfcHJvbWlzZSgke3Byb21pc2V9LCAke2luZm99KWA7XG4gICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgJHtpbmZvfS5jdHggPSAjY3R4O2ApO1xuICAgICAgICAgICAgaWYgKHRoaXMucGVuZGluZy5ibG9jay5oYXNfdXBkYXRlX21ldGhvZCkge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0XHRpZiAoJHtjb25kaXRpb259KSB7XG5cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0JHt1cGRhdGVfYXdhaXRfYmxvY2tfYnJhbmNofVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRcdFx0JHtjb25kaXRpb259XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMucGVuZGluZy5ibG9jay5oYXNfdXBkYXRlX21ldGhvZCkge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0XHQke3VwZGF0ZV9hd2FpdF9ibG9ja19icmFuY2h9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBlbmRpbmcuYmxvY2suaGFzX291dHJvX21ldGhvZCkge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm91dHJvLnB1c2goYiBgXG5cdFx0XHRcdGZvciAobGV0ICNpID0gMDsgI2kgPCAzOyAjaSArPSAxKSB7XG5cdFx0XHRcdFx0Y29uc3QgYmxvY2sgPSAke2luZm99LmJsb2Nrc1sjaV07XG5cdFx0XHRcdFx0QHRyYW5zaXRpb25fb3V0KGJsb2NrKTtcblx0XHRcdFx0fVxuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2suY2h1bmtzLmRlc3Ryb3kucHVzaChiIGBcblx0XHRcdCR7aW5mb30uYmxvY2suZCgke3BhcmVudF9ub2RlID8gbnVsbCA6ICdkZXRhY2hpbmcnfSk7XG5cdFx0XHQke2luZm99LnRva2VuID0gbnVsbDtcblx0XHRcdCR7aW5mb30gPSBudWxsO1xuXHRcdGApO1xuICAgICAgICBbdGhpcy5wZW5kaW5nLCB0aGlzLnRoZW4sIHRoaXMuY2F0Y2hdLmZvckVhY2goYnJhbmNoID0+IHtcbiAgICAgICAgICAgIGJyYW5jaC5yZW5kZXIoYnJhbmNoLmJsb2NrLCBudWxsLCB4IGAjbm9kZXNgKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5jb25zdCBUUlVFID0geCBgdHJ1ZWA7XG5jb25zdCBGQUxTRSA9IHggYGZhbHNlYDtcbmNsYXNzIEV2ZW50SGFuZGxlcldyYXBwZXIge1xuICAgIGNvbnN0cnVjdG9yKG5vZGUsIHBhcmVudCkge1xuICAgICAgICB0aGlzLm5vZGUgPSBub2RlO1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgaWYgKCFub2RlLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LnJlbmRlcmVyLmFkZF90b19jb250ZXh0KG5vZGUuaGFuZGxlcl9uYW1lLm5hbWUpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQucmVuZGVyZXIuY29tcG9uZW50LnBhcnRseV9ob2lzdGVkLnB1c2goYiBgXG5cdFx0XHRcdGZ1bmN0aW9uICR7bm9kZS5oYW5kbGVyX25hbWUubmFtZX0oZXZlbnQpIHtcblx0XHRcdFx0XHRAYnViYmxlLmNhbGwodGhpcywgJCRzZWxmLCBldmVudCk7XG5cdFx0XHRcdH1cblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldF9zbmlwcGV0KGJsb2NrKSB7XG4gICAgICAgIGNvbnN0IHNuaXBwZXQgPSB0aGlzLm5vZGUuZXhwcmVzc2lvbiA/IHRoaXMubm9kZS5leHByZXNzaW9uLm1hbmlwdWxhdGUoYmxvY2spIDogYmxvY2sucmVuZGVyZXIucmVmZXJlbmNlKHRoaXMubm9kZS5oYW5kbGVyX25hbWUpO1xuICAgICAgICBpZiAodGhpcy5ub2RlLnJlYXNzaWduZWQpIHtcbiAgICAgICAgICAgIGJsb2NrLm1haW50YWluX2NvbnRleHQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHggYGZ1bmN0aW9uICgpIHsgaWYgKEBpc19mdW5jdGlvbigke3NuaXBwZXR9KSkgJHtzbmlwcGV0fS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc25pcHBldDtcbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCB0YXJnZXQpIHtcbiAgICAgICAgbGV0IHNuaXBwZXQgPSB0aGlzLmdldF9zbmlwcGV0KGJsb2NrKTtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5tb2RpZmllcnMuaGFzKCdwcmV2ZW50RGVmYXVsdCcpKVxuICAgICAgICAgICAgc25pcHBldCA9IHggYEBwcmV2ZW50X2RlZmF1bHQoJHtzbmlwcGV0fSlgO1xuICAgICAgICBpZiAodGhpcy5ub2RlLm1vZGlmaWVycy5oYXMoJ3N0b3BQcm9wYWdhdGlvbicpKVxuICAgICAgICAgICAgc25pcHBldCA9IHggYEBzdG9wX3Byb3BhZ2F0aW9uKCR7c25pcHBldH0pYDtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5tb2RpZmllcnMuaGFzKCdzZWxmJykpXG4gICAgICAgICAgICBzbmlwcGV0ID0geCBgQHNlbGYoJHtzbmlwcGV0fSlgO1xuICAgICAgICBpZiAodGhpcy5ub2RlLm1vZGlmaWVycy5oYXMoJ3RydXN0ZWQnKSlcbiAgICAgICAgICAgIHNuaXBwZXQgPSB4IGBAdHJ1c3RlZCgke3NuaXBwZXR9KWA7XG4gICAgICAgIGNvbnN0IGFyZ3MgPSBbXTtcbiAgICAgICAgY29uc3Qgb3B0cyA9IFsnbm9ucGFzc2l2ZScsICdwYXNzaXZlJywgJ29uY2UnLCAnY2FwdHVyZSddLmZpbHRlcihtb2QgPT4gdGhpcy5ub2RlLm1vZGlmaWVycy5oYXMobW9kKSk7XG4gICAgICAgIGlmIChvcHRzLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKG9wdHMubGVuZ3RoID09PSAxICYmIG9wdHNbMF0gPT09ICdjYXB0dXJlJykge1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaChUUlVFKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh4IGB7ICR7b3B0cy5tYXAob3B0ID0+IG9wdCA9PT0gJ25vbnBhc3NpdmUnXG4gICAgICAgICAgICAgICAgICAgID8gcCBgcGFzc2l2ZTogZmFsc2VgXG4gICAgICAgICAgICAgICAgICAgIDogcCBgJHtvcHR9OiB0cnVlYCl9IH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChibG9jay5yZW5kZXJlci5vcHRpb25zLmRldikge1xuICAgICAgICAgICAgYXJncy5wdXNoKEZBTFNFKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmxvY2sucmVuZGVyZXIub3B0aW9ucy5kZXYpIHtcbiAgICAgICAgICAgIGFyZ3MucHVzaCh0aGlzLm5vZGUubW9kaWZpZXJzLmhhcygncHJldmVudERlZmF1bHQnKSA/IFRSVUUgOiBGQUxTRSk7XG4gICAgICAgICAgICBhcmdzLnB1c2godGhpcy5ub2RlLm1vZGlmaWVycy5oYXMoJ3N0b3BQcm9wYWdhdGlvbicpID8gVFJVRSA6IEZBTFNFKTtcbiAgICAgICAgfVxuICAgICAgICBibG9jay5ldmVudF9saXN0ZW5lcnMucHVzaCh4IGBAbGlzdGVuKCR7dGFyZ2V0fSwgXCIke3RoaXMubm9kZS5uYW1lfVwiLCAke3NuaXBwZXR9LCAke2FyZ3N9KWApO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gYWRkX2V2ZW50X2hhbmRsZXJzKGJsb2NrLCB0YXJnZXQsIGhhbmRsZXJzKSB7XG4gICAgaGFuZGxlcnMuZm9yRWFjaChoYW5kbGVyID0+IGFkZF9ldmVudF9oYW5kbGVyKGJsb2NrLCB0YXJnZXQsIGhhbmRsZXIpKTtcbn1cbmZ1bmN0aW9uIGFkZF9ldmVudF9oYW5kbGVyKGJsb2NrLCB0YXJnZXQsIGhhbmRsZXIpIHtcbiAgICBoYW5kbGVyLnJlbmRlcihibG9jaywgdGFyZ2V0KTtcbn1cblxuZnVuY3Rpb24gYWRkX2FjdGlvbnMoYmxvY2ssIHRhcmdldCwgYWN0aW9ucykge1xuICAgIGFjdGlvbnMuZm9yRWFjaChhY3Rpb24gPT4gYWRkX2FjdGlvbihibG9jaywgdGFyZ2V0LCBhY3Rpb24pKTtcbn1cbmNvbnN0IHJlZ2V4X2ludmFsaWRfdmFyaWFibGVfaWRlbnRpZmllcl9jaGFyYWN0ZXJzID0gL1teYS16QS1aMC05XyRdL2c7XG5mdW5jdGlvbiBhZGRfYWN0aW9uKGJsb2NrLCB0YXJnZXQsIGFjdGlvbikge1xuICAgIGNvbnN0IHsgZXhwcmVzc2lvbiwgdGVtcGxhdGVfc2NvcGUgfSA9IGFjdGlvbjtcbiAgICBsZXQgc25pcHBldDtcbiAgICBsZXQgZGVwZW5kZW5jaWVzO1xuICAgIGlmIChleHByZXNzaW9uKSB7XG4gICAgICAgIHNuaXBwZXQgPSBleHByZXNzaW9uLm1hbmlwdWxhdGUoYmxvY2spO1xuICAgICAgICBkZXBlbmRlbmNpZXMgPSBleHByZXNzaW9uLmR5bmFtaWNfZGVwZW5kZW5jaWVzKCk7XG4gICAgfVxuICAgIGNvbnN0IGlkID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke2FjdGlvbi5uYW1lLnJlcGxhY2UocmVnZXhfaW52YWxpZF92YXJpYWJsZV9pZGVudGlmaWVyX2NoYXJhY3RlcnMsICdfJyl9X2FjdGlvbmApO1xuICAgIGJsb2NrLmFkZF92YXJpYWJsZShpZCk7XG4gICAgY29uc3QgW29iaiwgLi4ucHJvcGVydGllc10gPSBhY3Rpb24ubmFtZS5zcGxpdCgnLicpO1xuICAgIGNvbnN0IGZuID0gaXNfY29udGV4dHVhbChhY3Rpb24uY29tcG9uZW50LCB0ZW1wbGF0ZV9zY29wZSwgb2JqKVxuICAgICAgICA/IGJsb2NrLnJlbmRlcmVyLnJlZmVyZW5jZShvYmopXG4gICAgICAgIDogb2JqO1xuICAgIGlmIChwcm9wZXJ0aWVzLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBtZW1iZXJfZXhwcmVzc2lvbiA9IHByb3BlcnRpZXMucmVkdWNlKChsaHMsIHJocykgPT4geCBgJHtsaHN9LiR7cmhzfWAsIGZuKTtcbiAgICAgICAgYmxvY2suZXZlbnRfbGlzdGVuZXJzLnB1c2goeCBgQGFjdGlvbl9kZXN0cm95ZXIoJHtpZH0gPSAke21lbWJlcl9leHByZXNzaW9ufSgke3RhcmdldH0sICR7c25pcHBldH0pKWApO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYmxvY2suZXZlbnRfbGlzdGVuZXJzLnB1c2goeCBgQGFjdGlvbl9kZXN0cm95ZXIoJHtpZH0gPSAke2ZufS5jYWxsKG51bGwsICR7dGFyZ2V0fSwgJHtzbmlwcGV0fSkpYCk7XG4gICAgfVxuICAgIGlmIChkZXBlbmRlbmNpZXMgJiYgZGVwZW5kZW5jaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbGV0IGNvbmRpdGlvbiA9IHggYCR7aWR9ICYmIEBpc19mdW5jdGlvbigke2lkfS51cGRhdGUpYDtcbiAgICAgICAgaWYgKGRlcGVuZGVuY2llcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25kaXRpb24gPSB4IGAke2NvbmRpdGlvbn0gJiYgJHtibG9jay5yZW5kZXJlci5kaXJ0eShkZXBlbmRlbmNpZXMpfWA7XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYGlmICgke2NvbmRpdGlvbn0pICR7aWR9LnVwZGF0ZS5jYWxsKG51bGwsICR7c25pcHBldH0pO2ApO1xuICAgIH1cbn1cblxuY2xhc3MgQm9keVdyYXBwZXIgZXh0ZW5kcyBXcmFwcGVyIHtcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSkge1xuICAgICAgICBzdXBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSk7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSB0aGlzLm5vZGUuaGFuZGxlcnMubWFwKGhhbmRsZXIgPT4gbmV3IEV2ZW50SGFuZGxlcldyYXBwZXIoaGFuZGxlciwgdGhpcykpO1xuICAgIH1cbiAgICByZW5kZXIoYmxvY2ssIF9wYXJlbnRfbm9kZSwgX3BhcmVudF9ub2Rlcykge1xuICAgICAgICBhZGRfZXZlbnRfaGFuZGxlcnMoYmxvY2ssIHggYEBfZG9jdW1lbnQuYm9keWAsIHRoaXMuaGFuZGxlcnMpO1xuICAgICAgICBhZGRfYWN0aW9ucyhibG9jaywgeCBgQF9kb2N1bWVudC5ib2R5YCwgdGhpcy5ub2RlLmFjdGlvbnMpO1xuICAgIH1cbn1cblxuY2xhc3MgRGVidWdUYWdXcmFwcGVyIGV4dGVuZHMgV3JhcHBlciB7XG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUsIF9zdHJpcF93aGl0ZXNwYWNlLCBfbmV4dF9zaWJsaW5nKSB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlKTtcbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCBfcGFyZW50X25vZGUsIF9wYXJlbnRfbm9kZXMpIHtcbiAgICAgICAgY29uc3QgeyByZW5kZXJlciB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgeyBjb21wb25lbnQgfSA9IHJlbmRlcmVyO1xuICAgICAgICBpZiAoIXJlbmRlcmVyLm9wdGlvbnMuZGV2KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCB7IHZhcl9sb29rdXAgfSA9IGNvbXBvbmVudDtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBjb21wb25lbnQubG9jYXRlKHRoaXMubm9kZS5zdGFydCArIDEpO1xuICAgICAgICBjb25zdCBlbmQgPSB7IGxpbmU6IHN0YXJ0LmxpbmUsIGNvbHVtbjogc3RhcnQuY29sdW1uICsgNiB9O1xuICAgICAgICBjb25zdCBsb2MgPSB7IHN0YXJ0LCBlbmQgfTtcbiAgICAgICAgY29uc3QgZGVidWcgPSB7XG4gICAgICAgICAgICB0eXBlOiAnRGVidWdnZXJTdGF0ZW1lbnQnLFxuICAgICAgICAgICAgbG9jXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLm5vZGUuZXhwcmVzc2lvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAvLyBEZWJ1ZyBhbGxcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5jcmVhdGUucHVzaChkZWJ1Zyk7XG4gICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goZGVidWcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbG9nID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdJZGVudGlmaWVyJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnbG9nJyxcbiAgICAgICAgICAgICAgICBsb2NcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICB0aGlzLm5vZGUuZXhwcmVzc2lvbnMuZm9yRWFjaChleHByZXNzaW9uID0+IHtcbiAgICAgICAgICAgICAgICBhZGRfdG9fc2V0KGRlcGVuZGVuY2llcywgZXhwcmVzc2lvbi5kZXBlbmRlbmNpZXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0dWFsX2lkZW50aWZpZXJzID0gdGhpcy5ub2RlLmV4cHJlc3Npb25zXG4gICAgICAgICAgICAgICAgLmZpbHRlcihlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YXJpYWJsZSA9IHZhcl9sb29rdXAuZ2V0KGUubm9kZS5uYW1lKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gISh2YXJpYWJsZSAmJiB2YXJpYWJsZS5ob2lzdGFibGUpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAubWFwKGUgPT4gZS5ub2RlLm5hbWUpO1xuICAgICAgICAgICAgY29uc3QgbG9nZ2VkX2lkZW50aWZpZXJzID0gdGhpcy5ub2RlLmV4cHJlc3Npb25zLm1hcChlID0+IHAgYCR7ZS5ub2RlLm5hbWV9YCk7XG4gICAgICAgICAgICBjb25zdCBkZWJ1Z19zdGF0ZW1lbnRzID0gYiBgXG5cdFx0XHRcdCR7Y29udGV4dHVhbF9pZGVudGlmaWVycy5tYXAobmFtZSA9PiBiIGBjb25zdCAke25hbWV9ID0gJHtyZW5kZXJlci5yZWZlcmVuY2UobmFtZSl9O2ApfVxuXHRcdFx0XHRAX2NvbnNvbGUuJHtsb2d9KHsgJHtsb2dnZWRfaWRlbnRpZmllcnN9IH0pO1xuXHRcdFx0XHRkZWJ1Z2dlcjtgO1xuICAgICAgICAgICAgaWYgKGRlcGVuZGVuY2llcy5zaXplKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29uZGl0aW9uID0gcmVuZGVyZXIuZGlydHkoQXJyYXkuZnJvbShkZXBlbmRlbmNpZXMpKTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRcdFx0aWYgKCR7Y29uZGl0aW9ufSkge1xuXHRcdFx0XHRcdFx0JHtkZWJ1Z19zdGF0ZW1lbnRzfVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBibG9jay5jaHVua3MuY3JlYXRlLnB1c2goYiBge1xuXHRcdFx0XHQke2RlYnVnX3N0YXRlbWVudHN9XG5cdFx0XHR9YCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIEVsc2VCbG9ja1dyYXBwZXIgZXh0ZW5kcyBXcmFwcGVyIHtcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSwgc3RyaXBfd2hpdGVzcGFjZSwgbmV4dF9zaWJsaW5nKSB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlKTtcbiAgICAgICAgdGhpcy52YXIgPSBudWxsO1xuICAgICAgICBhZGRfY29uc3RfdGFnc19jb250ZXh0KHJlbmRlcmVyLCB0aGlzLm5vZGUuY29uc3RfdGFncyk7XG4gICAgICAgIHRoaXMuYmxvY2sgPSBibG9jay5jaGlsZCh7XG4gICAgICAgICAgICBjb21tZW50OiBjcmVhdGVfZGVidWdnaW5nX2NvbW1lbnQobm9kZSwgdGhpcy5yZW5kZXJlci5jb21wb25lbnQpLFxuICAgICAgICAgICAgbmFtZTogdGhpcy5yZW5kZXJlci5jb21wb25lbnQuZ2V0X3VuaXF1ZV9uYW1lKCdjcmVhdGVfZWxzZV9ibG9jaycpLFxuICAgICAgICAgICAgdHlwZTogJ2Vsc2UnXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmZyYWdtZW50ID0gbmV3IEZyYWdtZW50V3JhcHBlcihyZW5kZXJlciwgdGhpcy5ibG9jaywgdGhpcy5ub2RlLmNoaWxkcmVuLCBwYXJlbnQsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZyk7XG4gICAgICAgIHRoaXMuaXNfZHluYW1pYyA9IHRoaXMuYmxvY2suZGVwZW5kZW5jaWVzLnNpemUgPiAwO1xuICAgIH1cbn1cbmNsYXNzIEVhY2hCbG9ja1dyYXBwZXIgZXh0ZW5kcyBXcmFwcGVyIHtcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSwgc3RyaXBfd2hpdGVzcGFjZSwgbmV4dF9zaWJsaW5nKSB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlKTtcbiAgICAgICAgdGhpcy51cGRhdGVzID0gW107XG4gICAgICAgIHRoaXMudmFyID0geyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6ICdlYWNoJyB9O1xuICAgICAgICB0aGlzLmNhbm5vdF91c2VfaW5uZXJodG1sKCk7XG4gICAgICAgIHRoaXMubm90X3N0YXRpY19jb250ZW50KCk7XG4gICAgICAgIGNvbnN0IHsgZGVwZW5kZW5jaWVzIH0gPSBub2RlLmV4cHJlc3Npb247XG4gICAgICAgIGJsb2NrLmFkZF9kZXBlbmRlbmNpZXMoZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgdGhpcy5ub2RlLmNvbnRleHRzLmZvckVhY2goY29udGV4dCA9PiB7XG4gICAgICAgICAgICByZW5kZXJlci5hZGRfdG9fY29udGV4dChjb250ZXh0LmtleS5uYW1lLCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGFkZF9jb25zdF90YWdzX2NvbnRleHQocmVuZGVyZXIsIHRoaXMubm9kZS5jb25zdF90YWdzKTtcbiAgICAgICAgdGhpcy5ibG9jayA9IGJsb2NrLmNoaWxkKHtcbiAgICAgICAgICAgIGNvbW1lbnQ6IGNyZWF0ZV9kZWJ1Z2dpbmdfY29tbWVudCh0aGlzLm5vZGUsIHRoaXMucmVuZGVyZXIuY29tcG9uZW50KSxcbiAgICAgICAgICAgIG5hbWU6IHJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoJ2NyZWF0ZV9lYWNoX2Jsb2NrJyksXG4gICAgICAgICAgICB0eXBlOiAnZWFjaCcsXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IHByb2JhYmx5IGVycm9yXG4gICAgICAgICAgICBrZXk6IG5vZGUua2V5LFxuICAgICAgICAgICAgYmluZGluZ3M6IG5ldyBNYXAoYmxvY2suYmluZGluZ3MpXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBUT0RPIHRoaXMgc2VlbXMgbWVzc3lcbiAgICAgICAgdGhpcy5ibG9jay5oYXNfYW5pbWF0aW9uID0gdGhpcy5ub2RlLmhhc19hbmltYXRpb247XG4gICAgICAgIHRoaXMuaW5kZXhfbmFtZSA9IHRoaXMubm9kZS5pbmRleFxuICAgICAgICAgICAgPyB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogdGhpcy5ub2RlLmluZGV4IH1cbiAgICAgICAgICAgIDogcmVuZGVyZXIuY29tcG9uZW50LmdldF91bmlxdWVfbmFtZShgJHt0aGlzLm5vZGUuY29udGV4dH1faW5kZXhgKTtcbiAgICAgICAgY29uc3QgZml4ZWRfbGVuZ3RoID0gbm9kZS5leHByZXNzaW9uLm5vZGUudHlwZSA9PT0gJ0FycmF5RXhwcmVzc2lvbicgJiZcbiAgICAgICAgICAgIG5vZGUuZXhwcmVzc2lvbi5ub2RlLmVsZW1lbnRzLmV2ZXJ5KGVsZW1lbnQgPT4gZWxlbWVudC50eXBlICE9PSAnU3ByZWFkRWxlbWVudCcpXG4gICAgICAgICAgICA/IG5vZGUuZXhwcmVzc2lvbi5ub2RlLmVsZW1lbnRzLmxlbmd0aFxuICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAvLyBoYWNrIHRoZSBzb3VyY2VtYXAsIHNvIHRoYXQgaWYgZGF0YSBpcyBtaXNzaW5nIHRoZSBidWdcbiAgICAgICAgLy8gaXMgZWFzeSB0byBmaW5kXG4gICAgICAgIGxldCBjID0gdGhpcy5ub2RlLnN0YXJ0ICsgMjtcbiAgICAgICAgd2hpbGUgKHJlbmRlcmVyLmNvbXBvbmVudC5zb3VyY2VbY10gIT09ICdlJylcbiAgICAgICAgICAgIGMgKz0gMTtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSByZW5kZXJlci5jb21wb25lbnQubG9jYXRlKGMpO1xuICAgICAgICBjb25zdCBlbmQgPSB7IGxpbmU6IHN0YXJ0LmxpbmUsIGNvbHVtbjogc3RhcnQuY29sdW1uICsgNCB9O1xuICAgICAgICBjb25zdCBsZW5ndGggPSB7XG4gICAgICAgICAgICB0eXBlOiAnSWRlbnRpZmllcicsXG4gICAgICAgICAgICBuYW1lOiAnbGVuZ3RoJyxcbiAgICAgICAgICAgIGxvYzogeyBzdGFydCwgZW5kIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZWFjaF9ibG9ja192YWx1ZSA9IHJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoYCR7dGhpcy52YXIubmFtZX1fdmFsdWVgKTtcbiAgICAgICAgY29uc3QgaXRlcmF0aW9ucyA9IGJsb2NrLmdldF91bmlxdWVfbmFtZShgJHt0aGlzLnZhci5uYW1lfV9ibG9ja3NgKTtcbiAgICAgICAgcmVuZGVyZXIuYWRkX3RvX2NvbnRleHQoZWFjaF9ibG9ja192YWx1ZS5uYW1lLCB0cnVlKTtcbiAgICAgICAgcmVuZGVyZXIuYWRkX3RvX2NvbnRleHQodGhpcy5pbmRleF9uYW1lLm5hbWUsIHRydWUpO1xuICAgICAgICB0aGlzLnZhcnMgPSB7XG4gICAgICAgICAgICBjcmVhdGVfZWFjaF9ibG9jazogdGhpcy5ibG9jay5uYW1lLFxuICAgICAgICAgICAgZWFjaF9ibG9ja192YWx1ZSxcbiAgICAgICAgICAgIGdldF9lYWNoX2NvbnRleHQ6IHJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoYGdldF8ke3RoaXMudmFyLm5hbWV9X2NvbnRleHRgKSxcbiAgICAgICAgICAgIGl0ZXJhdGlvbnMsXG4gICAgICAgICAgICAvLyBvcHRpbWlzYXRpb24gZm9yIGFycmF5IGxpdGVyYWxcbiAgICAgICAgICAgIGZpeGVkX2xlbmd0aCxcbiAgICAgICAgICAgIGRhdGFfbGVuZ3RoOiBmaXhlZF9sZW5ndGggPT09IG51bGwgPyB4IGAke2VhY2hfYmxvY2tfdmFsdWV9LiR7bGVuZ3RofWAgOiBmaXhlZF9sZW5ndGgsXG4gICAgICAgICAgICB2aWV3X2xlbmd0aDogZml4ZWRfbGVuZ3RoID09PSBudWxsID8geCBgJHtpdGVyYXRpb25zfS5sZW5ndGhgIDogZml4ZWRfbGVuZ3RoXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IGdldF9vYmplY3Qobm9kZS5leHByZXNzaW9uLm5vZGUpO1xuICAgICAgICBjb25zdCBzdG9yZSA9IG9iamVjdC50eXBlID09PSAnSWRlbnRpZmllcicgJiYgb2JqZWN0Lm5hbWVbMF0gPT09ICckJyA/IG9iamVjdC5uYW1lLnNsaWNlKDEpIDogbnVsbDtcbiAgICAgICAgbm9kZS5jb250ZXh0cy5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgICAgICAgdGhpcy5ibG9jay5iaW5kaW5ncy5zZXQocHJvcC5rZXkubmFtZSwge1xuICAgICAgICAgICAgICAgIG9iamVjdDogdGhpcy52YXJzLmVhY2hfYmxvY2tfdmFsdWUsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IHRoaXMuaW5kZXhfbmFtZSxcbiAgICAgICAgICAgICAgICBtb2RpZmllcjogcHJvcC5tb2RpZmllcixcbiAgICAgICAgICAgICAgICBzbmlwcGV0OiBwcm9wLm1vZGlmaWVyKHggYCR7dGhpcy52YXJzLmVhY2hfYmxvY2tfdmFsdWV9WyR7dGhpcy5pbmRleF9uYW1lfV1gKSxcbiAgICAgICAgICAgICAgICBzdG9yZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5ub2RlLmluZGV4KSB7XG4gICAgICAgICAgICB0aGlzLmJsb2NrLmdldF91bmlxdWVfbmFtZSh0aGlzLm5vZGUuaW5kZXgpOyAvLyB0aGlzIHByZXZlbnRzIG5hbWUgY29sbGlzaW9ucyAoIzEyNTQpXG4gICAgICAgIH1cbiAgICAgICAgcmVuZGVyZXIuYmxvY2tzLnB1c2godGhpcy5ibG9jayk7XG4gICAgICAgIHRoaXMuZnJhZ21lbnQgPSBuZXcgRnJhZ21lbnRXcmFwcGVyKHJlbmRlcmVyLCB0aGlzLmJsb2NrLCBub2RlLmNoaWxkcmVuLCB0aGlzLCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpO1xuICAgICAgICBpZiAodGhpcy5ub2RlLmVsc2UpIHtcbiAgICAgICAgICAgIHRoaXMuZWxzZSA9IG5ldyBFbHNlQmxvY2tXcmFwcGVyKHJlbmRlcmVyLCBibG9jaywgdGhpcywgdGhpcy5ub2RlLmVsc2UsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZyk7XG4gICAgICAgICAgICByZW5kZXJlci5ibG9ja3MucHVzaCh0aGlzLmVsc2UuYmxvY2spO1xuICAgICAgICAgICAgaWYgKHRoaXMuZWxzZS5pc19keW5hbWljKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9jay5hZGRfZGVwZW5kZW5jaWVzKHRoaXMuZWxzZS5ibG9jay5kZXBlbmRlbmNpZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmFkZF9kZXBlbmRlbmNpZXModGhpcy5ibG9jay5kZXBlbmRlbmNpZXMpO1xuICAgICAgICBpZiAodGhpcy5ibG9jay5oYXNfb3V0cm9zIHx8ICh0aGlzLmVsc2UgJiYgdGhpcy5lbHNlLmJsb2NrLmhhc19vdXRyb3MpKSB7XG4gICAgICAgICAgICBibG9jay5hZGRfb3V0cm8oKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXIoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpIHtcbiAgICAgICAgaWYgKHRoaXMuZnJhZ21lbnQubm9kZXMubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCB7IHJlbmRlcmVyIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7IGNvbXBvbmVudCB9ID0gcmVuZGVyZXI7XG4gICAgICAgIGNvbnN0IG5lZWRzX2FuY2hvciA9IHRoaXMubmV4dFxuICAgICAgICAgICAgPyAhdGhpcy5uZXh0LmlzX2RvbV9ub2RlKCkgOlxuICAgICAgICAgICAgIXBhcmVudF9ub2RlIHx8ICF0aGlzLnBhcmVudC5pc19kb21fbm9kZSgpO1xuICAgICAgICBjb25zdCBzbmlwcGV0ID0gdGhpcy5ub2RlLmV4cHJlc3Npb24ubWFuaXB1bGF0ZShibG9jayk7XG4gICAgICAgIGJsb2NrLmNodW5rcy5pbml0LnB1c2goYiBgbGV0ICR7dGhpcy52YXJzLmVhY2hfYmxvY2tfdmFsdWV9ID0gJHtzbmlwcGV0fTtgKTtcbiAgICAgICAgaWYgKHRoaXMucmVuZGVyZXIub3B0aW9ucy5kZXYpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbml0LnB1c2goYiBgQHZhbGlkYXRlX2VhY2hfYXJndW1lbnQoJHt0aGlzLnZhcnMuZWFjaF9ibG9ja192YWx1ZX0pO2ApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGluaXRpYWxfYW5jaG9yX25vZGUgPSB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogcGFyZW50X25vZGUgPyAnbnVsbCcgOiAnI2FuY2hvcicgfTtcbiAgICAgICAgY29uc3QgaW5pdGlhbF9tb3VudF9ub2RlID0gcGFyZW50X25vZGUgfHwgeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6ICcjdGFyZ2V0JyB9O1xuICAgICAgICBjb25zdCB1cGRhdGVfYW5jaG9yX25vZGUgPSBuZWVkc19hbmNob3JcbiAgICAgICAgICAgID8gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke3RoaXMudmFyLm5hbWV9X2FuY2hvcmApXG4gICAgICAgICAgICA6ICh0aGlzLm5leHQgJiYgdGhpcy5uZXh0LnZhcikgfHwgeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6ICdudWxsJyB9O1xuICAgICAgICBjb25zdCB1cGRhdGVfbW91bnRfbm9kZSA9IHRoaXMuZ2V0X3VwZGF0ZV9tb3VudF9ub2RlKHVwZGF0ZV9hbmNob3Jfbm9kZSk7XG4gICAgICAgIGNvbnN0IGFyZ3MgPSB7XG4gICAgICAgICAgICBibG9jayxcbiAgICAgICAgICAgIHBhcmVudF9ub2RlLFxuICAgICAgICAgICAgcGFyZW50X25vZGVzLFxuICAgICAgICAgICAgc25pcHBldCxcbiAgICAgICAgICAgIGluaXRpYWxfYW5jaG9yX25vZGUsXG4gICAgICAgICAgICBpbml0aWFsX21vdW50X25vZGUsXG4gICAgICAgICAgICB1cGRhdGVfYW5jaG9yX25vZGUsXG4gICAgICAgICAgICB1cGRhdGVfbW91bnRfbm9kZVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBhbGxfZGVwZW5kZW5jaWVzID0gbmV3IFNldCh0aGlzLmJsb2NrLmRlcGVuZGVuY2llcyk7IC8vIFRPRE8gc2hvdWxkIGJlIGR5bmFtaWMgZGVwcyBvbmx5XG4gICAgICAgIHRoaXMubm9kZS5leHByZXNzaW9uLmR5bmFtaWNfZGVwZW5kZW5jaWVzKCkuZm9yRWFjaCgoZGVwZW5kZW5jeSkgPT4ge1xuICAgICAgICAgICAgYWxsX2RlcGVuZGVuY2llcy5hZGQoZGVwZW5kZW5jeSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5ub2RlLmtleSkge1xuICAgICAgICAgICAgdGhpcy5ub2RlLmtleS5keW5hbWljX2RlcGVuZGVuY2llcygpLmZvckVhY2goKGRlcGVuZGVuY3kpID0+IHtcbiAgICAgICAgICAgICAgICBhbGxfZGVwZW5kZW5jaWVzLmFkZChkZXBlbmRlbmN5KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gYWxsX2RlcGVuZGVuY2llcztcbiAgICAgICAgaWYgKHRoaXMubm9kZS5rZXkpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyX2tleWVkKGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJfdW5rZXllZChhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ibG9jay5oYXNfaW50cm9fbWV0aG9kIHx8IHRoaXMuYmxvY2suaGFzX291dHJvX21ldGhvZCkge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmludHJvLnB1c2goYiBgXG5cdFx0XHRcdGZvciAobGV0ICNpID0gMDsgI2kgPCAke3RoaXMudmFycy5kYXRhX2xlbmd0aH07ICNpICs9IDEpIHtcblx0XHRcdFx0XHRAdHJhbnNpdGlvbl9pbigke3RoaXMudmFycy5pdGVyYXRpb25zfVsjaV0pO1xuXHRcdFx0XHR9XG5cdFx0XHRgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmVlZHNfYW5jaG9yKSB7XG4gICAgICAgICAgICBibG9jay5hZGRfZWxlbWVudCh1cGRhdGVfYW5jaG9yX25vZGUsIHggYEBlbXB0eSgpYCwgcGFyZW50X25vZGVzICYmIHggYEBlbXB0eSgpYCwgcGFyZW50X25vZGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVsc2UpIHtcbiAgICAgICAgICAgIGxldCBlbHNlX2N0eCA9IHggYCNjdHhgO1xuICAgICAgICAgICAgaWYgKHRoaXMuZWxzZS5ub2RlLmNvbnN0X3RhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGdldF9jdHhfbmFtZSA9IHRoaXMucmVuZGVyZXIuY29tcG9uZW50LmdldF91bmlxdWVfbmFtZSgnZ2V0X2Vsc2VfY3R4Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5ibG9ja3MucHVzaChiIGBcblx0XHRcdFx0XHRmdW5jdGlvbiAke2dldF9jdHhfbmFtZX0oI2N0eCkge1xuXHRcdFx0XHRcdFx0Y29uc3QgY2hpbGRfY3R4ID0gI2N0eC5zbGljZSgpO1xuXHRcdFx0XHRcdFx0JHthZGRfY29uc3RfdGFncyhibG9jaywgdGhpcy5lbHNlLm5vZGUuY29uc3RfdGFncywgJ2NoaWxkX2N0eCcpfVxuXHRcdFx0XHRcdFx0cmV0dXJuIGNoaWxkX2N0eDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgICAgIGVsc2VfY3R4ID0geCBgJHtnZXRfY3R4X25hbWV9KCNjdHgpYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGVhY2hfYmxvY2tfZWxzZSA9IGNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoYCR7dGhpcy52YXIubmFtZX1fZWxzZWApO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBsZXQgJHtlYWNoX2Jsb2NrX2Vsc2V9ID0gbnVsbDtgKTtcbiAgICAgICAgICAgIC8vIFRPRE8gbmVhdGVuIHRoaXMgdXAuLi4gd2lsbCBlbmQgdXAgd2l0aCBhbiBlbXB0eSBsaW5lIGluIHRoZSBibG9ja1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdFx0aWYgKCEke3RoaXMudmFycy5kYXRhX2xlbmd0aH0pIHtcblx0XHRcdFx0XHQke2VhY2hfYmxvY2tfZWxzZX0gPSAke3RoaXMuZWxzZS5ibG9jay5uYW1lfSgke2Vsc2VfY3R4fSk7XG5cdFx0XHRcdH1cblx0XHRcdGApO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmNyZWF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRpZiAoJHtlYWNoX2Jsb2NrX2Vsc2V9KSB7XG5cdFx0XHRcdFx0JHtlYWNoX2Jsb2NrX2Vsc2V9LmMoKTtcblx0XHRcdFx0fVxuXHRcdFx0YCk7XG4gICAgICAgICAgICBpZiAodGhpcy5yZW5kZXJlci5vcHRpb25zLmh5ZHJhdGFibGUpIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuY2xhaW0ucHVzaChiIGBcblx0XHRcdFx0XHRpZiAoJHtlYWNoX2Jsb2NrX2Vsc2V9KSB7XG5cdFx0XHRcdFx0XHQke2VhY2hfYmxvY2tfZWxzZX0ubCgke3BhcmVudF9ub2Rlc30pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGBcblx0XHRcdFx0aWYgKCR7ZWFjaF9ibG9ja19lbHNlfSkge1xuXHRcdFx0XHRcdCR7ZWFjaF9ibG9ja19lbHNlfS5tKCR7aW5pdGlhbF9tb3VudF9ub2RlfSwgJHtpbml0aWFsX2FuY2hvcl9ub2RlfSk7XG5cdFx0XHRcdH1cblx0XHRcdGApO1xuICAgICAgICAgICAgY29uc3QgaGFzX3RyYW5zaXRpb25zID0gISEodGhpcy5lbHNlLmJsb2NrLmhhc19pbnRyb19tZXRob2QgfHwgdGhpcy5lbHNlLmJsb2NrLmhhc19vdXRyb19tZXRob2QpO1xuICAgICAgICAgICAgY29uc3QgZGVzdHJveV9ibG9ja19lbHNlID0gdGhpcy5lbHNlLmJsb2NrLmhhc19vdXRyb19tZXRob2RcbiAgICAgICAgICAgICAgICA/IGIgYFxuXHRcdFx0XHRcdEBncm91cF9vdXRyb3MoKTtcblx0XHRcdFx0XHRAdHJhbnNpdGlvbl9vdXQoJHtlYWNoX2Jsb2NrX2Vsc2V9LCAxLCAxLCAoKSA9PiB7XG5cdFx0XHRcdFx0XHQke2VhY2hfYmxvY2tfZWxzZX0gPSBudWxsO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdEBjaGVja19vdXRyb3MoKTtgXG4gICAgICAgICAgICAgICAgOiBiIGBcblx0XHRcdFx0XHQke2VhY2hfYmxvY2tfZWxzZX0uZCgxKTtcblx0XHRcdFx0XHQke2VhY2hfYmxvY2tfZWxzZX0gPSBudWxsO2A7XG4gICAgICAgICAgICBpZiAodGhpcy5lbHNlLmJsb2NrLmhhc191cGRhdGVfbWV0aG9kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVzLnB1c2goYiBgXG5cdFx0XHRcdFx0aWYgKCEke3RoaXMudmFycy5kYXRhX2xlbmd0aH0gJiYgJHtlYWNoX2Jsb2NrX2Vsc2V9KSB7XG5cdFx0XHRcdFx0XHQke2VhY2hfYmxvY2tfZWxzZX0ucCgke2Vsc2VfY3R4fSwgI2RpcnR5KTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCEke3RoaXMudmFycy5kYXRhX2xlbmd0aH0pIHtcblx0XHRcdFx0XHRcdCR7ZWFjaF9ibG9ja19lbHNlfSA9ICR7dGhpcy5lbHNlLmJsb2NrLm5hbWV9KCR7ZWxzZV9jdHh9KTtcblx0XHRcdFx0XHRcdCR7ZWFjaF9ibG9ja19lbHNlfS5jKCk7XG5cdFx0XHRcdFx0XHQke2hhc190cmFuc2l0aW9ucyAmJiBiIGBAdHJhbnNpdGlvbl9pbigke2VhY2hfYmxvY2tfZWxzZX0sIDEpO2B9XG5cdFx0XHRcdFx0XHQke2VhY2hfYmxvY2tfZWxzZX0ubSgke3VwZGF0ZV9tb3VudF9ub2RlfSwgJHt1cGRhdGVfYW5jaG9yX25vZGV9KTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCR7ZWFjaF9ibG9ja19lbHNlfSkge1xuXHRcdFx0XHRcdFx0JHtkZXN0cm95X2Jsb2NrX2Vsc2V9O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZXMucHVzaChiIGBcblx0XHRcdFx0XHRpZiAoJHt0aGlzLnZhcnMuZGF0YV9sZW5ndGh9KSB7XG5cdFx0XHRcdFx0XHRpZiAoJHtlYWNoX2Jsb2NrX2Vsc2V9KSB7XG5cdFx0XHRcdFx0XHRcdCR7ZGVzdHJveV9ibG9ja19lbHNlfTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2UgaWYgKCEke2VhY2hfYmxvY2tfZWxzZX0pIHtcblx0XHRcdFx0XHRcdCR7ZWFjaF9ibG9ja19lbHNlfSA9ICR7dGhpcy5lbHNlLmJsb2NrLm5hbWV9KCR7ZWxzZV9jdHh9KTtcblx0XHRcdFx0XHRcdCR7ZWFjaF9ibG9ja19lbHNlfS5jKCk7XG5cdFx0XHRcdFx0XHQke2hhc190cmFuc2l0aW9ucyAmJiBiIGBAdHJhbnNpdGlvbl9pbigke2VhY2hfYmxvY2tfZWxzZX0sIDEpO2B9XG5cdFx0XHRcdFx0XHQke2VhY2hfYmxvY2tfZWxzZX0ubSgke3VwZGF0ZV9tb3VudF9ub2RlfSwgJHt1cGRhdGVfYW5jaG9yX25vZGV9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmRlc3Ryb3kucHVzaChiIGBcblx0XHRcdFx0aWYgKCR7ZWFjaF9ibG9ja19lbHNlfSkgJHtlYWNoX2Jsb2NrX2Vsc2V9LmQoJHtwYXJlbnRfbm9kZSA/ICcnIDogJ2RldGFjaGluZyd9KTtcblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnVwZGF0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRcdGlmICgke2Jsb2NrLnJlbmRlcmVyLmRpcnR5KEFycmF5LmZyb20oYWxsX2RlcGVuZGVuY2llcykpfSkge1xuXHRcdFx0XHRcdCR7dGhpcy51cGRhdGVzfVxuXHRcdFx0XHR9XG5cdFx0XHRgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZyYWdtZW50LnJlbmRlcih0aGlzLmJsb2NrLCBudWxsLCB4IGAjbm9kZXNgKTtcbiAgICAgICAgaWYgKHRoaXMuZWxzZSkge1xuICAgICAgICAgICAgdGhpcy5lbHNlLmZyYWdtZW50LnJlbmRlcih0aGlzLmVsc2UuYmxvY2ssIG51bGwsIHggYCNub2Rlc2ApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udGV4dF9wcm9wcyA9IHRoaXMubm9kZS5jb250ZXh0cy5tYXAocHJvcCA9PiBiIGBjaGlsZF9jdHhbJHtyZW5kZXJlci5jb250ZXh0X2xvb2t1cC5nZXQocHJvcC5rZXkubmFtZSkuaW5kZXh9XSA9ICR7cHJvcC5kZWZhdWx0X21vZGlmaWVyKHByb3AubW9kaWZpZXIoeCBgbGlzdFtpXWApLCBuYW1lID0+IHJlbmRlcmVyLmNvbnRleHRfbG9va3VwLmhhcyhuYW1lKSA/IHggYGNoaWxkX2N0eFske3JlbmRlcmVyLmNvbnRleHRfbG9va3VwLmdldChuYW1lKS5pbmRleH1dYCA6IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lIH0pfTtgKTtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5oYXNfYmluZGluZylcbiAgICAgICAgICAgIHRoaXMuY29udGV4dF9wcm9wcy5wdXNoKGIgYGNoaWxkX2N0eFske3JlbmRlcmVyLmNvbnRleHRfbG9va3VwLmdldCh0aGlzLnZhcnMuZWFjaF9ibG9ja192YWx1ZS5uYW1lKS5pbmRleH1dID0gbGlzdDtgKTtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5oYXNfYmluZGluZyB8fCB0aGlzLm5vZGUuaGFzX2luZGV4X2JpbmRpbmcgfHwgdGhpcy5ub2RlLmluZGV4KVxuICAgICAgICAgICAgdGhpcy5jb250ZXh0X3Byb3BzLnB1c2goYiBgY2hpbGRfY3R4WyR7cmVuZGVyZXIuY29udGV4dF9sb29rdXAuZ2V0KHRoaXMuaW5kZXhfbmFtZS5uYW1lKS5pbmRleH1dID0gaTtgKTtcbiAgICAgICAgLy8gVE9ETyB3aGljaCBpcyBiZXR0ZXIg4oCUIE9iamVjdC5jcmVhdGUoYXJyYXkpIG9yIGFycmF5LnNsaWNlKCk/XG4gICAgICAgIHJlbmRlcmVyLmJsb2Nrcy5wdXNoKGIgYFxuXHRcdFx0ZnVuY3Rpb24gJHt0aGlzLnZhcnMuZ2V0X2VhY2hfY29udGV4dH0oI2N0eCwgbGlzdCwgaSkge1xuXHRcdFx0XHRjb25zdCBjaGlsZF9jdHggPSAjY3R4LnNsaWNlKCk7XG5cdFx0XHRcdCR7dGhpcy5jb250ZXh0X3Byb3BzfVxuXHRcdFx0XHQke2FkZF9jb25zdF90YWdzKHRoaXMuYmxvY2ssIHRoaXMubm9kZS5jb25zdF90YWdzLCAnY2hpbGRfY3R4Jyl9XG5cdFx0XHRcdHJldHVybiBjaGlsZF9jdHg7XG5cdFx0XHR9XG5cdFx0YCk7XG4gICAgfVxuICAgIHJlbmRlcl9rZXllZCh7IGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzLCBzbmlwcGV0LCBpbml0aWFsX2FuY2hvcl9ub2RlLCBpbml0aWFsX21vdW50X25vZGUsIHVwZGF0ZV9hbmNob3Jfbm9kZSwgdXBkYXRlX21vdW50X25vZGUgfSkge1xuICAgICAgICBjb25zdCB7IGNyZWF0ZV9lYWNoX2Jsb2NrLCBpdGVyYXRpb25zLCBkYXRhX2xlbmd0aCwgdmlld19sZW5ndGggfSA9IHRoaXMudmFycztcbiAgICAgICAgY29uc3QgZ2V0X2tleSA9IGJsb2NrLmdldF91bmlxdWVfbmFtZSgnZ2V0X2tleScpO1xuICAgICAgICBjb25zdCBsb29rdXAgPSBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7dGhpcy52YXIubmFtZX1fbG9va3VwYCk7XG4gICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShpdGVyYXRpb25zLCB4IGBbXWApO1xuICAgICAgICBibG9jay5hZGRfdmFyaWFibGUobG9va3VwLCB4IGBuZXcgQF9NYXAoKWApO1xuICAgICAgICBpZiAodGhpcy5mcmFnbWVudC5ub2Rlc1swXS5pc19kb21fbm9kZSgpKSB7XG4gICAgICAgICAgICB0aGlzLmJsb2NrLmZpcnN0ID0gdGhpcy5mcmFnbWVudC5ub2Rlc1swXS52YXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJsb2NrLmZpcnN0ID0gdGhpcy5ibG9jay5nZXRfdW5pcXVlX25hbWUoJ2ZpcnN0Jyk7XG4gICAgICAgICAgICB0aGlzLmJsb2NrLmFkZF9lbGVtZW50KHRoaXMuYmxvY2suZmlyc3QsIHggYEBlbXB0eSgpYCwgcGFyZW50X25vZGVzICYmIHggYEBlbXB0eSgpYCwgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdGNvbnN0ICR7Z2V0X2tleX0gPSAjY3R4ID0+ICR7dGhpcy5ub2RlLmtleS5tYW5pcHVsYXRlKGJsb2NrKX07XG5cblx0XHRcdCR7dGhpcy5yZW5kZXJlci5vcHRpb25zLmRldiAmJiBiIGBAdmFsaWRhdGVfZWFjaF9rZXlzKCNjdHgsICR7dGhpcy52YXJzLmVhY2hfYmxvY2tfdmFsdWV9LCAke3RoaXMudmFycy5nZXRfZWFjaF9jb250ZXh0fSwgJHtnZXRfa2V5fSk7YH1cblx0XHRcdGZvciAobGV0ICNpID0gMDsgI2kgPCAke2RhdGFfbGVuZ3RofTsgI2kgKz0gMSkge1xuXHRcdFx0XHRsZXQgY2hpbGRfY3R4ID0gJHt0aGlzLnZhcnMuZ2V0X2VhY2hfY29udGV4dH0oI2N0eCwgJHt0aGlzLnZhcnMuZWFjaF9ibG9ja192YWx1ZX0sICNpKTtcblx0XHRcdFx0bGV0IGtleSA9ICR7Z2V0X2tleX0oY2hpbGRfY3R4KTtcblx0XHRcdFx0JHtsb29rdXB9LnNldChrZXksICR7aXRlcmF0aW9uc31bI2ldID0gJHtjcmVhdGVfZWFjaF9ibG9ja30oa2V5LCBjaGlsZF9jdHgpKTtcblx0XHRcdH1cblx0XHRgKTtcbiAgICAgICAgYmxvY2suY2h1bmtzLmNyZWF0ZS5wdXNoKGIgYFxuXHRcdFx0Zm9yIChsZXQgI2kgPSAwOyAjaSA8ICR7dmlld19sZW5ndGh9OyAjaSArPSAxKSB7XG5cdFx0XHRcdCR7aXRlcmF0aW9uc31bI2ldLmMoKTtcblx0XHRcdH1cblx0XHRgKTtcbiAgICAgICAgaWYgKHBhcmVudF9ub2RlcyAmJiB0aGlzLnJlbmRlcmVyLm9wdGlvbnMuaHlkcmF0YWJsZSkge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmNsYWltLnB1c2goYiBgXG5cdFx0XHRcdGZvciAobGV0ICNpID0gMDsgI2kgPCAke3ZpZXdfbGVuZ3RofTsgI2kgKz0gMSkge1xuXHRcdFx0XHRcdCR7aXRlcmF0aW9uc31bI2ldLmwoJHtwYXJlbnRfbm9kZXN9KTtcblx0XHRcdFx0fVxuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goYiBgXG5cdFx0XHRmb3IgKGxldCAjaSA9IDA7ICNpIDwgJHt2aWV3X2xlbmd0aH07ICNpICs9IDEpIHtcblx0XHRcdFx0JHtpdGVyYXRpb25zfVsjaV0ubSgke2luaXRpYWxfbW91bnRfbm9kZX0sICR7aW5pdGlhbF9hbmNob3Jfbm9kZX0pO1xuXHRcdFx0fVxuXHRcdGApO1xuICAgICAgICBjb25zdCBkeW5hbWljID0gdGhpcy5ibG9jay5oYXNfdXBkYXRlX21ldGhvZDtcbiAgICAgICAgY29uc3QgZGVzdHJveSA9IHRoaXMubm9kZS5oYXNfYW5pbWF0aW9uXG4gICAgICAgICAgICA/ICh0aGlzLmJsb2NrLmhhc19vdXRyb3NcbiAgICAgICAgICAgICAgICA/ICdAZml4X2FuZF9vdXRyb19hbmRfZGVzdHJveV9ibG9jaydcbiAgICAgICAgICAgICAgICA6ICdAZml4X2FuZF9kZXN0cm95X2Jsb2NrJylcbiAgICAgICAgICAgIDogdGhpcy5ibG9jay5oYXNfb3V0cm9zXG4gICAgICAgICAgICAgICAgPyAnQG91dHJvX2FuZF9kZXN0cm95X2Jsb2NrJ1xuICAgICAgICAgICAgICAgIDogJ0BkZXN0cm95X2Jsb2NrJztcbiAgICAgICAgaWYgKHRoaXMuZGVwZW5kZW5jaWVzLnNpemUpIHtcbiAgICAgICAgICAgIHRoaXMuYmxvY2subWFpbnRhaW5fY29udGV4dCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZXMucHVzaChiIGBcblx0XHRcdFx0JHt0aGlzLnZhcnMuZWFjaF9ibG9ja192YWx1ZX0gPSAke3NuaXBwZXR9O1xuXHRcdFx0XHQke3RoaXMucmVuZGVyZXIub3B0aW9ucy5kZXYgJiYgYiBgQHZhbGlkYXRlX2VhY2hfYXJndW1lbnQoJHt0aGlzLnZhcnMuZWFjaF9ibG9ja192YWx1ZX0pO2B9XG5cblx0XHRcdFx0JHt0aGlzLmJsb2NrLmhhc19vdXRyb3MgJiYgYiBgQGdyb3VwX291dHJvcygpO2B9XG5cdFx0XHRcdCR7dGhpcy5ub2RlLmhhc19hbmltYXRpb24gJiYgYiBgZm9yIChsZXQgI2kgPSAwOyAjaSA8ICR7dmlld19sZW5ndGh9OyAjaSArPSAxKSAke2l0ZXJhdGlvbnN9WyNpXS5yKCk7YH1cblx0XHRcdFx0JHt0aGlzLnJlbmRlcmVyLm9wdGlvbnMuZGV2ICYmIGIgYEB2YWxpZGF0ZV9lYWNoX2tleXMoI2N0eCwgJHt0aGlzLnZhcnMuZWFjaF9ibG9ja192YWx1ZX0sICR7dGhpcy52YXJzLmdldF9lYWNoX2NvbnRleHR9LCAke2dldF9rZXl9KTtgfVxuXHRcdFx0XHQke2l0ZXJhdGlvbnN9ID0gQHVwZGF0ZV9rZXllZF9lYWNoKCR7aXRlcmF0aW9uc30sICNkaXJ0eSwgJHtnZXRfa2V5fSwgJHtkeW5hbWljID8gMSA6IDB9LCAjY3R4LCAke3RoaXMudmFycy5lYWNoX2Jsb2NrX3ZhbHVlfSwgJHtsb29rdXB9LCAke3VwZGF0ZV9tb3VudF9ub2RlfSwgJHtkZXN0cm95fSwgJHtjcmVhdGVfZWFjaF9ibG9ja30sICR7dXBkYXRlX2FuY2hvcl9ub2RlfSwgJHt0aGlzLnZhcnMuZ2V0X2VhY2hfY29udGV4dH0pO1xuXHRcdFx0XHQke3RoaXMubm9kZS5oYXNfYW5pbWF0aW9uICYmIGIgYGZvciAobGV0ICNpID0gMDsgI2kgPCAke3ZpZXdfbGVuZ3RofTsgI2kgKz0gMSkgJHtpdGVyYXRpb25zfVsjaV0uYSgpO2B9XG5cdFx0XHRcdCR7dGhpcy5ibG9jay5oYXNfb3V0cm9zICYmIGIgYEBjaGVja19vdXRyb3MoKTtgfVxuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYmxvY2suaGFzX291dHJvcykge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm91dHJvLnB1c2goYiBgXG5cdFx0XHRcdGZvciAobGV0ICNpID0gMDsgI2kgPCAke3ZpZXdfbGVuZ3RofTsgI2kgKz0gMSkge1xuXHRcdFx0XHRcdEB0cmFuc2l0aW9uX291dCgke2l0ZXJhdGlvbnN9WyNpXSk7XG5cdFx0XHRcdH1cblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgXG5cdFx0XHRmb3IgKGxldCAjaSA9IDA7ICNpIDwgJHt2aWV3X2xlbmd0aH07ICNpICs9IDEpIHtcblx0XHRcdFx0JHtpdGVyYXRpb25zfVsjaV0uZCgke3BhcmVudF9ub2RlID8gbnVsbCA6ICdkZXRhY2hpbmcnfSk7XG5cdFx0XHR9XG5cdFx0YCk7XG4gICAgfVxuICAgIHJlbmRlcl91bmtleWVkKHsgYmxvY2ssIHBhcmVudF9ub2Rlcywgc25pcHBldCwgaW5pdGlhbF9hbmNob3Jfbm9kZSwgaW5pdGlhbF9tb3VudF9ub2RlLCB1cGRhdGVfYW5jaG9yX25vZGUsIHVwZGF0ZV9tb3VudF9ub2RlIH0pIHtcbiAgICAgICAgY29uc3QgeyBjcmVhdGVfZWFjaF9ibG9jaywgaXRlcmF0aW9ucywgZml4ZWRfbGVuZ3RoLCBkYXRhX2xlbmd0aCwgdmlld19sZW5ndGggfSA9IHRoaXMudmFycztcbiAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdGxldCAke2l0ZXJhdGlvbnN9ID0gW107XG5cblx0XHRcdGZvciAobGV0ICNpID0gMDsgI2kgPCAke2RhdGFfbGVuZ3RofTsgI2kgKz0gMSkge1xuXHRcdFx0XHQke2l0ZXJhdGlvbnN9WyNpXSA9ICR7Y3JlYXRlX2VhY2hfYmxvY2t9KCR7dGhpcy52YXJzLmdldF9lYWNoX2NvbnRleHR9KCNjdHgsICR7dGhpcy52YXJzLmVhY2hfYmxvY2tfdmFsdWV9LCAjaSkpO1xuXHRcdFx0fVxuXHRcdGApO1xuICAgICAgICBibG9jay5jaHVua3MuY3JlYXRlLnB1c2goYiBgXG5cdFx0XHRmb3IgKGxldCAjaSA9IDA7ICNpIDwgJHt2aWV3X2xlbmd0aH07ICNpICs9IDEpIHtcblx0XHRcdFx0JHtpdGVyYXRpb25zfVsjaV0uYygpO1xuXHRcdFx0fVxuXHRcdGApO1xuICAgICAgICBpZiAocGFyZW50X25vZGVzICYmIHRoaXMucmVuZGVyZXIub3B0aW9ucy5oeWRyYXRhYmxlKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuY2xhaW0ucHVzaChiIGBcblx0XHRcdFx0Zm9yIChsZXQgI2kgPSAwOyAjaSA8ICR7dmlld19sZW5ndGh9OyAjaSArPSAxKSB7XG5cdFx0XHRcdFx0JHtpdGVyYXRpb25zfVsjaV0ubCgke3BhcmVudF9ub2Rlc30pO1xuXHRcdFx0XHR9XG5cdFx0XHRgKTtcbiAgICAgICAgfVxuICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGBcblx0XHRcdGZvciAobGV0ICNpID0gMDsgI2kgPCAke3ZpZXdfbGVuZ3RofTsgI2kgKz0gMSkge1xuXHRcdFx0XHQke2l0ZXJhdGlvbnN9WyNpXS5tKCR7aW5pdGlhbF9tb3VudF9ub2RlfSwgJHtpbml0aWFsX2FuY2hvcl9ub2RlfSk7XG5cdFx0XHR9XG5cdFx0YCk7XG4gICAgICAgIGlmICh0aGlzLmRlcGVuZGVuY2llcy5zaXplKSB7XG4gICAgICAgICAgICBjb25zdCBoYXNfdHJhbnNpdGlvbnMgPSAhISh0aGlzLmJsb2NrLmhhc19pbnRyb19tZXRob2QgfHwgdGhpcy5ibG9jay5oYXNfb3V0cm9fbWV0aG9kKTtcbiAgICAgICAgICAgIGNvbnN0IGZvcl9sb29wX2JvZHkgPSB0aGlzLmJsb2NrLmhhc191cGRhdGVfbWV0aG9kXG4gICAgICAgICAgICAgICAgPyBiIGBcblx0XHRcdFx0XHRpZiAoJHtpdGVyYXRpb25zfVsjaV0pIHtcblx0XHRcdFx0XHRcdCR7aXRlcmF0aW9uc31bI2ldLnAoY2hpbGRfY3R4LCAjZGlydHkpO1xuXHRcdFx0XHRcdFx0JHtoYXNfdHJhbnNpdGlvbnMgJiYgYiBgQHRyYW5zaXRpb25faW4oJHt0aGlzLnZhcnMuaXRlcmF0aW9uc31bI2ldLCAxKTtgfVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQke2l0ZXJhdGlvbnN9WyNpXSA9ICR7Y3JlYXRlX2VhY2hfYmxvY2t9KGNoaWxkX2N0eCk7XG5cdFx0XHRcdFx0XHQke2l0ZXJhdGlvbnN9WyNpXS5jKCk7XG5cdFx0XHRcdFx0XHQke2hhc190cmFuc2l0aW9ucyAmJiBiIGBAdHJhbnNpdGlvbl9pbigke3RoaXMudmFycy5pdGVyYXRpb25zfVsjaV0sIDEpO2B9XG5cdFx0XHRcdFx0XHQke2l0ZXJhdGlvbnN9WyNpXS5tKCR7dXBkYXRlX21vdW50X25vZGV9LCAke3VwZGF0ZV9hbmNob3Jfbm9kZX0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0YFxuICAgICAgICAgICAgICAgIDogaGFzX3RyYW5zaXRpb25zXG4gICAgICAgICAgICAgICAgICAgID8gYiBgXG5cdFx0XHRcdFx0XHRpZiAoJHtpdGVyYXRpb25zfVsjaV0pIHtcblx0XHRcdFx0XHRcdFx0QHRyYW5zaXRpb25faW4oJHt0aGlzLnZhcnMuaXRlcmF0aW9uc31bI2ldLCAxKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdCR7aXRlcmF0aW9uc31bI2ldID0gJHtjcmVhdGVfZWFjaF9ibG9ja30oY2hpbGRfY3R4KTtcblx0XHRcdFx0XHRcdFx0JHtpdGVyYXRpb25zfVsjaV0uYygpO1xuXHRcdFx0XHRcdFx0XHRAdHJhbnNpdGlvbl9pbigke3RoaXMudmFycy5pdGVyYXRpb25zfVsjaV0sIDEpO1xuXHRcdFx0XHRcdFx0XHQke2l0ZXJhdGlvbnN9WyNpXS5tKCR7dXBkYXRlX21vdW50X25vZGV9LCAke3VwZGF0ZV9hbmNob3Jfbm9kZX0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGBcbiAgICAgICAgICAgICAgICAgICAgOiBiIGBcblx0XHRcdFx0XHRcdGlmICghJHtpdGVyYXRpb25zfVsjaV0pIHtcblx0XHRcdFx0XHRcdFx0JHtpdGVyYXRpb25zfVsjaV0gPSAke2NyZWF0ZV9lYWNoX2Jsb2NrfShjaGlsZF9jdHgpO1xuXHRcdFx0XHRcdFx0XHQke2l0ZXJhdGlvbnN9WyNpXS5jKCk7XG5cdFx0XHRcdFx0XHRcdCR7aXRlcmF0aW9uc31bI2ldLm0oJHt1cGRhdGVfbW91bnRfbm9kZX0sICR7dXBkYXRlX2FuY2hvcl9ub2RlfSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YDtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5ibG9jay5oYXNfdXBkYXRlX21ldGhvZCA/IDAgOiAnI29sZF9sZW5ndGgnO1xuICAgICAgICAgICAgbGV0IHJlbW92ZV9vbGRfYmxvY2tzO1xuICAgICAgICAgICAgaWYgKHRoaXMuYmxvY2suaGFzX291dHJvcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG91dCA9IGJsb2NrLmdldF91bmlxdWVfbmFtZSgnb3V0Jyk7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdFx0XHRjb25zdCAke291dH0gPSBpID0+IEB0cmFuc2l0aW9uX291dCgke2l0ZXJhdGlvbnN9W2ldLCAxLCAxLCAoKSA9PiB7XG5cdFx0XHRcdFx0XHQke2l0ZXJhdGlvbnN9W2ldID0gbnVsbDtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0YCk7XG4gICAgICAgICAgICAgICAgcmVtb3ZlX29sZF9ibG9ja3MgPSBiIGBcblx0XHRcdFx0XHRAZ3JvdXBfb3V0cm9zKCk7XG5cdFx0XHRcdFx0Zm9yICgjaSA9ICR7ZGF0YV9sZW5ndGh9OyAjaSA8ICR7dmlld19sZW5ndGh9OyAjaSArPSAxKSB7XG5cdFx0XHRcdFx0XHQke291dH0oI2kpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRAY2hlY2tfb3V0cm9zKCk7XG5cdFx0XHRcdGA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZW1vdmVfb2xkX2Jsb2NrcyA9IGIgYFxuXHRcdFx0XHRcdGZvciAoJHt0aGlzLmJsb2NrLmhhc191cGRhdGVfbWV0aG9kID8gbnVsbCA6IHggYCNpID0gJHtkYXRhX2xlbmd0aH1gfTsgI2kgPCAke3RoaXMuYmxvY2suaGFzX3VwZGF0ZV9tZXRob2QgPyB2aWV3X2xlbmd0aCA6ICcjb2xkX2xlbmd0aCd9OyAjaSArPSAxKSB7XG5cdFx0XHRcdFx0XHQke2l0ZXJhdGlvbnN9WyNpXS5kKDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQkeyFmaXhlZF9sZW5ndGggJiYgYiBgJHt2aWV3X2xlbmd0aH0gPSAke2RhdGFfbGVuZ3RofTtgfVxuXHRcdFx0XHRgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gV2UgZGVjbGFyZSBgaWAgYXMgYmxvY2sgc2NvcGVkIGhlcmUsIGFzIHRoZSBgcmVtb3ZlX29sZF9ibG9ja3NgIGNvZGVcbiAgICAgICAgICAgIC8vIG1heSByZWx5IG9uIGNvbnRpbnVpbmcgd2hlcmUgdGhpcyBpdGVyYXRpb24gc3RvcHBlZC5cbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZSA9IGIgYFxuXHRcdFx0XHQkeyF0aGlzLmJsb2NrLmhhc191cGRhdGVfbWV0aG9kICYmIGIgYGNvbnN0ICNvbGRfbGVuZ3RoID0gJHt0aGlzLnZhcnMuZWFjaF9ibG9ja192YWx1ZX0ubGVuZ3RoO2B9XG5cdFx0XHRcdCR7dGhpcy52YXJzLmVhY2hfYmxvY2tfdmFsdWV9ID0gJHtzbmlwcGV0fTtcblx0XHRcdFx0JHt0aGlzLnJlbmRlcmVyLm9wdGlvbnMuZGV2ICYmIGIgYEB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50KCR7dGhpcy52YXJzLmVhY2hfYmxvY2tfdmFsdWV9KTtgfVxuXG5cdFx0XHRcdGxldCAjaTtcblx0XHRcdFx0Zm9yICgjaSA9ICR7c3RhcnR9OyAjaSA8ICR7ZGF0YV9sZW5ndGh9OyAjaSArPSAxKSB7XG5cdFx0XHRcdFx0Y29uc3QgY2hpbGRfY3R4ID0gJHt0aGlzLnZhcnMuZ2V0X2VhY2hfY29udGV4dH0oI2N0eCwgJHt0aGlzLnZhcnMuZWFjaF9ibG9ja192YWx1ZX0sICNpKTtcblxuXHRcdFx0XHRcdCR7Zm9yX2xvb3BfYm9keX1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdCR7cmVtb3ZlX29sZF9ibG9ja3N9XG5cdFx0XHRgO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVzLnB1c2godXBkYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ibG9jay5oYXNfb3V0cm9zKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3Mub3V0cm8ucHVzaChiIGBcblx0XHRcdFx0JHtpdGVyYXRpb25zfSA9ICR7aXRlcmF0aW9uc30uZmlsdGVyKEBfQm9vbGVhbik7XG5cdFx0XHRcdGZvciAobGV0ICNpID0gMDsgI2kgPCAke3ZpZXdfbGVuZ3RofTsgI2kgKz0gMSkge1xuXHRcdFx0XHRcdEB0cmFuc2l0aW9uX291dCgke2l0ZXJhdGlvbnN9WyNpXSk7XG5cdFx0XHRcdH1cblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgQGRlc3Ryb3lfZWFjaCgke2l0ZXJhdGlvbnN9LCBkZXRhY2hpbmcpO2ApO1xuICAgIH1cbn1cblxuY29uc3QgcmVnZXhfbm9uX3doaXRlc3BhY2VfY2hhcmFjdGVycyQxID0gL1tcXFNcXHUwMEEwXS87XG5jbGFzcyBUZXh0V3JhcHBlciBleHRlbmRzIFdyYXBwZXIge1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlLCBkYXRhKSB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlKTtcbiAgICAgICAgdGhpcy5za2lwID0gdGhpcy5ub2RlLnNob3VsZF9za2lwKCk7XG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICAgIHRoaXMudmFyID0gKHRoaXMuc2tpcCA/IG51bGwgOiB4IGB0YCk7XG4gICAgfVxuICAgIHVzZV9zcGFjZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVuZGVyZXIuY29tcG9uZW50LmNvbXBvbmVudF9vcHRpb25zLnByZXNlcnZlV2hpdGVzcGFjZSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKHJlZ2V4X25vbl93aGl0ZXNwYWNlX2NoYXJhY3RlcnMkMS50ZXN0KHRoaXMuZGF0YSkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiAhdGhpcy5ub2RlLndpdGhpbl9wcmUoKTtcbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKSB7XG4gICAgICAgIGlmICh0aGlzLnNraXApXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IHVzZV9zcGFjZSA9IHRoaXMudXNlX3NwYWNlKCk7XG4gICAgICAgIGNvbnN0IHN0cmluZ19saXRlcmFsID0ge1xuICAgICAgICAgICAgdHlwZTogJ0xpdGVyYWwnLFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMuZGF0YSxcbiAgICAgICAgICAgIGxvYzoge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiB0aGlzLnJlbmRlcmVyLmxvY2F0ZSh0aGlzLm5vZGUuc3RhcnQpLFxuICAgICAgICAgICAgICAgIGVuZDogdGhpcy5yZW5kZXJlci5sb2NhdGUodGhpcy5ub2RlLmVuZClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgYmxvY2suYWRkX2VsZW1lbnQodGhpcy52YXIsIHVzZV9zcGFjZSA/IHggYEBzcGFjZSgpYCA6IHggYEB0ZXh0KCR7c3RyaW5nX2xpdGVyYWx9KWAsIHBhcmVudF9ub2RlcyAmJiAodXNlX3NwYWNlID8geCBgQGNsYWltX3NwYWNlKCR7cGFyZW50X25vZGVzfSlgIDogeCBgQGNsYWltX3RleHQoJHtwYXJlbnRfbm9kZXN9LCAke3N0cmluZ19saXRlcmFsfSlgKSwgcGFyZW50X25vZGUpO1xuICAgIH1cbn1cblxuY29uc3Qgc3ZnX2F0dHJpYnV0ZXMgPSAnYWNjZW50LWhlaWdodCBhY2N1bXVsYXRlIGFkZGl0aXZlIGFsaWdubWVudC1iYXNlbGluZSBhbGxvd1Jlb3JkZXIgYWxwaGFiZXRpYyBhbXBsaXR1ZGUgYXJhYmljLWZvcm0gYXNjZW50IGF0dHJpYnV0ZU5hbWUgYXR0cmlidXRlVHlwZSBhdXRvUmV2ZXJzZSBhemltdXRoIGJhc2VGcmVxdWVuY3kgYmFzZWxpbmUtc2hpZnQgYmFzZVByb2ZpbGUgYmJveCBiZWdpbiBiaWFzIGJ5IGNhbGNNb2RlIGNhcC1oZWlnaHQgY2xhc3MgY2xpcCBjbGlwUGF0aFVuaXRzIGNsaXAtcGF0aCBjbGlwLXJ1bGUgY29sb3IgY29sb3ItaW50ZXJwb2xhdGlvbiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnMgY29sb3ItcHJvZmlsZSBjb2xvci1yZW5kZXJpbmcgY29udGVudFNjcmlwdFR5cGUgY29udGVudFN0eWxlVHlwZSBjdXJzb3IgY3ggY3kgZCBkZWNlbGVyYXRlIGRlc2NlbnQgZGlmZnVzZUNvbnN0YW50IGRpcmVjdGlvbiBkaXNwbGF5IGRpdmlzb3IgZG9taW5hbnQtYmFzZWxpbmUgZHVyIGR4IGR5IGVkZ2VNb2RlIGVsZXZhdGlvbiBlbmFibGUtYmFja2dyb3VuZCBlbmQgZXhwb25lbnQgZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCBmaWxsIGZpbGwtb3BhY2l0eSBmaWxsLXJ1bGUgZmlsdGVyIGZpbHRlclJlcyBmaWx0ZXJVbml0cyBmbG9vZC1jb2xvciBmbG9vZC1vcGFjaXR5IGZvbnQtZmFtaWx5IGZvbnQtc2l6ZSBmb250LXNpemUtYWRqdXN0IGZvbnQtc3RyZXRjaCBmb250LXN0eWxlIGZvbnQtdmFyaWFudCBmb250LXdlaWdodCBmb3JtYXQgZnJvbSBmciBmeCBmeSBnMSBnMiBnbHlwaC1uYW1lIGdseXBoLW9yaWVudGF0aW9uLWhvcml6b250YWwgZ2x5cGgtb3JpZW50YXRpb24tdmVydGljYWwgZ2x5cGhSZWYgZ3JhZGllbnRUcmFuc2Zvcm0gZ3JhZGllbnRVbml0cyBoYW5naW5nIGhlaWdodCBocmVmIGhvcml6LWFkdi14IGhvcml6LW9yaWdpbi14IGlkIGlkZW9ncmFwaGljIGltYWdlLXJlbmRlcmluZyBpbiBpbjIgaW50ZXJjZXB0IGsgazEgazIgazMgazQga2VybmVsTWF0cml4IGtlcm5lbFVuaXRMZW5ndGgga2VybmluZyBrZXlQb2ludHMga2V5U3BsaW5lcyBrZXlUaW1lcyBsYW5nIGxlbmd0aEFkanVzdCBsZXR0ZXItc3BhY2luZyBsaWdodGluZy1jb2xvciBsaW1pdGluZ0NvbmVBbmdsZSBsb2NhbCBtYXJrZXItZW5kIG1hcmtlci1taWQgbWFya2VyLXN0YXJ0IG1hcmtlckhlaWdodCBtYXJrZXJVbml0cyBtYXJrZXJXaWR0aCBtYXNrIG1hc2tDb250ZW50VW5pdHMgbWFza1VuaXRzIG1hdGhlbWF0aWNhbCBtYXggbWVkaWEgbWV0aG9kIG1pbiBtb2RlIG5hbWUgbnVtT2N0YXZlcyBvZmZzZXQgb25hYm9ydCBvbmFjdGl2YXRlIG9uYmVnaW4gb25jbGljayBvbmVuZCBvbmVycm9yIG9uZm9jdXNpbiBvbmZvY3Vzb3V0IG9ubG9hZCBvbm1vdXNlZG93biBvbm1vdXNlbW92ZSBvbm1vdXNlb3V0IG9ubW91c2VvdmVyIG9ubW91c2V1cCBvbnJlcGVhdCBvbnJlc2l6ZSBvbnNjcm9sbCBvbnVubG9hZCBvcGFjaXR5IG9wZXJhdG9yIG9yZGVyIG9yaWVudCBvcmllbnRhdGlvbiBvcmlnaW4gb3ZlcmZsb3cgb3ZlcmxpbmUtcG9zaXRpb24gb3ZlcmxpbmUtdGhpY2tuZXNzIHBhbm9zZS0xIHBhaW50LW9yZGVyIHBhdGhMZW5ndGggcGF0dGVybkNvbnRlbnRVbml0cyBwYXR0ZXJuVHJhbnNmb3JtIHBhdHRlcm5Vbml0cyBwb2ludGVyLWV2ZW50cyBwb2ludHMgcG9pbnRzQXRYIHBvaW50c0F0WSBwb2ludHNBdFogcHJlc2VydmVBbHBoYSBwcmVzZXJ2ZUFzcGVjdFJhdGlvIHByaW1pdGl2ZVVuaXRzIHIgcmFkaXVzIHJlZlggcmVmWSByZW5kZXJpbmctaW50ZW50IHJlcGVhdENvdW50IHJlcGVhdER1ciByZXF1aXJlZEV4dGVuc2lvbnMgcmVxdWlyZWRGZWF0dXJlcyByZXN0YXJ0IHJlc3VsdCByb3RhdGUgcnggcnkgc2NhbGUgc2VlZCBzaGFwZS1yZW5kZXJpbmcgc2xvcGUgc3BhY2luZyBzcGVjdWxhckNvbnN0YW50IHNwZWN1bGFyRXhwb25lbnQgc3BlZWQgc3ByZWFkTWV0aG9kIHN0YXJ0T2Zmc2V0IHN0ZERldmlhdGlvbiBzdGVtaCBzdGVtdiBzdGl0Y2hUaWxlcyBzdG9wLWNvbG9yIHN0b3Atb3BhY2l0eSBzdHJpa2V0aHJvdWdoLXBvc2l0aW9uIHN0cmlrZXRocm91Z2gtdGhpY2tuZXNzIHN0cmluZyBzdHJva2Ugc3Ryb2tlLWRhc2hhcnJheSBzdHJva2UtZGFzaG9mZnNldCBzdHJva2UtbGluZWNhcCBzdHJva2UtbGluZWpvaW4gc3Ryb2tlLW1pdGVybGltaXQgc3Ryb2tlLW9wYWNpdHkgc3Ryb2tlLXdpZHRoIHN0eWxlIHN1cmZhY2VTY2FsZSBzeXN0ZW1MYW5ndWFnZSB0YWJpbmRleCB0YWJsZVZhbHVlcyB0YXJnZXQgdGFyZ2V0WCB0YXJnZXRZIHRleHQtYW5jaG9yIHRleHQtZGVjb3JhdGlvbiB0ZXh0LXJlbmRlcmluZyB0ZXh0TGVuZ3RoIHRvIHRyYW5zZm9ybSB0eXBlIHUxIHUyIHVuZGVybGluZS1wb3NpdGlvbiB1bmRlcmxpbmUtdGhpY2tuZXNzIHVuaWNvZGUgdW5pY29kZS1iaWRpIHVuaWNvZGUtcmFuZ2UgdW5pdHMtcGVyLWVtIHYtYWxwaGFiZXRpYyB2LWhhbmdpbmcgdi1pZGVvZ3JhcGhpYyB2LW1hdGhlbWF0aWNhbCB2YWx1ZXMgdmVyc2lvbiB2ZXJ0LWFkdi15IHZlcnQtb3JpZ2luLXggdmVydC1vcmlnaW4teSB2aWV3Qm94IHZpZXdUYXJnZXQgdmlzaWJpbGl0eSB3aWR0aCB3aWR0aHMgd29yZC1zcGFjaW5nIHdyaXRpbmctbW9kZSB4IHgtaGVpZ2h0IHgxIHgyIHhDaGFubmVsU2VsZWN0b3IgeGxpbms6YWN0dWF0ZSB4bGluazphcmNyb2xlIHhsaW5rOmhyZWYgeGxpbms6cm9sZSB4bGluazpzaG93IHhsaW5rOnRpdGxlIHhsaW5rOnR5cGUgeG1sOmJhc2UgeG1sOmxhbmcgeG1sOnNwYWNlIHkgeTEgeTIgeUNoYW5uZWxTZWxlY3RvciB6IHpvb21BbmRQYW4nLnNwbGl0KCcgJyk7XG5jb25zdCBzdmdfYXR0cmlidXRlX2xvb2t1cCA9IG5ldyBNYXAoKTtcbnN2Z19hdHRyaWJ1dGVzLmZvckVhY2gobmFtZSA9PiB7XG4gICAgc3ZnX2F0dHJpYnV0ZV9sb29rdXAuc2V0KG5hbWUudG9Mb3dlckNhc2UoKSwgbmFtZSk7XG59KTtcbmZ1bmN0aW9uIGZpeF9hdHRyaWJ1dGVfY2FzaW5nKG5hbWUpIHtcbiAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBzdmdfYXR0cmlidXRlX2xvb2t1cC5nZXQobmFtZSkgfHwgbmFtZTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlX3NlbGVjdF92YWx1ZV9iaW5kaW5nKGF0dHIsIGRlcGVuZGVuY2llcykge1xuICAgIGNvbnN0IHsgcGFyZW50IH0gPSBhdHRyO1xuICAgIGlmIChwYXJlbnQubm9kZS5uYW1lID09PSAnc2VsZWN0Jykge1xuICAgICAgICBwYXJlbnQuc2VsZWN0X2JpbmRpbmdfZGVwZW5kZW5jaWVzID0gZGVwZW5kZW5jaWVzO1xuICAgICAgICBkZXBlbmRlbmNpZXMuZm9yRWFjaCgocHJvcCkgPT4ge1xuICAgICAgICAgICAgcGFyZW50LnJlbmRlcmVyLmNvbXBvbmVudC5pbmRpcmVjdF9kZXBlbmRlbmNpZXMuc2V0KHByb3AsIG5ldyBTZXQoKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8gc291cmNlOiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9pbmRpY2VzLmh0bWxcbmNvbnN0IGJvb2xlYW5fYXR0cmlidXRlcyA9IG5ldyBTZXQoW1xuICAgICdhbGxvd2Z1bGxzY3JlZW4nLFxuICAgICdhbGxvd3BheW1lbnRyZXF1ZXN0JyxcbiAgICAnYXN5bmMnLFxuICAgICdhdXRvZm9jdXMnLFxuICAgICdhdXRvcGxheScsXG4gICAgJ2NoZWNrZWQnLFxuICAgICdjb250cm9scycsXG4gICAgJ2RlZmF1bHQnLFxuICAgICdkZWZlcicsXG4gICAgJ2Rpc2FibGVkJyxcbiAgICAnZm9ybW5vdmFsaWRhdGUnLFxuICAgICdoaWRkZW4nLFxuICAgICdpbmVydCcsXG4gICAgJ2lzbWFwJyxcbiAgICAnaXRlbXNjb3BlJyxcbiAgICAnbG9vcCcsXG4gICAgJ211bHRpcGxlJyxcbiAgICAnbXV0ZWQnLFxuICAgICdub21vZHVsZScsXG4gICAgJ25vdmFsaWRhdGUnLFxuICAgICdvcGVuJyxcbiAgICAncGxheXNpbmxpbmUnLFxuICAgICdyZWFkb25seScsXG4gICAgJ3JlcXVpcmVkJyxcbiAgICAncmV2ZXJzZWQnLFxuICAgICdzZWxlY3RlZCdcbl0pO1xuXG5jb25zdCBub25fdGV4dGxpa2VfaW5wdXRfdHlwZXMgPSBuZXcgU2V0KFtcbiAgICAnYnV0dG9uJyxcbiAgICAnY2hlY2tib3gnLFxuICAgICdjb2xvcicsXG4gICAgJ2RhdGUnLFxuICAgICdkYXRldGltZS1sb2NhbCcsXG4gICAgJ2ZpbGUnLFxuICAgICdoaWRkZW4nLFxuICAgICdpbWFnZScsXG4gICAgJ3JhZGlvJyxcbiAgICAncmFuZ2UnLFxuICAgICdyZXNldCcsXG4gICAgJ3N1Ym1pdCdcbl0pO1xuY2xhc3MgQmFzZUF0dHJpYnV0ZVdyYXBwZXIge1xuICAgIGNvbnN0cnVjdG9yKHBhcmVudCwgYmxvY2ssIG5vZGUpIHtcbiAgICAgICAgdGhpcy5ub2RlID0gbm9kZTtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIGlmIChub2RlLmRlcGVuZGVuY2llcy5zaXplID4gMCkge1xuICAgICAgICAgICAgcGFyZW50LmNhbm5vdF91c2VfaW5uZXJodG1sKCk7XG4gICAgICAgICAgICBwYXJlbnQubm90X3N0YXRpY19jb250ZW50KCk7XG4gICAgICAgICAgICBibG9jay5hZGRfZGVwZW5kZW5jaWVzKG5vZGUuZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXIoX2Jsb2NrKSB7IH1cbn1cbmNvbnN0IHJlZ2V4X21pbnVzX3NpZ24kMSA9IC8tLztcbmNvbnN0IHJlZ2V4X2ludmFsaWRfdmFyaWFibGVfaWRlbnRpZmllcl9jaGFyYWN0ZXJzJDEgPSAvW15hLXpBLVpfJF0vZztcbmNsYXNzIEF0dHJpYnV0ZVdyYXBwZXIgZXh0ZW5kcyBCYXNlQXR0cmlidXRlV3JhcHBlciB7XG4gICAgY29uc3RydWN0b3IocGFyZW50LCBibG9jaywgbm9kZSkge1xuICAgICAgICBzdXBlcihwYXJlbnQsIGJsb2NrLCBub2RlKTtcbiAgICAgICAgaWYgKG5vZGUuZGVwZW5kZW5jaWVzLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAvLyBzcGVjaWFsIGNhc2Ug4oCUIDxvcHRpb24gdmFsdWU9e2Zvb30+IOKAlCBzZWUgYmVsb3dcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5ub2RlLm5hbWUgPT09ICdvcHRpb24nICYmIG5vZGUubmFtZSA9PT0gJ3ZhbHVlJykge1xuICAgICAgICAgICAgICAgIGxldCBzZWxlY3QgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoc2VsZWN0ICYmIChzZWxlY3Qubm9kZS50eXBlICE9PSAnRWxlbWVudCcgfHwgc2VsZWN0Lm5vZGUubmFtZSAhPT0gJ3NlbGVjdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogZG91YmxlY2hlY2sgdGhpcywgYnV0IGxvb2tzIHRvIGJlIGNvcnJlY3RcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ID0gc2VsZWN0LnBhcmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdCAmJiBzZWxlY3Quc2VsZWN0X2JpbmRpbmdfZGVwZW5kZW5jaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdC5zZWxlY3RfYmluZGluZ19kZXBlbmRlbmNpZXMuZm9yRWFjaChwcm9wID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZS5kZXBlbmRlbmNpZXMuZm9yRWFjaCgoZGVwZW5kZW5jeSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnJlbmRlcmVyLmNvbXBvbmVudC5pbmRpcmVjdF9kZXBlbmRlbmNpZXMuZ2V0KHByb3ApLmFkZChkZXBlbmRlbmN5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm9kZS5uYW1lID09PSAndmFsdWUnKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlX3NlbGVjdF92YWx1ZV9iaW5kaW5nKHRoaXMsIG5vZGUuZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQubm9kZS5uYW1lc3BhY2UgPT0gbmFtZXNwYWNlcy5mb3JlaWduKSB7XG4gICAgICAgICAgICAvLyBsZWF2ZSBhdHRyaWJ1dGUgY2FzZSBhbG9uZSBmb3IgZWxlbWVudHMgaW4gdGhlIFwiZm9yZWlnblwiIG5hbWVzcGFjZVxuICAgICAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5ub2RlLm5hbWU7XG4gICAgICAgICAgICB0aGlzLm1ldGFkYXRhID0gdGhpcy5nZXRfbWV0YWRhdGEoKTtcbiAgICAgICAgICAgIHRoaXMuaXNfaW5kaXJlY3RseV9ib3VuZF92YWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eV9uYW1lID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuaXNfc2VsZWN0X3ZhbHVlX2F0dHJpYnV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5pc19pbnB1dF92YWx1ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gZml4X2F0dHJpYnV0ZV9jYXNpbmcodGhpcy5ub2RlLm5hbWUpO1xuICAgICAgICAgICAgdGhpcy5tZXRhZGF0YSA9IHRoaXMuZ2V0X21ldGFkYXRhKCk7XG4gICAgICAgICAgICB0aGlzLmlzX2luZGlyZWN0bHlfYm91bmRfdmFsdWUgPSBpc19pbmRpcmVjdGx5X2JvdW5kX3ZhbHVlKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eV9uYW1lID0gdGhpcy5pc19pbmRpcmVjdGx5X2JvdW5kX3ZhbHVlXG4gICAgICAgICAgICAgICAgPyAnX192YWx1ZSdcbiAgICAgICAgICAgICAgICA6IHRoaXMubWV0YWRhdGEgJiYgdGhpcy5tZXRhZGF0YS5wcm9wZXJ0eV9uYW1lO1xuICAgICAgICAgICAgdGhpcy5pc19zZWxlY3RfdmFsdWVfYXR0cmlidXRlID0gdGhpcy5uYW1lID09PSAndmFsdWUnICYmIHRoaXMucGFyZW50Lm5vZGUubmFtZSA9PT0gJ3NlbGVjdCc7XG4gICAgICAgICAgICB0aGlzLmlzX2lucHV0X3ZhbHVlID0gdGhpcy5uYW1lID09PSAndmFsdWUnICYmIHRoaXMucGFyZW50Lm5vZGUubmFtZSA9PT0gJ2lucHV0JztcbiAgICAgICAgfVxuICAgICAgICAvLyBUT0RPIHJldGlyZSB0aGlzIGV4Y2VwdGlvbiBpbiBmYXZvdXIgb2YgaHR0cHM6Ly9naXRodWIuY29tL3N2ZWx0ZWpzL3N2ZWx0ZS9pc3N1ZXMvMzc1MFxuICAgICAgICB0aGlzLmlzX3NyYyA9IHRoaXMubmFtZSA9PT0gJ3NyYycgJiYgKCF0aGlzLnBhcmVudC5ub2RlLm5hbWVzcGFjZSB8fCB0aGlzLnBhcmVudC5ub2RlLm5hbWVzcGFjZSA9PT0gbmFtZXNwYWNlcy5odG1sKTtcbiAgICAgICAgdGhpcy5zaG91bGRfY2FjaGUgPSBzaG91bGRfY2FjaGUodGhpcyk7XG4gICAgfVxuICAgIHJlbmRlcihibG9jaykge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGNvbnN0IHsgbmFtZSwgcHJvcGVydHlfbmFtZSwgc2hvdWxkX2NhY2hlLCBpc19pbmRpcmVjdGx5X2JvdW5kX3ZhbHVlIH0gPSB0aGlzO1xuICAgICAgICAvLyB4bGluayBpcyBhIHNwZWNpYWwgY2FzZS4uLiB3ZSBjb3VsZCBtYXliZSBleHRlbmQgdGhpcyB0byBnZW5lcmljXG4gICAgICAgIC8vIG5hbWVzcGFjZWQgYXR0cmlidXRlcyBidXQgSSdtIG5vdCBzdXJlIHRoYXQncyBhcHBsaWNhYmxlIGluXG4gICAgICAgIC8vIEhUTUw1P1xuICAgICAgICBjb25zdCBtZXRob2QgPSByZWdleF9taW51c19zaWduJDEudGVzdChlbGVtZW50Lm5vZGUubmFtZSlcbiAgICAgICAgICAgID8gJ0BzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YSdcbiAgICAgICAgICAgIDogbmFtZS5zbGljZSgwLCA2KSA9PT0gJ3hsaW5rOidcbiAgICAgICAgICAgICAgICA/ICdAeGxpbmtfYXR0cidcbiAgICAgICAgICAgICAgICA6ICdAYXR0cic7XG4gICAgICAgIGNvbnN0IGlzX2xlZ2FjeV9pbnB1dF90eXBlID0gZWxlbWVudC5yZW5kZXJlci5jb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmxlZ2FjeSAmJiBuYW1lID09PSAndHlwZScgJiYgdGhpcy5wYXJlbnQubm9kZS5uYW1lID09PSAnaW5wdXQnO1xuICAgICAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSB0aGlzLmdldF9kZXBlbmRlbmNpZXMoKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmdldF92YWx1ZShibG9jayk7XG4gICAgICAgIGxldCB1cGRhdGVyO1xuICAgICAgICBjb25zdCBpbml0ID0gdGhpcy5nZXRfaW5pdChibG9jaywgdmFsdWUpO1xuICAgICAgICBpZiAoaXNfbGVnYWN5X2lucHV0X3R5cGUpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5oeWRyYXRlLnB1c2goYiBgQHNldF9pbnB1dF90eXBlKCR7ZWxlbWVudC52YXJ9LCAke2luaXR9KTtgKTtcbiAgICAgICAgICAgIHVwZGF0ZXIgPSBiIGBAc2V0X2lucHV0X3R5cGUoJHtlbGVtZW50LnZhcn0sICR7c2hvdWxkX2NhY2hlID8gdGhpcy5sYXN0IDogdmFsdWV9KTtgO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaXNfc2VsZWN0X3ZhbHVlX2F0dHJpYnV0ZSkge1xuICAgICAgICAgICAgLy8gYW5ub3lpbmcgc3BlY2lhbCBjYXNlXG4gICAgICAgICAgICBjb25zdCBpc19tdWx0aXBsZV9zZWxlY3QgPSBlbGVtZW50Lm5vZGUuZ2V0X3N0YXRpY19hdHRyaWJ1dGVfdmFsdWUoJ211bHRpcGxlJyk7XG4gICAgICAgICAgICBpZiAoaXNfbXVsdGlwbGVfc2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgdXBkYXRlciA9IGIgYEBzZWxlY3Rfb3B0aW9ucygke2VsZW1lbnQudmFyfSwgJHt2YWx1ZX0pO2A7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cGRhdGVyID0gYiBgQHNlbGVjdF9vcHRpb24oJHtlbGVtZW50LnZhcn0sICR7dmFsdWV9KTtgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goYiBgXG5cdFx0XHRcdCR7dXBkYXRlcn1cblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaXNfc3JjKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaHlkcmF0ZS5wdXNoKGIgYGlmICghQHNyY191cmxfZXF1YWwoJHtlbGVtZW50LnZhcn0uc3JjLCAke2luaXR9KSkgJHttZXRob2R9KCR7ZWxlbWVudC52YXJ9LCBcIiR7bmFtZX1cIiwgJHt0aGlzLmxhc3R9KTtgKTtcbiAgICAgICAgICAgIHVwZGF0ZXIgPSBiIGAke21ldGhvZH0oJHtlbGVtZW50LnZhcn0sIFwiJHtuYW1lfVwiLCAke3Nob3VsZF9jYWNoZSA/IHRoaXMubGFzdCA6IHZhbHVlfSk7YDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwcm9wZXJ0eV9uYW1lKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaHlkcmF0ZS5wdXNoKGIgYCR7ZWxlbWVudC52YXJ9LiR7cHJvcGVydHlfbmFtZX0gPSAke2luaXR9O2ApO1xuICAgICAgICAgICAgdXBkYXRlciA9IGJsb2NrLnJlbmRlcmVyLm9wdGlvbnMuZGV2XG4gICAgICAgICAgICAgICAgPyBiIGBAcHJvcF9kZXYoJHtlbGVtZW50LnZhcn0sIFwiJHtwcm9wZXJ0eV9uYW1lfVwiLCAke3Nob3VsZF9jYWNoZSA/IHRoaXMubGFzdCA6IHZhbHVlfSk7YFxuICAgICAgICAgICAgICAgIDogYiBgJHtlbGVtZW50LnZhcn0uJHtwcm9wZXJ0eV9uYW1lfSA9ICR7c2hvdWxkX2NhY2hlID8gdGhpcy5sYXN0IDogdmFsdWV9O2A7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaHlkcmF0ZS5wdXNoKGIgYCR7bWV0aG9kfSgke2VsZW1lbnQudmFyfSwgXCIke25hbWV9XCIsICR7aW5pdH0pO2ApO1xuICAgICAgICAgICAgdXBkYXRlciA9IGIgYCR7bWV0aG9kfSgke2VsZW1lbnQudmFyfSwgXCIke25hbWV9XCIsICR7c2hvdWxkX2NhY2hlID8gdGhpcy5sYXN0IDogdmFsdWV9KTtgO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc19pbmRpcmVjdGx5X2JvdW5kX3ZhbHVlKSB7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVfdmFsdWUgPSBiIGAke2VsZW1lbnQudmFyfS52YWx1ZSA9ICR7ZWxlbWVudC52YXJ9Ll9fdmFsdWU7YDtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5oeWRyYXRlLnB1c2godXBkYXRlX3ZhbHVlKTtcbiAgICAgICAgICAgIHVwZGF0ZXIgPSBiIGBcblx0XHRcdFx0JHt1cGRhdGVyfVxuXHRcdFx0XHQke3VwZGF0ZV92YWx1ZX07XG5cdFx0XHRgO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZXBlbmRlbmNpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgY29uZGl0aW9uID0gdGhpcy5nZXRfZG9tX3VwZGF0ZV9jb25kaXRpb25zKGJsb2NrLCBibG9jay5yZW5kZXJlci5kaXJ0eShkZXBlbmRlbmNpZXMpKTtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0aWYgKCR7Y29uZGl0aW9ufSkge1xuXHRcdFx0XHRcdCR7dXBkYXRlcn1cblx0XHRcdFx0fWApO1xuICAgICAgICB9XG4gICAgICAgIC8vIHNwZWNpYWwgY2FzZSDigJMgYXV0b2ZvY3VzLiBoYXMgdG8gYmUgaGFuZGxlZCBpbiBhIGJpdCBvZiBhIHdlaXJkIHdheVxuICAgICAgICBpZiAobmFtZSA9PT0gJ2F1dG9mb2N1cycpIHtcbiAgICAgICAgICAgIGJsb2NrLmF1dG9mb2N1cyA9IHtcbiAgICAgICAgICAgICAgICBlbGVtZW50X3ZhcjogZWxlbWVudC52YXIsXG4gICAgICAgICAgICAgICAgY29uZGl0aW9uX2V4cHJlc3Npb246IHRoaXMubm9kZS5pc190cnVlID8gdW5kZWZpbmVkIDogdmFsdWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0X2luaXQoYmxvY2ssIHZhbHVlKSB7XG4gICAgICAgIHRoaXMubGFzdCA9IHRoaXMuc2hvdWxkX2NhY2hlICYmIGJsb2NrLmdldF91bmlxdWVfbmFtZShgJHt0aGlzLnBhcmVudC52YXIubmFtZX1fJHt0aGlzLm5hbWUucmVwbGFjZShyZWdleF9pbnZhbGlkX3ZhcmlhYmxlX2lkZW50aWZpZXJfY2hhcmFjdGVycyQxLCAnXycpfV92YWx1ZWApO1xuICAgICAgICBpZiAodGhpcy5zaG91bGRfY2FjaGUpXG4gICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUodGhpcy5sYXN0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2hvdWxkX2NhY2hlID8geCBgJHt0aGlzLmxhc3R9ID0gJHt2YWx1ZX1gIDogdmFsdWU7XG4gICAgfVxuICAgIGdldF9kb21fdXBkYXRlX2NvbmRpdGlvbnMoYmxvY2ssIGRlcGVuZGVuY3lfY29uZGl0aW9uKSB7XG4gICAgICAgIGNvbnN0IHsgcHJvcGVydHlfbmFtZSwgc2hvdWxkX2NhY2hlLCBsYXN0IH0gPSB0aGlzO1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5nZXRfdmFsdWUoYmxvY2spO1xuICAgICAgICBsZXQgY29uZGl0aW9uID0gZGVwZW5kZW5jeV9jb25kaXRpb247XG4gICAgICAgIGlmIChzaG91bGRfY2FjaGUpIHtcbiAgICAgICAgICAgIGNvbmRpdGlvbiA9IHRoaXMuaXNfc3JjXG4gICAgICAgICAgICAgICAgPyB4IGAke2NvbmRpdGlvbn0gJiYgKCFAc3JjX3VybF9lcXVhbCgke2VsZW1lbnQudmFyfS5zcmMsICgke2xhc3R9ID0gJHt2YWx1ZX0pKSlgXG4gICAgICAgICAgICAgICAgOiB4IGAke2NvbmRpdGlvbn0gJiYgKCR7bGFzdH0gIT09ICgke2xhc3R9ID0gJHt2YWx1ZX0pKWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNfaW5wdXRfdmFsdWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBlbGVtZW50Lm5vZGUuZ2V0X3N0YXRpY19hdHRyaWJ1dGVfdmFsdWUoJ3R5cGUnKTtcbiAgICAgICAgICAgIGlmICh0eXBlICE9PSB0cnVlICYmICFub25fdGV4dGxpa2VfaW5wdXRfdHlwZXMuaGFzKHR5cGUpKSB7XG4gICAgICAgICAgICAgICAgY29uZGl0aW9uID0geCBgJHtjb25kaXRpb259ICYmICR7ZWxlbWVudC52YXJ9LiR7cHJvcGVydHlfbmFtZX0gIT09ICR7c2hvdWxkX2NhY2hlID8gbGFzdCA6IHZhbHVlfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJsb2NrLmhhc19vdXRyb3MpIHtcbiAgICAgICAgICAgIGNvbmRpdGlvbiA9IHggYCEjY3VycmVudCB8fCAke2NvbmRpdGlvbn1gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb25kaXRpb247XG4gICAgfVxuICAgIGdldF9kZXBlbmRlbmNpZXMoKSB7XG4gICAgICAgIGNvbnN0IG5vZGVfZGVwZW5kZW5jaWVzID0gdGhpcy5ub2RlLmdldF9kZXBlbmRlbmNpZXMoKTtcbiAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzID0gbmV3IFNldChub2RlX2RlcGVuZGVuY2llcyk7XG4gICAgICAgIG5vZGVfZGVwZW5kZW5jaWVzLmZvckVhY2goKHByb3ApID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZGlyZWN0X2RlcGVuZGVuY2llcyA9IHRoaXMucGFyZW50LnJlbmRlcmVyLmNvbXBvbmVudC5pbmRpcmVjdF9kZXBlbmRlbmNpZXMuZ2V0KHByb3ApO1xuICAgICAgICAgICAgaWYgKGluZGlyZWN0X2RlcGVuZGVuY2llcykge1xuICAgICAgICAgICAgICAgIGluZGlyZWN0X2RlcGVuZGVuY2llcy5mb3JFYWNoKGluZGlyZWN0X2RlcGVuZGVuY3kgPT4ge1xuICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbmNpZXMuYWRkKGluZGlyZWN0X2RlcGVuZGVuY3kpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oZGVwZW5kZW5jaWVzKTtcbiAgICB9XG4gICAgZ2V0X21ldGFkYXRhKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQubm9kZS5uYW1lc3BhY2UpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBhdHRyaWJ1dGVfbG9va3VwW3RoaXMubmFtZV07XG4gICAgICAgIGlmIChtZXRhZGF0YSAmJiBtZXRhZGF0YS5hcHBsaWVzX3RvICYmICFtZXRhZGF0YS5hcHBsaWVzX3RvLmluY2x1ZGVzKHRoaXMucGFyZW50Lm5vZGUubmFtZSkpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xuICAgIH1cbiAgICBnZXRfdmFsdWUoYmxvY2spIHtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5pc190cnVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tZXRhZGF0YSAmJiBib29sZWFuX2F0dHJpYnV0ZXMuaGFzKHRoaXMubWV0YWRhdGEucHJvcGVydHlfbmFtZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB4IGB0cnVlYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB4IGBcIlwiYDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ub2RlLmNodW5rcy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICByZXR1cm4geCBgXCJcImA7XG4gICAgICAgIC8vIFRPRE8gc29tZSBvZiB0aGlzIGNvZGUgaXMgcmVwZWF0ZWQgaW4gVGFnLnRzIOKAlCB3b3VsZCBiZSBnb29kIHRvXG4gICAgICAgIC8vIERSWSBpdCBvdXQgaWYgdGhhdCdzIHBvc3NpYmxlIHdpdGhvdXQgaW50cm9kdWNpbmcgY3JhenkgaW5kaXJlY3Rpb25cbiAgICAgICAgaWYgKHRoaXMubm9kZS5jaHVua3MubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ub2RlLmNodW5rc1swXS50eXBlID09PSAnVGV4dCdcbiAgICAgICAgICAgICAgICA/IHN0cmluZ19saXRlcmFsKHRoaXMubm9kZS5jaHVua3NbMF0uZGF0YSlcbiAgICAgICAgICAgICAgICA6IHRoaXMubm9kZS5jaHVua3NbMF0ubWFuaXB1bGF0ZShibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHZhbHVlID0gdGhpcy5ub2RlLm5hbWUgPT09ICdjbGFzcydcbiAgICAgICAgICAgID8gdGhpcy5nZXRfY2xhc3NfbmFtZV90ZXh0KGJsb2NrKVxuICAgICAgICAgICAgOiB0aGlzLnJlbmRlcl9jaHVua3MoYmxvY2spLnJlZHVjZSgobGhzLCByaHMpID0+IHggYCR7bGhzfSArICR7cmhzfWApO1xuICAgICAgICAvLyAne2Zvb30ge2Jhcn0nIOKAlCB0cmVhdCBhcyBzdHJpbmcgY29uY2F0ZW5hdGlvblxuICAgICAgICBpZiAodGhpcy5ub2RlLmNodW5rc1swXS50eXBlICE9PSAnVGV4dCcpIHtcbiAgICAgICAgICAgIHZhbHVlID0geCBgXCJcIiArICR7dmFsdWV9YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGdldF9jbGFzc19uYW1lX3RleHQoYmxvY2spIHtcbiAgICAgICAgY29uc3Qgc2NvcGVkX2NzcyA9IHRoaXMubm9kZS5jaHVua3Muc29tZSgoY2h1bmspID0+IGNodW5rLnN5bnRoZXRpYyk7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVkID0gdGhpcy5yZW5kZXJfY2h1bmtzKGJsb2NrKTtcbiAgICAgICAgaWYgKHNjb3BlZF9jc3MgJiYgcmVuZGVyZWQubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAvLyB3ZSBoYXZlIGEgc2l0dWF0aW9uIGxpa2UgY2xhc3M9e3Bvc3NpYmx5VW5kZWZpbmVkfVxuICAgICAgICAgICAgcmVuZGVyZWRbMF0gPSB4IGBAbnVsbF90b19lbXB0eSgke3JlbmRlcmVkWzBdfSlgO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZW5kZXJlZC5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30gKyAke3Joc31gKTtcbiAgICB9XG4gICAgcmVuZGVyX2NodW5rcyhibG9jaykge1xuICAgICAgICByZXR1cm4gdGhpcy5ub2RlLmNodW5rcy5tYXAoKGNodW5rKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2h1bmsudHlwZSA9PT0gJ1RleHQnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZ19saXRlcmFsKGNodW5rLmRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNodW5rLm1hbmlwdWxhdGUoYmxvY2spO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RyaW5naWZ5KCkge1xuICAgICAgICBpZiAodGhpcy5ub2RlLmlzX3RydWUpXG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5ub2RlLmNodW5rcztcbiAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiAnPVwiXCInO1xuICAgICAgICByZXR1cm4gYD1cIiR7dmFsdWUubWFwKGNodW5rID0+IHtcbiAgICAgICAgICAgIHJldHVybiBjaHVuay50eXBlID09PSAnVGV4dCdcbiAgICAgICAgICAgICAgICA/IGNodW5rLmRhdGEucmVwbGFjZShyZWdleF9kb3VibGVfcXVvdGVzLCAnXFxcXFwiJylcbiAgICAgICAgICAgICAgICA6IGBcXCR7JHtjaHVuay5tYW5pcHVsYXRlKCl9fWA7XG4gICAgICAgIH0pLmpvaW4oJycpfVwiYDtcbiAgICB9XG59XG4vLyBzb3VyY2U6IGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2luZGljZXMuaHRtbFxuY29uc3QgYXR0cmlidXRlX2xvb2t1cCA9IHtcbiAgICBhbGxvd2Z1bGxzY3JlZW46IHsgcHJvcGVydHlfbmFtZTogJ2FsbG93RnVsbHNjcmVlbicsIGFwcGxpZXNfdG86IFsnaWZyYW1lJ10gfSxcbiAgICBhbGxvd3BheW1lbnRyZXF1ZXN0OiB7IHByb3BlcnR5X25hbWU6ICdhbGxvd1BheW1lbnRSZXF1ZXN0JywgYXBwbGllc190bzogWydpZnJhbWUnXSB9LFxuICAgIGFzeW5jOiB7IGFwcGxpZXNfdG86IFsnc2NyaXB0J10gfSxcbiAgICBhdXRvZm9jdXM6IHsgYXBwbGllc190bzogWydidXR0b24nLCAnaW5wdXQnLCAna2V5Z2VuJywgJ3NlbGVjdCcsICd0ZXh0YXJlYSddIH0sXG4gICAgYXV0b3BsYXk6IHsgYXBwbGllc190bzogWydhdWRpbycsICd2aWRlbyddIH0sXG4gICAgY2hlY2tlZDogeyBhcHBsaWVzX3RvOiBbJ2lucHV0J10gfSxcbiAgICBjb250cm9sczogeyBhcHBsaWVzX3RvOiBbJ2F1ZGlvJywgJ3ZpZGVvJ10gfSxcbiAgICBkZWZhdWx0OiB7IGFwcGxpZXNfdG86IFsndHJhY2snXSB9LFxuICAgIGRlZmVyOiB7IGFwcGxpZXNfdG86IFsnc2NyaXB0J10gfSxcbiAgICBkaXNhYmxlZDoge1xuICAgICAgICBhcHBsaWVzX3RvOiBbXG4gICAgICAgICAgICAnYnV0dG9uJyxcbiAgICAgICAgICAgICdmaWVsZHNldCcsXG4gICAgICAgICAgICAnaW5wdXQnLFxuICAgICAgICAgICAgJ2tleWdlbicsXG4gICAgICAgICAgICAnb3B0Z3JvdXAnLFxuICAgICAgICAgICAgJ29wdGlvbicsXG4gICAgICAgICAgICAnc2VsZWN0JyxcbiAgICAgICAgICAgICd0ZXh0YXJlYSdcbiAgICAgICAgXVxuICAgIH0sXG4gICAgZm9ybW5vdmFsaWRhdGU6IHsgcHJvcGVydHlfbmFtZTogJ2Zvcm1Ob1ZhbGlkYXRlJywgYXBwbGllc190bzogWydidXR0b24nLCAnaW5wdXQnXSB9LFxuICAgIGhpZGRlbjoge30sXG4gICAgaW5kZXRlcm1pbmF0ZTogeyBhcHBsaWVzX3RvOiBbJ2lucHV0J10gfSxcbiAgICBpc21hcDogeyBwcm9wZXJ0eV9uYW1lOiAnaXNNYXAnLCBhcHBsaWVzX3RvOiBbJ2ltZyddIH0sXG4gICAgbG9vcDogeyBhcHBsaWVzX3RvOiBbJ2F1ZGlvJywgJ2Jnc291bmQnLCAndmlkZW8nXSB9LFxuICAgIG11bHRpcGxlOiB7IGFwcGxpZXNfdG86IFsnaW5wdXQnLCAnc2VsZWN0J10gfSxcbiAgICBtdXRlZDogeyBhcHBsaWVzX3RvOiBbJ2F1ZGlvJywgJ3ZpZGVvJ10gfSxcbiAgICBub21vZHVsZTogeyBwcm9wZXJ0eV9uYW1lOiAnbm9Nb2R1bGUnLCBhcHBsaWVzX3RvOiBbJ3NjcmlwdCddIH0sXG4gICAgbm92YWxpZGF0ZTogeyBwcm9wZXJ0eV9uYW1lOiAnbm9WYWxpZGF0ZScsIGFwcGxpZXNfdG86IFsnZm9ybSddIH0sXG4gICAgb3BlbjogeyBhcHBsaWVzX3RvOiBbJ2RldGFpbHMnLCAnZGlhbG9nJ10gfSxcbiAgICBwbGF5c2lubGluZTogeyBwcm9wZXJ0eV9uYW1lOiAncGxheXNJbmxpbmUnLCBhcHBsaWVzX3RvOiBbJ3ZpZGVvJ10gfSxcbiAgICByZWFkb25seTogeyBwcm9wZXJ0eV9uYW1lOiAncmVhZE9ubHknLCBhcHBsaWVzX3RvOiBbJ2lucHV0JywgJ3RleHRhcmVhJ10gfSxcbiAgICByZXF1aXJlZDogeyBhcHBsaWVzX3RvOiBbJ2lucHV0JywgJ3NlbGVjdCcsICd0ZXh0YXJlYSddIH0sXG4gICAgcmV2ZXJzZWQ6IHsgYXBwbGllc190bzogWydvbCddIH0sXG4gICAgc2VsZWN0ZWQ6IHsgYXBwbGllc190bzogWydvcHRpb24nXSB9LFxuICAgIHZhbHVlOiB7XG4gICAgICAgIGFwcGxpZXNfdG86IFtcbiAgICAgICAgICAgICdidXR0b24nLFxuICAgICAgICAgICAgJ29wdGlvbicsXG4gICAgICAgICAgICAnaW5wdXQnLFxuICAgICAgICAgICAgJ2xpJyxcbiAgICAgICAgICAgICdtZXRlcicsXG4gICAgICAgICAgICAncHJvZ3Jlc3MnLFxuICAgICAgICAgICAgJ3BhcmFtJyxcbiAgICAgICAgICAgICdzZWxlY3QnLFxuICAgICAgICAgICAgJ3RleHRhcmVhJ1xuICAgICAgICBdXG4gICAgfVxufTtcbk9iamVjdC5rZXlzKGF0dHJpYnV0ZV9sb29rdXApLmZvckVhY2gobmFtZSA9PiB7XG4gICAgY29uc3QgbWV0YWRhdGEgPSBhdHRyaWJ1dGVfbG9va3VwW25hbWVdO1xuICAgIGlmICghbWV0YWRhdGEucHJvcGVydHlfbmFtZSlcbiAgICAgICAgbWV0YWRhdGEucHJvcGVydHlfbmFtZSA9IG5hbWU7XG59KTtcbmZ1bmN0aW9uIHNob3VsZF9jYWNoZShhdHRyaWJ1dGUpIHtcbiAgICByZXR1cm4gYXR0cmlidXRlLmlzX3NyYyB8fCBhdHRyaWJ1dGUubm9kZS5zaG91bGRfY2FjaGUoKTtcbn1cbmNvbnN0IHJlZ2V4X2NvbnRhaW5zX2NoZWNrZWRfb3JfZ3JvdXAgPSAvY2hlY2tlZHxncm91cC87XG5mdW5jdGlvbiBpc19pbmRpcmVjdGx5X2JvdW5kX3ZhbHVlKGF0dHJpYnV0ZSkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBhdHRyaWJ1dGUucGFyZW50O1xuICAgIHJldHVybiBhdHRyaWJ1dGUubmFtZSA9PT0gJ3ZhbHVlJyAmJlxuICAgICAgICAoZWxlbWVudC5ub2RlLm5hbWUgPT09ICdvcHRpb24nIHx8IC8vIFRPRE8gY2hlY2sgaXQncyBhY3R1YWxseSBib3VuZFxuICAgICAgICAgICAgKGVsZW1lbnQubm9kZS5uYW1lID09PSAnaW5wdXQnICYmXG4gICAgICAgICAgICAgICAgZWxlbWVudC5ub2RlLmJpbmRpbmdzLnNvbWUoKGJpbmRpbmcpID0+IHJlZ2V4X2NvbnRhaW5zX2NoZWNrZWRfb3JfZ3JvdXAudGVzdChiaW5kaW5nLm5hbWUpKSkpO1xufVxuXG5jbGFzcyBTdHlsZUF0dHJpYnV0ZVdyYXBwZXIgZXh0ZW5kcyBBdHRyaWJ1dGVXcmFwcGVyIHtcbiAgICByZW5kZXIoYmxvY2spIHtcbiAgICAgICAgY29uc3Qgc3R5bGVfcHJvcHMgPSBvcHRpbWl6ZV9zdHlsZSh0aGlzLm5vZGUuY2h1bmtzKTtcbiAgICAgICAgaWYgKCFzdHlsZV9wcm9wcylcbiAgICAgICAgICAgIHJldHVybiBzdXBlci5yZW5kZXIoYmxvY2spO1xuICAgICAgICBzdHlsZV9wcm9wcy5mb3JFYWNoKChwcm9wKSA9PiB7XG4gICAgICAgICAgICBsZXQgdmFsdWU7XG4gICAgICAgICAgICBpZiAoaXNfZHluYW1pYyQxKHByb3AudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvcF9kZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBwcm9wLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoY2h1bmsgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2h1bmsudHlwZSA9PT0gJ1RleHQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nX2xpdGVyYWwoY2h1bmsuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRfdG9fc2V0KHByb3BfZGVwZW5kZW5jaWVzLCBjaHVuay5keW5hbWljX2RlcGVuZGVuY2llcygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaHVuay5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30gKyAke3Joc31gKTtcbiAgICAgICAgICAgICAgICAvLyBUT0RPIGlzIHRoaXMgbmVjZXNzYXJ5PyBzdHlsZS5zZXRQcm9wZXJ0eSBhbHdheXMgdHJlYXRzIHZhbHVlIGFzIHN0cmluZywgbm8/XG4gICAgICAgICAgICAgICAgLy8gaWYgKHByb3AudmFsdWUubGVuZ3RoID09PSAxIHx8IHByb3AudmFsdWVbMF0udHlwZSAhPT0gJ1RleHQnKSB7XG4gICAgICAgICAgICAgICAgLy8gXHR2YWx1ZSA9IHhgXCJcIiArICR7dmFsdWV9YDtcbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgaWYgKHByb3BfZGVwZW5kZW5jaWVzLnNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbmRpdGlvbiA9IGJsb2NrLnJlbmRlcmVyLmRpcnR5KEFycmF5LmZyb20ocHJvcF9kZXBlbmRlbmNpZXMpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJsb2NrLmhhc19vdXRyb3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbiA9IHggYCEjY3VycmVudCB8fCAke2NvbmRpdGlvbn1gO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZSA9IGIgYFxuXHRcdFx0XHRcdFx0aWYgKCR7Y29uZGl0aW9ufSkge1xuXHRcdFx0XHRcdFx0XHRAc2V0X3N0eWxlKCR7dGhpcy5wYXJlbnQudmFyfSwgXCIke3Byb3Aua2V5fVwiLCAke3ZhbHVlfSwgJHtwcm9wLmltcG9ydGFudCA/IDEgOiBudWxsfSk7XG5cdFx0XHRcdFx0XHR9YDtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKHVwZGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBzdHJpbmdfbGl0ZXJhbChwcm9wLnZhbHVlWzBdLmRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmh5ZHJhdGUucHVzaChiIGBAc2V0X3N0eWxlKCR7dGhpcy5wYXJlbnQudmFyfSwgXCIke3Byb3Aua2V5fVwiLCAke3ZhbHVlfSwgJHtwcm9wLmltcG9ydGFudCA/IDEgOiBudWxsfSk7YCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmNvbnN0IHJlZ2V4X3N0eWxlX3Byb3Bfa2V5ID0gL15cXHMqKFtcXHctXSspOlxccyovO1xuZnVuY3Rpb24gb3B0aW1pemVfc3R5bGUodmFsdWUpIHtcbiAgICBjb25zdCBwcm9wcyA9IFtdO1xuICAgIGxldCBjaHVua3MgPSB2YWx1ZS5zbGljZSgpO1xuICAgIHdoaWxlIChjaHVua3MubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGNodW5rID0gY2h1bmtzWzBdO1xuICAgICAgICBpZiAoY2h1bmsudHlwZSAhPT0gJ1RleHQnKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IGtleV9tYXRjaCA9IHJlZ2V4X3N0eWxlX3Byb3Bfa2V5LmV4ZWMoY2h1bmsuZGF0YSk7XG4gICAgICAgIGlmICgha2V5X21hdGNoKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IGtleSA9IGtleV9tYXRjaFsxXTtcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0ga2V5X21hdGNoLmluZGV4ICsga2V5X21hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgY29uc3QgcmVtYWluaW5nX2RhdGEgPSBjaHVuay5kYXRhLnNsaWNlKG9mZnNldCk7XG4gICAgICAgIGlmIChyZW1haW5pbmdfZGF0YSkge1xuICAgICAgICAgICAgY2h1bmtzWzBdID0ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBjaHVuay5zdGFydCArIG9mZnNldCxcbiAgICAgICAgICAgICAgICBlbmQ6IGNodW5rLmVuZCxcbiAgICAgICAgICAgICAgICB0eXBlOiAnVGV4dCcsXG4gICAgICAgICAgICAgICAgZGF0YTogcmVtYWluaW5nX2RhdGFcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjaHVua3Muc2hpZnQoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXN1bHQgPSBnZXRfc3R5bGVfdmFsdWUoY2h1bmtzKTtcbiAgICAgICAgcHJvcHMucHVzaCh7IGtleSwgdmFsdWU6IHJlc3VsdC52YWx1ZSwgaW1wb3J0YW50OiByZXN1bHQuaW1wb3J0YW50IH0pO1xuICAgICAgICBjaHVua3MgPSByZXN1bHQuY2h1bmtzO1xuICAgIH1cbiAgICByZXR1cm4gcHJvcHM7XG59XG5jb25zdCByZWdleF9pbXBvcnRhbnRfZmxhZyA9IC9cXHMqIWltcG9ydGFudFxccyokLztcbmNvbnN0IHJlZ2V4X3NlbWljb2xvbl9vcl93aGl0ZXNwYWNlID0gL1s7XFxzXS87XG5mdW5jdGlvbiBnZXRfc3R5bGVfdmFsdWUoY2h1bmtzKSB7XG4gICAgY29uc3QgdmFsdWUgPSBbXTtcbiAgICBsZXQgaW5fdXJsID0gZmFsc2U7XG4gICAgbGV0IHF1b3RlX21hcmsgPSBudWxsO1xuICAgIGxldCBlc2NhcGVkID0gZmFsc2U7XG4gICAgbGV0IGNsb3NlZCA9IGZhbHNlO1xuICAgIHdoaWxlIChjaHVua3MubGVuZ3RoICYmICFjbG9zZWQpIHtcbiAgICAgICAgY29uc3QgY2h1bmsgPSBjaHVua3Muc2hpZnQoKTtcbiAgICAgICAgaWYgKGNodW5rLnR5cGUgPT09ICdUZXh0Jykge1xuICAgICAgICAgICAgbGV0IGMgPSAwO1xuICAgICAgICAgICAgd2hpbGUgKGMgPCBjaHVuay5kYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgPSBjaHVuay5kYXRhW2NdO1xuICAgICAgICAgICAgICAgIGlmIChlc2NhcGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGVzY2FwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hhciA9PT0gJ1xcXFwnKSB7XG4gICAgICAgICAgICAgICAgICAgIGVzY2FwZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyID09PSBxdW90ZV9tYXJrKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1b3RlX21hcmsgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyID09PSAnXCInIHx8IGNoYXIgPT09IFwiJ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1b3RlX21hcmsgPSBjaGFyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyID09PSAnKScgJiYgaW5fdXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIGluX3VybCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyID09PSAndScgJiYgY2h1bmsuZGF0YS5zbGljZShjLCBjICsgNCkgPT09ICd1cmwoJykge1xuICAgICAgICAgICAgICAgICAgICBpbl91cmwgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyID09PSAnOycgJiYgIWluX3VybCAmJiAhcXVvdGVfbWFyaykge1xuICAgICAgICAgICAgICAgICAgICBjbG9zZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYyArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGMgPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdUZXh0JyxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGNodW5rLnN0YXJ0LFxuICAgICAgICAgICAgICAgICAgICBlbmQ6IGNodW5rLnN0YXJ0ICsgYyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogY2h1bmsuZGF0YS5zbGljZSgwLCBjKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKHJlZ2V4X3NlbWljb2xvbl9vcl93aGl0ZXNwYWNlLnRlc3QoY2h1bmsuZGF0YVtjXSkpXG4gICAgICAgICAgICAgICAgYyArPSAxO1xuICAgICAgICAgICAgY29uc3QgcmVtYWluaW5nX2RhdGEgPSBjaHVuay5kYXRhLnNsaWNlKGMpO1xuICAgICAgICAgICAgaWYgKHJlbWFpbmluZ19kYXRhKSB7XG4gICAgICAgICAgICAgICAgY2h1bmtzLnVuc2hpZnQoe1xuICAgICAgICAgICAgICAgICAgICBzdGFydDogY2h1bmsuc3RhcnQgKyBjLFxuICAgICAgICAgICAgICAgICAgICBlbmQ6IGNodW5rLmVuZCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1RleHQnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiByZW1haW5pbmdfZGF0YVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUucHVzaChjaHVuayk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGltcG9ydGFudCA9IGZhbHNlO1xuICAgIGNvbnN0IGxhc3RfY2h1bmsgPSB2YWx1ZVt2YWx1ZS5sZW5ndGggLSAxXTtcbiAgICBpZiAobGFzdF9jaHVuayAmJiBsYXN0X2NodW5rLnR5cGUgPT09ICdUZXh0JyAmJiByZWdleF9pbXBvcnRhbnRfZmxhZy50ZXN0KGxhc3RfY2h1bmsuZGF0YSkpIHtcbiAgICAgICAgaW1wb3J0YW50ID0gdHJ1ZTtcbiAgICAgICAgbGFzdF9jaHVuay5kYXRhID0gbGFzdF9jaHVuay5kYXRhLnJlcGxhY2UocmVnZXhfaW1wb3J0YW50X2ZsYWcsICcnKTtcbiAgICAgICAgaWYgKCFsYXN0X2NodW5rLmRhdGEpXG4gICAgICAgICAgICB2YWx1ZS5wb3AoKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY2h1bmtzLFxuICAgICAgICB2YWx1ZSxcbiAgICAgICAgaW1wb3J0YW50XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGlzX2R5bmFtaWMkMSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZS5sZW5ndGggPiAxIHx8IHZhbHVlWzBdLnR5cGUgIT09ICdUZXh0Jztcbn1cblxuY2xhc3MgU3ByZWFkQXR0cmlidXRlV3JhcHBlciBleHRlbmRzIEJhc2VBdHRyaWJ1dGVXcmFwcGVyIHtcbn1cblxuZnVuY3Rpb24gbWFya19lYWNoX2Jsb2NrX2JpbmRpbmdzKHBhcmVudCwgYmluZGluZykge1xuICAgIC8vIHdlIG5lZWQgdG8gZW5zdXJlIHRoYXQgdGhlIGVhY2ggYmxvY2sgY3JlYXRlcyBhIGNvbnRleHQgaW5jbHVkaW5nXG4gICAgLy8gdGhlIGxpc3QgYW5kIHRoZSBpbmRleCwgaWYgdGhleSdyZSBub3Qgb3RoZXJ3aXNlIHJlZmVyZW5jZWRcbiAgICBiaW5kaW5nLmV4cHJlc3Npb24ucmVmZXJlbmNlcy5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICBjb25zdCBlYWNoX2Jsb2NrID0gcGFyZW50Lm5vZGUuc2NvcGUuZ2V0X293bmVyKG5hbWUpO1xuICAgICAgICBpZiAoZWFjaF9ibG9jaykge1xuICAgICAgICAgICAgZWFjaF9ibG9jay5oYXNfYmluZGluZyA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoYmluZGluZy5uYW1lID09PSAnZ3JvdXAnKSB7XG4gICAgICAgIGNvbnN0IGFkZF9pbmRleF9iaW5kaW5nID0gKG5hbWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVhY2hfYmxvY2sgPSBwYXJlbnQubm9kZS5zY29wZS5nZXRfb3duZXIobmFtZSk7XG4gICAgICAgICAgICBpZiAoZWFjaF9ibG9jay50eXBlID09PSAnRWFjaEJsb2NrJykge1xuICAgICAgICAgICAgICAgIGVhY2hfYmxvY2suaGFzX2luZGV4X2JpbmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZGVwIG9mIGVhY2hfYmxvY2suZXhwcmVzc2lvbi5jb250ZXh0dWFsX2RlcGVuZGVuY2llcykge1xuICAgICAgICAgICAgICAgICAgICBhZGRfaW5kZXhfYmluZGluZyhkZXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gZm9yIGA8aW5wdXQgYmluZDpncm91cD17fSA+YCwgd2UgbWFrZSBzdXJlIHRoYXQgYWxsIHRoZSBlYWNoIGJsb2NrcyBjcmVhdGVzIGNvbnRleHQgd2l0aCBgaW5kZXhgXG4gICAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBiaW5kaW5nLmV4cHJlc3Npb24uY29udGV4dHVhbF9kZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgICAgIGFkZF9pbmRleF9iaW5kaW5nKG5hbWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5jbGFzcyBCaW5kaW5nV3JhcHBlciB7XG4gICAgY29uc3RydWN0b3IoYmxvY2ssIG5vZGUsIHBhcmVudCkge1xuICAgICAgICB0aGlzLm5vZGUgPSBub2RlO1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgY29uc3QgeyBkZXBlbmRlbmNpZXMgfSA9IHRoaXMubm9kZS5leHByZXNzaW9uO1xuICAgICAgICBibG9jay5hZGRfZGVwZW5kZW5jaWVzKGRlcGVuZGVuY2llcyk7XG4gICAgICAgIC8vIFRPRE8gZG9lcyB0aGlzIGFsc28gYXBwbHkgdG8gZS5nLiBgPGlucHV0IHR5cGU9J2NoZWNrYm94JyBiaW5kOmdyb3VwPSdmb28nPmA/XG4gICAgICAgIGhhbmRsZV9zZWxlY3RfdmFsdWVfYmluZGluZyh0aGlzLCBkZXBlbmRlbmNpZXMpO1xuICAgICAgICBpZiAobm9kZS5pc19jb250ZXh0dWFsKSB7XG4gICAgICAgICAgICBtYXJrX2VhY2hfYmxvY2tfYmluZGluZ3ModGhpcy5wYXJlbnQsIHRoaXMubm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vYmplY3QgPSBnZXRfb2JqZWN0KHRoaXMubm9kZS5leHByZXNzaW9uLm5vZGUpLm5hbWU7XG4gICAgICAgIC8vIHZpZXcgdG8gbW9kZWxcbiAgICAgICAgdGhpcy5oYW5kbGVyID0gZ2V0X2V2ZW50X2hhbmRsZXIodGhpcywgcGFyZW50LnJlbmRlcmVyLCBibG9jaywgdGhpcy5vYmplY3QsIHRoaXMubm9kZS5yYXdfZXhwcmVzc2lvbik7XG4gICAgICAgIHRoaXMuc25pcHBldCA9IHRoaXMubm9kZS5leHByZXNzaW9uLm1hbmlwdWxhdGUoYmxvY2spO1xuICAgICAgICB0aGlzLmlzX3JlYWRvbmx5ID0gdGhpcy5ub2RlLmlzX3JlYWRvbmx5O1xuICAgICAgICB0aGlzLm5lZWRzX2xvY2sgPSB0aGlzLm5vZGUubmFtZSA9PT0gJ2N1cnJlbnRUaW1lJzsgLy8gVE9ETyBvdGhlcnM/XG4gICAgfVxuICAgIGdldF9kZXBlbmRlbmNpZXMoKSB7XG4gICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IG5ldyBTZXQodGhpcy5ub2RlLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgdGhpcy5ub2RlLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzLmZvckVhY2goKHByb3ApID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZGlyZWN0X2RlcGVuZGVuY2llcyA9IHRoaXMucGFyZW50LnJlbmRlcmVyLmNvbXBvbmVudC5pbmRpcmVjdF9kZXBlbmRlbmNpZXMuZ2V0KHByb3ApO1xuICAgICAgICAgICAgaWYgKGluZGlyZWN0X2RlcGVuZGVuY2llcykge1xuICAgICAgICAgICAgICAgIGluZGlyZWN0X2RlcGVuZGVuY2llcy5mb3JFYWNoKGluZGlyZWN0X2RlcGVuZGVuY3kgPT4ge1xuICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbmNpZXMuYWRkKGluZGlyZWN0X2RlcGVuZGVuY3kpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRlcGVuZGVuY2llcztcbiAgICB9XG4gICAgZ2V0X3VwZGF0ZV9kZXBlbmRlbmNpZXMoKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHRoaXMub2JqZWN0O1xuICAgICAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIGlmICh0aGlzLm5vZGUuZXhwcmVzc2lvbi50ZW1wbGF0ZV9zY29wZS5uYW1lcy5oYXMob2JqZWN0KSkge1xuICAgICAgICAgICAgdGhpcy5ub2RlLmV4cHJlc3Npb24udGVtcGxhdGVfc2NvcGUuZGVwZW5kZW5jaWVzX2Zvcl9uYW1lXG4gICAgICAgICAgICAgICAgLmdldChvYmplY3QpXG4gICAgICAgICAgICAgICAgLmZvckVhY2goKG5hbWUpID0+IGRlcGVuZGVuY2llcy5hZGQobmFtZSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGVwZW5kZW5jaWVzLmFkZChvYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBTZXQoZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgZGVwZW5kZW5jaWVzLmZvckVhY2goKGRlcGVuZGVuY3kpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZGlyZWN0X2RlcGVuZGVuY2llcyA9IHRoaXMucGFyZW50LnJlbmRlcmVyLmNvbXBvbmVudC5pbmRpcmVjdF9kZXBlbmRlbmNpZXMuZ2V0KGRlcGVuZGVuY3kpO1xuICAgICAgICAgICAgaWYgKGluZGlyZWN0X2RlcGVuZGVuY2llcykge1xuICAgICAgICAgICAgICAgIGluZGlyZWN0X2RlcGVuZGVuY2llcy5mb3JFYWNoKGluZGlyZWN0X2RlcGVuZGVuY3kgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuYWRkKGluZGlyZWN0X2RlcGVuZGVuY3kpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaXNfcmVhZG9ubHlfbWVkaWFfYXR0cmlidXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ub2RlLmlzX3JlYWRvbmx5X21lZGlhX2F0dHJpYnV0ZSgpO1xuICAgIH1cbiAgICByZW5kZXIoYmxvY2ssIGxvY2spIHtcbiAgICAgICAgaWYgKHRoaXMuaXNfcmVhZG9ubHkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IHsgcGFyZW50IH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB1cGRhdGVfY29uZGl0aW9ucyA9IHRoaXMubmVlZHNfbG9jayA/IFt4IGAhJHtsb2NrfWBdIDogW107XG4gICAgICAgIGNvbnN0IG1vdW50X2NvbmRpdGlvbnMgPSBbXTtcbiAgICAgICAgY29uc3QgZGVwZW5kZW5jeV9hcnJheSA9IEFycmF5LmZyb20odGhpcy5nZXRfZGVwZW5kZW5jaWVzKCkpO1xuICAgICAgICBpZiAoZGVwZW5kZW5jeV9hcnJheS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB1cGRhdGVfY29uZGl0aW9ucy5wdXNoKGJsb2NrLnJlbmRlcmVyLmRpcnR5KGRlcGVuZGVuY3lfYXJyYXkpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyZW50Lm5vZGUubmFtZSA9PT0gJ2lucHV0Jykge1xuICAgICAgICAgICAgY29uc3QgdHlwZSA9IHBhcmVudC5ub2RlLmdldF9zdGF0aWNfYXR0cmlidXRlX3ZhbHVlKCd0eXBlJyk7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gbnVsbCB8fFxuICAgICAgICAgICAgICAgIHR5cGUgPT09ICcnIHx8XG4gICAgICAgICAgICAgICAgdHlwZSA9PT0gJ3RleHQnIHx8XG4gICAgICAgICAgICAgICAgdHlwZSA9PT0gJ2VtYWlsJyB8fFxuICAgICAgICAgICAgICAgIHR5cGUgPT09ICdwYXNzd29yZCcpIHtcbiAgICAgICAgICAgICAgICB1cGRhdGVfY29uZGl0aW9ucy5wdXNoKHggYCR7cGFyZW50LnZhcn0uJHt0aGlzLm5vZGUubmFtZX0gIT09ICR7dGhpcy5zbmlwcGV0fWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICB1cGRhdGVfY29uZGl0aW9ucy5wdXNoKHggYEB0b19udW1iZXIoJHtwYXJlbnQudmFyfS4ke3RoaXMubm9kZS5uYW1lfSkgIT09ICR7dGhpcy5zbmlwcGV0fWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIG1vZGVsIHRvIHZpZXdcbiAgICAgICAgbGV0IHVwZGF0ZV9kb20gPSBnZXRfZG9tX3VwZGF0ZXIocGFyZW50LCB0aGlzKTtcbiAgICAgICAgbGV0IG1vdW50X2RvbSA9IHVwZGF0ZV9kb207XG4gICAgICAgIC8vIHNwZWNpYWwgY2FzZXNcbiAgICAgICAgc3dpdGNoICh0aGlzLm5vZGUubmFtZSkge1xuICAgICAgICAgICAgY2FzZSAnZ3JvdXAnOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBiaW5kaW5nX2dyb3VwLCBpc19jb250ZXh0LCBjb250ZXh0cywgaW5kZXgsIGtleXBhdGggfSA9IGdldF9iaW5kaW5nX2dyb3VwKHBhcmVudC5yZW5kZXJlciwgdGhpcy5ub2RlLCBibG9jayk7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLnJlbmRlcmVyLmFkZF90b19jb250ZXh0KCckJGJpbmRpbmdfZ3JvdXBzJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc19jb250ZXh0ICYmICFibG9jay5iaW5kaW5nX2dyb3VwX2luaXRpYWxpc2VkLmhhcyhrZXlwYXRoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRleHRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYmluZGluZ19ncm91cCA9IHggYCR7YmxvY2sucmVuZGVyZXIucmVmZXJlbmNlKCckJGJpbmRpbmdfZ3JvdXBzJyl9WyR7aW5kZXh9XWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIGNvbnRleHRzLnNsaWNlKDAsIC0xKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaW5kaW5nX2dyb3VwID0geCBgJHtiaW5kaW5nX2dyb3VwfVske2Jsb2NrLnJlbmRlcmVyLnJlZmVyZW5jZShuYW1lKX1dYDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGAke2JpbmRpbmdfZ3JvdXB9ID0gJHtiaW5kaW5nX2dyb3VwfSB8fCBbXTtgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYCR7YmluZGluZ19ncm91cCh0cnVlKX0gPSBbXTtgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrLmJpbmRpbmdfZ3JvdXBfaW5pdGlhbGlzZWQuYWRkKGtleXBhdGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5oeWRyYXRlLnB1c2goYiBgJHtiaW5kaW5nX2dyb3VwKHRydWUpfS5wdXNoKCR7cGFyZW50LnZhcn0pO2ApO1xuICAgICAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuZGVzdHJveS5wdXNoKGIgYCR7YmluZGluZ19ncm91cCh0cnVlKX0uc3BsaWNlKCR7YmluZGluZ19ncm91cCh0cnVlKX0uaW5kZXhPZigke3BhcmVudC52YXJ9KSwgMSk7YCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ3RleHRDb250ZW50JzpcbiAgICAgICAgICAgICAgICB1cGRhdGVfY29uZGl0aW9ucy5wdXNoKHggYCR7dGhpcy5zbmlwcGV0fSAhPT0gJHtwYXJlbnQudmFyfS50ZXh0Q29udGVudGApO1xuICAgICAgICAgICAgICAgIG1vdW50X2NvbmRpdGlvbnMucHVzaCh4IGAke3RoaXMuc25pcHBldH0gIT09IHZvaWQgMGApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnaW5uZXJIVE1MJzpcbiAgICAgICAgICAgICAgICB1cGRhdGVfY29uZGl0aW9ucy5wdXNoKHggYCR7dGhpcy5zbmlwcGV0fSAhPT0gJHtwYXJlbnQudmFyfS5pbm5lckhUTUxgKTtcbiAgICAgICAgICAgICAgICBtb3VudF9jb25kaXRpb25zLnB1c2goeCBgJHt0aGlzLnNuaXBwZXR9ICE9PSB2b2lkIDBgKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2N1cnJlbnRUaW1lJzpcbiAgICAgICAgICAgICAgICB1cGRhdGVfY29uZGl0aW9ucy5wdXNoKHggYCFAX2lzTmFOKCR7dGhpcy5zbmlwcGV0fSlgKTtcbiAgICAgICAgICAgICAgICBtb3VudF9kb20gPSBudWxsO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncGxheWJhY2tSYXRlJzpcbiAgICAgICAgICAgIGNhc2UgJ3ZvbHVtZSc6XG4gICAgICAgICAgICAgICAgdXBkYXRlX2NvbmRpdGlvbnMucHVzaCh4IGAhQF9pc05hTigke3RoaXMuc25pcHBldH0pYCk7XG4gICAgICAgICAgICAgICAgbW91bnRfY29uZGl0aW9ucy5wdXNoKHggYCFAX2lzTmFOKCR7dGhpcy5zbmlwcGV0fSlgKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3BhdXNlZCc6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIG5lY2Vzc2FyeSB0byBwcmV2ZW50IGF1ZGlvIHJlc3RhcnRpbmcgYnkgaXRzZWxmXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxhc3QgPSBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7cGFyZW50LnZhci5uYW1lfV9pc19wYXVzZWRgKTtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKGxhc3QsIHggYHRydWVgKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlX2NvbmRpdGlvbnMucHVzaCh4IGAke2xhc3R9ICE9PSAoJHtsYXN0fSA9ICR7dGhpcy5zbmlwcGV0fSlgKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlX2RvbSA9IGIgYCR7cGFyZW50LnZhcn1bJHtsYXN0fSA/IFwicGF1c2VcIiA6IFwicGxheVwiXSgpO2A7XG4gICAgICAgICAgICAgICAgICAgIG1vdW50X2RvbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ3ZhbHVlJzpcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50Lm5vZGUuZ2V0X3N0YXRpY19hdHRyaWJ1dGVfdmFsdWUoJ3R5cGUnKSA9PT0gJ2ZpbGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZV9kb20gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBtb3VudF9kb20gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodXBkYXRlX2RvbSkge1xuICAgICAgICAgICAgaWYgKHVwZGF0ZV9jb25kaXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25kaXRpb24gPSB1cGRhdGVfY29uZGl0aW9ucy5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30gJiYgJHtyaHN9YCk7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRcdGlmICgke2NvbmRpdGlvbn0pIHtcblx0XHRcdFx0XHRcdCR7dXBkYXRlX2RvbX1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKHVwZGF0ZV9kb20pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChtb3VudF9kb20pIHtcbiAgICAgICAgICAgIGlmIChtb3VudF9jb25kaXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25kaXRpb24gPSBtb3VudF9jb25kaXRpb25zLnJlZHVjZSgobGhzLCByaHMpID0+IHggYCR7bGhzfSAmJiAke3Joc31gKTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGBcblx0XHRcdFx0XHRpZiAoJHtjb25kaXRpb259KSB7XG5cdFx0XHRcdFx0XHQke21vdW50X2RvbX1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2gobW91bnRfZG9tKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGdldF9kb21fdXBkYXRlcihlbGVtZW50LCBiaW5kaW5nKSB7XG4gICAgY29uc3QgeyBub2RlIH0gPSBlbGVtZW50O1xuICAgIGlmIChiaW5kaW5nLmlzX3JlYWRvbmx5X21lZGlhX2F0dHJpYnV0ZSgpKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpZiAoYmluZGluZy5ub2RlLm5hbWUgPT09ICd0aGlzJykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaWYgKG5vZGUubmFtZSA9PT0gJ3NlbGVjdCcpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUuZ2V0X3N0YXRpY19hdHRyaWJ1dGVfdmFsdWUoJ211bHRpcGxlJykgPT09IHRydWUgP1xuICAgICAgICAgICAgYiBgQHNlbGVjdF9vcHRpb25zKCR7ZWxlbWVudC52YXJ9LCAke2JpbmRpbmcuc25pcHBldH0pYCA6XG4gICAgICAgICAgICBiIGBAc2VsZWN0X29wdGlvbigke2VsZW1lbnQudmFyfSwgJHtiaW5kaW5nLnNuaXBwZXR9KWA7XG4gICAgfVxuICAgIGlmIChiaW5kaW5nLm5vZGUubmFtZSA9PT0gJ2dyb3VwJykge1xuICAgICAgICBjb25zdCB0eXBlID0gbm9kZS5nZXRfc3RhdGljX2F0dHJpYnV0ZV92YWx1ZSgndHlwZScpO1xuICAgICAgICBjb25zdCBjb25kaXRpb24gPSB0eXBlID09PSAnY2hlY2tib3gnXG4gICAgICAgICAgICA/IHggYH4ke2JpbmRpbmcuc25pcHBldH0uaW5kZXhPZigke2VsZW1lbnQudmFyfS5fX3ZhbHVlKWBcbiAgICAgICAgICAgIDogeCBgJHtlbGVtZW50LnZhcn0uX192YWx1ZSA9PT0gJHtiaW5kaW5nLnNuaXBwZXR9YDtcbiAgICAgICAgcmV0dXJuIGIgYCR7ZWxlbWVudC52YXJ9LmNoZWNrZWQgPSAke2NvbmRpdGlvbn07YDtcbiAgICB9XG4gICAgaWYgKGJpbmRpbmcubm9kZS5uYW1lID09PSAndmFsdWUnKSB7XG4gICAgICAgIHJldHVybiBiIGBAc2V0X2lucHV0X3ZhbHVlKCR7ZWxlbWVudC52YXJ9LCAke2JpbmRpbmcuc25pcHBldH0pO2A7XG4gICAgfVxuICAgIHJldHVybiBiIGAke2VsZW1lbnQudmFyfS4ke2JpbmRpbmcubm9kZS5uYW1lfSA9ICR7YmluZGluZy5zbmlwcGV0fTtgO1xufVxuZnVuY3Rpb24gZ2V0X2JpbmRpbmdfZ3JvdXAocmVuZGVyZXIsIHZhbHVlLCBibG9jaykge1xuICAgIGNvbnN0IHsgcGFydHMgfSA9IGZsYXR0ZW5fcmVmZXJlbmNlKHZhbHVlLnJhd19leHByZXNzaW9uKTtcbiAgICBsZXQga2V5cGF0aCA9IHBhcnRzLmpvaW4oJy4nKTtcbiAgICBjb25zdCBjb250ZXh0cyA9IFtdO1xuICAgIGNvbnN0IGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzID0gbmV3IFNldCgpO1xuICAgIGNvbnN0IHsgdGVtcGxhdGVfc2NvcGUgfSA9IHZhbHVlLmV4cHJlc3Npb247XG4gICAgY29uc3QgYWRkX2NvbnRleHR1YWxfZGVwZW5kZW5jeSA9IChkZXApID0+IHtcbiAgICAgICAgY29udGV4dHVhbF9kZXBlbmRlbmNpZXMuYWRkKGRlcCk7XG4gICAgICAgIGNvbnN0IG93bmVyID0gdGVtcGxhdGVfc2NvcGUuZ2V0X293bmVyKGRlcCk7XG4gICAgICAgIGlmIChvd25lci50eXBlID09PSAnRWFjaEJsb2NrJykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBkZXAgb2Ygb3duZXIuZXhwcmVzc2lvbi5jb250ZXh0dWFsX2RlcGVuZGVuY2llcykge1xuICAgICAgICAgICAgICAgIGFkZF9jb250ZXh0dWFsX2RlcGVuZGVuY3koZGVwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgZm9yIChjb25zdCBkZXAgb2YgdmFsdWUuZXhwcmVzc2lvbi5jb250ZXh0dWFsX2RlcGVuZGVuY2llcykge1xuICAgICAgICBhZGRfY29udGV4dHVhbF9kZXBlbmRlbmN5KGRlcCk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgZGVwIG9mIGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzKSB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBibG9jay5iaW5kaW5ncy5nZXQoZGVwKTtcbiAgICAgICAgbGV0IGtleTtcbiAgICAgICAgbGV0IG5hbWU7XG4gICAgICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgICAgICBrZXkgPSBjb250ZXh0Lm9iamVjdC5uYW1lO1xuICAgICAgICAgICAgbmFtZSA9IGNvbnRleHQucHJvcGVydHkubmFtZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGtleSA9IGRlcDtcbiAgICAgICAgICAgIG5hbWUgPSBkZXA7XG4gICAgICAgIH1cbiAgICAgICAga2V5cGF0aCA9IGAke2tleX1AJHtrZXlwYXRofWA7XG4gICAgICAgIGNvbnRleHRzLnB1c2gobmFtZSk7XG4gICAgfVxuICAgIGlmICghcmVuZGVyZXIuYmluZGluZ19ncm91cHMuaGFzKGtleXBhdGgpKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gcmVuZGVyZXIuYmluZGluZ19ncm91cHMuc2l6ZTtcbiAgICAgICAgY29udGV4dHMuZm9yRWFjaChjb250ZXh0ID0+IHtcbiAgICAgICAgICAgIHJlbmRlcmVyLmFkZF90b19jb250ZXh0KGNvbnRleHQsIHRydWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVuZGVyZXIuYmluZGluZ19ncm91cHMuc2V0KGtleXBhdGgsIHtcbiAgICAgICAgICAgIGJpbmRpbmdfZ3JvdXA6ICh0b19yZWZlcmVuY2UgPSBmYWxzZSkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBiaW5kaW5nX2dyb3VwID0gJyQkYmluZGluZ19ncm91cHMnO1xuICAgICAgICAgICAgICAgIGxldCBfc2Vjb25kYXJ5X2luZGV4ZXMgPSBjb250ZXh0cztcbiAgICAgICAgICAgICAgICBpZiAodG9fcmVmZXJlbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGJpbmRpbmdfZ3JvdXAgPSBibG9jay5yZW5kZXJlci5yZWZlcmVuY2UoYmluZGluZ19ncm91cCk7XG4gICAgICAgICAgICAgICAgICAgIF9zZWNvbmRhcnlfaW5kZXhlcyA9IF9zZWNvbmRhcnlfaW5kZXhlcy5tYXAobmFtZSA9PiBibG9jay5yZW5kZXJlci5yZWZlcmVuY2UobmFtZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoX3NlY29uZGFyeV9pbmRleGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG9iaiA9IHggYCR7YmluZGluZ19ncm91cH1bJHtpbmRleH1dYDtcbiAgICAgICAgICAgICAgICAgICAgX3NlY29uZGFyeV9pbmRleGVzLmZvckVhY2goc2Vjb25kYXJ5X2luZGV4ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iaiA9IHggYCR7b2JqfVske3NlY29uZGFyeV9pbmRleH1dYDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geCBgJHtiaW5kaW5nX2dyb3VwfVske2luZGV4fV1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpc19jb250ZXh0OiBjb250ZXh0cy5sZW5ndGggPiAwLFxuICAgICAgICAgICAgY29udGV4dHMsXG4gICAgICAgICAgICBpbmRleCxcbiAgICAgICAgICAgIGtleXBhdGhcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiByZW5kZXJlci5iaW5kaW5nX2dyb3Vwcy5nZXQoa2V5cGF0aCk7XG59XG5mdW5jdGlvbiBnZXRfZXZlbnRfaGFuZGxlcihiaW5kaW5nLCByZW5kZXJlciwgYmxvY2ssIG5hbWUsIGxocykge1xuICAgIGNvbnN0IGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzID0gbmV3IFNldChiaW5kaW5nLm5vZGUuZXhwcmVzc2lvbi5jb250ZXh0dWFsX2RlcGVuZGVuY2llcyk7XG4gICAgY29uc3QgY29udGV4dCA9IGJsb2NrLmJpbmRpbmdzLmdldChuYW1lKTtcbiAgICBsZXQgc2V0X3N0b3JlO1xuICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IHsgb2JqZWN0LCBwcm9wZXJ0eSwgc3RvcmUsIHNuaXBwZXQgfSA9IGNvbnRleHQ7XG4gICAgICAgIGxocyA9IHJlcGxhY2Vfb2JqZWN0KGxocywgc25pcHBldCk7XG4gICAgICAgIGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLmFkZChvYmplY3QubmFtZSk7XG4gICAgICAgIGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLmFkZChwcm9wZXJ0eS5uYW1lKTtcbiAgICAgICAgY29udGV4dHVhbF9kZXBlbmRlbmNpZXMuZGVsZXRlKG5hbWUpO1xuICAgICAgICBpZiAoc3RvcmUpIHtcbiAgICAgICAgICAgIHNldF9zdG9yZSA9IGIgYCR7c3RvcmV9LnNldCgke2AkJHtzdG9yZX1gfSk7YDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0gZ2V0X29iamVjdChsaHMpO1xuICAgICAgICBpZiAob2JqZWN0Lm5hbWVbMF0gPT09ICckJykge1xuICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSBvYmplY3QubmFtZS5zbGljZSgxKTtcbiAgICAgICAgICAgIHNldF9zdG9yZSA9IGIgYCR7c3RvcmV9LnNldCgke29iamVjdC5uYW1lfSk7YDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCB2YWx1ZSA9IGdldF92YWx1ZV9mcm9tX2RvbShyZW5kZXJlciwgYmluZGluZy5wYXJlbnQsIGJpbmRpbmcsIGJsb2NrLCBjb250ZXh0dWFsX2RlcGVuZGVuY2llcyk7XG4gICAgY29uc3QgbXV0YXRpb24gPSBiIGBcblx0XHQke2xoc30gPSAke3ZhbHVlfTtcblx0XHQke3NldF9zdG9yZX1cblx0YDtcbiAgICByZXR1cm4ge1xuICAgICAgICB1c2VzX2NvbnRleHQ6IGJpbmRpbmcubm9kZS5pc19jb250ZXh0dWFsIHx8IGJpbmRpbmcubm9kZS5leHByZXNzaW9uLnVzZXNfY29udGV4dCxcbiAgICAgICAgbXV0YXRpb24sXG4gICAgICAgIGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLFxuICAgICAgICBsaHNcbiAgICB9O1xufVxuZnVuY3Rpb24gZ2V0X3ZhbHVlX2Zyb21fZG9tKHJlbmRlcmVyLCBlbGVtZW50LCBiaW5kaW5nLCBibG9jaywgY29udGV4dHVhbF9kZXBlbmRlbmNpZXMpIHtcbiAgICBjb25zdCB7IG5vZGUgfSA9IGVsZW1lbnQ7XG4gICAgY29uc3QgeyBuYW1lIH0gPSBiaW5kaW5nLm5vZGU7XG4gICAgaWYgKG5hbWUgPT09ICd0aGlzJykge1xuICAgICAgICByZXR1cm4geCBgJCR2YWx1ZWA7XG4gICAgfVxuICAgIC8vIDxzZWxlY3QgYmluZDp2YWx1ZT0nc2VsZWN0ZWQ+XG4gICAgaWYgKG5vZGUubmFtZSA9PT0gJ3NlbGVjdCcpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUuZ2V0X3N0YXRpY19hdHRyaWJ1dGVfdmFsdWUoJ211bHRpcGxlJykgPT09IHRydWUgP1xuICAgICAgICAgICAgeCBgQHNlbGVjdF9tdWx0aXBsZV92YWx1ZSh0aGlzKWAgOlxuICAgICAgICAgICAgeCBgQHNlbGVjdF92YWx1ZSh0aGlzKWA7XG4gICAgfVxuICAgIGNvbnN0IHR5cGUgPSBub2RlLmdldF9zdGF0aWNfYXR0cmlidXRlX3ZhbHVlKCd0eXBlJyk7XG4gICAgLy8gPGlucHV0IHR5cGU9J2NoZWNrYm94JyBiaW5kOmdyb3VwPSdmb28nPlxuICAgIGlmIChuYW1lID09PSAnZ3JvdXAnKSB7XG4gICAgICAgIGlmICh0eXBlID09PSAnY2hlY2tib3gnKSB7XG4gICAgICAgICAgICBjb25zdCB7IGJpbmRpbmdfZ3JvdXAsIGNvbnRleHRzIH0gPSBnZXRfYmluZGluZ19ncm91cChyZW5kZXJlciwgYmluZGluZy5ub2RlLCBibG9jayk7XG4gICAgICAgICAgICBhZGRfdG9fc2V0KGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLCBjb250ZXh0cyk7XG4gICAgICAgICAgICByZXR1cm4geCBgQGdldF9iaW5kaW5nX2dyb3VwX3ZhbHVlKCR7YmluZGluZ19ncm91cCgpfSwgdGhpcy5fX3ZhbHVlLCB0aGlzLmNoZWNrZWQpYDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geCBgdGhpcy5fX3ZhbHVlYDtcbiAgICB9XG4gICAgLy8gPGlucHV0IHR5cGU9J3JhbmdlfG51bWJlcicgYmluZDp2YWx1ZT5cbiAgICBpZiAodHlwZSA9PT0gJ3JhbmdlJyB8fCB0eXBlID09PSAnbnVtYmVyJykge1xuICAgICAgICByZXR1cm4geCBgQHRvX251bWJlcih0aGlzLiR7bmFtZX0pYDtcbiAgICB9XG4gICAgaWYgKChuYW1lID09PSAnYnVmZmVyZWQnIHx8IG5hbWUgPT09ICdzZWVrYWJsZScgfHwgbmFtZSA9PT0gJ3BsYXllZCcpKSB7XG4gICAgICAgIHJldHVybiB4IGBAdGltZV9yYW5nZXNfdG9fYXJyYXkodGhpcy4ke25hbWV9KWA7XG4gICAgfVxuICAgIC8vIGV2ZXJ5dGhpbmcgZWxzZVxuICAgIHJldHVybiB4IGB0aGlzLiR7bmFtZX1gO1xufVxuXG5mdW5jdGlvbiBjb21wYXJlX25vZGUoYSwgYikge1xuICAgIGlmIChhID09PSBiKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICBpZiAoIWEgfHwgIWIpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBpZiAoYS50eXBlICE9PSBiLnR5cGUpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBzd2l0Y2ggKGEudHlwZSkge1xuICAgICAgICBjYXNlICdJZGVudGlmaWVyJzpcbiAgICAgICAgICAgIHJldHVybiBhLm5hbWUgPT09IGIubmFtZTtcbiAgICAgICAgY2FzZSAnTWVtYmVyRXhwcmVzc2lvbic6XG4gICAgICAgICAgICByZXR1cm4gKGNvbXBhcmVfbm9kZShhLm9iamVjdCwgYi5vYmplY3QpICYmXG4gICAgICAgICAgICAgICAgY29tcGFyZV9ub2RlKGEucHJvcGVydHksIGIucHJvcGVydHkpICYmXG4gICAgICAgICAgICAgICAgYS5jb21wdXRlZCA9PT0gYi5jb21wdXRlZCk7XG4gICAgICAgIGNhc2UgJ0xpdGVyYWwnOlxuICAgICAgICAgICAgcmV0dXJuIGEudmFsdWUgPT09IGIudmFsdWU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBiaW5kX3RoaXMoY29tcG9uZW50LCBibG9jaywgYmluZGluZywgdmFyaWFibGUpIHtcbiAgICBjb25zdCBmbiA9IGNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoYCR7dmFyaWFibGUubmFtZX1fYmluZGluZ2ApO1xuICAgIGJsb2NrLnJlbmRlcmVyLmFkZF90b19jb250ZXh0KGZuLm5hbWUpO1xuICAgIGNvbnN0IGNhbGxlZSA9IGJsb2NrLnJlbmRlcmVyLnJlZmVyZW5jZShmbi5uYW1lKTtcbiAgICBjb25zdCB7IGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLCBtdXRhdGlvbiB9ID0gYmluZGluZy5oYW5kbGVyO1xuICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IGJpbmRpbmcuZ2V0X3VwZGF0ZV9kZXBlbmRlbmNpZXMoKTtcbiAgICBjb25zdCBib2R5ID0gYiBgXG5cdFx0JHttdXRhdGlvbn1cblx0XHQke0FycmF5LmZyb20oZGVwZW5kZW5jaWVzKVxuICAgICAgICAuZmlsdGVyKGRlcCA9PiBkZXBbMF0gIT09ICckJylcbiAgICAgICAgLmZpbHRlcihkZXAgPT4gIWNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLmhhcyhkZXApKVxuICAgICAgICAubWFwKGRlcCA9PiBiIGAke2Jsb2NrLnJlbmRlcmVyLmludmFsaWRhdGUoZGVwKX07YCl9XG5cdGA7XG4gICAgaWYgKGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLnNpemUpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gQXJyYXkuZnJvbShjb250ZXh0dWFsX2RlcGVuZGVuY2llcykubWFwKG5hbWUgPT4gKHtcbiAgICAgICAgICAgIHR5cGU6ICdJZGVudGlmaWVyJyxcbiAgICAgICAgICAgIG5hbWVcbiAgICAgICAgfSkpO1xuICAgICAgICBjb21wb25lbnQucGFydGx5X2hvaXN0ZWQucHVzaChiIGBcblx0XHRcdGZ1bmN0aW9uICR7Zm59KCQkdmFsdWUsICR7cGFyYW1zfSkge1xuXHRcdFx0XHRAYmluZGluZ19jYWxsYmFja3NbJCR2YWx1ZSA/ICd1bnNoaWZ0JyA6ICdwdXNoJ10oKCkgPT4ge1xuXHRcdFx0XHRcdCR7Ym9keX1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0YCk7XG4gICAgICAgIGNvbnN0IGFsaWFzX21hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgY29uc3QgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpZCBvZiBwYXJhbXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYmxvY2sucmVuZGVyZXIucmVmZXJlbmNlKGlkLm5hbWUpO1xuICAgICAgICAgICAgbGV0IGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoYmxvY2sudmFyaWFibGVzLmhhcyhpZC5uYW1lKSkge1xuICAgICAgICAgICAgICAgIGxldCBhbGlhcyA9IGlkLm5hbWU7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGJsb2NrLnZhcmlhYmxlcy5oYXMoYWxpYXMpICYmICFjb21wYXJlX25vZGUoYmxvY2sudmFyaWFibGVzLmdldChhbGlhcykuaW5pdCwgdmFsdWUpOyBhbGlhcyA9IGAke2lkLm5hbWV9XyR7aSsrfWApXG4gICAgICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgICAgICBhbGlhc19tYXAuc2V0KGFsaWFzLCBpZC5uYW1lKTtcbiAgICAgICAgICAgICAgICBpZCA9IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiBhbGlhcyB9O1xuICAgICAgICAgICAgICAgIGZvdW5kID0gYmxvY2sudmFyaWFibGVzLmhhcyhhbGlhcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhcmdzLnB1c2goaWQpO1xuICAgICAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShpZCwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFzc2lnbiA9IGJsb2NrLmdldF91bmlxdWVfbmFtZShgYXNzaWduXyR7dmFyaWFibGUubmFtZX1gKTtcbiAgICAgICAgY29uc3QgdW5hc3NpZ24gPSBibG9jay5nZXRfdW5pcXVlX25hbWUoYHVuYXNzaWduXyR7dmFyaWFibGUubmFtZX1gKTtcbiAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdGNvbnN0ICR7YXNzaWdufSA9ICgpID0+ICR7Y2FsbGVlfSgke3ZhcmlhYmxlfSwgJHthcmdzfSk7XG5cdFx0XHRjb25zdCAke3VuYXNzaWdufSA9ICgpID0+ICR7Y2FsbGVlfShudWxsLCAke2FyZ3N9KTtcblx0XHRgKTtcbiAgICAgICAgY29uc3QgY29uZGl0aW9uID0gQXJyYXkuZnJvbShhcmdzKVxuICAgICAgICAgICAgLm1hcChuYW1lID0+IHggYCR7bmFtZX0gIT09ICR7YmxvY2sucmVuZGVyZXIucmVmZXJlbmNlKGFsaWFzX21hcC5nZXQobmFtZS5uYW1lKSB8fCBuYW1lLm5hbWUpfWApXG4gICAgICAgICAgICAucmVkdWNlKChsaHMsIHJocykgPT4geCBgJHtsaHN9IHx8ICR7cmhzfWApO1xuICAgICAgICAvLyB3ZSBwdXNoIHVuYXNzaWduIGFuZCB1bnNoaWZ0IGFzc2lnbiBzbyB0aGF0IHJlZmVyZW5jZXMgYXJlXG4gICAgICAgIC8vIG51bGxlZCBvdXQgYmVmb3JlIHRoZXkncmUgY3JlYXRlZCwgdG8gYXZvaWQgZ2xpdGNoZXNcbiAgICAgICAgLy8gd2l0aCBzaGlmdGluZyBpbmRpY2VzXG4gICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdGlmICgke2NvbmRpdGlvbn0pIHtcblx0XHRcdFx0JHt1bmFzc2lnbn0oKTtcblx0XHRcdFx0JHthcmdzLm1hcChhID0+IGIgYCR7YX0gPSAke2Jsb2NrLnJlbmRlcmVyLnJlZmVyZW5jZShhbGlhc19tYXAuZ2V0KGEubmFtZSkgfHwgYS5uYW1lKX1gKX07XG5cdFx0XHRcdCR7YXNzaWdufSgpO1xuXHRcdFx0fWApO1xuICAgICAgICBibG9jay5jaHVua3MuZGVzdHJveS5wdXNoKGIgYCR7dW5hc3NpZ259KCk7YCk7XG4gICAgICAgIHJldHVybiBiIGAke2Fzc2lnbn0oKTtgO1xuICAgIH1cbiAgICBjb21wb25lbnQucGFydGx5X2hvaXN0ZWQucHVzaChiIGBcblx0XHRmdW5jdGlvbiAke2ZufSgkJHZhbHVlKSB7XG5cdFx0XHRAYmluZGluZ19jYWxsYmFja3NbJCR2YWx1ZSA/ICd1bnNoaWZ0JyA6ICdwdXNoJ10oKCkgPT4ge1xuXHRcdFx0XHQke2JvZHl9XG5cdFx0XHR9KTtcblx0XHR9XG5cdGApO1xuICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgJHtjYWxsZWV9KG51bGwpO2ApO1xuICAgIHJldHVybiBiIGAke2NhbGxlZX0oJHt2YXJpYWJsZX0pO2A7XG59XG5cbmNsYXNzIFRhZyQxIGV4dGVuZHMgV3JhcHBlciB7XG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUpIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUpO1xuICAgICAgICB0aGlzLmNhbm5vdF91c2VfaW5uZXJodG1sKCk7XG4gICAgICAgIGlmICghdGhpcy5pc19kZXBlbmRlbmNpZXNfc3RhdGljKCkpIHtcbiAgICAgICAgICAgIHRoaXMubm90X3N0YXRpY19jb250ZW50KCk7XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2suYWRkX2RlcGVuZGVuY2llcyhub2RlLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzKTtcbiAgICB9XG4gICAgaXNfZGVwZW5kZW5jaWVzX3N0YXRpYygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubm9kZS5leHByZXNzaW9uLmNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLnNpemUgPT09IDAgJiYgdGhpcy5ub2RlLmV4cHJlc3Npb24uZHluYW1pY19kZXBlbmRlbmNpZXMoKS5sZW5ndGggPT09IDA7XG4gICAgfVxuICAgIHJlbmFtZV90aGlzX21ldGhvZChibG9jaywgdXBkYXRlKSB7XG4gICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IHRoaXMubm9kZS5leHByZXNzaW9uLmR5bmFtaWNfZGVwZW5kZW5jaWVzKCk7XG4gICAgICAgIGxldCBzbmlwcGV0ID0gdGhpcy5ub2RlLmV4cHJlc3Npb24ubWFuaXB1bGF0ZShibG9jayk7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5ub2RlLnNob3VsZF9jYWNoZSAmJiBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7dGhpcy52YXIubmFtZX1fdmFsdWVgKTtcbiAgICAgICAgY29uc3QgY29udGVudCA9IHRoaXMubm9kZS5zaG91bGRfY2FjaGUgPyB2YWx1ZSA6IHNuaXBwZXQ7XG4gICAgICAgIHNuaXBwZXQgPSB4IGAke3NuaXBwZXR9ICsgXCJcImA7XG4gICAgICAgIGlmICh0aGlzLm5vZGUuc2hvdWxkX2NhY2hlKVxuICAgICAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKHZhbHVlLCBzbmlwcGV0KTsgLy8gVE9ETyBtYXkgbmVlZCB0byBjb2VyY2Ugc25pcHBldCB0byBzdHJpbmdcbiAgICAgICAgaWYgKGRlcGVuZGVuY2llcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBsZXQgY29uZGl0aW9uID0gYmxvY2sucmVuZGVyZXIuZGlydHkoZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIGlmIChibG9jay5oYXNfb3V0cm9zKSB7XG4gICAgICAgICAgICAgICAgY29uZGl0aW9uID0geCBgISNjdXJyZW50IHx8ICR7Y29uZGl0aW9ufWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVfY2FjaGVkX3ZhbHVlID0geCBgJHt2YWx1ZX0gIT09ICgke3ZhbHVlfSA9ICR7c25pcHBldH0pYDtcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGUuc2hvdWxkX2NhY2hlKSB7XG4gICAgICAgICAgICAgICAgY29uZGl0aW9uID0geCBgJHtjb25kaXRpb259ICYmICR7dXBkYXRlX2NhY2hlZF92YWx1ZX1gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYGlmICgke2NvbmRpdGlvbn0pICR7dXBkYXRlKGNvbnRlbnQpfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGluaXQ6IGNvbnRlbnQgfTtcbiAgICB9XG59XG5cbmNsYXNzIE11c3RhY2hlVGFnV3JhcHBlciBleHRlbmRzIFRhZyQxIHtcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSkge1xuICAgICAgICBzdXBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSk7XG4gICAgICAgIHRoaXMudmFyID0geyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6ICd0JyB9O1xuICAgIH1cbiAgICByZW5kZXIoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpIHtcbiAgICAgICAgY29uc3QgeyBpbml0IH0gPSB0aGlzLnJlbmFtZV90aGlzX21ldGhvZChibG9jaywgdmFsdWUgPT4geCBgQHNldF9kYXRhKCR7dGhpcy52YXJ9LCAke3ZhbHVlfSlgKTtcbiAgICAgICAgYmxvY2suYWRkX2VsZW1lbnQodGhpcy52YXIsIHggYEB0ZXh0KCR7aW5pdH0pYCwgcGFyZW50X25vZGVzICYmIHggYEBjbGFpbV90ZXh0KCR7cGFyZW50X25vZGVzfSwgJHtpbml0fSlgLCBwYXJlbnRfbm9kZSk7XG4gICAgfVxufVxuXG5jbGFzcyBSYXdNdXN0YWNoZVRhZ1dyYXBwZXIgZXh0ZW5kcyBUYWckMSB7XG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUpIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUpO1xuICAgICAgICB0aGlzLnZhciA9IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiAncmF3JyB9O1xuICAgICAgICB0aGlzLmNhbm5vdF91c2VfaW5uZXJodG1sKCk7XG4gICAgICAgIHRoaXMubm90X3N0YXRpY19jb250ZW50KCk7XG4gICAgfVxuICAgIHJlbmRlcihibG9jaywgcGFyZW50X25vZGUsIF9wYXJlbnRfbm9kZXMpIHtcbiAgICAgICAgY29uc3QgaW5faGVhZCA9IGlzX2hlYWQocGFyZW50X25vZGUpO1xuICAgICAgICBjb25zdCBjYW5fdXNlX2lubmVyaHRtbCA9ICFpbl9oZWFkICYmIHBhcmVudF9ub2RlICYmICF0aGlzLnByZXYgJiYgIXRoaXMubmV4dDtcbiAgICAgICAgaWYgKGNhbl91c2VfaW5uZXJodG1sKSB7XG4gICAgICAgICAgICBjb25zdCBpbnNlcnQgPSAoY29udGVudCkgPT4gYiBgJHtwYXJlbnRfbm9kZX0uaW5uZXJIVE1MID0gJHtjb250ZW50fTtgWzBdO1xuICAgICAgICAgICAgY29uc3QgeyBpbml0IH0gPSB0aGlzLnJlbmFtZV90aGlzX21ldGhvZChibG9jaywgY29udGVudCA9PiBpbnNlcnQoY29udGVudCkpO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goaW5zZXJ0KGluaXQpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG5lZWRzX2FuY2hvciA9IGluX2hlYWQgfHwgKHRoaXMubmV4dCA/ICF0aGlzLm5leHQuaXNfZG9tX25vZGUoKSA6ICghdGhpcy5wYXJlbnQgfHwgIXRoaXMucGFyZW50LmlzX2RvbV9ub2RlKCkpKTtcbiAgICAgICAgICAgIGNvbnN0IGh0bWxfdGFnID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdodG1sX3RhZycpO1xuICAgICAgICAgICAgY29uc3QgaHRtbF9hbmNob3IgPSBuZWVkc19hbmNob3IgJiYgYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdodG1sX2FuY2hvcicpO1xuICAgICAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKGh0bWxfdGFnKTtcbiAgICAgICAgICAgIGNvbnN0IHsgaW5pdCB9ID0gdGhpcy5yZW5hbWVfdGhpc19tZXRob2QoYmxvY2ssIGNvbnRlbnQgPT4geCBgJHtodG1sX3RhZ30ucCgke2NvbnRlbnR9KWApO1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlX2FuY2hvciA9IG5lZWRzX2FuY2hvciA/IGh0bWxfYW5jaG9yIDogdGhpcy5uZXh0ID8gdGhpcy5uZXh0LnZhciA6ICdudWxsJztcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudF9lbGVtZW50ID0gdGhpcy5ub2RlLmZpbmRfbmVhcmVzdCgvXkVsZW1lbnQvKTtcbiAgICAgICAgICAgIGNvbnN0IGlzX3N2ZyA9IHBhcmVudF9lbGVtZW50ICYmIHBhcmVudF9lbGVtZW50Lm5hbWVzcGFjZSA9PT0gbmFtZXNwYWNlcy5zdmc7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuY3JlYXRlLnB1c2goYiBgJHtodG1sX3RhZ30gPSBuZXcgQEh0bWxUYWcoJHtpc19zdmcgPyAndHJ1ZScgOiAnZmFsc2UnfSk7YCk7XG4gICAgICAgICAgICBpZiAodGhpcy5yZW5kZXJlci5vcHRpb25zLmh5ZHJhdGFibGUpIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuY2xhaW0ucHVzaChiIGAke2h0bWxfdGFnfSA9IEBjbGFpbV9odG1sX3RhZygke19wYXJlbnRfbm9kZXN9LCAke2lzX3N2ZyA/ICd0cnVlJyA6ICdmYWxzZSd9KTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5oeWRyYXRlLnB1c2goYiBgJHtodG1sX3RhZ30uYSA9ICR7dXBkYXRlX2FuY2hvcn07YCk7XG4gICAgICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGAke2h0bWxfdGFnfS5tKCR7aW5pdH0sICR7cGFyZW50X25vZGUgfHwgJyN0YXJnZXQnfSwgJHtwYXJlbnRfbm9kZSA/IG51bGwgOiAnI2FuY2hvcid9KTtgKTtcbiAgICAgICAgICAgIGlmIChuZWVkc19hbmNob3IpIHtcbiAgICAgICAgICAgICAgICBibG9jay5hZGRfZWxlbWVudChodG1sX2FuY2hvciwgeCBgQGVtcHR5KClgLCB4IGBAZW1wdHkoKWAsIHBhcmVudF9ub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghcGFyZW50X25vZGUgfHwgaW5faGVhZCkge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgaWYgKGRldGFjaGluZykgJHtodG1sX3RhZ30uZCgpO2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5jb25zdCByZWdleF9jb250YWluc19yYWRpb19vcl9jaGVja2JveF9vcl9maWxlID0gL3JhZGlvfGNoZWNrYm94fGZpbGUvO1xuY29uc3QgcmVnZXhfY29udGFpbnNfcmFkaW9fb3JfY2hlY2tib3hfb3JfcmFuZ2Vfb3JfZmlsZSA9IC9yYWRpb3xjaGVja2JveHxyYW5nZXxmaWxlLztcbmNvbnN0IGV2ZW50cyA9IFtcbiAgICB7XG4gICAgICAgIGV2ZW50X25hbWVzOiBbJ2lucHV0J10sXG4gICAgICAgIGZpbHRlcjogKG5vZGUsIF9uYW1lKSA9PiBub2RlLm5hbWUgPT09ICd0ZXh0YXJlYScgfHxcbiAgICAgICAgICAgIG5vZGUubmFtZSA9PT0gJ2lucHV0JyAmJlxuICAgICAgICAgICAgICAgICFyZWdleF9jb250YWluc19yYWRpb19vcl9jaGVja2JveF9vcl9yYW5nZV9vcl9maWxlLnRlc3Qobm9kZS5nZXRfc3RhdGljX2F0dHJpYnV0ZV92YWx1ZSgndHlwZScpKVxuICAgIH0sXG4gICAge1xuICAgICAgICBldmVudF9uYW1lczogWydpbnB1dCddLFxuICAgICAgICBmaWx0ZXI6IChub2RlLCBuYW1lKSA9PiAobmFtZSA9PT0gJ3RleHRDb250ZW50JyB8fCBuYW1lID09PSAnaW5uZXJIVE1MJykgJiZcbiAgICAgICAgICAgIG5vZGUuYXR0cmlidXRlcy5zb21lKGF0dHJpYnV0ZSA9PiBhdHRyaWJ1dGUubmFtZSA9PT0gJ2NvbnRlbnRlZGl0YWJsZScpXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGV2ZW50X25hbWVzOiBbJ2NoYW5nZSddLFxuICAgICAgICBmaWx0ZXI6IChub2RlLCBfbmFtZSkgPT4gbm9kZS5uYW1lID09PSAnc2VsZWN0JyB8fFxuICAgICAgICAgICAgbm9kZS5uYW1lID09PSAnaW5wdXQnICYmXG4gICAgICAgICAgICAgICAgcmVnZXhfY29udGFpbnNfcmFkaW9fb3JfY2hlY2tib3hfb3JfZmlsZS50ZXN0KG5vZGUuZ2V0X3N0YXRpY19hdHRyaWJ1dGVfdmFsdWUoJ3R5cGUnKSlcbiAgICB9LFxuICAgIHtcbiAgICAgICAgZXZlbnRfbmFtZXM6IFsnY2hhbmdlJywgJ2lucHV0J10sXG4gICAgICAgIGZpbHRlcjogKG5vZGUsIF9uYW1lKSA9PiBub2RlLm5hbWUgPT09ICdpbnB1dCcgJiYgbm9kZS5nZXRfc3RhdGljX2F0dHJpYnV0ZV92YWx1ZSgndHlwZScpID09PSAncmFuZ2UnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGV2ZW50X25hbWVzOiBbJ2VsZW1lbnRyZXNpemUnXSxcbiAgICAgICAgZmlsdGVyOiAoX25vZGUsIG5hbWUpID0+IHJlZ2V4X2RpbWVuc2lvbnMudGVzdChuYW1lKVxuICAgIH0sXG4gICAgLy8gbWVkaWEgZXZlbnRzXG4gICAge1xuICAgICAgICBldmVudF9uYW1lczogWyd0aW1ldXBkYXRlJ10sXG4gICAgICAgIGZpbHRlcjogKG5vZGUsIG5hbWUpID0+IG5vZGUuaXNfbWVkaWFfbm9kZSgpICYmXG4gICAgICAgICAgICAobmFtZSA9PT0gJ2N1cnJlbnRUaW1lJyB8fCBuYW1lID09PSAncGxheWVkJyB8fCBuYW1lID09PSAnZW5kZWQnKVxuICAgIH0sXG4gICAge1xuICAgICAgICBldmVudF9uYW1lczogWydkdXJhdGlvbmNoYW5nZSddLFxuICAgICAgICBmaWx0ZXI6IChub2RlLCBuYW1lKSA9PiBub2RlLmlzX21lZGlhX25vZGUoKSAmJlxuICAgICAgICAgICAgbmFtZSA9PT0gJ2R1cmF0aW9uJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBldmVudF9uYW1lczogWydwbGF5JywgJ3BhdXNlJ10sXG4gICAgICAgIGZpbHRlcjogKG5vZGUsIG5hbWUpID0+IG5vZGUuaXNfbWVkaWFfbm9kZSgpICYmXG4gICAgICAgICAgICBuYW1lID09PSAncGF1c2VkJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBldmVudF9uYW1lczogWydwcm9ncmVzcyddLFxuICAgICAgICBmaWx0ZXI6IChub2RlLCBuYW1lKSA9PiBub2RlLmlzX21lZGlhX25vZGUoKSAmJlxuICAgICAgICAgICAgbmFtZSA9PT0gJ2J1ZmZlcmVkJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBldmVudF9uYW1lczogWydsb2FkZWRtZXRhZGF0YSddLFxuICAgICAgICBmaWx0ZXI6IChub2RlLCBuYW1lKSA9PiBub2RlLmlzX21lZGlhX25vZGUoKSAmJlxuICAgICAgICAgICAgKG5hbWUgPT09ICdidWZmZXJlZCcgfHwgbmFtZSA9PT0gJ3NlZWthYmxlJylcbiAgICB9LFxuICAgIHtcbiAgICAgICAgZXZlbnRfbmFtZXM6IFsndm9sdW1lY2hhbmdlJ10sXG4gICAgICAgIGZpbHRlcjogKG5vZGUsIG5hbWUpID0+IG5vZGUuaXNfbWVkaWFfbm9kZSgpICYmXG4gICAgICAgICAgICAobmFtZSA9PT0gJ3ZvbHVtZScgfHwgbmFtZSA9PT0gJ211dGVkJylcbiAgICB9LFxuICAgIHtcbiAgICAgICAgZXZlbnRfbmFtZXM6IFsncmF0ZWNoYW5nZSddLFxuICAgICAgICBmaWx0ZXI6IChub2RlLCBuYW1lKSA9PiBub2RlLmlzX21lZGlhX25vZGUoKSAmJlxuICAgICAgICAgICAgbmFtZSA9PT0gJ3BsYXliYWNrUmF0ZSdcbiAgICB9LFxuICAgIHtcbiAgICAgICAgZXZlbnRfbmFtZXM6IFsnc2Vla2luZycsICdzZWVrZWQnXSxcbiAgICAgICAgZmlsdGVyOiAobm9kZSwgbmFtZSkgPT4gbm9kZS5pc19tZWRpYV9ub2RlKCkgJiZcbiAgICAgICAgICAgIChuYW1lID09PSAnc2Vla2luZycpXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGV2ZW50X25hbWVzOiBbJ2VuZGVkJ10sXG4gICAgICAgIGZpbHRlcjogKG5vZGUsIG5hbWUpID0+IG5vZGUuaXNfbWVkaWFfbm9kZSgpICYmXG4gICAgICAgICAgICBuYW1lID09PSAnZW5kZWQnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGV2ZW50X25hbWVzOiBbJ3Jlc2l6ZSddLFxuICAgICAgICBmaWx0ZXI6IChub2RlLCBuYW1lKSA9PiBub2RlLmlzX21lZGlhX25vZGUoKSAmJlxuICAgICAgICAgICAgKG5hbWUgPT09ICd2aWRlb0hlaWdodCcgfHwgbmFtZSA9PT0gJ3ZpZGVvV2lkdGgnKVxuICAgIH0sXG4gICAgLy8gZGV0YWlscyBldmVudFxuICAgIHtcbiAgICAgICAgZXZlbnRfbmFtZXM6IFsndG9nZ2xlJ10sXG4gICAgICAgIGZpbHRlcjogKG5vZGUsIF9uYW1lKSA9PiBub2RlLm5hbWUgPT09ICdkZXRhaWxzJ1xuICAgIH1cbl07XG5jb25zdCBDSElMRF9EWU5BTUlDX0VMRU1FTlRfQkxPQ0sgPSAnY2hpbGRfZHluYW1pY19lbGVtZW50JztcbmNvbnN0IHJlZ2V4X2ludmFsaWRfdmFyaWFibGVfaWRlbnRpZmllcl9jaGFyYWN0ZXJzJDIgPSAvW15hLXpBLVowLTlfJF0vZztcbmNvbnN0IHJlZ2V4X21pbnVzX3NpZ25zID0gLy0vZztcbmNsYXNzIEVsZW1lbnRXcmFwcGVyIGV4dGVuZHMgV3JhcHBlciB7XG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZykge1xuICAgICAgICBzdXBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSk7XG4gICAgICAgIHRoaXMuY2hpbGRfZHluYW1pY19lbGVtZW50X2Jsb2NrID0gbnVsbDtcbiAgICAgICAgdGhpcy5jaGlsZF9keW5hbWljX2VsZW1lbnQgPSBudWxsO1xuICAgICAgICBpZiAobm9kZS5pc19keW5hbWljX2VsZW1lbnQgJiYgYmxvY2sudHlwZSAhPT0gQ0hJTERfRFlOQU1JQ19FTEVNRU5UX0JMT0NLKSB7XG4gICAgICAgICAgICB0aGlzLmNoaWxkX2R5bmFtaWNfZWxlbWVudF9ibG9jayA9IGJsb2NrLmNoaWxkKHtcbiAgICAgICAgICAgICAgICBjb21tZW50OiBjcmVhdGVfZGVidWdnaW5nX2NvbW1lbnQobm9kZSwgcmVuZGVyZXIuY29tcG9uZW50KSxcbiAgICAgICAgICAgICAgICBuYW1lOiByZW5kZXJlci5jb21wb25lbnQuZ2V0X3VuaXF1ZV9uYW1lKCdjcmVhdGVfZHluYW1pY19lbGVtZW50JyksXG4gICAgICAgICAgICAgICAgdHlwZTogQ0hJTERfRFlOQU1JQ19FTEVNRU5UX0JMT0NLXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlbmRlcmVyLmJsb2Nrcy5wdXNoKHRoaXMuY2hpbGRfZHluYW1pY19lbGVtZW50X2Jsb2NrKTtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRfZHluYW1pY19lbGVtZW50ID0gbmV3IEVsZW1lbnRXcmFwcGVyKHJlbmRlcmVyLCB0aGlzLmNoaWxkX2R5bmFtaWNfZWxlbWVudF9ibG9jaywgcGFyZW50LCBub2RlLCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFyID0ge1xuICAgICAgICAgICAgdHlwZTogJ0lkZW50aWZpZXInLFxuICAgICAgICAgICAgbmFtZTogbm9kZS5uYW1lLnJlcGxhY2UocmVnZXhfaW52YWxpZF92YXJpYWJsZV9pZGVudGlmaWVyX2NoYXJhY3RlcnMkMiwgJ18nKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnZvaWQgPSBpc192b2lkKG5vZGUubmFtZSk7XG4gICAgICAgIHRoaXMuY2xhc3NfZGVwZW5kZW5jaWVzID0gW107XG4gICAgICAgIGlmICh0aGlzLm5vZGUuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUubGV0cy5mb3JFYWNoKGwgPT4ge1xuICAgICAgICAgICAgICAgIGV4dHJhY3RfbmFtZXMobC52YWx1ZSB8fCBsLm5hbWUpLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLmFkZF90b19jb250ZXh0KG5hbWUsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gdGhpcy5ub2RlLmF0dHJpYnV0ZXMubWFwKGF0dHJpYnV0ZSA9PiB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0eWxlQXR0cmlidXRlV3JhcHBlcih0aGlzLCBibG9jaywgYXR0cmlidXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUudHlwZSA9PT0gJ1NwcmVhZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNwcmVhZEF0dHJpYnV0ZVdyYXBwZXIodGhpcywgYmxvY2ssIGF0dHJpYnV0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEF0dHJpYnV0ZVdyYXBwZXIodGhpcywgYmxvY2ssIGF0dHJpYnV0ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBvcmRpbmFyaWx5LCB0aGVyZSdsbCBvbmx5IGJlIG9uZS4uLiBidXQgd2UgbmVlZCB0byBoYW5kbGVcbiAgICAgICAgLy8gdGhlIHJhcmUgY2FzZSB3aGVyZSBhbiBlbGVtZW50IGNhbiBoYXZlIG11bHRpcGxlIGJpbmRpbmdzLFxuICAgICAgICAvLyBlLmcuIDxhdWRpbyBiaW5kOnBhdXNlZCBiaW5kOmN1cnJlbnRUaW1lPlxuICAgICAgICB0aGlzLmJpbmRpbmdzID0gdGhpcy5ub2RlLmJpbmRpbmdzLm1hcChiaW5kaW5nID0+IG5ldyBCaW5kaW5nV3JhcHBlcihibG9jaywgYmluZGluZywgdGhpcykpO1xuICAgICAgICB0aGlzLmV2ZW50X2hhbmRsZXJzID0gdGhpcy5ub2RlLmhhbmRsZXJzLm1hcChldmVudF9oYW5kbGVyID0+IG5ldyBFdmVudEhhbmRsZXJXcmFwcGVyKGV2ZW50X2hhbmRsZXIsIHRoaXMpKTtcbiAgICAgICAgaWYgKG5vZGUuaW50cm8gfHwgbm9kZS5vdXRybykge1xuICAgICAgICAgICAgaWYgKG5vZGUuaW50cm8pXG4gICAgICAgICAgICAgICAgYmxvY2suYWRkX2ludHJvKG5vZGUuaW50cm8uaXNfbG9jYWwpO1xuICAgICAgICAgICAgaWYgKG5vZGUub3V0cm8pXG4gICAgICAgICAgICAgICAgYmxvY2suYWRkX291dHJvKG5vZGUub3V0cm8uaXNfbG9jYWwpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlLmFuaW1hdGlvbikge1xuICAgICAgICAgICAgYmxvY2suYWRkX2FuaW1hdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmFkZF9kZXBlbmRlbmNpZXMobm9kZS50YWdfZXhwci5kZXBlbmRlbmNpZXMpO1xuICAgICAgICAvLyBhZGQgZGlyZWN0aXZlIGFuZCBoYW5kbGVyIGRlcGVuZGVuY2llc1xuICAgICAgICBbbm9kZS5hbmltYXRpb24sIG5vZGUub3V0cm8sIC4uLm5vZGUuYWN0aW9ucywgLi4ubm9kZS5jbGFzc2VzLCAuLi5ub2RlLnN0eWxlc10uZm9yRWFjaChkaXJlY3RpdmUgPT4ge1xuICAgICAgICAgICAgaWYgKGRpcmVjdGl2ZSAmJiBkaXJlY3RpdmUuZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgICAgIGJsb2NrLmFkZF9kZXBlbmRlbmNpZXMoZGlyZWN0aXZlLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIG5vZGUuaGFuZGxlcnMuZm9yRWFjaChoYW5kbGVyID0+IHtcbiAgICAgICAgICAgIGlmIChoYW5kbGVyLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgICAgICBibG9jay5hZGRfZGVwZW5kZW5jaWVzKGhhbmRsZXIuZXhwcmVzc2lvbi5kZXBlbmRlbmNpZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICBpZiAobm9kZS5hY3Rpb25zLmxlbmd0aCA+IDAgfHxcbiAgICAgICAgICAgICAgICBub2RlLmFuaW1hdGlvbiB8fFxuICAgICAgICAgICAgICAgIG5vZGUuYmluZGluZ3MubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgICAgIG5vZGUuY2xhc3Nlcy5sZW5ndGggPiAwIHx8XG4gICAgICAgICAgICAgICAgbm9kZS5pbnRybyB8fCBub2RlLm91dHJvIHx8XG4gICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVycy5sZW5ndGggPiAwIHx8XG4gICAgICAgICAgICAgICAgbm9kZS5zdHlsZXMubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5uYW1lID09PSAnb3B0aW9uJyB8fFxuICAgICAgICAgICAgICAgIG5vZGUudGFnX2V4cHIuZHluYW1pY19kZXBlbmRlbmNpZXMoKS5sZW5ndGggfHxcbiAgICAgICAgICAgICAgICByZW5kZXJlci5vcHRpb25zLmRldikge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNhbm5vdF91c2VfaW5uZXJodG1sKCk7IC8vIG5lZWQgdG8gdXNlIGFkZF9sb2NhdGlvblxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdF9zdGF0aWNfY29udGVudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuZnJhZ21lbnQgPSBuZXcgRnJhZ21lbnRXcmFwcGVyKHJlbmRlcmVyLCBibG9jaywgbm9kZS5jaGlsZHJlbiwgdGhpcywgc3RyaXBfd2hpdGVzcGFjZSwgbmV4dF9zaWJsaW5nKTtcbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKSB7XG4gICAgICAgIGlmICh0aGlzLmNoaWxkX2R5bmFtaWNfZWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJfZHluYW1pY19lbGVtZW50KGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyX2VsZW1lbnQoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbmRlcl9keW5hbWljX2VsZW1lbnQoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpIHtcbiAgICAgICAgdGhpcy5jaGlsZF9keW5hbWljX2VsZW1lbnQucmVuZGVyKHRoaXMuY2hpbGRfZHluYW1pY19lbGVtZW50X2Jsb2NrLCBudWxsLCB4IGAjbm9kZXNgKTtcbiAgICAgICAgY29uc3QgcHJldmlvdXNfdGFnID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdwcmV2aW91c190YWcnKTtcbiAgICAgICAgY29uc3QgdGFnID0gdGhpcy5ub2RlLnRhZ19leHByLm1hbmlwdWxhdGUoYmxvY2spO1xuICAgICAgICBibG9jay5hZGRfdmFyaWFibGUocHJldmlvdXNfdGFnLCB0YWcpO1xuICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0JHt0aGlzLnJlbmRlcmVyLm9wdGlvbnMuZGV2ICYmIGIgYEB2YWxpZGF0ZV9keW5hbWljX2VsZW1lbnQoJHt0YWd9KTtgfVxuXHRcdFx0JHt0aGlzLnJlbmRlcmVyLm9wdGlvbnMuZGV2ICYmIHRoaXMubm9kZS5jaGlsZHJlbi5sZW5ndGggPiAwICYmIGIgYEB2YWxpZGF0ZV92b2lkX2R5bmFtaWNfZWxlbWVudCgke3RhZ30pO2B9XG5cdFx0XHRsZXQgJHt0aGlzLnZhcn0gPSAke3RhZ30gJiYgJHt0aGlzLmNoaWxkX2R5bmFtaWNfZWxlbWVudF9ibG9jay5uYW1lfSgjY3R4KTtcblx0XHRgKTtcbiAgICAgICAgYmxvY2suY2h1bmtzLmNyZWF0ZS5wdXNoKGIgYFxuXHRcdFx0aWYgKCR7dGhpcy52YXJ9KSAke3RoaXMudmFyfS5jKCk7XG5cdFx0YCk7XG4gICAgICAgIGlmICh0aGlzLnJlbmRlcmVyLm9wdGlvbnMuaHlkcmF0YWJsZSkge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmNsYWltLnB1c2goYiBgXG5cdFx0XHRcdGlmICgke3RoaXMudmFyfSkgJHt0aGlzLnZhcn0ubCgke3BhcmVudF9ub2Rlc30pO1xuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goYiBgXG5cdFx0XHRpZiAoJHt0aGlzLnZhcn0pICR7dGhpcy52YXJ9Lm0oJHtwYXJlbnRfbm9kZSB8fCAnI3RhcmdldCd9LCAke3BhcmVudF9ub2RlID8gJ251bGwnIDogJyNhbmNob3InfSk7XG5cdFx0YCk7XG4gICAgICAgIGNvbnN0IGFuY2hvciA9IHRoaXMuZ2V0X29yX2NyZWF0ZV9hbmNob3IoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpO1xuICAgICAgICBjb25zdCBoYXNfdHJhbnNpdGlvbnMgPSAhISh0aGlzLm5vZGUuaW50cm8gfHwgdGhpcy5ub2RlLm91dHJvKTtcbiAgICAgICAgY29uc3Qgbm90X2VxdWFsID0gdGhpcy5yZW5kZXJlci5jb21wb25lbnQuY29tcG9uZW50X29wdGlvbnMuaW1tdXRhYmxlID8geCBgQG5vdF9lcXVhbGAgOiB4IGBAc2FmZV9ub3RfZXF1YWxgO1xuICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRpZiAoJHt0YWd9KSB7XG5cdFx0XHRcdGlmICghJHtwcmV2aW91c190YWd9KSB7XG5cdFx0XHRcdFx0JHt0aGlzLnZhcn0gPSAke3RoaXMuY2hpbGRfZHluYW1pY19lbGVtZW50X2Jsb2NrLm5hbWV9KCNjdHgpO1xuXHRcdFx0XHRcdCR7dGhpcy52YXJ9LmMoKTtcblx0XHRcdFx0XHQke2hhc190cmFuc2l0aW9ucyAmJiBiIGBAdHJhbnNpdGlvbl9pbigke3RoaXMudmFyfSlgfVxuXHRcdFx0XHRcdCR7dGhpcy52YXJ9Lm0oJHt0aGlzLmdldF91cGRhdGVfbW91bnRfbm9kZShhbmNob3IpfSwgJHthbmNob3J9KTtcblx0XHRcdFx0fSBlbHNlIGlmICgke25vdF9lcXVhbH0oJHtwcmV2aW91c190YWd9LCAke3RhZ30pKSB7XG5cdFx0XHRcdFx0JHt0aGlzLnZhcn0uZCgxKTtcblx0XHRcdFx0XHQke3RoaXMucmVuZGVyZXIub3B0aW9ucy5kZXYgJiYgYiBgQHZhbGlkYXRlX2R5bmFtaWNfZWxlbWVudCgke3RhZ30pO2B9XG5cdFx0XHRcdFx0JHt0aGlzLnJlbmRlcmVyLm9wdGlvbnMuZGV2ICYmIHRoaXMubm9kZS5jaGlsZHJlbi5sZW5ndGggPiAwICYmIGIgYEB2YWxpZGF0ZV92b2lkX2R5bmFtaWNfZWxlbWVudCgke3RhZ30pO2B9XG5cdFx0XHRcdFx0JHt0aGlzLnZhcn0gPSAke3RoaXMuY2hpbGRfZHluYW1pY19lbGVtZW50X2Jsb2NrLm5hbWV9KCNjdHgpO1xuXHRcdFx0XHRcdCR7dGhpcy52YXJ9LmMoKTtcblx0XHRcdFx0XHQke3RoaXMudmFyfS5tKCR7dGhpcy5nZXRfdXBkYXRlX21vdW50X25vZGUoYW5jaG9yKX0sICR7YW5jaG9yfSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JHt0aGlzLnZhcn0ucCgjY3R4LCAjZGlydHkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKCR7cHJldmlvdXNfdGFnfSkge1xuXHRcdFx0XHQke2hhc190cmFuc2l0aW9uc1xuICAgICAgICAgICAgPyBiIGBcblx0XHRcdFx0XHRcdFx0QGdyb3VwX291dHJvcygpO1xuXHRcdFx0XHRcdFx0XHRAdHJhbnNpdGlvbl9vdXQoJHt0aGlzLnZhcn0sIDEsIDEsICgpID0+IHtcblx0XHRcdFx0XHRcdFx0XHQke3RoaXMudmFyfSA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRAY2hlY2tfb3V0cm9zKCk7XG5cdFx0XHRcdFx0XHRgXG4gICAgICAgICAgICA6IGIgYFxuXHRcdFx0XHRcdFx0XHQke3RoaXMudmFyfS5kKDEpO1xuXHRcdFx0XHRcdFx0XHQke3RoaXMudmFyfSA9IG51bGw7XG5cdFx0XHRcdFx0XHRgfVxuXHRcdFx0fVxuXHRcdFx0JHtwcmV2aW91c190YWd9ID0gJHt0YWd9O1xuXHRcdGApO1xuICAgICAgICBpZiAodGhpcy5jaGlsZF9keW5hbWljX2VsZW1lbnRfYmxvY2suaGFzX2ludHJvcykge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmludHJvLnB1c2goYiBgQHRyYW5zaXRpb25faW4oJHt0aGlzLnZhcn0pO2ApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNoaWxkX2R5bmFtaWNfZWxlbWVudF9ibG9jay5oYXNfb3V0cm9zKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3Mub3V0cm8ucHVzaChiIGBAdHJhbnNpdGlvbl9vdXQoJHt0aGlzLnZhcn0pO2ApO1xuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgaWYgKCR7dGhpcy52YXJ9KSAke3RoaXMudmFyfS5kKGRldGFjaGluZylgKTtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5hbmltYXRpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IG1lYXN1cmVtZW50cyA9IGJsb2NrLmdldF91bmlxdWVfbmFtZSgnbWVhc3VyZW1lbnRzJyk7XG4gICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUobWVhc3VyZW1lbnRzKTtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5tZWFzdXJlLnB1c2goYiBgJHttZWFzdXJlbWVudHN9ID0gJHt0aGlzLnZhcn0ucigpYCk7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuZml4LnB1c2goYiBgJHt0aGlzLnZhcn0uZigpO2ApO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmFuaW1hdGUucHVzaChiIGBcblx0XHRcdFx0JHt0aGlzLnZhcn0ucygke21lYXN1cmVtZW50c30pO1xuXHRcdFx0XHQke3RoaXMudmFyfS5hKClcblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlzX2RvbV9ub2RlKCkge1xuICAgICAgICByZXR1cm4gc3VwZXIuaXNfZG9tX25vZGUoKSAmJiAhdGhpcy5jaGlsZF9keW5hbWljX2VsZW1lbnQ7XG4gICAgfVxuICAgIHJlbmRlcl9lbGVtZW50KGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKSB7XG4gICAgICAgIGNvbnN0IHsgcmVuZGVyZXIgfSA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLm5vZGUubmFtZSA9PT0gJ25vc2NyaXB0JylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHRoaXMudmFyO1xuICAgICAgICBjb25zdCBub2RlcyA9IHBhcmVudF9ub2RlcyAmJiBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7dGhpcy52YXIubmFtZX1fbm9kZXNgKTsgLy8gaWYgd2UncmUgaW4gdW5jbGFpbWFibGUgdGVycml0b3J5LCBpLmUuIDxoZWFkPiwgcGFyZW50X25vZGVzIGlzIG51bGxcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSB4IGBAY2hpbGRyZW4oJHt0aGlzLm5vZGUubmFtZSA9PT0gJ3RlbXBsYXRlJyA/IHggYCR7bm9kZX0uY29udGVudGAgOiBub2RlfSlgO1xuICAgICAgICBibG9jay5hZGRfdmFyaWFibGUobm9kZSk7XG4gICAgICAgIGNvbnN0IHJlbmRlcl9zdGF0ZW1lbnQgPSB0aGlzLmdldF9yZW5kZXJfc3RhdGVtZW50KGJsb2NrKTtcbiAgICAgICAgYmxvY2suY2h1bmtzLmNyZWF0ZS5wdXNoKGIgYCR7bm9kZX0gPSAke3JlbmRlcl9zdGF0ZW1lbnR9O2ApO1xuICAgICAgICBpZiAocmVuZGVyZXIub3B0aW9ucy5oeWRyYXRhYmxlKSB7XG4gICAgICAgICAgICBpZiAocGFyZW50X25vZGVzKSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLmNsYWltLnB1c2goYiBgXG5cdFx0XHRcdFx0JHtub2RlfSA9ICR7dGhpcy5nZXRfY2xhaW1fc3RhdGVtZW50KGJsb2NrLCBwYXJlbnRfbm9kZXMpfTtcblx0XHRcdFx0YCk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnZvaWQgJiYgdGhpcy5ub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLmNsYWltLnB1c2goYiBgXG5cdFx0XHRcdFx0XHR2YXIgJHtub2Rlc30gPSAke2NoaWxkcmVufTtcblx0XHRcdFx0XHRgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuY2xhaW0ucHVzaChiIGAke25vZGV9ID0gJHtyZW5kZXJfc3RhdGVtZW50fTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyZW50X25vZGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGFwcGVuZCA9IGIgYEBhcHBlbmQoJHtwYXJlbnRfbm9kZX0sICR7bm9kZX0pO2A7XG4gICAgICAgICAgICBhcHBlbmRbMF0uZXhwcmVzc2lvbi5jYWxsZWUubG9jID0ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiB0aGlzLnJlbmRlcmVyLmxvY2F0ZSh0aGlzLm5vZGUuc3RhcnQpLFxuICAgICAgICAgICAgICAgIGVuZDogdGhpcy5yZW5kZXJlci5sb2NhdGUodGhpcy5ub2RlLmVuZClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChhcHBlbmQpO1xuICAgICAgICAgICAgaWYgKGlzX2hlYWQocGFyZW50X25vZGUpKSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLmRlc3Ryb3kucHVzaChiIGBAZGV0YWNoKCR7bm9kZX0pO2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgaW5zZXJ0ID0gYiBgQGluc2VydCgjdGFyZ2V0LCAke25vZGV9LCAjYW5jaG9yKTtgO1xuICAgICAgICAgICAgaW5zZXJ0WzBdLmV4cHJlc3Npb24uY2FsbGVlLmxvYyA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogdGhpcy5yZW5kZXJlci5sb2NhdGUodGhpcy5ub2RlLnN0YXJ0KSxcbiAgICAgICAgICAgICAgICBlbmQ6IHRoaXMucmVuZGVyZXIubG9jYXRlKHRoaXMubm9kZS5lbmQpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goaW5zZXJ0KTtcbiAgICAgICAgICAgIC8vIFRPRE8gd2UgZXZlbnR1YWxseSBuZWVkIHRvIGNvbnNpZGVyIHdoYXQgaGFwcGVucyB0byBlbGVtZW50c1xuICAgICAgICAgICAgLy8gdGhhdCBiZWxvbmcgdG8gdGhlIHNhbWUgb3V0Z3JvdXAgYXMgYW4gb3V0cm9pbmcgZWxlbWVudC4uLlxuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmRlc3Ryb3kucHVzaChiIGBpZiAoZGV0YWNoaW5nKSBAZGV0YWNoKCR7bm9kZX0pO2ApO1xuICAgICAgICB9XG4gICAgICAgIC8vIGluc2VydCBzdGF0aWMgY2hpbGRyZW4gd2l0aCB0ZXh0Q29udGVudCBvciBpbm5lckhUTUxcbiAgICAgICAgLy8gc2tpcCB0ZXh0Y29udGVudCBmb3IgPHRlbXBsYXRlPi4gIGFwcGVuZCBub2RlcyB0byBUZW1wbGF0ZUVsZW1lbnQuY29udGVudCBpbnN0ZWFkXG4gICAgICAgIGNvbnN0IGNhbl91c2VfdGV4dGNvbnRlbnQgPSB0aGlzLmNhbl91c2VfdGV4dGNvbnRlbnQoKTtcbiAgICAgICAgY29uc3QgaXNfdGVtcGxhdGUgPSB0aGlzLm5vZGUubmFtZSA9PT0gJ3RlbXBsYXRlJztcbiAgICAgICAgY29uc3QgaXNfdGVtcGxhdGVfd2l0aF90ZXh0X2NvbnRlbnQgPSBpc190ZW1wbGF0ZSAmJiBjYW5fdXNlX3RleHRjb250ZW50O1xuICAgICAgICBpZiAoIWlzX3RlbXBsYXRlX3dpdGhfdGV4dF9jb250ZW50ICYmICF0aGlzLm5vZGUubmFtZXNwYWNlICYmICh0aGlzLmNhbl91c2VfaW5uZXJodG1sIHx8IGNhbl91c2VfdGV4dGNvbnRlbnQpICYmIHRoaXMuZnJhZ21lbnQubm9kZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZnJhZ21lbnQubm9kZXMubGVuZ3RoID09PSAxICYmIHRoaXMuZnJhZ21lbnQubm9kZXNbMF0ubm9kZS50eXBlID09PSAnVGV4dCcpIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuY3JlYXRlLnB1c2goYiBgJHtub2RlfS50ZXh0Q29udGVudCA9ICR7c3RyaW5nX2xpdGVyYWwodGhpcy5mcmFnbWVudC5ub2Rlc1swXS5kYXRhKX07YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgcXVhc2k6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdUZW1wbGF0ZUVsZW1lbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHsgcmF3OiAnJyB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpdGVyYWwgPSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdUZW1wbGF0ZUxpdGVyYWwnLFxuICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uczogW10sXG4gICAgICAgICAgICAgICAgICAgIHF1YXNpczogW11cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhbl91c2VfcmF3X3RleHQgPSAhdGhpcy5jYW5fdXNlX2lubmVyaHRtbCAmJiBjYW5fdXNlX3RleHRjb250ZW50O1xuICAgICAgICAgICAgICAgIHRvX2h0bWwodGhpcy5mcmFnbWVudC5ub2RlcywgYmxvY2ssIGxpdGVyYWwsIHN0YXRlLCBjYW5fdXNlX3Jhd190ZXh0KTtcbiAgICAgICAgICAgICAgICBsaXRlcmFsLnF1YXNpcy5wdXNoKHN0YXRlLnF1YXNpKTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuY3JlYXRlLnB1c2goYiBgJHtub2RlfS4ke3RoaXMuY2FuX3VzZV9pbm5lcmh0bWwgPyAnaW5uZXJIVE1MJyA6ICd0ZXh0Q29udGVudCd9ID0gJHtsaXRlcmFsfTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZnJhZ21lbnQubm9kZXMuZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgICAgICAgICAgICBjaGlsZC5yZW5kZXIoYmxvY2ssIGlzX3RlbXBsYXRlID8geCBgJHtub2RlfS5jb250ZW50YCA6IG5vZGUsIG5vZGVzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGV2ZW50X2hhbmRsZXJfb3JfYmluZGluZ191c2VzX2NvbnRleHQgPSAodGhpcy5iaW5kaW5ncy5zb21lKGJpbmRpbmcgPT4gYmluZGluZy5oYW5kbGVyLnVzZXNfY29udGV4dCkgfHxcbiAgICAgICAgICAgIHRoaXMubm9kZS5oYW5kbGVycy5zb21lKGhhbmRsZXIgPT4gaGFuZGxlci51c2VzX2NvbnRleHQpIHx8XG4gICAgICAgICAgICB0aGlzLm5vZGUuYWN0aW9ucy5zb21lKGFjdGlvbiA9PiBhY3Rpb24udXNlc19jb250ZXh0KSk7XG4gICAgICAgIGlmIChldmVudF9oYW5kbGVyX29yX2JpbmRpbmdfdXNlc19jb250ZXh0KSB7XG4gICAgICAgICAgICBibG9jay5tYWludGFpbl9jb250ZXh0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFkZF9hdHRyaWJ1dGVzKGJsb2NrKTtcbiAgICAgICAgdGhpcy5hZGRfZGlyZWN0aXZlc19pbl9vcmRlcihibG9jayk7XG4gICAgICAgIHRoaXMuYWRkX3RyYW5zaXRpb25zKGJsb2NrKTtcbiAgICAgICAgdGhpcy5hZGRfYW5pbWF0aW9uKGJsb2NrKTtcbiAgICAgICAgdGhpcy5hZGRfY2xhc3NlcyhibG9jayk7XG4gICAgICAgIHRoaXMuYWRkX3N0eWxlcyhibG9jayk7XG4gICAgICAgIHRoaXMuYWRkX21hbnVhbF9zdHlsZV9zY29waW5nKGJsb2NrKTtcbiAgICAgICAgaWYgKG5vZGVzICYmIHRoaXMucmVuZGVyZXIub3B0aW9ucy5oeWRyYXRhYmxlICYmICF0aGlzLnZvaWQpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5jbGFpbS5wdXNoKGIgYCR7dGhpcy5ub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDAgPyBub2RlcyA6IGNoaWxkcmVufS5mb3JFYWNoKEBkZXRhY2gpO2ApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZW5kZXJlci5vcHRpb25zLmRldikge1xuICAgICAgICAgICAgY29uc3QgbG9jID0gcmVuZGVyZXIubG9jYXRlKHRoaXMubm9kZS5zdGFydCk7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaHlkcmF0ZS5wdXNoKGIgYEBhZGRfbG9jYXRpb24oJHt0aGlzLnZhcn0sICR7cmVuZGVyZXIuZmlsZV92YXJ9LCAke2xvYy5saW5lIC0gMX0sICR7bG9jLmNvbHVtbn0sICR7dGhpcy5ub2RlLnN0YXJ0fSk7YCk7XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2sucmVuZGVyZXIuZGlydHkodGhpcy5ub2RlLnRhZ19leHByLmR5bmFtaWNfZGVwZW5kZW5jaWVzKCkpO1xuICAgIH1cbiAgICBjYW5fdXNlX3RleHRjb250ZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc19zdGF0aWNfY29udGVudCAmJiB0aGlzLmZyYWdtZW50Lm5vZGVzLmV2ZXJ5KG5vZGUgPT4gbm9kZS5ub2RlLnR5cGUgPT09ICdUZXh0JyB8fCBub2RlLm5vZGUudHlwZSA9PT0gJ011c3RhY2hlVGFnJyk7XG4gICAgfVxuICAgIGdldF9yZW5kZXJfc3RhdGVtZW50KGJsb2NrKSB7XG4gICAgICAgIGNvbnN0IHsgbmFtZSwgbmFtZXNwYWNlLCB0YWdfZXhwciB9ID0gdGhpcy5ub2RlO1xuICAgICAgICBjb25zdCByZWZlcmVuY2UgPSB0YWdfZXhwci5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgaWYgKG5hbWVzcGFjZSA9PT0gbmFtZXNwYWNlcy5zdmcpIHtcbiAgICAgICAgICAgIHJldHVybiB4IGBAc3ZnX2VsZW1lbnQoJHtyZWZlcmVuY2V9KWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hbWVzcGFjZSkge1xuICAgICAgICAgICAgcmV0dXJuIHggYEBfZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiJHtuYW1lc3BhY2V9XCIsIFwiJHtuYW1lfVwiKWA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXMgPSB0aGlzLmF0dHJpYnV0ZXMuZmluZChhdHRyID0+IGF0dHIubm9kZS5uYW1lID09PSAnaXMnKTtcbiAgICAgICAgaWYgKGlzKSB7XG4gICAgICAgICAgICByZXR1cm4geCBgQGVsZW1lbnRfaXMoXCIke25hbWV9XCIsICR7aXMucmVuZGVyX2NodW5rcyhibG9jaykucmVkdWNlKChsaHMsIHJocykgPT4geCBgJHtsaHN9ICsgJHtyaHN9YCl9KWA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHggYEBlbGVtZW50KCR7cmVmZXJlbmNlfSlgO1xuICAgIH1cbiAgICBnZXRfY2xhaW1fc3RhdGVtZW50KGJsb2NrLCBub2Rlcykge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzXG4gICAgICAgICAgICAuZmlsdGVyKChhdHRyKSA9PiAhKGF0dHIgaW5zdGFuY2VvZiBTcHJlYWRBdHRyaWJ1dGVXcmFwcGVyKSAmJiAhYXR0ci5wcm9wZXJ0eV9uYW1lKVxuICAgICAgICAgICAgLm1hcCgoYXR0cikgPT4gcCBgJHthdHRyLm5hbWV9OiB0cnVlYCk7XG4gICAgICAgIGxldCByZWZlcmVuY2U7XG4gICAgICAgIGlmICh0aGlzLm5vZGUudGFnX2V4cHIubm9kZS50eXBlID09PSAnTGl0ZXJhbCcpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGUubmFtZXNwYWNlKSB7XG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlID0gYFwiJHt0aGlzLm5vZGUudGFnX2V4cHIubm9kZS52YWx1ZX1cImA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2UgPSBgXCIkeyh0aGlzLm5vZGUudGFnX2V4cHIubm9kZS52YWx1ZSB8fCAnJykudG9VcHBlckNhc2UoKX1cImA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5ub2RlLm5hbWVzcGFjZSkge1xuICAgICAgICAgICAgcmVmZXJlbmNlID0geCBgJHt0aGlzLm5vZGUudGFnX2V4cHIubWFuaXB1bGF0ZShibG9jayl9YDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZSA9IHggYCgke3RoaXMubm9kZS50YWdfZXhwci5tYW5pcHVsYXRlKGJsb2NrKX0gfHwgJ251bGwnKS50b1VwcGVyQ2FzZSgpYDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ub2RlLm5hbWVzcGFjZSA9PT0gbmFtZXNwYWNlcy5zdmcpIHtcbiAgICAgICAgICAgIHJldHVybiB4IGBAY2xhaW1fc3ZnX2VsZW1lbnQoJHtub2Rlc30sICR7cmVmZXJlbmNlfSwgeyAke2F0dHJpYnV0ZXN9IH0pYDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB4IGBAY2xhaW1fZWxlbWVudCgke25vZGVzfSwgJHtyZWZlcmVuY2V9LCB7ICR7YXR0cmlidXRlc30gfSlgO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFkZF9kaXJlY3RpdmVzX2luX29yZGVyKGJsb2NrKSB7XG4gICAgICAgIGNvbnN0IGJpbmRpbmdfZ3JvdXBzID0gZXZlbnRzXG4gICAgICAgICAgICAubWFwKGV2ZW50ID0+ICh7XG4gICAgICAgICAgICBldmVudHM6IGV2ZW50LmV2ZW50X25hbWVzLFxuICAgICAgICAgICAgYmluZGluZ3M6IHRoaXMuYmluZGluZ3NcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGJpbmRpbmcgPT4gYmluZGluZy5ub2RlLm5hbWUgIT09ICd0aGlzJylcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGJpbmRpbmcgPT4gZXZlbnQuZmlsdGVyKHRoaXMubm9kZSwgYmluZGluZy5ub2RlLm5hbWUpKVxuICAgICAgICB9KSlcbiAgICAgICAgICAgIC5maWx0ZXIoZ3JvdXAgPT4gZ3JvdXAuYmluZGluZ3MubGVuZ3RoKTtcbiAgICAgICAgY29uc3QgdGhpc19iaW5kaW5nID0gdGhpcy5iaW5kaW5ncy5maW5kKGIgPT4gYi5ub2RlLm5hbWUgPT09ICd0aGlzJyk7XG4gICAgICAgIGZ1bmN0aW9uIGdldE9yZGVyKGl0ZW0pIHtcbiAgICAgICAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgRXZlbnRIYW5kbGVyV3JhcHBlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLm5vZGUuc3RhcnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpdGVtIGluc3RhbmNlb2YgQmluZGluZ1dyYXBwZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5ub2RlLnN0YXJ0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXRlbSBpbnN0YW5jZW9mIEFjdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnN0YXJ0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uYmluZGluZ3NbMF0ubm9kZS5zdGFydDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBbXG4gICAgICAgICAgICAuLi5iaW5kaW5nX2dyb3VwcyxcbiAgICAgICAgICAgIC4uLnRoaXMuZXZlbnRfaGFuZGxlcnMsXG4gICAgICAgICAgICB0aGlzX2JpbmRpbmcsXG4gICAgICAgICAgICAuLi50aGlzLm5vZGUuYWN0aW9uc1xuICAgICAgICBdXG4gICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gZ2V0T3JkZXIoYSkgLSBnZXRPcmRlcihiKSlcbiAgICAgICAgICAgIC5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBFdmVudEhhbmRsZXJXcmFwcGVyKSB7XG4gICAgICAgICAgICAgICAgYWRkX2V2ZW50X2hhbmRsZXIoYmxvY2ssIHRoaXMudmFyLCBpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gaW5zdGFuY2VvZiBCaW5kaW5nV3JhcHBlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkX3RoaXNfYmluZGluZyhibG9jaywgaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpdGVtIGluc3RhbmNlb2YgQWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgYWRkX2FjdGlvbihibG9jaywgdGhpcy52YXIsIGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRfYmluZGluZ3MoYmxvY2ssIGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWRkX2JpbmRpbmdzKGJsb2NrLCBiaW5kaW5nX2dyb3VwKSB7XG4gICAgICAgIGNvbnN0IHsgcmVuZGVyZXIgfSA9IHRoaXM7XG4gICAgICAgIGlmIChiaW5kaW5nX2dyb3VwLmJpbmRpbmdzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgcmVuZGVyZXIuY29tcG9uZW50Lmhhc19yZWFjdGl2ZV9hc3NpZ25tZW50cyA9IHRydWU7XG4gICAgICAgIGNvbnN0IGxvY2sgPSBiaW5kaW5nX2dyb3VwLmJpbmRpbmdzLnNvbWUoYmluZGluZyA9PiBiaW5kaW5nLm5lZWRzX2xvY2spID9cbiAgICAgICAgICAgIGJsb2NrLmdldF91bmlxdWVfbmFtZShgJHt0aGlzLnZhci5uYW1lfV91cGRhdGluZ2ApIDpcbiAgICAgICAgICAgIG51bGw7XG4gICAgICAgIGlmIChsb2NrKVxuICAgICAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKGxvY2ssIHggYGZhbHNlYCk7XG4gICAgICAgIGNvbnN0IGhhbmRsZXIgPSByZW5kZXJlci5jb21wb25lbnQuZ2V0X3VuaXF1ZV9uYW1lKGAke3RoaXMudmFyLm5hbWV9XyR7YmluZGluZ19ncm91cC5ldmVudHMuam9pbignXycpfV9oYW5kbGVyYCk7XG4gICAgICAgIHJlbmRlcmVyLmFkZF90b19jb250ZXh0KGhhbmRsZXIubmFtZSk7XG4gICAgICAgIC8vIFRPRE8gZmlndXJlIG91dCBob3cgdG8gaGFuZGxlIGxvY2tzXG4gICAgICAgIGNvbnN0IG5lZWRzX2xvY2sgPSBiaW5kaW5nX2dyb3VwLmJpbmRpbmdzLnNvbWUoYmluZGluZyA9PiBiaW5kaW5nLm5lZWRzX2xvY2spO1xuICAgICAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIGNvbnN0IGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzID0gbmV3IFNldCgpO1xuICAgICAgICBiaW5kaW5nX2dyb3VwLmJpbmRpbmdzLmZvckVhY2goYmluZGluZyA9PiB7XG4gICAgICAgICAgICAvLyBUT0RPIHRoaXMgaXMgYSBtZXNzXG4gICAgICAgICAgICBhZGRfdG9fc2V0KGRlcGVuZGVuY2llcywgYmluZGluZy5nZXRfdXBkYXRlX2RlcGVuZGVuY2llcygpKTtcbiAgICAgICAgICAgIGFkZF90b19zZXQoY29udGV4dHVhbF9kZXBlbmRlbmNpZXMsIGJpbmRpbmcuaGFuZGxlci5jb250ZXh0dWFsX2RlcGVuZGVuY2llcyk7XG4gICAgICAgICAgICBiaW5kaW5nLnJlbmRlcihibG9jaywgbG9jayk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBtZWRpYSBiaW5kaW5ncyDigJQgYXdrd2FyZCBzcGVjaWFsIGNhc2UuIFRoZSBuYXRpdmUgdGltZXVwZGF0ZSBldmVudHNcbiAgICAgICAgLy8gZmlyZSB0b28gaW5mcmVxdWVudGx5LCBzbyB3ZSBuZWVkIHRvIHRha2UgbWF0dGVycyBpbnRvIG91clxuICAgICAgICAvLyBvd24gaGFuZHNcbiAgICAgICAgbGV0IGFuaW1hdGlvbl9mcmFtZTtcbiAgICAgICAgaWYgKGJpbmRpbmdfZ3JvdXAuZXZlbnRzWzBdID09PSAndGltZXVwZGF0ZScpIHtcbiAgICAgICAgICAgIGFuaW1hdGlvbl9mcmFtZSA9IGJsb2NrLmdldF91bmlxdWVfbmFtZShgJHt0aGlzLnZhci5uYW1lfV9hbmltYXRpb25mcmFtZWApO1xuICAgICAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKGFuaW1hdGlvbl9mcmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGFzX2xvY2FsX2Z1bmN0aW9uID0gY29udGV4dHVhbF9kZXBlbmRlbmNpZXMuc2l6ZSA+IDAgfHwgbmVlZHNfbG9jayB8fCBhbmltYXRpb25fZnJhbWU7XG4gICAgICAgIGxldCBjYWxsZWUgPSByZW5kZXJlci5yZWZlcmVuY2UoaGFuZGxlcik7XG4gICAgICAgIC8vIFRPRE8gZHJ5IHRoaXMgb3V0IOKAlCBzaW1pbGFyIGNvZGUgZm9yIGV2ZW50IGhhbmRsZXJzIGFuZCBjb21wb25lbnQgYmluZGluZ3NcbiAgICAgICAgaWYgKGhhc19sb2NhbF9mdW5jdGlvbikge1xuICAgICAgICAgICAgY29uc3QgYXJncyA9IEFycmF5LmZyb20oY29udGV4dHVhbF9kZXBlbmRlbmNpZXMpLm1hcChuYW1lID0+IHJlbmRlcmVyLnJlZmVyZW5jZShuYW1lKSk7XG4gICAgICAgICAgICAvLyBuZWVkIHRvIGNyZWF0ZSBhIGJsb2NrLWxvY2FsIGZ1bmN0aW9uIHRoYXQgY2FsbHMgYW4gaW5zdGFuY2UtbGV2ZWwgZnVuY3Rpb25cbiAgICAgICAgICAgIGlmIChhbmltYXRpb25fZnJhbWUpIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0XHRcdGZ1bmN0aW9uICR7aGFuZGxlcn0oKSB7XG5cdFx0XHRcdFx0XHRAX2NhbmNlbEFuaW1hdGlvbkZyYW1lKCR7YW5pbWF0aW9uX2ZyYW1lfSk7XG5cdFx0XHRcdFx0XHRpZiAoISR7dGhpcy52YXJ9LnBhdXNlZCkge1xuXHRcdFx0XHRcdFx0XHQke2FuaW1hdGlvbl9mcmFtZX0gPSBAcmFmKCR7aGFuZGxlcn0pO1xuXHRcdFx0XHRcdFx0XHQke25lZWRzX2xvY2sgJiYgYiBgJHtsb2NrfSA9IHRydWU7YH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdCR7Y2FsbGVlfS5jYWxsKCR7dGhpcy52YXJ9LCAke2FyZ3N9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdFx0XHRmdW5jdGlvbiAke2hhbmRsZXJ9KCkge1xuXHRcdFx0XHRcdFx0JHtuZWVkc19sb2NrICYmIGIgYCR7bG9ja30gPSB0cnVlO2B9XG5cdFx0XHRcdFx0XHQke2NhbGxlZX0uY2FsbCgke3RoaXMudmFyfSwgJHthcmdzfSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhbGxlZSA9IGhhbmRsZXI7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcGFyYW1zID0gQXJyYXkuZnJvbShjb250ZXh0dWFsX2RlcGVuZGVuY2llcykubWFwKG5hbWUgPT4gKHtcbiAgICAgICAgICAgIHR5cGU6ICdJZGVudGlmaWVyJyxcbiAgICAgICAgICAgIG5hbWVcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmNvbXBvbmVudC5wYXJ0bHlfaG9pc3RlZC5wdXNoKGIgYFxuXHRcdFx0ZnVuY3Rpb24gJHtoYW5kbGVyfSgke3BhcmFtc30pIHtcblx0XHRcdFx0JHtiaW5kaW5nX2dyb3VwLmJpbmRpbmdzLm1hcChiID0+IGIuaGFuZGxlci5tdXRhdGlvbil9XG5cdFx0XHRcdCR7QXJyYXkuZnJvbShkZXBlbmRlbmNpZXMpXG4gICAgICAgICAgICAuZmlsdGVyKGRlcCA9PiBkZXBbMF0gIT09ICckJylcbiAgICAgICAgICAgIC5maWx0ZXIoZGVwID0+ICFjb250ZXh0dWFsX2RlcGVuZGVuY2llcy5oYXMoZGVwKSlcbiAgICAgICAgICAgIC5tYXAoZGVwID0+IGIgYCR7dGhpcy5yZW5kZXJlci5pbnZhbGlkYXRlKGRlcCl9O2ApfVxuXHRcdFx0fVxuXHRcdGApO1xuICAgICAgICBiaW5kaW5nX2dyb3VwLmV2ZW50cy5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdlbGVtZW50cmVzaXplJykge1xuICAgICAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZVxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc2l6ZV9saXN0ZW5lciA9IGJsb2NrLmdldF91bmlxdWVfbmFtZShgJHt0aGlzLnZhci5uYW1lfV9yZXNpemVfbGlzdGVuZXJgKTtcbiAgICAgICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUocmVzaXplX2xpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGAke3Jlc2l6ZV9saXN0ZW5lcn0gPSBAYWRkX3Jlc2l6ZV9saXN0ZW5lcigke3RoaXMudmFyfSwgJHtjYWxsZWV9LmJpbmQoJHt0aGlzLnZhcn0pKTtgKTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuZGVzdHJveS5wdXNoKGIgYCR7cmVzaXplX2xpc3RlbmVyfSgpO2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYmxvY2suZXZlbnRfbGlzdGVuZXJzLnB1c2goeCBgQGxpc3Rlbigke3RoaXMudmFyfSwgXCIke25hbWV9XCIsICR7Y2FsbGVlfSlgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHNvbWVfaW5pdGlhbF9zdGF0ZV9pc191bmRlZmluZWQgPSBiaW5kaW5nX2dyb3VwLmJpbmRpbmdzXG4gICAgICAgICAgICAubWFwKGJpbmRpbmcgPT4geCBgJHtiaW5kaW5nLnNuaXBwZXR9ID09PSB2b2lkIDBgKVxuICAgICAgICAgICAgLnJlZHVjZSgobGhzLCByaHMpID0+IHggYCR7bGhzfSB8fCAke3Joc31gKTtcbiAgICAgICAgY29uc3Qgc2hvdWxkX2luaXRpYWxpc2UgPSAodGhpcy5ub2RlLm5hbWUgPT09ICdzZWxlY3QnIHx8XG4gICAgICAgICAgICBiaW5kaW5nX2dyb3VwLmJpbmRpbmdzLmZpbmQoYmluZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChiaW5kaW5nLm5vZGUubmFtZSA9PT0gJ2luZGV0ZXJtaW5hdGUnIHx8XG4gICAgICAgICAgICAgICAgICAgIGJpbmRpbmcubm9kZS5uYW1lID09PSAndGV4dENvbnRlbnQnIHx8XG4gICAgICAgICAgICAgICAgICAgIGJpbmRpbmcubm9kZS5uYW1lID09PSAnaW5uZXJIVE1MJyB8fFxuICAgICAgICAgICAgICAgICAgICBiaW5kaW5nLmlzX3JlYWRvbmx5X21lZGlhX2F0dHJpYnV0ZSgpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgaWYgKHNob3VsZF9pbml0aWFsaXNlKSB7XG4gICAgICAgICAgICBjb25zdCBjYWxsYmFjayA9IGhhc19sb2NhbF9mdW5jdGlvbiA/IGhhbmRsZXIgOiB4IGAoKSA9PiAke2NhbGxlZX0uY2FsbCgke3RoaXMudmFyfSlgO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmh5ZHJhdGUucHVzaChiIGBpZiAoJHtzb21lX2luaXRpYWxfc3RhdGVfaXNfdW5kZWZpbmVkfSkgQGFkZF9yZW5kZXJfY2FsbGJhY2soJHtjYWxsYmFja30pO2ApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiaW5kaW5nX2dyb3VwLmV2ZW50c1swXSA9PT0gJ2VsZW1lbnRyZXNpemUnKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaHlkcmF0ZS5wdXNoKGIgYEBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+ICR7Y2FsbGVlfS5jYWxsKCR7dGhpcy52YXJ9KSk7YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxvY2spIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGAke2xvY2t9ID0gZmFsc2U7YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkX3RoaXNfYmluZGluZyhibG9jaywgdGhpc19iaW5kaW5nKSB7XG4gICAgICAgIGNvbnN0IHsgcmVuZGVyZXIgfSA9IHRoaXM7XG4gICAgICAgIHJlbmRlcmVyLmNvbXBvbmVudC5oYXNfcmVhY3RpdmVfYXNzaWdubWVudHMgPSB0cnVlO1xuICAgICAgICBjb25zdCBiaW5kaW5nX2NhbGxiYWNrID0gYmluZF90aGlzKHJlbmRlcmVyLmNvbXBvbmVudCwgYmxvY2ssIHRoaXNfYmluZGluZywgdGhpcy52YXIpO1xuICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiaW5kaW5nX2NhbGxiYWNrKTtcbiAgICB9XG4gICAgYWRkX2F0dHJpYnV0ZXMoYmxvY2spIHtcbiAgICAgICAgLy8gR2V0IGFsbCB0aGUgY2xhc3MgZGVwZW5kZW5jaWVzIGZpcnN0XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcy5mb3JFYWNoKChhdHRyaWJ1dGUpID0+IHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubm9kZS5uYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzID0gYXR0cmlidXRlLm5vZGUuZ2V0X2RlcGVuZGVuY2llcygpO1xuICAgICAgICAgICAgICAgIHB1c2hfYXJyYXkkMSh0aGlzLmNsYXNzX2RlcGVuZGVuY2llcywgZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLm5vZGUuYXR0cmlidXRlcy5zb21lKGF0dHIgPT4gYXR0ci5pc19zcHJlYWQpIHx8IHRoaXMubm9kZS5pc19keW5hbWljX2VsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkX3NwcmVhZF9hdHRyaWJ1dGVzKGJsb2NrKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuZm9yRWFjaCgoYXR0cmlidXRlKSA9PiB7XG4gICAgICAgICAgICBhdHRyaWJ1dGUucmVuZGVyKGJsb2NrKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFkZF9zcHJlYWRfYXR0cmlidXRlcyhibG9jaykge1xuICAgICAgICBjb25zdCBsZXZlbHMgPSBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7dGhpcy52YXIubmFtZX1fbGV2ZWxzYCk7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7dGhpcy52YXIubmFtZX1fZGF0YWApO1xuICAgICAgICBjb25zdCBpbml0aWFsX3Byb3BzID0gW107XG4gICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzXG4gICAgICAgICAgICAuZm9yRWFjaChhdHRyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IGF0dHIubm9kZS5nZXRfZGVwZW5kZW5jaWVzKCk7XG4gICAgICAgICAgICBjb25zdCBjb25kaXRpb24gPSBkZXBlbmRlbmNpZXMubGVuZ3RoID4gMFxuICAgICAgICAgICAgICAgID8gYmxvY2sucmVuZGVyZXIuZGlydHkoZGVwZW5kZW5jaWVzKVxuICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgIGlmIChhdHRyIGluc3RhbmNlb2YgU3ByZWFkQXR0cmlidXRlV3JhcHBlcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNuaXBwZXQgPSBhdHRyLm5vZGUuZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgICAgICBpbml0aWFsX3Byb3BzLnB1c2goc25pcHBldCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKGNvbmRpdGlvbiA/IHggYCR7Y29uZGl0aW9ufSAmJiAke3NuaXBwZXR9YCA6IHNuaXBwZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGF0dHIucHJvcGVydHlfbmFtZSB8fCBhdHRyLm5hbWU7XG4gICAgICAgICAgICAgICAgaW5pdGlhbF9wcm9wcy5wdXNoKHggYHsgJHtuYW1lfTogJHthdHRyLmdldF9pbml0KGJsb2NrLCBhdHRyLmdldF92YWx1ZShibG9jaykpfSB9YCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc25pcHBldCA9IHggYHsgJHtuYW1lfTogJHthdHRyLnNob3VsZF9jYWNoZSA/IGF0dHIubGFzdCA6IGF0dHIuZ2V0X3ZhbHVlKGJsb2NrKX0gfWA7XG4gICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKGNvbmRpdGlvbiA/IHggYCR7YXR0ci5nZXRfZG9tX3VwZGF0ZV9jb25kaXRpb25zKGJsb2NrLCBjb25kaXRpb24pfSAmJiAke3NuaXBwZXR9YCA6IHNuaXBwZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdGxldCAke2xldmVsc30gPSBbJHtpbml0aWFsX3Byb3BzfV07XG5cblx0XHRcdGxldCAke2RhdGF9ID0ge307XG5cdFx0XHRmb3IgKGxldCAjaSA9IDA7ICNpIDwgJHtsZXZlbHN9Lmxlbmd0aDsgI2kgKz0gMSkge1xuXHRcdFx0XHQke2RhdGF9ID0gQGFzc2lnbigke2RhdGF9LCAke2xldmVsc31bI2ldKTtcblx0XHRcdH1cblx0XHRgKTtcbiAgICAgICAgY29uc3QgZm4gPSB0aGlzLm5vZGUubmFtZXNwYWNlID09PSBuYW1lc3BhY2VzLnN2ZyA/IHggYEBzZXRfc3ZnX2F0dHJpYnV0ZXNgIDogeCBgQHNldF9hdHRyaWJ1dGVzYDtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5pc19keW5hbWljX2VsZW1lbnQpIHtcbiAgICAgICAgICAgIC8vIGNhbGwgYXR0cmlidXRlIGJpbmRpbmdzIGZvciBjdXN0b20gZWxlbWVudCBpZiB0YWcgaXMgY3VzdG9tIGVsZW1lbnRcbiAgICAgICAgICAgIGNvbnN0IHRhZyA9IHRoaXMubm9kZS50YWdfZXhwci5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJfdXBkYXRlID0gdGhpcy5ub2RlLm5hbWVzcGFjZSA9PT0gbmFtZXNwYWNlcy5zdmdcbiAgICAgICAgICAgICAgICA/IGIgYCR7Zm59KCR7dGhpcy52YXJ9LCAke2RhdGF9KTtgXG4gICAgICAgICAgICAgICAgOiBiIGBcblx0XHRcdFx0XHRpZiAoLy0vLnRlc3QoJHt0YWd9KSkge1xuXHRcdFx0XHRcdFx0QHNldF9jdXN0b21fZWxlbWVudF9kYXRhX21hcCgke3RoaXMudmFyfSwgJHtkYXRhfSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdCR7Zm59KCR7dGhpcy52YXJ9LCAke2RhdGF9KTtcblx0XHRcdFx0XHR9YDtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5oeWRyYXRlLnB1c2goYXR0cl91cGRhdGUpO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHQke2RhdGF9ID0gQGdldF9zcHJlYWRfdXBkYXRlKCR7bGV2ZWxzfSwgWyR7dXBkYXRlc31dKTtcblx0XHRcdFx0JHthdHRyX3VwZGF0ZX1gKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5oeWRyYXRlLnB1c2goYiBgJHtmbn0oJHt0aGlzLnZhcn0sICR7ZGF0YX0pO2ApO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHQke2ZufSgke3RoaXMudmFyfSwgJHtkYXRhfSA9IEBnZXRfc3ByZWFkX3VwZGF0ZSgke2xldmVsc30sIFtcblx0XHRcdFx0XHQke3VwZGF0ZXN9XG5cdFx0XHRcdF0pKTtcblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIC8vIGhhbmRsZSBlZGdlIGNhc2VzIGZvciBlbGVtZW50c1xuICAgICAgICBpZiAodGhpcy5ub2RlLm5hbWUgPT09ICdzZWxlY3QnKSB7XG4gICAgICAgICAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHIgb2YgdGhpcy5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBkZXAgb2YgYXR0ci5ub2RlLmRlcGVuZGVuY2llcykge1xuICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbmNpZXMuYWRkKGRlcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goYiBgXG5cdFx0XHRcdCgke2RhdGF9Lm11bHRpcGxlID8gQHNlbGVjdF9vcHRpb25zIDogQHNlbGVjdF9vcHRpb24pKCR7dGhpcy52YXJ9LCAke2RhdGF9LnZhbHVlKTtcblx0XHRcdGApO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRpZiAoJHtibG9jay5yZW5kZXJlci5kaXJ0eShBcnJheS5mcm9tKGRlcGVuZGVuY2llcykpfSAmJiAndmFsdWUnIGluICR7ZGF0YX0pICgke2RhdGF9Lm11bHRpcGxlID8gQHNlbGVjdF9vcHRpb25zIDogQHNlbGVjdF9vcHRpb24pKCR7dGhpcy52YXJ9LCAke2RhdGF9LnZhbHVlKTtcblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMubm9kZS5uYW1lID09PSAnaW5wdXQnICYmIHRoaXMuYXR0cmlidXRlcy5maW5kKGF0dHIgPT4gYXR0ci5ub2RlLm5hbWUgPT09ICd2YWx1ZScpKSB7XG4gICAgICAgICAgICBjb25zdCB0eXBlID0gdGhpcy5ub2RlLmdldF9zdGF0aWNfYXR0cmlidXRlX3ZhbHVlKCd0eXBlJyk7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gbnVsbCB8fCB0eXBlID09PSAnJyB8fCB0eXBlID09PSAndGV4dCcgfHwgdHlwZSA9PT0gJ2VtYWlsJyB8fCB0eXBlID09PSAncGFzc3dvcmQnKSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goYiBgXG5cdFx0XHRcdFx0JHt0aGlzLnZhcn0udmFsdWUgPSAke2RhdGF9LnZhbHVlO1xuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRcdFx0aWYgKCd2YWx1ZScgaW4gJHtkYXRhfSkge1xuXHRcdFx0XHRcdFx0JHt0aGlzLnZhcn0udmFsdWUgPSAke2RhdGF9LnZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFsnYnV0dG9uJywgJ2lucHV0JywgJ2tleWdlbicsICdzZWxlY3QnLCAndGV4dGFyZWEnXS5pbmNsdWRlcyh0aGlzLm5vZGUubmFtZSkpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5tb3VudC5wdXNoKGIgYFxuXHRcdFx0XHRpZiAoJHt0aGlzLnZhcn0uYXV0b2ZvY3VzKSAke3RoaXMudmFyfS5mb2N1cygpO1xuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkX3RyYW5zaXRpb25zKGJsb2NrKSB7XG4gICAgICAgIGNvbnN0IHsgaW50cm8sIG91dHJvIH0gPSB0aGlzLm5vZGU7XG4gICAgICAgIGlmICghaW50cm8gJiYgIW91dHJvKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoaW50cm8gPT09IG91dHJvKSB7XG4gICAgICAgICAgICAvLyBiaWRpcmVjdGlvbmFsIHRyYW5zaXRpb25cbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7dGhpcy52YXIubmFtZX1fdHJhbnNpdGlvbmApO1xuICAgICAgICAgICAgY29uc3Qgc25pcHBldCA9IGludHJvLmV4cHJlc3Npb25cbiAgICAgICAgICAgICAgICA/IGludHJvLmV4cHJlc3Npb24ubWFuaXB1bGF0ZShibG9jaylcbiAgICAgICAgICAgICAgICA6IHggYHt9YDtcbiAgICAgICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShuYW1lKTtcbiAgICAgICAgICAgIGNvbnN0IGZuID0gdGhpcy5yZW5kZXJlci5yZWZlcmVuY2UoaW50cm8ubmFtZSk7XG4gICAgICAgICAgICBjb25zdCBpbnRyb19ibG9jayA9IGIgYFxuXHRcdFx0XHRAYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiB7XG5cdFx0XHRcdFx0aWYgKCEke25hbWV9KSAke25hbWV9ID0gQGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24oJHt0aGlzLnZhcn0sICR7Zm59LCAke3NuaXBwZXR9LCB0cnVlKTtcblx0XHRcdFx0XHQke25hbWV9LnJ1bigxKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRgO1xuICAgICAgICAgICAgY29uc3Qgb3V0cm9fYmxvY2sgPSBiIGBcblx0XHRcdFx0aWYgKCEke25hbWV9KSAke25hbWV9ID0gQGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24oJHt0aGlzLnZhcn0sICR7Zm59LCAke3NuaXBwZXR9LCBmYWxzZSk7XG5cdFx0XHRcdCR7bmFtZX0ucnVuKDApO1xuXHRcdFx0YDtcbiAgICAgICAgICAgIGlmIChpbnRyby5pc19sb2NhbCkge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbnRyby5wdXNoKGIgYFxuXHRcdFx0XHRcdGlmICgjbG9jYWwpIHtcblx0XHRcdFx0XHRcdCR7aW50cm9fYmxvY2t9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3Mub3V0cm8ucHVzaChiIGBcblx0XHRcdFx0XHRpZiAoI2xvY2FsKSB7XG5cdFx0XHRcdFx0XHQke291dHJvX2Jsb2NrfVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuaW50cm8ucHVzaChpbnRyb19ibG9jayk7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLm91dHJvLnB1c2gob3V0cm9fYmxvY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmRlc3Ryb3kucHVzaChiIGBpZiAoZGV0YWNoaW5nICYmICR7bmFtZX0pICR7bmFtZX0uZW5kKCk7YCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBpbnRyb19uYW1lID0gaW50cm8gJiYgYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke3RoaXMudmFyLm5hbWV9X2ludHJvYCk7XG4gICAgICAgICAgICBjb25zdCBvdXRyb19uYW1lID0gb3V0cm8gJiYgYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke3RoaXMudmFyLm5hbWV9X291dHJvYCk7XG4gICAgICAgICAgICBpZiAoaW50cm8pIHtcbiAgICAgICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUoaW50cm9fbmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc25pcHBldCA9IGludHJvLmV4cHJlc3Npb25cbiAgICAgICAgICAgICAgICAgICAgPyBpbnRyby5leHByZXNzaW9uLm1hbmlwdWxhdGUoYmxvY2spXG4gICAgICAgICAgICAgICAgICAgIDogeCBge31gO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZuID0gdGhpcy5yZW5kZXJlci5yZWZlcmVuY2UoaW50cm8ubmFtZSk7XG4gICAgICAgICAgICAgICAgbGV0IGludHJvX2Jsb2NrO1xuICAgICAgICAgICAgICAgIGlmIChvdXRybykge1xuICAgICAgICAgICAgICAgICAgICBpbnRyb19ibG9jayA9IGIgYFxuXHRcdFx0XHRcdFx0QGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRpZiAoJHtvdXRyb19uYW1lfSkgJHtvdXRyb19uYW1lfS5lbmQoMSk7XG5cdFx0XHRcdFx0XHRcdCR7aW50cm9fbmFtZX0gPSBAY3JlYXRlX2luX3RyYW5zaXRpb24oJHt0aGlzLnZhcn0sICR7Zm59LCAke3NuaXBwZXR9KTtcblx0XHRcdFx0XHRcdFx0JHtpbnRyb19uYW1lfS5zdGFydCgpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0YDtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLm91dHJvLnB1c2goYiBgaWYgKCR7aW50cm9fbmFtZX0pICR7aW50cm9fbmFtZX0uaW52YWxpZGF0ZSgpO2ApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaW50cm9fYmxvY2sgPSBiIGBcblx0XHRcdFx0XHRcdGlmICghJHtpbnRyb19uYW1lfSkge1xuXHRcdFx0XHRcdFx0XHRAYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0JHtpbnRyb19uYW1lfSA9IEBjcmVhdGVfaW5fdHJhbnNpdGlvbigke3RoaXMudmFyfSwgJHtmbn0sICR7c25pcHBldH0pO1xuXHRcdFx0XHRcdFx0XHRcdCR7aW50cm9fbmFtZX0uc3RhcnQoKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGludHJvLmlzX2xvY2FsKSB7XG4gICAgICAgICAgICAgICAgICAgIGludHJvX2Jsb2NrID0gYiBgXG5cdFx0XHRcdFx0XHRpZiAoI2xvY2FsKSB7XG5cdFx0XHRcdFx0XHRcdCR7aW50cm9fYmxvY2t9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLmludHJvLnB1c2goaW50cm9fYmxvY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG91dHJvKSB7XG4gICAgICAgICAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKG91dHJvX25hbWUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNuaXBwZXQgPSBvdXRyby5leHByZXNzaW9uXG4gICAgICAgICAgICAgICAgICAgID8gb3V0cm8uZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKVxuICAgICAgICAgICAgICAgICAgICA6IHggYHt9YDtcbiAgICAgICAgICAgICAgICBjb25zdCBmbiA9IHRoaXMucmVuZGVyZXIucmVmZXJlbmNlKG91dHJvLm5hbWUpO1xuICAgICAgICAgICAgICAgIGlmICghaW50cm8pIHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLmludHJvLnB1c2goYiBgXG5cdFx0XHRcdFx0XHRpZiAoJHtvdXRyb19uYW1lfSkgJHtvdXRyb19uYW1lfS5lbmQoMSk7XG5cdFx0XHRcdFx0YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFRPRE8gaGlkZSBlbGVtZW50cyB0aGF0IGhhdmUgb3V0cm8nZCAodW5sZXNzIHRoZXkgYmVsb25nIHRvIGEgc3RpbGwtb3V0cm9pbmdcbiAgICAgICAgICAgICAgICAvLyBncm91cCkgcHJpb3IgdG8gdGhlaXIgcmVtb3ZhbCBmcm9tIHRoZSBET01cbiAgICAgICAgICAgICAgICBsZXQgb3V0cm9fYmxvY2sgPSBiIGBcblx0XHRcdFx0XHQke291dHJvX25hbWV9ID0gQGNyZWF0ZV9vdXRfdHJhbnNpdGlvbigke3RoaXMudmFyfSwgJHtmbn0sICR7c25pcHBldH0pO1xuXHRcdFx0XHRgO1xuICAgICAgICAgICAgICAgIGlmIChvdXRyby5pc19sb2NhbCkge1xuICAgICAgICAgICAgICAgICAgICBvdXRyb19ibG9jayA9IGIgYFxuXHRcdFx0XHRcdFx0aWYgKCNsb2NhbCkge1xuXHRcdFx0XHRcdFx0XHQke291dHJvX2Jsb2NrfVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5vdXRyby5wdXNoKG91dHJvX2Jsb2NrKTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuZGVzdHJveS5wdXNoKGIgYGlmIChkZXRhY2hpbmcgJiYgJHtvdXRyb19uYW1lfSkgJHtvdXRyb19uYW1lfS5lbmQoKTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoKGludHJvICYmIGludHJvLmV4cHJlc3Npb24gJiYgaW50cm8uZXhwcmVzc2lvbi5kZXBlbmRlbmNpZXMuc2l6ZSkgfHwgKG91dHJvICYmIG91dHJvLmV4cHJlc3Npb24gJiYgb3V0cm8uZXhwcmVzc2lvbi5kZXBlbmRlbmNpZXMuc2l6ZSkpIHtcbiAgICAgICAgICAgIGJsb2NrLm1haW50YWluX2NvbnRleHQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFkZF9hbmltYXRpb24oYmxvY2spIHtcbiAgICAgICAgaWYgKCF0aGlzLm5vZGUuYW5pbWF0aW9uKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCB7IG91dHJvIH0gPSB0aGlzLm5vZGU7XG4gICAgICAgIGNvbnN0IHJlY3QgPSBibG9jay5nZXRfdW5pcXVlX25hbWUoJ3JlY3QnKTtcbiAgICAgICAgY29uc3Qgc3RvcF9hbmltYXRpb24gPSBibG9jay5nZXRfdW5pcXVlX25hbWUoJ3N0b3BfYW5pbWF0aW9uJyk7XG4gICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShyZWN0KTtcbiAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKHN0b3BfYW5pbWF0aW9uLCB4IGBAbm9vcGApO1xuICAgICAgICBibG9jay5jaHVua3MubWVhc3VyZS5wdXNoKGIgYFxuXHRcdFx0JHtyZWN0fSA9ICR7dGhpcy52YXJ9LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdGApO1xuICAgICAgICBpZiAoYmxvY2sudHlwZSA9PT0gQ0hJTERfRFlOQU1JQ19FTEVNRU5UX0JMT0NLKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MubWVhc3VyZS5wdXNoKGIgYHJldHVybiAke3JlY3R9YCk7XG4gICAgICAgICAgICBibG9jay5jaHVua3MucmVzdG9yZV9tZWFzdXJlbWVudHMucHVzaChiIGAke3JlY3R9ID0gI21lYXN1cmVtZW50O2ApO1xuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmNodW5rcy5maXgucHVzaChiIGBcblx0XHRcdEBmaXhfcG9zaXRpb24oJHt0aGlzLnZhcn0pO1xuXHRcdFx0JHtzdG9wX2FuaW1hdGlvbn0oKTtcblx0XHRcdCR7b3V0cm8gJiYgYiBgQGFkZF90cmFuc2Zvcm0oJHt0aGlzLnZhcn0sICR7cmVjdH0pO2B9XG5cdFx0YCk7XG4gICAgICAgIGxldCBwYXJhbXM7XG4gICAgICAgIGlmICh0aGlzLm5vZGUuYW5pbWF0aW9uLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHBhcmFtcyA9IHRoaXMubm9kZS5hbmltYXRpb24uZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGUuYW5pbWF0aW9uLmV4cHJlc3Npb24uZHluYW1pY19kZXBlbmRlbmNpZXMoKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBgcGFyYW1zYCBpcyBkeW5hbWljLCBjYWxjdWxhdGUgcGFyYW1zIGFoZWFkIG9mIHRpbWUgaW4gdGhlIGAucigpYCBtZXRob2RcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJhbXNfdmFyID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdwYXJhbXMnKTtcbiAgICAgICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUocGFyYW1zX3Zhcik7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1lYXN1cmUucHVzaChiIGAke3BhcmFtc192YXJ9ID0gJHtwYXJhbXN9O2ApO1xuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHBhcmFtc192YXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwYXJhbXMgPSB4IGB7fWA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMucmVuZGVyZXIucmVmZXJlbmNlKHRoaXMubm9kZS5hbmltYXRpb24ubmFtZSk7XG4gICAgICAgIGJsb2NrLmNodW5rcy5hbmltYXRlLnB1c2goYiBgXG5cdFx0XHQke3N0b3BfYW5pbWF0aW9ufSgpO1xuXHRcdFx0JHtzdG9wX2FuaW1hdGlvbn0gPSBAY3JlYXRlX2FuaW1hdGlvbigke3RoaXMudmFyfSwgJHtyZWN0fSwgJHtuYW1lfSwgJHtwYXJhbXN9KTtcblx0XHRgKTtcbiAgICB9XG4gICAgYWRkX2NsYXNzZXMoYmxvY2spIHtcbiAgICAgICAgY29uc3QgaGFzX3NwcmVhZCA9IHRoaXMubm9kZS5hdHRyaWJ1dGVzLnNvbWUoYXR0ciA9PiBhdHRyLmlzX3NwcmVhZCk7XG4gICAgICAgIHRoaXMubm9kZS5jbGFzc2VzLmZvckVhY2goY2xhc3NfZGlyZWN0aXZlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgZXhwcmVzc2lvbiwgbmFtZSB9ID0gY2xhc3NfZGlyZWN0aXZlO1xuICAgICAgICAgICAgbGV0IHNuaXBwZXQ7XG4gICAgICAgICAgICBsZXQgZGVwZW5kZW5jaWVzO1xuICAgICAgICAgICAgaWYgKGV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgICAgICBzbmlwcGV0ID0gZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgICAgICBkZXBlbmRlbmNpZXMgPSBleHByZXNzaW9uLmRlcGVuZGVuY2llcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNuaXBwZXQgPSBuYW1lO1xuICAgICAgICAgICAgICAgIGRlcGVuZGVuY2llcyA9IG5ldyBTZXQoW25hbWVdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXIgPSBiIGBAdG9nZ2xlX2NsYXNzKCR7dGhpcy52YXJ9LCBcIiR7bmFtZX1cIiwgJHtzbmlwcGV0fSk7YDtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5oeWRyYXRlLnB1c2godXBkYXRlcik7XG4gICAgICAgICAgICBpZiAoaGFzX3NwcmVhZCB8fCB0aGlzLm5vZGUuaXNfZHluYW1pY19lbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKHVwZGF0ZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoKGRlcGVuZGVuY2llcyAmJiBkZXBlbmRlbmNpZXMuc2l6ZSA+IDApIHx8IHRoaXMuY2xhc3NfZGVwZW5kZW5jaWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsbF9kZXBlbmRlbmNpZXMgPSB0aGlzLmNsYXNzX2RlcGVuZGVuY2llcy5jb25jYXQoLi4uZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgICAgICBsZXQgY29uZGl0aW9uID0gYmxvY2sucmVuZGVyZXIuZGlydHkoYWxsX2RlcGVuZGVuY2llcyk7XG4gICAgICAgICAgICAgICAgaWYgKGJsb2NrLmhhc19vdXRyb3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uID0geCBgISNjdXJyZW50IHx8ICR7Y29uZGl0aW9ufWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIElmIGFsbCBvZiB0aGUgZGVwZW5kZW5jaWVzIGFyZSBub24tZHluYW1pYyAoZG9uJ3QgZ2V0IHVwZGF0ZWQpIHRoZW4gdGhlcmUgaXMgbm8gcmVhc29uXG4gICAgICAgICAgICAgICAgLy8gdG8gYWRkIGFuIHVwZGF0ZXIgZm9yIHRoaXMuXG4gICAgICAgICAgICAgICAgY29uc3QgYW55X2R5bmFtaWNfZGVwZW5kZW5jaWVzID0gYWxsX2RlcGVuZGVuY2llcy5zb21lKChkZXApID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLnJlbmRlcmVyLmNvbXBvbmVudC52YXJfbG9va3VwLmdldChkZXApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXZhcmlhYmxlIHx8IGlzX2R5bmFtaWModmFyaWFibGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChhbnlfZHluYW1pY19kZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRcdFx0aWYgKCR7Y29uZGl0aW9ufSkge1xuXHRcdFx0XHRcdFx0XHQke3VwZGF0ZXJ9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWRkX3N0eWxlcyhibG9jaykge1xuICAgICAgICBjb25zdCBoYXNfc3ByZWFkID0gdGhpcy5ub2RlLmF0dHJpYnV0ZXMuc29tZShhdHRyID0+IGF0dHIuaXNfc3ByZWFkKTtcbiAgICAgICAgdGhpcy5ub2RlLnN0eWxlcy5mb3JFYWNoKChzdHlsZV9kaXJlY3RpdmUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgbmFtZSwgZXhwcmVzc2lvbiwgc2hvdWxkX2NhY2hlLCBpbXBvcnRhbnQgfSA9IHN0eWxlX2RpcmVjdGl2ZTtcbiAgICAgICAgICAgIGNvbnN0IHNuaXBwZXQgPSBleHByZXNzaW9uLm1hbmlwdWxhdGUoYmxvY2spO1xuICAgICAgICAgICAgbGV0IGNhY2hlZF9zbmlwcGV0O1xuICAgICAgICAgICAgaWYgKHNob3VsZF9jYWNoZSkge1xuICAgICAgICAgICAgICAgIGNhY2hlZF9zbmlwcGV0ID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGBzdHlsZV8ke25hbWUucmVwbGFjZShyZWdleF9taW51c19zaWducywgJ18nKX1gKTtcbiAgICAgICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUoY2FjaGVkX3NuaXBwZXQsIHNuaXBwZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdXBkYXRlciA9IGIgYEBzZXRfc3R5bGUoJHt0aGlzLnZhcn0sIFwiJHtuYW1lfVwiLCAke3Nob3VsZF9jYWNoZSA/IGNhY2hlZF9zbmlwcGV0IDogc25pcHBldH0sICR7aW1wb3J0YW50ID8gMSA6IG51bGx9KWA7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaHlkcmF0ZS5wdXNoKHVwZGF0ZXIpO1xuICAgICAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzID0gZXhwcmVzc2lvbi5keW5hbWljX2RlcGVuZGVuY2llcygpO1xuICAgICAgICAgICAgaWYgKGhhc19zcHJlYWQpIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2godXBkYXRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChkZXBlbmRlbmNpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGlmIChzaG91bGRfY2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRcdFx0XHRpZiAoJHtibG9jay5yZW5kZXJlci5kaXJ0eShkZXBlbmRlbmNpZXMpfSAmJiAoJHtjYWNoZWRfc25pcHBldH0gIT09ICgke2NhY2hlZF9zbmlwcGV0fSA9ICR7c25pcHBldH0pKSkge1xuXHRcdFx0XHRcdFx0XHRcdCR7dXBkYXRlcn1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRcdFx0aWYgKCR7YmxvY2sucmVuZGVyZXIuZGlydHkoZGVwZW5kZW5jaWVzKX0pIHtcblx0XHRcdFx0XHRcdFx0JHt1cGRhdGVyfVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFkZF9tYW51YWxfc3R5bGVfc2NvcGluZyhibG9jaykge1xuICAgICAgICBpZiAodGhpcy5ub2RlLm5lZWRzX21hbnVhbF9zdHlsZV9zY29waW5nKSB7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVyID0gYiBgQHRvZ2dsZV9jbGFzcygke3RoaXMudmFyfSwgXCIke3RoaXMubm9kZS5jb21wb25lbnQuc3R5bGVzaGVldC5pZH1cIiwgdHJ1ZSk7YDtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5oeWRyYXRlLnB1c2godXBkYXRlcik7XG4gICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2godXBkYXRlcik7XG4gICAgICAgIH1cbiAgICB9XG59XG5jb25zdCByZWdleF9iYWNrdGlja3MgPSAvYC9nO1xuY29uc3QgcmVnZXhfZG9sbGFyX3NpZ25zID0gL1xcJC9nO1xuZnVuY3Rpb24gdG9faHRtbCh3cmFwcGVycywgYmxvY2ssIGxpdGVyYWwsIHN0YXRlLCBjYW5fdXNlX3Jhd190ZXh0KSB7XG4gICAgd3JhcHBlcnMuZm9yRWFjaCh3cmFwcGVyID0+IHtcbiAgICAgICAgaWYgKHdyYXBwZXIgaW5zdGFuY2VvZiBUZXh0V3JhcHBlcikge1xuICAgICAgICAgICAgLy8gRG9uJ3QgYWRkIHRoZSA8cHJlPi88dGV4dGFyZWE+IG5ld2xpbmUgbG9naWMgaGVyZSBiZWNhdXNlIHByZS90ZXh0YXJlYS5pbm5lckhUTUxcbiAgICAgICAgICAgIC8vIHdvdWxkIGtlZXAgdGhlIGxlYWRpbmcgbmV3bGluZSwgdG9vLCBvbmx5IHNvbWVQYXJlbnQuaW5uZXJIVE1MID0gJy4uPHByZS90ZXh0YXJlYT4uLicgd29uJ3RcbiAgICAgICAgICAgIGlmICh3cmFwcGVyLnVzZV9zcGFjZSgpKVxuICAgICAgICAgICAgICAgIHN0YXRlLnF1YXNpLnZhbHVlLnJhdyArPSAnICc7XG4gICAgICAgICAgICBjb25zdCBwYXJlbnQgPSB3cmFwcGVyLm5vZGUucGFyZW50O1xuICAgICAgICAgICAgY29uc3QgcmF3ID0gcGFyZW50ICYmIChwYXJlbnQubmFtZSA9PT0gJ3NjcmlwdCcgfHxcbiAgICAgICAgICAgICAgICBwYXJlbnQubmFtZSA9PT0gJ3N0eWxlJyB8fFxuICAgICAgICAgICAgICAgIGNhbl91c2VfcmF3X3RleHQpO1xuICAgICAgICAgICAgc3RhdGUucXVhc2kudmFsdWUucmF3ICs9IChyYXcgPyB3cmFwcGVyLmRhdGEgOiBlc2NhcGVfaHRtbCh3cmFwcGVyLmRhdGEpKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKHJlZ2V4X2JhY2tzbGFzaGVzLCAnXFxcXFxcXFwnKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKHJlZ2V4X2JhY2t0aWNrcywgJ1xcXFxgJylcbiAgICAgICAgICAgICAgICAucmVwbGFjZShyZWdleF9kb2xsYXJfc2lnbnMsICdcXFxcJCcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHdyYXBwZXIgaW5zdGFuY2VvZiBNdXN0YWNoZVRhZ1dyYXBwZXIgfHwgd3JhcHBlciBpbnN0YW5jZW9mIFJhd011c3RhY2hlVGFnV3JhcHBlcikge1xuICAgICAgICAgICAgbGl0ZXJhbC5xdWFzaXMucHVzaChzdGF0ZS5xdWFzaSk7XG4gICAgICAgICAgICBsaXRlcmFsLmV4cHJlc3Npb25zLnB1c2god3JhcHBlci5ub2RlLmV4cHJlc3Npb24ubWFuaXB1bGF0ZShibG9jaykpO1xuICAgICAgICAgICAgc3RhdGUucXVhc2kgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1RlbXBsYXRlRWxlbWVudCcsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHsgcmF3OiAnJyB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHdyYXBwZXIubm9kZS5uYW1lID09PSAnbm9zY3JpcHQnKSA7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gZWxlbWVudFxuICAgICAgICAgICAgc3RhdGUucXVhc2kudmFsdWUucmF3ICs9IGA8JHt3cmFwcGVyLm5vZGUubmFtZX1gO1xuICAgICAgICAgICAgY29uc3QgaXNfZW1wdHlfdGV4dGFyZWEgPSB3cmFwcGVyLm5vZGUubmFtZSA9PT0gJ3RleHRhcmVhJyAmJiB3cmFwcGVyLmZyYWdtZW50Lm5vZGVzLmxlbmd0aCA9PT0gMDtcbiAgICAgICAgICAgIHdyYXBwZXIuYXR0cmlidXRlcy5mb3JFYWNoKChhdHRyKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGlzX2VtcHR5X3RleHRhcmVhICYmIGF0dHIubm9kZS5uYW1lID09PSAndmFsdWUnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSB2YWx1ZSBhdHRyaWJ1dGUgb2YgPHRleHRhcmVhPiByZW5kZXJzIGFzIGNvbnRlbnQuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGUucXVhc2kudmFsdWUucmF3ICs9IGAgJHtmaXhfYXR0cmlidXRlX2Nhc2luZyhhdHRyLm5vZGUubmFtZSl9PVwiYDtcbiAgICAgICAgICAgICAgICB0b19odG1sX2Zvcl9hdHRyX3ZhbHVlKGF0dHIsIGJsb2NrLCBsaXRlcmFsLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgc3RhdGUucXVhc2kudmFsdWUucmF3ICs9ICdcIic7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICghd3JhcHBlci52b2lkKSB7XG4gICAgICAgICAgICAgICAgc3RhdGUucXVhc2kudmFsdWUucmF3ICs9ICc+JztcbiAgICAgICAgICAgICAgICBpZiAod3JhcHBlci5ub2RlLm5hbWUgPT09ICdwcmUnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFR3byBvciBtb3JlIGxlYWRpbmcgbmV3bGluZXMgYXJlIHJlcXVpcmVkIHRvIHJlc3RvcmUgdGhlIGxlYWRpbmcgbmV3bGluZSBpbW1lZGlhdGVseSBhZnRlciBgPHByZT5gLlxuICAgICAgICAgICAgICAgICAgICAvLyBzZWUgaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvZ3JvdXBpbmctY29udGVudC5odG1sI3RoZS1wcmUtZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaXJzdCA9IHdyYXBwZXIuZnJhZ21lbnQubm9kZXNbMF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdCAmJiBmaXJzdC5ub2RlLnR5cGUgPT09ICdUZXh0JyAmJiByZWdleF9zdGFydHNfd2l0aF9uZXdsaW5lLnRlc3QoZmlyc3Qubm9kZS5kYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUucXVhc2kudmFsdWUucmF3ICs9ICdcXG4nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpc19lbXB0eV90ZXh0YXJlYSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgPHRleHRhcmVhPiByZW5kZXJzIHRoZSB2YWx1ZSBhdHRyaWJ1dGUgYXMgY29udGVudCBiZWNhdXNlIHRoZSBjb250ZW50IGlzIHN0b3JlZCBpbiB0aGUgdmFsdWUgYXR0cmlidXRlLlxuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZV9hdHRyaWJ1dGUgPSB3cmFwcGVyLmF0dHJpYnV0ZXMuZmluZChhdHRyID0+IGF0dHIubm9kZS5uYW1lID09PSAndmFsdWUnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlX2F0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHdvIG9yIG1vcmUgbGVhZGluZyBuZXdsaW5lcyBhcmUgcmVxdWlyZWQgdG8gcmVzdG9yZSB0aGUgbGVhZGluZyBuZXdsaW5lIGltbWVkaWF0ZWx5IGFmdGVyIGA8dGV4dGFyZWE+YC5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlZSBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNlbGVtZW50LXJlc3RyaWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlyc3QgPSB2YWx1ZV9hdHRyaWJ1dGUubm9kZS5jaHVua3NbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3QgJiYgZmlyc3QudHlwZSA9PT0gJ1RleHQnICYmIHJlZ2V4X3N0YXJ0c193aXRoX25ld2xpbmUudGVzdChmaXJzdC5kYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLnF1YXNpLnZhbHVlLnJhdyArPSAnXFxuJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRvX2h0bWxfZm9yX2F0dHJfdmFsdWUodmFsdWVfYXR0cmlidXRlLCBibG9jaywgbGl0ZXJhbCwgc3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRvX2h0bWwod3JhcHBlci5mcmFnbWVudC5ub2RlcywgYmxvY2ssIGxpdGVyYWwsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5xdWFzaS52YWx1ZS5yYXcgKz0gYDwvJHt3cmFwcGVyLm5vZGUubmFtZX0+YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0YXRlLnF1YXNpLnZhbHVlLnJhdyArPSAnLz4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5mdW5jdGlvbiB0b19odG1sX2Zvcl9hdHRyX3ZhbHVlKGF0dHIsIGJsb2NrLCBsaXRlcmFsLCBzdGF0ZSkge1xuICAgIGF0dHIubm9kZS5jaHVua3MuZm9yRWFjaChjaHVuayA9PiB7XG4gICAgICAgIGlmIChjaHVuay50eXBlID09PSAnVGV4dCcpIHtcbiAgICAgICAgICAgIHN0YXRlLnF1YXNpLnZhbHVlLnJhdyArPSBlc2NhcGVfaHRtbChjaHVuay5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGxpdGVyYWwucXVhc2lzLnB1c2goc3RhdGUucXVhc2kpO1xuICAgICAgICAgICAgbGl0ZXJhbC5leHByZXNzaW9ucy5wdXNoKGNodW5rLm1hbmlwdWxhdGUoYmxvY2spKTtcbiAgICAgICAgICAgIHN0YXRlLnF1YXNpID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdUZW1wbGF0ZUVsZW1lbnQnLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB7IHJhdzogJycgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5jbGFzcyBIZWFkV3JhcHBlciBleHRlbmRzIFdyYXBwZXIge1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlLCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUpO1xuICAgICAgICB0aGlzLmNhbl91c2VfaW5uZXJodG1sID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZnJhZ21lbnQgPSBuZXcgRnJhZ21lbnRXcmFwcGVyKHJlbmRlcmVyLCBibG9jaywgbm9kZS5jaGlsZHJlbiwgdGhpcywgc3RyaXBfd2hpdGVzcGFjZSwgbmV4dF9zaWJsaW5nKTtcbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCBfcGFyZW50X25vZGUsIF9wYXJlbnRfbm9kZXMpIHtcbiAgICAgICAgbGV0IG5vZGVzO1xuICAgICAgICBpZiAodGhpcy5yZW5kZXJlci5vcHRpb25zLmh5ZHJhdGFibGUgJiYgdGhpcy5mcmFnbWVudC5ub2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIG5vZGVzID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdoZWFkX25vZGVzJyk7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuY2xhaW0ucHVzaChiIGBjb25zdCAke25vZGVzfSA9IEBoZWFkX3NlbGVjdG9yKCcke3RoaXMubm9kZS5pZH0nLCBAX2RvY3VtZW50LmhlYWQpO2ApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZnJhZ21lbnQucmVuZGVyKGJsb2NrLCB4IGBAX2RvY3VtZW50LmhlYWRgLCBub2Rlcyk7XG4gICAgICAgIGlmIChub2RlcyAmJiB0aGlzLnJlbmRlcmVyLm9wdGlvbnMuaHlkcmF0YWJsZSkge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmNsYWltLnB1c2goYiBgJHtub2Rlc30uZm9yRWFjaChAZGV0YWNoKTtgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gaXNfZWxzZV9pZihub2RlKSB7XG4gICAgcmV0dXJuIChub2RlICYmIG5vZGUuY2hpbGRyZW4ubGVuZ3RoID09PSAxICYmIG5vZGUuY2hpbGRyZW5bMF0udHlwZSA9PT0gJ0lmQmxvY2snKTtcbn1cbmNsYXNzIElmQmxvY2tCcmFuY2ggZXh0ZW5kcyBXcmFwcGVyIHtcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSwgc3RyaXBfd2hpdGVzcGFjZSwgbmV4dF9zaWJsaW5nKSB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlKTtcbiAgICAgICAgdGhpcy52YXIgPSBudWxsO1xuICAgICAgICBjb25zdCB7IGV4cHJlc3Npb24gfSA9IG5vZGU7XG4gICAgICAgIGNvbnN0IGlzX2Vsc2UgPSAhZXhwcmVzc2lvbjtcbiAgICAgICAgaWYgKGV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gZXhwcmVzc2lvbi5keW5hbWljX2RlcGVuZGVuY2llcygpO1xuICAgICAgICAgICAgLy8gVE9ETyBpcyB0aGlzIHRoZSByaWdodCBydWxlPyBvciBzaG91bGQgYW55IG5vbi1yZWZlcmVuY2UgY291bnQ/XG4gICAgICAgICAgICAvLyBjb25zdCBzaG91bGRfY2FjaGUgPSAhaXNfcmVmZXJlbmNlKGV4cHJlc3Npb24ubm9kZSwgbnVsbCkgJiYgZGVwZW5kZW5jaWVzLmxlbmd0aCA+IDA7XG4gICAgICAgICAgICBsZXQgc2hvdWxkX2NhY2hlID0gZmFsc2U7XG4gICAgICAgICAgICB3YWxrKGV4cHJlc3Npb24ubm9kZSwge1xuICAgICAgICAgICAgICAgIGVudGVyKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ0NhbGxFeHByZXNzaW9uJyB8fCBub2RlLnR5cGUgPT09ICdOZXdFeHByZXNzaW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2NhY2hlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHNob3VsZF9jYWNoZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZGl0aW9uID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdzaG93X2lmJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zbmlwcGV0ID0gZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZGl0aW9uID0gZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhZGRfY29uc3RfdGFnc19jb250ZXh0KHJlbmRlcmVyLCB0aGlzLm5vZGUuY29uc3RfdGFncyk7XG4gICAgICAgIHRoaXMuYmxvY2sgPSBibG9jay5jaGlsZCh7XG4gICAgICAgICAgICBjb21tZW50OiBjcmVhdGVfZGVidWdnaW5nX2NvbW1lbnQobm9kZSwgcGFyZW50LnJlbmRlcmVyLmNvbXBvbmVudCksXG4gICAgICAgICAgICBuYW1lOiBwYXJlbnQucmVuZGVyZXIuY29tcG9uZW50LmdldF91bmlxdWVfbmFtZShpc19lbHNlID8gJ2NyZWF0ZV9lbHNlX2Jsb2NrJyA6ICdjcmVhdGVfaWZfYmxvY2snKSxcbiAgICAgICAgICAgIHR5cGU6IG5vZGUuZXhwcmVzc2lvbiA/ICdpZicgOiAnZWxzZSdcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZnJhZ21lbnQgPSBuZXcgRnJhZ21lbnRXcmFwcGVyKHJlbmRlcmVyLCB0aGlzLmJsb2NrLCBub2RlLmNoaWxkcmVuLCBwYXJlbnQsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZyk7XG4gICAgICAgIHRoaXMuaXNfZHluYW1pYyA9IHRoaXMuYmxvY2suZGVwZW5kZW5jaWVzLnNpemUgPiAwO1xuICAgICAgICBpZiAobm9kZS5jb25zdF90YWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0X2N0eF9uYW1lID0gcGFyZW50LnJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoaXNfZWxzZSA/ICdnZXRfZWxzZV9jdHgnIDogJ2dldF9pZl9jdHgnKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmNsYXNzIElmQmxvY2tXcmFwcGVyIGV4dGVuZHMgV3JhcHBlciB7XG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZykge1xuICAgICAgICBzdXBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSk7XG4gICAgICAgIHRoaXMubmVlZHNfdXBkYXRlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudmFyID0geyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6ICdpZl9ibG9jaycgfTtcbiAgICAgICAgdGhpcy5jYW5ub3RfdXNlX2lubmVyaHRtbCgpO1xuICAgICAgICB0aGlzLm5vdF9zdGF0aWNfY29udGVudCgpO1xuICAgICAgICB0aGlzLmJyYW5jaGVzID0gW107XG4gICAgICAgIGNvbnN0IGJsb2NrcyA9IFtdO1xuICAgICAgICBsZXQgaXNfZHluYW1pYyA9IGZhbHNlO1xuICAgICAgICBsZXQgaGFzX2ludHJvcyA9IGZhbHNlO1xuICAgICAgICBsZXQgaGFzX291dHJvcyA9IGZhbHNlO1xuICAgICAgICBjb25zdCBjcmVhdGVfYnJhbmNoZXMgPSAobm9kZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgYnJhbmNoID0gbmV3IElmQmxvY2tCcmFuY2gocmVuZGVyZXIsIGJsb2NrLCB0aGlzLCBub2RlLCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpO1xuICAgICAgICAgICAgdGhpcy5icmFuY2hlcy5wdXNoKGJyYW5jaCk7XG4gICAgICAgICAgICBibG9ja3MucHVzaChicmFuY2guYmxvY2spO1xuICAgICAgICAgICAgYmxvY2suYWRkX2RlcGVuZGVuY2llcyhub2RlLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIGlmIChicmFuY2guYmxvY2suZGVwZW5kZW5jaWVzLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gdGhlIGNvbmRpdGlvbiwgb3IgaXRzIGNvbnRlbnRzLCBpcyBkeW5hbWljXG4gICAgICAgICAgICAgICAgaXNfZHluYW1pYyA9IHRydWU7XG4gICAgICAgICAgICAgICAgYmxvY2suYWRkX2RlcGVuZGVuY2llcyhicmFuY2guYmxvY2suZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChicmFuY2guZGVwZW5kZW5jaWVzICYmIGJyYW5jaC5kZXBlbmRlbmNpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIHRoZSBjb25kaXRpb24gaXRzZWxmIGlzIGR5bmFtaWNcbiAgICAgICAgICAgICAgICB0aGlzLm5lZWRzX3VwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYnJhbmNoLmJsb2NrLmhhc19pbnRyb3MpXG4gICAgICAgICAgICAgICAgaGFzX2ludHJvcyA9IHRydWU7XG4gICAgICAgICAgICBpZiAoYnJhbmNoLmJsb2NrLmhhc19vdXRyb3MpXG4gICAgICAgICAgICAgICAgaGFzX291dHJvcyA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaXNfZWxzZV9pZihub2RlLmVsc2UpKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlX2JyYW5jaGVzKG5vZGUuZWxzZS5jaGlsZHJlblswXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChub2RlLmVsc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBicmFuY2ggPSBuZXcgSWZCbG9ja0JyYW5jaChyZW5kZXJlciwgYmxvY2ssIHRoaXMsIG5vZGUuZWxzZSwgc3RyaXBfd2hpdGVzcGFjZSwgbmV4dF9zaWJsaW5nKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJyYW5jaGVzLnB1c2goYnJhbmNoKTtcbiAgICAgICAgICAgICAgICBibG9ja3MucHVzaChicmFuY2guYmxvY2spO1xuICAgICAgICAgICAgICAgIGlmIChicmFuY2guYmxvY2suZGVwZW5kZW5jaWVzLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzX2R5bmFtaWMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBibG9jay5hZGRfZGVwZW5kZW5jaWVzKGJyYW5jaC5ibG9jay5kZXBlbmRlbmNpZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYnJhbmNoLmJsb2NrLmhhc19pbnRyb3MpXG4gICAgICAgICAgICAgICAgICAgIGhhc19pbnRyb3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChicmFuY2guYmxvY2suaGFzX291dHJvcylcbiAgICAgICAgICAgICAgICAgICAgaGFzX291dHJvcyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNyZWF0ZV9icmFuY2hlcyh0aGlzLm5vZGUpO1xuICAgICAgICBibG9ja3MuZm9yRWFjaChibG9jayA9PiB7XG4gICAgICAgICAgICBibG9jay5oYXNfdXBkYXRlX21ldGhvZCA9IGlzX2R5bmFtaWM7XG4gICAgICAgICAgICBibG9jay5oYXNfaW50cm9fbWV0aG9kID0gaGFzX2ludHJvcztcbiAgICAgICAgICAgIGJsb2NrLmhhc19vdXRyb19tZXRob2QgPSBoYXNfb3V0cm9zO1xuICAgICAgICB9KTtcbiAgICAgICAgcHVzaF9hcnJheSQxKHJlbmRlcmVyLmJsb2NrcywgYmxvY2tzKTtcbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLnZhcjtcbiAgICAgICAgY29uc3QgbmVlZHNfYW5jaG9yID0gdGhpcy5uZXh0ID8gIXRoaXMubmV4dC5pc19kb21fbm9kZSgpIDogIXBhcmVudF9ub2RlIHx8ICF0aGlzLnBhcmVudC5pc19kb21fbm9kZSgpO1xuICAgICAgICBjb25zdCBhbmNob3IgPSBuZWVkc19hbmNob3JcbiAgICAgICAgICAgID8gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke3RoaXMudmFyLm5hbWV9X2FuY2hvcmApXG4gICAgICAgICAgICA6ICh0aGlzLm5leHQgJiYgdGhpcy5uZXh0LnZhcikgfHwgJ251bGwnO1xuICAgICAgICBjb25zdCBoYXNfZWxzZSA9ICEodGhpcy5icmFuY2hlc1t0aGlzLmJyYW5jaGVzLmxlbmd0aCAtIDFdLmNvbmRpdGlvbik7XG4gICAgICAgIGNvbnN0IGlmX2V4aXN0c19jb25kaXRpb24gPSBoYXNfZWxzZSA/IG51bGwgOiBuYW1lO1xuICAgICAgICBjb25zdCBkeW5hbWljID0gdGhpcy5icmFuY2hlc1swXS5ibG9jay5oYXNfdXBkYXRlX21ldGhvZDsgLy8gY2FuIHVzZSBbMF0gYXMgcHJveHkgZm9yIGFsbCwgc2luY2UgdGhleSBuZWNlc3NhcmlseSBoYXZlIHRoZSBzYW1lIHZhbHVlXG4gICAgICAgIGNvbnN0IGhhc19pbnRyb3MgPSB0aGlzLmJyYW5jaGVzWzBdLmJsb2NrLmhhc19pbnRyb19tZXRob2Q7XG4gICAgICAgIGNvbnN0IGhhc19vdXRyb3MgPSB0aGlzLmJyYW5jaGVzWzBdLmJsb2NrLmhhc19vdXRyb19tZXRob2Q7XG4gICAgICAgIGNvbnN0IGhhc190cmFuc2l0aW9ucyA9IGhhc19pbnRyb3MgfHwgaGFzX291dHJvcztcbiAgICAgICAgdGhpcy5icmFuY2hlcy5mb3JFYWNoKGJyYW5jaCA9PiB7XG4gICAgICAgICAgICBpZiAoYnJhbmNoLmdldF9jdHhfbmFtZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYmxvY2tzLnB1c2goYiBgXG5cdFx0XHRcdGZ1bmN0aW9uICR7YnJhbmNoLmdldF9jdHhfbmFtZX0oI2N0eCkge1xuXHRcdFx0XHRcdGNvbnN0IGNoaWxkX2N0eCA9ICNjdHguc2xpY2UoKTtcblx0XHRcdFx0XHQke2FkZF9jb25zdF90YWdzKGJsb2NrLCBicmFuY2gubm9kZS5jb25zdF90YWdzLCAnY2hpbGRfY3R4Jyl9XG5cdFx0XHRcdFx0cmV0dXJuIGNoaWxkX2N0eDtcblx0XHRcdFx0fVxuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhcnMgPSB7IG5hbWUsIGFuY2hvciwgaWZfZXhpc3RzX2NvbmRpdGlvbiwgaGFzX2Vsc2UsIGhhc190cmFuc2l0aW9ucyB9O1xuICAgICAgICBjb25zdCBkZXRhY2hpbmcgPSBwYXJlbnRfbm9kZSAmJiAhaXNfaGVhZChwYXJlbnRfbm9kZSkgPyBudWxsIDogJ2RldGFjaGluZyc7XG4gICAgICAgIGlmICh0aGlzLm5vZGUuZWxzZSkge1xuICAgICAgICAgICAgdGhpcy5icmFuY2hlcy5mb3JFYWNoKGJyYW5jaCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGJyYW5jaC5zbmlwcGV0KVxuICAgICAgICAgICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUoYnJhbmNoLmNvbmRpdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChoYXNfb3V0cm9zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJfY29tcG91bmRfd2l0aF9vdXRyb3MoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMsIGR5bmFtaWMsIHZhcnMsIGRldGFjaGluZyk7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLm91dHJvLnB1c2goYiBgQHRyYW5zaXRpb25fb3V0KCR7bmFtZX0pO2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJfY29tcG91bmQoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMsIGR5bmFtaWMsIHZhcnMsIGRldGFjaGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcl9zaW1wbGUoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMsIGR5bmFtaWMsIHZhcnMsIGRldGFjaGluZyk7XG4gICAgICAgICAgICBpZiAoaGFzX291dHJvcykge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5vdXRyby5wdXNoKGIgYEB0cmFuc2l0aW9uX291dCgke25hbWV9KTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaWZfZXhpc3RzX2NvbmRpdGlvbikge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmNyZWF0ZS5wdXNoKGIgYGlmICgke2lmX2V4aXN0c19jb25kaXRpb259KSAke25hbWV9LmMoKTtgKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5jcmVhdGUucHVzaChiIGAke25hbWV9LmMoKTtgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyZW50X25vZGVzICYmIHRoaXMucmVuZGVyZXIub3B0aW9ucy5oeWRyYXRhYmxlKSB7XG4gICAgICAgICAgICBpZiAoaWZfZXhpc3RzX2NvbmRpdGlvbikge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5jbGFpbS5wdXNoKGIgYGlmICgke2lmX2V4aXN0c19jb25kaXRpb259KSAke25hbWV9LmwoJHtwYXJlbnRfbm9kZXN9KTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5jbGFpbS5wdXNoKGIgYCR7bmFtZX0ubCgke3BhcmVudF9ub2Rlc30pO2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChoYXNfaW50cm9zIHx8IGhhc19vdXRyb3MpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbnRyby5wdXNoKGIgYEB0cmFuc2l0aW9uX2luKCR7bmFtZX0pO2ApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZWVkc19hbmNob3IpIHtcbiAgICAgICAgICAgIGJsb2NrLmFkZF9lbGVtZW50KGFuY2hvciwgeCBgQGVtcHR5KClgLCBwYXJlbnRfbm9kZXMgJiYgeCBgQGVtcHR5KClgLCBwYXJlbnRfbm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5icmFuY2hlcy5mb3JFYWNoKGJyYW5jaCA9PiB7XG4gICAgICAgICAgICBicmFuY2guZnJhZ21lbnQucmVuZGVyKGJyYW5jaC5ibG9jaywgbnVsbCwgeCBgI25vZGVzYCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZW5kZXJfY29tcG91bmQoYmxvY2ssIHBhcmVudF9ub2RlLCBfcGFyZW50X25vZGVzLCBkeW5hbWljLCB7IG5hbWUsIGFuY2hvciwgaGFzX2Vsc2UsIGlmX2V4aXN0c19jb25kaXRpb24sIGhhc190cmFuc2l0aW9ucyB9LCBkZXRhY2hpbmcpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0X2Jsb2NrX3R5cGUgPSB0aGlzLnJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoJ3NlbGVjdF9ibG9ja190eXBlJyk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRfYmxvY2tfdHlwZSA9IGJsb2NrLmdldF91bmlxdWVfbmFtZSgnY3VycmVudF9ibG9ja190eXBlJyk7XG4gICAgICAgIGNvbnN0IG5lZWRfc2VsZWN0X2Jsb2NrX2N0eCA9IHRoaXMuYnJhbmNoZXMuc29tZShicmFuY2ggPT4gYnJhbmNoLmdldF9jdHhfbmFtZSk7XG4gICAgICAgIGNvbnN0IHNlbGVjdF9ibG9ja19jdHggPSBuZWVkX3NlbGVjdF9ibG9ja19jdHggPyBibG9jay5nZXRfdW5pcXVlX25hbWUoJ3NlbGVjdF9ibG9ja19jdHgnKSA6IG51bGw7XG4gICAgICAgIGNvbnN0IGlmX2N0eCA9IHNlbGVjdF9ibG9ja19jdHggPyB4IGAke3NlbGVjdF9ibG9ja19jdHh9KCNjdHgsICR7Y3VycmVudF9ibG9ja190eXBlfSlgIDogeCBgI2N0eGA7XG4gICAgICAgIGNvbnN0IGdldF9ibG9jayA9IGhhc19lbHNlXG4gICAgICAgICAgICA/IHggYCR7Y3VycmVudF9ibG9ja190eXBlfSgke2lmX2N0eH0pYFxuICAgICAgICAgICAgOiB4IGAke2N1cnJlbnRfYmxvY2tfdHlwZX0gJiYgJHtjdXJyZW50X2Jsb2NrX3R5cGV9KCR7aWZfY3R4fSlgO1xuICAgICAgICBpZiAodGhpcy5uZWVkc191cGRhdGUpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbml0LnB1c2goYiBgXG5cdFx0XHRcdGZ1bmN0aW9uICR7c2VsZWN0X2Jsb2NrX3R5cGV9KCNjdHgsICNkaXJ0eSkge1xuXHRcdFx0XHRcdCR7dGhpcy5icmFuY2hlcy5tYXAoKHsgZGVwZW5kZW5jaWVzLCBjb25kaXRpb24sIHNuaXBwZXQgfSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBiIGAke3NuaXBwZXQgJiYgZGVwZW5kZW5jaWVzLmxlbmd0aCA+IDAgPyBiIGBpZiAoJHtibG9jay5yZW5kZXJlci5kaXJ0eShkZXBlbmRlbmNpZXMpfSkgJHtjb25kaXRpb259ID0gbnVsbDtgIDogbnVsbH1gO1xuICAgICAgICAgICAgfSl9XG5cdFx0XHRcdFx0JHt0aGlzLmJyYW5jaGVzLm1hcCgoeyBjb25kaXRpb24sIHNuaXBwZXQsIGJsb2NrIH0pID0+IGNvbmRpdGlvblxuICAgICAgICAgICAgICAgID8gYiBgXG5cdFx0XHRcdFx0XHRcdFx0JHtzbmlwcGV0ICYmIGIgYGlmICgke2NvbmRpdGlvbn0gPT0gbnVsbCkgJHtjb25kaXRpb259ID0gISEke3NuaXBwZXR9YH1cblx0XHRcdFx0XHRcdFx0XHRpZiAoJHtjb25kaXRpb259KSByZXR1cm4gJHtibG9jay5uYW1lfTtgXG4gICAgICAgICAgICAgICAgOiBiIGByZXR1cm4gJHtibG9jay5uYW1lfTtgKX1cblx0XHRcdFx0fVxuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0XHRmdW5jdGlvbiAke3NlbGVjdF9ibG9ja190eXBlfSgjY3R4LCAjZGlydHkpIHtcblx0XHRcdFx0XHQke3RoaXMuYnJhbmNoZXMubWFwKCh7IGNvbmRpdGlvbiwgc25pcHBldCwgYmxvY2sgfSkgPT4gY29uZGl0aW9uXG4gICAgICAgICAgICAgICAgPyBiIGBpZiAoJHtzbmlwcGV0IHx8IGNvbmRpdGlvbn0pIHJldHVybiAke2Jsb2NrLm5hbWV9O2BcbiAgICAgICAgICAgICAgICA6IGIgYHJldHVybiAke2Jsb2NrLm5hbWV9O2ApfVxuXHRcdFx0XHR9XG5cdFx0XHRgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmVlZF9zZWxlY3RfYmxvY2tfY3R4KSB7XG4gICAgICAgICAgICAvLyBpZiBhbGwgYnJhbmNoZXMgbmVlZHMgY3JlYXRlIGEgY29udGV4dFxuICAgICAgICAgICAgaWYgKHRoaXMuYnJhbmNoZXMuZXZlcnkoYnJhbmNoID0+IGJyYW5jaC5nZXRfY3R4X25hbWUpKSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdFx0XHRmdW5jdGlvbiAke3NlbGVjdF9ibG9ja19jdHh9KCNjdHgsICN0eXBlKSB7XG5cdFx0XHRcdFx0XHQke3RoaXMuYnJhbmNoZXMubWFwKCh7IGNvbmRpdGlvbiwgZ2V0X2N0eF9uYW1lLCBibG9jayB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25kaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgID8gYiBgaWYgKCN0eXBlID09PSAke2Jsb2NrLm5hbWV9KSByZXR1cm4gJHtnZXRfY3R4X25hbWV9KCNjdHgpO2BcbiAgICAgICAgICAgICAgICAgICAgICAgIDogYiBgcmV0dXJuICR7Z2V0X2N0eF9uYW1lfSgjY3R4KTtgO1xuICAgICAgICAgICAgICAgIH0pLmZpbHRlcihCb29sZWFuKX1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gd2hlbiBub3QgYWxsIGJyYW5jaGVzIG5lZWQgdG8gY3JlYXRlIGEgbmV3IGNvbnRleHQsXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBjb2RlIGlzIHNpbXBsZXJcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0XHRcdGZ1bmN0aW9uICR7c2VsZWN0X2Jsb2NrX2N0eH0oI2N0eCwgI3R5cGUpIHtcblx0XHRcdFx0XHRcdCR7dGhpcy5icmFuY2hlcy5tYXAoKHsgZ2V0X2N0eF9uYW1lLCBibG9jayB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRfY3R4X25hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYiBgaWYgKCN0eXBlID09PSAke2Jsb2NrLm5hbWV9KSByZXR1cm4gJHtnZXRfY3R4X25hbWV9KCNjdHgpO2BcbiAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgICAgICB9KS5maWx0ZXIoQm9vbGVhbil9XG5cdFx0XHRcdFx0XHRyZXR1cm4gI2N0eDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmNodW5rcy5pbml0LnB1c2goYiBgXG5cdFx0XHRsZXQgJHtjdXJyZW50X2Jsb2NrX3R5cGV9ID0gJHtzZWxlY3RfYmxvY2tfdHlwZX0oI2N0eCwgJHt0aGlzLnJlbmRlcmVyLmdldF9pbml0aWFsX2RpcnR5KCl9KTtcblx0XHRcdGxldCAke25hbWV9ID0gJHtnZXRfYmxvY2t9O1xuXHRcdGApO1xuICAgICAgICBjb25zdCBpbml0aWFsX21vdW50X25vZGUgPSBwYXJlbnRfbm9kZSB8fCAnI3RhcmdldCc7XG4gICAgICAgIGNvbnN0IGFuY2hvcl9ub2RlID0gcGFyZW50X25vZGUgPyAnbnVsbCcgOiAnI2FuY2hvcic7XG4gICAgICAgIGlmIChpZl9leGlzdHNfY29uZGl0aW9uKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGBpZiAoJHtpZl9leGlzdHNfY29uZGl0aW9ufSkgJHtuYW1lfS5tKCR7aW5pdGlhbF9tb3VudF9ub2RlfSwgJHthbmNob3Jfbm9kZX0pO2ApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goYiBgJHtuYW1lfS5tKCR7aW5pdGlhbF9tb3VudF9ub2RlfSwgJHthbmNob3Jfbm9kZX0pO2ApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm5lZWRzX3VwZGF0ZSkge1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlX21vdW50X25vZGUgPSB0aGlzLmdldF91cGRhdGVfbW91bnRfbm9kZShhbmNob3IpO1xuICAgICAgICAgICAgY29uc3QgY2hhbmdlX2Jsb2NrID0gYiBgXG5cdFx0XHRcdCR7aWZfZXhpc3RzX2NvbmRpdGlvbiA/IGIgYGlmICgke2lmX2V4aXN0c19jb25kaXRpb259KSAke25hbWV9LmQoMSlgIDogYiBgJHtuYW1lfS5kKDEpYH07XG5cdFx0XHRcdCR7bmFtZX0gPSAke2dldF9ibG9ja307XG5cdFx0XHRcdGlmICgke25hbWV9KSB7XG5cdFx0XHRcdFx0JHtuYW1lfS5jKCk7XG5cdFx0XHRcdFx0JHtoYXNfdHJhbnNpdGlvbnMgJiYgYiBgQHRyYW5zaXRpb25faW4oJHtuYW1lfSwgMSk7YH1cblx0XHRcdFx0XHQke25hbWV9Lm0oJHt1cGRhdGVfbW91bnRfbm9kZX0sICR7YW5jaG9yfSk7XG5cdFx0XHRcdH1cblx0XHRcdGA7XG4gICAgICAgICAgICBpZiAoZHluYW1pYykge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0XHRpZiAoJHtjdXJyZW50X2Jsb2NrX3R5cGV9ID09PSAoJHtjdXJyZW50X2Jsb2NrX3R5cGV9ID0gJHtzZWxlY3RfYmxvY2tfdHlwZX0oI2N0eCwgI2RpcnR5KSkgJiYgJHtuYW1lfSkge1xuXHRcdFx0XHRcdFx0JHtuYW1lfS5wKCR7aWZfY3R4fSwgI2RpcnR5KTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0JHtjaGFuZ2VfYmxvY2t9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0XHRpZiAoJHtjdXJyZW50X2Jsb2NrX3R5cGV9ICE9PSAoJHtjdXJyZW50X2Jsb2NrX3R5cGV9ID0gJHtzZWxlY3RfYmxvY2tfdHlwZX0oI2N0eCwgI2RpcnR5KSkpIHtcblx0XHRcdFx0XHRcdCR7Y2hhbmdlX2Jsb2NrfVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZHluYW1pYykge1xuICAgICAgICAgICAgaWYgKGlmX2V4aXN0c19jb25kaXRpb24pIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgaWYgKCR7aWZfZXhpc3RzX2NvbmRpdGlvbn0pICR7bmFtZX0ucCgke2lmX2N0eH0sICNkaXJ0eSk7YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgJHtuYW1lfS5wKCR7aWZfY3R4fSwgI2RpcnR5KTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaWZfZXhpc3RzX2NvbmRpdGlvbikge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmRlc3Ryb3kucHVzaChiIGBcblx0XHRcdFx0aWYgKCR7aWZfZXhpc3RzX2NvbmRpdGlvbn0pIHtcblx0XHRcdFx0XHQke25hbWV9LmQoJHtkZXRhY2hpbmd9KTtcblx0XHRcdFx0fVxuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuZGVzdHJveS5wdXNoKGIgYFxuXHRcdFx0XHQke25hbWV9LmQoJHtkZXRhY2hpbmd9KTtcblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIGlmIGFueSBvZiB0aGUgc2libGluZ3MgaGF2ZSBvdXRyb3MsIHdlIG5lZWQgdG8ga2VlcCByZWZlcmVuY2VzIHRvIHRoZSBibG9ja3NcbiAgICAvLyAoVE9ETyBkb2VzIHRoaXMgb25seSBhcHBseSB0byBiaWRpIHRyYW5zaXRpb25zPylcbiAgICByZW5kZXJfY29tcG91bmRfd2l0aF9vdXRyb3MoYmxvY2ssIHBhcmVudF9ub2RlLCBfcGFyZW50X25vZGVzLCBkeW5hbWljLCB7IG5hbWUsIGFuY2hvciwgaGFzX2Vsc2UsIGhhc190cmFuc2l0aW9ucywgaWZfZXhpc3RzX2NvbmRpdGlvbiB9LCBkZXRhY2hpbmcpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0X2Jsb2NrX3R5cGUgPSB0aGlzLnJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoJ3NlbGVjdF9ibG9ja190eXBlJyk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRfYmxvY2tfdHlwZV9pbmRleCA9IGJsb2NrLmdldF91bmlxdWVfbmFtZSgnY3VycmVudF9ibG9ja190eXBlX2luZGV4Jyk7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzX2Jsb2NrX2luZGV4ID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdwcmV2aW91c19ibG9ja19pbmRleCcpO1xuICAgICAgICBjb25zdCBpZl9ibG9ja19jcmVhdG9ycyA9IGJsb2NrLmdldF91bmlxdWVfbmFtZSgnaWZfYmxvY2tfY3JlYXRvcnMnKTtcbiAgICAgICAgY29uc3QgaWZfYmxvY2tzID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdpZl9ibG9ja3MnKTtcbiAgICAgICAgY29uc3QgbmVlZF9zZWxlY3RfYmxvY2tfY3R4ID0gdGhpcy5icmFuY2hlcy5zb21lKGJyYW5jaCA9PiBicmFuY2guZ2V0X2N0eF9uYW1lKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0X2Jsb2NrX2N0eCA9IG5lZWRfc2VsZWN0X2Jsb2NrX2N0eCA/IGJsb2NrLmdldF91bmlxdWVfbmFtZSgnc2VsZWN0X2Jsb2NrX2N0eCcpIDogbnVsbDtcbiAgICAgICAgY29uc3QgaWZfY3R4ID0gc2VsZWN0X2Jsb2NrX2N0eCA/IHggYCR7c2VsZWN0X2Jsb2NrX2N0eH0oI2N0eCwgJHtjdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXh9KWAgOiB4IGAjY3R4YDtcbiAgICAgICAgY29uc3QgaWZfY3VycmVudF9ibG9ja190eXBlX2luZGV4ID0gaGFzX2Vsc2VcbiAgICAgICAgICAgID8gKG5vZGVzKSA9PiBub2Rlc1xuICAgICAgICAgICAgOiAobm9kZXMpID0+IGIgYGlmICh+JHtjdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXh9KSB7ICR7bm9kZXN9IH1gO1xuICAgICAgICBibG9jay5hZGRfdmFyaWFibGUoY3VycmVudF9ibG9ja190eXBlX2luZGV4KTtcbiAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKG5hbWUpO1xuICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0Y29uc3QgJHtpZl9ibG9ja19jcmVhdG9yc30gPSBbXG5cdFx0XHRcdCR7dGhpcy5icmFuY2hlcy5tYXAoYnJhbmNoID0+IGJyYW5jaC5ibG9jay5uYW1lKX1cblx0XHRcdF07XG5cblx0XHRcdGNvbnN0ICR7aWZfYmxvY2tzfSA9IFtdO1xuXG5cdFx0XHQke3RoaXMubmVlZHNfdXBkYXRlXG4gICAgICAgICAgICA/IGIgYFxuXHRcdFx0XHRcdGZ1bmN0aW9uICR7c2VsZWN0X2Jsb2NrX3R5cGV9KCNjdHgsICNkaXJ0eSkge1xuXHRcdFx0XHRcdFx0JHt0aGlzLmJyYW5jaGVzLm1hcCgoeyBkZXBlbmRlbmNpZXMsIGNvbmRpdGlvbiwgc25pcHBldCB9KSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGIgYCR7c25pcHBldCAmJiBkZXBlbmRlbmNpZXMubGVuZ3RoID4gMCA/IGIgYGlmICgke2Jsb2NrLnJlbmRlcmVyLmRpcnR5KGRlcGVuZGVuY2llcyl9KSAke2NvbmRpdGlvbn0gPSBudWxsO2AgOiBudWxsfWA7XG4gICAgICAgICAgICB9KX1cblx0XHRcdFx0XHRcdCR7dGhpcy5icmFuY2hlcy5tYXAoKHsgY29uZGl0aW9uLCBzbmlwcGV0IH0sIGkpID0+IGNvbmRpdGlvblxuICAgICAgICAgICAgICAgID8gYiBgXG5cdFx0XHRcdFx0XHRcdFx0JHtzbmlwcGV0ICYmIGIgYGlmICgke2NvbmRpdGlvbn0gPT0gbnVsbCkgJHtjb25kaXRpb259ID0gISEke3NuaXBwZXR9YH1cblx0XHRcdFx0XHRcdFx0XHRpZiAoJHtjb25kaXRpb259KSByZXR1cm4gJHtpfTtgXG4gICAgICAgICAgICAgICAgOiBiIGByZXR1cm4gJHtpfTtgKX1cblx0XHRcdFx0XHRcdFx0XHQkeyFoYXNfZWxzZSAmJiBiIGByZXR1cm4gLTE7YH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YFxuICAgICAgICAgICAgOiBiIGBcblx0XHRcdFx0XHRmdW5jdGlvbiAke3NlbGVjdF9ibG9ja190eXBlfSgjY3R4LCAjZGlydHkpIHtcblx0XHRcdFx0XHRcdCR7dGhpcy5icmFuY2hlcy5tYXAoKHsgY29uZGl0aW9uLCBzbmlwcGV0IH0sIGkpID0+IGNvbmRpdGlvblxuICAgICAgICAgICAgICAgID8gYiBgaWYgKCR7c25pcHBldCB8fCBjb25kaXRpb259KSByZXR1cm4gJHtpfTtgXG4gICAgICAgICAgICAgICAgOiBiIGByZXR1cm4gJHtpfTtgKX1cblx0XHRcdFx0XHRcdCR7IWhhc19lbHNlICYmIGIgYHJldHVybiAtMTtgfVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YH1cblx0XHRgKTtcbiAgICAgICAgaWYgKG5lZWRfc2VsZWN0X2Jsb2NrX2N0eCkge1xuICAgICAgICAgICAgLy8gaWYgYWxsIGJyYW5jaGVzIG5lZWRzIGNyZWF0ZSBhIGNvbnRleHRcbiAgICAgICAgICAgIGlmICh0aGlzLmJyYW5jaGVzLmV2ZXJ5KGJyYW5jaCA9PiBicmFuY2guZ2V0X2N0eF9uYW1lKSkge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbml0LnB1c2goYiBgXG5cdFx0XHRcdFx0ZnVuY3Rpb24gJHtzZWxlY3RfYmxvY2tfY3R4fSgjY3R4LCAjaW5kZXgpIHtcblx0XHRcdFx0XHRcdCR7dGhpcy5icmFuY2hlcy5tYXAoKHsgY29uZGl0aW9uLCBnZXRfY3R4X25hbWUgfSwgaSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uZGl0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGIgYGlmICgjaW5kZXggPT09ICR7aX0pIHJldHVybiAke2dldF9jdHhfbmFtZX0oI2N0eCk7YFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBiIGByZXR1cm4gJHtnZXRfY3R4X25hbWV9KCNjdHgpO2A7XG4gICAgICAgICAgICAgICAgfSkuZmlsdGVyKEJvb2xlYW4pfVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyB3aGVuIG5vdCBhbGwgYnJhbmNoZXMgbmVlZCB0byBjcmVhdGUgYSBuZXcgY29udGV4dCxcbiAgICAgICAgICAgICAgICAvLyB0aGlzIGNvZGUgaXMgc2ltcGxlclxuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbml0LnB1c2goYiBgXG5cdFx0XHRcdFx0ZnVuY3Rpb24gJHtzZWxlY3RfYmxvY2tfY3R4fSgjY3R4LCAjaW5kZXgpIHtcblx0XHRcdFx0XHRcdCR7dGhpcy5icmFuY2hlcy5tYXAoKHsgZ2V0X2N0eF9uYW1lIH0sIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldF9jdHhfbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBiIGBpZiAoI2luZGV4ID09PSAke2l9KSByZXR1cm4gJHtnZXRfY3R4X25hbWV9KCNjdHgpO2BcbiAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgICAgICB9KS5maWx0ZXIoQm9vbGVhbil9XG5cdFx0XHRcdFx0XHRyZXR1cm4gI2N0eDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChoYXNfZWxzZSkge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdFx0JHtjdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXh9ID0gJHtzZWxlY3RfYmxvY2tfdHlwZX0oI2N0eCwgJHt0aGlzLnJlbmRlcmVyLmdldF9pbml0aWFsX2RpcnR5KCl9KTtcblx0XHRcdFx0JHtuYW1lfSA9ICR7aWZfYmxvY2tzfVske2N1cnJlbnRfYmxvY2tfdHlwZV9pbmRleH1dID0gJHtpZl9ibG9ja19jcmVhdG9yc31bJHtjdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXh9XSgke2lmX2N0eH0pO1xuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0XHRpZiAofigke2N1cnJlbnRfYmxvY2tfdHlwZV9pbmRleH0gPSAke3NlbGVjdF9ibG9ja190eXBlfSgjY3R4LCAke3RoaXMucmVuZGVyZXIuZ2V0X2luaXRpYWxfZGlydHkoKX0pKSkge1xuXHRcdFx0XHRcdCR7bmFtZX0gPSAke2lmX2Jsb2Nrc31bJHtjdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXh9XSA9ICR7aWZfYmxvY2tfY3JlYXRvcnN9WyR7Y3VycmVudF9ibG9ja190eXBlX2luZGV4fV0oJHtpZl9jdHh9KTtcblx0XHRcdFx0fVxuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5pdGlhbF9tb3VudF9ub2RlID0gcGFyZW50X25vZGUgfHwgJyN0YXJnZXQnO1xuICAgICAgICBjb25zdCBhbmNob3Jfbm9kZSA9IHBhcmVudF9ub2RlID8gJ251bGwnIDogJyNhbmNob3InO1xuICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChpZl9jdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXgoYiBgJHtpZl9ibG9ja3N9WyR7Y3VycmVudF9ibG9ja190eXBlX2luZGV4fV0ubSgke2luaXRpYWxfbW91bnRfbm9kZX0sICR7YW5jaG9yX25vZGV9KTtgKSk7XG4gICAgICAgIGlmICh0aGlzLm5lZWRzX3VwZGF0ZSkge1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlX21vdW50X25vZGUgPSB0aGlzLmdldF91cGRhdGVfbW91bnRfbm9kZShhbmNob3IpO1xuICAgICAgICAgICAgY29uc3QgZGVzdHJveV9vbGRfYmxvY2sgPSBiIGBcblx0XHRcdFx0QGdyb3VwX291dHJvcygpO1xuXHRcdFx0XHRAdHJhbnNpdGlvbl9vdXQoJHtpZl9ibG9ja3N9WyR7cHJldmlvdXNfYmxvY2tfaW5kZXh9XSwgMSwgMSwgKCkgPT4ge1xuXHRcdFx0XHRcdCR7aWZfYmxvY2tzfVske3ByZXZpb3VzX2Jsb2NrX2luZGV4fV0gPSBudWxsO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0QGNoZWNrX291dHJvcygpO1xuXHRcdFx0YDtcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZV9uZXdfYmxvY2sgPSBiIGBcblx0XHRcdFx0JHtuYW1lfSA9ICR7aWZfYmxvY2tzfVske2N1cnJlbnRfYmxvY2tfdHlwZV9pbmRleH1dO1xuXHRcdFx0XHRpZiAoISR7bmFtZX0pIHtcblx0XHRcdFx0XHQke25hbWV9ID0gJHtpZl9ibG9ja3N9WyR7Y3VycmVudF9ibG9ja190eXBlX2luZGV4fV0gPSAke2lmX2Jsb2NrX2NyZWF0b3JzfVske2N1cnJlbnRfYmxvY2tfdHlwZV9pbmRleH1dKCR7aWZfY3R4fSk7XG5cdFx0XHRcdFx0JHtuYW1lfS5jKCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JHtkeW5hbWljICYmIGIgYCR7bmFtZX0ucCgke2lmX2N0eH0sICNkaXJ0eSk7YH1cblx0XHRcdFx0fVxuXHRcdFx0XHQke2hhc190cmFuc2l0aW9ucyAmJiBiIGBAdHJhbnNpdGlvbl9pbigke25hbWV9LCAxKTtgfVxuXHRcdFx0XHQke25hbWV9Lm0oJHt1cGRhdGVfbW91bnRfbm9kZX0sICR7YW5jaG9yfSk7XG5cdFx0XHRgO1xuICAgICAgICAgICAgY29uc3QgY2hhbmdlX2Jsb2NrID0gaGFzX2Vsc2VcbiAgICAgICAgICAgICAgICA/IGIgYFxuXHRcdFx0XHRcdCR7ZGVzdHJveV9vbGRfYmxvY2t9XG5cblx0XHRcdFx0XHQke2NyZWF0ZV9uZXdfYmxvY2t9XG5cdFx0XHRcdGBcbiAgICAgICAgICAgICAgICA6IGIgYFxuXHRcdFx0XHRcdGlmICgke25hbWV9KSB7XG5cdFx0XHRcdFx0XHQke2Rlc3Ryb3lfb2xkX2Jsb2NrfVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICh+JHtjdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXh9KSB7XG5cdFx0XHRcdFx0XHQke2NyZWF0ZV9uZXdfYmxvY2t9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdCR7bmFtZX0gPSBudWxsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0YDtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0bGV0ICR7cHJldmlvdXNfYmxvY2tfaW5kZXh9ID0gJHtjdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXh9O1xuXHRcdFx0XHQke2N1cnJlbnRfYmxvY2tfdHlwZV9pbmRleH0gPSAke3NlbGVjdF9ibG9ja190eXBlfSgjY3R4LCAjZGlydHkpO1xuXHRcdFx0YCk7XG4gICAgICAgICAgICBpZiAoZHluYW1pYykge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0XHRpZiAoJHtjdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXh9ID09PSAke3ByZXZpb3VzX2Jsb2NrX2luZGV4fSkge1xuXHRcdFx0XHRcdFx0JHtpZl9jdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXgoYiBgJHtpZl9ibG9ja3N9WyR7Y3VycmVudF9ibG9ja190eXBlX2luZGV4fV0ucCgke2lmX2N0eH0sICNkaXJ0eSk7YCl9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdCR7Y2hhbmdlX2Jsb2NrfVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRcdFx0aWYgKCR7Y3VycmVudF9ibG9ja190eXBlX2luZGV4fSAhPT0gJHtwcmV2aW91c19ibG9ja19pbmRleH0pIHtcblx0XHRcdFx0XHRcdCR7Y2hhbmdlX2Jsb2NrfVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZHluYW1pYykge1xuICAgICAgICAgICAgaWYgKGlmX2V4aXN0c19jb25kaXRpb24pIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgaWYgKCR7aWZfZXhpc3RzX2NvbmRpdGlvbn0pICR7bmFtZX0ucCgke2lmX2N0eH0sICNkaXJ0eSk7YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgJHtuYW1lfS5wKCR7aWZfY3R4fSwgI2RpcnR5KTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBibG9jay5jaHVua3MuZGVzdHJveS5wdXNoKGlmX2N1cnJlbnRfYmxvY2tfdHlwZV9pbmRleChiIGAke2lmX2Jsb2Nrc31bJHtjdXJyZW50X2Jsb2NrX3R5cGVfaW5kZXh9XS5kKCR7ZGV0YWNoaW5nfSk7YCkpO1xuICAgIH1cbiAgICByZW5kZXJfc2ltcGxlKGJsb2NrLCBwYXJlbnRfbm9kZSwgX3BhcmVudF9ub2RlcywgZHluYW1pYywgeyBuYW1lLCBhbmNob3IsIGlmX2V4aXN0c19jb25kaXRpb24sIGhhc190cmFuc2l0aW9ucyB9LCBkZXRhY2hpbmcpIHtcbiAgICAgICAgY29uc3QgYnJhbmNoID0gdGhpcy5icmFuY2hlc1swXTtcbiAgICAgICAgY29uc3QgaWZfY3R4ID0gYnJhbmNoLmdldF9jdHhfbmFtZSA/IHggYCR7YnJhbmNoLmdldF9jdHhfbmFtZX0oI2N0eClgIDogeCBgI2N0eGA7XG4gICAgICAgIGlmIChicmFuY2guc25pcHBldClcbiAgICAgICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShicmFuY2guY29uZGl0aW9uLCBicmFuY2guc25pcHBldCk7XG4gICAgICAgIGJsb2NrLmNodW5rcy5pbml0LnB1c2goYiBgXG5cdFx0XHRsZXQgJHtuYW1lfSA9ICR7YnJhbmNoLmNvbmRpdGlvbn0gJiYgJHticmFuY2guYmxvY2submFtZX0oJHtpZl9jdHh9KTtcblx0XHRgKTtcbiAgICAgICAgY29uc3QgaW5pdGlhbF9tb3VudF9ub2RlID0gcGFyZW50X25vZGUgfHwgJyN0YXJnZXQnO1xuICAgICAgICBjb25zdCBhbmNob3Jfbm9kZSA9IHBhcmVudF9ub2RlID8gJ251bGwnIDogJyNhbmNob3InO1xuICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGBpZiAoJHtuYW1lfSkgJHtuYW1lfS5tKCR7aW5pdGlhbF9tb3VudF9ub2RlfSwgJHthbmNob3Jfbm9kZX0pO2ApO1xuICAgICAgICBpZiAoYnJhbmNoLmRlcGVuZGVuY2llcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVfbW91bnRfbm9kZSA9IHRoaXMuZ2V0X3VwZGF0ZV9tb3VudF9ub2RlKGFuY2hvcik7XG4gICAgICAgICAgICBjb25zdCBlbnRlciA9IGIgYFxuXHRcdFx0XHRpZiAoJHtuYW1lfSkge1xuXHRcdFx0XHRcdCR7ZHluYW1pYyAmJiBiIGAke25hbWV9LnAoJHtpZl9jdHh9LCAjZGlydHkpO2B9XG5cdFx0XHRcdFx0JHtoYXNfdHJhbnNpdGlvbnMgJiZcbiAgICAgICAgICAgICAgICBiIGBpZiAoJHtibG9jay5yZW5kZXJlci5kaXJ0eShicmFuY2guZGVwZW5kZW5jaWVzKX0pIHtcblx0XHRcdFx0XHRcdFx0XHRcdEB0cmFuc2l0aW9uX2luKCR7bmFtZX0sIDEpO1xuXHRcdFx0XHRcdFx0XHRcdH1gfVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdCR7bmFtZX0gPSAke2JyYW5jaC5ibG9jay5uYW1lfSgke2lmX2N0eH0pO1xuXHRcdFx0XHRcdCR7bmFtZX0uYygpO1xuXHRcdFx0XHRcdCR7aGFzX3RyYW5zaXRpb25zICYmIGIgYEB0cmFuc2l0aW9uX2luKCR7bmFtZX0sIDEpO2B9XG5cdFx0XHRcdFx0JHtuYW1lfS5tKCR7dXBkYXRlX21vdW50X25vZGV9LCAke2FuY2hvcn0pO1xuXHRcdFx0XHR9XG5cdFx0XHRgO1xuICAgICAgICAgICAgaWYgKGJyYW5jaC5zbmlwcGV0KSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYGlmICgke2Jsb2NrLnJlbmRlcmVyLmRpcnR5KGJyYW5jaC5kZXBlbmRlbmNpZXMpfSkgJHticmFuY2guY29uZGl0aW9ufSA9ICR7YnJhbmNoLnNuaXBwZXR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBubyBgcCgpYCBoZXJlIOKAlCB3ZSBkb24ndCB3YW50IHRvIHVwZGF0ZSBvdXRyb2luZyBub2RlcyxcbiAgICAgICAgICAgIC8vIGFzIHRoYXQgd2lsbCB0eXBpY2FsbHkgcmVzdWx0IGluIGdsaXRjaGluZ1xuICAgICAgICAgICAgaWYgKGJyYW5jaC5ibG9jay5oYXNfb3V0cm9fbWV0aG9kKSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRcdGlmICgke2JyYW5jaC5jb25kaXRpb259KSB7XG5cdFx0XHRcdFx0XHQke2VudGVyfVxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoJHtuYW1lfSkge1xuXHRcdFx0XHRcdFx0QGdyb3VwX291dHJvcygpO1xuXHRcdFx0XHRcdFx0QHRyYW5zaXRpb25fb3V0KCR7bmFtZX0sIDEsIDEsICgpID0+IHtcblx0XHRcdFx0XHRcdFx0JHtuYW1lfSA9IG51bGw7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdEBjaGVja19vdXRyb3MoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRcdGlmICgke2JyYW5jaC5jb25kaXRpb259KSB7XG5cdFx0XHRcdFx0XHQke2VudGVyfVxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoJHtuYW1lfSkge1xuXHRcdFx0XHRcdFx0JHtuYW1lfS5kKDEpO1xuXHRcdFx0XHRcdFx0JHtuYW1lfSA9IG51bGw7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkeW5hbWljKSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRcdGlmICgke2JyYW5jaC5jb25kaXRpb259KSAke25hbWV9LnAoJHtpZl9jdHh9LCAjZGlydHkpO1xuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlmX2V4aXN0c19jb25kaXRpb24pIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgXG5cdFx0XHRcdGlmICgke2lmX2V4aXN0c19jb25kaXRpb259KSAke25hbWV9LmQoJHtkZXRhY2hpbmd9KTtcblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmRlc3Ryb3kucHVzaChiIGBcblx0XHRcdFx0JHtuYW1lfS5kKCR7ZGV0YWNoaW5nfSk7XG5cdFx0XHRgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuY2xhc3MgS2V5QmxvY2tXcmFwcGVyIGV4dGVuZHMgV3JhcHBlciB7XG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZykge1xuICAgICAgICBzdXBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSk7XG4gICAgICAgIHRoaXMudmFyID0geyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6ICdrZXlfYmxvY2snIH07XG4gICAgICAgIHRoaXMuY2Fubm90X3VzZV9pbm5lcmh0bWwoKTtcbiAgICAgICAgdGhpcy5ub3Rfc3RhdGljX2NvbnRlbnQoKTtcbiAgICAgICAgdGhpcy5kZXBlbmRlbmNpZXMgPSBub2RlLmV4cHJlc3Npb24uZHluYW1pY19kZXBlbmRlbmNpZXMoKTtcbiAgICAgICAgaWYgKHRoaXMuZGVwZW5kZW5jaWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgYmxvY2sgPSBibG9jay5jaGlsZCh7XG4gICAgICAgICAgICAgICAgY29tbWVudDogY3JlYXRlX2RlYnVnZ2luZ19jb21tZW50KG5vZGUsIHJlbmRlcmVyLmNvbXBvbmVudCksXG4gICAgICAgICAgICAgICAgbmFtZTogcmVuZGVyZXIuY29tcG9uZW50LmdldF91bmlxdWVfbmFtZSgnY3JlYXRlX2tleV9ibG9jaycpLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdrZXknXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJsb2NrLmFkZF9kZXBlbmRlbmNpZXMobm9kZS5leHByZXNzaW9uLmRlcGVuZGVuY2llcyk7XG4gICAgICAgICAgICByZW5kZXJlci5ibG9ja3MucHVzaChibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ibG9jayA9IGJsb2NrO1xuICAgICAgICB0aGlzLmZyYWdtZW50ID0gbmV3IEZyYWdtZW50V3JhcHBlcihyZW5kZXJlciwgdGhpcy5ibG9jaywgbm9kZS5jaGlsZHJlbiwgdGhpcywgc3RyaXBfd2hpdGVzcGFjZSwgbmV4dF9zaWJsaW5nKTtcbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKSB7XG4gICAgICAgIGlmICh0aGlzLmRlcGVuZGVuY2llcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyX3N0YXRpY19rZXkoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJfZHluYW1pY19rZXkoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbmRlcl9zdGF0aWNfa2V5KF9ibG9jaywgcGFyZW50X25vZGUsIHBhcmVudF9ub2Rlcykge1xuICAgICAgICB0aGlzLmZyYWdtZW50LnJlbmRlcih0aGlzLmJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKTtcbiAgICB9XG4gICAgcmVuZGVyX2R5bmFtaWNfa2V5KGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKSB7XG4gICAgICAgIHRoaXMuZnJhZ21lbnQucmVuZGVyKHRoaXMuYmxvY2ssIG51bGwsIHggYCNub2Rlc2ApO1xuICAgICAgICBjb25zdCBoYXNfdHJhbnNpdGlvbnMgPSAhISh0aGlzLmJsb2NrLmhhc19pbnRyb19tZXRob2QgfHwgdGhpcy5ibG9jay5oYXNfb3V0cm9fbWV0aG9kKTtcbiAgICAgICAgY29uc3QgZHluYW1pYyA9IHRoaXMuYmxvY2suaGFzX3VwZGF0ZV9tZXRob2Q7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzX2tleSA9IGJsb2NrLmdldF91bmlxdWVfbmFtZSgncHJldmlvdXNfa2V5Jyk7XG4gICAgICAgIGNvbnN0IHNuaXBwZXQgPSB0aGlzLm5vZGUuZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKHByZXZpb3VzX2tleSwgc25pcHBldCk7XG4gICAgICAgIGNvbnN0IG5vdF9lcXVhbCA9IHRoaXMucmVuZGVyZXIuY29tcG9uZW50LmNvbXBvbmVudF9vcHRpb25zLmltbXV0YWJsZSA/IHggYEBub3RfZXF1YWxgIDogeCBgQHNhZmVfbm90X2VxdWFsYDtcbiAgICAgICAgY29uc3QgY29uZGl0aW9uID0geCBgJHt0aGlzLnJlbmRlcmVyLmRpcnR5KHRoaXMuZGVwZW5kZW5jaWVzKX0gJiYgJHtub3RfZXF1YWx9KCR7cHJldmlvdXNfa2V5fSwgJHtwcmV2aW91c19rZXl9ID0gJHtzbmlwcGV0fSlgO1xuICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0bGV0ICR7dGhpcy52YXJ9ID0gJHt0aGlzLmJsb2NrLm5hbWV9KCNjdHgpO1xuXHRcdGApO1xuICAgICAgICBibG9jay5jaHVua3MuY3JlYXRlLnB1c2goYiBgJHt0aGlzLnZhcn0uYygpO2ApO1xuICAgICAgICBpZiAodGhpcy5yZW5kZXJlci5vcHRpb25zLmh5ZHJhdGFibGUpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5jbGFpbS5wdXNoKGIgYCR7dGhpcy52YXJ9LmwoJHtwYXJlbnRfbm9kZXN9KTtgKTtcbiAgICAgICAgfVxuICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGAke3RoaXMudmFyfS5tKCR7cGFyZW50X25vZGUgfHwgJyN0YXJnZXQnfSwgJHtwYXJlbnRfbm9kZSA/ICdudWxsJyA6ICcjYW5jaG9yJ30pO2ApO1xuICAgICAgICBjb25zdCBhbmNob3IgPSB0aGlzLmdldF9vcl9jcmVhdGVfYW5jaG9yKGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKTtcbiAgICAgICAgY29uc3QgYm9keSA9IGIgYFxuXHRcdFx0JHtoYXNfdHJhbnNpdGlvbnNcbiAgICAgICAgICAgID8gYiBgXG5cdFx0XHRcdFx0XHRAZ3JvdXBfb3V0cm9zKCk7XG5cdFx0XHRcdFx0XHRAdHJhbnNpdGlvbl9vdXQoJHt0aGlzLnZhcn0sIDEsIDEsIEBub29wKTtcblx0XHRcdFx0XHRcdEBjaGVja19vdXRyb3MoKTtcblx0XHRcdFx0XHRgXG4gICAgICAgICAgICA6IGIgYCR7dGhpcy52YXJ9LmQoMSk7YH1cblx0XHRcdCR7dGhpcy52YXJ9ID0gJHt0aGlzLmJsb2NrLm5hbWV9KCNjdHgpO1xuXHRcdFx0JHt0aGlzLnZhcn0uYygpO1xuXHRcdFx0JHtoYXNfdHJhbnNpdGlvbnMgJiYgYiBgQHRyYW5zaXRpb25faW4oJHt0aGlzLnZhcn0sIDEpYH1cblx0XHRcdCR7dGhpcy52YXJ9Lm0oJHt0aGlzLmdldF91cGRhdGVfbW91bnRfbm9kZShhbmNob3IpfSwgJHthbmNob3J9KTtcblx0XHRgO1xuICAgICAgICBpZiAoZHluYW1pYykge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRpZiAoJHtjb25kaXRpb259KSB7XG5cdFx0XHRcdFx0JHtib2R5fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdCR7dGhpcy52YXJ9LnAoI2N0eCwgI2RpcnR5KTtcblx0XHRcdFx0fVxuXHRcdFx0YCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRcdGlmICgke2NvbmRpdGlvbn0pIHtcblx0XHRcdFx0XHQke2JvZHl9XG5cdFx0XHRcdH1cblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoYXNfdHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbnRyby5wdXNoKGIgYEB0cmFuc2l0aW9uX2luKCR7dGhpcy52YXJ9KWApO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm91dHJvLnB1c2goYiBgQHRyYW5zaXRpb25fb3V0KCR7dGhpcy52YXJ9KWApO1xuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgJHt0aGlzLnZhcn0uZChkZXRhY2hpbmcpYCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRfc2xvdF9kZWZpbml0aW9uKGJsb2NrLCBzY29wZSwgbGV0cykge1xuICAgIGlmIChsZXRzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgcmV0dXJuIHsgYmxvY2ssIHNjb3BlIH07XG4gICAgY29uc3QgY29udGV4dF9pbnB1dCA9IHtcbiAgICAgICAgdHlwZTogJ09iamVjdFBhdHRlcm4nLFxuICAgICAgICBwcm9wZXJ0aWVzOiBsZXRzLm1hcChsID0+ICh7XG4gICAgICAgICAgICB0eXBlOiAnUHJvcGVydHknLFxuICAgICAgICAgICAga2luZDogJ2luaXQnLFxuICAgICAgICAgICAga2V5OiBsLm5hbWUsXG4gICAgICAgICAgICB2YWx1ZTogbC52YWx1ZSB8fCBsLm5hbWVcbiAgICAgICAgfSkpXG4gICAgfTtcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gW107XG4gICAgY29uc3QgdmFsdWVfbWFwID0gbmV3IE1hcCgpO1xuICAgIGxldHMuZm9yRWFjaChsID0+IHtcbiAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICBpZiAobC5uYW1lcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAvLyBtb3JlIHRoYW4gb25lLCBwcm9iYWJseSBkZXN0cnVjdHVyaW5nXG4gICAgICAgICAgICBjb25zdCB1bmlxdWVfbmFtZSA9IGJsb2NrLmdldF91bmlxdWVfbmFtZShsLm5hbWVzLmpvaW4oJ18nKSkubmFtZTtcbiAgICAgICAgICAgIHZhbHVlX21hcC5zZXQobC52YWx1ZSwgdW5pcXVlX25hbWUpO1xuICAgICAgICAgICAgdmFsdWUgPSB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogdW5pcXVlX25hbWUgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlID0gbC52YWx1ZSB8fCBsLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcHJvcGVydGllcy5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdQcm9wZXJ0eScsXG4gICAgICAgICAgICBraW5kOiAnaW5pdCcsXG4gICAgICAgICAgICBrZXk6IGwubmFtZSxcbiAgICAgICAgICAgIHZhbHVlXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIGNvbnN0IGNoYW5nZXNfaW5wdXQgPSB7XG4gICAgICAgIHR5cGU6ICdPYmplY3RQYXR0ZXJuJyxcbiAgICAgICAgcHJvcGVydGllc1xuICAgIH07XG4gICAgY29uc3QgbmFtZXMgPSBuZXcgU2V0KCk7XG4gICAgY29uc3QgbmFtZXNfbG9va3VwID0gbmV3IE1hcCgpO1xuICAgIGxldHMuZm9yRWFjaChsID0+IHtcbiAgICAgICAgbC5uYW1lcy5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgICAgbmFtZXMuYWRkKG5hbWUpO1xuICAgICAgICAgICAgaWYgKHZhbHVlX21hcC5oYXMobC52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBuYW1lc19sb29rdXAuc2V0KG5hbWUsIHZhbHVlX21hcC5nZXQobC52YWx1ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgICB0eXBlOiAnT2JqZWN0RXhwcmVzc2lvbicsXG4gICAgICAgIHByb3BlcnRpZXM6IEFycmF5LmZyb20obmFtZXMpLm1hcChuYW1lID0+IHAgYCR7YmxvY2sucmVuZGVyZXIuY29udGV4dF9sb29rdXAuZ2V0KG5hbWUpLmluZGV4fTogJHtuYW1lfWApXG4gICAgfTtcbiAgICBjb25zdCB7IGNvbnRleHRfbG9va3VwIH0gPSBibG9jay5yZW5kZXJlcjtcbiAgICAvLyBpIGFtIHdlbGwgYXdhcmUgdGhhdCB0aGlzIGNvZGUgaXMgZ3Jvc3NcbiAgICAvLyBUT0RPOiBjb250ZXh0LW92ZXJmbG93IG1ha2UgaXQgbGVzcyBncm9zc1xuICAgIGNvbnN0IGNoYW5nZXMgPSB7XG4gICAgICAgIHR5cGU6ICdQYXJlbnRoZXNpemVkRXhwcmVzc2lvbicsXG4gICAgICAgIGdldCBleHByZXNzaW9uKCkge1xuICAgICAgICAgICAgaWYgKGJsb2NrLnJlbmRlcmVyLmNvbnRleHRfb3ZlcmZsb3cpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBncm91cGVkID0gW107XG4gICAgICAgICAgICAgICAgQXJyYXkuZnJvbShuYW1lcykuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGNvbnRleHRfbG9va3VwLmdldChuYW1lKS5pbmRleC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZyA9IE1hdGguZmxvb3IoaSAvIDMxKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9va3VwX25hbWUgPSBuYW1lc19sb29rdXAuaGFzKG5hbWUpID8gbmFtZXNfbG9va3VwLmdldChuYW1lKSA6IG5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ3JvdXBlZFtnXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwZWRbZ10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBlZFtnXS5wdXNoKHsgbmFtZTogbG9va3VwX25hbWUsIG46IGkgJSAzMSB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50cyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGcgPSAwOyBnIDwgZ3JvdXBlZC5sZW5ndGg7IGcgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50c1tnXSA9IGdyb3VwZWRbZ11cbiAgICAgICAgICAgICAgICAgICAgICAgID8gZ3JvdXBlZFtnXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKHsgbmFtZSwgbiB9KSA9PiB4IGAke25hbWV9ID8gJHsxIDw8IG59IDogMGApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlZHVjZSgobGhzLCByaHMpID0+IHggYCR7bGhzfSB8ICR7cmhzfWApXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHggYDBgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQXJyYXlFeHByZXNzaW9uJyxcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEFycmF5LmZyb20obmFtZXMpXG4gICAgICAgICAgICAgICAgLm1hcChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBsb29rdXBfbmFtZSA9IG5hbWVzX2xvb2t1cC5oYXMobmFtZSkgPyBuYW1lc19sb29rdXAuZ2V0KG5hbWUpIDogbmFtZTtcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gY29udGV4dF9sb29rdXAuZ2V0KG5hbWUpLmluZGV4LnZhbHVlO1xuICAgICAgICAgICAgICAgIHJldHVybiB4IGAke2xvb2t1cF9uYW1lfSA/ICR7MSA8PCBpfSA6IDBgO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAucmVkdWNlKChsaHMsIHJocykgPT4geCBgJHtsaHN9IHwgJHtyaHN9YCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICAgIGJsb2NrLFxuICAgICAgICBzY29wZSxcbiAgICAgICAgZ2V0X2NvbnRleHQ6IHggYCR7Y29udGV4dF9pbnB1dH0gPT4gJHtjb250ZXh0fWAsXG4gICAgICAgIGdldF9jaGFuZ2VzOiB4IGAke2NoYW5nZXNfaW5wdXR9ID0+ICR7Y2hhbmdlc31gXG4gICAgfTtcbn1cblxuY2xhc3MgU2xvdFRlbXBsYXRlV3JhcHBlciBleHRlbmRzIFdyYXBwZXIge1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlLCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUpO1xuICAgICAgICBjb25zdCB7IHNjb3BlLCBsZXRzLCBjb25zdF90YWdzLCBzbG90X3RlbXBsYXRlX25hbWUgfSA9IHRoaXMubm9kZTtcbiAgICAgICAgbGV0cy5mb3JFYWNoKGwgPT4ge1xuICAgICAgICAgICAgZXh0cmFjdF9uYW1lcyhsLnZhbHVlIHx8IGwubmFtZSkuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICByZW5kZXJlci5hZGRfdG9fY29udGV4dChuYW1lLCB0cnVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgYWRkX2NvbnN0X3RhZ3NfY29udGV4dChyZW5kZXJlciwgY29uc3RfdGFncyk7XG4gICAgICAgIHRoaXMuYmxvY2sgPSBibG9jay5jaGlsZCh7XG4gICAgICAgICAgICBjb21tZW50OiBjcmVhdGVfZGVidWdnaW5nX2NvbW1lbnQodGhpcy5ub2RlLCB0aGlzLnJlbmRlcmVyLmNvbXBvbmVudCksXG4gICAgICAgICAgICBuYW1lOiB0aGlzLnJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoYGNyZWF0ZV8ke3Nhbml0aXplKHNsb3RfdGVtcGxhdGVfbmFtZSl9X3Nsb3RgKSxcbiAgICAgICAgICAgIHR5cGU6ICdzbG90J1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5ibG9ja3MucHVzaCh0aGlzLmJsb2NrKTtcbiAgICAgICAgY29uc3Qgc2VlbiA9IG5ldyBTZXQobGV0cy5tYXAobCA9PiBsLm5hbWUubmFtZSkpO1xuICAgICAgICB0aGlzLnBhcmVudC5ub2RlLmxldHMuZm9yRWFjaChsID0+IHtcbiAgICAgICAgICAgIGlmICghc2Vlbi5oYXMobC5uYW1lLm5hbWUpKVxuICAgICAgICAgICAgICAgIGxldHMucHVzaChsKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucGFyZW50LnNldF9zbG90KHNsb3RfdGVtcGxhdGVfbmFtZSwgZ2V0X3Nsb3RfZGVmaW5pdGlvbih0aGlzLmJsb2NrLCBzY29wZSwgbGV0cykpO1xuICAgICAgICB0aGlzLmZyYWdtZW50ID0gbmV3IEZyYWdtZW50V3JhcHBlcihyZW5kZXJlciwgdGhpcy5ibG9jaywgbm9kZS50eXBlID09PSAnU2xvdFRlbXBsYXRlJyA/IG5vZGUuY2hpbGRyZW4gOiBbbm9kZV0sIHRoaXMsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZyk7XG4gICAgICAgIHRoaXMuYmxvY2sucGFyZW50LmFkZF9kZXBlbmRlbmNpZXModGhpcy5ibG9jay5kZXBlbmRlbmNpZXMpO1xuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHRoaXMuZnJhZ21lbnQucmVuZGVyKHRoaXMuYmxvY2ssIG51bGwsIHggYCNub2Rlc2ApO1xuICAgICAgICBpZiAodGhpcy5ub2RlLmNvbnN0X3RhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJfZ2V0X2NvbnRleHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXJfZ2V0X2NvbnRleHQoKSB7XG4gICAgICAgIGNvbnN0IGdldF9jb250ZXh0ID0gdGhpcy5ibG9jay5yZW5kZXJlci5jb21wb25lbnQuZ2V0X3VuaXF1ZV9uYW1lKCdnZXRfY29udGV4dCcpO1xuICAgICAgICB0aGlzLmJsb2NrLnJlbmRlcmVyLmJsb2Nrcy5wdXNoKGIgYFxuXHRcdFx0ZnVuY3Rpb24gJHtnZXRfY29udGV4dH0oI2N0eCkge1xuXHRcdFx0XHQke2FkZF9jb25zdF90YWdzKHRoaXMuYmxvY2ssIHRoaXMubm9kZS5jb25zdF90YWdzLCAnI2N0eCcpfVxuXHRcdFx0fVxuXHRcdGApO1xuICAgICAgICB0aGlzLmJsb2NrLmNodW5rcy5kZWNsYXJhdGlvbnMucHVzaChiIGAke2dldF9jb250ZXh0fSgjY3R4KWApO1xuICAgICAgICBpZiAodGhpcy5ibG9jay5oYXNfdXBkYXRlX21ldGhvZCkge1xuICAgICAgICAgICAgdGhpcy5ibG9jay5jaHVua3MudXBkYXRlLnVuc2hpZnQoYiBgJHtnZXRfY29udGV4dH0oI2N0eClgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gc3RyaW5nX3RvX21lbWJlcl9leHByZXNzaW9uKG5hbWUpIHtcbiAgICBjb25zdCBwYXJ0cyA9IG5hbWUuc3BsaXQoJy4nKTtcbiAgICBsZXQgbm9kZSA9IHtcbiAgICAgICAgdHlwZTogJ0lkZW50aWZpZXInLFxuICAgICAgICBuYW1lOiBwYXJ0c1swXVxuICAgIH07XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBub2RlID0ge1xuICAgICAgICAgICAgdHlwZTogJ01lbWJlckV4cHJlc3Npb24nLFxuICAgICAgICAgICAgb2JqZWN0OiBub2RlLFxuICAgICAgICAgICAgcHJvcGVydHk6IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiBwYXJ0c1tpXSB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBub2RlO1xufVxuXG5jb25zdCByZWdleF9pbnZhbGlkX3ZhcmlhYmxlX2lkZW50aWZpZXJfY2hhcmFjdGVycyQzID0gL1teYS16QS1aXyRdL2c7XG5jbGFzcyBJbmxpbmVDb21wb25lbnRXcmFwcGVyIGV4dGVuZHMgV3JhcHBlciB7XG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZykge1xuICAgICAgICBzdXBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSk7XG4gICAgICAgIHRoaXMuc2xvdHMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgdGhpcy5jYW5ub3RfdXNlX2lubmVyaHRtbCgpO1xuICAgICAgICB0aGlzLm5vdF9zdGF0aWNfY29udGVudCgpO1xuICAgICAgICBpZiAodGhpcy5ub2RlLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIGJsb2NrLmFkZF9kZXBlbmRlbmNpZXModGhpcy5ub2RlLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5vZGUuYXR0cmlidXRlcy5mb3JFYWNoKGF0dHIgPT4ge1xuICAgICAgICAgICAgYmxvY2suYWRkX2RlcGVuZGVuY2llcyhhdHRyLmRlcGVuZGVuY2llcyk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm5vZGUuYmluZGluZ3MuZm9yRWFjaChiaW5kaW5nID0+IHtcbiAgICAgICAgICAgIGlmIChiaW5kaW5nLmlzX2NvbnRleHR1YWwpIHtcbiAgICAgICAgICAgICAgICBtYXJrX2VhY2hfYmxvY2tfYmluZGluZ3ModGhpcywgYmluZGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBibG9jay5hZGRfZGVwZW5kZW5jaWVzKGJpbmRpbmcuZXhwcmVzc2lvbi5kZXBlbmRlbmNpZXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5ub2RlLmhhbmRsZXJzLmZvckVhY2goaGFuZGxlciA9PiB7XG4gICAgICAgICAgICBpZiAoaGFuZGxlci5leHByZXNzaW9uKSB7XG4gICAgICAgICAgICAgICAgYmxvY2suYWRkX2RlcGVuZGVuY2llcyhoYW5kbGVyLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubm9kZS5jc3NfY3VzdG9tX3Byb3BlcnRpZXMuZm9yRWFjaChhdHRyID0+IHtcbiAgICAgICAgICAgIGJsb2NrLmFkZF9kZXBlbmRlbmNpZXMoYXR0ci5kZXBlbmRlbmNpZXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy52YXIgPSB7XG4gICAgICAgICAgICB0eXBlOiAnSWRlbnRpZmllcicsXG4gICAgICAgICAgICBuYW1lOiAodGhpcy5ub2RlLm5hbWUgPT09ICdzdmVsdGU6c2VsZicgPyByZW5kZXJlci5jb21wb25lbnQubmFtZS5uYW1lIDpcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUubmFtZSA9PT0gJ3N2ZWx0ZTpjb21wb25lbnQnID8gJ3N3aXRjaF9pbnN0YW5jZScgOlxuICAgICAgICAgICAgICAgICAgICBzYW5pdGl6ZSh0aGlzLm5vZGUubmFtZSkpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMubm9kZS5sZXRzLmZvckVhY2gobCA9PiB7XG4gICAgICAgICAgICAgICAgZXh0cmFjdF9uYW1lcyhsLnZhbHVlIHx8IGwubmFtZSkuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3RvX2NvbnRleHQobmFtZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4gPSB0aGlzLm5vZGUuY2hpbGRyZW4ubWFwKGNoaWxkID0+IG5ldyBTbG90VGVtcGxhdGVXcmFwcGVyKHJlbmRlcmVyLCBibG9jaywgdGhpcywgY2hpbGQsIHN0cmlwX3doaXRlc3BhY2UsIG5leHRfc2libGluZykpO1xuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmFkZF9vdXRybygpO1xuICAgIH1cbiAgICBzZXRfc2xvdChuYW1lLCBzbG90X2RlZmluaXRpb24pIHtcbiAgICAgICAgaWYgKHRoaXMuc2xvdHMuaGFzKG5hbWUpKSB7XG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJ2RlZmF1bHQnKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGb3VuZCBlbGVtZW50cyB3aXRob3V0IHNsb3QgYXR0cmlidXRlIHdoZW4gdXNpbmcgc2xvdD1cImRlZmF1bHRcIicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEdXBsaWNhdGUgc2xvdCBuYW1lIFwiJHtuYW1lfVwiIGluIDwke3RoaXMubm9kZS5uYW1lfT5gKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNsb3RzLnNldChuYW1lLCBzbG90X2RlZmluaXRpb24pO1xuICAgIH1cbiAgICB3YXJuX2lmX3JlYWN0aXZlKCkge1xuICAgICAgICBjb25zdCB7IG5hbWUgfSA9IHRoaXMubm9kZTtcbiAgICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLnJlbmRlcmVyLmNvbXBvbmVudC52YXJfbG9va3VwLmdldChuYW1lKTtcbiAgICAgICAgaWYgKCF2YXJpYWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YXJpYWJsZS5yZWFzc2lnbmVkIHx8IHZhcmlhYmxlLmV4cG9ydF9uYW1lIHx8IHZhcmlhYmxlLmlzX3JlYWN0aXZlX2RlcGVuZGVuY3kpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuY29tcG9uZW50Lndhcm4odGhpcy5ub2RlLCBjb21waWxlcl93YXJuaW5ncy5yZWFjdGl2ZV9jb21wb25lbnQobmFtZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbmRlcihibG9jaywgcGFyZW50X25vZGUsIHBhcmVudF9ub2Rlcykge1xuICAgICAgICB0aGlzLndhcm5faWZfcmVhY3RpdmUoKTtcbiAgICAgICAgY29uc3QgeyByZW5kZXJlciB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgeyBjb21wb25lbnQgfSA9IHJlbmRlcmVyO1xuICAgICAgICBjb25zdCBuYW1lID0gdGhpcy52YXI7XG4gICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShuYW1lKTtcbiAgICAgICAgY29uc3QgY29tcG9uZW50X29wdHMgPSB4IGB7fWA7XG4gICAgICAgIGNvbnN0IHN0YXRlbWVudHMgPSBbXTtcbiAgICAgICAgY29uc3QgdXBkYXRlcyA9IFtdO1xuICAgICAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZF90b19jb250ZXh0KCckJHNjb3BlJywgdHJ1ZSk7XG4gICAgICAgICAgICBjaGlsZC5yZW5kZXIoYmxvY2ssIG51bGwsIHggYCNub2Rlc2ApO1xuICAgICAgICB9KTtcbiAgICAgICAgbGV0IHByb3BzO1xuICAgICAgICBjb25zdCBuYW1lX2NoYW5nZXMgPSBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7bmFtZS5uYW1lfV9jaGFuZ2VzYCk7XG4gICAgICAgIGNvbnN0IHVzZXNfc3ByZWFkID0gISF0aGlzLm5vZGUuYXR0cmlidXRlcy5maW5kKGEgPT4gYS5pc19zcHJlYWQpO1xuICAgICAgICAvLyByZW1vdmluZyBlbXB0eSBzbG90XG4gICAgICAgIGZvciAoY29uc3Qgc2xvdCBvZiB0aGlzLnNsb3RzLmtleXMoKSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnNsb3RzLmdldChzbG90KS5ibG9jay5oYXNfY29udGVudCgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVfYmxvY2sodGhpcy5zbG90cy5nZXQoc2xvdCkuYmxvY2spO1xuICAgICAgICAgICAgICAgIHRoaXMuc2xvdHMuZGVsZXRlKHNsb3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhhc19jc3NfY3VzdG9tX3Byb3BlcnRpZXMgPSB0aGlzLm5vZGUuY3NzX2N1c3RvbV9wcm9wZXJ0aWVzLmxlbmd0aCA+IDA7XG4gICAgICAgIGNvbnN0IGlzX3N2Z19uYW1lc3BhY2UgPSB0aGlzLm5vZGUubmFtZXNwYWNlID09PSBuYW1lc3BhY2VzLnN2ZztcbiAgICAgICAgY29uc3QgY3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXJfZWxlbWVudCA9IGlzX3N2Z19uYW1lc3BhY2UgPyAnZycgOiAnZGl2JztcbiAgICAgICAgY29uc3QgY3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXIgPSBoYXNfY3NzX2N1c3RvbV9wcm9wZXJ0aWVzID8gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyX2VsZW1lbnQpIDogbnVsbDtcbiAgICAgICAgaWYgKGhhc19jc3NfY3VzdG9tX3Byb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5pdGlhbF9wcm9wcyA9IHRoaXMuc2xvdHMuc2l6ZSA+IDBcbiAgICAgICAgICAgID8gW1xuICAgICAgICAgICAgICAgIHAgYCQkc2xvdHM6IHtcblx0XHRcdFx0XHQke0FycmF5LmZyb20odGhpcy5zbG90cykubWFwKChbbmFtZSwgc2xvdF0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHAgYCR7bmFtZX06IFske3Nsb3QuYmxvY2submFtZX0sICR7c2xvdC5nZXRfY29udGV4dCB8fCBudWxsfSwgJHtzbG90LmdldF9jaGFuZ2VzIHx8IG51bGx9XWA7XG4gICAgICAgICAgICAgICAgfSl9XG5cdFx0XHRcdH1gLFxuICAgICAgICAgICAgICAgIHAgYCQkc2NvcGU6IHtcblx0XHRcdFx0XHRjdHg6ICNjdHhcblx0XHRcdFx0fWBcbiAgICAgICAgICAgIF1cbiAgICAgICAgICAgIDogW107XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZV9vYmplY3QgPSB1c2VzX3NwcmVhZFxuICAgICAgICAgICAgPyB4IGB7ICR7aW5pdGlhbF9wcm9wc30gfWBcbiAgICAgICAgICAgIDogeCBge1xuXHRcdFx0XHQke3RoaXMubm9kZS5hdHRyaWJ1dGVzLm1hcChhdHRyID0+IHAgYCR7YXR0ci5uYW1lfTogJHthdHRyLmdldF92YWx1ZShibG9jayl9YCl9LFxuXHRcdFx0XHQke2luaXRpYWxfcHJvcHN9XG5cdFx0XHR9YDtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5hdHRyaWJ1dGVzLmxlbmd0aCB8fCB0aGlzLm5vZGUuYmluZGluZ3MubGVuZ3RoIHx8IGluaXRpYWxfcHJvcHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoIXVzZXNfc3ByZWFkICYmIHRoaXMubm9kZS5iaW5kaW5ncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnRfb3B0cy5wcm9wZXJ0aWVzLnB1c2gocCBgcHJvcHM6ICR7YXR0cmlidXRlX29iamVjdH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb3BzID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke25hbWUubmFtZX1fcHJvcHNgKTtcbiAgICAgICAgICAgICAgICBjb21wb25lbnRfb3B0cy5wcm9wZXJ0aWVzLnB1c2gocCBgcHJvcHM6ICR7cHJvcHN9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbXBvbmVudC5jb21waWxlX29wdGlvbnMuZGV2KSB7XG4gICAgICAgICAgICAvLyBUT0RPIHRoaXMgaXMgYSB0ZXJyaWJsZSBoYWNrLCBidXQgd2l0aG91dCBpdCB0aGUgY29tcG9uZW50XG4gICAgICAgICAgICAvLyB3aWxsIGNvbXBsYWluIHRoYXQgb3B0aW9ucy50YXJnZXQgaXMgbWlzc2luZy4gVGhpcyB3b3VsZFxuICAgICAgICAgICAgLy8gd29yayBiZXR0ZXIgaWYgY29tcG9uZW50cyBoYWQgc2VwYXJhdGUgcHVibGljIGFuZCBwcml2YXRlXG4gICAgICAgICAgICAvLyBBUElzXG4gICAgICAgICAgICBjb21wb25lbnRfb3B0cy5wcm9wZXJ0aWVzLnB1c2gocCBgJCRpbmxpbmU6IHRydWVgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmcmFnbWVudF9kZXBlbmRlbmNpZXMgPSBuZXcgU2V0KHRoaXMuc2xvdHMuc2l6ZSA/IFsnJCRzY29wZSddIDogW10pO1xuICAgICAgICB0aGlzLnNsb3RzLmZvckVhY2goc2xvdCA9PiB7XG4gICAgICAgICAgICBzbG90LmJsb2NrLmRlcGVuZGVuY2llcy5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzX2xldCA9IHNsb3Quc2NvcGUuaXNfbGV0KG5hbWUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhcmlhYmxlID0gcmVuZGVyZXIuY29tcG9uZW50LnZhcl9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChpc19sZXQgfHwgaXNfZHluYW1pYyh2YXJpYWJsZSkpXG4gICAgICAgICAgICAgICAgICAgIGZyYWdtZW50X2RlcGVuZGVuY2llcy5hZGQobmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGR5bmFtaWNfYXR0cmlidXRlcyA9IHRoaXMubm9kZS5hdHRyaWJ1dGVzLmZpbHRlcihhID0+IGEuZ2V0X2RlcGVuZGVuY2llcygpLmxlbmd0aCA+IDApO1xuICAgICAgICBpZiAoIXVzZXNfc3ByZWFkICYmIChkeW5hbWljX2F0dHJpYnV0ZXMubGVuZ3RoID4gMCB8fCB0aGlzLm5vZGUuYmluZGluZ3MubGVuZ3RoID4gMCB8fCBmcmFnbWVudF9kZXBlbmRlbmNpZXMuc2l6ZSA+IDApKSB7XG4gICAgICAgICAgICB1cGRhdGVzLnB1c2goYiBgY29uc3QgJHtuYW1lX2NoYW5nZXN9ID0ge307YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubm9kZS5hdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHVzZXNfc3ByZWFkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGV2ZWxzID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke3RoaXMudmFyLm5hbWV9X3NwcmVhZF9sZXZlbHNgKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbml0aWFsX3Byb3BzID0gW107XG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsbF9kZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmF0dHJpYnV0ZXMuZm9yRWFjaChhdHRyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYWRkX3RvX3NldChhbGxfZGVwZW5kZW5jaWVzLCBhdHRyLmRlcGVuZGVuY2llcyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmF0dHJpYnV0ZXMuZm9yRWFjaCgoYXR0ciwgaSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IG5hbWUsIGRlcGVuZGVuY2llcyB9ID0gYXR0cjtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZGl0aW9uID0gZGVwZW5kZW5jaWVzLnNpemUgPiAwICYmIChkZXBlbmRlbmNpZXMuc2l6ZSAhPT0gYWxsX2RlcGVuZGVuY2llcy5zaXplKVxuICAgICAgICAgICAgICAgICAgICAgICAgPyByZW5kZXJlci5kaXJ0eShBcnJheS5mcm9tKGRlcGVuZGVuY2llcykpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVuY2hhbmdlZCA9IGRlcGVuZGVuY2llcy5zaXplID09PSAwO1xuICAgICAgICAgICAgICAgICAgICBsZXQgY2hhbmdlX29iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHIuaXNfc3ByZWFkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGF0dHIuZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxfcHJvcHMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWVfb2JqZWN0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ci5leHByZXNzaW9uLm5vZGUudHlwZSAhPT0gJ09iamVjdEV4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVfb2JqZWN0ID0geCBgQGdldF9zcHJlYWRfb2JqZWN0KCR7dmFsdWV9KWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2Vfb2JqZWN0ID0gdmFsdWVfb2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2JqID0geCBgeyAke25hbWV9OiAke2F0dHIuZ2V0X3ZhbHVlKGJsb2NrKX0gfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsX3Byb3BzLnB1c2gob2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZV9vYmplY3QgPSBvYmo7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlcy5wdXNoKHVuY2hhbmdlZFxuICAgICAgICAgICAgICAgICAgICAgICAgPyB4IGAke2xldmVsc31bJHtpfV1gXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGNvbmRpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8geCBgJHtjb25kaXRpb259ICYmICR7Y2hhbmdlX29iamVjdH1gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBjaGFuZ2Vfb2JqZWN0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0XHRcdGNvbnN0ICR7bGV2ZWxzfSA9IFtcblx0XHRcdFx0XHRcdCR7aW5pdGlhbF9wcm9wc31cblx0XHRcdFx0XHRdO1xuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgICAgICBzdGF0ZW1lbnRzLnB1c2goYiBgXG5cdFx0XHRcdFx0Zm9yIChsZXQgI2kgPSAwOyAjaSA8ICR7bGV2ZWxzfS5sZW5ndGg7ICNpICs9IDEpIHtcblx0XHRcdFx0XHRcdCR7cHJvcHN9ID0gQGFzc2lnbigke3Byb3BzfSwgJHtsZXZlbHN9WyNpXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgICAgICBpZiAoYWxsX2RlcGVuZGVuY2llcy5zaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbmRpdGlvbiA9IHJlbmRlcmVyLmRpcnR5KEFycmF5LmZyb20oYWxsX2RlcGVuZGVuY2llcykpO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVzLnB1c2goYiBgXG5cdFx0XHRcdFx0XHRjb25zdCAke25hbWVfY2hhbmdlc30gPSAke2NvbmRpdGlvbn0gPyBAZ2V0X3NwcmVhZF91cGRhdGUoJHtsZXZlbHN9LCBbXG5cdFx0XHRcdFx0XHRcdCR7Y2hhbmdlc31cblx0XHRcdFx0XHRcdF0pIDoge31cblx0XHRcdFx0XHRgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZXMucHVzaChiIGBcblx0XHRcdFx0XHRcdGNvbnN0ICR7bmFtZV9jaGFuZ2VzfSA9IHt9O1xuXHRcdFx0XHRcdGApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGR5bmFtaWNfYXR0cmlidXRlcy5mb3JFYWNoKChhdHRyaWJ1dGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzID0gYXR0cmlidXRlLmdldF9kZXBlbmRlbmNpZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlcGVuZGVuY2llcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25kaXRpb24gPSByZW5kZXJlci5kaXJ0eShkZXBlbmRlbmNpZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKGIgYFxuXHRcdFx0XHRcdFx0XHRpZiAoJHtjb25kaXRpb259KSAke25hbWVfY2hhbmdlc30uJHthdHRyaWJ1dGUubmFtZX0gPSAke2F0dHJpYnV0ZS5nZXRfdmFsdWUoYmxvY2spfTtcblx0XHRcdFx0XHRcdGApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZyYWdtZW50X2RlcGVuZGVuY2llcy5zaXplID4gMCkge1xuICAgICAgICAgICAgdXBkYXRlcy5wdXNoKGIgYFxuXHRcdFx0XHRpZiAoJHtyZW5kZXJlci5kaXJ0eShBcnJheS5mcm9tKGZyYWdtZW50X2RlcGVuZGVuY2llcykpfSkge1xuXHRcdFx0XHRcdCR7bmFtZV9jaGFuZ2VzfS4kJHNjb3BlID0geyBkaXJ0eTogI2RpcnR5LCBjdHg6ICNjdHggfTtcblx0XHRcdFx0fWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG11bmdlZF9iaW5kaW5ncyA9IHRoaXMubm9kZS5iaW5kaW5ncy5tYXAoYmluZGluZyA9PiB7XG4gICAgICAgICAgICBjb21wb25lbnQuaGFzX3JlYWN0aXZlX2Fzc2lnbm1lbnRzID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChiaW5kaW5nLm5hbWUgPT09ICd0aGlzJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBiaW5kX3RoaXMoY29tcG9uZW50LCBibG9jaywgbmV3IEJpbmRpbmdXcmFwcGVyKGJsb2NrLCBiaW5kaW5nLCB0aGlzKSwgdGhpcy52YXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaWQgPSBjb21wb25lbnQuZ2V0X3VuaXF1ZV9uYW1lKGAke3RoaXMudmFyLm5hbWV9XyR7YmluZGluZy5uYW1lfV9iaW5kaW5nYCk7XG4gICAgICAgICAgICByZW5kZXJlci5hZGRfdG9fY29udGV4dChpZC5uYW1lKTtcbiAgICAgICAgICAgIGNvbnN0IGNhbGxlZSA9IHJlbmRlcmVyLnJlZmVyZW5jZShpZCk7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGluZyA9IGJsb2NrLmdldF91bmlxdWVfbmFtZShgdXBkYXRpbmdfJHtiaW5kaW5nLm5hbWV9YCk7XG4gICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUodXBkYXRpbmcpO1xuICAgICAgICAgICAgY29uc3Qgc25pcHBldCA9IGJpbmRpbmcuZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgIHN0YXRlbWVudHMucHVzaChiIGBcblx0XHRcdFx0aWYgKCR7c25pcHBldH0gIT09IHZvaWQgMCkge1xuXHRcdFx0XHRcdCR7cHJvcHN9LiR7YmluZGluZy5uYW1lfSA9ICR7c25pcHBldH07XG5cdFx0XHRcdH1gKTtcbiAgICAgICAgICAgIHVwZGF0ZXMucHVzaChiIGBcblx0XHRcdFx0aWYgKCEke3VwZGF0aW5nfSAmJiAke3JlbmRlcmVyLmRpcnR5KEFycmF5LmZyb20oYmluZGluZy5leHByZXNzaW9uLmRlcGVuZGVuY2llcykpfSkge1xuXHRcdFx0XHRcdCR7dXBkYXRpbmd9ID0gdHJ1ZTtcblx0XHRcdFx0XHQke25hbWVfY2hhbmdlc30uJHtiaW5kaW5nLm5hbWV9ID0gJHtzbmlwcGV0fTtcblx0XHRcdFx0XHRAYWRkX2ZsdXNoX2NhbGxiYWNrKCgpID0+ICR7dXBkYXRpbmd9ID0gZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHRgKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzID0gQXJyYXkuZnJvbShiaW5kaW5nLmV4cHJlc3Npb24uY29udGV4dHVhbF9kZXBlbmRlbmNpZXMpO1xuICAgICAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzID0gQXJyYXkuZnJvbShiaW5kaW5nLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIGxldCBsaHMgPSBiaW5kaW5nLnJhd19leHByZXNzaW9uO1xuICAgICAgICAgICAgaWYgKGJpbmRpbmcuaXNfY29udGV4dHVhbCAmJiBiaW5kaW5nLmV4cHJlc3Npb24ubm9kZS50eXBlID09PSAnSWRlbnRpZmllcicpIHtcbiAgICAgICAgICAgICAgICAvLyBiaW5kOng9e3l9IOKAlCB3ZSBjYW4ndCBqdXN0IGRvIGB5ID0geGAsIHdlIG5lZWQgdG9cbiAgICAgICAgICAgICAgICAvLyB0byBgYXJyYXlbaW5kZXhdID0geDtcbiAgICAgICAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IGJpbmRpbmcuZXhwcmVzc2lvbi5ub2RlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgb2JqZWN0LCBwcm9wZXJ0eSwgc25pcHBldCB9ID0gYmxvY2suYmluZGluZ3MuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgIGxocyA9IHNuaXBwZXQ7XG4gICAgICAgICAgICAgICAgY29udGV4dHVhbF9kZXBlbmRlbmNpZXMucHVzaChvYmplY3QubmFtZSwgcHJvcGVydHkubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwYXJhbXMgPSBbeCBgI3ZhbHVlYF07XG4gICAgICAgICAgICBjb25zdCBhcmdzID0gW3ggYCN2YWx1ZWBdO1xuICAgICAgICAgICAgaWYgKGNvbnRleHR1YWxfZGVwZW5kZW5jaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0dWFsX2RlcGVuZGVuY2llcy5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnSWRlbnRpZmllcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5hZGRfdG9fY29udGV4dChuYW1lLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHJlbmRlcmVyLnJlZmVyZW5jZShuYW1lKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYmxvY2subWFpbnRhaW5fY29udGV4dCA9IHRydWU7IC8vIFRPRE8gcHV0IHRoaXMgc29tZXdoZXJlIG1vcmUgbG9naWNhbFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdFx0ZnVuY3Rpb24gJHtpZH0oI3ZhbHVlKSB7XG5cdFx0XHRcdFx0JHtjYWxsZWV9KCR7YXJnc30pO1xuXHRcdFx0XHR9XG5cdFx0XHRgKTtcbiAgICAgICAgICAgIGxldCBpbnZhbGlkYXRlX2JpbmRpbmcgPSBiIGBcblx0XHRcdFx0JHtsaHN9ID0gI3ZhbHVlO1xuXHRcdFx0XHQke3JlbmRlcmVyLmludmFsaWRhdGUoZGVwZW5kZW5jaWVzWzBdKX07XG5cdFx0XHRgO1xuICAgICAgICAgICAgaWYgKGJpbmRpbmcuZXhwcmVzc2lvbi5ub2RlLnR5cGUgPT09ICdNZW1iZXJFeHByZXNzaW9uJykge1xuICAgICAgICAgICAgICAgIGludmFsaWRhdGVfYmluZGluZyA9IGIgYFxuXHRcdFx0XHRcdGlmICgkJHNlbGYuJCQubm90X2VxdWFsKCR7bGhzfSwgI3ZhbHVlKSkge1xuXHRcdFx0XHRcdFx0JHtpbnZhbGlkYXRlX2JpbmRpbmd9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYm9keSA9IGIgYFxuXHRcdFx0XHRmdW5jdGlvbiAke2lkfSgke3BhcmFtc30pIHtcblx0XHRcdFx0XHQke2ludmFsaWRhdGVfYmluZGluZ31cblx0XHRcdFx0fVxuXHRcdFx0YDtcbiAgICAgICAgICAgIGNvbXBvbmVudC5wYXJ0bHlfaG9pc3RlZC5wdXNoKGJvZHkpO1xuICAgICAgICAgICAgcmV0dXJuIGIgYEBiaW5kaW5nX2NhbGxiYWNrcy5wdXNoKCgpID0+IEBiaW5kKCR7dGhpcy52YXJ9LCAnJHtiaW5kaW5nLm5hbWV9JywgJHtpZH0pKTtgO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbXVuZ2VkX2hhbmRsZXJzID0gdGhpcy5ub2RlLmhhbmRsZXJzLm1hcChoYW5kbGVyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50X2hhbmRsZXIgPSBuZXcgRXZlbnRIYW5kbGVyV3JhcHBlcihoYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgICAgIGxldCBzbmlwcGV0ID0gZXZlbnRfaGFuZGxlci5nZXRfc25pcHBldChibG9jayk7XG4gICAgICAgICAgICBpZiAoaGFuZGxlci5tb2RpZmllcnMuaGFzKCdvbmNlJykpXG4gICAgICAgICAgICAgICAgc25pcHBldCA9IHggYEBvbmNlKCR7c25pcHBldH0pYDtcbiAgICAgICAgICAgIHJldHVybiBiIGAke25hbWV9LiRvbihcIiR7aGFuZGxlci5uYW1lfVwiLCAke3NuaXBwZXR9KTtgO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbW91bnRfdGFyZ2V0ID0gaGFzX2Nzc19jdXN0b21fcHJvcGVydGllcyA/IGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyIDogKHBhcmVudF9ub2RlIHx8ICcjdGFyZ2V0Jyk7XG4gICAgICAgIGNvbnN0IG1vdW50X2FuY2hvciA9IGhhc19jc3NfY3VzdG9tX3Byb3BlcnRpZXMgPyAnbnVsbCcgOiAocGFyZW50X25vZGUgPyAnbnVsbCcgOiAnI2FuY2hvcicpO1xuICAgICAgICBjb25zdCB0b19jbGFpbSA9IHBhcmVudF9ub2RlcyAmJiB0aGlzLnJlbmRlcmVyLm9wdGlvbnMuaHlkcmF0YWJsZTtcbiAgICAgICAgbGV0IGNsYWltX25vZGVzID0gcGFyZW50X25vZGVzO1xuICAgICAgICBpZiAodGhpcy5ub2RlLm5hbWUgPT09ICdzdmVsdGU6Y29tcG9uZW50Jykge1xuICAgICAgICAgICAgY29uc3Qgc3dpdGNoX3ZhbHVlID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdzd2l0Y2hfdmFsdWUnKTtcbiAgICAgICAgICAgIGNvbnN0IHN3aXRjaF9wcm9wcyA9IGJsb2NrLmdldF91bmlxdWVfbmFtZSgnc3dpdGNoX3Byb3BzJyk7XG4gICAgICAgICAgICBjb25zdCBzbmlwcGV0ID0gdGhpcy5ub2RlLmV4cHJlc3Npb24ubWFuaXB1bGF0ZShibG9jayk7XG4gICAgICAgICAgICBpZiAoaGFzX2Nzc19jdXN0b21fcHJvcGVydGllcykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0X2Nzc19jdXN0b21fcHJvcGVydGllcyhibG9jaywgY3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXIsIGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyX2VsZW1lbnQsIGlzX3N2Z19uYW1lc3BhY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdFx0dmFyICR7c3dpdGNoX3ZhbHVlfSA9ICR7c25pcHBldH07XG5cblx0XHRcdFx0ZnVuY3Rpb24gJHtzd2l0Y2hfcHJvcHN9KCNjdHgpIHtcblx0XHRcdFx0XHQkeyh0aGlzLm5vZGUuYXR0cmlidXRlcy5sZW5ndGggPiAwIHx8IHRoaXMubm9kZS5iaW5kaW5ncy5sZW5ndGggPiAwKSAmJiBiIGBcblx0XHRcdFx0XHQke3Byb3BzICYmIGIgYGxldCAke3Byb3BzfSA9ICR7YXR0cmlidXRlX29iamVjdH07YH1gfVxuXHRcdFx0XHRcdCR7c3RhdGVtZW50c31cblx0XHRcdFx0XHRyZXR1cm4gJHtjb21wb25lbnRfb3B0c307XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoJHtzd2l0Y2hfdmFsdWV9KSB7XG5cdFx0XHRcdFx0JHtuYW1lfSA9IEBjb25zdHJ1Y3Rfc3ZlbHRlX2NvbXBvbmVudCgke3N3aXRjaF92YWx1ZX0sICR7c3dpdGNoX3Byb3BzfSgjY3R4KSk7XG5cblx0XHRcdFx0XHQke211bmdlZF9iaW5kaW5nc31cblx0XHRcdFx0XHQke211bmdlZF9oYW5kbGVyc31cblx0XHRcdFx0fVxuXHRcdFx0YCk7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuY3JlYXRlLnB1c2goYiBgaWYgKCR7bmFtZX0pIEBjcmVhdGVfY29tcG9uZW50KCR7bmFtZX0uJCQuZnJhZ21lbnQpO2ApO1xuICAgICAgICAgICAgaWYgKGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyKVxuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlX2Nzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyX21vdW50X2NodW5rKGJsb2NrLCBwYXJlbnRfbm9kZSwgY3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXIpO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goYiBgaWYgKCR7bmFtZX0pIEBtb3VudF9jb21wb25lbnQoJHtuYW1lfSwgJHttb3VudF90YXJnZXR9LCAke21vdW50X2FuY2hvcn0pO2ApO1xuICAgICAgICAgICAgaWYgKHRvX2NsYWltKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyKVxuICAgICAgICAgICAgICAgICAgICBjbGFpbV9ub2RlcyA9IHRoaXMuY3JlYXRlX2Nzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyX2NsYWltX2NodW5rKGJsb2NrLCBjbGFpbV9ub2RlcywgY3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXIsIGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyX2VsZW1lbnQsIGlzX3N2Z19uYW1lc3BhY2UpO1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy5jbGFpbS5wdXNoKGIgYGlmICgke25hbWV9KSBAY2xhaW1fY29tcG9uZW50KCR7bmFtZX0uJCQuZnJhZ21lbnQsICR7Y2xhaW1fbm9kZXN9KTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh1cGRhdGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0XHQke3VwZGF0ZXN9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdG1wX2FuY2hvciA9IHRoaXMuZ2V0X29yX2NyZWF0ZV9hbmNob3IoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpO1xuICAgICAgICAgICAgY29uc3QgYW5jaG9yID0gaGFzX2Nzc19jdXN0b21fcHJvcGVydGllcyA/ICdudWxsJyA6IHRtcF9hbmNob3I7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVfbW91bnRfbm9kZSA9IGhhc19jc3NfY3VzdG9tX3Byb3BlcnRpZXMgPyBjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlciA6IHRoaXMuZ2V0X3VwZGF0ZV9tb3VudF9ub2RlKHRtcF9hbmNob3IpO1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlX2luc2VydCA9IGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyICYmXG4gICAgICAgICAgICAgICAgKHRtcF9hbmNob3IubmFtZSAhPT0gJ251bGwnXG4gICAgICAgICAgICAgICAgICAgID8gYiBgQGluc2VydCgke3RtcF9hbmNob3J9LnBhcmVudE5vZGUsICR7Y3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXJ9LCAke3RtcF9hbmNob3J9KTtgXG4gICAgICAgICAgICAgICAgICAgIDogYiBgQGluc2VydCgke3BhcmVudF9ub2RlfSwgJHtjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcn0sICR7dG1wX2FuY2hvcn0pO2ApO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRpZiAoJHtzd2l0Y2hfdmFsdWV9ICE9PSAoJHtzd2l0Y2hfdmFsdWV9ID0gJHtzbmlwcGV0fSkpIHtcblx0XHRcdFx0XHRpZiAoJHtuYW1lfSkge1xuXHRcdFx0XHRcdFx0QGdyb3VwX291dHJvcygpO1xuXHRcdFx0XHRcdFx0Y29uc3Qgb2xkX2NvbXBvbmVudCA9ICR7bmFtZX07XG5cdFx0XHRcdFx0XHRAdHJhbnNpdGlvbl9vdXQob2xkX2NvbXBvbmVudC4kJC5mcmFnbWVudCwgMSwgMCwgKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRAZGVzdHJveV9jb21wb25lbnQob2xkX2NvbXBvbmVudCwgMSk7XG5cdFx0XHRcdFx0XHRcdCR7aGFzX2Nzc19jdXN0b21fcHJvcGVydGllcyA/IGIgYEBkZXRhY2goJHt1cGRhdGVfbW91bnRfbm9kZX0pYCA6IG51bGx9XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdEBjaGVja19vdXRyb3MoKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoJHtzd2l0Y2hfdmFsdWV9KSB7XG5cdFx0XHRcdFx0XHQke3VwZGF0ZV9pbnNlcnR9XG5cdFx0XHRcdFx0XHQke25hbWV9ID0gQGNvbnN0cnVjdF9zdmVsdGVfY29tcG9uZW50KCR7c3dpdGNoX3ZhbHVlfSwgJHtzd2l0Y2hfcHJvcHN9KCNjdHgpKTtcblxuXHRcdFx0XHRcdFx0JHttdW5nZWRfYmluZGluZ3N9XG5cdFx0XHRcdFx0XHQke211bmdlZF9oYW5kbGVyc31cblxuXHRcdFx0XHRcdFx0QGNyZWF0ZV9jb21wb25lbnQoJHtuYW1lfS4kJC5mcmFnbWVudCk7XG5cdFx0XHRcdFx0XHRAdHJhbnNpdGlvbl9pbigke25hbWV9LiQkLmZyYWdtZW50LCAxKTtcblx0XHRcdFx0XHRcdEBtb3VudF9jb21wb25lbnQoJHtuYW1lfSwgJHt1cGRhdGVfbW91bnRfbm9kZX0sICR7YW5jaG9yfSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdCR7bmFtZX0gPSBudWxsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIGlmICgke3N3aXRjaF92YWx1ZX0pIHtcblx0XHRcdFx0XHQke3VwZGF0ZXMubGVuZ3RoID4gMCAmJiBiIGAke25hbWV9LiRzZXQoJHtuYW1lX2NoYW5nZXN9KTtgfVxuXHRcdFx0XHR9XG5cdFx0XHRgKTtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbnRyby5wdXNoKGIgYFxuXHRcdFx0XHRpZiAoJHtuYW1lfSkgQHRyYW5zaXRpb25faW4oJHtuYW1lfS4kJC5mcmFnbWVudCwgI2xvY2FsKTtcblx0XHRcdGApO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm91dHJvLnB1c2goYiBgaWYgKCR7bmFtZX0pIEB0cmFuc2l0aW9uX291dCgke25hbWV9LiQkLmZyYWdtZW50LCAjbG9jYWwpO2ApO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmRlc3Ryb3kucHVzaChiIGBpZiAoJHtuYW1lfSkgQGRlc3Ryb3lfY29tcG9uZW50KCR7bmFtZX0sICR7cGFyZW50X25vZGUgPyBudWxsIDogJ2RldGFjaGluZyd9KTtgKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGV4cHJlc3Npb24gPSB0aGlzLm5vZGUubmFtZSA9PT0gJ3N2ZWx0ZTpzZWxmJ1xuICAgICAgICAgICAgICAgID8gY29tcG9uZW50Lm5hbWVcbiAgICAgICAgICAgICAgICA6IHRoaXMucmVuZGVyZXIucmVmZXJlbmNlKHN0cmluZ190b19tZW1iZXJfZXhwcmVzc2lvbih0aGlzLm5vZGUubmFtZSkpO1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLmluaXQucHVzaChiIGBcblx0XHRcdFx0JHsodGhpcy5ub2RlLmF0dHJpYnV0ZXMubGVuZ3RoID4gMCB8fCB0aGlzLm5vZGUuYmluZGluZ3MubGVuZ3RoID4gMCkgJiYgYiBgXG5cdFx0XHRcdCR7cHJvcHMgJiYgYiBgbGV0ICR7cHJvcHN9ID0gJHthdHRyaWJ1dGVfb2JqZWN0fTtgfWB9XG5cdFx0XHRcdCR7c3RhdGVtZW50c31cblx0XHRcdFx0JHtuYW1lfSA9IG5ldyAke2V4cHJlc3Npb259KCR7Y29tcG9uZW50X29wdHN9KTtcblxuXHRcdFx0XHQke211bmdlZF9iaW5kaW5nc31cblx0XHRcdFx0JHttdW5nZWRfaGFuZGxlcnN9XG5cdFx0XHRgKTtcbiAgICAgICAgICAgIGlmIChoYXNfY3NzX2N1c3RvbV9wcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRfY3NzX2N1c3RvbV9wcm9wZXJ0aWVzKGJsb2NrLCBjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlciwgY3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXJfZWxlbWVudCwgaXNfc3ZnX25hbWVzcGFjZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBibG9jay5jaHVua3MuY3JlYXRlLnB1c2goYiBgQGNyZWF0ZV9jb21wb25lbnQoJHtuYW1lfS4kJC5mcmFnbWVudCk7YCk7XG4gICAgICAgICAgICBpZiAoY3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXIpXG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVfY3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXJfbW91bnRfY2h1bmsoYmxvY2ssIHBhcmVudF9ub2RlLCBjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcik7XG4gICAgICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGBAbW91bnRfY29tcG9uZW50KCR7bmFtZX0sICR7bW91bnRfdGFyZ2V0fSwgJHttb3VudF9hbmNob3J9KTtgKTtcbiAgICAgICAgICAgIGlmICh0b19jbGFpbSkge1xuICAgICAgICAgICAgICAgIGlmIChjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcilcbiAgICAgICAgICAgICAgICAgICAgY2xhaW1fbm9kZXMgPSB0aGlzLmNyZWF0ZV9jc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcl9jbGFpbV9jaHVuayhibG9jaywgY2xhaW1fbm9kZXMsIGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyLCBjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcl9lbGVtZW50LCBpc19zdmdfbmFtZXNwYWNlKTtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuY2xhaW0ucHVzaChiIGBAY2xhaW1fY29tcG9uZW50KCR7bmFtZX0uJCQuZnJhZ21lbnQsICR7Y2xhaW1fbm9kZXN9KTtgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbnRyby5wdXNoKGIgYFxuXHRcdFx0XHRAdHJhbnNpdGlvbl9pbigke25hbWV9LiQkLmZyYWdtZW50LCAjbG9jYWwpO1xuXHRcdFx0YCk7XG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRcdFx0JHt1cGRhdGVzfVxuXHRcdFx0XHRcdCR7bmFtZX0uJHNldCgke25hbWVfY2hhbmdlc30pO1xuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgXG5cdFx0XHRcdEBkZXN0cm95X2NvbXBvbmVudCgke25hbWV9LCAke3BhcmVudF9ub2RlID8gbnVsbCA6ICdkZXRhY2hpbmcnfSk7XG5cdFx0XHRgKTtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5vdXRyby5wdXNoKGIgYEB0cmFuc2l0aW9uX291dCgke25hbWV9LiQkLmZyYWdtZW50LCAjbG9jYWwpO2ApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZV9jc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcl9tb3VudF9jaHVuayhibG9jaywgcGFyZW50X25vZGUsIGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyKSB7XG4gICAgICAgIGlmIChwYXJlbnRfbm9kZSkge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goYiBgQGFwcGVuZCgke3BhcmVudF9ub2RlfSwgJHtjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcn0pYCk7XG4gICAgICAgICAgICBpZiAoaXNfaGVhZChwYXJlbnRfbm9kZSkpIHtcbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MuZGVzdHJveS5wdXNoKGIgYEBkZXRhY2goJHtjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcn0pO2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLm1vdW50LnB1c2goYiBgQGluc2VydCgjdGFyZ2V0LCAke2Nzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyfSwgI2FuY2hvcik7YCk7XG4gICAgICAgICAgICAvLyBUT0RPIHdlIGV2ZW50dWFsbHkgbmVlZCB0byBjb25zaWRlciB3aGF0IGhhcHBlbnMgdG8gZWxlbWVudHNcbiAgICAgICAgICAgIC8vIHRoYXQgYmVsb25nIHRvIHRoZSBzYW1lIG91dGdyb3VwIGFzIGFuIG91dHJvaW5nIGVsZW1lbnQuLi5cbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgaWYgKGRldGFjaGluZyAmJiAke3RoaXMudmFyfSkgQGRldGFjaCgke2Nzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyfSk7YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY3JlYXRlX2Nzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyX2NsYWltX2NodW5rKGJsb2NrLCBwYXJlbnRfbm9kZXMsIGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyLCBjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcl9lbGVtZW50LCBpc19zdmdfbmFtZXNwYWNlKSB7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke2Nzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyLm5hbWV9X25vZGVzYCk7XG4gICAgICAgIGNvbnN0IGNsYWltX2VsZW1lbnQgPSBpc19zdmdfbmFtZXNwYWNlID8geCBgQGNsYWltX3N2Z19lbGVtZW50YCA6IHggYEBjbGFpbV9lbGVtZW50YDtcbiAgICAgICAgYmxvY2suY2h1bmtzLmNsYWltLnB1c2goYiBgXG5cdFx0XHQke2Nzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyfSA9ICR7Y2xhaW1fZWxlbWVudH0oJHtwYXJlbnRfbm9kZXN9LCBcIiR7Y3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXJfZWxlbWVudC50b1VwcGVyQ2FzZSgpfVwiLCB7IHN0eWxlOiB0cnVlIH0pXG5cdFx0XHR2YXIgJHtub2Rlc30gPSBAY2hpbGRyZW4oJHtjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcn0pO1xuXHRcdGApO1xuICAgICAgICByZXR1cm4gbm9kZXM7XG4gICAgfVxuICAgIHNldF9jc3NfY3VzdG9tX3Byb3BlcnRpZXMoYmxvY2ssIGNzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyLCBjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcl9lbGVtZW50LCBpc19zdmdfbmFtZXNwYWNlKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBpc19zdmdfbmFtZXNwYWNlID8geCBgQHN2Z19lbGVtZW50YCA6IHggYEBlbGVtZW50YDtcbiAgICAgICAgYmxvY2suY2h1bmtzLmNyZWF0ZS5wdXNoKGIgYCR7Y3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXJ9ID0gJHtlbGVtZW50fShcIiR7Y3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXJfZWxlbWVudH1cIik7YCk7XG4gICAgICAgIGlmICghaXNfc3ZnX25hbWVzcGFjZSlcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5oeWRyYXRlLnB1c2goYiBgQHNldF9zdHlsZSgke2Nzc19jdXN0b21fcHJvcGVydGllc193cmFwcGVyfSwgXCJkaXNwbGF5XCIsIFwiY29udGVudHNcIik7YCk7XG4gICAgICAgIHRoaXMubm9kZS5jc3NfY3VzdG9tX3Byb3BlcnRpZXMuZm9yRWFjaCgoYXR0cikgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzID0gYXR0ci5nZXRfZGVwZW5kZW5jaWVzKCk7XG4gICAgICAgICAgICBjb25zdCBzaG91bGRfY2FjaGUgPSBhdHRyLnNob3VsZF9jYWNoZSgpO1xuICAgICAgICAgICAgY29uc3QgbGFzdCA9IHNob3VsZF9jYWNoZSAmJiBibG9jay5nZXRfdW5pcXVlX25hbWUoYCR7YXR0ci5uYW1lLnJlcGxhY2UocmVnZXhfaW52YWxpZF92YXJpYWJsZV9pZGVudGlmaWVyX2NoYXJhY3RlcnMkMywgJ18nKX1fbGFzdGApO1xuICAgICAgICAgICAgaWYgKHNob3VsZF9jYWNoZSlcbiAgICAgICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUobGFzdCk7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGF0dHIuZ2V0X3ZhbHVlKGJsb2NrKTtcbiAgICAgICAgICAgIGNvbnN0IGluaXQgPSBzaG91bGRfY2FjaGUgPyB4IGAke2xhc3R9ID0gJHt2YWx1ZX1gIDogdmFsdWU7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaHlkcmF0ZS5wdXNoKGIgYEBzZXRfc3R5bGUoJHtjc3NfY3VzdG9tX3Byb3BlcnRpZXNfd3JhcHBlcn0sIFwiJHthdHRyLm5hbWV9XCIsICR7aW5pdH0pO2ApO1xuICAgICAgICAgICAgaWYgKGRlcGVuZGVuY2llcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNvbmRpdGlvbiA9IGJsb2NrLnJlbmRlcmVyLmRpcnR5KGRlcGVuZGVuY2llcyk7XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZF9jYWNoZSlcbiAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uID0geCBgJHtjb25kaXRpb259ICYmICgke2xhc3R9ICE9PSAoJHtsYXN0fSA9ICR7dmFsdWV9KSlgO1xuICAgICAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0XHRpZiAoJHtjb25kaXRpb259KSB7XG5cdFx0XHRcdFx0XHRAc2V0X3N0eWxlKCR7Y3NzX2N1c3RvbV9wcm9wZXJ0aWVzX3dyYXBwZXJ9LCBcIiR7YXR0ci5uYW1lfVwiLCAke3Nob3VsZF9jYWNoZSA/IGxhc3QgOiB2YWx1ZX0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0X3Nsb3RfZGF0YSh2YWx1ZXMsIGJsb2NrID0gbnVsbCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdPYmplY3RFeHByZXNzaW9uJyxcbiAgICAgICAgcHJvcGVydGllczogQXJyYXkuZnJvbSh2YWx1ZXMudmFsdWVzKCkpXG4gICAgICAgICAgICAuZmlsdGVyKGF0dHJpYnV0ZSA9PiBhdHRyaWJ1dGUubmFtZSAhPT0gJ25hbWUnKVxuICAgICAgICAgICAgLm1hcChhdHRyaWJ1dGUgPT4ge1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5pc19zcHJlYWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhcmd1bWVudCA9IGdldF9zcHJlYWRfdmFsdWUoYmxvY2ssIGF0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1NwcmVhZEVsZW1lbnQnLFxuICAgICAgICAgICAgICAgICAgICBhcmd1bWVudFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGdldF92YWx1ZShibG9jaywgYXR0cmlidXRlKTtcbiAgICAgICAgICAgIHJldHVybiBwIGAke2F0dHJpYnV0ZS5uYW1lfTogJHt2YWx1ZX1gO1xuICAgICAgICB9KVxuICAgIH07XG59XG5mdW5jdGlvbiBnZXRfdmFsdWUoYmxvY2ssIGF0dHJpYnV0ZSkge1xuICAgIGlmIChhdHRyaWJ1dGUuaXNfdHJ1ZSlcbiAgICAgICAgcmV0dXJuIHggYHRydWVgO1xuICAgIGlmIChhdHRyaWJ1dGUuY2h1bmtzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgcmV0dXJuIHggYFwiXCJgO1xuICAgIGxldCB2YWx1ZSA9IGF0dHJpYnV0ZS5jaHVua3NcbiAgICAgICAgLm1hcChjaHVuayA9PiBjaHVuay50eXBlID09PSAnVGV4dCcgPyBzdHJpbmdfbGl0ZXJhbChjaHVuay5kYXRhKSA6IChibG9jayA/IGNodW5rLm1hbmlwdWxhdGUoYmxvY2spIDogY2h1bmsubm9kZSkpXG4gICAgICAgIC5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30gKyAke3Joc31gKTtcbiAgICBpZiAoYXR0cmlidXRlLmNodW5rcy5sZW5ndGggPiAxICYmIGF0dHJpYnV0ZS5jaHVua3NbMF0udHlwZSAhPT0gJ1RleHQnKSB7XG4gICAgICAgIHZhbHVlID0geCBgXCJcIiArICR7dmFsdWV9YDtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gZ2V0X3NwcmVhZF92YWx1ZShibG9jaywgYXR0cmlidXRlKSB7XG4gICAgcmV0dXJuIGJsb2NrID8gYXR0cmlidXRlLmV4cHJlc3Npb24ubWFuaXB1bGF0ZShibG9jaykgOiBhdHRyaWJ1dGUuZXhwcmVzc2lvbi5ub2RlO1xufVxuXG5jbGFzcyBTbG90V3JhcHBlciBleHRlbmRzIFdyYXBwZXIge1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlLCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIsIGJsb2NrLCBwYXJlbnQsIG5vZGUpO1xuICAgICAgICB0aGlzLmZhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgdGhpcy52YXIgPSB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogJ3Nsb3QnIH07XG4gICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gbmV3IFNldChbJyQkc2NvcGUnXSk7XG4gICAgICAgIHRoaXMuY2Fubm90X3VzZV9pbm5lcmh0bWwoKTtcbiAgICAgICAgdGhpcy5ub3Rfc3RhdGljX2NvbnRlbnQoKTtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuZmFsbGJhY2sgPSBibG9jay5jaGlsZCh7XG4gICAgICAgICAgICAgICAgY29tbWVudDogY3JlYXRlX2RlYnVnZ2luZ19jb21tZW50KHRoaXMubm9kZS5jaGlsZHJlblswXSwgdGhpcy5yZW5kZXJlci5jb21wb25lbnQpLFxuICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMucmVuZGVyZXIuY29tcG9uZW50LmdldF91bmlxdWVfbmFtZSgnZmFsbGJhY2tfYmxvY2snKSxcbiAgICAgICAgICAgICAgICB0eXBlOiAnZmFsbGJhY2snXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlbmRlcmVyLmJsb2Nrcy5wdXNoKHRoaXMuZmFsbGJhY2spO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZnJhZ21lbnQgPSBuZXcgRnJhZ21lbnRXcmFwcGVyKHJlbmRlcmVyLCB0aGlzLmZhbGxiYWNrLCBub2RlLmNoaWxkcmVuLCB0aGlzLCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpO1xuICAgICAgICB0aGlzLm5vZGUudmFsdWVzLmZvckVhY2goYXR0cmlidXRlID0+IHtcbiAgICAgICAgICAgIGFkZF90b19zZXQodGhpcy5kZXBlbmRlbmNpZXMsIGF0dHJpYnV0ZS5kZXBlbmRlbmNpZXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgYmxvY2suYWRkX2RlcGVuZGVuY2llcyh0aGlzLmRlcGVuZGVuY2llcyk7XG4gICAgICAgIC8vIHdlIGhhdmUgdG8gZG8gdGhpcywganVzdCBpbiBjYXNlXG4gICAgICAgIGJsb2NrLmFkZF9pbnRybygpO1xuICAgICAgICBibG9jay5hZGRfb3V0cm8oKTtcbiAgICB9XG4gICAgcmVuZGVyKGJsb2NrLCBwYXJlbnRfbm9kZSwgcGFyZW50X25vZGVzKSB7XG4gICAgICAgIGNvbnN0IHsgcmVuZGVyZXIgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHsgc2xvdF9uYW1lIH0gPSB0aGlzLm5vZGU7XG4gICAgICAgIGlmICh0aGlzLnNsb3RfYmxvY2spIHtcbiAgICAgICAgICAgIGJsb2NrID0gdGhpcy5zbG90X2Jsb2NrO1xuICAgICAgICB9XG4gICAgICAgIGxldCBnZXRfc2xvdF9jaGFuZ2VzX2ZuO1xuICAgICAgICBsZXQgZ2V0X3Nsb3Rfc3ByZWFkX2NoYW5nZXNfZm47XG4gICAgICAgIGxldCBnZXRfc2xvdF9jb250ZXh0X2ZuO1xuICAgICAgICBpZiAodGhpcy5ub2RlLnZhbHVlcy5zaXplID4gMCkge1xuICAgICAgICAgICAgZ2V0X3Nsb3RfY2hhbmdlc19mbiA9IHJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoYGdldF8ke3Nhbml0aXplKHNsb3RfbmFtZSl9X3Nsb3RfY2hhbmdlc2ApO1xuICAgICAgICAgICAgZ2V0X3Nsb3RfY29udGV4dF9mbiA9IHJlbmRlcmVyLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoYGdldF8ke3Nhbml0aXplKHNsb3RfbmFtZSl9X3Nsb3RfY29udGV4dGApO1xuICAgICAgICAgICAgY29uc3QgY2hhbmdlcyA9IHggYHt9YDtcbiAgICAgICAgICAgIGNvbnN0IHNwcmVhZF9keW5hbWljX2RlcGVuZGVuY2llcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgIHRoaXMubm9kZS52YWx1ZXMuZm9yRWFjaChhdHRyaWJ1dGUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUudHlwZSA9PT0gJ1NwcmVhZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkX3RvX3NldChzcHJlYWRfZHluYW1pY19kZXBlbmRlbmNpZXMsIEFycmF5LmZyb20oYXR0cmlidXRlLmRlcGVuZGVuY2llcykuZmlsdGVyKChuYW1lKSA9PiB0aGlzLmlzX2RlcGVuZGVuY3lfZHluYW1pYyhuYW1lKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZHluYW1pY19kZXBlbmRlbmNpZXMgPSBBcnJheS5mcm9tKGF0dHJpYnV0ZS5kZXBlbmRlbmNpZXMpLmZpbHRlcigobmFtZSkgPT4gdGhpcy5pc19kZXBlbmRlbmN5X2R5bmFtaWMobmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZHluYW1pY19kZXBlbmRlbmNpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlcy5wcm9wZXJ0aWVzLnB1c2gocCBgJHthdHRyaWJ1dGUubmFtZX06ICR7cmVuZGVyZXIuZGlydHkoZHluYW1pY19kZXBlbmRlbmNpZXMpfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZW5kZXJlci5ibG9ja3MucHVzaChiIGBcblx0XHRcdFx0Y29uc3QgJHtnZXRfc2xvdF9jaGFuZ2VzX2ZufSA9ICNkaXJ0eSA9PiAke2NoYW5nZXN9O1xuXHRcdFx0XHRjb25zdCAke2dldF9zbG90X2NvbnRleHRfZm59ID0gI2N0eCA9PiAke2dldF9zbG90X2RhdGEodGhpcy5ub2RlLnZhbHVlcywgYmxvY2spfTtcblx0XHRcdGApO1xuICAgICAgICAgICAgaWYgKHNwcmVhZF9keW5hbWljX2RlcGVuZGVuY2llcy5zaXplKSB7XG4gICAgICAgICAgICAgICAgZ2V0X3Nsb3Rfc3ByZWFkX2NoYW5nZXNfZm4gPSByZW5kZXJlci5jb21wb25lbnQuZ2V0X3VuaXF1ZV9uYW1lKGBnZXRfJHtzYW5pdGl6ZShzbG90X25hbWUpfV9zbG90X3NwcmVhZF9jaGFuZ2VzYCk7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuYmxvY2tzLnB1c2goYiBgXG5cdFx0XHRcdFx0Y29uc3QgJHtnZXRfc2xvdF9zcHJlYWRfY2hhbmdlc19mbn0gPSAjZGlydHkgPT4gJHtyZW5kZXJlci5kaXJ0eShBcnJheS5mcm9tKHNwcmVhZF9keW5hbWljX2RlcGVuZGVuY2llcykpfTtcblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBnZXRfc2xvdF9jaGFuZ2VzX2ZuID0gJ251bGwnO1xuICAgICAgICAgICAgZ2V0X3Nsb3RfY29udGV4dF9mbiA9ICdudWxsJztcbiAgICAgICAgfVxuICAgICAgICBsZXQgaGFzX2ZhbGxiYWNrID0gISF0aGlzLmZhbGxiYWNrO1xuICAgICAgICBpZiAodGhpcy5mYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5mcmFnbWVudC5yZW5kZXIodGhpcy5mYWxsYmFjaywgbnVsbCwgeCBgI25vZGVzYCk7XG4gICAgICAgICAgICBoYXNfZmFsbGJhY2sgPSB0aGlzLmZhbGxiYWNrLmhhc19jb250ZW50KCk7XG4gICAgICAgICAgICBpZiAoIWhhc19mYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHJlbmRlcmVyLnJlbW92ZV9ibG9jayh0aGlzLmZhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzbG90ID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke3Nhbml0aXplKHNsb3RfbmFtZSl9X3Nsb3RgKTtcbiAgICAgICAgY29uc3Qgc2xvdF9kZWZpbml0aW9uID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKGAke3Nhbml0aXplKHNsb3RfbmFtZSl9X3Nsb3RfdGVtcGxhdGVgKTtcbiAgICAgICAgY29uc3Qgc2xvdF9vcl9mYWxsYmFjayA9IGhhc19mYWxsYmFjayA/IGJsb2NrLmdldF91bmlxdWVfbmFtZShgJHtzYW5pdGl6ZShzbG90X25hbWUpfV9zbG90X29yX2ZhbGxiYWNrYCkgOiBzbG90O1xuICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0Y29uc3QgJHtzbG90X2RlZmluaXRpb259ID0gJHtyZW5kZXJlci5yZWZlcmVuY2UoJyNzbG90cycpfS4ke3Nsb3RfbmFtZX07XG5cdFx0XHRjb25zdCAke3Nsb3R9ID0gQGNyZWF0ZV9zbG90KCR7c2xvdF9kZWZpbml0aW9ufSwgI2N0eCwgJHtyZW5kZXJlci5yZWZlcmVuY2UoJyQkc2NvcGUnKX0sICR7Z2V0X3Nsb3RfY29udGV4dF9mbn0pO1xuXHRcdFx0JHtoYXNfZmFsbGJhY2sgPyBiIGBjb25zdCAke3Nsb3Rfb3JfZmFsbGJhY2t9ID0gJHtzbG90fSB8fCAke3RoaXMuZmFsbGJhY2submFtZX0oI2N0eCk7YCA6IG51bGx9XG5cdFx0YCk7XG4gICAgICAgIGJsb2NrLmNodW5rcy5jcmVhdGUucHVzaChiIGBpZiAoJHtzbG90X29yX2ZhbGxiYWNrfSkgJHtzbG90X29yX2ZhbGxiYWNrfS5jKCk7YCk7XG4gICAgICAgIGlmIChyZW5kZXJlci5vcHRpb25zLmh5ZHJhdGFibGUpIHtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5jbGFpbS5wdXNoKGIgYGlmICgke3Nsb3Rfb3JfZmFsbGJhY2t9KSAke3Nsb3Rfb3JfZmFsbGJhY2t9LmwoJHtwYXJlbnRfbm9kZXN9KTtgKTtcbiAgICAgICAgfVxuICAgICAgICBibG9jay5jaHVua3MubW91bnQucHVzaChiIGBcblx0XHRcdGlmICgke3Nsb3Rfb3JfZmFsbGJhY2t9KSB7XG5cdFx0XHRcdCR7c2xvdF9vcl9mYWxsYmFja30ubSgke3BhcmVudF9ub2RlIHx8ICcjdGFyZ2V0J30sICR7cGFyZW50X25vZGUgPyAnbnVsbCcgOiAnI2FuY2hvcid9KTtcblx0XHRcdH1cblx0XHRgKTtcbiAgICAgICAgYmxvY2suY2h1bmtzLmludHJvLnB1c2goYiBgQHRyYW5zaXRpb25faW4oJHtzbG90X29yX2ZhbGxiYWNrfSwgI2xvY2FsKTtgKTtcbiAgICAgICAgYmxvY2suY2h1bmtzLm91dHJvLnB1c2goYiBgQHRyYW5zaXRpb25fb3V0KCR7c2xvdF9vcl9mYWxsYmFja30sICNsb2NhbCk7YCk7XG4gICAgICAgIGNvbnN0IGR5bmFtaWNfZGVwZW5kZW5jaWVzID0gQXJyYXkuZnJvbSh0aGlzLmRlcGVuZGVuY2llcykuZmlsdGVyKChuYW1lKSA9PiB0aGlzLmlzX2RlcGVuZGVuY3lfZHluYW1pYyhuYW1lKSk7XG4gICAgICAgIGNvbnN0IGZhbGxiYWNrX2R5bmFtaWNfZGVwZW5kZW5jaWVzID0gaGFzX2ZhbGxiYWNrXG4gICAgICAgICAgICA/IEFycmF5LmZyb20odGhpcy5mYWxsYmFjay5kZXBlbmRlbmNpZXMpLmZpbHRlcigobmFtZSkgPT4gdGhpcy5pc19kZXBlbmRlbmN5X2R5bmFtaWMobmFtZSkpXG4gICAgICAgICAgICA6IFtdO1xuICAgICAgICBsZXQgY29uZGl0aW9uID0gcmVuZGVyZXIuZGlydHkoZHluYW1pY19kZXBlbmRlbmNpZXMpO1xuICAgICAgICBpZiAoYmxvY2suaGFzX291dHJvcykge1xuICAgICAgICAgICAgY29uZGl0aW9uID0geCBgISNjdXJyZW50IHx8ICR7Y29uZGl0aW9ufWA7XG4gICAgICAgIH1cbiAgICAgICAgLy8gY29uZGl0aW9ucyB0byB0cmVhdCBldmVyeXRoaW5nIGFzIGRpcnR5XG4gICAgICAgIGNvbnN0IGFsbF9kaXJ0eV9jb25kaXRpb25zID0gW1xuICAgICAgICAgICAgZ2V0X3Nsb3Rfc3ByZWFkX2NoYW5nZXNfZm4gPyB4IGAke2dldF9zbG90X3NwcmVhZF9jaGFuZ2VzX2ZufSgjZGlydHkpYCA6IG51bGwsXG4gICAgICAgICAgICBibG9jay5oYXNfb3V0cm9zID8geCBgISNjdXJyZW50YCA6IG51bGxcbiAgICAgICAgXS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgIGNvbnN0IGFsbF9kaXJ0eV9jb25kaXRpb24gPSBhbGxfZGlydHlfY29uZGl0aW9ucy5sZW5ndGggPyBhbGxfZGlydHlfY29uZGl0aW9ucy5yZWR1Y2UoKGNvbmRpdGlvbjEsIGNvbmRpdGlvbjIpID0+IHggYCR7Y29uZGl0aW9uMX0gfHwgJHtjb25kaXRpb24yfWApIDogbnVsbDtcbiAgICAgICAgbGV0IHNsb3RfdXBkYXRlO1xuICAgICAgICBpZiAoYWxsX2RpcnR5X2NvbmRpdGlvbikge1xuICAgICAgICAgICAgY29uc3QgZGlydHkgPSB4IGAke2FsbF9kaXJ0eV9jb25kaXRpb259ID8gQGdldF9hbGxfZGlydHlfZnJvbV9zY29wZSgke3JlbmRlcmVyLnJlZmVyZW5jZSgnJCRzY29wZScpfSkgOiBAZ2V0X3Nsb3RfY2hhbmdlcygke3Nsb3RfZGVmaW5pdGlvbn0sICR7cmVuZGVyZXIucmVmZXJlbmNlKCckJHNjb3BlJyl9LCAjZGlydHksICR7Z2V0X3Nsb3RfY2hhbmdlc19mbn0pYDtcbiAgICAgICAgICAgIHNsb3RfdXBkYXRlID0gYiBgXG5cdFx0XHRcdGlmICgke3Nsb3R9LnAgJiYgJHtjb25kaXRpb259KSB7XG5cdFx0XHRcdFx0QHVwZGF0ZV9zbG90X2Jhc2UoJHtzbG90fSwgJHtzbG90X2RlZmluaXRpb259LCAjY3R4LCAke3JlbmRlcmVyLnJlZmVyZW5jZSgnJCRzY29wZScpfSwgJHtkaXJ0eX0sICR7Z2V0X3Nsb3RfY29udGV4dF9mbn0pO1xuXHRcdFx0XHR9XG5cdFx0XHRgO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2xvdF91cGRhdGUgPSBiIGBcblx0XHRcdFx0aWYgKCR7c2xvdH0ucCAmJiAke2NvbmRpdGlvbn0pIHtcblx0XHRcdFx0XHRAdXBkYXRlX3Nsb3QoJHtzbG90fSwgJHtzbG90X2RlZmluaXRpb259LCAjY3R4LCAke3JlbmRlcmVyLnJlZmVyZW5jZSgnJCRzY29wZScpfSwgI2RpcnR5LCAke2dldF9zbG90X2NoYW5nZXNfZm59LCAke2dldF9zbG90X2NvbnRleHRfZm59KTtcblx0XHRcdFx0fVxuXHRcdFx0YDtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZmFsbGJhY2tfY29uZGl0aW9uID0gcmVuZGVyZXIuZGlydHkoZmFsbGJhY2tfZHluYW1pY19kZXBlbmRlbmNpZXMpO1xuICAgICAgICBsZXQgZmFsbGJhY2tfZGlydHkgPSB4IGAjZGlydHlgO1xuICAgICAgICBpZiAoYmxvY2suaGFzX291dHJvcykge1xuICAgICAgICAgICAgZmFsbGJhY2tfY29uZGl0aW9uID0geCBgISNjdXJyZW50IHx8ICR7ZmFsbGJhY2tfY29uZGl0aW9ufWA7XG4gICAgICAgICAgICBmYWxsYmFja19kaXJ0eSA9IHggYCEjY3VycmVudCA/ICR7cmVuZGVyZXIuZ2V0X2luaXRpYWxfZGlydHkoKX0gOiAke2ZhbGxiYWNrX2RpcnR5fWA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmFsbGJhY2tfdXBkYXRlID0gaGFzX2ZhbGxiYWNrICYmIGZhbGxiYWNrX2R5bmFtaWNfZGVwZW5kZW5jaWVzLmxlbmd0aCA+IDAgJiYgYiBgXG5cdFx0XHRpZiAoJHtzbG90X29yX2ZhbGxiYWNrfSAmJiAke3Nsb3Rfb3JfZmFsbGJhY2t9LnAgJiYgJHtmYWxsYmFja19jb25kaXRpb259KSB7XG5cdFx0XHRcdCR7c2xvdF9vcl9mYWxsYmFja30ucCgjY3R4LCAke2ZhbGxiYWNrX2RpcnR5fSk7XG5cdFx0XHR9XG5cdFx0YDtcbiAgICAgICAgaWYgKGZhbGxiYWNrX3VwZGF0ZSkge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRpZiAoJHtzbG90fSkge1xuXHRcdFx0XHRcdCR7c2xvdF91cGRhdGV9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JHtmYWxsYmFja191cGRhdGV9XG5cdFx0XHRcdH1cblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYmxvY2suY2h1bmtzLnVwZGF0ZS5wdXNoKGIgYFxuXHRcdFx0XHRpZiAoJHtzbG90fSkge1xuXHRcdFx0XHRcdCR7c2xvdF91cGRhdGV9XG5cdFx0XHRcdH1cblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIGJsb2NrLmNodW5rcy5kZXN0cm95LnB1c2goYiBgaWYgKCR7c2xvdF9vcl9mYWxsYmFja30pICR7c2xvdF9vcl9mYWxsYmFja30uZChkZXRhY2hpbmcpO2ApO1xuICAgIH1cbiAgICBpc19kZXBlbmRlbmN5X2R5bmFtaWMobmFtZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gJyQkc2NvcGUnKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmICh0aGlzLm5vZGUuc2NvcGUuaXNfbGV0KG5hbWUpKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmIChpc19yZXNlcnZlZF9rZXl3b3JkKG5hbWUpKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGNvbnN0IHZhcmlhYmxlID0gdGhpcy5yZW5kZXJlci5jb21wb25lbnQudmFyX2xvb2t1cC5nZXQobmFtZSk7XG4gICAgICAgIHJldHVybiBpc19keW5hbWljKHZhcmlhYmxlKTtcbiAgICB9XG59XG5cbmNsYXNzIFRpdGxlV3JhcHBlciBleHRlbmRzIFdyYXBwZXIge1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBub2RlLCBfc3RyaXBfd2hpdGVzcGFjZSwgX25leHRfc2libGluZykge1xuICAgICAgICBzdXBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSk7XG4gICAgfVxuICAgIHJlbmRlcihibG9jaywgX3BhcmVudF9ub2RlLCBfcGFyZW50X25vZGVzKSB7XG4gICAgICAgIGNvbnN0IGlzX2R5bmFtaWMgPSAhIXRoaXMubm9kZS5jaGlsZHJlbi5maW5kKG5vZGUgPT4gbm9kZS50eXBlICE9PSAnVGV4dCcpO1xuICAgICAgICBpZiAoaXNfZHluYW1pYykge1xuICAgICAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICAgICAgY29uc3QgYWxsX2RlcGVuZGVuY2llcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgIC8vIFRPRE8gc29tZSBvZiB0aGlzIGNvZGUgaXMgcmVwZWF0ZWQgaW4gVGFnLnRzIOKAlCB3b3VsZCBiZSBnb29kIHRvXG4gICAgICAgICAgICAvLyBEUlkgaXQgb3V0IGlmIHRoYXQncyBwb3NzaWJsZSB3aXRob3V0IGludHJvZHVjaW5nIGNyYXp5IGluZGlyZWN0aW9uXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIC8vIHNpbmdsZSB7dGFnfSDigJQgbWF5IGJlIGEgbm9uLXN0cmluZ1xuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogY2hlY2sgdGhpc1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgZXhwcmVzc2lvbiB9ID0gdGhpcy5ub2RlLmNoaWxkcmVuWzBdO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZXhwcmVzc2lvbi5tYW5pcHVsYXRlKGJsb2NrKTtcbiAgICAgICAgICAgICAgICBhZGRfdG9fc2V0KGFsbF9kZXBlbmRlbmNpZXMsIGV4cHJlc3Npb24uZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vICd7Zm9vfSB7YmFyfScg4oCUIHRyZWF0IGFzIHN0cmluZyBjb25jYXRlbmF0aW9uXG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLm5vZGUuY2hpbGRyZW5cbiAgICAgICAgICAgICAgICAgICAgLm1hcChjaHVuayA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaHVuay50eXBlID09PSAnVGV4dCcpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nX2xpdGVyYWwoY2h1bmsuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGNodW5rLmV4cHJlc3Npb24uZGVwZW5kZW5jaWVzLmZvckVhY2goZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxfZGVwZW5kZW5jaWVzLmFkZChkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjaHVuay5leHByZXNzaW9uLm1hbmlwdWxhdGUoYmxvY2spO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30gKyAke3Joc31gKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ub2RlLmNoaWxkcmVuWzBdLnR5cGUgIT09ICdUZXh0Jykge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHggYFwiXCIgKyAke3ZhbHVlfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbGFzdCA9IHRoaXMubm9kZS5zaG91bGRfY2FjaGUgJiYgYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCd0aXRsZV92YWx1ZScpO1xuICAgICAgICAgICAgaWYgKHRoaXMubm9kZS5zaG91bGRfY2FjaGUpXG4gICAgICAgICAgICAgICAgYmxvY2suYWRkX3ZhcmlhYmxlKGxhc3QpO1xuICAgICAgICAgICAgY29uc3QgaW5pdCA9IHRoaXMubm9kZS5zaG91bGRfY2FjaGUgPyB4IGAke2xhc3R9ID0gJHt2YWx1ZX1gIDogdmFsdWU7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYEBfZG9jdW1lbnQudGl0bGUgPSAke2luaXR9O2ApO1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlciA9IGIgYEBfZG9jdW1lbnQudGl0bGUgPSAke3RoaXMubm9kZS5zaG91bGRfY2FjaGUgPyBsYXN0IDogdmFsdWV9O2A7XG4gICAgICAgICAgICBpZiAoYWxsX2RlcGVuZGVuY2llcy5zaXplKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzID0gQXJyYXkuZnJvbShhbGxfZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgICAgICBsZXQgY29uZGl0aW9uID0gYmxvY2sucmVuZGVyZXIuZGlydHkoZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgICAgICBpZiAoYmxvY2suaGFzX291dHJvcykge1xuICAgICAgICAgICAgICAgICAgICBjb25kaXRpb24gPSB4IGAhI2N1cnJlbnQgfHwgJHtjb25kaXRpb259YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubm9kZS5zaG91bGRfY2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uID0geCBgJHtjb25kaXRpb259ICYmICgke2xhc3R9ICE9PSAoJHtsYXN0fSA9ICR7dmFsdWV9KSlgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBibG9jay5jaHVua3MudXBkYXRlLnB1c2goYiBgXG5cdFx0XHRcdFx0aWYgKCR7Y29uZGl0aW9ufSkge1xuXHRcdFx0XHRcdFx0JHt1cGRhdGVyfVxuXHRcdFx0XHRcdH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5ub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgICA/IHN0cmluZ19saXRlcmFsKHRoaXMubm9kZS5jaGlsZHJlblswXS5kYXRhKVxuICAgICAgICAgICAgICAgIDogeCBgXCJcImA7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaHlkcmF0ZS5wdXNoKGIgYEBfZG9jdW1lbnQudGl0bGUgPSAke3ZhbHVlfTtgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuY29uc3QgYXNzb2NpYXRlZF9ldmVudHMgPSB7XG4gICAgaW5uZXJXaWR0aDogJ3Jlc2l6ZScsXG4gICAgaW5uZXJIZWlnaHQ6ICdyZXNpemUnLFxuICAgIG91dGVyV2lkdGg6ICdyZXNpemUnLFxuICAgIG91dGVySGVpZ2h0OiAncmVzaXplJyxcbiAgICBzY3JvbGxYOiAnc2Nyb2xsJyxcbiAgICBzY3JvbGxZOiAnc2Nyb2xsJ1xufTtcbmNvbnN0IHByb3BlcnRpZXMkMSA9IHtcbiAgICBzY3JvbGxYOiAncGFnZVhPZmZzZXQnLFxuICAgIHNjcm9sbFk6ICdwYWdlWU9mZnNldCdcbn07XG5jb25zdCByZWFkb25seSA9IG5ldyBTZXQoW1xuICAgICdpbm5lcldpZHRoJyxcbiAgICAnaW5uZXJIZWlnaHQnLFxuICAgICdvdXRlcldpZHRoJyxcbiAgICAnb3V0ZXJIZWlnaHQnLFxuICAgICdvbmxpbmUnXG5dKTtcbmNsYXNzIFdpbmRvd1dyYXBwZXIgZXh0ZW5kcyBXcmFwcGVyIHtcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSkge1xuICAgICAgICBzdXBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgbm9kZSk7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSB0aGlzLm5vZGUuaGFuZGxlcnMubWFwKGhhbmRsZXIgPT4gbmV3IEV2ZW50SGFuZGxlcldyYXBwZXIoaGFuZGxlciwgdGhpcykpO1xuICAgIH1cbiAgICByZW5kZXIoYmxvY2ssIF9wYXJlbnRfbm9kZSwgX3BhcmVudF9ub2Rlcykge1xuICAgICAgICBjb25zdCB7IHJlbmRlcmVyIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7IGNvbXBvbmVudCB9ID0gcmVuZGVyZXI7XG4gICAgICAgIGNvbnN0IGV2ZW50cyA9IHt9O1xuICAgICAgICBjb25zdCBiaW5kaW5ncyA9IHt9O1xuICAgICAgICBhZGRfYWN0aW9ucyhibG9jaywgJ0Bfd2luZG93JywgdGhpcy5ub2RlLmFjdGlvbnMpO1xuICAgICAgICBhZGRfZXZlbnRfaGFuZGxlcnMoYmxvY2ssICdAX3dpbmRvdycsIHRoaXMuaGFuZGxlcnMpO1xuICAgICAgICB0aGlzLm5vZGUuYmluZGluZ3MuZm9yRWFjaChiaW5kaW5nID0+IHtcbiAgICAgICAgICAgIC8vIFRPRE86IHdoYXQgaWYgaXQncyBhIE1lbWJlckV4cHJlc3Npb24/XG4gICAgICAgICAgICBjb25zdCBiaW5kaW5nX25hbWUgPSBiaW5kaW5nLmV4cHJlc3Npb24ubm9kZS5uYW1lO1xuICAgICAgICAgICAgLy8gaW4gZGV2IG1vZGUsIHRocm93IGlmIHJlYWQtb25seSB2YWx1ZXMgYXJlIHdyaXR0ZW4gdG9cbiAgICAgICAgICAgIGlmIChyZWFkb25seS5oYXMoYmluZGluZy5uYW1lKSkge1xuICAgICAgICAgICAgICAgIHJlbmRlcmVyLnJlYWRvbmx5LmFkZChiaW5kaW5nX25hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmluZGluZ3NbYmluZGluZy5uYW1lXSA9IGJpbmRpbmdfbmFtZTtcbiAgICAgICAgICAgIC8vIGJpbmQ6b25saW5lIGlzIGEgc3BlY2lhbCBjYXNlLCB3ZSBuZWVkIHRvIGxpc3RlbiBmb3IgdHdvIHNlcGFyYXRlIGV2ZW50c1xuICAgICAgICAgICAgaWYgKGJpbmRpbmcubmFtZSA9PT0gJ29ubGluZScpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgYXNzb2NpYXRlZF9ldmVudCA9IGFzc29jaWF0ZWRfZXZlbnRzW2JpbmRpbmcubmFtZV07XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IHByb3BlcnRpZXMkMVtiaW5kaW5nLm5hbWVdIHx8IGJpbmRpbmcubmFtZTtcbiAgICAgICAgICAgIGlmICghZXZlbnRzW2Fzc29jaWF0ZWRfZXZlbnRdKVxuICAgICAgICAgICAgICAgIGV2ZW50c1thc3NvY2lhdGVkX2V2ZW50XSA9IFtdO1xuICAgICAgICAgICAgZXZlbnRzW2Fzc29jaWF0ZWRfZXZlbnRdLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IGJpbmRpbmdfbmFtZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogcHJvcGVydHlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2Nyb2xsaW5nID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdzY3JvbGxpbmcnKTtcbiAgICAgICAgY29uc3QgY2xlYXJfc2Nyb2xsaW5nID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdjbGVhcl9zY3JvbGxpbmcnKTtcbiAgICAgICAgY29uc3Qgc2Nyb2xsaW5nX3RpbWVvdXQgPSBibG9jay5nZXRfdW5pcXVlX25hbWUoJ3Njcm9sbGluZ190aW1lb3V0Jyk7XG4gICAgICAgIE9iamVjdC5rZXlzKGV2ZW50cykuZm9yRWFjaChldmVudCA9PiB7XG4gICAgICAgICAgICBjb25zdCBpZCA9IGJsb2NrLmdldF91bmlxdWVfbmFtZShgb253aW5kb3cke2V2ZW50fWApO1xuICAgICAgICAgICAgY29uc3QgcHJvcHMgPSBldmVudHNbZXZlbnRdO1xuICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3RvX2NvbnRleHQoaWQubmFtZSk7XG4gICAgICAgICAgICBjb25zdCBmbiA9IHJlbmRlcmVyLnJlZmVyZW5jZShpZC5uYW1lKTtcbiAgICAgICAgICAgIGlmIChldmVudCA9PT0gJ3Njcm9sbCcpIHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPIG90aGVyIGJpZGlyZWN0aW9uYWwgYmluZGluZ3MuLi5cbiAgICAgICAgICAgICAgICBibG9jay5hZGRfdmFyaWFibGUoc2Nyb2xsaW5nLCB4IGBmYWxzZWApO1xuICAgICAgICAgICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShjbGVhcl9zY3JvbGxpbmcsIHggYCgpID0+IHsgJHtzY3JvbGxpbmd9ID0gZmFsc2UgfWApO1xuICAgICAgICAgICAgICAgIGJsb2NrLmFkZF92YXJpYWJsZShzY3JvbGxpbmdfdGltZW91dCk7XG4gICAgICAgICAgICAgICAgY29uc3QgY29uZGl0aW9uID0gYmluZGluZ3Muc2Nyb2xsWCAmJiBiaW5kaW5ncy5zY3JvbGxZXG4gICAgICAgICAgICAgICAgICAgID8geCBgXCIke2JpbmRpbmdzLnNjcm9sbFh9XCIgaW4gdGhpcy5fc3RhdGUgfHwgXCIke2JpbmRpbmdzLnNjcm9sbFl9XCIgaW4gdGhpcy5fc3RhdGVgXG4gICAgICAgICAgICAgICAgICAgIDogeCBgXCIke2JpbmRpbmdzLnNjcm9sbFggfHwgYmluZGluZ3Muc2Nyb2xsWX1cIiBpbiB0aGlzLl9zdGF0ZWA7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2Nyb2xsWCA9IGJpbmRpbmdzLnNjcm9sbFggJiYgeCBgdGhpcy5fc3RhdGUuJHtiaW5kaW5ncy5zY3JvbGxYfWA7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2Nyb2xsWSA9IGJpbmRpbmdzLnNjcm9sbFkgJiYgeCBgdGhpcy5fc3RhdGUuJHtiaW5kaW5ncy5zY3JvbGxZfWA7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIubWV0YV9iaW5kaW5ncy5wdXNoKGIgYFxuXHRcdFx0XHRcdGlmICgke2NvbmRpdGlvbn0pIHtcblx0XHRcdFx0XHRcdEBfc2Nyb2xsVG8oJHtzY3JvbGxYIHx8ICdAX3dpbmRvdy5wYWdlWE9mZnNldCd9LCAke3Njcm9sbFkgfHwgJ0Bfd2luZG93LnBhZ2VZT2Zmc2V0J30pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQke3Njcm9sbFggJiYgYCR7c2Nyb2xsWH0gPSBAX3dpbmRvdy5wYWdlWE9mZnNldDtgfVxuXHRcdFx0XHRcdCR7c2Nyb2xsWSAmJiBgJHtzY3JvbGxZfSA9IEBfd2luZG93LnBhZ2VZT2Zmc2V0O2B9XG5cdFx0XHRcdGApO1xuICAgICAgICAgICAgICAgIGJsb2NrLmV2ZW50X2xpc3RlbmVycy5wdXNoKHggYFxuXHRcdFx0XHRcdEBsaXN0ZW4oQF93aW5kb3csIFwiJHtldmVudH1cIiwgKCkgPT4ge1xuXHRcdFx0XHRcdFx0JHtzY3JvbGxpbmd9ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdEBfY2xlYXJUaW1lb3V0KCR7c2Nyb2xsaW5nX3RpbWVvdXR9KTtcblx0XHRcdFx0XHRcdCR7c2Nyb2xsaW5nX3RpbWVvdXR9ID0gQF9zZXRUaW1lb3V0KCR7Y2xlYXJfc2Nyb2xsaW5nfSwgMTAwKTtcblx0XHRcdFx0XHRcdCR7Zm59KCk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9wcy5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5tZXRhX2JpbmRpbmdzLnB1c2goYiBgdGhpcy5fc3RhdGUuJHtwcm9wLm5hbWV9ID0gQF93aW5kb3cuJHtwcm9wLnZhbHVlfTtgKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBibG9jay5ldmVudF9saXN0ZW5lcnMucHVzaCh4IGBcblx0XHRcdFx0XHRAbGlzdGVuKEBfd2luZG93LCBcIiR7ZXZlbnR9XCIsICR7Zm59KVxuXHRcdFx0XHRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbXBvbmVudC5wYXJ0bHlfaG9pc3RlZC5wdXNoKGIgYFxuXHRcdFx0XHRmdW5jdGlvbiAke2lkfSgpIHtcblx0XHRcdFx0XHQke3Byb3BzLm1hcChwcm9wID0+IHJlbmRlcmVyLmludmFsaWRhdGUocHJvcC5uYW1lLCB4IGAke3Byb3AubmFtZX0gPSBAX3dpbmRvdy4ke3Byb3AudmFsdWV9YCkpfVxuXHRcdFx0XHR9XG5cdFx0XHRgKTtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy5pbml0LnB1c2goYiBgXG5cdFx0XHRcdEBhZGRfcmVuZGVyX2NhbGxiYWNrKCR7Zm59KTtcblx0XHRcdGApO1xuICAgICAgICAgICAgY29tcG9uZW50Lmhhc19yZWFjdGl2ZV9hc3NpZ25tZW50cyA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBzcGVjaWFsIGNhc2UuLi4gbWlnaHQgbmVlZCB0byBhYnN0cmFjdCB0aGlzIG91dCBpZiB3ZSBhZGQgbW9yZSBzcGVjaWFsIGNhc2VzXG4gICAgICAgIGlmIChiaW5kaW5ncy5zY3JvbGxYIHx8IGJpbmRpbmdzLnNjcm9sbFkpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbmRpdGlvbiA9IHJlbmRlcmVyLmRpcnR5KFtiaW5kaW5ncy5zY3JvbGxYLCBiaW5kaW5ncy5zY3JvbGxZXS5maWx0ZXIoQm9vbGVhbikpO1xuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsWCA9IGJpbmRpbmdzLnNjcm9sbFggPyByZW5kZXJlci5yZWZlcmVuY2UoYmluZGluZ3Muc2Nyb2xsWCkgOiB4IGBAX3dpbmRvdy5wYWdlWE9mZnNldGA7XG4gICAgICAgICAgICBjb25zdCBzY3JvbGxZID0gYmluZGluZ3Muc2Nyb2xsWSA/IHJlbmRlcmVyLnJlZmVyZW5jZShiaW5kaW5ncy5zY3JvbGxZKSA6IHggYEBfd2luZG93LnBhZ2VZT2Zmc2V0YDtcbiAgICAgICAgICAgIGJsb2NrLmNodW5rcy51cGRhdGUucHVzaChiIGBcblx0XHRcdFx0aWYgKCR7Y29uZGl0aW9ufSAmJiAhJHtzY3JvbGxpbmd9KSB7XG5cdFx0XHRcdFx0JHtzY3JvbGxpbmd9ID0gdHJ1ZTtcblx0XHRcdFx0XHRAX2NsZWFyVGltZW91dCgke3Njcm9sbGluZ190aW1lb3V0fSk7XG5cdFx0XHRcdFx0QF9zY3JvbGxUbygke3Njcm9sbFh9LCAke3Njcm9sbFl9KTtcblx0XHRcdFx0XHQke3Njcm9sbGluZ190aW1lb3V0fSA9IEBfc2V0VGltZW91dCgke2NsZWFyX3Njcm9sbGluZ30sIDEwMCk7XG5cdFx0XHRcdH1cblx0XHRcdGApO1xuICAgICAgICB9XG4gICAgICAgIC8vIGFub3RoZXIgc3BlY2lhbCBjYXNlLiAoSSdtIHN0YXJ0aW5nIHRvIHRoaW5rIHRoZXNlIGFyZSBhbGwgc3BlY2lhbCBjYXNlcy4pXG4gICAgICAgIGlmIChiaW5kaW5ncy5vbmxpbmUpIHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gYmxvY2suZ2V0X3VuaXF1ZV9uYW1lKCdvbmxpbmVzdGF0dXNjaGFuZ2VkJyk7XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gYmluZGluZ3Mub25saW5lO1xuICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3RvX2NvbnRleHQoaWQubmFtZSk7XG4gICAgICAgICAgICBjb25zdCByZWZlcmVuY2UgPSByZW5kZXJlci5yZWZlcmVuY2UoaWQubmFtZSk7XG4gICAgICAgICAgICBjb21wb25lbnQucGFydGx5X2hvaXN0ZWQucHVzaChiIGBcblx0XHRcdFx0ZnVuY3Rpb24gJHtpZH0oKSB7XG5cdFx0XHRcdFx0JHtyZW5kZXJlci5pbnZhbGlkYXRlKG5hbWUsIHggYCR7bmFtZX0gPSBAX25hdmlnYXRvci5vbkxpbmVgKX1cblx0XHRcdFx0fVxuXHRcdFx0YCk7XG4gICAgICAgICAgICBibG9jay5jaHVua3MuaW5pdC5wdXNoKGIgYFxuXHRcdFx0XHRAYWRkX3JlbmRlcl9jYWxsYmFjaygke3JlZmVyZW5jZX0pO1xuXHRcdFx0YCk7XG4gICAgICAgICAgICBibG9jay5ldmVudF9saXN0ZW5lcnMucHVzaCh4IGBAbGlzdGVuKEBfd2luZG93LCBcIm9ubGluZVwiLCAke3JlZmVyZW5jZX0pYCwgeCBgQGxpc3RlbihAX3dpbmRvdywgXCJvZmZsaW5lXCIsICR7cmVmZXJlbmNlfSlgKTtcbiAgICAgICAgICAgIGNvbXBvbmVudC5oYXNfcmVhY3RpdmVfYXNzaWdubWVudHMgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBsaW5rKG5leHQsIHByZXYpIHtcbiAgICBwcmV2Lm5leHQgPSBuZXh0O1xuICAgIGlmIChuZXh0KVxuICAgICAgICBuZXh0LnByZXYgPSBwcmV2O1xufVxuXG5jb25zdCB3cmFwcGVycyA9IHtcbiAgICBBd2FpdEJsb2NrOiBBd2FpdEJsb2NrV3JhcHBlcixcbiAgICBCb2R5OiBCb2R5V3JhcHBlcixcbiAgICBDb21tZW50OiBudWxsLFxuICAgIERlYnVnVGFnOiBEZWJ1Z1RhZ1dyYXBwZXIsXG4gICAgRWFjaEJsb2NrOiBFYWNoQmxvY2tXcmFwcGVyLFxuICAgIEVsZW1lbnQ6IEVsZW1lbnRXcmFwcGVyLFxuICAgIEhlYWQ6IEhlYWRXcmFwcGVyLFxuICAgIElmQmxvY2s6IElmQmxvY2tXcmFwcGVyLFxuICAgIElubGluZUNvbXBvbmVudDogSW5saW5lQ29tcG9uZW50V3JhcHBlcixcbiAgICBLZXlCbG9jazogS2V5QmxvY2tXcmFwcGVyLFxuICAgIE11c3RhY2hlVGFnOiBNdXN0YWNoZVRhZ1dyYXBwZXIsXG4gICAgT3B0aW9uczogbnVsbCxcbiAgICBSYXdNdXN0YWNoZVRhZzogUmF3TXVzdGFjaGVUYWdXcmFwcGVyLFxuICAgIFNsb3Q6IFNsb3RXcmFwcGVyLFxuICAgIFNsb3RUZW1wbGF0ZTogU2xvdFRlbXBsYXRlV3JhcHBlcixcbiAgICBUZXh0OiBUZXh0V3JhcHBlcixcbiAgICBUaXRsZTogVGl0bGVXcmFwcGVyLFxuICAgIFdpbmRvdzogV2luZG93V3JhcHBlclxufTtcbmZ1bmN0aW9uIHRyaW1tYWJsZV9hdChjaGlsZCwgbmV4dF9zaWJsaW5nKSB7XG4gICAgLy8gV2hpdGVzcGFjZSBpcyB0cmltbWFibGUgaWYgb25lIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZTpcbiAgICAvLyBUaGUgY2hpbGQgYW5kIGl0cyBzaWJsaW5nIHNoYXJlIGEgY29tbW9uIG5lYXJlc3QgZWFjaCBibG9jayAobm90IGF0IGFuIGVhY2ggYmxvY2sgYm91bmRhcnkpXG4gICAgLy8gVGhlIG5leHQgc2libGluZydzIHByZXZpb3VzIG5vZGUgaXMgYW4gZWFjaCBibG9ja1xuICAgIHJldHVybiAobmV4dF9zaWJsaW5nLm5vZGUuZmluZF9uZWFyZXN0KC9FYWNoQmxvY2svKSA9PT0gY2hpbGQuZmluZF9uZWFyZXN0KC9FYWNoQmxvY2svKSkgfHwgbmV4dF9zaWJsaW5nLm5vZGUucHJldi50eXBlID09PSAnRWFjaEJsb2NrJztcbn1cbmNsYXNzIEZyYWdtZW50V3JhcHBlciB7XG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGJsb2NrLCBub2RlcywgcGFyZW50LCBzdHJpcF93aGl0ZXNwYWNlLCBuZXh0X3NpYmxpbmcpIHtcbiAgICAgICAgdGhpcy5ub2RlcyA9IFtdO1xuICAgICAgICBsZXQgbGFzdF9jaGlsZDtcbiAgICAgICAgbGV0IHdpbmRvd193cmFwcGVyO1xuICAgICAgICBsZXQgaSA9IG5vZGVzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBub2Rlc1tpXTtcbiAgICAgICAgICAgIGlmICghY2hpbGQudHlwZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignbWlzc2luZyB0eXBlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIShjaGlsZC50eXBlIGluIHdyYXBwZXJzKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVE9ETyBpbXBsZW1lbnQgJHtjaGlsZC50eXBlfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gc3BlY2lhbCBjYXNlIOKAlCB0aGlzIGlzIGFuIGVhc3kgd2F5IHRvIHJlbW92ZSB3aGl0ZXNwYWNlIHN1cnJvdW5kaW5nXG4gICAgICAgICAgICAvLyA8c3ZlbHRlOndpbmRvdy8+LiBsaWwgaGFja3kgYnV0IGl0IHdvcmtzXG4gICAgICAgICAgICBpZiAoY2hpbGQudHlwZSA9PT0gJ1dpbmRvdycpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3dfd3JhcHBlciA9IG5ldyBXaW5kb3dXcmFwcGVyKHJlbmRlcmVyLCBibG9jaywgcGFyZW50LCBjaGlsZCk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2hpbGQudHlwZSA9PT0gJ1RleHQnKSB7XG4gICAgICAgICAgICAgICAgbGV0IHsgZGF0YSB9ID0gY2hpbGQ7XG4gICAgICAgICAgICAgICAgLy8gV2Ugd2FudCB0byByZW1vdmUgdHJhaWxpbmcgd2hpdGVzcGFjZSBpbnNpZGUgYW4gZWxlbWVudC9jb21wb25lbnQvYmxvY2ssXG4gICAgICAgICAgICAgICAgLy8gKnVubGVzcyogdGhlcmUgaXMgbm8gd2hpdGVzcGFjZSBiZXR3ZWVuIHRoaXMgbm9kZSBhbmQgaXRzIG5leHQgc2libGluZ1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzaG91bGRfdHJpbSA9IChuZXh0X3NpYmxpbmcgPyAobmV4dF9zaWJsaW5nLm5vZGUudHlwZSA9PT0gJ1RleHQnICYmIHJlZ2V4X3N0YXJ0c193aXRoX3doaXRlc3BhY2UudGVzdChuZXh0X3NpYmxpbmcubm9kZS5kYXRhKSAmJiB0cmltbWFibGVfYXQoY2hpbGQsIG5leHRfc2libGluZykpIDogIWNoaWxkLmhhc19hbmNlc3RvcignRWFjaEJsb2NrJykpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdWxkX3RyaW0gJiYgIWNoaWxkLmtlZXBfc3BhY2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHRyaW1fZW5kKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGdsdWUgdGV4dCBub2RlcyAod2hpY2ggY291bGQgZS5nLiBiZSBzZXBhcmF0ZWQgYnkgY29tbWVudHMpIHRvZ2V0aGVyXG4gICAgICAgICAgICAgICAgaWYgKGxhc3RfY2hpbGQgJiYgbGFzdF9jaGlsZC5ub2RlLnR5cGUgPT09ICdUZXh0Jykge1xuICAgICAgICAgICAgICAgICAgICBsYXN0X2NoaWxkLmRhdGEgPSBkYXRhICsgbGFzdF9jaGlsZC5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgd3JhcHBlciA9IG5ldyBUZXh0V3JhcHBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgY2hpbGQsIGRhdGEpO1xuICAgICAgICAgICAgICAgIGlmICh3cmFwcGVyLnNraXApXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHRoaXMubm9kZXMudW5zaGlmdCh3cmFwcGVyKTtcbiAgICAgICAgICAgICAgICBsaW5rKGxhc3RfY2hpbGQsIGxhc3RfY2hpbGQgPSB3cmFwcGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IFdyYXBwZXIgPSB3cmFwcGVyc1tjaGlsZC50eXBlXTtcbiAgICAgICAgICAgICAgICBpZiAoIVdyYXBwZXIpXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHdyYXBwZXIgPSBuZXcgV3JhcHBlcihyZW5kZXJlciwgYmxvY2ssIHBhcmVudCwgY2hpbGQsIHN0cmlwX3doaXRlc3BhY2UsIGxhc3RfY2hpbGQgfHwgbmV4dF9zaWJsaW5nKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVzLnVuc2hpZnQod3JhcHBlcik7XG4gICAgICAgICAgICAgICAgbGluayhsYXN0X2NoaWxkLCBsYXN0X2NoaWxkID0gd3JhcHBlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0cmlwX3doaXRlc3BhY2UpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0ID0gdGhpcy5ub2Rlc1swXTtcbiAgICAgICAgICAgIGlmIChmaXJzdCAmJiBmaXJzdC5ub2RlLnR5cGUgPT09ICdUZXh0JyAmJiAhZmlyc3Qubm9kZS5rZWVwX3NwYWNlKCkpIHtcbiAgICAgICAgICAgICAgICBmaXJzdC5kYXRhID0gdHJpbV9zdGFydChmaXJzdC5kYXRhKTtcbiAgICAgICAgICAgICAgICBpZiAoIWZpcnN0LmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlyc3QudmFyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2Rlcy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ub2Rlc1swXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2Rlc1swXS5wcmV2ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAod2luZG93X3dyYXBwZXIpIHtcbiAgICAgICAgICAgIHRoaXMubm9kZXMudW5zaGlmdCh3aW5kb3dfd3JhcHBlcik7XG4gICAgICAgICAgICBsaW5rKGxhc3RfY2hpbGQsIHdpbmRvd193cmFwcGVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXIoYmxvY2ssIHBhcmVudF9ub2RlLCBwYXJlbnRfbm9kZXMpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLnJlbmRlcihibG9jaywgcGFyZW50X25vZGUsIHBhcmVudF9ub2Rlcyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIFJlbmRlcmVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb21wb25lbnQsIG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gW107XG4gICAgICAgIHRoaXMuaW5pdGlhbF9jb250ZXh0ID0gW107XG4gICAgICAgIHRoaXMuY29udGV4dF9sb29rdXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuYmxvY2tzID0gW107XG4gICAgICAgIHRoaXMucmVhZG9ubHkgPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMubWV0YV9iaW5kaW5ncyA9IFtdOyAvLyBpbml0aWFsIHZhbHVlcyBmb3IgZS5nLiB3aW5kb3cuaW5uZXJXaWR0aCwgaWYgdGhlcmUncyBhIDxzdmVsdGU6d2luZG93PiBtZXRhIHRhZ1xuICAgICAgICB0aGlzLmJpbmRpbmdfZ3JvdXBzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmNvbXBvbmVudCA9IGNvbXBvbmVudDtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5sb2NhdGUgPSBjb21wb25lbnQubG9jYXRlOyAvLyBUT0RPIG1lc3N5XG4gICAgICAgIHRoaXMuZmlsZV92YXIgPSBvcHRpb25zLmRldiAmJiB0aGlzLmNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoJ2ZpbGUnKTtcbiAgICAgICAgY29tcG9uZW50LnZhcnMuZmlsdGVyKHYgPT4gIXYuaG9pc3RhYmxlIHx8ICh2LmV4cG9ydF9uYW1lICYmICF2Lm1vZHVsZSkpLmZvckVhY2godiA9PiB0aGlzLmFkZF90b19jb250ZXh0KHYubmFtZSkpO1xuICAgICAgICAvLyBlbnN1cmUgc3RvcmUgdmFsdWVzIGFyZSBpbmNsdWRlZCBpbiBjb250ZXh0XG4gICAgICAgIGNvbXBvbmVudC52YXJzLmZpbHRlcih2ID0+IHYuc3Vic2NyaWJhYmxlKS5mb3JFYWNoKHYgPT4gdGhpcy5hZGRfdG9fY29udGV4dChgJCR7di5uYW1lfWApKTtcbiAgICAgICAgcmVzZXJ2ZWRfa2V5d29yZHMuZm9yRWFjaChrZXl3b3JkID0+IHtcbiAgICAgICAgICAgIGlmIChjb21wb25lbnQudmFyX2xvb2t1cC5oYXMoa2V5d29yZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZF90b19jb250ZXh0KGtleXdvcmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGNvbXBvbmVudC5zbG90cy5zaXplID4gMCkge1xuICAgICAgICAgICAgdGhpcy5hZGRfdG9fY29udGV4dCgnJCRzY29wZScpO1xuICAgICAgICAgICAgdGhpcy5hZGRfdG9fY29udGV4dCgnI3Nsb3RzJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYmluZGluZ19ncm91cHMuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuYWRkX3RvX2NvbnRleHQoJyQkYmluZGluZ19ncm91cHMnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBtYWluIGJsb2NrXG4gICAgICAgIHRoaXMuYmxvY2sgPSBuZXcgQmxvY2skMSh7XG4gICAgICAgICAgICByZW5kZXJlcjogdGhpcyxcbiAgICAgICAgICAgIG5hbWU6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiAnY29tcG9uZW50JyxcbiAgICAgICAgICAgIGtleTogbnVsbCxcbiAgICAgICAgICAgIGJpbmRpbmdzOiBuZXcgTWFwKCksXG4gICAgICAgICAgICBkZXBlbmRlbmNpZXM6IG5ldyBTZXQoKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5ibG9jay5oYXNfdXBkYXRlX21ldGhvZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZnJhZ21lbnQgPSBuZXcgRnJhZ21lbnRXcmFwcGVyKHRoaXMsIHRoaXMuYmxvY2ssIGNvbXBvbmVudC5mcmFnbWVudC5jaGlsZHJlbiwgbnVsbCwgdHJ1ZSwgbnVsbCk7XG4gICAgICAgIC8vIFRPRE8gbWVzc3lcbiAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChibG9jayA9PiB7XG4gICAgICAgICAgICBpZiAoYmxvY2sgaW5zdGFuY2VvZiBCbG9jayQxKSB7XG4gICAgICAgICAgICAgICAgYmxvY2suYXNzaWduX3ZhcmlhYmxlX25hbWVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJsb2NrLmFzc2lnbl92YXJpYWJsZV9uYW1lcygpO1xuICAgICAgICB0aGlzLmZyYWdtZW50LnJlbmRlcih0aGlzLmJsb2NrLCBudWxsLCB4IGAjbm9kZXNgKTtcbiAgICAgICAgdGhpcy5jb250ZXh0X292ZXJmbG93ID0gdGhpcy5jb250ZXh0Lmxlbmd0aCA+IDMxO1xuICAgICAgICB0aGlzLmNvbnRleHQuZm9yRWFjaChtZW1iZXIgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyB2YXJpYWJsZSB9ID0gbWVtYmVyO1xuICAgICAgICAgICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICAgICAgICAgICAgbWVtYmVyLnByaW9yaXR5ICs9IDI7XG4gICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlLm11dGF0ZWQgfHwgdmFyaWFibGUucmVhc3NpZ25lZClcbiAgICAgICAgICAgICAgICAgICAgbWVtYmVyLnByaW9yaXR5ICs9IDQ7XG4gICAgICAgICAgICAgICAgLy8gdGhlc2UgZGV0ZXJtaW5lIHdoZXRoZXIgdmFyaWFibGUgaXMgaW5jbHVkZWQgaW4gaW5pdGlhbCBjb250ZXh0XG4gICAgICAgICAgICAgICAgLy8gYXJyYXksIHNvIG11c3QgaGF2ZSB0aGUgaGlnaGVzdCBwcmlvcml0eVxuICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZS5pc19yZWFjdGl2ZV9kZXBlbmRlbmN5ICYmICh2YXJpYWJsZS5tdXRhdGVkIHx8IHZhcmlhYmxlLnJlYXNzaWduZWQpKVxuICAgICAgICAgICAgICAgICAgICBtZW1iZXIucHJpb3JpdHkgKz0gMTY7XG4gICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlLmV4cG9ydF9uYW1lKVxuICAgICAgICAgICAgICAgICAgICBtZW1iZXIucHJpb3JpdHkgKz0gMzI7XG4gICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlLnJlZmVyZW5jZWQpXG4gICAgICAgICAgICAgICAgICAgIG1lbWJlci5wcmlvcml0eSArPSA2NDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG1lbWJlci5pc19ub25fY29udGV4dHVhbCkge1xuICAgICAgICAgICAgICAgIC8vIGRldGVybWluZSB3aGV0aGVyIHZhcmlhYmxlIGlzIGluY2x1ZGVkIGluIGluaXRpYWwgY29udGV4dFxuICAgICAgICAgICAgICAgIC8vIGFycmF5LCBzbyBtdXN0IGhhdmUgdGhlIGhpZ2hlc3QgcHJpb3JpdHlcbiAgICAgICAgICAgICAgICBtZW1iZXIucHJpb3JpdHkgKz0gODtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghbWVtYmVyLmlzX2NvbnRleHR1YWwpIHtcbiAgICAgICAgICAgICAgICBtZW1iZXIucHJpb3JpdHkgKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29udGV4dC5zb3J0KChhLCBiKSA9PiAoYi5wcmlvcml0eSAtIGEucHJpb3JpdHkpIHx8IChhLmluZGV4LnZhbHVlIC0gYi5pbmRleC52YWx1ZSkpO1xuICAgICAgICB0aGlzLmNvbnRleHQuZm9yRWFjaCgobWVtYmVyLCBpKSA9PiBtZW1iZXIuaW5kZXgudmFsdWUgPSBpKTtcbiAgICAgICAgbGV0IGkgPSB0aGlzLmNvbnRleHQubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBtZW1iZXIgPSB0aGlzLmNvbnRleHRbaV07XG4gICAgICAgICAgICBpZiAobWVtYmVyLnZhcmlhYmxlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1lbWJlci52YXJpYWJsZS5yZWZlcmVuY2VkIHx8IG1lbWJlci52YXJpYWJsZS5leHBvcnRfbmFtZSB8fCAobWVtYmVyLnZhcmlhYmxlLmlzX3JlYWN0aXZlX2RlcGVuZGVuY3kgJiYgKG1lbWJlci52YXJpYWJsZS5tdXRhdGVkIHx8IG1lbWJlci52YXJpYWJsZS5yZWFzc2lnbmVkKSkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobWVtYmVyLmlzX25vbl9jb250ZXh0dWFsKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0aWFsX2NvbnRleHQgPSB0aGlzLmNvbnRleHQuc2xpY2UoMCwgaSArIDEpO1xuICAgIH1cbiAgICBhZGRfdG9fY29udGV4dChuYW1lLCBjb250ZXh0dWFsID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnRleHRfbG9va3VwLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgY29uc3QgbWVtYmVyID0ge1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgaW5kZXg6IHsgdHlwZTogJ0xpdGVyYWwnLCB2YWx1ZTogdGhpcy5jb250ZXh0Lmxlbmd0aCB9LFxuICAgICAgICAgICAgICAgIGlzX2NvbnRleHR1YWw6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGlzX25vbl9jb250ZXh0dWFsOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB2YXJpYWJsZTogbnVsbCxcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dF9sb29rdXAuc2V0KG5hbWUsIG1lbWJlcik7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucHVzaChtZW1iZXIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG1lbWJlciA9IHRoaXMuY29udGV4dF9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICBpZiAoY29udGV4dHVhbCkge1xuICAgICAgICAgICAgbWVtYmVyLmlzX2NvbnRleHR1YWwgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbWVtYmVyLmlzX25vbl9jb250ZXh0dWFsID0gdHJ1ZTtcbiAgICAgICAgICAgIG1lbWJlci52YXJpYWJsZSA9IHRoaXMuY29tcG9uZW50LnZhcl9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtZW1iZXI7XG4gICAgfVxuICAgIGludmFsaWRhdGUobmFtZSwgdmFsdWUsIG1haW5fZXhlY3V0aW9uX2NvbnRleHQgPSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gcmVuZGVyZXJfaW52YWxpZGF0ZSh0aGlzLCBuYW1lLCB2YWx1ZSwgbWFpbl9leGVjdXRpb25fY29udGV4dCk7XG4gICAgfVxuICAgIGRpcnR5KG5hbWVzLCBpc19yZWFjdGl2ZV9kZWNsYXJhdGlvbiA9IGZhbHNlKSB7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcztcbiAgICAgICAgY29uc3QgZGlydHkgPSAoaXNfcmVhY3RpdmVfZGVjbGFyYXRpb25cbiAgICAgICAgICAgID8geCBgJCRzZWxmLiQkLmRpcnR5YFxuICAgICAgICAgICAgOiB4IGAjZGlydHlgKTtcbiAgICAgICAgY29uc3QgZ2V0X2JpdG1hc2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBiaXRtYXNrID0gW107XG4gICAgICAgICAgICBuYW1lcy5mb3JFYWNoKChuYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWVtYmVyID0gcmVuZGVyZXIuY29udGV4dF9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmICghbWVtYmVyKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgaWYgKG1lbWJlci5pbmRleC52YWx1ZSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bnNldCBpbmRleCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IG1lbWJlci5pbmRleC52YWx1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gKHZhbHVlIC8gMzEpIHwgMDtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gMSA8PCAodmFsdWUgJSAzMSk7XG4gICAgICAgICAgICAgICAgaWYgKCFiaXRtYXNrW2ldKVxuICAgICAgICAgICAgICAgICAgICBiaXRtYXNrW2ldID0geyBuOiAwLCBuYW1lczogW10gfTtcbiAgICAgICAgICAgICAgICBiaXRtYXNrW2ldLm4gfD0gbjtcbiAgICAgICAgICAgICAgICBiaXRtYXNrW2ldLm5hbWVzLnB1c2gobmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBiaXRtYXNrO1xuICAgICAgICB9O1xuICAgICAgICAvLyBUT0RPOiBjb250ZXh0LW92ZXJmbG93IG1ha2UgaXQgbGVzcyBncm9zc1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLy8gVXNpbmcgYSBQYXJlbnRoZXNpemVkRXhwcmVzc2lvbiBhbGxvd3MgdXMgdG8gY3JlYXRlXG4gICAgICAgICAgICAvLyB0aGUgZXhwcmVzc2lvbiBsYXppbHkuIFRPRE8gd291bGQgYmUgYmV0dGVyIGlmXG4gICAgICAgICAgICAvLyBjb250ZXh0IHdhcyBkZXRlcm1pbmVkIGJlZm9yZSByZW5kZXJpbmcsIHNvIHRoYXRcbiAgICAgICAgICAgIC8vIHRoaXMgaW5kaXJlY3Rpb24gd2FzIHVubmVjZXNzYXJ5XG4gICAgICAgICAgICB0eXBlOiAnUGFyZW50aGVzaXplZEV4cHJlc3Npb24nLFxuICAgICAgICAgICAgZ2V0IGV4cHJlc3Npb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYml0bWFzayA9IGdldF9iaXRtYXNrKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFiaXRtYXNrLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geCBgJHtkaXJ0eX0gJiAvKiR7bmFtZXMuam9pbignLCAnKX0qLyAwYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJlbmRlcmVyLmNvbnRleHRfb3ZlcmZsb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJpdG1hc2tcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKGIsIGkpID0+ICh7IGIsIGkgfSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKCh7IGIgfSkgPT4gYilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKHsgYiwgaSB9KSA9PiB4IGAke2RpcnR5fVske2l9XSAmIC8qJHtiLm5hbWVzLmpvaW4oJywgJyl9Ki8gJHtiLm59YClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30gfCAke3Joc31gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHggYCR7ZGlydHl9ICYgLyoke25hbWVzLmpvaW4oJywgJyl9Ki8gJHtiaXRtYXNrWzBdLm59YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLy8gTk9URTogdGhpcyBtZXRob2QgbWF5IGJlIGNhbGxlZCBiZWZvcmUgdGhpcy5jb250ZXh0X292ZXJmbG93IC8gdGhpcy5jb250ZXh0IGlzIGZ1bGx5IGRlZmluZWRcbiAgICAvLyB0aGVyZWZvcmUsIHRoZXkgY2FuIG9ubHkgYmUgZXZhbHVhdGVkIGxhdGVyIGluIGEgZ2V0dGVyIGZ1bmN0aW9uXG4gICAgZ2V0X2luaXRpYWxfZGlydHkoKSB7XG4gICAgICAgIGNvbnN0IF90aGlzID0gdGhpcztcbiAgICAgICAgLy8gVE9ETzogY29udGV4dC1vdmVyZmxvdyBtYWtlIGl0IGxlc3MgZ3Jvc3NcbiAgICAgICAgY29uc3QgdmFsID0geCBgLTFgO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0IHR5cGUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNvbnRleHRfb3ZlcmZsb3cgPyAnQXJyYXlFeHByZXNzaW9uJyA6ICdVbmFyeUV4cHJlc3Npb24nO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIGFzIFstMV1cbiAgICAgICAgICAgIGdldCBlbGVtZW50cygpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50cyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgX3RoaXMuY29udGV4dC5sZW5ndGg7IGkgKz0gMzEpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHMucHVzaCh2YWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudHM7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gYXMgLTFcbiAgICAgICAgICAgIG9wZXJhdG9yOiB2YWwub3BlcmF0b3IsXG4gICAgICAgICAgICBwcmVmaXg6IHZhbC5wcmVmaXgsXG4gICAgICAgICAgICBhcmd1bWVudDogdmFsLmFyZ3VtZW50XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJlZmVyZW5jZShub2RlLCBjdHggPSAnI2N0eCcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBub2RlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgbm9kZSA9IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiBub2RlIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBuYW1lLCBub2RlcyB9ID0gZmxhdHRlbl9yZWZlcmVuY2Uobm9kZSk7XG4gICAgICAgIGNvbnN0IG1lbWJlciA9IHRoaXMuY29udGV4dF9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAvLyBUT0RPIGlzIHRoaXMgY29ycmVjdD9cbiAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50LnZhcl9sb29rdXAuZ2V0KG5hbWUpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudC5hZGRfcmVmZXJlbmNlKG5vZGUsIG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtZW1iZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSB4IGAvKiR7bWVtYmVyLm5hbWV9Ki8gJHtjdHh9WyR7bWVtYmVyLmluZGV4fV1gO1xuICAgICAgICAgICAgaWYgKG5vZGVzWzBdLmxvYylcbiAgICAgICAgICAgICAgICByZXBsYWNlbWVudC5vYmplY3QubG9jID0gbm9kZXNbMF0ubG9jO1xuICAgICAgICAgICAgbm9kZXNbMF0gPSByZXBsYWNlbWVudDtcbiAgICAgICAgICAgIHJldHVybiBub2Rlcy5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30uJHtyaHN9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuICAgIHJlbW92ZV9ibG9jayhibG9jaykge1xuICAgICAgICB0aGlzLmJsb2Nrcy5zcGxpY2UodGhpcy5ibG9ja3MuaW5kZXhPZihibG9jayksIDEpO1xuICAgIH1cbn1cblxudmFyIGNoYXJUb0ludGVnZXIkMSA9IHt9O1xudmFyIGNoYXJzJDEgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0nO1xuZm9yICh2YXIgaSQzID0gMDsgaSQzIDwgY2hhcnMkMS5sZW5ndGg7IGkkMysrKSB7XG4gICAgY2hhclRvSW50ZWdlciQxW2NoYXJzJDEuY2hhckNvZGVBdChpJDMpXSA9IGkkMztcbn1cbmZ1bmN0aW9uIGRlY29kZSQxKG1hcHBpbmdzKSB7XG4gICAgdmFyIGRlY29kZWQgPSBbXTtcbiAgICB2YXIgbGluZSA9IFtdO1xuICAgIHZhciBzZWdtZW50ID0gW1xuICAgICAgICAwLFxuICAgICAgICAwLFxuICAgICAgICAwLFxuICAgICAgICAwLFxuICAgICAgICAwLFxuICAgIF07XG4gICAgdmFyIGogPSAwO1xuICAgIGZvciAodmFyIGkgPSAwLCBzaGlmdCA9IDAsIHZhbHVlID0gMDsgaSA8IG1hcHBpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjID0gbWFwcGluZ3MuY2hhckNvZGVBdChpKTtcbiAgICAgICAgaWYgKGMgPT09IDQ0KSB7IC8vIFwiLFwiXG4gICAgICAgICAgICBzZWdtZW50aWZ5JDEobGluZSwgc2VnbWVudCwgaik7XG4gICAgICAgICAgICBqID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjID09PSA1OSkgeyAvLyBcIjtcIlxuICAgICAgICAgICAgc2VnbWVudGlmeSQxKGxpbmUsIHNlZ21lbnQsIGopO1xuICAgICAgICAgICAgaiA9IDA7XG4gICAgICAgICAgICBkZWNvZGVkLnB1c2gobGluZSk7XG4gICAgICAgICAgICBsaW5lID0gW107XG4gICAgICAgICAgICBzZWdtZW50WzBdID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpbnRlZ2VyID0gY2hhclRvSW50ZWdlciQxW2NdO1xuICAgICAgICAgICAgaWYgKGludGVnZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjaGFyYWN0ZXIgKCcgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpICsgJyknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBoYXNDb250aW51YXRpb25CaXQgPSBpbnRlZ2VyICYgMzI7XG4gICAgICAgICAgICBpbnRlZ2VyICY9IDMxO1xuICAgICAgICAgICAgdmFsdWUgKz0gaW50ZWdlciA8PCBzaGlmdDtcbiAgICAgICAgICAgIGlmIChoYXNDb250aW51YXRpb25CaXQpIHtcbiAgICAgICAgICAgICAgICBzaGlmdCArPSA1O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHNob3VsZE5lZ2F0ZSA9IHZhbHVlICYgMTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA+Pj49IDE7XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZE5lZ2F0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlID09PSAwID8gLTB4ODAwMDAwMDAgOiAtdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlZ21lbnRbal0gKz0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gc2hpZnQgPSAwOyAvLyByZXNldFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHNlZ21lbnRpZnkkMShsaW5lLCBzZWdtZW50LCBqKTtcbiAgICBkZWNvZGVkLnB1c2gobGluZSk7XG4gICAgcmV0dXJuIGRlY29kZWQ7XG59XG5mdW5jdGlvbiBzZWdtZW50aWZ5JDEobGluZSwgc2VnbWVudCwgaikge1xuICAgIC8vIFRoaXMgbG9va3MgdWdseSwgYnV0IHdlJ3JlIGNyZWF0aW5nIHNwZWNpYWxpemVkIGFycmF5cyB3aXRoIGEgc3BlY2lmaWNcbiAgICAvLyBsZW5ndGguIFRoaXMgaXMgbXVjaCBmYXN0ZXIgdGhhbiBjcmVhdGluZyBhIG5ldyBhcnJheSAod2hpY2ggdjggZXhwYW5kcyB0b1xuICAgIC8vIGEgY2FwYWNpdHkgb2YgMTcgYWZ0ZXIgcHVzaGluZyB0aGUgZmlyc3QgaXRlbSksIG9yIHNsaWNpbmcgb3V0IGEgc3ViYXJyYXlcbiAgICAvLyAod2hpY2ggaXMgc2xvdykuIExlbmd0aCA0IGlzIGFzc3VtZWQgdG8gYmUgdGhlIG1vc3QgZnJlcXVlbnQsIGZvbGxvd2VkIGJ5XG4gICAgLy8gbGVuZ3RoIDUgKHNpbmNlIG5vdCBldmVyeXRoaW5nIHdpbGwgaGF2ZSBhbiBhc3NvY2lhdGVkIG5hbWUpLCBmb2xsb3dlZCBieVxuICAgIC8vIGxlbmd0aCAxIChpdCdzIHByb2JhYmx5IHJhcmUgZm9yIGEgc291cmNlIHN1YnN0cmluZyB0byBub3QgaGF2ZSBhblxuICAgIC8vIGFzc29jaWF0ZWQgc2VnbWVudCBkYXRhKS5cbiAgICBpZiAoaiA9PT0gNClcbiAgICAgICAgbGluZS5wdXNoKFtzZWdtZW50WzBdLCBzZWdtZW50WzFdLCBzZWdtZW50WzJdLCBzZWdtZW50WzNdXSk7XG4gICAgZWxzZSBpZiAoaiA9PT0gNSlcbiAgICAgICAgbGluZS5wdXNoKFtzZWdtZW50WzBdLCBzZWdtZW50WzFdLCBzZWdtZW50WzJdLCBzZWdtZW50WzNdLCBzZWdtZW50WzRdXSk7XG4gICAgZWxzZSBpZiAoaiA9PT0gMSlcbiAgICAgICAgbGluZS5wdXNoKFtzZWdtZW50WzBdXSk7XG59XG5mdW5jdGlvbiBlbmNvZGUkMShkZWNvZGVkKSB7XG4gICAgdmFyIHNvdXJjZUZpbGVJbmRleCA9IDA7IC8vIHNlY29uZCBmaWVsZFxuICAgIHZhciBzb3VyY2VDb2RlTGluZSA9IDA7IC8vIHRoaXJkIGZpZWxkXG4gICAgdmFyIHNvdXJjZUNvZGVDb2x1bW4gPSAwOyAvLyBmb3VydGggZmllbGRcbiAgICB2YXIgbmFtZUluZGV4ID0gMDsgLy8gZmlmdGggZmllbGRcbiAgICB2YXIgbWFwcGluZ3MgPSAnJztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRlY29kZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGxpbmUgPSBkZWNvZGVkW2ldO1xuICAgICAgICBpZiAoaSA+IDApXG4gICAgICAgICAgICBtYXBwaW5ncyArPSAnOyc7XG4gICAgICAgIGlmIChsaW5lLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB2YXIgZ2VuZXJhdGVkQ29kZUNvbHVtbiA9IDA7IC8vIGZpcnN0IGZpZWxkXG4gICAgICAgIHZhciBsaW5lTWFwcGluZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBsaW5lXzEgPSBsaW5lOyBfaSA8IGxpbmVfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBzZWdtZW50ID0gbGluZV8xW19pXTtcbiAgICAgICAgICAgIHZhciBzZWdtZW50TWFwcGluZ3MgPSBlbmNvZGVJbnRlZ2VyJDEoc2VnbWVudFswXSAtIGdlbmVyYXRlZENvZGVDb2x1bW4pO1xuICAgICAgICAgICAgZ2VuZXJhdGVkQ29kZUNvbHVtbiA9IHNlZ21lbnRbMF07XG4gICAgICAgICAgICBpZiAoc2VnbWVudC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgc2VnbWVudE1hcHBpbmdzICs9XG4gICAgICAgICAgICAgICAgICAgIGVuY29kZUludGVnZXIkMShzZWdtZW50WzFdIC0gc291cmNlRmlsZUluZGV4KSArXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVJbnRlZ2VyJDEoc2VnbWVudFsyXSAtIHNvdXJjZUNvZGVMaW5lKSArXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVJbnRlZ2VyJDEoc2VnbWVudFszXSAtIHNvdXJjZUNvZGVDb2x1bW4pO1xuICAgICAgICAgICAgICAgIHNvdXJjZUZpbGVJbmRleCA9IHNlZ21lbnRbMV07XG4gICAgICAgICAgICAgICAgc291cmNlQ29kZUxpbmUgPSBzZWdtZW50WzJdO1xuICAgICAgICAgICAgICAgIHNvdXJjZUNvZGVDb2x1bW4gPSBzZWdtZW50WzNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlZ21lbnQubGVuZ3RoID09PSA1KSB7XG4gICAgICAgICAgICAgICAgc2VnbWVudE1hcHBpbmdzICs9IGVuY29kZUludGVnZXIkMShzZWdtZW50WzRdIC0gbmFtZUluZGV4KTtcbiAgICAgICAgICAgICAgICBuYW1lSW5kZXggPSBzZWdtZW50WzRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGluZU1hcHBpbmdzLnB1c2goc2VnbWVudE1hcHBpbmdzKTtcbiAgICAgICAgfVxuICAgICAgICBtYXBwaW5ncyArPSBsaW5lTWFwcGluZ3Muam9pbignLCcpO1xuICAgIH1cbiAgICByZXR1cm4gbWFwcGluZ3M7XG59XG5mdW5jdGlvbiBlbmNvZGVJbnRlZ2VyJDEobnVtKSB7XG4gICAgdmFyIHJlc3VsdCA9ICcnO1xuICAgIG51bSA9IG51bSA8IDAgPyAoLW51bSA8PCAxKSB8IDEgOiBudW0gPDwgMTtcbiAgICBkbyB7XG4gICAgICAgIHZhciBjbGFtcGVkID0gbnVtICYgMzE7XG4gICAgICAgIG51bSA+Pj49IDU7XG4gICAgICAgIGlmIChudW0gPiAwKSB7XG4gICAgICAgICAgICBjbGFtcGVkIHw9IDMyO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCArPSBjaGFycyQxW2NsYW1wZWRdO1xuICAgIH0gd2hpbGUgKG51bSA+IDApO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogQ29weXJpZ2h0IDIwMTkgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDcmVhdGVzIGEgYnJhbmQgbmV3IChwcm90b3R5cGUtbGVzcykgb2JqZWN0IHdpdGggdGhlIGVudW1lcmFibGUtb3duXG4gKiBwcm9wZXJ0aWVzIG9mIGB0YXJnZXRgLiBBbnkgZW51bWVyYWJsZS1vd24gcHJvcGVydGllcyBmcm9tIGBzb3VyY2VgIHdoaWNoXG4gKiBhcmUgbm90IHByZXNlbnQgb24gYHRhcmdldGAgd2lsbCBiZSBjb3BpZWQgYXMgd2VsbC5cbiAqL1xuZnVuY3Rpb24gZGVmYXVsdHModGFyZ2V0LCBzb3VyY2UpIHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKG51bGwpLCBzb3VyY2UsIHRhcmdldCk7XG59XG5cbi8qKlxuICogQ29weXJpZ2h0IDIwMTkgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBEZWNvZGVzIGFuIGlucHV0IHNvdXJjZW1hcCBpbnRvIGEgYERlY29kZWRTb3VyY2VNYXBgIHNvdXJjZW1hcCBvYmplY3QuXG4gKlxuICogVmFsaWQgaW5wdXQgbWFwcyBpbmNsdWRlIGEgYERlY29kZWRTb3VyY2VNYXBgLCBhIGBSYXdTb3VyY2VNYXBgLCBvciBKU09OXG4gKiByZXByZXNlbnRhdGlvbnMgb2YgZWl0aGVyIHR5cGUuXG4gKi9cbmZ1bmN0aW9uIGRlY29kZVNvdXJjZU1hcChtYXApIHtcbiAgICBpZiAodHlwZW9mIG1hcCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgbWFwID0gSlNPTi5wYXJzZShtYXApO1xuICAgIH1cbiAgICBsZXQgeyBtYXBwaW5ncyB9ID0gbWFwO1xuICAgIGlmICh0eXBlb2YgbWFwcGluZ3MgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIG1hcHBpbmdzID0gZGVjb2RlJDEobWFwcGluZ3MpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy8gQ2xvbmUgdGhlIExpbmUgc28gdGhhdCB3ZSBjYW4gc29ydCBpdC4gV2UgZG9uJ3Qgd2FudCB0byBtdXRhdGUgYW4gYXJyYXlcbiAgICAgICAgLy8gdGhhdCB3ZSBkb24ndCBvd24gZGlyZWN0bHkuXG4gICAgICAgIG1hcHBpbmdzID0gbWFwcGluZ3MubWFwKGNsb25lU2VnbWVudExpbmUpO1xuICAgIH1cbiAgICAvLyBTb3J0IGVhY2ggTGluZSdzIHNlZ21lbnRzLiBUaGVyZSdzIG5vIGd1YXJhbnRlZSB0aGF0IHNlZ21lbnRzIGFyZSBzb3J0ZWQgZm9yIHVzLFxuICAgIC8vIGFuZCBldmVuIENocm9tZSdzIGltcGxlbWVudGF0aW9uIHNvcnRzOlxuICAgIC8vIGh0dHBzOi8vY3MuY2hyb21pdW0ub3JnL2Nocm9taXVtL3NyYy90aGlyZF9wYXJ0eS9kZXZ0b29scy1mcm9udGVuZC9zcmMvZnJvbnRfZW5kL3Nkay9Tb3VyY2VNYXAuanM/bD01MDctNTA4JnJjbD0xMDkyMzJiY2Y0NzljOGY0ZWY4ZWFkM2NmNTZjNDllYjI1ZjhjMmYwXG4gICAgbWFwcGluZ3MuZm9yRWFjaChzb3J0U2VnbWVudHMpO1xuICAgIHJldHVybiBkZWZhdWx0cyh7IG1hcHBpbmdzIH0sIG1hcCk7XG59XG5mdW5jdGlvbiBjbG9uZVNlZ21lbnRMaW5lKHNlZ21lbnRzKSB7XG4gICAgcmV0dXJuIHNlZ21lbnRzLnNsaWNlKCk7XG59XG5mdW5jdGlvbiBzb3J0U2VnbWVudHMoc2VnbWVudHMpIHtcbiAgICBzZWdtZW50cy5zb3J0KHNlZ21lbnRDb21wYXJhdG9yKTtcbn1cbmZ1bmN0aW9uIHNlZ21lbnRDb21wYXJhdG9yKGEsIGIpIHtcbiAgICByZXR1cm4gYVswXSAtIGJbMF07XG59XG5cbi8qKlxuICogQ29weXJpZ2h0IDIwMTkgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIFwibGVhZlwiIG5vZGUgaW4gdGhlIHNvdXJjZW1hcCB0cmVlLCByZXByZXNlbnRpbmcgYW4gb3JpZ2luYWwsIHVubW9kaWZpZWRcbiAqIHNvdXJjZSBmaWxlLiBSZWN1cnNpdmUgc2VnbWVudCB0cmFjaW5nIGVuZHMgYXQgdGhlIGBPcmlnaW5hbFNvdXJjZWAuXG4gKi9cbmNsYXNzIE9yaWdpbmFsU291cmNlIHtcbiAgICBjb25zdHJ1Y3RvcihmaWxlbmFtZSwgY29udGVudCkge1xuICAgICAgICB0aGlzLmZpbGVuYW1lID0gZmlsZW5hbWU7XG4gICAgICAgIHRoaXMuY29udGVudCA9IGNvbnRlbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRyYWNpbmcgYSBgU291cmNlTWFwU2VnbWVudGAgZW5kcyB3aGVuIHdlIGdldCB0byBhbiBgT3JpZ2luYWxTb3VyY2VgLFxuICAgICAqIG1lYW5pbmcgdGhpcyBsaW5lL2NvbHVtbiBsb2NhdGlvbiBvcmlnaW5hdGVkIGZyb20gdGhpcyBzb3VyY2UgZmlsZS5cbiAgICAgKi9cbiAgICB0cmFjZVNlZ21lbnQobGluZSwgY29sdW1uLCBuYW1lKSB7XG4gICAgICAgIHJldHVybiB7IGNvbHVtbiwgbGluZSwgbmFtZSwgc291cmNlOiB0aGlzIH07XG4gICAgfVxufVxuXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuY29uc3QgVXJsJDEgPSAodHlwZW9mIFVSTCAhPT0gJ3VuZGVmaW5lZCcgPyBVUkwgOiByZXF1aXJlKCd1cmwnKS5VUkwpO1xuLy8gTWF0Y2hlcyBcIi4uXCIsIHdoaWNoIG11c3QgYmUgcHJlY2VlZGVkIGJ5IFwiL1wiIG9yIHRoZSBzdGFydCBvZiB0aGUgc3RyaW5nLCBhbmRcbi8vIG11c3QgYmUgZm9sbG93ZWQgYnkgYSBcIi9cIi4gV2UgZG8gbm90IGVhdCB0aGUgZm9sbG93aW5nIFwiL1wiLCBzbyB0aGF0IHRoZSBuZXh0XG4vLyBpdGVyYXRpb24gY2FuIG1hdGNoIG9uIGl0LlxuY29uc3QgcGFyZW50UmVnZXggPSAvKF58XFwvKVxcLlxcLig/PVxcL3wkKS9nO1xuZnVuY3Rpb24gaXNBYnNvbHV0ZVVybCh1cmwpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gISFuZXcgVXJsJDEodXJsKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbi8qKlxuICogQ3JlYXRlcyBhIGRpcmVjdG9yeSBuYW1lIHRoYXQgaXMgZ3VhcmFudGVlZCB0byBub3QgYmUgaW4gYHN0cmAuXG4gKi9cbmZ1bmN0aW9uIHVuaXFJblN0cihzdHIpIHtcbiAgICBsZXQgdW5pcSA9IFN0cmluZyhNYXRoLnJhbmRvbSgpKS5zbGljZSgyKTtcbiAgICB3aGlsZSAoc3RyLmluZGV4T2YodW5pcSkgPiAtMSkge1xuICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgICAgICB1bmlxICs9IHVuaXE7XG4gICAgfVxuICAgIHJldHVybiB1bmlxO1xufVxuLyoqXG4gKiBSZW1vdmVzIHRoZSBmaWxlbmFtZSBmcm9tIHRoZSBwYXRoIChldmVyeXRoaW5nIHRyYWlsaW5nIHRoZSBsYXN0IFwiL1wiKS4gVGhpc1xuICogaXMgb25seSBzYWZlIHRvIGNhbGwgb24gYSBwYXRoLCBuZXZlciBjYWxsIHdpdGggYW4gYWJzb2x1dGUgb3IgcHJvdG9jb2xcbiAqIHJlbGF0aXZlIFVSTC5cbiAqL1xuZnVuY3Rpb24gc3RyaXBQYXRoRmlsZW5hbWUocGF0aCkge1xuICAgIHBhdGggPSBub3JtYWxpemVQYXRoKHBhdGgpO1xuICAgIGNvbnN0IGluZGV4ID0gcGF0aC5sYXN0SW5kZXhPZignLycpO1xuICAgIHJldHVybiBwYXRoLnNsaWNlKDAsIGluZGV4ICsgMSk7XG59XG4vKipcbiAqIE5vcm1hbGl6ZXMgYSBwcm90b2NvbC1yZWxhdGl2ZSBVUkwsIGJ1dCBrZWVwcyBpdCBwcm90b2NvbCByZWxhdGl2ZSBieVxuICogc3RyaXBwaW5nIG91dCB0aGUgcHJvdG9jbCBiZWZvcmUgcmV0dXJuaW5nIGl0LlxuICovXG5mdW5jdGlvbiBub3JtYWxpemVQcm90b2NvbFJlbGF0aXZlKGlucHV0LCBhYnNvbHV0ZUJhc2UpIHtcbiAgICBjb25zdCB7IGhyZWYsIHByb3RvY29sIH0gPSBuZXcgVXJsJDEoaW5wdXQsIGFic29sdXRlQmFzZSk7XG4gICAgcmV0dXJuIGhyZWYuc2xpY2UocHJvdG9jb2wubGVuZ3RoKTtcbn1cbi8qKlxuICogTm9ybWFsaXplcyBhIHNpbXBsZSBwYXRoIChvbmUgdGhhdCBoYXMgbm8gXCIuLlwicywgb3IgaXMgYWJzb2x1dGUgc28gXCIuLlwicyBjYW5cbiAqIGJlIG5vcm1hbGl6ZWQgYWJzb2x1dGVseSkuXG4gKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZVNpbXBsZVBhdGgoaW5wdXQpIHtcbiAgICBjb25zdCB7IGhyZWYgfSA9IG5ldyBVcmwkMShpbnB1dCwgJ2h0dHBzOi8vZm9vLmNvbS8nKTtcbiAgICByZXR1cm4gaHJlZi5zbGljZSgnaHR0cHM6Ly9mb28uY29tLycubGVuZ3RoKTtcbn1cbi8qKlxuICogTm9ybWFsaXplcyBhIHBhdGgsIGVuc3VyaW5nIHRoYXQgZXhjZXNzIFwiLi5cInMgYXJlIHByZXNlcnZlZCBmb3IgcmVsYXRpdmVcbiAqIHBhdGhzIGluIHRoZSBvdXRwdXQuXG4gKlxuICogSWYgdGhlIGlucHV0IGlzIGFic29sdXRlLCB0aGlzIHdpbGwgcmV0dXJuIGFuIGFic29sdXRleSBub3JtYWxpemVkIHBhdGgsIGJ1dFxuICogaXQgd2lsbCBub3QgaGF2ZSBhIGxlYWRpbmcgXCIvXCIuXG4gKlxuICogSWYgdGhlIGlucHV0IGhhcyBhIGxlYWRpbmcgXCIuLlwiLCB0aGUgb3V0cHV0IHdpbGwgaGF2ZSBhIGxlYWRpbmcgXCIuLlwiLlxuICpcbiAqIElmIHRoZSBpbnB1dCBoYXMgYSBsZWFkaW5nIFwiLlwiLCB0aGUgb3V0cHV0IHdpbGwgbm90IGhhdmUgYSBsZWFkaW5nIFwiLlwiXG4gKiB1bmxlc3MgdGhlcmUgYXJlIHRvbyBtYW55IFwiLi5cInMsIGluIHdoaWNoIGNhc2UgdGhlcmUgd2lsbCBiZSBhIGxlYWRpbmcgXCIuLlwiLlxuICovXG5mdW5jdGlvbiBub3JtYWxpemVQYXRoKGlucHV0KSB7XG4gICAgLy8gSWYgdGhlcmUgYXJlIG5vIFwiLi5cInMsIHdlIGNhbiB0cmVhdCB0aGlzIGFzIGlmIGl0IHdlcmUgYW4gYWJzb2x1dGUgcGF0aC5cbiAgICAvLyBUaGUgcmV0dXJuIHdvbid0IGJlIGFuIGFic29sdXRlIHBhdGgsIHNvIGl0J3MgZWFzeS5cbiAgICBpZiAoIXBhcmVudFJlZ2V4LnRlc3QoaW5wdXQpKVxuICAgICAgICByZXR1cm4gbm9ybWFsaXplU2ltcGxlUGF0aChpbnB1dCk7XG4gICAgLy8gV2UgYWxyZWFkeSBmb3VuZCBvbmUgXCIuLlwiLiBMZXQncyBzZWUgaG93IG1hbnkgdGhlcmUgYXJlLlxuICAgIGxldCB0b3RhbCA9IDE7XG4gICAgd2hpbGUgKHBhcmVudFJlZ2V4LnRlc3QoaW5wdXQpKVxuICAgICAgICB0b3RhbCsrO1xuICAgIC8vIElmIHRoZXJlIGFyZSBcIi4uXCJzLCB3ZSBuZWVkIHRvIHByZWZpeCB0aGUgdGhlIHBhdGggd2l0aCB0aGUgc2FtZSBudW1iZXIgb2ZcbiAgICAvLyB1bmlxdWUgZGlyZWN0b3JpZXMuIFRoaXMgaXMgdG8gZW5zdXJlIHRoYXQgd2UgXCJyZW1lbWJlclwiIGhvdyBtYW55IHBhcmVudFxuICAgIC8vIGRpcmVjdG9yaWVzIHdlIGFyZSBhY2Nlc3NpbmcuIEVnLCBcIi4uLy4uLy4uXCIgbXVzdCBrZWVwIDMsIGFuZCBcImZvby8uLi8uLlwiXG4gICAgLy8gbXVzdCBrZWVwIDEuXG4gICAgY29uc3QgdW5pcURpcmVjdG9yeSA9IGB6JHt1bmlxSW5TdHIoaW5wdXQpfS9gO1xuICAgIC8vIHVuaXFEaXJlY3RvcnkgaXMganVzdCBhIFwielwiLCBmb2xsb3dlZCBieSBudW1iZXJzLCBmb2xsb3dlZCBieSBhIFwiL1wiLiBTb1xuICAgIC8vIGdlbmVyYXRpbmcgYSBydW50aW1lIHJlZ2V4IGZyb20gaXQgaXMgc2FmZS4gV2UnbGwgdXNlIHRoaXMgc2VhcmNoIHJlZ2V4IHRvXG4gICAgLy8gc3RyaXAgb3V0IG91ciB1bmlxIGRpcmVjdG9yeSBuYW1lcyBhbmQgaW5zZXJ0IGFueSBuZWVkZWQgXCIuLlwicy5cbiAgICBjb25zdCBzZWFyY2ggPSBuZXcgUmVnRXhwKGBeKD86JHt1bmlxRGlyZWN0b3J5fSkqYCk7XG4gICAgLy8gTm93IHdlIGNhbiByZXNvbHZlIHRoZSB0b3RhbCBwYXRoLiBJZiB0aGVyZSBhcmUgZXhjZXNzIFwiLi5cInMsIHRoZXkgd2lsbFxuICAgIC8vIGVsaW1pbmF0ZSBvbmUgb3IgbW9yZSBvZiB0aGUgdW5pcXVlIGRpcmVjdG9yaWVzIHdlIHByZWZpeCB3aXRoLlxuICAgIGNvbnN0IHJlbGF0aXZlID0gbm9ybWFsaXplU2ltcGxlUGF0aCh1bmlxRGlyZWN0b3J5LnJlcGVhdCh0b3RhbCkgKyBpbnB1dCk7XG4gICAgLy8gV2UgY2FuIG5vdyBjb3VudCB0aGUgbnVtYmVyIG9mIHVuaXF1ZSBkaXJlY3RvcmllcyB0aGF0IHdlcmUgZWxpbWluYXRlZC4gSWZcbiAgICAvLyB0aGVyZSB3ZXJlIDMsIGFuZCAxIHdhcyBlbGltaW5hdGVkLCB3ZSBrbm93IHdlIG9ubHkgbmVlZCB0byBhZGQgMSBcIi4uXCIuIElmXG4gICAgLy8gMiB3ZXJlIGVsaW1pbmF0ZWQsIHdlIG5lZWQgdG8gaW5zZXJ0IDIgXCIuLlwicy4gSWYgYWxsIDMgd2VyZSBlbGltaW5hdGVkLFxuICAgIC8vIHRoZW4gd2UgbmVlZCAzLCBldGMuIFRoaXMgcmVwbGFjZSBpcyBndXJhbnRlZWQgdG8gbWF0Y2ggKGl0IG1heSBtYXRjaCAwIG9yXG4gICAgLy8gbW9yZSB0aW1lcyksIGFuZCB3ZSBjYW4gY291bnQgdGhlIHRvdGFsIG1hdGNoIHRvIHNlZSBob3cgbWFueSB3ZXJlIGVsaW1pbmF0ZWQuXG4gICAgcmV0dXJuIHJlbGF0aXZlLnJlcGxhY2Uoc2VhcmNoLCAoYWxsKSA9PiB7XG4gICAgICAgIGNvbnN0IGxlZnRvdmVyID0gYWxsLmxlbmd0aCAvIHVuaXFEaXJlY3RvcnkubGVuZ3RoO1xuICAgICAgICByZXR1cm4gJy4uLycucmVwZWF0KHRvdGFsIC0gbGVmdG92ZXIpO1xuICAgIH0pO1xufVxuLyoqXG4gKiBBdHRlbXB0cyB0byByZXNvbHZlIGBpbnB1dGAgVVJMIHJlbGF0aXZlIHRvIGBiYXNlYC5cbiAqL1xuZnVuY3Rpb24gcmVzb2x2ZShpbnB1dCwgYmFzZSkge1xuICAgIGlmICghYmFzZSlcbiAgICAgICAgYmFzZSA9ICcnO1xuICAgIC8vIEFic29sdXRlIFVSTHMgYXJlIHZlcnkgZWFzeSB0byByZXNvbHZlIHJpZ2h0LlxuICAgIGlmIChpc0Fic29sdXRlVXJsKGlucHV0KSlcbiAgICAgICAgcmV0dXJuIG5ldyBVcmwkMShpbnB1dCkuaHJlZjtcbiAgICBpZiAoYmFzZSkge1xuICAgICAgICAvLyBBYnNvbHV0ZSBVUkxzIGFyZSBlYXN5Li4uXG4gICAgICAgIGlmIChpc0Fic29sdXRlVXJsKGJhc2UpKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBVcmwkMShpbnB1dCwgYmFzZSkuaHJlZjtcbiAgICAgICAgLy8gSWYgYmFzZSBpcyBwcm90b2NvbCByZWxhdGl2ZSwgd2UnbGwgcmVzb2x2ZSB3aXRoIGl0IGJ1dCBrZWVwIHRoZSByZXN1bHRcbiAgICAgICAgLy8gcHJvdG9jb2wgcmVsYXRpdmUuXG4gICAgICAgIGlmIChiYXNlLnN0YXJ0c1dpdGgoJy8vJykpXG4gICAgICAgICAgICByZXR1cm4gbm9ybWFsaXplUHJvdG9jb2xSZWxhdGl2ZShpbnB1dCwgYGh0dHBzOiR7YmFzZX1gKTtcbiAgICB9XG4gICAgLy8gTm9ybWFsaXplIGlucHV0LCBidXQga2VlcCBpdCBwcm90b2NvbCByZWxhdGl2ZS4gV2Uga25vdyBiYXNlIGRvZXNuJ3Qgc3VwcGx5XG4gICAgLy8gYSBwcm90b2NvbCwgYmVjYXVzZSB0aGF0IHdvdWxkIGhhdmUgYmVlbiBoYW5kbGVkIGFib3ZlLlxuICAgIGlmIChpbnB1dC5zdGFydHNXaXRoKCcvLycpKVxuICAgICAgICByZXR1cm4gbm9ybWFsaXplUHJvdG9jb2xSZWxhdGl2ZShpbnB1dCwgJ2h0dHBzOi8vZm9vLmNvbS8nKTtcbiAgICAvLyBXZSBub3cga25vdyB0aGF0IGJhc2UgKGlmIHRoZXJlIGlzIG9uZSkgYW5kIGlucHV0IGFyZSBwYXRocy4gV2UndmUgaGFuZGxlZFxuICAgIC8vIGJvdGggYWJzb2x1dGUgYW5kIHByb3RvY29sLXJlbGF0aXZlIHZhcmlhdGlvbnMgYWJvdmUuXG4gICAgLy8gQWJzb2x1dGUgcGF0aHMgZG9uJ3QgbmVlZCBhbnkgc3BlY2lhbCBoYW5kbGluZywgYmVjYXVzZSB0aGV5IGNhbm5vdCBoYXZlXG4gICAgLy8gZXh0cmEgXCIuXCIgb3IgXCIuLlwicy4gVGhhdCdsbCBhbGwgYmUgc3RyaXBwZWQgYXdheS4gSW5wdXQgdGFrZXMgcHJpb3JpdHkgaGVyZSxcbiAgICAvLyBiZWNhdXNlIGlmIGlucHV0IGlzIGFuIGFic29sdXRlIHBhdGgsIGJhc2UgcGF0aCB3b24ndCBhZmZlY3QgaXQgaW4gYW55IHdheS5cbiAgICBpZiAoaW5wdXQuc3RhcnRzV2l0aCgnLycpKVxuICAgICAgICByZXR1cm4gJy8nICsgbm9ybWFsaXplU2ltcGxlUGF0aChpbnB1dCk7XG4gICAgLy8gU2luY2UgaW5wdXQgYW5kIGJhc2UgYXJlIHBhdGhzLCB3ZSBuZWVkIHRvIGpvaW4gdGhlbSB0byBkbyBhbnkgZnVydGhlclxuICAgIC8vIHByb2Nlc3NpbmcuIFBhdGhzIGFyZSBqb2luZWQgYXQgdGhlIGRpcmVjdG9yeSBsZXZlbCwgc28gd2UgbmVlZCB0byByZW1vdmVcbiAgICAvLyB0aGUgYmFzZSdzIGZpbGVuYW1lIGJlZm9yZSBqb2luaW5nLiBXZSBhbHNvIGtub3cgdGhhdCBpbnB1dCBkb2VzIG5vdCBoYXZlIGFcbiAgICAvLyBsZWFkaW5nIHNsYXNoLCBhbmQgdGhhdCB0aGUgc3RyaXBwZWQgYmFzZSB3aWxsIGhhdmUgYSB0cmFpbGluZyBzbGFzaCBpZlxuICAgIC8vIHRoZXJlIGFyZSBhbnkgZGlyZWN0b3JpZXMgKG9yIGl0J2xsIGJlIGVtcHR5KS5cbiAgICBjb25zdCBqb2luZWQgPSBzdHJpcFBhdGhGaWxlbmFtZShiYXNlKSArIGlucHV0O1xuICAgIC8vIElmIGJhc2UgaXMgYW4gYWJzb2x1dGUgcGF0aCwgdGhlbiBpbnB1dCB3aWxsIGJlIHJlbGF0aXZlIHRvIGl0LlxuICAgIGlmIChiYXNlLnN0YXJ0c1dpdGgoJy8nKSlcbiAgICAgICAgcmV0dXJuICcvJyArIG5vcm1hbGl6ZVNpbXBsZVBhdGgoam9pbmVkKTtcbiAgICAvLyBXZSBub3cga25vdyBib3RoIGJhc2UgKGlmIHRoZXJlIGlzIG9uZSkgYW5kIGlucHV0IGFyZSByZWxhdGl2ZSBwYXRocy5cbiAgICBjb25zdCByZWxhdGl2ZSA9IG5vcm1hbGl6ZVBhdGgoam9pbmVkKTtcbiAgICAvLyBJZiBiYXNlIHN0YXJ0ZWQgd2l0aCBhIGxlYWRpbmcgXCIuXCIsIG9yIHRoZXJlIGlzIG5vIGJhc2UgYW5kIGlucHV0IHN0YXJ0ZWRcbiAgICAvLyB3aXRoIGEgXCIuXCIsIHRoZW4gd2UgbmVlZCB0byBlbnN1cmUgdGhhdCB0aGUgcmVsYXRpdmUgcGF0aCBzdGFydHMgd2l0aCBhXG4gICAgLy8gXCIuXCIuIFdlIGRvbid0IGtub3cgaWYgcmVsYXRpdmUgc3RhcnRzIHdpdGggYSBcIi4uXCIsIHRob3VnaCwgc28gY2hlY2sgYmVmb3JlXG4gICAgLy8gcHJlcGVuZGluZy5cbiAgICBpZiAoKGJhc2UgfHwgaW5wdXQpLnN0YXJ0c1dpdGgoJy4nKSAmJiAhcmVsYXRpdmUuc3RhcnRzV2l0aCgnLicpKSB7XG4gICAgICAgIHJldHVybiAnLi8nICsgcmVsYXRpdmU7XG4gICAgfVxuICAgIHJldHVybiByZWxhdGl2ZTtcbn1cblxuLyoqXG4gKiBDb3B5cmlnaHQgMjAxOSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiByZXNvbHZlJDEoaW5wdXQsIGJhc2UpIHtcbiAgICAvLyBUaGUgYmFzZSBpcyBhbHdheXMgdHJlYXRlZCBhcyBhIGRpcmVjdG9yeSwgaWYgaXQncyBub3QgZW1wdHkuXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL21vemlsbGEvc291cmNlLW1hcC9ibG9iLzhjYjNlZTU3L2xpYi91dGlsLmpzI0wzMjdcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vY2hyb21pdW0vY2hyb21pdW0vYmxvYi9kYTRhZGJiMy90aGlyZF9wYXJ0eS9ibGluay9yZW5kZXJlci9kZXZ0b29scy9mcm9udF9lbmQvc2RrL1NvdXJjZU1hcC5qcyNMNDAwLUw0MDFcbiAgICBpZiAoYmFzZSAmJiAhYmFzZS5lbmRzV2l0aCgnLycpKVxuICAgICAgICBiYXNlICs9ICcvJztcbiAgICByZXR1cm4gcmVzb2x2ZShpbnB1dCwgYmFzZSk7XG59XG5cbi8qKlxuICogQ29weXJpZ2h0IDIwMTkgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGJpbmFyeSBzZWFyY2ggaW1wbGVtZW50YXRpb24gdGhhdCByZXR1cm5zIHRoZSBpbmRleCBpZiBhIG1hdGNoIGlzIGZvdW5kLFxuICogb3IgdGhlIG5lZ2F0ZWQgaW5kZXggb2Ygd2hlcmUgdGhlIGBuZWVkbGVgIHNob3VsZCBiZSBpbnNlcnRlZC5cbiAqXG4gKiBUaGUgYGNvbXBhcmF0b3JgIGNhbGxiYWNrIHJlY2VpdmVzIGJvdGggdGhlIGBpdGVtYCB1bmRlciBjb21wYXJpc29uIGFuZCB0aGVcbiAqIG5lZWRsZSB3ZSBhcmUgc2VhcmNoaW5nIGZvci4gSXQgbXVzdCByZXR1cm4gYDBgIGlmIHRoZSBgaXRlbWAgaXMgYSBtYXRjaCxcbiAqIGFueSBuZWdhdGl2ZSBudW1iZXIgaWYgYGl0ZW1gIGlzIHRvbyBzbWFsbCAoYW5kIHdlIG11c3Qgc2VhcmNoIGFmdGVyIGl0KSwgb3JcbiAqIGFueSBwb3NpdGl2ZSBudW1iZXIgaWYgdGhlIGBpdGVtYCBpcyB0b28gbGFyZ2UgKGFuZCB3ZSBtdXN0IHNlYXJjaCBiZWZvcmVcbiAqIGl0KS5cbiAqXG4gKiBJZiBubyBtYXRjaCBpcyBmb3VuZCwgYSBuZWdhdGVkIGluZGV4IG9mIHdoZXJlIHRvIGluc2VydCB0aGUgYG5lZWRsZWAgaXNcbiAqIHJldHVybmVkLiBUaGlzIG5lZ2F0ZWQgaW5kZXggaXMgZ3VhcmFudGVlZCB0byBiZSBsZXNzIHRoYW4gMC4gVG8gaW5zZXJ0IGFuXG4gKiBpdGVtLCBuZWdhdGUgaXQgKGFnYWluKSBhbmQgc3BsaWNlOlxuICpcbiAqIGBgYGpzXG4gKiBjb25zdCBhcnJheSA9IFsxLCAzXTtcbiAqIGNvbnN0IG5lZWRsZSA9IDI7XG4gKiBjb25zdCBpbmRleCA9IGJpbmFyeVNlYXJjaChhcnJheSwgbmVlZGxlLCAoaXRlbSwgbmVlZGxlKSA9PiBpdGVtIC0gbmVlZGxlKTtcbiAqXG4gKiBhc3NlcnQuZXF1YWwoaW5kZXgsIC0yKTtcbiAqIGFzc2VydC5lcXVhbCh+aW5kZXgsIDEpO1xuICogYXJyYXkuc3BsaWNlKH5pbmRleCwgMCwgbmVlZGxlKTtcbiAqIGFzc2VydC5kZWVwRXF1YWwoYXJyYXksIFsxLCAyLCAzXSk7XG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gYmluYXJ5U2VhcmNoKGhheXN0YWNrLCBuZWVkbGUsIGNvbXBhcmF0b3IpIHtcbiAgICBsZXQgbG93ID0gMDtcbiAgICBsZXQgaGlnaCA9IGhheXN0YWNrLmxlbmd0aCAtIDE7XG4gICAgd2hpbGUgKGxvdyA8PSBoaWdoKSB7XG4gICAgICAgIGNvbnN0IG1pZCA9IGxvdyArICgoaGlnaCAtIGxvdykgPj4gMSk7XG4gICAgICAgIGNvbnN0IGNtcCA9IGNvbXBhcmF0b3IoaGF5c3RhY2tbbWlkXSwgbmVlZGxlKTtcbiAgICAgICAgaWYgKGNtcCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG1pZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY21wIDwgMCkge1xuICAgICAgICAgICAgbG93ID0gbWlkICsgMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGhpZ2ggPSBtaWQgLSAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB+bG93O1xufVxuXG4vKipcbiAqIENvcHlyaWdodCAyMDE5IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRmFzdFN0cmluZ0FycmF5IGFjdHMgbGlrZSBhIGBTZXRgIChhbGxvd2luZyBvbmx5IG9uZSBvY2N1cnJlbmNlIG9mIGEgc3RyaW5nXG4gKiBga2V5YCksIGJ1dCBwcm92aWRlcyB0aGUgaW5kZXggb2YgdGhlIGBrZXlgIGluIHRoZSBiYWNraW5nIGFycmF5LlxuICpcbiAqIFRoaXMgaXMgZGVzaWduZWQgdG8gYWxsb3cgc3luY2hyb25pemluZyBhIHNlY29uZCBhcnJheSB3aXRoIHRoZSBjb250ZW50cyBvZlxuICogdGhlIGJhY2tpbmcgYXJyYXksIGxpa2UgaG93IGBzb3VyY2VzQ29udGVudFtpXWAgaXMgdGhlIHNvdXJjZSBjb250ZW50XG4gKiBhc3NvY2lhdGVkIHdpdGggYHNvdXJjZVtpXWAsIGFuZCB0aGVyZSBhcmUgbmV2ZXIgZHVwbGljYXRlcy5cbiAqL1xuY2xhc3MgRmFzdFN0cmluZ0FycmF5IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5pbmRleGVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgdGhpcy5hcnJheSA9IFtdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQdXRzIGBrZXlgIGludG8gdGhlIGJhY2tpbmcgYXJyYXksIGlmIGl0IGlzIG5vdCBhbHJlYWR5IHByZXNlbnQuIFJldHVybnNcbiAgICAgKiB0aGUgaW5kZXggb2YgdGhlIGBrZXlgIGluIHRoZSBiYWNraW5nIGFycmF5LlxuICAgICAqL1xuICAgIHB1dChrZXkpIHtcbiAgICAgICAgY29uc3QgeyBhcnJheSwgaW5kZXhlcyB9ID0gdGhpcztcbiAgICAgICAgLy8gVGhlIGtleSBtYXkgb3IgbWF5IG5vdCBiZSBwcmVzZW50LiBJZiBpdCBpcyBwcmVzZW50LCBpdCdzIGEgbnVtYmVyLlxuICAgICAgICBsZXQgaW5kZXggPSBpbmRleGVzW2tleV07XG4gICAgICAgIC8vIElmIGl0J3Mgbm90IHlldCBwcmVzZW50LCB3ZSBuZWVkIHRvIGluc2VydCBpdCBhbmQgdHJhY2sgdGhlIGluZGV4IGluIHRoZVxuICAgICAgICAvLyBpbmRleGVzLlxuICAgICAgICBpZiAoaW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaW5kZXggPSBpbmRleGVzW2tleV0gPSBhcnJheS5sZW5ndGg7XG4gICAgICAgICAgICBhcnJheS5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb3B5cmlnaHQgMjAxOSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNvdXJjZU1hcFRyZWUgcmVwcmVzZW50cyBhIHNpbmdsZSBzb3VyY2VtYXAsIHdpdGggdGhlIGFiaWxpdHkgdG8gdHJhY2VcbiAqIG1hcHBpbmdzIGludG8gaXRzIGNoaWxkIG5vZGVzICh3aGljaCBtYXkgdGhlbXNlbHZlcyBiZSBTb3VyY2VNYXBUcmVlcykuXG4gKi9cbmNsYXNzIFNvdXJjZU1hcFRyZWUge1xuICAgIGNvbnN0cnVjdG9yKG1hcCwgc291cmNlcykge1xuICAgICAgICB0aGlzLm1hcCA9IG1hcDtcbiAgICAgICAgdGhpcy5zb3VyY2VzID0gc291cmNlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogdHJhY2VNYXBwaW5ncyBpcyBvbmx5IGNhbGxlZCBvbiB0aGUgcm9vdCBsZXZlbCBTb3VyY2VNYXBUcmVlLCBhbmQgYmVnaW5zXG4gICAgICogdGhlIHByb2Nlc3Mgb2YgcmVzb2x2aW5nIGVhY2ggbWFwcGluZyBpbiB0ZXJtcyBvZiB0aGUgb3JpZ2luYWwgc291cmNlXG4gICAgICogZmlsZXMuXG4gICAgICovXG4gICAgdHJhY2VNYXBwaW5ncygpIHtcbiAgICAgICAgY29uc3QgbWFwcGluZ3MgPSBbXTtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBuZXcgRmFzdFN0cmluZ0FycmF5KCk7XG4gICAgICAgIGNvbnN0IHNvdXJjZXMgPSBuZXcgRmFzdFN0cmluZ0FycmF5KCk7XG4gICAgICAgIGNvbnN0IHNvdXJjZXNDb250ZW50ID0gW107XG4gICAgICAgIGNvbnN0IHsgbWFwcGluZ3M6IHJvb3RNYXBwaW5ncywgbmFtZXM6IHJvb3ROYW1lcyB9ID0gdGhpcy5tYXA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm9vdE1hcHBpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBzZWdtZW50cyA9IHJvb3RNYXBwaW5nc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IHRyYWNlZFNlZ21lbnRzID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHNlZ21lbnRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VnbWVudCA9IHNlZ21lbnRzW2pdO1xuICAgICAgICAgICAgICAgIC8vIDEtbGVuZ3RoIHNlZ21lbnRzIG9ubHkgbW92ZSB0aGUgY3VycmVudCBnZW5lcmF0ZWQgY29sdW1uLCB0aGVyZSdzIG5vXG4gICAgICAgICAgICAgICAgLy8gc291cmNlIGluZm9ybWF0aW9uIHRvIGdhdGhlciBmcm9tIGl0LlxuICAgICAgICAgICAgICAgIGlmIChzZWdtZW50Lmxlbmd0aCA9PT0gMSlcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgY29uc3Qgc291cmNlID0gdGhpcy5zb3VyY2VzW3NlZ21lbnRbMV1dO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNlZCA9IHNvdXJjZS50cmFjZVNlZ21lbnQoc2VnbWVudFsyXSwgc2VnbWVudFszXSwgc2VnbWVudC5sZW5ndGggPT09IDUgPyByb290TmFtZXNbc2VnbWVudFs0XV0gOiAnJyk7XG4gICAgICAgICAgICAgICAgaWYgKCF0cmFjZWQpXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIC8vIFNvIHdlIHRyYWNlZCBhIHNlZ21lbnQgZG93biBpbnRvIGl0cyBvcmlnaW5hbCBzb3VyY2UgZmlsZS4gTm93IHB1c2ggYVxuICAgICAgICAgICAgICAgIC8vIG5ldyBzZWdtZW50IHBvaW50aW5nIHRvIHRoaXMgbG9jYXRpb24uXG4gICAgICAgICAgICAgICAgY29uc3QgeyBjb2x1bW4sIGxpbmUsIG5hbWUgfSA9IHRyYWNlZDtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGNvbnRlbnQsIGZpbGVuYW1lIH0gPSB0cmFjZWQuc291cmNlO1xuICAgICAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBzb3VyY2UgbG9jYXRpb24sIGFuZCBlbnN1cmUgd2Uga2VlcCBzb3VyY2VzQ29udGVudCB1cCB0b1xuICAgICAgICAgICAgICAgIC8vIGRhdGUgd2l0aCB0aGUgc291cmNlcyBhcnJheS5cbiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VJbmRleCA9IHNvdXJjZXMucHV0KGZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgICBzb3VyY2VzQ29udGVudFtzb3VyY2VJbmRleF0gPSBjb250ZW50O1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgbG9va3MgbGlrZSB1bm5lY2Vzc2FyeSBkdXBsaWNhdGlvbiwgYnV0IGl0IG5vdGljZWFibHkgaW5jcmVhc2VzXG4gICAgICAgICAgICAgICAgLy8gcGVyZm9ybWFuY2UuIElmIHdlIHdlcmUgdG8gcHVzaCB0aGUgbmFtZUluZGV4IG9udG8gbGVuZ3RoLTQgYXJyYXksIHY4XG4gICAgICAgICAgICAgICAgLy8gd291bGQgaW50ZXJuYWxseSBhbGxvY2F0ZSAyMiBzbG90cyEgVGhhdCdzIDY4IHdhc3RlZCBieXRlcyEgQXJyYXlcbiAgICAgICAgICAgICAgICAvLyBsaXRlcmFscyBoYXZlIHRoZSBzYW1lIGNhcGFjaXR5IGFzIHRoZWlyIGxlbmd0aCwgc2F2aW5nIG1lbW9yeS5cbiAgICAgICAgICAgICAgICBpZiAobmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFjZWRTZWdtZW50cy5wdXNoKFtzZWdtZW50WzBdLCBzb3VyY2VJbmRleCwgbGluZSwgY29sdW1uLCBuYW1lcy5wdXQobmFtZSldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlZFNlZ21lbnRzLnB1c2goW3NlZ21lbnRbMF0sIHNvdXJjZUluZGV4LCBsaW5lLCBjb2x1bW5dKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXBwaW5ncy5wdXNoKHRyYWNlZFNlZ21lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBUT0RPOiBNYWtlIGFsbCBzb3VyY2VzIHJlbGF0aXZlIHRvIHRoZSBzb3VyY2VSb290LlxuICAgICAgICByZXR1cm4gZGVmYXVsdHMoe1xuICAgICAgICAgICAgbWFwcGluZ3MsXG4gICAgICAgICAgICBuYW1lczogbmFtZXMuYXJyYXksXG4gICAgICAgICAgICBzb3VyY2VzOiBzb3VyY2VzLmFycmF5LFxuICAgICAgICAgICAgc291cmNlc0NvbnRlbnQsXG4gICAgICAgIH0sIHRoaXMubWFwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogdHJhY2VTZWdtZW50IGlzIG9ubHkgY2FsbGVkIG9uIGNoaWxkcmVuIFNvdXJjZU1hcFRyZWVzLiBJdCByZWN1cnNlcyBkb3duXG4gICAgICogaW50byBpdHMgb3duIGNoaWxkIFNvdXJjZU1hcFRyZWVzLCB1bnRpbCB3ZSBmaW5kIHRoZSBvcmlnaW5hbCBzb3VyY2UgbWFwLlxuICAgICAqL1xuICAgIHRyYWNlU2VnbWVudChsaW5lLCBjb2x1bW4sIG5hbWUpIHtcbiAgICAgICAgY29uc3QgeyBtYXBwaW5ncywgbmFtZXMgfSA9IHRoaXMubWFwO1xuICAgICAgICAvLyBJdCdzIGNvbW1vbiBmb3IgcGFyZW50IHNvdXJjZW1hcHMgdG8gaGF2ZSBwb2ludGVycyB0byBsaW5lcyB0aGF0IGhhdmUgbm9cbiAgICAgICAgLy8gbWFwcGluZyAobGlrZSBhIFwiLy8jIHNvdXJjZU1hcHBpbmdVUkw9XCIpIGF0IHRoZSBlbmQgb2YgdGhlIGNoaWxkIGZpbGUuXG4gICAgICAgIGlmIChsaW5lID49IG1hcHBpbmdzLmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCBzZWdtZW50cyA9IG1hcHBpbmdzW2xpbmVdO1xuICAgICAgICBpZiAoc2VnbWVudHMubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIGxldCBpbmRleCA9IGJpbmFyeVNlYXJjaChzZWdtZW50cywgY29sdW1uLCBzZWdtZW50Q29tcGFyYXRvciQxKTtcbiAgICAgICAgaWYgKGluZGV4ID09PSAtMSlcbiAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyB3ZSBjb21lIGJlZm9yZSBhbnkgbWFwcGVkIHNlZ21lbnRcbiAgICAgICAgLy8gSWYgd2UgY2FuJ3QgZmluZCBhIHNlZ21lbnQgdGhhdCBsaW5lcyB1cCB0byB0aGlzIGNvbHVtbiwgd2UgdXNlIHRoZVxuICAgICAgICAvLyBzZWdtZW50IGJlZm9yZS5cbiAgICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgaW5kZXggPSB+aW5kZXggLSAxO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNlZ21lbnQgPSBzZWdtZW50c1tpbmRleF07XG4gICAgICAgIC8vIDEtbGVuZ3RoIHNlZ21lbnRzIG9ubHkgbW92ZSB0aGUgY3VycmVudCBnZW5lcmF0ZWQgY29sdW1uLCB0aGVyZSdzIG5vXG4gICAgICAgIC8vIHNvdXJjZSBpbmZvcm1hdGlvbiB0byBnYXRoZXIgZnJvbSBpdC5cbiAgICAgICAgaWYgKHNlZ21lbnQubGVuZ3RoID09PSAxKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuc291cmNlc1tzZWdtZW50WzFdXTtcbiAgICAgICAgLy8gU28gbm93IHdlIGNhbiByZWN1cnNlIGRvd24sIHVudGlsIHdlIGhpdCB0aGUgb3JpZ2luYWwgc291cmNlIGZpbGUuXG4gICAgICAgIHJldHVybiBzb3VyY2UudHJhY2VTZWdtZW50KHNlZ21lbnRbMl0sIHNlZ21lbnRbM10sIFxuICAgICAgICAvLyBBIGNoaWxkIG1hcCdzIHJlY29yZGVkIG5hbWUgZm9yIHRoaXMgc2VnbWVudCB0YWtlcyBwcmVjZWRlbmNlIG92ZXIgdGhlXG4gICAgICAgIC8vIHBhcmVudCdzIG1hcHBlZCBuYW1lLiBJbWFnaW5lIGEgbWFuZ2xlciBjaGFuZ2luZyB0aGUgbmFtZSBvdmVyLCBldGMuXG4gICAgICAgIHNlZ21lbnQubGVuZ3RoID09PSA1ID8gbmFtZXNbc2VnbWVudFs0XV0gOiBuYW1lKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZWdtZW50Q29tcGFyYXRvciQxKHNlZ21lbnQsIGNvbHVtbikge1xuICAgIHJldHVybiBzZWdtZW50WzBdIC0gY29sdW1uO1xufVxuXG4vKipcbiAqIENvcHlyaWdodCAyMDE5IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVtb3ZlcyB0aGUgZmlsZW5hbWUgZnJvbSBhIHBhdGguXG4gKi9cbmZ1bmN0aW9uIHN0cmlwRmlsZW5hbWUocGF0aCkge1xuICAgIGlmICghcGF0aClcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIGNvbnN0IGluZGV4ID0gcGF0aC5sYXN0SW5kZXhPZignLycpO1xuICAgIHJldHVybiBwYXRoLnNsaWNlKDAsIGluZGV4ICsgMSk7XG59XG5cbi8qKlxuICogQ29weXJpZ2h0IDIwMTkgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gYXNBcnJheSh2YWx1ZSkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSlcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIHJldHVybiBbdmFsdWVdO1xufVxuLyoqXG4gKiBSZWN1cnNpdmVseSBidWlsZHMgYSB0cmVlIHN0cnVjdHVyZSBvdXQgb2Ygc291cmNlbWFwIGZpbGVzLCB3aXRoIGVhY2ggbm9kZVxuICogYmVpbmcgZWl0aGVyIGFuIGBPcmlnaW5hbFNvdXJjZWAgXCJsZWFmXCIgb3IgYSBgU291cmNlTWFwVHJlZWAgY29tcG9zZWQgb2ZcbiAqIGBPcmlnaW5hbFNvdXJjZWBzIGFuZCBgU291cmNlTWFwVHJlZWBzLlxuICpcbiAqIEV2ZXJ5IHNvdXJjZW1hcCBpcyBjb21wb3NlZCBvZiBhIGNvbGxlY3Rpb24gb2Ygc291cmNlIGZpbGVzIGFuZCBtYXBwaW5nc1xuICogaW50byBsb2NhdGlvbnMgb2YgdGhvc2Ugc291cmNlIGZpbGVzLiBXaGVuIHdlIGdlbmVyYXRlIGEgYFNvdXJjZU1hcFRyZWVgIGZvclxuICogdGhlIHNvdXJjZW1hcCwgd2UgYXR0ZW1wdCB0byBsb2FkIGVhY2ggc291cmNlIGZpbGUncyBvd24gc291cmNlbWFwLiBJZiBpdFxuICogZG9lcyBub3QgaGF2ZSBhbiBhc3NvY2lhdGVkIHNvdXJjZW1hcCwgaXQgaXMgY29uc2lkZXJlZCBhbiBvcmlnaW5hbCxcbiAqIHVubW9kaWZpZWQgc291cmNlIGZpbGUuXG4gKi9cbmZ1bmN0aW9uIGJ1aWxkU291cmNlTWFwVHJlZShpbnB1dCwgbG9hZGVyLCByZWxhdGl2ZVJvb3QpIHtcbiAgICBjb25zdCBtYXBzID0gYXNBcnJheShpbnB1dCkubWFwKGRlY29kZVNvdXJjZU1hcCk7XG4gICAgY29uc3QgbWFwID0gbWFwcy5wb3AoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKG1hcHNbaV0uc291cmNlcy5sZW5ndGggIT09IDEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVHJhbnNmb3JtYXRpb24gbWFwICR7aX0gbXVzdCBoYXZlIGV4YWN0bHkgb25lIHNvdXJjZSBmaWxlLlxcbmAgK1xuICAgICAgICAgICAgICAgICdEaWQgeW91IHNwZWNpZnkgdGhlc2Ugd2l0aCB0aGUgbW9zdCByZWNlbnQgdHJhbnNmb3JtYXRpb24gbWFwcyBmaXJzdD8nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCB7IHNvdXJjZVJvb3QsIHNvdXJjZXMsIHNvdXJjZXNDb250ZW50IH0gPSBtYXA7XG4gICAgY29uc3QgY2hpbGRyZW4gPSBzb3VyY2VzLm1hcCgoc291cmNlRmlsZSwgaSkgPT4ge1xuICAgICAgICAvLyBFYWNoIHNvdXJjZSBmaWxlIGlzIGxvYWRlZCByZWxhdGl2ZSB0byB0aGUgc291cmNlbWFwJ3Mgb3duIHNvdXJjZVJvb3QsXG4gICAgICAgIC8vIHdoaWNoIGlzIGl0c2VsZiByZWxhdGl2ZSB0byB0aGUgc291cmNlbWFwJ3MgcGFyZW50LlxuICAgICAgICBjb25zdCB1cmkgPSByZXNvbHZlJDEoc291cmNlRmlsZSB8fCAnJywgcmVzb2x2ZSQxKHNvdXJjZVJvb3QgfHwgJycsIHN0cmlwRmlsZW5hbWUocmVsYXRpdmVSb290KSkpO1xuICAgICAgICAvLyBVc2UgdGhlIHByb3ZpZGVkIGxvYWRlciBjYWxsYmFjayB0byByZXRyaWV2ZSB0aGUgZmlsZSdzIHNvdXJjZW1hcC5cbiAgICAgICAgLy8gVE9ETzogV2Ugc2hvdWxkIGV2ZW50dWFsbHkgc3VwcG9ydCBhc3luYyBsb2FkaW5nIG9mIHNvdXJjZW1hcCBmaWxlcy5cbiAgICAgICAgY29uc3Qgc291cmNlTWFwID0gbG9hZGVyKHVyaSk7XG4gICAgICAgIC8vIElmIHRoZXJlIGlzIG5vIHNvdXJjZW1hcCwgdGhlbiBpdCBpcyBhbiB1bm1vZGlmaWVkIHNvdXJjZSBmaWxlLlxuICAgICAgICBpZiAoIXNvdXJjZU1hcCkge1xuICAgICAgICAgICAgLy8gVGhlIHNvdXJjZSBmaWxlJ3MgYWN0dWFsIGNvbnRlbnRzIG11c3QgYmUgaW5jbHVkZWQgaW4gdGhlIHNvdXJjZW1hcFxuICAgICAgICAgICAgLy8gKGRvbmUgd2hlbiBnZW5lcmF0aW5nIHRoZSBzb3VyY2VtYXApIGZvciBpdCB0byBiZSBpbmNsdWRlZCBhcyBhXG4gICAgICAgICAgICAvLyBzb3VyY2VDb250ZW50IGluIHRoZSBvdXRwdXQgc291cmNlbWFwLlxuICAgICAgICAgICAgY29uc3Qgc291cmNlQ29udGVudCA9IHNvdXJjZXNDb250ZW50ID8gc291cmNlc0NvbnRlbnRbaV0gOiBudWxsO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBPcmlnaW5hbFNvdXJjZSh1cmksIHNvdXJjZUNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEVsc2UsIGl0J3MgYSByZWFsIHNvdXJjZW1hcCwgYW5kIHdlIG5lZWQgdG8gcmVjdXJzZSBpbnRvIGl0IHRvIGxvYWQgaXRzXG4gICAgICAgIC8vIHNvdXJjZSBmaWxlcy5cbiAgICAgICAgcmV0dXJuIGJ1aWxkU291cmNlTWFwVHJlZShkZWNvZGVTb3VyY2VNYXAoc291cmNlTWFwKSwgbG9hZGVyLCB1cmkpO1xuICAgIH0pO1xuICAgIGxldCB0cmVlID0gbmV3IFNvdXJjZU1hcFRyZWUobWFwLCBjaGlsZHJlbik7XG4gICAgZm9yIChsZXQgaSA9IG1hcHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgdHJlZSA9IG5ldyBTb3VyY2VNYXBUcmVlKG1hcHNbaV0sIFt0cmVlXSk7XG4gICAgfVxuICAgIHJldHVybiB0cmVlO1xufVxuXG4vKipcbiAqIENvcHlyaWdodCAyMDE5IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBTb3VyY2VNYXAgdjMgY29tcGF0aWJsZSBzb3VyY2VtYXAsIHdoaWNoIG9ubHkgaW5jbHVkZXMgZmllbGRzIHRoYXQgd2VyZVxuICogcHJvdmlkZWQgdG8gaXQuXG4gKi9cbmNsYXNzIFNvdXJjZU1hcCB7XG4gICAgY29uc3RydWN0b3IobWFwLCBleGNsdWRlQ29udGVudCkge1xuICAgICAgICB0aGlzLnZlcnNpb24gPSAzOyAvLyBTb3VyY2VNYXAgc3BlYyBzYXlzIHRoaXMgc2hvdWxkIGJlIGZpcnN0LlxuICAgICAgICBpZiAoJ2ZpbGUnIGluIG1hcClcbiAgICAgICAgICAgIHRoaXMuZmlsZSA9IG1hcC5maWxlO1xuICAgICAgICB0aGlzLm1hcHBpbmdzID0gZW5jb2RlJDEobWFwLm1hcHBpbmdzKTtcbiAgICAgICAgdGhpcy5uYW1lcyA9IG1hcC5uYW1lcztcbiAgICAgICAgLy8gVE9ETzogV2UgZmlyc3QgbmVlZCB0byBtYWtlIGFsbCBzb3VyY2UgVVJJcyByZWxhdGl2ZSB0byB0aGUgc291cmNlUm9vdFxuICAgICAgICAvLyBiZWZvcmUgd2UgY2FuIHN1cHBvcnQgYSBzb3VyY2VSb290LlxuICAgICAgICAvLyBpZiAoJ3NvdXJjZVJvb3QnIGluIG1hcCkgdGhpcy5zb3VyY2VSb290ID0gbWFwLnNvdXJjZVJvb3Q7XG4gICAgICAgIHRoaXMuc291cmNlcyA9IG1hcC5zb3VyY2VzO1xuICAgICAgICBpZiAoIWV4Y2x1ZGVDb250ZW50ICYmICdzb3VyY2VzQ29udGVudCcgaW4gbWFwKVxuICAgICAgICAgICAgdGhpcy5zb3VyY2VzQ29udGVudCA9IG1hcC5zb3VyY2VzQ29udGVudDtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ29weXJpZ2h0IDIwMTkgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUcmFjZXMgdGhyb3VnaCBhbGwgdGhlIG1hcHBpbmdzIGluIHRoZSByb290IHNvdXJjZW1hcCwgdGhyb3VnaCB0aGUgc291cmNlc1xuICogKGFuZCB0aGVpciBzb3VyY2VtYXBzKSwgYWxsIHRoZSB3YXkgYmFjayB0byB0aGUgb3JpZ2luYWwgc291cmNlIGxvY2F0aW9uLlxuICpcbiAqIGBsb2FkZXJgIHdpbGwgYmUgY2FsbGVkIGV2ZXJ5IHRpbWUgd2UgZW5jb3VudGVyIGEgc291cmNlIGZpbGUuIElmIGl0IHJldHVybnNcbiAqIGEgc291cmNlbWFwLCB3ZSB3aWxsIHJlY3Vyc2UgaW50byB0aGF0IHNvdXJjZW1hcCB0byBjb250aW51ZSB0aGUgdHJhY2UuIElmXG4gKiBpdCByZXR1cm5zIGEgZmFsc2V5IHZhbHVlLCB0aGF0IHNvdXJjZSBmaWxlIGlzIHRyZWF0ZWQgYXMgYW4gb3JpZ2luYWwsXG4gKiB1bm1vZGlmaWVkIHNvdXJjZSBmaWxlLlxuICpcbiAqIFBhc3MgYGV4Y2x1ZGVDb250ZW50YCBjb250ZW50IHRvIGV4Y2x1ZGUgYW55IHNlbGYtY29udGFpbmluZyBzb3VyY2UgZmlsZVxuICogY29udGVudCBmcm9tIHRoZSBvdXRwdXQgc291cmNlbWFwLlxuICovXG5mdW5jdGlvbiByZW1hcHBpbmcoaW5wdXQsIGxvYWRlciwgZXhjbHVkZUNvbnRlbnQpIHtcbiAgICBjb25zdCBncmFwaCA9IGJ1aWxkU291cmNlTWFwVHJlZShpbnB1dCwgbG9hZGVyKTtcbiAgICByZXR1cm4gbmV3IFNvdXJjZU1hcChncmFwaC50cmFjZU1hcHBpbmdzKCksICEhZXhjbHVkZUNvbnRlbnQpO1xufVxuXG5mdW5jdGlvbiBsYXN0X2xpbmVfbGVuZ3RoKHMpIHtcbiAgICByZXR1cm4gcy5sZW5ndGggLSBzLmxhc3RJbmRleE9mKCdcXG4nKSAtIDE7XG59XG4vLyBtdXRhdGUgbWFwIGluLXBsYWNlXG5mdW5jdGlvbiBzb3VyY2VtYXBfYWRkX29mZnNldChtYXAsIG9mZnNldCwgc291cmNlX2luZGV4KSB7XG4gICAgaWYgKG1hcC5tYXBwaW5ncy5sZW5ndGggPT0gMClcbiAgICAgICAgcmV0dXJuO1xuICAgIGZvciAobGV0IGxpbmUgPSAwOyBsaW5lIDwgbWFwLm1hcHBpbmdzLmxlbmd0aDsgbGluZSsrKSB7XG4gICAgICAgIGNvbnN0IHNlZ21lbnRfbGlzdCA9IG1hcC5tYXBwaW5nc1tsaW5lXTtcbiAgICAgICAgZm9yIChsZXQgc2VnbWVudCA9IDA7IHNlZ21lbnQgPCBzZWdtZW50X2xpc3QubGVuZ3RoOyBzZWdtZW50KyspIHtcbiAgICAgICAgICAgIGNvbnN0IHNlZyA9IHNlZ21lbnRfbGlzdFtzZWdtZW50XTtcbiAgICAgICAgICAgIC8vIHNoaWZ0IG9ubHkgc2VnbWVudHMgdGhhdCBiZWxvbmcgdG8gY29tcG9uZW50IHNvdXJjZSBmaWxlXG4gICAgICAgICAgICBpZiAoc2VnWzFdID09PSBzb3VyY2VfaW5kZXgpIHsgLy8gYWxzbyBlbnN1cmVzIHRoYXQgc2VnLmxlbmd0aCA+PSA0XG4gICAgICAgICAgICAgICAgLy8gc2hpZnQgY29sdW1uIGlmIGl0IHBvaW50cyBhdCB0aGUgZmlyc3QgbGluZVxuICAgICAgICAgICAgICAgIGlmIChzZWdbMl0gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc2VnWzNdICs9IG9mZnNldC5jb2x1bW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHNoaWZ0IGxpbmVcbiAgICAgICAgICAgICAgICBzZWdbMl0gKz0gb2Zmc2V0LmxpbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBtZXJnZV90YWJsZXModGhpc190YWJsZSwgb3RoZXJfdGFibGUpIHtcbiAgICBjb25zdCBuZXdfdGFibGUgPSB0aGlzX3RhYmxlLnNsaWNlKCk7XG4gICAgY29uc3QgaWR4X21hcCA9IFtdO1xuICAgIG90aGVyX3RhYmxlID0gb3RoZXJfdGFibGUgfHwgW107XG4gICAgbGV0IHZhbF9jaGFuZ2VkID0gZmFsc2U7XG4gICAgZm9yIChjb25zdCBbb3RoZXJfaWR4LCBvdGhlcl92YWxdIG9mIG90aGVyX3RhYmxlLmVudHJpZXMoKSkge1xuICAgICAgICBjb25zdCB0aGlzX2lkeCA9IHRoaXNfdGFibGUuaW5kZXhPZihvdGhlcl92YWwpO1xuICAgICAgICBpZiAodGhpc19pZHggPj0gMCkge1xuICAgICAgICAgICAgaWR4X21hcFtvdGhlcl9pZHhdID0gdGhpc19pZHg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBuZXdfaWR4ID0gbmV3X3RhYmxlLmxlbmd0aDtcbiAgICAgICAgICAgIG5ld190YWJsZVtuZXdfaWR4XSA9IG90aGVyX3ZhbDtcbiAgICAgICAgICAgIGlkeF9tYXBbb3RoZXJfaWR4XSA9IG5ld19pZHg7XG4gICAgICAgICAgICB2YWxfY2hhbmdlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGlkeF9jaGFuZ2VkID0gdmFsX2NoYW5nZWQ7XG4gICAgaWYgKHZhbF9jaGFuZ2VkKSB7XG4gICAgICAgIGlmIChpZHhfbWFwLmZpbmQoKHZhbCwgaWR4KSA9PiB2YWwgIT0gaWR4KSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBpZHhfbWFwIGlzIGlkZW50aXR5IG1hcCBbMCwgMSwgMiwgMywgNCwgLi4uLl1cbiAgICAgICAgICAgIGlkeF9jaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFtuZXdfdGFibGUsIGlkeF9tYXAsIHZhbF9jaGFuZ2VkLCBpZHhfY2hhbmdlZF07XG59XG5jb25zdCByZWdleF9saW5lX3Rva2VuID0gLyhbXlxcZFxcd1xcc118XFxzKykvZztcbmNsYXNzIE1hcHBlZENvZGUge1xuICAgIGNvbnN0cnVjdG9yKHN0cmluZyA9ICcnLCBtYXAgPSBudWxsKSB7XG4gICAgICAgIHRoaXMuc3RyaW5nID0gc3RyaW5nO1xuICAgICAgICBpZiAobWFwKSB7XG4gICAgICAgICAgICB0aGlzLm1hcCA9IG1hcDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubWFwID0ge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IDMsXG4gICAgICAgICAgICAgICAgbWFwcGluZ3M6IFtdLFxuICAgICAgICAgICAgICAgIHNvdXJjZXM6IFtdLFxuICAgICAgICAgICAgICAgIG5hbWVzOiBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBjb25jYXQgaW4tcGxhY2UgKG11dGFibGUpLCByZXR1cm4gdGhpcyAoY2hhaW5hYmxlKVxuICAgICAqIHdpbGwgYWxzbyBtdXRhdGUgdGhlIGBvdGhlcmAgb2JqZWN0XG4gICAgICovXG4gICAgY29uY2F0KG90aGVyKSB7XG4gICAgICAgIC8vIG5vb3A6IGlmIG9uZSBpcyBlbXB0eSwgcmV0dXJuIHRoZSBvdGhlclxuICAgICAgICBpZiAob3RoZXIuc3RyaW5nID09ICcnKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIGlmICh0aGlzLnN0cmluZyA9PSAnJykge1xuICAgICAgICAgICAgdGhpcy5zdHJpbmcgPSBvdGhlci5zdHJpbmc7XG4gICAgICAgICAgICB0aGlzLm1hcCA9IG90aGVyLm1hcDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIC8vIGNvbXB1dGUgbGFzdCBsaW5lIGxlbmd0aCBiZWZvcmUgbXV0YXRpbmdcbiAgICAgICAgY29uc3QgY29sdW1uX29mZnNldCA9IGxhc3RfbGluZV9sZW5ndGgodGhpcy5zdHJpbmcpO1xuICAgICAgICB0aGlzLnN0cmluZyArPSBvdGhlci5zdHJpbmc7XG4gICAgICAgIGNvbnN0IG0xID0gdGhpcy5tYXA7XG4gICAgICAgIGNvbnN0IG0yID0gb3RoZXIubWFwO1xuICAgICAgICBpZiAobTIubWFwcGluZ3MubGVuZ3RoID09IDApXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgLy8gY29tYmluZSBzb3VyY2VzIGFuZCBuYW1lc1xuICAgICAgICBjb25zdCBbc291cmNlcywgbmV3X3NvdXJjZV9pZHgsIHNvdXJjZXNfY2hhbmdlZCwgc291cmNlc19pZHhfY2hhbmdlZF0gPSBtZXJnZV90YWJsZXMobTEuc291cmNlcywgbTIuc291cmNlcyk7XG4gICAgICAgIGNvbnN0IFtuYW1lcywgbmV3X25hbWVfaWR4LCBuYW1lc19jaGFuZ2VkLCBuYW1lc19pZHhfY2hhbmdlZF0gPSBtZXJnZV90YWJsZXMobTEubmFtZXMsIG0yLm5hbWVzKTtcbiAgICAgICAgaWYgKHNvdXJjZXNfY2hhbmdlZClcbiAgICAgICAgICAgIG0xLnNvdXJjZXMgPSBzb3VyY2VzO1xuICAgICAgICBpZiAobmFtZXNfY2hhbmdlZClcbiAgICAgICAgICAgIG0xLm5hbWVzID0gbmFtZXM7XG4gICAgICAgIC8vIHVuc3dpdGNoZWQgbG9vcHMgYXJlIGZhc3RlclxuICAgICAgICBpZiAoc291cmNlc19pZHhfY2hhbmdlZCAmJiBuYW1lc19pZHhfY2hhbmdlZCkge1xuICAgICAgICAgICAgZm9yIChsZXQgbGluZSA9IDA7IGxpbmUgPCBtMi5tYXBwaW5ncy5sZW5ndGg7IGxpbmUrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlZ21lbnRfbGlzdCA9IG0yLm1hcHBpbmdzW2xpbmVdO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IHNlZ21lbnQgPSAwOyBzZWdtZW50IDwgc2VnbWVudF9saXN0Lmxlbmd0aDsgc2VnbWVudCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlZyA9IHNlZ21lbnRfbGlzdFtzZWdtZW50XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlZ1sxXSA+PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VnWzFdID0gbmV3X3NvdXJjZV9pZHhbc2VnWzFdXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlZ1s0XSA+PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VnWzRdID0gbmV3X25hbWVfaWR4W3NlZ1s0XV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNvdXJjZXNfaWR4X2NoYW5nZWQpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGxpbmUgPSAwOyBsaW5lIDwgbTIubWFwcGluZ3MubGVuZ3RoOyBsaW5lKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWdtZW50X2xpc3QgPSBtMi5tYXBwaW5nc1tsaW5lXTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBzZWdtZW50ID0gMDsgc2VnbWVudCA8IHNlZ21lbnRfbGlzdC5sZW5ndGg7IHNlZ21lbnQrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWcgPSBzZWdtZW50X2xpc3Rbc2VnbWVudF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWdbMV0gPj0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlZ1sxXSA9IG5ld19zb3VyY2VfaWR4W3NlZ1sxXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5hbWVzX2lkeF9jaGFuZ2VkKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBsaW5lID0gMDsgbGluZSA8IG0yLm1hcHBpbmdzLmxlbmd0aDsgbGluZSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VnbWVudF9saXN0ID0gbTIubWFwcGluZ3NbbGluZV07XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgc2VnbWVudCA9IDA7IHNlZ21lbnQgPCBzZWdtZW50X2xpc3QubGVuZ3RoOyBzZWdtZW50KyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VnID0gc2VnbWVudF9saXN0W3NlZ21lbnRdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VnWzRdID49IDApXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWdbNF0gPSBuZXdfbmFtZV9pZHhbc2VnWzRdXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gY29tYmluZSB0aGUgbWFwcGluZ3NcbiAgICAgICAgLy8gY29tYmluZVxuICAgICAgICAvLyAxLiBsYXN0IGxpbmUgb2YgZmlyc3QgbWFwXG4gICAgICAgIC8vIDIuIGZpcnN0IGxpbmUgb2Ygc2Vjb25kIG1hcFxuICAgICAgICAvLyBjb2x1bW5zIG9mIDIgbXVzdCBiZSBzaGlmdGVkXG4gICAgICAgIGlmIChtMi5tYXBwaW5ncy5sZW5ndGggPiAwICYmIGNvbHVtbl9vZmZzZXQgPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBmaXJzdF9saW5lID0gbTIubWFwcGluZ3NbMF07XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpcnN0X2xpbmUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmaXJzdF9saW5lW2ldWzBdICs9IGNvbHVtbl9vZmZzZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gY29tYmluZSBsYXN0IGxpbmUgKyBmaXJzdCBsaW5lXG4gICAgICAgIHB1c2hfYXJyYXkkMShtMS5tYXBwaW5nc1ttMS5tYXBwaW5ncy5sZW5ndGggLSAxXSwgbTIubWFwcGluZ3Muc2hpZnQoKSk7XG4gICAgICAgIC8vIGFwcGVuZCBvdGhlciBsaW5lc1xuICAgICAgICBwdXNoX2FycmF5JDEobTEubWFwcGluZ3MsIG0yLm1hcHBpbmdzKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tX3Byb2Nlc3NlZChzdHJpbmcsIG1hcCkge1xuICAgICAgICBjb25zdCBsaW5lX2NvdW50ID0gc3RyaW5nLnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgIGlmIChtYXApIHtcbiAgICAgICAgICAgIC8vIGVuc3VyZSB0aGF0IGNvdW50IG9mIHNvdXJjZSBtYXAgbWFwcGluZ3MgbGluZXNcbiAgICAgICAgICAgIC8vIGlzIGVxdWFsIHRvIGNvdW50IG9mIGdlbmVyYXRlZCBjb2RlIGxpbmVzXG4gICAgICAgICAgICAvLyAoc29tZSB0b29scyBtYXkgcHJvZHVjZSBsZXNzKVxuICAgICAgICAgICAgY29uc3QgbWlzc2luZ19saW5lcyA9IGxpbmVfY291bnQgLSBtYXAubWFwcGluZ3MubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtaXNzaW5nX2xpbmVzOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXAubWFwcGluZ3MucHVzaChbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IE1hcHBlZENvZGUoc3RyaW5nLCBtYXApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdHJpbmcgPT0gJycpXG4gICAgICAgICAgICByZXR1cm4gbmV3IE1hcHBlZENvZGUoKTtcbiAgICAgICAgbWFwID0geyB2ZXJzaW9uOiAzLCBuYW1lczogW10sIHNvdXJjZXM6IFtdLCBtYXBwaW5nczogW10gfTtcbiAgICAgICAgLy8gYWRkIGVtcHR5IFNvdXJjZU1hcFNlZ21lbnRbXSBmb3IgZXZlcnkgbGluZVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVfY291bnQ7IGkrKylcbiAgICAgICAgICAgIG1hcC5tYXBwaW5ncy5wdXNoKFtdKTtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXBwZWRDb2RlKHN0cmluZywgbWFwKTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21fc291cmNlKHsgc291cmNlLCBmaWxlX2Jhc2VuYW1lLCBnZXRfbG9jYXRpb24gfSkge1xuICAgICAgICBsZXQgb2Zmc2V0ID0gZ2V0X2xvY2F0aW9uKDApO1xuICAgICAgICBpZiAoIW9mZnNldClcbiAgICAgICAgICAgIG9mZnNldCA9IHsgbGluZTogMCwgY29sdW1uOiAwIH07XG4gICAgICAgIGNvbnN0IG1hcCA9IHsgdmVyc2lvbjogMywgbmFtZXM6IFtdLCBzb3VyY2VzOiBbZmlsZV9iYXNlbmFtZV0sIG1hcHBpbmdzOiBbXSB9O1xuICAgICAgICBpZiAoc291cmNlID09ICcnKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBNYXBwZWRDb2RlKHNvdXJjZSwgbWFwKTtcbiAgICAgICAgLy8gd2UgY3JlYXRlIGEgaGlnaCByZXNvbHV0aW9uIGlkZW50aXR5IG1hcCBoZXJlLFxuICAgICAgICAvLyB3ZSBrbm93IHRoYXQgaXQgd2lsbCBldmVudHVhbGx5IGJlIG1lcmdlZCB3aXRoIHN2ZWx0ZSdzIG1hcCxcbiAgICAgICAgLy8gYXQgd2hpY2ggc3RhZ2UgdGhlIHJlc29sdXRpb24gd2lsbCBkZWNyZWFzZS5cbiAgICAgICAgY29uc3QgbGluZV9saXN0ID0gc291cmNlLnNwbGl0KCdcXG4nKTtcbiAgICAgICAgZm9yIChsZXQgbGluZSA9IDA7IGxpbmUgPCBsaW5lX2xpc3QubGVuZ3RoOyBsaW5lKyspIHtcbiAgICAgICAgICAgIG1hcC5tYXBwaW5ncy5wdXNoKFtdKTtcbiAgICAgICAgICAgIGNvbnN0IHRva2VuX2xpc3QgPSBsaW5lX2xpc3RbbGluZV0uc3BsaXQocmVnZXhfbGluZV90b2tlbik7XG4gICAgICAgICAgICBmb3IgKGxldCB0b2tlbiA9IDAsIGNvbHVtbiA9IDA7IHRva2VuIDwgdG9rZW5fbGlzdC5sZW5ndGg7IHRva2VuKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodG9rZW5fbGlzdFt0b2tlbl0gPT0gJycpXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIG1hcC5tYXBwaW5nc1tsaW5lXS5wdXNoKFtjb2x1bW4sIDAsIG9mZnNldC5saW5lICsgbGluZSwgY29sdW1uXSk7XG4gICAgICAgICAgICAgICAgY29sdW1uICs9IHRva2VuX2xpc3RbdG9rZW5dLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBzaGlmdCBjb2x1bW5zIGluIGZpcnN0IGxpbmVcbiAgICAgICAgY29uc3Qgc2VnbWVudF9saXN0ID0gbWFwLm1hcHBpbmdzWzBdO1xuICAgICAgICBmb3IgKGxldCBzZWdtZW50ID0gMDsgc2VnbWVudCA8IHNlZ21lbnRfbGlzdC5sZW5ndGg7IHNlZ21lbnQrKykge1xuICAgICAgICAgICAgc2VnbWVudF9saXN0W3NlZ21lbnRdWzNdICs9IG9mZnNldC5jb2x1bW47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBNYXBwZWRDb2RlKHNvdXJjZSwgbWFwKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjb21iaW5lX3NvdXJjZW1hcHMoZmlsZW5hbWUsIHNvdXJjZW1hcF9saXN0KSB7XG4gICAgaWYgKHNvdXJjZW1hcF9saXN0Lmxlbmd0aCA9PSAwKVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICBsZXQgbWFwX2lkeCA9IDE7XG4gICAgY29uc3QgbWFwID0gc291cmNlbWFwX2xpc3Quc2xpY2UoMCwgLTEpXG4gICAgICAgIC5maW5kKG0gPT4gbS5zb3VyY2VzLmxlbmd0aCAhPT0gMSkgPT09IHVuZGVmaW5lZFxuICAgICAgICA/IHJlbWFwcGluZygvLyB1c2UgYXJyYXkgaW50ZXJmYWNlXG4gICAgICAgIC8vIG9ubHkgdGhlIG9sZGVzdCBzb3VyY2VtYXAgY2FuIGhhdmUgbXVsdGlwbGUgc291cmNlc1xuICAgICAgICBzb3VyY2VtYXBfbGlzdCwgKCkgPT4gbnVsbCwgdHJ1ZSAvLyBza2lwIG9wdGlvbmFsIGZpZWxkIGBzb3VyY2VzQ29udGVudGBcbiAgICAgICAgKVxuICAgICAgICA6IHJlbWFwcGluZygvLyB1c2UgbG9hZGVyIGludGVyZmFjZVxuICAgICAgICBzb3VyY2VtYXBfbGlzdFswXSwgLy8gbGFzdCBtYXBcbiAgICAgICAgZnVuY3Rpb24gbG9hZGVyKHNvdXJjZWZpbGUpIHtcbiAgICAgICAgICAgIGlmIChzb3VyY2VmaWxlID09PSBmaWxlbmFtZSAmJiBzb3VyY2VtYXBfbGlzdFttYXBfaWR4XSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2VtYXBfbGlzdFttYXBfaWR4KytdOyAvLyBpZHggMSwgMiwgLi4uXG4gICAgICAgICAgICAgICAgLy8gYnVuZGxlIGZpbGUgPSBicmFuY2ggbm9kZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIHNvdXJjZSBmaWxlID0gbGVhZiBub2RlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRydWUpO1xuICAgIGlmICghbWFwLmZpbGUpXG4gICAgICAgIGRlbGV0ZSBtYXAuZmlsZTsgLy8gc2tpcCBvcHRpb25hbCBmaWVsZCBgZmlsZWBcbiAgICAvLyBXaGVuIHNvdXJjZSBtYXBzIGFyZSBjb21iaW5lZCBhbmQgdGhlIGxlYWRpbmcgbWFwIGlzIGVtcHR5LCBzb3VyY2VzIGlzIG5vdCBzZXQuXG4gICAgLy8gQWRkIHRoZSBmaWxlbmFtZSB0byB0aGUgZW1wdHkgYXJyYXkgaW4gdGhpcyBjYXNlLlxuICAgIC8vIEZ1cnRoZXIgaW1wcm92ZW1lbnRzIHRvIHJlbWFwcGluZyBtYXkgaGVscCBhZGRyZXNzIHRoaXMgYXMgd2VsbCBodHRwczovL2dpdGh1Yi5jb20vYW1wcHJvamVjdC9yZW1hcHBpbmcvaXNzdWVzLzExNlxuICAgIGlmICghbWFwLnNvdXJjZXMubGVuZ3RoKVxuICAgICAgICBtYXAuc291cmNlcyA9IFtmaWxlbmFtZV07XG4gICAgcmV0dXJuIG1hcDtcbn1cbi8vIGJyb3dzZXIgdnMgbm9kZS5qc1xuY29uc3QgYjY0ZW5jID0gdHlwZW9mIGJ0b2EgPT0gJ2Z1bmN0aW9uJyA/IGJ0b2EgOiBiID0+IEJ1ZmZlci5mcm9tKGIpLnRvU3RyaW5nKCdiYXNlNjQnKTtcbmNvbnN0IGI2NGRlYyA9IHR5cGVvZiBhdG9iID09ICdmdW5jdGlvbicgPyBhdG9iIDogYSA9PiBCdWZmZXIuZnJvbShhLCAnYmFzZTY0JykudG9TdHJpbmcoKTtcbmZ1bmN0aW9uIGFwcGx5X3ByZXByb2Nlc3Nvcl9zb3VyY2VtYXAoZmlsZW5hbWUsIHN2ZWx0ZV9tYXAsIHByZXByb2Nlc3Nvcl9tYXBfaW5wdXQpIHtcbiAgICBpZiAoIXN2ZWx0ZV9tYXAgfHwgIXByZXByb2Nlc3Nvcl9tYXBfaW5wdXQpXG4gICAgICAgIHJldHVybiBzdmVsdGVfbWFwO1xuICAgIGNvbnN0IHByZXByb2Nlc3Nvcl9tYXAgPSB0eXBlb2YgcHJlcHJvY2Vzc29yX21hcF9pbnB1dCA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKHByZXByb2Nlc3Nvcl9tYXBfaW5wdXQpIDogcHJlcHJvY2Vzc29yX21hcF9pbnB1dDtcbiAgICBjb25zdCByZXN1bHRfbWFwID0gY29tYmluZV9zb3VyY2VtYXBzKGZpbGVuYW1lLCBbXG4gICAgICAgIHN2ZWx0ZV9tYXAsXG4gICAgICAgIHByZXByb2Nlc3Nvcl9tYXBcbiAgICBdKTtcbiAgICAvLyBTdmVsdGUgZXhwZWN0cyBhIFNvdXJjZU1hcCB3aGljaCBpbmNsdWRlcyB0b1VybCBhbmQgdG9TdHJpbmcuIEluc3RlYWQgb2Ygd3JhcHBpbmcgb3VyIG91dHB1dCBpbiBhIGNsYXNzLFxuICAgIC8vIHdlIGp1c3QgdGFjayBvbiB0aGUgZXh0cmEgcHJvcGVydGllcy5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhyZXN1bHRfbWFwLCB7XG4gICAgICAgIHRvU3RyaW5nOiB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRvVXJsOiB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b1VybCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2RhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCwnICsgYjY0ZW5jKHRoaXMudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0X21hcDtcbn1cbmNvbnN0IHJlZ2V4X2RhdGFfdXJpID0gL2RhdGE6KD86YXBwbGljYXRpb258dGV4dClcXC9qc29uOyg/OmNoYXJzZXRbOj1dXFxTKz87KT9iYXNlNjQsKFxcUyopLztcbi8vIHBhcnNlIGF0dGFjaGVkIHNvdXJjZW1hcCBpbiBwcm9jZXNzZWQuY29kZVxuZnVuY3Rpb24gcGFyc2VfYXR0YWNoZWRfc291cmNlbWFwKHByb2Nlc3NlZCwgdGFnX25hbWUpIHtcbiAgICBjb25zdCByX2luID0gJ1sjQF1cXFxccypzb3VyY2VNYXBwaW5nVVJMXFxcXHMqPVxcXFxzKihcXFxcUyopJztcbiAgICBjb25zdCByZWdleCA9ICh0YWdfbmFtZSA9PSAnc2NyaXB0JylcbiAgICAgICAgPyBuZXcgUmVnRXhwKCcoPzovLycgKyByX2luICsgJyl8KD86L1xcXFwqJyArIHJfaW4gKyAnXFxcXHMqXFxcXCovKSQnKVxuICAgICAgICA6IG5ldyBSZWdFeHAoJy9cXFxcKicgKyByX2luICsgJ1xcXFxzKlxcXFwqLyQnKTtcbiAgICBmdW5jdGlvbiBsb2dfd2FybmluZyhtZXNzYWdlKSB7XG4gICAgICAgIC8vIGNvZGVfc3RhcnQ6IGhlbHAgdG8gZmluZCBwcmVwcm9jZXNzb3JcbiAgICAgICAgY29uc3QgY29kZV9zdGFydCA9IHByb2Nlc3NlZC5jb2RlLmxlbmd0aCA8IDEwMCA/IHByb2Nlc3NlZC5jb2RlIDogKHByb2Nlc3NlZC5jb2RlLnNsaWNlKDAsIDEwMCkgKyAnIFsuLi5dJyk7XG4gICAgICAgIGNvbnNvbGUud2Fybihgd2FybmluZzogJHttZXNzYWdlfS4gcHJvY2Vzc2VkLmNvZGUgPSAke0pTT04uc3RyaW5naWZ5KGNvZGVfc3RhcnQpfWApO1xuICAgIH1cbiAgICBwcm9jZXNzZWQuY29kZSA9IHByb2Nlc3NlZC5jb2RlLnJlcGxhY2UocmVnZXgsIChfLCBtYXRjaDEsIG1hdGNoMikgPT4ge1xuICAgICAgICBjb25zdCBtYXBfdXJsID0gKHRhZ19uYW1lID09ICdzY3JpcHQnKSA/IChtYXRjaDEgfHwgbWF0Y2gyKSA6IG1hdGNoMTtcbiAgICAgICAgY29uc3QgbWFwX2RhdGEgPSAobWFwX3VybC5tYXRjaChyZWdleF9kYXRhX3VyaSkgfHwgW10pWzFdO1xuICAgICAgICBpZiAobWFwX2RhdGEpIHtcbiAgICAgICAgICAgIC8vIHNvdXJjZU1hcHBpbmdVUkwgaXMgZGF0YSBVUkxcbiAgICAgICAgICAgIGlmIChwcm9jZXNzZWQubWFwKSB7XG4gICAgICAgICAgICAgICAgbG9nX3dhcm5pbmcoJ05vdCBpbXBsZW1lbnRlZC4gJyArXG4gICAgICAgICAgICAgICAgICAgICdGb3VuZCBzb3VyY2VtYXAgaW4gYm90aCBwcm9jZXNzZWQuY29kZSBhbmQgcHJvY2Vzc2VkLm1hcC4gJyArXG4gICAgICAgICAgICAgICAgICAgICdQbGVhc2UgdXBkYXRlIHlvdXIgcHJlcHJvY2Vzc29yIHRvIHJldHVybiBvbmx5IG9uZSBzb3VyY2VtYXAuJyk7XG4gICAgICAgICAgICAgICAgLy8gaWdub3JlIGF0dGFjaGVkIHNvdXJjZW1hcFxuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByb2Nlc3NlZC5tYXAgPSBiNjRkZWMobWFwX2RhdGEpOyAvLyB1c2UgYXR0YWNoZWQgc291cmNlbWFwXG4gICAgICAgICAgICByZXR1cm4gJyc7IC8vIHJlbW92ZSBmcm9tIHByb2Nlc3NlZC5jb2RlXG4gICAgICAgIH1cbiAgICAgICAgLy8gc291cmNlTWFwcGluZ1VSTCBpcyBwYXRoIG9yIFVSTFxuICAgICAgICBpZiAoIXByb2Nlc3NlZC5tYXApIHtcbiAgICAgICAgICAgIGxvZ193YXJuaW5nKGBGb3VuZCBzb3VyY2VtYXAgcGF0aCAke0pTT04uc3RyaW5naWZ5KG1hcF91cmwpfSBpbiBwcm9jZXNzZWQuY29kZSwgYnV0IG5vIHNvdXJjZW1hcCBkYXRhLiBgICtcbiAgICAgICAgICAgICAgICAnUGxlYXNlIHVwZGF0ZSB5b3VyIHByZXByb2Nlc3NvciB0byByZXR1cm4gc291cmNlbWFwIGRhdGEgZGlyZWN0bHkuJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWdub3JlIHNvdXJjZW1hcCBwYXRoXG4gICAgICAgIHJldHVybiAnJzsgLy8gcmVtb3ZlIGZyb20gcHJvY2Vzc2VkLmNvZGVcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY2hlY2tfZW5hYmxlX3NvdXJjZW1hcChlbmFibGVfc291cmNlbWFwLCBuYW1lc3BhY2UpIHtcbiAgICByZXR1cm4gdHlwZW9mIGVuYWJsZV9zb3VyY2VtYXAgPT09ICdib29sZWFuJ1xuICAgICAgICA/IGVuYWJsZV9zb3VyY2VtYXBcbiAgICAgICAgOiBlbmFibGVfc291cmNlbWFwW25hbWVzcGFjZV07XG59XG5cbmZ1bmN0aW9uIGRvbShjb21wb25lbnQsIG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IG5hbWUgfSA9IGNvbXBvbmVudDtcbiAgICBjb25zdCByZW5kZXJlciA9IG5ldyBSZW5kZXJlcihjb21wb25lbnQsIG9wdGlvbnMpO1xuICAgIGNvbnN0IHsgYmxvY2sgfSA9IHJlbmRlcmVyO1xuICAgIGJsb2NrLmhhc19vdXRyb19tZXRob2QgPSB0cnVlO1xuICAgIC8vIHByZXZlbnQgZnJhZ21lbnQgYmVpbmcgY3JlYXRlZCB0d2ljZSAoIzEwNjMpXG4gICAgaWYgKG9wdGlvbnMuY3VzdG9tRWxlbWVudClcbiAgICAgICAgYmxvY2suY2h1bmtzLmNyZWF0ZS5wdXNoKGIgYHRoaXMuYyA9IEBub29wO2ApO1xuICAgIGNvbnN0IGJvZHkgPSBbXTtcbiAgICBpZiAocmVuZGVyZXIuZmlsZV92YXIpIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IGNvbXBvbmVudC5maWxlID8geCBgXCIke2NvbXBvbmVudC5maWxlfVwiYCA6IHggYHVuZGVmaW5lZGA7XG4gICAgICAgIGJvZHkucHVzaChiIGBjb25zdCAke3JlbmRlcmVyLmZpbGVfdmFyfSA9ICR7ZmlsZX07YCk7XG4gICAgfVxuICAgIGNvbnN0IGNzcyA9IGNvbXBvbmVudC5zdHlsZXNoZWV0LnJlbmRlcihvcHRpb25zLmZpbGVuYW1lLCAhb3B0aW9ucy5jdXN0b21FbGVtZW50KTtcbiAgICBjb25zdCBjc3Nfc291cmNlbWFwX2VuYWJsZWQgPSBjaGVja19lbmFibGVfc291cmNlbWFwKG9wdGlvbnMuZW5hYmxlU291cmNlbWFwLCAnY3NzJyk7XG4gICAgaWYgKGNzc19zb3VyY2VtYXBfZW5hYmxlZCkge1xuICAgICAgICBjc3MubWFwID0gYXBwbHlfcHJlcHJvY2Vzc29yX3NvdXJjZW1hcChvcHRpb25zLmZpbGVuYW1lLCBjc3MubWFwLCBvcHRpb25zLnNvdXJjZW1hcCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjc3MubWFwID0gbnVsbDtcbiAgICB9XG4gICAgY29uc3Qgc3R5bGVzID0gY3NzX3NvdXJjZW1hcF9lbmFibGVkICYmIGNvbXBvbmVudC5zdHlsZXNoZWV0Lmhhc19zdHlsZXMgJiYgb3B0aW9ucy5kZXZcbiAgICAgICAgPyBgJHtjc3MuY29kZX1cXG4vKiMgc291cmNlTWFwcGluZ1VSTD0ke2Nzcy5tYXAudG9VcmwoKX0gKi9gXG4gICAgICAgIDogY3NzLmNvZGU7XG4gICAgY29uc3QgYWRkX2NzcyA9IGNvbXBvbmVudC5nZXRfdW5pcXVlX25hbWUoJ2FkZF9jc3MnKTtcbiAgICBjb25zdCBzaG91bGRfYWRkX2NzcyA9ICghb3B0aW9ucy5jdXN0b21FbGVtZW50ICYmXG4gICAgICAgICEhc3R5bGVzICYmXG4gICAgICAgIG9wdGlvbnMuY3NzICE9PSBmYWxzZSk7XG4gICAgaWYgKHNob3VsZF9hZGRfY3NzKSB7XG4gICAgICAgIGJvZHkucHVzaChiIGBcblx0XHRcdGZ1bmN0aW9uICR7YWRkX2Nzc30odGFyZ2V0KSB7XG5cdFx0XHRcdEBhcHBlbmRfc3R5bGVzKHRhcmdldCwgXCIke2NvbXBvbmVudC5zdHlsZXNoZWV0LmlkfVwiLCBcIiR7c3R5bGVzfVwiKTtcblx0XHRcdH1cblx0XHRgKTtcbiAgICB9XG4gICAgLy8gZml4IG9yZGVyXG4gICAgLy8gVE9ETyB0aGUgZGVjb25mbGljdGVkIG5hbWVzIG9mIGJsb2NrcyBhcmUgcmV2ZXJzZWQuLi4gc2hvdWxkIHNldCB0aGVtIGhlcmVcbiAgICBjb25zdCBibG9ja3MgPSByZW5kZXJlci5ibG9ja3Muc2xpY2UoKS5yZXZlcnNlKCk7XG4gICAgcHVzaF9hcnJheSQxKGJvZHksIGJsb2Nrcy5tYXAoYmxvY2sgPT4ge1xuICAgICAgICAvLyBUT0RPIHRoaXMgaXMgYSBob3JyaWJsZSBtZXNzIOKAlCByZW5kZXJlci5ibG9ja3NcbiAgICAgICAgLy8gY29udGFpbnMgYSBtaXh0dXJlIG9mIEJsb2NrcyBhbmQgTm9kZXNcbiAgICAgICAgaWYgKGJsb2NrLnJlbmRlcilcbiAgICAgICAgICAgIHJldHVybiBibG9jay5yZW5kZXIoKTtcbiAgICAgICAgcmV0dXJuIGJsb2NrO1xuICAgIH0pKTtcbiAgICBpZiAob3B0aW9ucy5kZXYgJiYgIW9wdGlvbnMuaHlkcmF0YWJsZSkge1xuICAgICAgICBibG9jay5jaHVua3MuY2xhaW0ucHVzaChiIGB0aHJvdyBuZXcgQF9FcnJvcihcIm9wdGlvbnMuaHlkcmF0ZSBvbmx5IHdvcmtzIGlmIHRoZSBjb21wb25lbnQgd2FzIGNvbXBpbGVkIHdpdGggdGhlIFxcYGh5ZHJhdGFibGU6IHRydWVcXGAgb3B0aW9uXCIpO2ApO1xuICAgIH1cbiAgICBjb25zdCB1c2VzX3Nsb3RzID0gY29tcG9uZW50LnZhcl9sb29rdXAuaGFzKCckJHNsb3RzJyk7XG4gICAgbGV0IGNvbXB1dGVfc2xvdHM7XG4gICAgaWYgKHVzZXNfc2xvdHMpIHtcbiAgICAgICAgY29tcHV0ZV9zbG90cyA9IGIgYFxuXHRcdFx0Y29uc3QgJCRzbG90cyA9IEBjb21wdXRlX3Nsb3RzKCNzbG90cyk7XG5cdFx0YDtcbiAgICB9XG4gICAgY29uc3QgdXNlc19wcm9wcyA9IGNvbXBvbmVudC52YXJfbG9va3VwLmhhcygnJCRwcm9wcycpO1xuICAgIGNvbnN0IHVzZXNfcmVzdCA9IGNvbXBvbmVudC52YXJfbG9va3VwLmhhcygnJCRyZXN0UHJvcHMnKTtcbiAgICBjb25zdCAkJHByb3BzID0gdXNlc19wcm9wcyB8fCB1c2VzX3Jlc3QgPyAnJCRuZXdfcHJvcHMnIDogJyQkcHJvcHMnO1xuICAgIGNvbnN0IHByb3BzID0gY29tcG9uZW50LnZhcnMuZmlsdGVyKHZhcmlhYmxlID0+ICF2YXJpYWJsZS5tb2R1bGUgJiYgdmFyaWFibGUuZXhwb3J0X25hbWUpO1xuICAgIGNvbnN0IHdyaXRhYmxlX3Byb3BzID0gcHJvcHMuZmlsdGVyKHZhcmlhYmxlID0+IHZhcmlhYmxlLndyaXRhYmxlKTtcbiAgICBjb25zdCBvbWl0X3Byb3BzX25hbWVzID0gY29tcG9uZW50LmdldF91bmlxdWVfbmFtZSgnb21pdF9wcm9wc19uYW1lcycpO1xuICAgIGNvbnN0IGNvbXB1dGVfcmVzdCA9IHggYEBjb21wdXRlX3Jlc3RfcHJvcHMoJCRwcm9wcywgJHtvbWl0X3Byb3BzX25hbWVzLm5hbWV9KWA7XG4gICAgY29uc3QgcmVzdCA9IHVzZXNfcmVzdCA/IGIgYFxuXHRcdGNvbnN0ICR7b21pdF9wcm9wc19uYW1lcy5uYW1lfSA9IFske3Byb3BzLm1hcChwcm9wID0+IGBcIiR7cHJvcC5leHBvcnRfbmFtZX1cImApLmpvaW4oJywnKX1dO1xuXHRcdGxldCAkJHJlc3RQcm9wcyA9ICR7Y29tcHV0ZV9yZXN0fTtcblx0YCA6IG51bGw7XG4gICAgY29uc3Qgc2V0ID0gKHVzZXNfcHJvcHMgfHwgdXNlc19yZXN0IHx8IHdyaXRhYmxlX3Byb3BzLmxlbmd0aCA+IDAgfHwgY29tcG9uZW50LnNsb3RzLnNpemUgPiAwKVxuICAgICAgICA/IHggYFxuXHRcdFx0JHskJHByb3BzfSA9PiB7XG5cdFx0XHRcdCR7dXNlc19wcm9wcyAmJiByZW5kZXJlci5pbnZhbGlkYXRlKCckJHByb3BzJywgeCBgJCRwcm9wcyA9IEBhc3NpZ24oQGFzc2lnbih7fSwgJCRwcm9wcyksIEBleGNsdWRlX2ludGVybmFsX3Byb3BzKCQkbmV3X3Byb3BzKSlgKX1cblx0XHRcdFx0JHt1c2VzX3Jlc3QgJiYgIXVzZXNfcHJvcHMgJiYgeCBgJCRwcm9wcyA9IEBhc3NpZ24oQGFzc2lnbih7fSwgJCRwcm9wcyksIEBleGNsdWRlX2ludGVybmFsX3Byb3BzKCQkbmV3X3Byb3BzKSlgfVxuXHRcdFx0XHQke3VzZXNfcmVzdCAmJiByZW5kZXJlci5pbnZhbGlkYXRlKCckJHJlc3RQcm9wcycsIHggYCQkcmVzdFByb3BzID0gJHtjb21wdXRlX3Jlc3R9YCl9XG5cdFx0XHRcdCR7d3JpdGFibGVfcHJvcHMubWFwKHByb3AgPT4gYiBgaWYgKCcke3Byb3AuZXhwb3J0X25hbWV9JyBpbiAkeyQkcHJvcHN9KSAke3JlbmRlcmVyLmludmFsaWRhdGUocHJvcC5uYW1lLCB4IGAke3Byb3AubmFtZX0gPSAkeyQkcHJvcHN9LiR7cHJvcC5leHBvcnRfbmFtZX1gKX07YCl9XG5cdFx0XHRcdCR7Y29tcG9uZW50LnNsb3RzLnNpemUgPiAwICYmXG4gICAgICAgICAgICBiIGBpZiAoJyQkc2NvcGUnIGluICR7JCRwcm9wc30pICR7cmVuZGVyZXIuaW52YWxpZGF0ZSgnJCRzY29wZScsIHggYCQkc2NvcGUgPSAkeyQkcHJvcHN9LiQkc2NvcGVgKX07YH1cblx0XHRcdH1cblx0XHRgXG4gICAgICAgIDogbnVsbDtcbiAgICBjb25zdCBhY2Nlc3NvcnMgPSBbXTtcbiAgICBjb25zdCBub3RfZXF1YWwgPSBjb21wb25lbnQuY29tcG9uZW50X29wdGlvbnMuaW1tdXRhYmxlID8geCBgQG5vdF9lcXVhbGAgOiB4IGBAc2FmZV9ub3RfZXF1YWxgO1xuICAgIGxldCBtaXNzaW5nX3Byb3BzX2NoZWNrO1xuICAgIGxldCBpbmplY3Rfc3RhdGU7XG4gICAgbGV0IGNhcHR1cmVfc3RhdGU7XG4gICAgbGV0IHByb3BzX2luamVjdDtcbiAgICBwcm9wcy5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgICBjb25zdCB2YXJpYWJsZSA9IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChwcm9wLm5hbWUpO1xuICAgICAgICBpZiAoIXZhcmlhYmxlLndyaXRhYmxlIHx8IGNvbXBvbmVudC5jb21wb25lbnRfb3B0aW9ucy5hY2Nlc3NvcnMpIHtcbiAgICAgICAgICAgIGFjY2Vzc29ycy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnTWV0aG9kRGVmaW5pdGlvbicsXG4gICAgICAgICAgICAgICAga2luZDogJ2dldCcsXG4gICAgICAgICAgICAgICAga2V5OiB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogcHJvcC5leHBvcnRfbmFtZSB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB4IGBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gJHtwcm9wLmhvaXN0YWJsZSA/IHByb3AubmFtZSA6IHggYHRoaXMuJCQuY3R4WyR7cmVuZGVyZXIuY29udGV4dF9sb29rdXAuZ2V0KHByb3AubmFtZSkuaW5kZXh9XWB9XG5cdFx0XHRcdH1gXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldikge1xuICAgICAgICAgICAgYWNjZXNzb3JzLnB1c2goe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdNZXRob2REZWZpbml0aW9uJyxcbiAgICAgICAgICAgICAgICBraW5kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICBrZXk6IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiBwcm9wLmV4cG9ydF9uYW1lIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHggYGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHRocm93IG5ldyBAX0Vycm9yKFwiPCR7Y29tcG9uZW50LnRhZ30+OiBQcm9wcyBjYW5ub3QgYmUgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBjb21wb25lbnQgaW5zdGFuY2UgdW5sZXNzIGNvbXBpbGluZyB3aXRoICdhY2Nlc3NvcnM6IHRydWUnIG9yICc8c3ZlbHRlOm9wdGlvbnMgYWNjZXNzb3JzLz4nXCIpO1xuXHRcdFx0XHR9YFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbXBvbmVudC5jb21wb25lbnRfb3B0aW9ucy5hY2Nlc3NvcnMpIHtcbiAgICAgICAgICAgIGlmICh2YXJpYWJsZS53cml0YWJsZSAmJiAhcmVuZGVyZXIucmVhZG9ubHkuaGFzKHByb3AubmFtZSkpIHtcbiAgICAgICAgICAgICAgICBhY2Nlc3NvcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdNZXRob2REZWZpbml0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAga2luZDogJ3NldCcsXG4gICAgICAgICAgICAgICAgICAgIGtleTogeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6IHByb3AuZXhwb3J0X25hbWUgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHggYGZ1bmN0aW9uKCR7cHJvcC5uYW1lfSkge1xuXHRcdFx0XHRcdFx0dGhpcy4kJHNldCh7ICR7cHJvcC5leHBvcnRfbmFtZX06ICR7cHJvcC5uYW1lfSB9KTtcblx0XHRcdFx0XHRcdEBmbHVzaCgpO1xuXHRcdFx0XHRcdH1gXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldikge1xuICAgICAgICAgICAgICAgIGFjY2Vzc29ycy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ01ldGhvZERlZmluaXRpb24nLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiAnc2V0JyxcbiAgICAgICAgICAgICAgICAgICAga2V5OiB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogcHJvcC5leHBvcnRfbmFtZSB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogeCBgZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBAX0Vycm9yKFwiPCR7Y29tcG9uZW50LnRhZ30+OiBDYW5ub3Qgc2V0IHJlYWQtb25seSBwcm9wZXJ0eSAnJHtwcm9wLmV4cG9ydF9uYW1lfSdcIik7XG5cdFx0XHRcdFx0fWBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldikge1xuICAgICAgICAgICAgYWNjZXNzb3JzLnB1c2goe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdNZXRob2REZWZpbml0aW9uJyxcbiAgICAgICAgICAgICAgICBraW5kOiAnc2V0JyxcbiAgICAgICAgICAgICAgICBrZXk6IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiBwcm9wLmV4cG9ydF9uYW1lIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHggYGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IEBfRXJyb3IoXCI8JHtjb21wb25lbnQudGFnfT46IFByb3BzIGNhbm5vdCBiZSBzZXQgZGlyZWN0bHkgb24gdGhlIGNvbXBvbmVudCBpbnN0YW5jZSB1bmxlc3MgY29tcGlsaW5nIHdpdGggJ2FjY2Vzc29yczogdHJ1ZScgb3IgJzxzdmVsdGU6b3B0aW9ucyBhY2Nlc3NvcnMvPidcIik7XG5cdFx0XHRcdH1gXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGNvbXBvbmVudC5pbnN0YW5jZV9leHBvcnRzX2Zyb20uZm9yRWFjaChleHBvcnRzX2Zyb20gPT4ge1xuICAgICAgICBjb25zdCBpbXBvcnRfZGVjbGFyYXRpb24gPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGV4cG9ydHNfZnJvbSksIHsgdHlwZTogJ0ltcG9ydERlY2xhcmF0aW9uJywgc3BlY2lmaWVyczogW10sIHNvdXJjZTogZXhwb3J0c19mcm9tLnNvdXJjZSB9KTtcbiAgICAgICAgY29tcG9uZW50LmltcG9ydHMucHVzaChpbXBvcnRfZGVjbGFyYXRpb24pO1xuICAgICAgICBleHBvcnRzX2Zyb20uc3BlY2lmaWVycy5mb3JFYWNoKHNwZWNpZmllciA9PiB7XG4gICAgICAgICAgICBpZiAoY29tcG9uZW50LmNvbXBvbmVudF9vcHRpb25zLmFjY2Vzc29ycykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBjb21wb25lbnQuZ2V0X3VuaXF1ZV9uYW1lKHNwZWNpZmllci5leHBvcnRlZC5uYW1lKTtcbiAgICAgICAgICAgICAgICBpbXBvcnRfZGVjbGFyYXRpb24uc3BlY2lmaWVycy5wdXNoKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgc3BlY2lmaWVyKSwgeyB0eXBlOiAnSW1wb3J0U3BlY2lmaWVyJywgaW1wb3J0ZWQ6IHNwZWNpZmllci5sb2NhbCwgbG9jYWw6IG5hbWUgfSkpO1xuICAgICAgICAgICAgICAgIGFjY2Vzc29ycy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ01ldGhvZERlZmluaXRpb24nLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAga2V5OiB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogc3BlY2lmaWVyLmV4cG9ydGVkLm5hbWUgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHggYGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuICR7bmFtZX1cblx0XHRcdFx0XHR9YFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5kZXYpIHtcbiAgICAgICAgICAgICAgICBhY2Nlc3NvcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdNZXRob2REZWZpbml0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAga2luZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIGtleTogeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6IHNwZWNpZmllci5leHBvcnRlZC5uYW1lIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB4IGBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBAX0Vycm9yKFwiPCR7Y29tcG9uZW50LnRhZ30+OiBQcm9wcyBjYW5ub3QgYmUgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBjb21wb25lbnQgaW5zdGFuY2UgdW5sZXNzIGNvbXBpbGluZyB3aXRoICdhY2Nlc3NvcnM6IHRydWUnIG9yICc8c3ZlbHRlOm9wdGlvbnMgYWNjZXNzb3JzLz4nXCIpO1xuXHRcdFx0XHRcdH1gXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIGlmIChjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldikge1xuICAgICAgICAvLyBjaGVja2luZyB0aGF0IGV4cGVjdGVkIG9uZXMgd2VyZSBwYXNzZWRcbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBwcm9wcy5maWx0ZXIocHJvcCA9PiBwcm9wLndyaXRhYmxlICYmICFwcm9wLmluaXRpYWxpc2VkKTtcbiAgICAgICAgaWYgKGV4cGVjdGVkLmxlbmd0aCkge1xuICAgICAgICAgICAgbWlzc2luZ19wcm9wc19jaGVjayA9IGIgYFxuXHRcdFx0XHQkJHNlbGYuJCQub25fbW91bnQucHVzaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0JHtleHBlY3RlZC5tYXAocHJvcCA9PiBiIGBcblx0XHRcdFx0XHRpZiAoJHtwcm9wLm5hbWV9ID09PSB1bmRlZmluZWQgJiYgISgoJyR7cHJvcC5leHBvcnRfbmFtZX0nIGluICQkcHJvcHMpIHx8ICQkc2VsZi4kJC5ib3VuZFskJHNlbGYuJCQucHJvcHNbJyR7cHJvcC5leHBvcnRfbmFtZX0nXV0pKSB7XG5cdFx0XHRcdFx0XHRAX2NvbnNvbGUud2FybihcIjwke2NvbXBvbmVudC50YWd9PiB3YXMgY3JlYXRlZCB3aXRob3V0IGV4cGVjdGVkIHByb3AgJyR7cHJvcC5leHBvcnRfbmFtZX0nXCIpO1xuXHRcdFx0XHRcdH1gKX1cblx0XHRcdFx0fSk7XG5cdFx0XHRgO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNhcHR1cmFibGVfdmFycyA9IGNvbXBvbmVudC52YXJzLmZpbHRlcih2ID0+ICF2LmludGVybmFsICYmICF2Lmdsb2JhbCAmJiAhdi5uYW1lLnN0YXJ0c1dpdGgoJyQkJykpO1xuICAgICAgICBpZiAoY2FwdHVyYWJsZV92YXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNhcHR1cmVfc3RhdGUgPSB4IGAoKSA9PiAoeyAke2NhcHR1cmFibGVfdmFycy5tYXAocHJvcCA9PiBwIGAke3Byb3AubmFtZX1gKX0gfSlgO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGluamVjdGFibGVfdmFycyA9IGNhcHR1cmFibGVfdmFycy5maWx0ZXIodiA9PiAhdi5tb2R1bGUgJiYgdi53cml0YWJsZSAmJiB2Lm5hbWVbMF0gIT09ICckJyk7XG4gICAgICAgIGlmICh1c2VzX3Byb3BzIHx8IGluamVjdGFibGVfdmFycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBpbmplY3Rfc3RhdGUgPSB4IGBcblx0XHRcdFx0JHskJHByb3BzfSA9PiB7XG5cdFx0XHRcdFx0JHt1c2VzX3Byb3BzICYmIHJlbmRlcmVyLmludmFsaWRhdGUoJyQkcHJvcHMnLCB4IGAkJHByb3BzID0gQGFzc2lnbihAYXNzaWduKHt9LCAkJHByb3BzKSwgJCRuZXdfcHJvcHMpYCl9XG5cdFx0XHRcdFx0JHtpbmplY3RhYmxlX3ZhcnMubWFwKHYgPT4gYiBgaWYgKCcke3YubmFtZX0nIGluICQkcHJvcHMpICR7cmVuZGVyZXIuaW52YWxpZGF0ZSh2Lm5hbWUsIHggYCR7di5uYW1lfSA9ICR7JCRwcm9wc30uJHt2Lm5hbWV9YCl9O2ApfVxuXHRcdFx0XHR9XG5cdFx0XHRgO1xuICAgICAgICAgICAgcHJvcHNfaW5qZWN0ID0gYiBgXG5cdFx0XHRcdGlmICgkJHByb3BzICYmIFwiJCRpbmplY3RcIiBpbiAkJHByb3BzKSB7XG5cdFx0XHRcdFx0JCRzZWxmLiRpbmplY3Rfc3RhdGUoJCRwcm9wcy4kJGluamVjdCk7XG5cdFx0XHRcdH1cblx0XHRcdGA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gaW5zdHJ1bWVudCBhc3NpZ25tZW50c1xuICAgIGlmIChjb21wb25lbnQuYXN0Lmluc3RhbmNlKSB7XG4gICAgICAgIGxldCBzY29wZSA9IGNvbXBvbmVudC5pbnN0YW5jZV9zY29wZTtcbiAgICAgICAgY29uc3QgbWFwID0gY29tcG9uZW50Lmluc3RhbmNlX3Njb3BlX21hcDtcbiAgICAgICAgbGV0IGV4ZWN1dGlvbl9jb250ZXh0ID0gbnVsbDtcbiAgICAgICAgd2Fsayhjb21wb25lbnQuYXN0Lmluc3RhbmNlLmNvbnRlbnQsIHtcbiAgICAgICAgICAgIGVudGVyKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZiAobWFwLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZSA9IG1hcC5nZXQobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZXhlY3V0aW9uX2NvbnRleHQgJiYgIXNjb3BlLmJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGVjdXRpb25fY29udGV4dCA9IG5vZGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoIWV4ZWN1dGlvbl9jb250ZXh0ICYmIG5vZGUudHlwZSA9PT0gJ0xhYmVsZWRTdGF0ZW1lbnQnICYmIG5vZGUubGFiZWwubmFtZSA9PT0gJyQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4ZWN1dGlvbl9jb250ZXh0ID0gbm9kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGVhdmUobm9kZSkge1xuICAgICAgICAgICAgICAgIGlmIChtYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlID0gc2NvcGUucGFyZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZXhlY3V0aW9uX2NvbnRleHQgPT09IG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZXhlY3V0aW9uX2NvbnRleHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnQXNzaWdubWVudEV4cHJlc3Npb24nIHx8IG5vZGUudHlwZSA9PT0gJ1VwZGF0ZUV4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFzc2lnbmVlID0gbm9kZS50eXBlID09PSAnQXNzaWdubWVudEV4cHJlc3Npb24nID8gbm9kZS5sZWZ0IDogbm9kZS5hcmd1bWVudDtcbiAgICAgICAgICAgICAgICAgICAgLy8gbm9ybWFsbHkgKGBhID0gMWAsIGBiLmMgPSAyYCksIHRoZXJlJ2xsIGJlIGEgc2luZ2xlIG5hbWVcbiAgICAgICAgICAgICAgICAgICAgLy8gKGEgb3IgYikuIEluIGRlc3RydWN0dXJpbmcgY2FzZXMgKGBbZCwgZV0gPSBbZSwgZF1gKSB0aGVyZVxuICAgICAgICAgICAgICAgICAgICAvLyBtYXkgYmUgbW9yZSwgaW4gd2hpY2ggY2FzZSB3ZSBuZWVkIHRvIHRhY2sgdGhlIGV4dHJhIG9uZXNcbiAgICAgICAgICAgICAgICAgICAgLy8gb250byB0aGUgaW5pdGlhbCBmdW5jdGlvbiBjYWxsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVzID0gbmV3IFNldChleHRyYWN0X25hbWVzKGFzc2lnbmVlKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZShpbnZhbGlkYXRlKHJlbmRlcmVyLCBzY29wZSwgbm9kZSwgbmFtZXMsIGV4ZWN1dGlvbl9jb250ZXh0ID09PSBudWxsKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29tcG9uZW50LnJld3JpdGVfcHJvcHMoKHsgbmFtZSwgcmVhc3NpZ25lZCwgZXhwb3J0X25hbWUgfSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBgJCR7bmFtZX1gO1xuICAgICAgICAgICAgY29uc3QgaSA9IHJlbmRlcmVyLmNvbnRleHRfbG9va3VwLmdldChgJCR7bmFtZX1gKS5pbmRleDtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydCA9IChyZWFzc2lnbmVkIHx8IGV4cG9ydF9uYW1lKVxuICAgICAgICAgICAgICAgID8gYiBgJHtgJCRzdWJzY3JpYmVfJHtuYW1lfWB9KClgXG4gICAgICAgICAgICAgICAgOiBiIGBAY29tcG9uZW50X3N1YnNjcmliZSgkJHNlbGYsICR7bmFtZX0sICN2YWx1ZSA9PiAkJGludmFsaWRhdGUoJHtpfSwgJHt2YWx1ZX0gPSAjdmFsdWUpKWA7XG4gICAgICAgICAgICBpZiAoY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5kZXYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYiBgQHZhbGlkYXRlX3N0b3JlKCR7bmFtZX0sICcke25hbWV9Jyk7ICR7aW5zZXJ0fWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaW5zZXJ0O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYXJncyA9IFt4IGAkJHNlbGZgXTtcbiAgICBjb25zdCBoYXNfaW52YWxpZGF0ZSA9IHByb3BzLmxlbmd0aCA+IDAgfHxcbiAgICAgICAgY29tcG9uZW50Lmhhc19yZWFjdGl2ZV9hc3NpZ25tZW50cyB8fFxuICAgICAgICBjb21wb25lbnQuc2xvdHMuc2l6ZSA+IDAgfHxcbiAgICAgICAgY2FwdHVyZV9zdGF0ZSB8fFxuICAgICAgICBpbmplY3Rfc3RhdGU7XG4gICAgaWYgKGhhc19pbnZhbGlkYXRlKSB7XG4gICAgICAgIGFyZ3MucHVzaCh4IGAkJHByb3BzYCwgeCBgJCRpbnZhbGlkYXRlYCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNvbXBvbmVudC5jb21waWxlX29wdGlvbnMuZGV2KSB7XG4gICAgICAgIC8vICQkcHJvcHMgYXJnIGlzIHN0aWxsIG5lZWRlZCBmb3IgdW5rbm93biBwcm9wIGNoZWNrXG4gICAgICAgIGFyZ3MucHVzaCh4IGAkJHByb3BzYCk7XG4gICAgfVxuICAgIC8vIGhhc19jcmVhdGVfZnJhZ21lbnQgaXMgaW50ZW50aW9uYWxseSB0byBiZSB0cnVlIGluIGRldiBtb2RlLlxuICAgIGNvbnN0IGhhc19jcmVhdGVfZnJhZ21lbnQgPSBjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldiB8fCBibG9jay5oYXNfY29udGVudCgpO1xuICAgIGlmIChoYXNfY3JlYXRlX2ZyYWdtZW50KSB7XG4gICAgICAgIGJvZHkucHVzaChiIGBcblx0XHRcdGZ1bmN0aW9uIGNyZWF0ZV9mcmFnbWVudCgjY3R4KSB7XG5cdFx0XHRcdCR7YmxvY2suZ2V0X2NvbnRlbnRzKCl9XG5cdFx0XHR9XG5cdFx0YCk7XG4gICAgfVxuICAgIGJvZHkucHVzaChiIGBcblx0XHQke2NvbXBvbmVudC5leHRyYWN0X2phdmFzY3JpcHQoY29tcG9uZW50LmFzdC5tb2R1bGUpfVxuXG5cdFx0JHtjb21wb25lbnQuZnVsbHlfaG9pc3RlZH1cblx0YCk7XG4gICAgY29uc3QgZmlsdGVyZWRfcHJvcHMgPSBwcm9wcy5maWx0ZXIocHJvcCA9PiB7XG4gICAgICAgIGNvbnN0IHZhcmlhYmxlID0gY29tcG9uZW50LnZhcl9sb29rdXAuZ2V0KHByb3AubmFtZSk7XG4gICAgICAgIGlmICh2YXJpYWJsZS5ob2lzdGFibGUpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiBwcm9wLm5hbWVbMF0gIT09ICckJztcbiAgICB9KTtcbiAgICBjb25zdCByZWFjdGl2ZV9zdG9yZXMgPSBjb21wb25lbnQudmFycy5maWx0ZXIodmFyaWFibGUgPT4gdmFyaWFibGUubmFtZVswXSA9PT0gJyQnICYmIHZhcmlhYmxlLm5hbWVbMV0gIT09ICckJyk7XG4gICAgY29uc3QgaW5zdGFuY2VfamF2YXNjcmlwdCA9IGNvbXBvbmVudC5leHRyYWN0X2phdmFzY3JpcHQoY29tcG9uZW50LmFzdC5pbnN0YW5jZSk7XG4gICAgY29uc3QgaGFzX2RlZmluaXRpb24gPSAoY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5kZXYgfHxcbiAgICAgICAgKGluc3RhbmNlX2phdmFzY3JpcHQgJiYgaW5zdGFuY2VfamF2YXNjcmlwdC5sZW5ndGggPiAwKSB8fFxuICAgICAgICBmaWx0ZXJlZF9wcm9wcy5sZW5ndGggPiAwIHx8XG4gICAgICAgIHVzZXNfcHJvcHMgfHxcbiAgICAgICAgY29tcG9uZW50LnBhcnRseV9ob2lzdGVkLmxlbmd0aCA+IDAgfHxcbiAgICAgICAgcmVuZGVyZXIuaW5pdGlhbF9jb250ZXh0Lmxlbmd0aCA+IDAgfHxcbiAgICAgICAgY29tcG9uZW50LnJlYWN0aXZlX2RlY2xhcmF0aW9ucy5sZW5ndGggPiAwIHx8XG4gICAgICAgIGNhcHR1cmVfc3RhdGUgfHxcbiAgICAgICAgaW5qZWN0X3N0YXRlKTtcbiAgICBjb25zdCBkZWZpbml0aW9uID0gaGFzX2RlZmluaXRpb25cbiAgICAgICAgPyBjb21wb25lbnQuYWxpYXMoJ2luc3RhbmNlJylcbiAgICAgICAgOiB7IHR5cGU6ICdMaXRlcmFsJywgdmFsdWU6IG51bGwgfTtcbiAgICBjb25zdCByZWFjdGl2ZV9zdG9yZV9zdWJzY3JpcHRpb25zID0gcmVhY3RpdmVfc3RvcmVzXG4gICAgICAgIC5maWx0ZXIoc3RvcmUgPT4ge1xuICAgICAgICBjb25zdCB2YXJpYWJsZSA9IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChzdG9yZS5uYW1lLnNsaWNlKDEpKTtcbiAgICAgICAgcmV0dXJuICF2YXJpYWJsZSB8fCB2YXJpYWJsZS5ob2lzdGFibGU7XG4gICAgfSlcbiAgICAgICAgLm1hcCgoeyBuYW1lIH0pID0+IGIgYFxuXHRcdFx0JHtjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldiAmJiBiIGBAdmFsaWRhdGVfc3RvcmUoJHtuYW1lLnNsaWNlKDEpfSwgJyR7bmFtZS5zbGljZSgxKX0nKTtgfVxuXHRcdFx0QGNvbXBvbmVudF9zdWJzY3JpYmUoJCRzZWxmLCAke25hbWUuc2xpY2UoMSl9LCAkJHZhbHVlID0+ICQkaW52YWxpZGF0ZSgke3JlbmRlcmVyLmNvbnRleHRfbG9va3VwLmdldChuYW1lKS5pbmRleH0sICR7bmFtZX0gPSAkJHZhbHVlKSk7XG5cdFx0YCk7XG4gICAgY29uc3QgcmVzdWJzY3JpYmFibGVfcmVhY3RpdmVfc3RvcmVfdW5zdWJzY3JpYmVycyA9IHJlYWN0aXZlX3N0b3Jlc1xuICAgICAgICAuZmlsdGVyKHN0b3JlID0+IHtcbiAgICAgICAgY29uc3QgdmFyaWFibGUgPSBjb21wb25lbnQudmFyX2xvb2t1cC5nZXQoc3RvcmUubmFtZS5zbGljZSgxKSk7XG4gICAgICAgIHJldHVybiB2YXJpYWJsZSAmJiAodmFyaWFibGUucmVhc3NpZ25lZCB8fCB2YXJpYWJsZS5leHBvcnRfbmFtZSk7XG4gICAgfSlcbiAgICAgICAgLm1hcCgoeyBuYW1lIH0pID0+IGIgYCQkc2VsZi4kJC5vbl9kZXN0cm95LnB1c2goKCkgPT4gJHtgJCR1bnN1YnNjcmliZV8ke25hbWUuc2xpY2UoMSl9YH0oKSk7YCk7XG4gICAgaWYgKGhhc19kZWZpbml0aW9uKSB7XG4gICAgICAgIGNvbnN0IHJlYWN0aXZlX2RlY2xhcmF0aW9ucyA9IFtdO1xuICAgICAgICBjb25zdCBmaXhlZF9yZWFjdGl2ZV9kZWNsYXJhdGlvbnMgPSBbXTsgLy8gbm90IHJlYWxseSAncmVhY3RpdmUnIGJ1dCB3aGF0ZXZlclxuICAgICAgICBjb21wb25lbnQucmVhY3RpdmVfZGVjbGFyYXRpb25zLmZvckVhY2goZCA9PiB7XG4gICAgICAgICAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBBcnJheS5mcm9tKGQuZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgICAgIGNvbnN0IHVzZXNfcmVzdF9vcl9wcm9wcyA9ICEhZGVwZW5kZW5jaWVzLmZpbmQobiA9PiBuID09PSAnJCRwcm9wcycgfHwgbiA9PT0gJyQkcmVzdFByb3BzJyk7XG4gICAgICAgICAgICBjb25zdCB3cml0YWJsZSA9IGRlcGVuZGVuY2llcy5maWx0ZXIobiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSBjb21wb25lbnQudmFyX2xvb2t1cC5nZXQobik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhcmlhYmxlICYmICh2YXJpYWJsZS5leHBvcnRfbmFtZSB8fCB2YXJpYWJsZS5tdXRhdGVkIHx8IHZhcmlhYmxlLnJlYXNzaWduZWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBjb25kaXRpb24gPSAhdXNlc19yZXN0X29yX3Byb3BzICYmIHdyaXRhYmxlLmxlbmd0aCA+IDAgJiYgcmVuZGVyZXIuZGlydHkod3JpdGFibGUsIHRydWUpO1xuICAgICAgICAgICAgbGV0IHN0YXRlbWVudCA9IGQubm9kZTsgLy8gVE9ETyByZW1vdmUgbGFiZWwgKHVzZSBkLm5vZGUuYm9keSkgaWYgaXQncyBub3QgcmVmZXJlbmNlZFxuICAgICAgICAgICAgaWYgKGNvbmRpdGlvbilcbiAgICAgICAgICAgICAgICBzdGF0ZW1lbnQgPSBiIGBpZiAoJHtjb25kaXRpb259KSB7ICR7c3RhdGVtZW50fSB9YFswXTtcbiAgICAgICAgICAgIGlmIChjb25kaXRpb24gfHwgdXNlc19yZXN0X29yX3Byb3BzKSB7XG4gICAgICAgICAgICAgICAgcmVhY3RpdmVfZGVjbGFyYXRpb25zLnB1c2goc3RhdGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpeGVkX3JlYWN0aXZlX2RlY2xhcmF0aW9ucy5wdXNoKHN0YXRlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBpbmplY3RlZCA9IEFycmF5LmZyb20oY29tcG9uZW50LmluamVjdGVkX3JlYWN0aXZlX2RlY2xhcmF0aW9uX3ZhcnMpLmZpbHRlcihuYW1lID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhcmlhYmxlID0gY29tcG9uZW50LnZhcl9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIHZhcmlhYmxlLmluamVjdGVkICYmIHZhcmlhYmxlLm5hbWVbMF0gIT09ICckJztcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHJlYWN0aXZlX3N0b3JlX2RlY2xhcmF0aW9ucyA9IHJlYWN0aXZlX3N0b3Jlcy5tYXAodmFyaWFibGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgJG5hbWUgPSB2YXJpYWJsZS5uYW1lO1xuICAgICAgICAgICAgY29uc3QgbmFtZSA9ICRuYW1lLnNsaWNlKDEpO1xuICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSBjb21wb25lbnQudmFyX2xvb2t1cC5nZXQobmFtZSk7XG4gICAgICAgICAgICBpZiAoc3RvcmUgJiYgKHN0b3JlLnJlYXNzaWduZWQgfHwgc3RvcmUuZXhwb3J0X25hbWUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdW5zdWJzY3JpYmUgPSBgJCR1bnN1YnNjcmliZV8ke25hbWV9YDtcbiAgICAgICAgICAgICAgICBjb25zdCBzdWJzY3JpYmUgPSBgJCRzdWJzY3JpYmVfJHtuYW1lfWA7XG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHJlbmRlcmVyLmNvbnRleHRfbG9va3VwLmdldCgkbmFtZSkuaW5kZXg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGIgYGxldCAkeyRuYW1lfSwgJHt1bnN1YnNjcmliZX0gPSBAbm9vcCwgJHtzdWJzY3JpYmV9ID0gKCkgPT4gKCR7dW5zdWJzY3JpYmV9KCksICR7dW5zdWJzY3JpYmV9ID0gQHN1YnNjcmliZSgke25hbWV9LCAkJHZhbHVlID0+ICQkaW52YWxpZGF0ZSgke2l9LCAkeyRuYW1lfSA9ICQkdmFsdWUpKSwgJHtuYW1lfSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGIgYGxldCAkeyRuYW1lfTtgO1xuICAgICAgICB9KTtcbiAgICAgICAgbGV0IHVua25vd25fcHJvcHNfY2hlY2s7XG4gICAgICAgIGlmIChjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldiAmJiAhKHVzZXNfcHJvcHMgfHwgdXNlc19yZXN0KSkge1xuICAgICAgICAgICAgdW5rbm93bl9wcm9wc19jaGVjayA9IGIgYFxuXHRcdFx0XHRjb25zdCB3cml0YWJsZV9wcm9wcyA9IFske3dyaXRhYmxlX3Byb3BzLm1hcChwcm9wID0+IHggYCcke3Byb3AuZXhwb3J0X25hbWV9J2ApfV07XG5cdFx0XHRcdEBfT2JqZWN0LmtleXMoJCRwcm9wcykuZm9yRWFjaChrZXkgPT4ge1xuXHRcdFx0XHRcdGlmICghfndyaXRhYmxlX3Byb3BzLmluZGV4T2Yoa2V5KSAmJiBrZXkuc2xpY2UoMCwgMikgIT09ICckJCcgJiYga2V5ICE9PSAnc2xvdCcpIEBfY29uc29sZS53YXJuKFxcYDwke2NvbXBvbmVudC50YWd9PiB3YXMgY3JlYXRlZCB3aXRoIHVua25vd24gcHJvcCAnXFwke2tleX0nXFxgKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRgO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJldHVybl92YWx1ZSA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdBcnJheUV4cHJlc3Npb24nLFxuICAgICAgICAgICAgZWxlbWVudHM6IHJlbmRlcmVyLmluaXRpYWxfY29udGV4dC5tYXAobWVtYmVyID0+ICh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0lkZW50aWZpZXInLFxuICAgICAgICAgICAgICAgIG5hbWU6IG1lbWJlci5uYW1lXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgfTtcbiAgICAgICAgYm9keS5wdXNoKGIgYFxuXHRcdFx0ZnVuY3Rpb24gJHtkZWZpbml0aW9ufSgke2FyZ3N9KSB7XG5cdFx0XHRcdCR7aW5qZWN0ZWQubWFwKG5hbWUgPT4gYiBgbGV0ICR7bmFtZX07YCl9XG5cblx0XHRcdFx0JHtyZXN0fVxuXG5cdFx0XHRcdCR7cmVhY3RpdmVfc3RvcmVfZGVjbGFyYXRpb25zfVxuXG5cdFx0XHRcdCR7cmVhY3RpdmVfc3RvcmVfc3Vic2NyaXB0aW9uc31cblxuXHRcdFx0XHQke3Jlc3Vic2NyaWJhYmxlX3JlYWN0aXZlX3N0b3JlX3Vuc3Vic2NyaWJlcnN9XG5cblx0XHRcdFx0JHtjb21wb25lbnQuc2xvdHMuc2l6ZSB8fCBjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldiB8fCB1c2VzX3Nsb3RzID8gYiBgbGV0IHsgJCRzbG90czogI3Nsb3RzID0ge30sICQkc2NvcGUgfSA9ICQkcHJvcHM7YCA6IG51bGx9XG5cdFx0XHRcdCR7Y29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5kZXYgJiYgYiBgQHZhbGlkYXRlX3Nsb3RzKCcke2NvbXBvbmVudC50YWd9JywgI3Nsb3RzLCBbJHtbLi4uY29tcG9uZW50LnNsb3RzLmtleXMoKV0ubWFwKGtleSA9PiBgJyR7a2V5fSdgKS5qb2luKCcsJyl9XSk7YH1cblx0XHRcdFx0JHtjb21wdXRlX3Nsb3RzfVxuXG5cdFx0XHRcdCR7aW5zdGFuY2VfamF2YXNjcmlwdH1cblxuXHRcdFx0XHQke21pc3NpbmdfcHJvcHNfY2hlY2t9XG5cdFx0XHRcdCR7dW5rbm93bl9wcm9wc19jaGVja31cblxuXHRcdFx0XHQke3JlbmRlcmVyLmJpbmRpbmdfZ3JvdXBzLnNpemUgPiAwICYmIGIgYGNvbnN0ICQkYmluZGluZ19ncm91cHMgPSBbJHtbLi4ucmVuZGVyZXIuYmluZGluZ19ncm91cHMua2V5cygpXS5tYXAoXyA9PiB4IGBbXWApfV07YH1cblxuXHRcdFx0XHQke2NvbXBvbmVudC5wYXJ0bHlfaG9pc3RlZH1cblxuXHRcdFx0XHQke3NldCAmJiBiIGAkJHNlbGYuJCRzZXQgPSAke3NldH07YH1cblxuXHRcdFx0XHQke2NhcHR1cmVfc3RhdGUgJiYgYiBgJCRzZWxmLiRjYXB0dXJlX3N0YXRlID0gJHtjYXB0dXJlX3N0YXRlfTtgfVxuXG5cdFx0XHRcdCR7aW5qZWN0X3N0YXRlICYmIGIgYCQkc2VsZi4kaW5qZWN0X3N0YXRlID0gJHtpbmplY3Rfc3RhdGV9O2B9XG5cblx0XHRcdFx0JHsgLyogYmVmb3JlIHJlYWN0aXZlIGRlY2xhcmF0aW9ucyAqL3Byb3BzX2luamVjdH1cblxuXHRcdFx0XHQke3JlYWN0aXZlX2RlY2xhcmF0aW9ucy5sZW5ndGggPiAwICYmIGIgYFxuXHRcdFx0XHQkJHNlbGYuJCQudXBkYXRlID0gKCkgPT4ge1xuXHRcdFx0XHRcdCR7cmVhY3RpdmVfZGVjbGFyYXRpb25zfVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRgfVxuXG5cdFx0XHRcdCR7Zml4ZWRfcmVhY3RpdmVfZGVjbGFyYXRpb25zfVxuXG5cdFx0XHRcdCR7dXNlc19wcm9wcyAmJiBiIGAkJHByb3BzID0gQGV4Y2x1ZGVfaW50ZXJuYWxfcHJvcHMoJCRwcm9wcyk7YH1cblxuXHRcdFx0XHRyZXR1cm4gJHtyZXR1cm5fdmFsdWV9O1xuXHRcdFx0fVxuXHRcdGApO1xuICAgIH1cbiAgICBjb25zdCBwcm9wX2luZGV4ZXMgPSB4IGB7XG5cdFx0JHtwcm9wcy5maWx0ZXIodiA9PiB2LmV4cG9ydF9uYW1lICYmICF2Lm1vZHVsZSkubWFwKHYgPT4gcCBgJHt2LmV4cG9ydF9uYW1lfTogJHtyZW5kZXJlci5jb250ZXh0X2xvb2t1cC5nZXQodi5uYW1lKS5pbmRleH1gKX1cblx0fWA7XG4gICAgbGV0IGRpcnR5O1xuICAgIGlmIChyZW5kZXJlci5jb250ZXh0X292ZXJmbG93KSB7XG4gICAgICAgIGRpcnR5ID0geCBgW11gO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbmRlcmVyLmNvbnRleHQubGVuZ3RoOyBpICs9IDMxKSB7XG4gICAgICAgICAgICBkaXJ0eS5lbGVtZW50cy5wdXNoKHggYC0xYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKG9wdGlvbnMuY3VzdG9tRWxlbWVudCkge1xuICAgICAgICBsZXQgaW5pdF9wcm9wcyA9IHggYEBhdHRyaWJ1dGVfdG9fb2JqZWN0KHRoaXMuYXR0cmlidXRlcylgO1xuICAgICAgICBpZiAodXNlc19zbG90cykge1xuICAgICAgICAgICAgaW5pdF9wcm9wcyA9IHggYHsgLi4uJHtpbml0X3Byb3BzfSwgJCRzbG90czogQGdldF9jdXN0b21fZWxlbWVudHNfc2xvdHModGhpcykgfWA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGVjbGFyYXRpb24gPSBiIGBcblx0XHRcdGNsYXNzICR7bmFtZX0gZXh0ZW5kcyBAU3ZlbHRlRWxlbWVudCB7XG5cdFx0XHRcdGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcblx0XHRcdFx0XHRzdXBlcigpO1xuXG5cdFx0XHRcdFx0JHtjc3MuY29kZSAmJiBiIGB0aGlzLnNoYWRvd1Jvb3QuaW5uZXJIVE1MID0gXFxgPHN0eWxlPiR7Y3NzLmNvZGUucmVwbGFjZShyZWdleF9iYWNrc2xhc2hlcywgJ1xcXFxcXFxcJyl9JHtjc3Nfc291cmNlbWFwX2VuYWJsZWQgJiYgb3B0aW9ucy5kZXYgPyBgXFxuLyojIHNvdXJjZU1hcHBpbmdVUkw9JHtjc3MubWFwLnRvVXJsKCl9ICovYCA6ICcnfTwvc3R5bGU+XFxgO2B9XG5cblx0XHRcdFx0XHRAaW5pdCh0aGlzLCB7IHRhcmdldDogdGhpcy5zaGFkb3dSb290LCBwcm9wczogJHtpbml0X3Byb3BzfSwgY3VzdG9tRWxlbWVudDogdHJ1ZSB9LCAke2RlZmluaXRpb259LCAke2hhc19jcmVhdGVfZnJhZ21lbnQgPyAnY3JlYXRlX2ZyYWdtZW50JyA6ICdudWxsJ30sICR7bm90X2VxdWFsfSwgJHtwcm9wX2luZGV4ZXN9LCBudWxsLCAke2RpcnR5fSk7XG5cblx0XHRcdFx0XHRpZiAob3B0aW9ucykge1xuXHRcdFx0XHRcdFx0aWYgKG9wdGlvbnMudGFyZ2V0KSB7XG5cdFx0XHRcdFx0XHRcdEBpbnNlcnQob3B0aW9ucy50YXJnZXQsIHRoaXMsIG9wdGlvbnMuYW5jaG9yKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0JHsocHJvcHMubGVuZ3RoID4gMCB8fCB1c2VzX3Byb3BzIHx8IHVzZXNfcmVzdCkgJiYgYiBgXG5cdFx0XHRcdFx0XHRpZiAob3B0aW9ucy5wcm9wcykge1xuXHRcdFx0XHRcdFx0XHR0aGlzLiRzZXQob3B0aW9ucy5wcm9wcyk7XG5cdFx0XHRcdFx0XHRcdEBmbHVzaCgpO1xuXHRcdFx0XHRcdFx0fWB9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0YFswXTtcbiAgICAgICAgaWYgKHByb3BzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGRlY2xhcmF0aW9uLmJvZHkuYm9keS5wdXNoKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnTWV0aG9kRGVmaW5pdGlvbicsXG4gICAgICAgICAgICAgICAga2luZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgc3RhdGljOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbXB1dGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBrZXk6IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiAnb2JzZXJ2ZWRBdHRyaWJ1dGVzJyB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB4IGBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gWyR7cHJvcHMubWFwKHByb3AgPT4geCBgXCIke3Byb3AuZXhwb3J0X25hbWV9XCJgKX1dO1xuXHRcdFx0XHR9YFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcHVzaF9hcnJheSQxKGRlY2xhcmF0aW9uLmJvZHkuYm9keSwgYWNjZXNzb3JzKTtcbiAgICAgICAgYm9keS5wdXNoKGRlY2xhcmF0aW9uKTtcbiAgICAgICAgaWYgKGNvbXBvbmVudC50YWcgIT0gbnVsbCkge1xuICAgICAgICAgICAgYm9keS5wdXNoKGIgYFxuXHRcdFx0XHRAX2N1c3RvbUVsZW1lbnRzLmRlZmluZShcIiR7Y29tcG9uZW50LnRhZ31cIiwgJHtuYW1lfSk7XG5cdFx0XHRgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3Qgc3VwZXJjbGFzcyA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdJZGVudGlmaWVyJyxcbiAgICAgICAgICAgIG5hbWU6IG9wdGlvbnMuZGV2ID8gJ0BTdmVsdGVDb21wb25lbnREZXYnIDogJ0BTdmVsdGVDb21wb25lbnQnXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IG9wdGlvbmFsX3BhcmFtZXRlcnMgPSBbXTtcbiAgICAgICAgaWYgKHNob3VsZF9hZGRfY3NzKSB7XG4gICAgICAgICAgICBvcHRpb25hbF9wYXJhbWV0ZXJzLnB1c2goYWRkX2Nzcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGlydHkpIHtcbiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtZXRlcnMucHVzaCh4IGBudWxsYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRpcnR5KSB7XG4gICAgICAgICAgICBvcHRpb25hbF9wYXJhbWV0ZXJzLnB1c2goZGlydHkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlY2xhcmF0aW9uID0gYiBgXG5cdFx0XHRjbGFzcyAke25hbWV9IGV4dGVuZHMgJHtzdXBlcmNsYXNzfSB7XG5cdFx0XHRcdGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcblx0XHRcdFx0XHRzdXBlcigke29wdGlvbnMuZGV2ICYmICdvcHRpb25zJ30pO1xuXHRcdFx0XHRcdEBpbml0KHRoaXMsIG9wdGlvbnMsICR7ZGVmaW5pdGlvbn0sICR7aGFzX2NyZWF0ZV9mcmFnbWVudCA/ICdjcmVhdGVfZnJhZ21lbnQnIDogJ251bGwnfSwgJHtub3RfZXF1YWx9LCAke3Byb3BfaW5kZXhlc30sICR7b3B0aW9uYWxfcGFyYW1ldGVyc30pO1xuXHRcdFx0XHRcdCR7b3B0aW9ucy5kZXYgJiYgYiBgQGRpc3BhdGNoX2RldihcIlN2ZWx0ZVJlZ2lzdGVyQ29tcG9uZW50XCIsIHsgY29tcG9uZW50OiB0aGlzLCB0YWdOYW1lOiBcIiR7bmFtZS5uYW1lfVwiLCBvcHRpb25zLCBpZDogY3JlYXRlX2ZyYWdtZW50Lm5hbWUgfSk7YH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdGBbMF07XG4gICAgICAgIHB1c2hfYXJyYXkkMShkZWNsYXJhdGlvbi5ib2R5LmJvZHksIGFjY2Vzc29ycyk7XG4gICAgICAgIGJvZHkucHVzaChkZWNsYXJhdGlvbik7XG4gICAgfVxuICAgIHJldHVybiB7IGpzOiBmbGF0dGVuKGJvZHkpLCBjc3MgfTtcbn1cblxuZnVuY3Rpb24gZ2V0X2NvbnN0X3RhZ3MkMShjb25zdF90YWdzKSB7XG4gICAgaWYgKGNvbnN0X3RhZ3MubGVuZ3RoID09PSAwKVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnVmFyaWFibGVEZWNsYXJhdGlvbicsXG4gICAgICAgIGtpbmQ6ICdsZXQnLFxuICAgICAgICBkZWNsYXJhdGlvbnM6IGNvbnN0X3RhZ3MubWFwKGNvbnN0X3RhZyA9PiB7XG4gICAgICAgICAgICBjb25zdCBhc3NpZ25tZW50ID0gY29uc3RfdGFnLm5vZGUuZXhwcmVzc2lvbjtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1ZhcmlhYmxlRGVjbGFyYXRvcicsXG4gICAgICAgICAgICAgICAgaWQ6IGFzc2lnbm1lbnQubGVmdCxcbiAgICAgICAgICAgICAgICBpbml0OiBhc3NpZ25tZW50LnJpZ2h0XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIEF3YWl0QmxvY2skMSAobm9kZSwgcmVuZGVyZXIsIG9wdGlvbnMpIHtcbiAgICByZW5kZXJlci5wdXNoKCk7XG4gICAgcmVuZGVyZXIucmVuZGVyKG5vZGUucGVuZGluZy5jaGlsZHJlbiwgb3B0aW9ucyk7XG4gICAgY29uc3QgcGVuZGluZyA9IHJlbmRlcmVyLnBvcCgpO1xuICAgIHJlbmRlcmVyLnB1c2goKTtcbiAgICByZW5kZXJlci5yZW5kZXIobm9kZS50aGVuLmNoaWxkcmVuLCBvcHRpb25zKTtcbiAgICBjb25zdCB0aGVuID0gcmVuZGVyZXIucG9wKCk7XG4gICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgXG5cdFx0ZnVuY3Rpb24oX192YWx1ZSkge1xuXHRcdFx0aWYgKEBpc19wcm9taXNlKF9fdmFsdWUpKSB7XG5cdFx0XHRcdF9fdmFsdWUudGhlbihudWxsLCBAbm9vcCk7XG5cdFx0XHRcdHJldHVybiAke3BlbmRpbmd9O1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIChmdW5jdGlvbigke25vZGUudGhlbl9ub2RlID8gbm9kZS50aGVuX25vZGUgOiAnJ30pIHsgJHtnZXRfY29uc3RfdGFncyQxKG5vZGUudGhlbi5jb25zdF90YWdzKX07IHJldHVybiAke3RoZW59OyB9KF9fdmFsdWUpKTtcblx0XHR9KCR7bm9kZS5leHByZXNzaW9uLm5vZGV9KVxuXHRgKTtcbn1cblxuZnVuY3Rpb24gQ29tbWVudCQyIChub2RlLCByZW5kZXJlciwgb3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zLnByZXNlcnZlQ29tbWVudHMpIHtcbiAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZyhgPCEtLSR7bm9kZS5kYXRhfS0tPmApO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gRGVidWdUYWckMSAobm9kZSwgcmVuZGVyZXIsIG9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMuZGV2KVxuICAgICAgICByZXR1cm47XG4gICAgY29uc3QgZmlsZW5hbWUgPSBvcHRpb25zLmZpbGVuYW1lIHx8IG51bGw7XG4gICAgY29uc3QgeyBsaW5lLCBjb2x1bW4gfSA9IG9wdGlvbnMubG9jYXRlKG5vZGUuc3RhcnQgKyAxKTtcbiAgICBjb25zdCBvYmogPSB4IGB7XG5cdFx0JHtub2RlLmV4cHJlc3Npb25zLm1hcChlID0+IHAgYCR7ZS5ub2RlLm5hbWV9YCl9XG5cdH1gO1xuICAgIHJlbmRlcmVyLmFkZF9leHByZXNzaW9uKHggYEBkZWJ1Zygke2ZpbGVuYW1lID8geCBgXCIke2ZpbGVuYW1lfVwiYCA6IHggYG51bGxgfSwgJHtsaW5lIC0gMX0sICR7Y29sdW1ufSwgJHtvYmp9KWApO1xufVxuXG5mdW5jdGlvbiBFYWNoQmxvY2skMSAobm9kZSwgcmVuZGVyZXIsIG9wdGlvbnMpIHtcbiAgICBjb25zdCBhcmdzID0gW25vZGUuY29udGV4dF9ub2RlXTtcbiAgICBpZiAobm9kZS5pbmRleClcbiAgICAgICAgYXJncy5wdXNoKHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiBub2RlLmluZGV4IH0pO1xuICAgIHJlbmRlcmVyLnB1c2goKTtcbiAgICByZW5kZXJlci5yZW5kZXIobm9kZS5jaGlsZHJlbiwgb3B0aW9ucyk7XG4gICAgY29uc3QgcmVzdWx0ID0gcmVuZGVyZXIucG9wKCk7XG4gICAgY29uc3QgY29uc2VxdWVudCA9IHggYEBlYWNoKCR7bm9kZS5leHByZXNzaW9uLm5vZGV9LCAoJHthcmdzfSkgPT4geyAke2dldF9jb25zdF90YWdzJDEobm9kZS5jb25zdF90YWdzKX07IHJldHVybiAke3Jlc3VsdH0gfSlgO1xuICAgIGlmIChub2RlLmVsc2UpIHtcbiAgICAgICAgcmVuZGVyZXIucHVzaCgpO1xuICAgICAgICByZW5kZXJlci5yZW5kZXIobm9kZS5lbHNlLmNoaWxkcmVuLCBvcHRpb25zKTtcbiAgICAgICAgbGV0IGFsdGVybmF0ZSA9IHJlbmRlcmVyLnBvcCgpO1xuICAgICAgICBpZiAobm9kZS5lbHNlLmNvbnN0X3RhZ3MubGVuZ3RoID4gMClcbiAgICAgICAgICAgIGFsdGVybmF0ZSA9IHggYCgoKSA9PiB7ICR7Z2V0X2NvbnN0X3RhZ3MkMShub2RlLmVsc2UuY29uc3RfdGFncyl9OyByZXR1cm4gJHthbHRlcm5hdGV9IH0pKClgO1xuICAgICAgICByZW5kZXJlci5hZGRfZXhwcmVzc2lvbih4IGAke25vZGUuZXhwcmVzc2lvbi5ub2RlfS5sZW5ndGggPyAke2NvbnNlcXVlbnR9IDogJHthbHRlcm5hdGV9YCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZW5kZXJlci5hZGRfZXhwcmVzc2lvbihjb25zZXF1ZW50KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldF9jbGFzc19hdHRyaWJ1dGVfdmFsdWUoYXR0cmlidXRlKSB7XG4gICAgLy8gaGFuZGxlIHNwZWNpYWwgY2FzZSDigJQgYGNsYXNzPXtwb3NzaWJseVVuZGVmaW5lZH1gIHdpdGggc2NvcGVkIENTU1xuICAgIGlmIChhdHRyaWJ1dGUuY2h1bmtzLmxlbmd0aCA9PT0gMiAmJiBhdHRyaWJ1dGUuY2h1bmtzWzFdLnN5bnRoZXRpYykge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGF0dHJpYnV0ZS5jaHVua3NbMF0ubm9kZTtcbiAgICAgICAgcmV0dXJuIHggYEBlc2NhcGUoQG51bGxfdG9fZW1wdHkoJHt2YWx1ZX0pLCB0cnVlKSArIFwiJHthdHRyaWJ1dGUuY2h1bmtzWzFdLmRhdGF9XCJgO1xuICAgIH1cbiAgICByZXR1cm4gZ2V0X2F0dHJpYnV0ZV92YWx1ZShhdHRyaWJ1dGUpO1xufVxuZnVuY3Rpb24gZ2V0X2F0dHJpYnV0ZV92YWx1ZShhdHRyaWJ1dGUpIHtcbiAgICBpZiAoYXR0cmlidXRlLmNodW5rcy5sZW5ndGggPT09IDApXG4gICAgICAgIHJldHVybiB4IGBcIlwiYDtcbiAgICByZXR1cm4gYXR0cmlidXRlLmNodW5rc1xuICAgICAgICAubWFwKChjaHVuaykgPT4ge1xuICAgICAgICByZXR1cm4gY2h1bmsudHlwZSA9PT0gJ1RleHQnXG4gICAgICAgICAgICA/IHN0cmluZ19saXRlcmFsKGNodW5rLmRhdGEucmVwbGFjZShyZWdleF9kb3VibGVfcXVvdGVzLCAnJnF1b3Q7JykpXG4gICAgICAgICAgICA6IHggYEBlc2NhcGUoJHtjaHVuay5ub2RlfSwgdHJ1ZSlgO1xuICAgIH0pXG4gICAgICAgIC5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30gKyAke3Joc31gKTtcbn1cbmZ1bmN0aW9uIGdldF9hdHRyaWJ1dGVfZXhwcmVzc2lvbihhdHRyaWJ1dGUpIHtcbiAgICBpZiAoYXR0cmlidXRlLmNodW5rcy5sZW5ndGggPT09IDEgJiYgYXR0cmlidXRlLmNodW5rc1swXS50eXBlID09PSAnRXhwcmVzc2lvbicpIHtcbiAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZS5jaHVua3NbMF0ubm9kZTtcbiAgICB9XG4gICAgcmV0dXJuIGdldF9hdHRyaWJ1dGVfdmFsdWUoYXR0cmlidXRlKTtcbn1cblxuLy8gc2ltaWxhciBsb2dpYyBmcm9tIGBjb21waWxlL3JlbmRlcl9kb20vd3JhcHBlcnMvRnJhZ21lbnRgXG4vLyBXZSB3YW50IHRvIHJlbW92ZSB0cmFpbGluZyB3aGl0ZXNwYWNlIGluc2lkZSBhbiBlbGVtZW50L2NvbXBvbmVudC9ibG9jayxcbi8vICp1bmxlc3MqIHRoZXJlIGlzIG5vIHdoaXRlc3BhY2UgYmV0d2VlbiB0aGlzIG5vZGUgYW5kIGl0cyBuZXh0IHNpYmxpbmdcbmZ1bmN0aW9uIHJlbW92ZV93aGl0ZXNwYWNlX2NoaWxkcmVuKGNoaWxkcmVuLCBuZXh0KSB7XG4gICAgY29uc3Qgbm9kZXMgPSBbXTtcbiAgICBsZXQgbGFzdF9jaGlsZDtcbiAgICBsZXQgaSA9IGNoaWxkcmVuLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XG4gICAgICAgIGlmIChjaGlsZC50eXBlID09PSAnVGV4dCcpIHtcbiAgICAgICAgICAgIGlmIChjaGlsZC5zaG91bGRfc2tpcCgpKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgeyBkYXRhIH0gPSBjaGlsZDtcbiAgICAgICAgICAgIGlmIChub2Rlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzaG91bGRfdHJpbSA9IG5leHRcbiAgICAgICAgICAgICAgICAgICAgPyBuZXh0LnR5cGUgPT09ICdUZXh0JyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXhfc3RhcnRzX3dpdGhfd2hpdGVzcGFjZS50ZXN0KG5leHQuZGF0YSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyaW1tYWJsZV9hdCQxKGNoaWxkLCBuZXh0KVxuICAgICAgICAgICAgICAgICAgICA6ICFjaGlsZC5oYXNfYW5jZXN0b3IoJ0VhY2hCbG9jaycpO1xuICAgICAgICAgICAgICAgIGlmIChzaG91bGRfdHJpbSAmJiAhY2hpbGQua2VlcF9zcGFjZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0cmltX2VuZChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZ2x1ZSB0ZXh0IG5vZGVzICh3aGljaCBjb3VsZCBlLmcuIGJlIHNlcGFyYXRlZCBieSBjb21tZW50cykgdG9nZXRoZXJcbiAgICAgICAgICAgIGlmIChsYXN0X2NoaWxkICYmIGxhc3RfY2hpbGQudHlwZSA9PT0gJ1RleHQnKSB7XG4gICAgICAgICAgICAgICAgbGFzdF9jaGlsZC5kYXRhID0gZGF0YSArIGxhc3RfY2hpbGQuZGF0YTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vZGVzLnVuc2hpZnQoY2hpbGQpO1xuICAgICAgICAgICAgbGluayhsYXN0X2NoaWxkLCBsYXN0X2NoaWxkID0gY2hpbGQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbm9kZXMudW5zaGlmdChjaGlsZCk7XG4gICAgICAgICAgICBsaW5rKGxhc3RfY2hpbGQsIGxhc3RfY2hpbGQgPSBjaGlsZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZmlyc3QgPSBub2Rlc1swXTtcbiAgICBpZiAoZmlyc3QgJiYgZmlyc3QudHlwZSA9PT0gJ1RleHQnICYmICFmaXJzdC5rZWVwX3NwYWNlKCkpIHtcbiAgICAgICAgZmlyc3QuZGF0YSA9IHRyaW1fc3RhcnQoZmlyc3QuZGF0YSk7XG4gICAgICAgIGlmICghZmlyc3QuZGF0YSkge1xuICAgICAgICAgICAgZmlyc3QudmFyID0gbnVsbDtcbiAgICAgICAgICAgIG5vZGVzLnNoaWZ0KCk7XG4gICAgICAgICAgICBpZiAobm9kZXNbMF0pIHtcbiAgICAgICAgICAgICAgICBub2Rlc1swXS5wcmV2ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbm9kZXM7XG59XG5mdW5jdGlvbiB0cmltbWFibGVfYXQkMShjaGlsZCwgbmV4dF9zaWJsaW5nKSB7XG4gICAgLy8gV2hpdGVzcGFjZSBpcyB0cmltbWFibGUgaWYgb25lIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZTpcbiAgICAvLyBUaGUgY2hpbGQgYW5kIGl0cyBzaWJsaW5nIHNoYXJlIGEgY29tbW9uIG5lYXJlc3QgZWFjaCBibG9jayAobm90IGF0IGFuIGVhY2ggYmxvY2sgYm91bmRhcnkpXG4gICAgLy8gVGhlIG5leHQgc2libGluZydzIHByZXZpb3VzIG5vZGUgaXMgYW4gZWFjaCBibG9ja1xuICAgIHJldHVybiAobmV4dF9zaWJsaW5nLmZpbmRfbmVhcmVzdCgvRWFjaEJsb2NrLykgPT09XG4gICAgICAgIGNoaWxkLmZpbmRfbmVhcmVzdCgvRWFjaEJsb2NrLykgfHwgbmV4dF9zaWJsaW5nLnByZXYudHlwZSA9PT0gJ0VhY2hCbG9jaycpO1xufVxuXG5mdW5jdGlvbiBFbGVtZW50JDEgKG5vZGUsIHJlbmRlcmVyLCBvcHRpb25zKSB7XG4gICAgY29uc3QgY2hpbGRyZW4gPSByZW1vdmVfd2hpdGVzcGFjZV9jaGlsZHJlbihub2RlLmNoaWxkcmVuLCBub2RlLm5leHQpO1xuICAgIC8vIGF3a3dhcmQgc3BlY2lhbCBjYXNlXG4gICAgbGV0IG5vZGVfY29udGVudHM7XG4gICAgY29uc3QgY29udGVudGVkaXRhYmxlID0gKG5vZGUubmFtZSAhPT0gJ3RleHRhcmVhJyAmJlxuICAgICAgICBub2RlLm5hbWUgIT09ICdpbnB1dCcgJiZcbiAgICAgICAgbm9kZS5hdHRyaWJ1dGVzLnNvbWUoKGF0dHJpYnV0ZSkgPT4gYXR0cmlidXRlLm5hbWUgPT09ICdjb250ZW50ZWRpdGFibGUnKSk7XG4gICAgaWYgKG5vZGUuaXNfZHluYW1pY19lbGVtZW50KSB7XG4gICAgICAgIHJlbmRlcmVyLnB1c2goKTtcbiAgICB9XG4gICAgcmVuZGVyZXIuYWRkX3N0cmluZygnPCcpO1xuICAgIGFkZF90YWdfbmFtZSgpO1xuICAgIGNvbnN0IGNsYXNzX2V4cHJlc3Npb25fbGlzdCA9IG5vZGUuY2xhc3Nlcy5tYXAoY2xhc3NfZGlyZWN0aXZlID0+IHtcbiAgICAgICAgY29uc3QgeyBleHByZXNzaW9uLCBuYW1lIH0gPSBjbGFzc19kaXJlY3RpdmU7XG4gICAgICAgIGNvbnN0IHNuaXBwZXQgPSBleHByZXNzaW9uID8gZXhwcmVzc2lvbi5ub2RlIDogeCBgI2N0eC4ke25hbWV9YDsgLy8gVE9ETyBpcyB0aGlzIHJpZ2h0P1xuICAgICAgICByZXR1cm4geCBgJHtzbmlwcGV0fSA/IFwiJHtuYW1lfVwiIDogXCJcImA7XG4gICAgfSk7XG4gICAgaWYgKG5vZGUubmVlZHNfbWFudWFsX3N0eWxlX3Njb3BpbmcpIHtcbiAgICAgICAgY2xhc3NfZXhwcmVzc2lvbl9saXN0LnB1c2goeCBgXCIke25vZGUuY29tcG9uZW50LnN0eWxlc2hlZXQuaWR9XCJgKTtcbiAgICB9XG4gICAgY29uc3QgY2xhc3NfZXhwcmVzc2lvbiA9IGNsYXNzX2V4cHJlc3Npb25fbGlzdC5sZW5ndGggPiAwICYmXG4gICAgICAgIGNsYXNzX2V4cHJlc3Npb25fbGlzdC5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30gKyAnICcgKyAke3Joc31gKTtcbiAgICBjb25zdCBzdHlsZV9leHByZXNzaW9uX2xpc3QgPSBub2RlLnN0eWxlcy5tYXAoc3R5bGVfZGlyZWN0aXZlID0+IHtcbiAgICAgICAgbGV0IHsgbmFtZSwgaW1wb3J0YW50LCBleHByZXNzaW9uOiB7IG5vZGU6IGV4cHJlc3Npb24gfSB9ID0gc3R5bGVfZGlyZWN0aXZlO1xuICAgICAgICBpZiAoaW1wb3J0YW50KSB7XG4gICAgICAgICAgICBleHByZXNzaW9uID0geCBgJHtleHByZXNzaW9ufSArICcgIWltcG9ydGFudCdgO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwIGBcIiR7bmFtZX1cIjogJHtleHByZXNzaW9ufWA7XG4gICAgfSk7XG4gICAgY29uc3Qgc3R5bGVfZXhwcmVzc2lvbiA9IHN0eWxlX2V4cHJlc3Npb25fbGlzdC5sZW5ndGggPiAwICYmXG4gICAgICAgIHggYHsgJHtzdHlsZV9leHByZXNzaW9uX2xpc3R9IH1gO1xuICAgIGlmIChub2RlLmF0dHJpYnV0ZXMuc29tZShhdHRyID0+IGF0dHIuaXNfc3ByZWFkKSkge1xuICAgICAgICAvLyBUT0RPIGRyeSB0aGlzIG91dFxuICAgICAgICBjb25zdCBhcmdzID0gW107XG4gICAgICAgIG5vZGUuYXR0cmlidXRlcy5mb3JFYWNoKGF0dHJpYnV0ZSA9PiB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlLmlzX3NwcmVhZCkge1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh4IGBAZXNjYXBlX29iamVjdCgke2F0dHJpYnV0ZS5leHByZXNzaW9uLm5vZGV9KWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXR0cl9uYW1lID0gbm9kZS5uYW1lc3BhY2UgPT09IG5hbWVzcGFjZXMuZm9yZWlnbiA/IGF0dHJpYnV0ZS5uYW1lIDogZml4X2F0dHJpYnV0ZV9jYXNpbmcoYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBhdHRyaWJ1dGUubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAndmFsdWUnICYmIG5vZGUubmFtZS50b0xvd2VyQ2FzZSgpID09PSAndGV4dGFyZWEnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVfY29udGVudHMgPSBnZXRfYXR0cmlidXRlX3ZhbHVlKGF0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGF0dHJpYnV0ZS5pc190cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh4IGB7ICR7YXR0cl9uYW1lfTogdHJ1ZSB9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJvb2xlYW5fYXR0cmlidXRlcy5oYXMobmFtZSkgJiZcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmNodW5rcy5sZW5ndGggPT09IDEgJiZcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmNodW5rc1swXS50eXBlICE9PSAnVGV4dCcpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYSBib29sZWFuIGF0dHJpYnV0ZSB3aXRoIG9uZSBub24tVGV4dCBjaHVua1xuICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goeCBgeyAke2F0dHJfbmFtZX06ICR7YXR0cmlidXRlLmNodW5rc1swXS5ub2RlfSB8fCBudWxsIH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYXR0cmlidXRlLmNodW5rcy5sZW5ndGggPT09IDEgJiYgYXR0cmlidXRlLmNodW5rc1swXS50eXBlICE9PSAnVGV4dCcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc25pcHBldCA9IGF0dHJpYnV0ZS5jaHVua3NbMF0ubm9kZTtcbiAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHggYHsgJHthdHRyX25hbWV9OiBAZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSgke3NuaXBwZXR9KSB9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goeCBgeyAke2F0dHJfbmFtZX06ICR7Z2V0X2F0dHJpYnV0ZV92YWx1ZShhdHRyaWJ1dGUpfSB9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgQHNwcmVhZChbJHthcmdzfV0sIHsgY2xhc3NlczogJHtjbGFzc19leHByZXNzaW9ufSwgc3R5bGVzOiAke3N0eWxlX2V4cHJlc3Npb259IH0pYCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBsZXQgYWRkX2NsYXNzX2F0dHJpYnV0ZSA9ICEhY2xhc3NfZXhwcmVzc2lvbjtcbiAgICAgICAgbGV0IGFkZF9zdHlsZV9hdHRyaWJ1dGUgPSAhIXN0eWxlX2V4cHJlc3Npb247XG4gICAgICAgIG5vZGUuYXR0cmlidXRlcy5mb3JFYWNoKGF0dHJpYnV0ZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gYXR0cmlidXRlLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJfbmFtZSA9IG5vZGUubmFtZXNwYWNlID09PSBuYW1lc3BhY2VzLmZvcmVpZ24gPyBhdHRyaWJ1dGUubmFtZSA6IGZpeF9hdHRyaWJ1dGVfY2FzaW5nKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgIGlmIChuYW1lID09PSAndmFsdWUnICYmIG5vZGUubmFtZS50b0xvd2VyQ2FzZSgpID09PSAndGV4dGFyZWEnKSB7XG4gICAgICAgICAgICAgICAgbm9kZV9jb250ZW50cyA9IGdldF9hdHRyaWJ1dGVfdmFsdWUoYXR0cmlidXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGF0dHJpYnV0ZS5pc190cnVlKSB7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZyhgICR7YXR0cl9uYW1lfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYm9vbGVhbl9hdHRyaWJ1dGVzLmhhcyhuYW1lKSAmJlxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5jaHVua3MubGVuZ3RoID09PSAxICYmXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlLmNodW5rc1swXS50eXBlICE9PSAnVGV4dCcpIHtcbiAgICAgICAgICAgICAgICAvLyBhIGJvb2xlYW4gYXR0cmlidXRlIHdpdGggb25lIG5vbi1UZXh0IGNodW5rXG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZygnICcpO1xuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9leHByZXNzaW9uKHggYCR7YXR0cmlidXRlLmNodW5rc1swXS5ub2RlfSA/IFwiJHthdHRyX25hbWV9XCIgOiBcIlwiYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChuYW1lID09PSAnY2xhc3MnICYmIGNsYXNzX2V4cHJlc3Npb24pIHtcbiAgICAgICAgICAgICAgICBhZGRfY2xhc3NfYXR0cmlidXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZyhgICR7YXR0cl9uYW1lfT1cImApO1xuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9leHByZXNzaW9uKHggYFske2dldF9jbGFzc19hdHRyaWJ1dGVfdmFsdWUoYXR0cmlidXRlKX0sICR7Y2xhc3NfZXhwcmVzc2lvbn1dLmpvaW4oJyAnKS50cmltKClgKTtcbiAgICAgICAgICAgICAgICByZW5kZXJlci5hZGRfc3RyaW5nKCdcIicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gJ3N0eWxlJyAmJiBzdHlsZV9leHByZXNzaW9uKSB7XG4gICAgICAgICAgICAgICAgYWRkX3N0eWxlX2F0dHJpYnV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9leHByZXNzaW9uKHggYEBhZGRfc3R5bGVzKEBtZXJnZV9zc3Jfc3R5bGVzKCR7Z2V0X2F0dHJpYnV0ZV92YWx1ZShhdHRyaWJ1dGUpfSwgJHtzdHlsZV9leHByZXNzaW9ufSkpYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhdHRyaWJ1dGUuY2h1bmtzLmxlbmd0aCA9PT0gMSAmJiBhdHRyaWJ1dGUuY2h1bmtzWzBdLnR5cGUgIT09ICdUZXh0Jykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNuaXBwZXQgPSBhdHRyaWJ1dGUuY2h1bmtzWzBdLm5vZGU7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgQGFkZF9hdHRyaWJ1dGUoXCIke2F0dHJfbmFtZX1cIiwgJHtzbmlwcGV0fSwgJHtib29sZWFuX2F0dHJpYnV0ZXMuaGFzKG5hbWUpID8gMSA6IDB9KWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZyhgICR7YXR0cl9uYW1lfT1cImApO1xuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9leHByZXNzaW9uKChuYW1lID09PSAnY2xhc3MnID8gZ2V0X2NsYXNzX2F0dHJpYnV0ZV92YWx1ZSA6IGdldF9hdHRyaWJ1dGVfdmFsdWUpKGF0dHJpYnV0ZSkpO1xuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9zdHJpbmcoJ1wiJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoYWRkX2NsYXNzX2F0dHJpYnV0ZSkge1xuICAgICAgICAgICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgQGFkZF9jbGFzc2VzKCgke2NsYXNzX2V4cHJlc3Npb259KS50cmltKCkpYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFkZF9zdHlsZV9hdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9leHByZXNzaW9uKHggYEBhZGRfc3R5bGVzKCR7c3R5bGVfZXhwcmVzc2lvbn0pYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbm9kZS5iaW5kaW5ncy5mb3JFYWNoKGJpbmRpbmcgPT4ge1xuICAgICAgICBjb25zdCB7IG5hbWUsIGV4cHJlc3Npb24gfSA9IGJpbmRpbmc7XG4gICAgICAgIGlmIChiaW5kaW5nLmlzX3JlYWRvbmx5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hbWUgPT09ICdncm91cCcpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlX2F0dHJpYnV0ZSA9IG5vZGUuYXR0cmlidXRlcy5maW5kKCh7IG5hbWUgfSkgPT4gbmFtZSA9PT0gJ3ZhbHVlJyk7XG4gICAgICAgICAgICBpZiAodmFsdWVfYXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBnZXRfYXR0cmlidXRlX2V4cHJlc3Npb24odmFsdWVfYXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gbm9kZS5nZXRfc3RhdGljX2F0dHJpYnV0ZV92YWx1ZSgndHlwZScpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGJvdW5kID0gZXhwcmVzc2lvbi5ub2RlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbmRpdGlvbiA9IHR5cGUgPT09ICdjaGVja2JveCcgPyB4IGB+JHtib3VuZH0uaW5kZXhPZigke3ZhbHVlfSlgIDogeCBgJHt2YWx1ZX0gPT09ICR7Ym91bmR9YDtcbiAgICAgICAgICAgICAgICByZW5kZXJlci5hZGRfZXhwcmVzc2lvbih4IGAke2NvbmRpdGlvbn0gPyBAYWRkX2F0dHJpYnV0ZShcImNoZWNrZWRcIiwgdHJ1ZSwgMSkgOiBcIlwiYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29udGVudGVkaXRhYmxlICYmIChuYW1lID09PSAndGV4dENvbnRlbnQnIHx8IG5hbWUgPT09ICdpbm5lckhUTUwnKSkge1xuICAgICAgICAgICAgbm9kZV9jb250ZW50cyA9IGV4cHJlc3Npb24ubm9kZTtcbiAgICAgICAgICAgIC8vIFRPRE8gd2hlcmUgd2FzIHRoaXMgdXNlZD9cbiAgICAgICAgICAgIC8vIHZhbHVlID0gbmFtZSA9PT0gJ3RleHRDb250ZW50JyA/IHhgQGVzY2FwZSgkJHZhbHVlKWAgOiB4YCQkdmFsdWVgO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGJpbmRpbmcubmFtZSA9PT0gJ3ZhbHVlJyAmJiBub2RlLm5hbWUgPT09ICd0ZXh0YXJlYScpIHtcbiAgICAgICAgICAgIGNvbnN0IHNuaXBwZXQgPSBleHByZXNzaW9uLm5vZGU7XG4gICAgICAgICAgICBub2RlX2NvbnRlbnRzID0geCBgJHtzbmlwcGV0fSB8fCBcIlwiYDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChiaW5kaW5nLm5hbWUgPT09ICd2YWx1ZScgJiYgbm9kZS5uYW1lID09PSAnc2VsZWN0JykgO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHNuaXBwZXQgPSBleHByZXNzaW9uLm5vZGU7XG4gICAgICAgICAgICByZW5kZXJlci5hZGRfZXhwcmVzc2lvbih4IGBAYWRkX2F0dHJpYnV0ZShcIiR7bmFtZX1cIiwgJHtzbmlwcGV0fSwgJHtib29sZWFuX2F0dHJpYnV0ZXMuaGFzKG5hbWUpID8gMSA6IDB9KWApO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmVuZGVyZXIuYWRkX3N0cmluZygnPicpO1xuICAgIGlmIChub2RlX2NvbnRlbnRzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKGNvbnRlbnRlZGl0YWJsZSkge1xuICAgICAgICAgICAgcmVuZGVyZXIucHVzaCgpO1xuICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyKGNoaWxkcmVuLCBvcHRpb25zKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHJlbmRlcmVyLnBvcCgpO1xuICAgICAgICAgICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgKCQkdmFsdWUgPT4gJCR2YWx1ZSA9PT0gdm9pZCAwID8gJHtyZXN1bHR9IDogJCR2YWx1ZSkoJHtub2RlX2NvbnRlbnRzfSlgKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChub2RlLm5hbWUgPT09ICd0ZXh0YXJlYScpIHtcbiAgICAgICAgICAgICAgICAvLyBUd28gb3IgbW9yZSBsZWFkaW5nIG5ld2xpbmVzIGFyZSByZXF1aXJlZCB0byByZXN0b3JlIHRoZSBsZWFkaW5nIG5ld2xpbmUgaW1tZWRpYXRlbHkgYWZ0ZXIgYDx0ZXh0YXJlYT5gLlxuICAgICAgICAgICAgICAgIC8vIHNlZSBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNlbGVtZW50LXJlc3RyaWN0aW9uc1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlX2F0dHJpYnV0ZSA9IG5vZGUuYXR0cmlidXRlcy5maW5kKCh7IG5hbWUgfSkgPT4gbmFtZSA9PT0gJ3ZhbHVlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlX2F0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaXJzdCA9IHZhbHVlX2F0dHJpYnV0ZS5jaHVua3NbMF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdCAmJiBmaXJzdC50eXBlID09PSAnVGV4dCcgJiYgcmVnZXhfc3RhcnRzX3dpdGhfbmV3bGluZS50ZXN0KGZpcnN0LmRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5hZGRfc3RyaW5nKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9leHByZXNzaW9uKG5vZGVfY29udGVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGFkZF9jbG9zZV90YWcoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChub2RlLm5hbWUgPT09ICdwcmUnKSB7XG4gICAgICAgICAgICAvLyBUd28gb3IgbW9yZSBsZWFkaW5nIG5ld2xpbmVzIGFyZSByZXF1aXJlZCB0byByZXN0b3JlIHRoZSBsZWFkaW5nIG5ld2xpbmUgaW1tZWRpYXRlbHkgYWZ0ZXIgYDxwcmU+YC5cbiAgICAgICAgICAgIC8vIHNlZSBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9ncm91cGluZy1jb250ZW50Lmh0bWwjdGhlLXByZS1lbGVtZW50XG4gICAgICAgICAgICAvLyBzZWUgaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjZWxlbWVudC1yZXN0cmljdGlvbnNcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0ID0gY2hpbGRyZW5bMF07XG4gICAgICAgICAgICBpZiAoZmlyc3QgJiYgZmlyc3QudHlwZSA9PT0gJ1RleHQnICYmIHJlZ2V4X3N0YXJ0c193aXRoX25ld2xpbmUudGVzdChmaXJzdC5kYXRhKSkge1xuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9zdHJpbmcoJ1xcbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlLmlzX2R5bmFtaWNfZWxlbWVudClcbiAgICAgICAgICAgIHJlbmRlcmVyLnB1c2goKTtcbiAgICAgICAgcmVuZGVyZXIucmVuZGVyKGNoaWxkcmVuLCBvcHRpb25zKTtcbiAgICAgICAgaWYgKG5vZGUuaXNfZHluYW1pY19lbGVtZW50KSB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHJlbmRlcmVyLnBvcCgpO1xuICAgICAgICAgICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgQGlzX3ZvaWQoI3RhZykgPyAnJyA6ICR7Y2hpbGRyZW59YCk7XG4gICAgICAgIH1cbiAgICAgICAgYWRkX2Nsb3NlX3RhZygpO1xuICAgIH1cbiAgICBpZiAobm9kZS5pc19keW5hbWljX2VsZW1lbnQpIHtcbiAgICAgICAgbGV0IGNvbnRlbnQgPSByZW5kZXJlci5wb3AoKTtcbiAgICAgICAgaWYgKG9wdGlvbnMuZGV2ICYmIG5vZGUuY2hpbGRyZW4ubGVuZ3RoID4gMClcbiAgICAgICAgICAgIGNvbnRlbnQgPSB4IGAoKCkgPT4geyBAdmFsaWRhdGVfdm9pZF9keW5hbWljX2VsZW1lbnQoI3RhZyk7IHJldHVybiAke2NvbnRlbnR9OyB9KSgpYDtcbiAgICAgICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgKCgjdGFnKSA9PiB7XG5cdFx0XHQke29wdGlvbnMuZGV2ICYmIHggYEB2YWxpZGF0ZV9keW5hbWljX2VsZW1lbnQoI3RhZylgfVxuXHRcdFx0cmV0dXJuICN0YWcgPyAke2NvbnRlbnR9IDogJyc7XG5cdFx0fSkoJHtub2RlLnRhZ19leHByLm5vZGV9KWApO1xuICAgIH1cbiAgICBmdW5jdGlvbiBhZGRfY2xvc2VfdGFnKCkge1xuICAgICAgICBpZiAobm9kZS50YWdfZXhwci5ub2RlLnR5cGUgPT09ICdMaXRlcmFsJykge1xuICAgICAgICAgICAgaWYgKCFpc192b2lkKG5vZGUudGFnX2V4cHIubm9kZS52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZW5kZXJlci5hZGRfc3RyaW5nKCc8LycpO1xuICAgICAgICAgICAgICAgIGFkZF90YWdfbmFtZSgpO1xuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9zdHJpbmcoJz4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZW5kZXJlci5hZGRfZXhwcmVzc2lvbih4IGBAaXNfdm9pZCgjdGFnKSA/ICcnIDogXFxgPC9cXCR7I3RhZ30+XFxgYCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGFkZF90YWdfbmFtZSgpIHtcbiAgICAgICAgaWYgKG5vZGUudGFnX2V4cHIubm9kZS50eXBlID09PSAnTGl0ZXJhbCcpIHtcbiAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9zdHJpbmcobm9kZS50YWdfZXhwci5ub2RlLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9leHByZXNzaW9uKG5vZGUudGFnX2V4cHIubm9kZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIEhlYWQkMSAobm9kZSwgcmVuZGVyZXIsIG9wdGlvbnMpIHtcbiAgICBjb25zdCBoZWFkX29wdGlvbnMgPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpLCB7IGhlYWRfaWQ6IG5vZGUuaWQgfSk7XG4gICAgcmVuZGVyZXIucHVzaCgpO1xuICAgIHJlbmRlcmVyLnJlbmRlcihub2RlLmNoaWxkcmVuLCBoZWFkX29wdGlvbnMpO1xuICAgIGNvbnN0IHJlc3VsdCA9IHJlbmRlcmVyLnBvcCgpO1xuICAgIGxldCBleHByZXNzaW9uID0gcmVzdWx0O1xuICAgIGlmIChvcHRpb25zLmh5ZHJhdGFibGUpIHtcbiAgICAgICAgY29uc3Qgc3RhcnRfY29tbWVudCA9IGBIRUFEXyR7bm9kZS5pZH1fU1RBUlRgO1xuICAgICAgICBjb25zdCBlbmRfY29tbWVudCA9IGBIRUFEXyR7bm9kZS5pZH1fRU5EYDtcbiAgICAgICAgZXhwcmVzc2lvbiA9IHggYCc8IS0tICR7c3RhcnRfY29tbWVudH0gLS0+JyArICR7ZXhwcmVzc2lvbn0gKyAnPCEtLSAke2VuZF9jb21tZW50fSAtLT4nYDtcbiAgICB9XG4gICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgJCRyZXN1bHQuaGVhZCArPSAke2V4cHJlc3Npb259LCBcIlwiYCk7XG59XG5cbmZ1bmN0aW9uIEh0bWxUYWcgKG5vZGUsIHJlbmRlcmVyLCBvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMuaHlkcmF0YWJsZSlcbiAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZygnPCEtLSBIVE1MX1RBR19TVEFSVCAtLT4nKTtcbiAgICByZW5kZXJlci5hZGRfZXhwcmVzc2lvbihub2RlLmV4cHJlc3Npb24ubm9kZSk7XG4gICAgaWYgKG9wdGlvbnMuaHlkcmF0YWJsZSlcbiAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZygnPCEtLSBIVE1MX1RBR19FTkQgLS0+Jyk7XG59XG5cbmZ1bmN0aW9uIElmQmxvY2skMSAobm9kZSwgcmVuZGVyZXIsIG9wdGlvbnMpIHtcbiAgICBjb25zdCBjb25kaXRpb24gPSBub2RlLmV4cHJlc3Npb24ubm9kZTtcbiAgICByZW5kZXJlci5wdXNoKCk7XG4gICAgcmVuZGVyZXIucmVuZGVyKG5vZGUuY2hpbGRyZW4sIG9wdGlvbnMpO1xuICAgIGxldCBjb25zZXF1ZW50ID0gcmVuZGVyZXIucG9wKCk7XG4gICAgaWYgKG5vZGUuY29uc3RfdGFncy5sZW5ndGggPiAwKVxuICAgICAgICBjb25zZXF1ZW50ID0geCBgKCgpID0+IHsgJHtnZXRfY29uc3RfdGFncyQxKG5vZGUuY29uc3RfdGFncyl9OyByZXR1cm4gJHtjb25zZXF1ZW50fSB9KSgpYDtcbiAgICByZW5kZXJlci5wdXNoKCk7XG4gICAgaWYgKG5vZGUuZWxzZSlcbiAgICAgICAgcmVuZGVyZXIucmVuZGVyKG5vZGUuZWxzZS5jaGlsZHJlbiwgb3B0aW9ucyk7XG4gICAgbGV0IGFsdGVybmF0ZSA9IHJlbmRlcmVyLnBvcCgpO1xuICAgIGlmIChub2RlLmVsc2UgJiYgbm9kZS5lbHNlLmNvbnN0X3RhZ3MubGVuZ3RoID4gMClcbiAgICAgICAgYWx0ZXJuYXRlID0geCBgKCgpID0+IHsgJHtnZXRfY29uc3RfdGFncyQxKG5vZGUuZWxzZS5jb25zdF90YWdzKX07IHJldHVybiAke2FsdGVybmF0ZX0gfSkoKWA7XG4gICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgJHtjb25kaXRpb259ID8gJHtjb25zZXF1ZW50fSA6ICR7YWx0ZXJuYXRlfWApO1xufVxuXG5mdW5jdGlvbiBnZXRfcHJvcF92YWx1ZShhdHRyaWJ1dGUpIHtcbiAgICBpZiAoYXR0cmlidXRlLmlzX3RydWUpXG4gICAgICAgIHJldHVybiB4IGB0cnVlYDtcbiAgICBpZiAoYXR0cmlidXRlLmNodW5rcy5sZW5ndGggPT09IDApXG4gICAgICAgIHJldHVybiB4IGAnJ2A7XG4gICAgcmV0dXJuIGF0dHJpYnV0ZS5jaHVua3NcbiAgICAgICAgLm1hcChjaHVuayA9PiB7XG4gICAgICAgIGlmIChjaHVuay50eXBlID09PSAnVGV4dCcpXG4gICAgICAgICAgICByZXR1cm4gc3RyaW5nX2xpdGVyYWwoY2h1bmsuZGF0YSk7XG4gICAgICAgIHJldHVybiBjaHVuay5ub2RlO1xuICAgIH0pXG4gICAgICAgIC5yZWR1Y2UoKGxocywgcmhzKSA9PiB4IGAke2xoc30gKyAke3Joc31gKTtcbn1cbmZ1bmN0aW9uIElubGluZUNvbXBvbmVudCQxIChub2RlLCByZW5kZXJlciwgb3B0aW9ucykge1xuICAgIGNvbnN0IGJpbmRpbmdfcHJvcHMgPSBbXTtcbiAgICBjb25zdCBiaW5kaW5nX2ZucyA9IFtdO1xuICAgIG5vZGUuYmluZGluZ3MuZm9yRWFjaChiaW5kaW5nID0+IHtcbiAgICAgICAgcmVuZGVyZXIuaGFzX2JpbmRpbmdzID0gdHJ1ZTtcbiAgICAgICAgLy8gVE9ETyB0aGlzIHByb2JhYmx5IHdvbid0IHdvcmsgZm9yIGNvbnRleHR1YWwgYmluZGluZ3NcbiAgICAgICAgY29uc3Qgc25pcHBldCA9IGJpbmRpbmcuZXhwcmVzc2lvbi5ub2RlO1xuICAgICAgICBiaW5kaW5nX3Byb3BzLnB1c2gocCBgJHtiaW5kaW5nLm5hbWV9OiAke3NuaXBwZXR9YCk7XG4gICAgICAgIGJpbmRpbmdfZm5zLnB1c2gocCBgJHtiaW5kaW5nLm5hbWV9OiAkJHZhbHVlID0+IHsgJHtzbmlwcGV0fSA9ICQkdmFsdWU7ICQkc2V0dGxlZCA9IGZhbHNlIH1gKTtcbiAgICB9KTtcbiAgICBjb25zdCB1c2VzX3NwcmVhZCA9IG5vZGUuYXR0cmlidXRlcy5maW5kKGF0dHIgPT4gYXR0ci5pc19zcHJlYWQpO1xuICAgIGxldCBwcm9wcztcbiAgICBpZiAodXNlc19zcHJlYWQpIHtcbiAgICAgICAgcHJvcHMgPSB4IGBAX09iamVjdC5hc3NpZ24oJHtub2RlLmF0dHJpYnV0ZXNcbiAgICAgICAgICAgIC5tYXAoYXR0cmlidXRlID0+IHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUuaXNfc3ByZWFkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZS5leHByZXNzaW9uLm5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geCBgeyAke2F0dHJpYnV0ZS5uYW1lfTogJHtnZXRfcHJvcF92YWx1ZShhdHRyaWJ1dGUpfSB9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jb25jYXQoYmluZGluZ19wcm9wcy5tYXAocCA9PiB4IGB7ICR7cH0gfWApKX0pYDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHByb3BzID0geCBge1xuXHRcdFx0JHtub2RlLmF0dHJpYnV0ZXMubWFwKGF0dHJpYnV0ZSA9PiBwIGAke2F0dHJpYnV0ZS5uYW1lfTogJHtnZXRfcHJvcF92YWx1ZShhdHRyaWJ1dGUpfWApfSxcblx0XHRcdCR7YmluZGluZ19wcm9wc31cblx0XHR9YDtcbiAgICB9XG4gICAgY29uc3QgYmluZGluZ3MgPSB4IGB7XG5cdFx0JHtiaW5kaW5nX2Zuc31cblx0fWA7XG4gICAgY29uc3QgZXhwcmVzc2lvbiA9IChub2RlLm5hbWUgPT09ICdzdmVsdGU6c2VsZidcbiAgICAgICAgPyByZW5kZXJlci5uYW1lXG4gICAgICAgIDogbm9kZS5uYW1lID09PSAnc3ZlbHRlOmNvbXBvbmVudCdcbiAgICAgICAgICAgID8geCBgKCR7bm9kZS5leHByZXNzaW9uLm5vZGV9KSB8fCBAbWlzc2luZ19jb21wb25lbnRgXG4gICAgICAgICAgICA6IG5vZGUubmFtZS5zcGxpdCgnLicpLnJlZHVjZSgoKGxocywgcmhzKSA9PiB4IGAke2xoc30uJHtyaHN9YCkpKTtcbiAgICBjb25zdCBzbG90X2ZucyA9IFtdO1xuICAgIGNvbnN0IGNoaWxkcmVuID0gbm9kZS5jaGlsZHJlbjtcbiAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IHNsb3Rfc2NvcGVzID0gbmV3IE1hcCgpO1xuICAgICAgICByZW5kZXJlci5yZW5kZXIoY2hpbGRyZW4sIE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMsIHtcbiAgICAgICAgICAgIHNsb3Rfc2NvcGVzXG4gICAgICAgIH0pKTtcbiAgICAgICAgc2xvdF9zY29wZXMuZm9yRWFjaCgoeyBpbnB1dCwgb3V0cHV0LCBzdGF0ZW1lbnRzIH0sIG5hbWUpID0+IHtcbiAgICAgICAgICAgIHNsb3RfZm5zLnB1c2gocCBgJHtuYW1lfTogKCR7aW5wdXR9KSA9PiB7ICR7c3RhdGVtZW50c307IHJldHVybiAke291dHB1dH07IH1gKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHNsb3RzID0geCBge1xuXHRcdCR7c2xvdF9mbnN9XG5cdH1gO1xuICAgIGlmIChub2RlLmNzc19jdXN0b21fcHJvcGVydGllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGlmIChub2RlLm5hbWVzcGFjZSA9PT0gbmFtZXNwYWNlcy5zdmcpIHtcbiAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9zdHJpbmcoJzxnIHN0eWxlPVwiJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZW5kZXJlci5hZGRfc3RyaW5nKCc8ZGl2IHN0eWxlPVwiZGlzcGxheTogY29udGVudHM7ICcpO1xuICAgICAgICB9XG4gICAgICAgIG5vZGUuY3NzX2N1c3RvbV9wcm9wZXJ0aWVzLmZvckVhY2goKGF0dHIsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICByZW5kZXJlci5hZGRfc3RyaW5nKGAke2F0dHIubmFtZX06YCk7XG4gICAgICAgICAgICByZW5kZXJlci5hZGRfZXhwcmVzc2lvbihnZXRfYXR0cmlidXRlX3ZhbHVlKGF0dHIpKTtcbiAgICAgICAgICAgIHJlbmRlcmVyLmFkZF9zdHJpbmcoJzsnKTtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IG5vZGUuY3NzX2N1c3RvbV9wcm9wZXJ0aWVzLmxlbmd0aCAtIDEpXG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZygnICcpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZygnXCI+Jyk7XG4gICAgfVxuICAgIHJlbmRlcmVyLmFkZF9leHByZXNzaW9uKHggYEB2YWxpZGF0ZV9jb21wb25lbnQoJHtleHByZXNzaW9ufSwgXCIke25vZGUubmFtZX1cIikuJCRyZW5kZXIoJCRyZXN1bHQsICR7cHJvcHN9LCAke2JpbmRpbmdzfSwgJHtzbG90c30pYCk7XG4gICAgaWYgKG5vZGUuY3NzX2N1c3RvbV9wcm9wZXJ0aWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgaWYgKG5vZGUubmFtZXNwYWNlID09PSBuYW1lc3BhY2VzLnN2Zykge1xuICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZygnPC9nPicpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVuZGVyZXIuYWRkX3N0cmluZygnPC9kaXY+Jyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIEtleUJsb2NrJDEgKG5vZGUsIHJlbmRlcmVyLCBvcHRpb25zKSB7XG4gICAgcmVuZGVyZXIucmVuZGVyKG5vZGUuY2hpbGRyZW4sIG9wdGlvbnMpO1xufVxuXG5mdW5jdGlvbiBnZXRfc2xvdF9zY29wZShsZXRzKSB7XG4gICAgaWYgKGxldHMubGVuZ3RoID09PSAwKVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnT2JqZWN0UGF0dGVybicsXG4gICAgICAgIHByb3BlcnRpZXM6IGxldHMubWFwKGwgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnUHJvcGVydHknLFxuICAgICAgICAgICAgICAgIGtpbmQ6ICdpbml0JyxcbiAgICAgICAgICAgICAgICBtZXRob2Q6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHNob3J0aGFuZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgY29tcHV0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGtleTogbC5uYW1lLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBsLnZhbHVlIHx8IGwubmFtZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSlcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBTbG90JDEgKG5vZGUsIHJlbmRlcmVyLCBvcHRpb25zKSB7XG4gICAgY29uc3Qgc2xvdF9kYXRhID0gZ2V0X3Nsb3RfZGF0YShub2RlLnZhbHVlcyk7XG4gICAgY29uc3Qgc2xvdCA9IG5vZGUuZ2V0X3N0YXRpY19hdHRyaWJ1dGVfdmFsdWUoJ3Nsb3QnKTtcbiAgICBjb25zdCBuZWFyZXN0X2lubGluZV9jb21wb25lbnQgPSBub2RlLmZpbmRfbmVhcmVzdCgvSW5saW5lQ29tcG9uZW50Lyk7XG4gICAgaWYgKHNsb3QgJiYgbmVhcmVzdF9pbmxpbmVfY29tcG9uZW50KSB7XG4gICAgICAgIHJlbmRlcmVyLnB1c2goKTtcbiAgICB9XG4gICAgcmVuZGVyZXIucHVzaCgpO1xuICAgIHJlbmRlcmVyLnJlbmRlcihub2RlLmNoaWxkcmVuLCBvcHRpb25zKTtcbiAgICBjb25zdCByZXN1bHQgPSByZW5kZXJlci5wb3AoKTtcbiAgICByZW5kZXJlci5hZGRfZXhwcmVzc2lvbih4IGBcblx0XHQjc2xvdHMuJHtub2RlLnNsb3RfbmFtZX1cblx0XHRcdD8gI3Nsb3RzLiR7bm9kZS5zbG90X25hbWV9KCR7c2xvdF9kYXRhfSlcblx0XHRcdDogJHtyZXN1bHR9XG5cdGApO1xuICAgIGlmIChzbG90ICYmIG5lYXJlc3RfaW5saW5lX2NvbXBvbmVudCkge1xuICAgICAgICBjb25zdCBsZXRzID0gbm9kZS5sZXRzO1xuICAgICAgICBjb25zdCBzZWVuID0gbmV3IFNldChsZXRzLm1hcChsID0+IGwubmFtZS5uYW1lKSk7XG4gICAgICAgIG5lYXJlc3RfaW5saW5lX2NvbXBvbmVudC5sZXRzLmZvckVhY2gobCA9PiB7XG4gICAgICAgICAgICBpZiAoIXNlZW4uaGFzKGwubmFtZS5uYW1lKSlcbiAgICAgICAgICAgICAgICBsZXRzLnB1c2gobCk7XG4gICAgICAgIH0pO1xuICAgICAgICBvcHRpb25zLnNsb3Rfc2NvcGVzLnNldChzbG90LCB7XG4gICAgICAgICAgICBpbnB1dDogZ2V0X3Nsb3Rfc2NvcGUobm9kZS5sZXRzKSxcbiAgICAgICAgICAgIG91dHB1dDogcmVuZGVyZXIucG9wKClcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBTbG90VGVtcGxhdGUkMSAobm9kZSwgcmVuZGVyZXIsIG9wdGlvbnMpIHtcbiAgICBjb25zdCBwYXJlbnRfaW5saW5lX2NvbXBvbmVudCA9IG5vZGUucGFyZW50O1xuICAgIGNvbnN0IGNoaWxkcmVuID0gcmVtb3ZlX3doaXRlc3BhY2VfY2hpbGRyZW4obm9kZSBpbnN0YW5jZW9mIFNsb3RUZW1wbGF0ZSA/IG5vZGUuY2hpbGRyZW4gOiBbbm9kZV0sIG5vZGUubmV4dCk7XG4gICAgcmVuZGVyZXIucHVzaCgpO1xuICAgIHJlbmRlcmVyLnJlbmRlcihjaGlsZHJlbiwgb3B0aW9ucyk7XG4gICAgY29uc3QgbGV0cyA9IG5vZGUubGV0cztcbiAgICBjb25zdCBzZWVuID0gbmV3IFNldChsZXRzLm1hcChsID0+IGwubmFtZS5uYW1lKSk7XG4gICAgcGFyZW50X2lubGluZV9jb21wb25lbnQubGV0cy5mb3JFYWNoKGwgPT4ge1xuICAgICAgICBpZiAoIXNlZW4uaGFzKGwubmFtZS5uYW1lKSlcbiAgICAgICAgICAgIGxldHMucHVzaChsKTtcbiAgICB9KTtcbiAgICBjb25zdCBzbG90X2ZyYWdtZW50X2NvbnRlbnQgPSByZW5kZXJlci5wb3AoKTtcbiAgICBpZiAoIWlzX2VtcHR5X3RlbXBsYXRlX2xpdGVyYWwoc2xvdF9mcmFnbWVudF9jb250ZW50KSkge1xuICAgICAgICBpZiAob3B0aW9ucy5zbG90X3Njb3Blcy5oYXMobm9kZS5zbG90X3RlbXBsYXRlX25hbWUpKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5zbG90X3RlbXBsYXRlX25hbWUgPT09ICdkZWZhdWx0Jykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRm91bmQgZWxlbWVudHMgd2l0aG91dCBzbG90IGF0dHJpYnV0ZSB3aGVuIHVzaW5nIHNsb3Q9XCJkZWZhdWx0XCInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRHVwbGljYXRlIHNsb3QgbmFtZSBcIiR7bm9kZS5zbG90X3RlbXBsYXRlX25hbWV9XCIgaW4gPCR7cGFyZW50X2lubGluZV9jb21wb25lbnQubmFtZX0+YCk7XG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucy5zbG90X3Njb3Blcy5zZXQobm9kZS5zbG90X3RlbXBsYXRlX25hbWUsIHtcbiAgICAgICAgICAgIGlucHV0OiBnZXRfc2xvdF9zY29wZShub2RlLmxldHMpLFxuICAgICAgICAgICAgb3V0cHV0OiBzbG90X2ZyYWdtZW50X2NvbnRlbnQsXG4gICAgICAgICAgICBzdGF0ZW1lbnRzOiBnZXRfY29uc3RfdGFncyQxKG5vZGUuY29uc3RfdGFncylcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gaXNfZW1wdHlfdGVtcGxhdGVfbGl0ZXJhbCh0ZW1wbGF0ZV9saXRlcmFsKSB7XG4gICAgcmV0dXJuICh0ZW1wbGF0ZV9saXRlcmFsLmV4cHJlc3Npb25zLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgICB0ZW1wbGF0ZV9saXRlcmFsLnF1YXNpcy5sZW5ndGggPT09IDEgJiZcbiAgICAgICAgdGVtcGxhdGVfbGl0ZXJhbC5xdWFzaXNbMF0udmFsdWUucmF3ID09PSAnJyk7XG59XG5cbmZ1bmN0aW9uIFRhZyQyIChub2RlLCByZW5kZXJlciwgX29wdGlvbnMpIHtcbiAgICBjb25zdCBzbmlwcGV0ID0gbm9kZS5leHByZXNzaW9uLm5vZGU7XG4gICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24obm9kZS5wYXJlbnQgJiZcbiAgICAgICAgbm9kZS5wYXJlbnQudHlwZSA9PT0gJ0VsZW1lbnQnICYmXG4gICAgICAgIG5vZGUucGFyZW50Lm5hbWUgPT09ICdzdHlsZSdcbiAgICAgICAgPyBzbmlwcGV0XG4gICAgICAgIDogeCBgQGVzY2FwZSgke3NuaXBwZXR9KWApO1xufVxuXG5mdW5jdGlvbiBUZXh0JDEgKG5vZGUsIHJlbmRlcmVyLCBfb3B0aW9ucykge1xuICAgIGxldCB0ZXh0ID0gbm9kZS5kYXRhO1xuICAgIGlmICghbm9kZS5wYXJlbnQgfHxcbiAgICAgICAgbm9kZS5wYXJlbnQudHlwZSAhPT0gJ0VsZW1lbnQnIHx8XG4gICAgICAgIChub2RlLnBhcmVudC5uYW1lICE9PSAnc2NyaXB0JyAmJiBub2RlLnBhcmVudC5uYW1lICE9PSAnc3R5bGUnKSkge1xuICAgICAgICAvLyB1bmxlc3MgdGhpcyBUZXh0IG5vZGUgaXMgaW5zaWRlIGEgPHNjcmlwdD4gb3IgPHN0eWxlPiBlbGVtZW50LCBlc2NhcGUgJiw8LD5cbiAgICAgICAgdGV4dCA9IGVzY2FwZV9odG1sKHRleHQpO1xuICAgIH1cbiAgICByZW5kZXJlci5hZGRfc3RyaW5nKHRleHQpO1xufVxuXG5mdW5jdGlvbiBUaXRsZSQxIChub2RlLCByZW5kZXJlciwgb3B0aW9ucykge1xuICAgIHJlbmRlcmVyLnB1c2goKTtcbiAgICByZW5kZXJlci5hZGRfc3RyaW5nKCc8dGl0bGU+Jyk7XG4gICAgcmVuZGVyZXIucmVuZGVyKG5vZGUuY2hpbGRyZW4sIG9wdGlvbnMpO1xuICAgIHJlbmRlcmVyLmFkZF9zdHJpbmcoJzwvdGl0bGU+Jyk7XG4gICAgY29uc3QgcmVzdWx0ID0gcmVuZGVyZXIucG9wKCk7XG4gICAgcmVuZGVyZXIuYWRkX2V4cHJlc3Npb24oeCBgJCRyZXN1bHQudGl0bGUgPSAke3Jlc3VsdH0sIFwiXCJgKTtcbn1cblxuZnVuY3Rpb24gbm9vcCQxKCkgeyB9XG5jb25zdCBoYW5kbGVycyQxID0ge1xuICAgIEF3YWl0QmxvY2s6IEF3YWl0QmxvY2skMSxcbiAgICBCb2R5OiBub29wJDEsXG4gICAgQ29tbWVudDogQ29tbWVudCQyLFxuICAgIERlYnVnVGFnOiBEZWJ1Z1RhZyQxLFxuICAgIEVhY2hCbG9jazogRWFjaEJsb2NrJDEsXG4gICAgRWxlbWVudDogRWxlbWVudCQxLFxuICAgIEhlYWQ6IEhlYWQkMSxcbiAgICBJZkJsb2NrOiBJZkJsb2NrJDEsXG4gICAgSW5saW5lQ29tcG9uZW50OiBJbmxpbmVDb21wb25lbnQkMSxcbiAgICBLZXlCbG9jazogS2V5QmxvY2skMSxcbiAgICBNdXN0YWNoZVRhZzogVGFnJDIsXG4gICAgT3B0aW9uczogbm9vcCQxLFxuICAgIFJhd011c3RhY2hlVGFnOiBIdG1sVGFnLFxuICAgIFNsb3Q6IFNsb3QkMSxcbiAgICBTbG90VGVtcGxhdGU6IFNsb3RUZW1wbGF0ZSQxLFxuICAgIFRleHQ6IFRleHQkMSxcbiAgICBUaXRsZTogVGl0bGUkMSxcbiAgICBXaW5kb3c6IG5vb3AkMVxufTtcbmNsYXNzIFJlbmRlcmVyJDEge1xuICAgIGNvbnN0cnVjdG9yKHsgbmFtZSB9KSB7XG4gICAgICAgIHRoaXMuaGFzX2JpbmRpbmdzID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3RhY2sgPSBbXTtcbiAgICAgICAgdGhpcy50YXJnZXRzID0gW107XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMucHVzaCgpO1xuICAgIH1cbiAgICBhZGRfc3RyaW5nKHN0cikge1xuICAgICAgICB0aGlzLmN1cnJlbnQudmFsdWUgKz0gZXNjYXBlX3RlbXBsYXRlKHN0cik7XG4gICAgfVxuICAgIGFkZF9leHByZXNzaW9uKG5vZGUpIHtcbiAgICAgICAgdGhpcy5saXRlcmFsLnF1YXNpcy5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdUZW1wbGF0ZUVsZW1lbnQnLFxuICAgICAgICAgICAgdmFsdWU6IHsgcmF3OiB0aGlzLmN1cnJlbnQudmFsdWUsIGNvb2tlZDogbnVsbCB9LFxuICAgICAgICAgICAgdGFpbDogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGl0ZXJhbC5leHByZXNzaW9ucy5wdXNoKG5vZGUpO1xuICAgICAgICB0aGlzLmN1cnJlbnQudmFsdWUgPSAnJztcbiAgICB9XG4gICAgcHVzaCgpIHtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMuY3VycmVudCA9IHsgdmFsdWU6ICcnIH07XG4gICAgICAgIGNvbnN0IGxpdGVyYWwgPSB0aGlzLmxpdGVyYWwgPSB7XG4gICAgICAgICAgICB0eXBlOiAnVGVtcGxhdGVMaXRlcmFsJyxcbiAgICAgICAgICAgIGV4cHJlc3Npb25zOiBbXSxcbiAgICAgICAgICAgIHF1YXNpczogW11cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zdGFjay5wdXNoKHsgY3VycmVudCwgbGl0ZXJhbCB9KTtcbiAgICB9XG4gICAgcG9wKCkge1xuICAgICAgICB0aGlzLmxpdGVyYWwucXVhc2lzLnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ1RlbXBsYXRlRWxlbWVudCcsXG4gICAgICAgICAgICB2YWx1ZTogeyByYXc6IHRoaXMuY3VycmVudC52YWx1ZSwgY29va2VkOiBudWxsIH0sXG4gICAgICAgICAgICB0YWlsOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwb3BwZWQgPSB0aGlzLnN0YWNrLnBvcCgpO1xuICAgICAgICBjb25zdCBsYXN0ID0gdGhpcy5zdGFja1t0aGlzLnN0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICBpZiAobGFzdCkge1xuICAgICAgICAgICAgdGhpcy5saXRlcmFsID0gbGFzdC5saXRlcmFsO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gbGFzdC5jdXJyZW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwb3BwZWQubGl0ZXJhbDtcbiAgICB9XG4gICAgcmVuZGVyKG5vZGVzLCBvcHRpb25zKSB7XG4gICAgICAgIG5vZGVzLmZvckVhY2gobm9kZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoYW5kbGVyID0gaGFuZGxlcnMkMVtub2RlLnR5cGVdO1xuICAgICAgICAgICAgaWYgKCFoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBoYW5kbGVyIGZvciAnJHtub2RlLnR5cGV9JyBub2Rlc2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGFuZGxlcihub2RlLCB0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzc3IoY29tcG9uZW50LCBvcHRpb25zKSB7XG4gICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgUmVuZGVyZXIkMSh7XG4gICAgICAgIG5hbWU6IGNvbXBvbmVudC5uYW1lXG4gICAgfSk7XG4gICAgY29uc3QgeyBuYW1lIH0gPSBjb21wb25lbnQ7XG4gICAgLy8gY3JlYXRlICQkcmVuZGVyIGZ1bmN0aW9uXG4gICAgcmVuZGVyZXIucmVuZGVyKHRyaW0oY29tcG9uZW50LmZyYWdtZW50LmNoaWxkcmVuKSwgT2JqZWN0LmFzc2lnbih7XG4gICAgICAgIGxvY2F0ZTogY29tcG9uZW50LmxvY2F0ZVxuICAgIH0sIG9wdGlvbnMpKTtcbiAgICAvLyBUT0RPIHB1dCB0aGlzIGluc2lkZSB0aGUgUmVuZGVyZXIgY2xhc3NcbiAgICBjb25zdCBsaXRlcmFsID0gcmVuZGVyZXIucG9wKCk7XG4gICAgLy8gVE9ETyBjb25jYXRlbmF0ZSBDU1MgbWFwc1xuICAgIGNvbnN0IGNzcyA9IG9wdGlvbnMuY3VzdG9tRWxlbWVudCA/XG4gICAgICAgIHsgY29kZTogbnVsbCwgbWFwOiBudWxsIH0gOlxuICAgICAgICBjb21wb25lbnQuc3R5bGVzaGVldC5yZW5kZXIob3B0aW9ucy5maWxlbmFtZSwgdHJ1ZSk7XG4gICAgY29uc3QgdXNlc19yZXN0ID0gY29tcG9uZW50LnZhcl9sb29rdXAuaGFzKCckJHJlc3RQcm9wcycpO1xuICAgIGNvbnN0IHByb3BzID0gY29tcG9uZW50LnZhcnMuZmlsdGVyKHZhcmlhYmxlID0+ICF2YXJpYWJsZS5tb2R1bGUgJiYgdmFyaWFibGUuZXhwb3J0X25hbWUpO1xuICAgIGNvbnN0IHJlc3QgPSB1c2VzX3Jlc3QgPyBiIGBsZXQgJCRyZXN0UHJvcHMgPSBAY29tcHV0ZV9yZXN0X3Byb3BzKCQkcHJvcHMsIFske3Byb3BzLm1hcChwcm9wID0+IGBcIiR7cHJvcC5leHBvcnRfbmFtZX1cImApLmpvaW4oJywnKX1dKTtgIDogbnVsbDtcbiAgICBjb25zdCB1c2VzX3Nsb3RzID0gY29tcG9uZW50LnZhcl9sb29rdXAuaGFzKCckJHNsb3RzJyk7XG4gICAgY29uc3Qgc2xvdHMgPSB1c2VzX3Nsb3RzID8gYiBgbGV0ICQkc2xvdHMgPSBAY29tcHV0ZV9zbG90cygjc2xvdHMpO2AgOiBudWxsO1xuICAgIGNvbnN0IHJlYWN0aXZlX3N0b3JlcyA9IGNvbXBvbmVudC52YXJzLmZpbHRlcih2YXJpYWJsZSA9PiB2YXJpYWJsZS5uYW1lWzBdID09PSAnJCcgJiYgdmFyaWFibGUubmFtZVsxXSAhPT0gJyQnKTtcbiAgICBjb25zdCByZWFjdGl2ZV9zdG9yZV9zdWJzY3JpcHRpb25zID0gcmVhY3RpdmVfc3RvcmVzXG4gICAgICAgIC5maWx0ZXIoc3RvcmUgPT4ge1xuICAgICAgICBjb25zdCB2YXJpYWJsZSA9IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChzdG9yZS5uYW1lLnNsaWNlKDEpKTtcbiAgICAgICAgcmV0dXJuICF2YXJpYWJsZSB8fCB2YXJpYWJsZS5ob2lzdGFibGU7XG4gICAgfSlcbiAgICAgICAgLm1hcCgoeyBuYW1lIH0pID0+IHtcbiAgICAgICAgY29uc3Qgc3RvcmVfbmFtZSA9IG5hbWUuc2xpY2UoMSk7XG4gICAgICAgIHJldHVybiBiIGBcblx0XHRcdFx0JHtjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmRldiAmJiBiIGBAdmFsaWRhdGVfc3RvcmUoJHtzdG9yZV9uYW1lfSwgJyR7c3RvcmVfbmFtZX0nKTtgfVxuXHRcdFx0XHQke2AkJHVuc3Vic2NyaWJlXyR7c3RvcmVfbmFtZX1gfSA9IEBzdWJzY3JpYmUoJHtzdG9yZV9uYW1lfSwgI3ZhbHVlID0+ICR7bmFtZX0gPSAjdmFsdWUpXG5cdFx0XHRgO1xuICAgIH0pO1xuICAgIGNvbnN0IHJlYWN0aXZlX3N0b3JlX3Vuc3Vic2NyaXB0aW9ucyA9IHJlYWN0aXZlX3N0b3Jlcy5tYXAoKHsgbmFtZSB9KSA9PiBiIGAke2AkJHVuc3Vic2NyaWJlXyR7bmFtZS5zbGljZSgxKX1gfSgpYCk7XG4gICAgY29uc3QgcmVhY3RpdmVfc3RvcmVfZGVjbGFyYXRpb25zID0gcmVhY3RpdmVfc3RvcmVzXG4gICAgICAgIC5tYXAoKHsgbmFtZSB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHN0b3JlX25hbWUgPSBuYW1lLnNsaWNlKDEpO1xuICAgICAgICBjb25zdCBzdG9yZSA9IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChzdG9yZV9uYW1lKTtcbiAgICAgICAgaWYgKHN0b3JlICYmIHN0b3JlLnJlYXNzaWduZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gYCQkdW5zdWJzY3JpYmVfJHtzdG9yZV9uYW1lfWA7XG4gICAgICAgICAgICBjb25zdCBzdWJzY3JpYmUgPSBgJCRzdWJzY3JpYmVfJHtzdG9yZV9uYW1lfWA7XG4gICAgICAgICAgICByZXR1cm4gYiBgbGV0ICR7bmFtZX0sICR7dW5zdWJzY3JpYmV9ID0gQG5vb3AsICR7c3Vic2NyaWJlfSA9ICgpID0+ICgke3Vuc3Vic2NyaWJlfSgpLCAke3Vuc3Vic2NyaWJlfSA9IEBzdWJzY3JpYmUoJHtzdG9yZV9uYW1lfSwgJCR2YWx1ZSA9PiAke25hbWV9ID0gJCR2YWx1ZSksICR7c3RvcmVfbmFtZX0pYDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYiBgbGV0ICR7bmFtZX0sICR7YCQkdW5zdWJzY3JpYmVfJHtzdG9yZV9uYW1lfWB9O2A7XG4gICAgfSk7XG4gICAgLy8gaW5zdHJ1bWVudCBnZXQvc2V0IHN0b3JlIHZhbHVlXG4gICAgaWYgKGNvbXBvbmVudC5hc3QuaW5zdGFuY2UpIHtcbiAgICAgICAgbGV0IHNjb3BlID0gY29tcG9uZW50Lmluc3RhbmNlX3Njb3BlO1xuICAgICAgICBjb25zdCBtYXAgPSBjb21wb25lbnQuaW5zdGFuY2Vfc2NvcGVfbWFwO1xuICAgICAgICB3YWxrKGNvbXBvbmVudC5hc3QuaW5zdGFuY2UuY29udGVudCwge1xuICAgICAgICAgICAgZW50ZXIobm9kZSkge1xuICAgICAgICAgICAgICAgIGlmIChtYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlID0gbWFwLmdldChub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGVhdmUobm9kZSkge1xuICAgICAgICAgICAgICAgIGlmIChtYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlID0gc2NvcGUucGFyZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnQXNzaWdubWVudEV4cHJlc3Npb24nIHx8IG5vZGUudHlwZSA9PT0gJ1VwZGF0ZUV4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFzc2lnbmVlID0gbm9kZS50eXBlID09PSAnQXNzaWdubWVudEV4cHJlc3Npb24nID8gbm9kZS5sZWZ0IDogbm9kZS5hcmd1bWVudDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZXMgPSBuZXcgU2V0KGV4dHJhY3RfbmFtZXMoYXNzaWduZWUpKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9faW52YWxpZGF0ZSA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIG5hbWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YXJpYWJsZSA9IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF2YXJpYWJsZS5ob2lzdGFibGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdmFyaWFibGUuZ2xvYmFsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXZhcmlhYmxlLm1vZHVsZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh2YXJpYWJsZS5zdWJzY3JpYmFibGUgfHwgdmFyaWFibGUubmFtZVswXSA9PT0gJyQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvX2ludmFsaWRhdGUuYWRkKHZhcmlhYmxlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b19pbnZhbGlkYXRlLnNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZShpbnZhbGlkYXRlKHsgY29tcG9uZW50IH0sIHNjb3BlLCBub2RlLCB0b19pbnZhbGlkYXRlLCB0cnVlKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjb21wb25lbnQucmV3cml0ZV9wcm9wcygoeyBuYW1lLCByZWFzc2lnbmVkIH0pID0+IHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBgJCR7bmFtZX1gO1xuICAgICAgICBsZXQgaW5zZXJ0ID0gcmVhc3NpZ25lZFxuICAgICAgICAgICAgPyBiIGAke2AkJHN1YnNjcmliZV8ke25hbWV9YH0oKWBcbiAgICAgICAgICAgIDogYiBgJHtgJCR1bnN1YnNjcmliZV8ke25hbWV9YH0gPSBAc3Vic2NyaWJlKCR7bmFtZX0sICN2YWx1ZSA9PiAkJHt2YWx1ZX0gPSAjdmFsdWUpYDtcbiAgICAgICAgaWYgKGNvbXBvbmVudC5jb21waWxlX29wdGlvbnMuZGV2KSB7XG4gICAgICAgICAgICBpbnNlcnQgPSBiIGBAdmFsaWRhdGVfc3RvcmUoJHtuYW1lfSwgJyR7bmFtZX0nKTsgJHtpbnNlcnR9YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5zZXJ0O1xuICAgIH0pO1xuICAgIGNvbnN0IGluc3RhbmNlX2phdmFzY3JpcHQgPSBjb21wb25lbnQuZXh0cmFjdF9qYXZhc2NyaXB0KGNvbXBvbmVudC5hc3QuaW5zdGFuY2UpO1xuICAgIC8vIFRPRE8gb25seSBkbyB0aGlzIGZvciBwcm9wcyB3aXRoIGEgZGVmYXVsdCB2YWx1ZVxuICAgIGNvbnN0IHBhcmVudF9iaW5kaW5ncyA9IGluc3RhbmNlX2phdmFzY3JpcHRcbiAgICAgICAgPyBjb21wb25lbnQudmFyc1xuICAgICAgICAgICAgLmZpbHRlcih2YXJpYWJsZSA9PiAhdmFyaWFibGUubW9kdWxlICYmIHZhcmlhYmxlLmV4cG9ydF9uYW1lKVxuICAgICAgICAgICAgLm1hcChwcm9wID0+IHtcbiAgICAgICAgICAgIHJldHVybiBiIGBpZiAoJCRwcm9wcy4ke3Byb3AuZXhwb3J0X25hbWV9ID09PSB2b2lkIDAgJiYgJCRiaW5kaW5ncy4ke3Byb3AuZXhwb3J0X25hbWV9ICYmICR7cHJvcC5uYW1lfSAhPT0gdm9pZCAwKSAkJGJpbmRpbmdzLiR7cHJvcC5leHBvcnRfbmFtZX0oJHtwcm9wLm5hbWV9KTtgO1xuICAgICAgICB9KVxuICAgICAgICA6IFtdO1xuICAgIGNvbnN0IGluamVjdGVkID0gQXJyYXkuZnJvbShjb21wb25lbnQuaW5qZWN0ZWRfcmVhY3RpdmVfZGVjbGFyYXRpb25fdmFycykuZmlsdGVyKG5hbWUgPT4ge1xuICAgICAgICBjb25zdCB2YXJpYWJsZSA9IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChuYW1lKTtcbiAgICAgICAgcmV0dXJuIHZhcmlhYmxlLmluamVjdGVkO1xuICAgIH0pO1xuICAgIGNvbnN0IHJlYWN0aXZlX2RlY2xhcmF0aW9ucyA9IGNvbXBvbmVudC5yZWFjdGl2ZV9kZWNsYXJhdGlvbnMubWFwKGQgPT4ge1xuICAgICAgICBjb25zdCBib2R5ID0gZC5ub2RlLmJvZHk7XG4gICAgICAgIGxldCBzdGF0ZW1lbnQgPSBiIGAke2JvZHl9YDtcbiAgICAgICAgaWYgKCFkLmRlY2xhcmF0aW9uKSB7IC8vIFRPRE8gZG8gbm90IGFkZCBsYWJlbCBpZiBpdCdzIG5vdCByZWZlcmVuY2VkXG4gICAgICAgICAgICBzdGF0ZW1lbnQgPSBiIGAkOiB7ICR7c3RhdGVtZW50fSB9YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RhdGVtZW50O1xuICAgIH0pO1xuICAgIGNvbnN0IG1haW4gPSByZW5kZXJlci5oYXNfYmluZGluZ3NcbiAgICAgICAgPyBiIGBcblx0XHRcdGxldCAkJHNldHRsZWQ7XG5cdFx0XHRsZXQgJCRyZW5kZXJlZDtcblxuXHRcdFx0ZG8ge1xuXHRcdFx0XHQkJHNldHRsZWQgPSB0cnVlO1xuXG5cdFx0XHRcdCR7cmVhY3RpdmVfZGVjbGFyYXRpb25zfVxuXG5cdFx0XHRcdCQkcmVuZGVyZWQgPSAke2xpdGVyYWx9O1xuXHRcdFx0fSB3aGlsZSAoISQkc2V0dGxlZCk7XG5cblx0XHRcdCR7cmVhY3RpdmVfc3RvcmVfdW5zdWJzY3JpcHRpb25zfVxuXG5cdFx0XHRyZXR1cm4gJCRyZW5kZXJlZDtcblx0XHRgXG4gICAgICAgIDogYiBgXG5cdFx0XHQke3JlYWN0aXZlX2RlY2xhcmF0aW9uc31cblxuXHRcdFx0JHtyZWFjdGl2ZV9zdG9yZV91bnN1YnNjcmlwdGlvbnN9XG5cblx0XHRcdHJldHVybiAke2xpdGVyYWx9O2A7XG4gICAgY29uc3QgYmxvY2tzID0gW1xuICAgICAgICAuLi5pbmplY3RlZC5tYXAobmFtZSA9PiBiIGBsZXQgJHtuYW1lfTtgKSxcbiAgICAgICAgcmVzdCxcbiAgICAgICAgc2xvdHMsXG4gICAgICAgIC4uLnJlYWN0aXZlX3N0b3JlX2RlY2xhcmF0aW9ucyxcbiAgICAgICAgLi4ucmVhY3RpdmVfc3RvcmVfc3Vic2NyaXB0aW9ucyxcbiAgICAgICAgaW5zdGFuY2VfamF2YXNjcmlwdCxcbiAgICAgICAgLi4ucGFyZW50X2JpbmRpbmdzLFxuICAgICAgICBjc3MuY29kZSAmJiBiIGAkJHJlc3VsdC5jc3MuYWRkKCNjc3MpO2AsXG4gICAgICAgIG1haW5cbiAgICBdLmZpbHRlcihCb29sZWFuKTtcbiAgICBjb25zdCBjc3Nfc291cmNlbWFwX2VuYWJsZWQgPSBjaGVja19lbmFibGVfc291cmNlbWFwKG9wdGlvbnMuZW5hYmxlU291cmNlbWFwLCAnY3NzJyk7XG4gICAgY29uc3QganMgPSBiIGBcblx0XHQke2Nzcy5jb2RlID8gYiBgXG5cdFx0Y29uc3QgI2NzcyA9IHtcblx0XHRcdGNvZGU6IFwiJHtjc3MuY29kZX1cIixcblx0XHRcdG1hcDogJHtjc3Nfc291cmNlbWFwX2VuYWJsZWQgJiYgY3NzLm1hcCA/IHN0cmluZ19saXRlcmFsKGNzcy5tYXAudG9TdHJpbmcoKSkgOiAnbnVsbCd9XG5cdFx0fTtgIDogbnVsbH1cblxuXHRcdCR7Y29tcG9uZW50LmV4dHJhY3RfamF2YXNjcmlwdChjb21wb25lbnQuYXN0Lm1vZHVsZSl9XG5cblx0XHQke2NvbXBvbmVudC5mdWxseV9ob2lzdGVkfVxuXG5cdFx0Y29uc3QgJHtuYW1lfSA9IEBjcmVhdGVfc3NyX2NvbXBvbmVudCgoJCRyZXN1bHQsICQkcHJvcHMsICQkYmluZGluZ3MsICNzbG90cykgPT4ge1xuXHRcdFx0JHtibG9ja3N9XG5cdFx0fSk7XG5cdGA7XG4gICAgcmV0dXJuIHsganMsIGNzcyB9O1xufVxuZnVuY3Rpb24gdHJpbShub2Rlcykge1xuICAgIGxldCBzdGFydCA9IDA7XG4gICAgZm9yICg7IHN0YXJ0IDwgbm9kZXMubGVuZ3RoOyBzdGFydCArPSAxKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tzdGFydF07XG4gICAgICAgIGlmIChub2RlLnR5cGUgIT09ICdUZXh0JylcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBub2RlLmRhdGEgPSBub2RlLmRhdGEucmVwbGFjZSgvXlxccysvLCAnJyk7XG4gICAgICAgIGlmIChub2RlLmRhdGEpXG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgbGV0IGVuZCA9IG5vZGVzLmxlbmd0aDtcbiAgICBmb3IgKDsgZW5kID4gc3RhcnQ7IGVuZCAtPSAxKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tlbmQgLSAxXTtcbiAgICAgICAgaWYgKG5vZGUudHlwZSAhPT0gJ1RleHQnKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIG5vZGUuZGF0YSA9IG5vZGUuZGF0YS50cmltUmlnaHQoKTtcbiAgICAgICAgaWYgKG5vZGUuZGF0YSlcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZXMuc2xpY2Uoc3RhcnQsIGVuZCk7XG59XG5cbi8qKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5UaGlzIGZpbGUgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgYHNjcmlwdHMvZ2xvYmFscy1leHRyYWN0b3IubWpzYC5cbkdlbmVyYXRlZCBBdDogMjAyMi0wOS0wM1QxNToyMjozNy40MTVaXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgZ2xvYmFscyA9IG5ldyBTZXQoW1xuICAgICdBYm9ydENvbnRyb2xsZXInLFxuICAgICdBYm9ydFNpZ25hbCcsXG4gICAgJ0Fic3RyYWN0UmFuZ2UnLFxuICAgICdBY3RpdmVYT2JqZWN0JyxcbiAgICAnQWdncmVnYXRlRXJyb3InLFxuICAgICdBbmFseXNlck5vZGUnLFxuICAgICdBbmltYXRpb24nLFxuICAgICdBbmltYXRpb25FZmZlY3QnLFxuICAgICdBbmltYXRpb25FdmVudCcsXG4gICAgJ0FuaW1hdGlvblBsYXliYWNrRXZlbnQnLFxuICAgICdBbmltYXRpb25UaW1lbGluZScsXG4gICAgJ0FycmF5JyxcbiAgICAnQXJyYXlCdWZmZXInLFxuICAgICdBdG9taWNzJyxcbiAgICAnQXR0cicsXG4gICAgJ0F1ZGlvJyxcbiAgICAnQXVkaW9CdWZmZXInLFxuICAgICdBdWRpb0J1ZmZlclNvdXJjZU5vZGUnLFxuICAgICdBdWRpb0NvbnRleHQnLFxuICAgICdBdWRpb0Rlc3RpbmF0aW9uTm9kZScsXG4gICAgJ0F1ZGlvTGlzdGVuZXInLFxuICAgICdBdWRpb05vZGUnLFxuICAgICdBdWRpb1BhcmFtJyxcbiAgICAnQXVkaW9QYXJhbU1hcCcsXG4gICAgJ0F1ZGlvUHJvY2Vzc2luZ0V2ZW50JyxcbiAgICAnQXVkaW9TY2hlZHVsZWRTb3VyY2VOb2RlJyxcbiAgICAnQXVkaW9Xb3JrbGV0JyxcbiAgICAnQXVkaW9Xb3JrbGV0Tm9kZScsXG4gICAgJ0F1dGhlbnRpY2F0b3JBc3NlcnRpb25SZXNwb25zZScsXG4gICAgJ0F1dGhlbnRpY2F0b3JBdHRlc3RhdGlvblJlc3BvbnNlJyxcbiAgICAnQXV0aGVudGljYXRvclJlc3BvbnNlJyxcbiAgICAnQmFyUHJvcCcsXG4gICAgJ0Jhc2VBdWRpb0NvbnRleHQnLFxuICAgICdCZWZvcmVVbmxvYWRFdmVudCcsXG4gICAgJ0JpZ0ludCcsXG4gICAgJ0JpZ0ludDY0QXJyYXknLFxuICAgICdCaWdVaW50NjRBcnJheScsXG4gICAgJ0JpcXVhZEZpbHRlck5vZGUnLFxuICAgICdCbG9iJyxcbiAgICAnQmxvYkV2ZW50JyxcbiAgICAnQm9vbGVhbicsXG4gICAgJ0Jyb2FkY2FzdENoYW5uZWwnLFxuICAgICdCeXRlTGVuZ3RoUXVldWluZ1N0cmF0ZWd5JyxcbiAgICAnQ0RBVEFTZWN0aW9uJyxcbiAgICAnQ1NTJyxcbiAgICAnQ1NTQW5pbWF0aW9uJyxcbiAgICAnQ1NTQ29uZGl0aW9uUnVsZScsXG4gICAgJ0NTU0NvdW50ZXJTdHlsZVJ1bGUnLFxuICAgICdDU1NGb250RmFjZVJ1bGUnLFxuICAgICdDU1NHcm91cGluZ1J1bGUnLFxuICAgICdDU1NJbXBvcnRSdWxlJyxcbiAgICAnQ1NTS2V5ZnJhbWVSdWxlJyxcbiAgICAnQ1NTS2V5ZnJhbWVzUnVsZScsXG4gICAgJ0NTU01lZGlhUnVsZScsXG4gICAgJ0NTU05hbWVzcGFjZVJ1bGUnLFxuICAgICdDU1NQYWdlUnVsZScsXG4gICAgJ0NTU1J1bGUnLFxuICAgICdDU1NSdWxlTGlzdCcsXG4gICAgJ0NTU1N0eWxlRGVjbGFyYXRpb24nLFxuICAgICdDU1NTdHlsZVJ1bGUnLFxuICAgICdDU1NTdHlsZVNoZWV0JyxcbiAgICAnQ1NTU3VwcG9ydHNSdWxlJyxcbiAgICAnQ1NTVHJhbnNpdGlvbicsXG4gICAgJ0NhY2hlJyxcbiAgICAnQ2FjaGVTdG9yYWdlJyxcbiAgICAnQ2FudmFzQ2FwdHVyZU1lZGlhU3RyZWFtVHJhY2snLFxuICAgICdDYW52YXNHcmFkaWVudCcsXG4gICAgJ0NhbnZhc1BhdHRlcm4nLFxuICAgICdDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQnLFxuICAgICdDaGFubmVsTWVyZ2VyTm9kZScsXG4gICAgJ0NoYW5uZWxTcGxpdHRlck5vZGUnLFxuICAgICdDaGFyYWN0ZXJEYXRhJyxcbiAgICAnQ2xpZW50UmVjdCcsXG4gICAgJ0NsaXBib2FyZCcsXG4gICAgJ0NsaXBib2FyZEV2ZW50JyxcbiAgICAnQ2xpcGJvYXJkSXRlbScsXG4gICAgJ0Nsb3NlRXZlbnQnLFxuICAgICdDb21tZW50JyxcbiAgICAnQ29tcG9zaXRpb25FdmVudCcsXG4gICAgJ0NvbnN0YW50U291cmNlTm9kZScsXG4gICAgJ0NvbnZvbHZlck5vZGUnLFxuICAgICdDb3VudFF1ZXVpbmdTdHJhdGVneScsXG4gICAgJ0NyZWRlbnRpYWwnLFxuICAgICdDcmVkZW50aWFsc0NvbnRhaW5lcicsXG4gICAgJ0NyeXB0bycsXG4gICAgJ0NyeXB0b0tleScsXG4gICAgJ0N1c3RvbUVsZW1lbnRSZWdpc3RyeScsXG4gICAgJ0N1c3RvbUV2ZW50JyxcbiAgICAnRE9NRXhjZXB0aW9uJyxcbiAgICAnRE9NSW1wbGVtZW50YXRpb24nLFxuICAgICdET01NYXRyaXgnLFxuICAgICdET01NYXRyaXhSZWFkT25seScsXG4gICAgJ0RPTVBhcnNlcicsXG4gICAgJ0RPTVBvaW50JyxcbiAgICAnRE9NUG9pbnRSZWFkT25seScsXG4gICAgJ0RPTVF1YWQnLFxuICAgICdET01SZWN0JyxcbiAgICAnRE9NUmVjdExpc3QnLFxuICAgICdET01SZWN0UmVhZE9ubHknLFxuICAgICdET01TdHJpbmdMaXN0JyxcbiAgICAnRE9NU3RyaW5nTWFwJyxcbiAgICAnRE9NVG9rZW5MaXN0JyxcbiAgICAnRGF0YVRyYW5zZmVyJyxcbiAgICAnRGF0YVRyYW5zZmVySXRlbScsXG4gICAgJ0RhdGFUcmFuc2Zlckl0ZW1MaXN0JyxcbiAgICAnRGF0YVZpZXcnLFxuICAgICdEYXRlJyxcbiAgICAnRGVsYXlOb2RlJyxcbiAgICAnRGV2aWNlTW90aW9uRXZlbnQnLFxuICAgICdEZXZpY2VPcmllbnRhdGlvbkV2ZW50JyxcbiAgICAnRG9jdW1lbnQnLFxuICAgICdEb2N1bWVudEZyYWdtZW50JyxcbiAgICAnRG9jdW1lbnRUaW1lbGluZScsXG4gICAgJ0RvY3VtZW50VHlwZScsXG4gICAgJ0RyYWdFdmVudCcsXG4gICAgJ0R5bmFtaWNzQ29tcHJlc3Nvck5vZGUnLFxuICAgICdFbGVtZW50JyxcbiAgICAnRWxlbWVudEludGVybmFscycsXG4gICAgJ0VudW1lcmF0b3InLFxuICAgICdFcnJvcicsXG4gICAgJ0Vycm9yRXZlbnQnLFxuICAgICdFdmFsRXJyb3InLFxuICAgICdFdmVudCcsXG4gICAgJ0V2ZW50Q291bnRzJyxcbiAgICAnRXZlbnRTb3VyY2UnLFxuICAgICdFdmVudFRhcmdldCcsXG4gICAgJ0V4dGVybmFsJyxcbiAgICAnRmlsZScsXG4gICAgJ0ZpbGVMaXN0JyxcbiAgICAnRmlsZVJlYWRlcicsXG4gICAgJ0ZpbGVTeXN0ZW0nLFxuICAgICdGaWxlU3lzdGVtRGlyZWN0b3J5RW50cnknLFxuICAgICdGaWxlU3lzdGVtRGlyZWN0b3J5SGFuZGxlJyxcbiAgICAnRmlsZVN5c3RlbURpcmVjdG9yeVJlYWRlcicsXG4gICAgJ0ZpbGVTeXN0ZW1FbnRyeScsXG4gICAgJ0ZpbGVTeXN0ZW1GaWxlRW50cnknLFxuICAgICdGaWxlU3lzdGVtRmlsZUhhbmRsZScsXG4gICAgJ0ZpbGVTeXN0ZW1IYW5kbGUnLFxuICAgICdGaW5hbGl6YXRpb25SZWdpc3RyeScsXG4gICAgJ0Zsb2F0MzJBcnJheScsXG4gICAgJ0Zsb2F0NjRBcnJheScsXG4gICAgJ0ZvY3VzRXZlbnQnLFxuICAgICdGb250RmFjZScsXG4gICAgJ0ZvbnRGYWNlU2V0JyxcbiAgICAnRm9udEZhY2VTZXRMb2FkRXZlbnQnLFxuICAgICdGb3JtRGF0YScsXG4gICAgJ0Zvcm1EYXRhRXZlbnQnLFxuICAgICdGdW5jdGlvbicsXG4gICAgJ0dhaW5Ob2RlJyxcbiAgICAnR2FtZXBhZCcsXG4gICAgJ0dhbWVwYWRCdXR0b24nLFxuICAgICdHYW1lcGFkRXZlbnQnLFxuICAgICdHYW1lcGFkSGFwdGljQWN0dWF0b3InLFxuICAgICdHZW9sb2NhdGlvbicsXG4gICAgJ0dlb2xvY2F0aW9uQ29vcmRpbmF0ZXMnLFxuICAgICdHZW9sb2NhdGlvblBvc2l0aW9uJyxcbiAgICAnR2VvbG9jYXRpb25Qb3NpdGlvbkVycm9yJyxcbiAgICAnSFRNTEFsbENvbGxlY3Rpb24nLFxuICAgICdIVE1MQW5jaG9yRWxlbWVudCcsXG4gICAgJ0hUTUxBcmVhRWxlbWVudCcsXG4gICAgJ0hUTUxBdWRpb0VsZW1lbnQnLFxuICAgICdIVE1MQlJFbGVtZW50JyxcbiAgICAnSFRNTEJhc2VFbGVtZW50JyxcbiAgICAnSFRNTEJvZHlFbGVtZW50JyxcbiAgICAnSFRNTEJ1dHRvbkVsZW1lbnQnLFxuICAgICdIVE1MQ2FudmFzRWxlbWVudCcsXG4gICAgJ0hUTUxDb2xsZWN0aW9uJyxcbiAgICAnSFRNTERMaXN0RWxlbWVudCcsXG4gICAgJ0hUTUxEYXRhRWxlbWVudCcsXG4gICAgJ0hUTUxEYXRhTGlzdEVsZW1lbnQnLFxuICAgICdIVE1MRGV0YWlsc0VsZW1lbnQnLFxuICAgICdIVE1MRGlhbG9nRWxlbWVudCcsXG4gICAgJ0hUTUxEaXJlY3RvcnlFbGVtZW50JyxcbiAgICAnSFRNTERpdkVsZW1lbnQnLFxuICAgICdIVE1MRG9jdW1lbnQnLFxuICAgICdIVE1MRWxlbWVudCcsXG4gICAgJ0hUTUxFbWJlZEVsZW1lbnQnLFxuICAgICdIVE1MRmllbGRTZXRFbGVtZW50JyxcbiAgICAnSFRNTEZvbnRFbGVtZW50JyxcbiAgICAnSFRNTEZvcm1Db250cm9sc0NvbGxlY3Rpb24nLFxuICAgICdIVE1MRm9ybUVsZW1lbnQnLFxuICAgICdIVE1MRnJhbWVFbGVtZW50JyxcbiAgICAnSFRNTEZyYW1lU2V0RWxlbWVudCcsXG4gICAgJ0hUTUxIUkVsZW1lbnQnLFxuICAgICdIVE1MSGVhZEVsZW1lbnQnLFxuICAgICdIVE1MSGVhZGluZ0VsZW1lbnQnLFxuICAgICdIVE1MSHRtbEVsZW1lbnQnLFxuICAgICdIVE1MSUZyYW1lRWxlbWVudCcsXG4gICAgJ0hUTUxJbWFnZUVsZW1lbnQnLFxuICAgICdIVE1MSW5wdXRFbGVtZW50JyxcbiAgICAnSFRNTExJRWxlbWVudCcsXG4gICAgJ0hUTUxMYWJlbEVsZW1lbnQnLFxuICAgICdIVE1MTGVnZW5kRWxlbWVudCcsXG4gICAgJ0hUTUxMaW5rRWxlbWVudCcsXG4gICAgJ0hUTUxNYXBFbGVtZW50JyxcbiAgICAnSFRNTE1hcnF1ZWVFbGVtZW50JyxcbiAgICAnSFRNTE1lZGlhRWxlbWVudCcsXG4gICAgJ0hUTUxNZW51RWxlbWVudCcsXG4gICAgJ0hUTUxNZXRhRWxlbWVudCcsXG4gICAgJ0hUTUxNZXRlckVsZW1lbnQnLFxuICAgICdIVE1MTW9kRWxlbWVudCcsXG4gICAgJ0hUTUxPTGlzdEVsZW1lbnQnLFxuICAgICdIVE1MT2JqZWN0RWxlbWVudCcsXG4gICAgJ0hUTUxPcHRHcm91cEVsZW1lbnQnLFxuICAgICdIVE1MT3B0aW9uRWxlbWVudCcsXG4gICAgJ0hUTUxPcHRpb25zQ29sbGVjdGlvbicsXG4gICAgJ0hUTUxPdXRwdXRFbGVtZW50JyxcbiAgICAnSFRNTFBhcmFncmFwaEVsZW1lbnQnLFxuICAgICdIVE1MUGFyYW1FbGVtZW50JyxcbiAgICAnSFRNTFBpY3R1cmVFbGVtZW50JyxcbiAgICAnSFRNTFByZUVsZW1lbnQnLFxuICAgICdIVE1MUHJvZ3Jlc3NFbGVtZW50JyxcbiAgICAnSFRNTFF1b3RlRWxlbWVudCcsXG4gICAgJ0hUTUxTY3JpcHRFbGVtZW50JyxcbiAgICAnSFRNTFNlbGVjdEVsZW1lbnQnLFxuICAgICdIVE1MU2xvdEVsZW1lbnQnLFxuICAgICdIVE1MU291cmNlRWxlbWVudCcsXG4gICAgJ0hUTUxTcGFuRWxlbWVudCcsXG4gICAgJ0hUTUxTdHlsZUVsZW1lbnQnLFxuICAgICdIVE1MVGFibGVDYXB0aW9uRWxlbWVudCcsXG4gICAgJ0hUTUxUYWJsZUNlbGxFbGVtZW50JyxcbiAgICAnSFRNTFRhYmxlQ29sRWxlbWVudCcsXG4gICAgJ0hUTUxUYWJsZUVsZW1lbnQnLFxuICAgICdIVE1MVGFibGVSb3dFbGVtZW50JyxcbiAgICAnSFRNTFRhYmxlU2VjdGlvbkVsZW1lbnQnLFxuICAgICdIVE1MVGVtcGxhdGVFbGVtZW50JyxcbiAgICAnSFRNTFRleHRBcmVhRWxlbWVudCcsXG4gICAgJ0hUTUxUaW1lRWxlbWVudCcsXG4gICAgJ0hUTUxUaXRsZUVsZW1lbnQnLFxuICAgICdIVE1MVHJhY2tFbGVtZW50JyxcbiAgICAnSFRNTFVMaXN0RWxlbWVudCcsXG4gICAgJ0hUTUxVbmtub3duRWxlbWVudCcsXG4gICAgJ0hUTUxWaWRlb0VsZW1lbnQnLFxuICAgICdIYXNoQ2hhbmdlRXZlbnQnLFxuICAgICdIZWFkZXJzJyxcbiAgICAnSGlzdG9yeScsXG4gICAgJ0lEQkN1cnNvcicsXG4gICAgJ0lEQkN1cnNvcldpdGhWYWx1ZScsXG4gICAgJ0lEQkRhdGFiYXNlJyxcbiAgICAnSURCRmFjdG9yeScsXG4gICAgJ0lEQkluZGV4JyxcbiAgICAnSURCS2V5UmFuZ2UnLFxuICAgICdJREJPYmplY3RTdG9yZScsXG4gICAgJ0lEQk9wZW5EQlJlcXVlc3QnLFxuICAgICdJREJSZXF1ZXN0JyxcbiAgICAnSURCVHJhbnNhY3Rpb24nLFxuICAgICdJREJWZXJzaW9uQ2hhbmdlRXZlbnQnLFxuICAgICdJSVJGaWx0ZXJOb2RlJyxcbiAgICAnSWRsZURlYWRsaW5lJyxcbiAgICAnSW1hZ2UnLFxuICAgICdJbWFnZUJpdG1hcCcsXG4gICAgJ0ltYWdlQml0bWFwUmVuZGVyaW5nQ29udGV4dCcsXG4gICAgJ0ltYWdlRGF0YScsXG4gICAgJ0luZmluaXR5JyxcbiAgICAnSW5wdXREZXZpY2VJbmZvJyxcbiAgICAnSW5wdXRFdmVudCcsXG4gICAgJ0ludDE2QXJyYXknLFxuICAgICdJbnQzMkFycmF5JyxcbiAgICAnSW50OEFycmF5JyxcbiAgICAnSW50ZXJuYWxFcnJvcicsXG4gICAgJ0ludGVyc2VjdGlvbk9ic2VydmVyJyxcbiAgICAnSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeScsXG4gICAgJ0ludGwnLFxuICAgICdKU09OJyxcbiAgICAnS2V5Ym9hcmRFdmVudCcsXG4gICAgJ0tleWZyYW1lRWZmZWN0JyxcbiAgICAnTG9jYXRpb24nLFxuICAgICdMb2NrJyxcbiAgICAnTG9ja01hbmFnZXInLFxuICAgICdNYXAnLFxuICAgICdNYXRoJyxcbiAgICAnTWF0aE1MRWxlbWVudCcsXG4gICAgJ01lZGlhQ2FwYWJpbGl0aWVzJyxcbiAgICAnTWVkaWFEZXZpY2VJbmZvJyxcbiAgICAnTWVkaWFEZXZpY2VzJyxcbiAgICAnTWVkaWFFbGVtZW50QXVkaW9Tb3VyY2VOb2RlJyxcbiAgICAnTWVkaWFFbmNyeXB0ZWRFdmVudCcsXG4gICAgJ01lZGlhRXJyb3InLFxuICAgICdNZWRpYUtleU1lc3NhZ2VFdmVudCcsXG4gICAgJ01lZGlhS2V5U2Vzc2lvbicsXG4gICAgJ01lZGlhS2V5U3RhdHVzTWFwJyxcbiAgICAnTWVkaWFLZXlTeXN0ZW1BY2Nlc3MnLFxuICAgICdNZWRpYUtleXMnLFxuICAgICdNZWRpYUxpc3QnLFxuICAgICdNZWRpYU1ldGFkYXRhJyxcbiAgICAnTWVkaWFRdWVyeUxpc3QnLFxuICAgICdNZWRpYVF1ZXJ5TGlzdEV2ZW50JyxcbiAgICAnTWVkaWFSZWNvcmRlcicsXG4gICAgJ01lZGlhUmVjb3JkZXJFcnJvckV2ZW50JyxcbiAgICAnTWVkaWFTZXNzaW9uJyxcbiAgICAnTWVkaWFTb3VyY2UnLFxuICAgICdNZWRpYVN0cmVhbScsXG4gICAgJ01lZGlhU3RyZWFtQXVkaW9EZXN0aW5hdGlvbk5vZGUnLFxuICAgICdNZWRpYVN0cmVhbUF1ZGlvU291cmNlTm9kZScsXG4gICAgJ01lZGlhU3RyZWFtVHJhY2snLFxuICAgICdNZWRpYVN0cmVhbVRyYWNrRXZlbnQnLFxuICAgICdNZXNzYWdlQ2hhbm5lbCcsXG4gICAgJ01lc3NhZ2VFdmVudCcsXG4gICAgJ01lc3NhZ2VQb3J0JyxcbiAgICAnTWltZVR5cGUnLFxuICAgICdNaW1lVHlwZUFycmF5JyxcbiAgICAnTW91c2VFdmVudCcsXG4gICAgJ011dGF0aW9uRXZlbnQnLFxuICAgICdNdXRhdGlvbk9ic2VydmVyJyxcbiAgICAnTXV0YXRpb25SZWNvcmQnLFxuICAgICdOYU4nLFxuICAgICdOYW1lZE5vZGVNYXAnLFxuICAgICdOYXZpZ2F0aW9uUHJlbG9hZE1hbmFnZXInLFxuICAgICdOYXZpZ2F0b3InLFxuICAgICdOZXR3b3JrSW5mb3JtYXRpb24nLFxuICAgICdOb2RlJyxcbiAgICAnTm9kZUZpbHRlcicsXG4gICAgJ05vZGVJdGVyYXRvcicsXG4gICAgJ05vZGVMaXN0JyxcbiAgICAnTm90aWZpY2F0aW9uJyxcbiAgICAnTnVtYmVyJyxcbiAgICAnT2JqZWN0JyxcbiAgICAnT2ZmbGluZUF1ZGlvQ29tcGxldGlvbkV2ZW50JyxcbiAgICAnT2ZmbGluZUF1ZGlvQ29udGV4dCcsXG4gICAgJ09wdGlvbicsXG4gICAgJ09zY2lsbGF0b3JOb2RlJyxcbiAgICAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InLFxuICAgICdQYWdlVHJhbnNpdGlvbkV2ZW50JyxcbiAgICAnUGFubmVyTm9kZScsXG4gICAgJ1BhdGgyRCcsXG4gICAgJ1BheW1lbnRBZGRyZXNzJyxcbiAgICAnUGF5bWVudE1ldGhvZENoYW5nZUV2ZW50JyxcbiAgICAnUGF5bWVudFJlcXVlc3QnLFxuICAgICdQYXltZW50UmVxdWVzdFVwZGF0ZUV2ZW50JyxcbiAgICAnUGF5bWVudFJlc3BvbnNlJyxcbiAgICAnUGVyZm9ybWFuY2UnLFxuICAgICdQZXJmb3JtYW5jZUVudHJ5JyxcbiAgICAnUGVyZm9ybWFuY2VFdmVudFRpbWluZycsXG4gICAgJ1BlcmZvcm1hbmNlTWFyaycsXG4gICAgJ1BlcmZvcm1hbmNlTWVhc3VyZScsXG4gICAgJ1BlcmZvcm1hbmNlTmF2aWdhdGlvbicsXG4gICAgJ1BlcmZvcm1hbmNlTmF2aWdhdGlvblRpbWluZycsXG4gICAgJ1BlcmZvcm1hbmNlT2JzZXJ2ZXInLFxuICAgICdQZXJmb3JtYW5jZU9ic2VydmVyRW50cnlMaXN0JyxcbiAgICAnUGVyZm9ybWFuY2VQYWludFRpbWluZycsXG4gICAgJ1BlcmZvcm1hbmNlUmVzb3VyY2VUaW1pbmcnLFxuICAgICdQZXJmb3JtYW5jZVNlcnZlclRpbWluZycsXG4gICAgJ1BlcmZvcm1hbmNlVGltaW5nJyxcbiAgICAnUGVyaW9kaWNXYXZlJyxcbiAgICAnUGVybWlzc2lvblN0YXR1cycsXG4gICAgJ1Blcm1pc3Npb25zJyxcbiAgICAnUGljdHVyZUluUGljdHVyZVdpbmRvdycsXG4gICAgJ1BsdWdpbicsXG4gICAgJ1BsdWdpbkFycmF5JyxcbiAgICAnUG9pbnRlckV2ZW50JyxcbiAgICAnUG9wU3RhdGVFdmVudCcsXG4gICAgJ1Byb2Nlc3NpbmdJbnN0cnVjdGlvbicsXG4gICAgJ1Byb2dyZXNzRXZlbnQnLFxuICAgICdQcm9taXNlJyxcbiAgICAnUHJvbWlzZVJlamVjdGlvbkV2ZW50JyxcbiAgICAnUHJveHknLFxuICAgICdQdWJsaWNLZXlDcmVkZW50aWFsJyxcbiAgICAnUHVzaE1hbmFnZXInLFxuICAgICdQdXNoU3Vic2NyaXB0aW9uJyxcbiAgICAnUHVzaFN1YnNjcmlwdGlvbk9wdGlvbnMnLFxuICAgICdSVENDZXJ0aWZpY2F0ZScsXG4gICAgJ1JUQ0RUTUZTZW5kZXInLFxuICAgICdSVENEVE1GVG9uZUNoYW5nZUV2ZW50JyxcbiAgICAnUlRDRGF0YUNoYW5uZWwnLFxuICAgICdSVENEYXRhQ2hhbm5lbEV2ZW50JyxcbiAgICAnUlRDRHRsc1RyYW5zcG9ydCcsXG4gICAgJ1JUQ0VuY29kZWRBdWRpb0ZyYW1lJyxcbiAgICAnUlRDRW5jb2RlZFZpZGVvRnJhbWUnLFxuICAgICdSVENFcnJvcicsXG4gICAgJ1JUQ0Vycm9yRXZlbnQnLFxuICAgICdSVENJY2VDYW5kaWRhdGUnLFxuICAgICdSVENJY2VUcmFuc3BvcnQnLFxuICAgICdSVENQZWVyQ29ubmVjdGlvbicsXG4gICAgJ1JUQ1BlZXJDb25uZWN0aW9uSWNlRXJyb3JFdmVudCcsXG4gICAgJ1JUQ1BlZXJDb25uZWN0aW9uSWNlRXZlbnQnLFxuICAgICdSVENSdHBSZWNlaXZlcicsXG4gICAgJ1JUQ1J0cFNlbmRlcicsXG4gICAgJ1JUQ1J0cFRyYW5zY2VpdmVyJyxcbiAgICAnUlRDU2N0cFRyYW5zcG9ydCcsXG4gICAgJ1JUQ1Nlc3Npb25EZXNjcmlwdGlvbicsXG4gICAgJ1JUQ1N0YXRzUmVwb3J0JyxcbiAgICAnUlRDVHJhY2tFdmVudCcsXG4gICAgJ1JhZGlvTm9kZUxpc3QnLFxuICAgICdSYW5nZScsXG4gICAgJ1JhbmdlRXJyb3InLFxuICAgICdSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyJyxcbiAgICAnUmVhZGFibGVTdHJlYW0nLFxuICAgICdSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXInLFxuICAgICdSZWFkYWJsZVN0cmVhbUJZT0JSZXF1ZXN0JyxcbiAgICAnUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcicsXG4gICAgJ1JlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlcicsXG4gICAgJ1JlZmVyZW5jZUVycm9yJyxcbiAgICAnUmVmbGVjdCcsXG4gICAgJ1JlZ0V4cCcsXG4gICAgJ1JlbW90ZVBsYXliYWNrJyxcbiAgICAnUmVxdWVzdCcsXG4gICAgJ1Jlc2l6ZU9ic2VydmVyJyxcbiAgICAnUmVzaXplT2JzZXJ2ZXJFbnRyeScsXG4gICAgJ1Jlc2l6ZU9ic2VydmVyU2l6ZScsXG4gICAgJ1Jlc3BvbnNlJyxcbiAgICAnU1ZHQUVsZW1lbnQnLFxuICAgICdTVkdBbmdsZScsXG4gICAgJ1NWR0FuaW1hdGVFbGVtZW50JyxcbiAgICAnU1ZHQW5pbWF0ZU1vdGlvbkVsZW1lbnQnLFxuICAgICdTVkdBbmltYXRlVHJhbnNmb3JtRWxlbWVudCcsXG4gICAgJ1NWR0FuaW1hdGVkQW5nbGUnLFxuICAgICdTVkdBbmltYXRlZEJvb2xlYW4nLFxuICAgICdTVkdBbmltYXRlZEVudW1lcmF0aW9uJyxcbiAgICAnU1ZHQW5pbWF0ZWRJbnRlZ2VyJyxcbiAgICAnU1ZHQW5pbWF0ZWRMZW5ndGgnLFxuICAgICdTVkdBbmltYXRlZExlbmd0aExpc3QnLFxuICAgICdTVkdBbmltYXRlZE51bWJlcicsXG4gICAgJ1NWR0FuaW1hdGVkTnVtYmVyTGlzdCcsXG4gICAgJ1NWR0FuaW1hdGVkUHJlc2VydmVBc3BlY3RSYXRpbycsXG4gICAgJ1NWR0FuaW1hdGVkUmVjdCcsXG4gICAgJ1NWR0FuaW1hdGVkU3RyaW5nJyxcbiAgICAnU1ZHQW5pbWF0ZWRUcmFuc2Zvcm1MaXN0JyxcbiAgICAnU1ZHQW5pbWF0aW9uRWxlbWVudCcsXG4gICAgJ1NWR0NpcmNsZUVsZW1lbnQnLFxuICAgICdTVkdDbGlwUGF0aEVsZW1lbnQnLFxuICAgICdTVkdDb21wb25lbnRUcmFuc2ZlckZ1bmN0aW9uRWxlbWVudCcsXG4gICAgJ1NWR0N1cnNvckVsZW1lbnQnLFxuICAgICdTVkdEZWZzRWxlbWVudCcsXG4gICAgJ1NWR0Rlc2NFbGVtZW50JyxcbiAgICAnU1ZHRWxlbWVudCcsXG4gICAgJ1NWR0VsbGlwc2VFbGVtZW50JyxcbiAgICAnU1ZHRkVCbGVuZEVsZW1lbnQnLFxuICAgICdTVkdGRUNvbG9yTWF0cml4RWxlbWVudCcsXG4gICAgJ1NWR0ZFQ29tcG9uZW50VHJhbnNmZXJFbGVtZW50JyxcbiAgICAnU1ZHRkVDb21wb3NpdGVFbGVtZW50JyxcbiAgICAnU1ZHRkVDb252b2x2ZU1hdHJpeEVsZW1lbnQnLFxuICAgICdTVkdGRURpZmZ1c2VMaWdodGluZ0VsZW1lbnQnLFxuICAgICdTVkdGRURpc3BsYWNlbWVudE1hcEVsZW1lbnQnLFxuICAgICdTVkdGRURpc3RhbnRMaWdodEVsZW1lbnQnLFxuICAgICdTVkdGRURyb3BTaGFkb3dFbGVtZW50JyxcbiAgICAnU1ZHRkVGbG9vZEVsZW1lbnQnLFxuICAgICdTVkdGRUZ1bmNBRWxlbWVudCcsXG4gICAgJ1NWR0ZFRnVuY0JFbGVtZW50JyxcbiAgICAnU1ZHRkVGdW5jR0VsZW1lbnQnLFxuICAgICdTVkdGRUZ1bmNSRWxlbWVudCcsXG4gICAgJ1NWR0ZFR2F1c3NpYW5CbHVyRWxlbWVudCcsXG4gICAgJ1NWR0ZFSW1hZ2VFbGVtZW50JyxcbiAgICAnU1ZHRkVNZXJnZUVsZW1lbnQnLFxuICAgICdTVkdGRU1lcmdlTm9kZUVsZW1lbnQnLFxuICAgICdTVkdGRU1vcnBob2xvZ3lFbGVtZW50JyxcbiAgICAnU1ZHRkVPZmZzZXRFbGVtZW50JyxcbiAgICAnU1ZHRkVQb2ludExpZ2h0RWxlbWVudCcsXG4gICAgJ1NWR0ZFU3BlY3VsYXJMaWdodGluZ0VsZW1lbnQnLFxuICAgICdTVkdGRVNwb3RMaWdodEVsZW1lbnQnLFxuICAgICdTVkdGRVRpbGVFbGVtZW50JyxcbiAgICAnU1ZHRkVUdXJidWxlbmNlRWxlbWVudCcsXG4gICAgJ1NWR0ZpbHRlckVsZW1lbnQnLFxuICAgICdTVkdGb3JlaWduT2JqZWN0RWxlbWVudCcsXG4gICAgJ1NWR0dFbGVtZW50JyxcbiAgICAnU1ZHR2VvbWV0cnlFbGVtZW50JyxcbiAgICAnU1ZHR3JhZGllbnRFbGVtZW50JyxcbiAgICAnU1ZHR3JhcGhpY3NFbGVtZW50JyxcbiAgICAnU1ZHSW1hZ2VFbGVtZW50JyxcbiAgICAnU1ZHTGVuZ3RoJyxcbiAgICAnU1ZHTGVuZ3RoTGlzdCcsXG4gICAgJ1NWR0xpbmVFbGVtZW50JyxcbiAgICAnU1ZHTGluZWFyR3JhZGllbnRFbGVtZW50JyxcbiAgICAnU1ZHTVBhdGhFbGVtZW50JyxcbiAgICAnU1ZHTWFya2VyRWxlbWVudCcsXG4gICAgJ1NWR01hc2tFbGVtZW50JyxcbiAgICAnU1ZHTWF0cml4JyxcbiAgICAnU1ZHTWV0YWRhdGFFbGVtZW50JyxcbiAgICAnU1ZHTnVtYmVyJyxcbiAgICAnU1ZHTnVtYmVyTGlzdCcsXG4gICAgJ1NWR1BhdGhFbGVtZW50JyxcbiAgICAnU1ZHUGF0dGVybkVsZW1lbnQnLFxuICAgICdTVkdQb2ludCcsXG4gICAgJ1NWR1BvaW50TGlzdCcsXG4gICAgJ1NWR1BvbHlnb25FbGVtZW50JyxcbiAgICAnU1ZHUG9seWxpbmVFbGVtZW50JyxcbiAgICAnU1ZHUHJlc2VydmVBc3BlY3RSYXRpbycsXG4gICAgJ1NWR1JhZGlhbEdyYWRpZW50RWxlbWVudCcsXG4gICAgJ1NWR1JlY3QnLFxuICAgICdTVkdSZWN0RWxlbWVudCcsXG4gICAgJ1NWR1NWR0VsZW1lbnQnLFxuICAgICdTVkdTY3JpcHRFbGVtZW50JyxcbiAgICAnU1ZHU2V0RWxlbWVudCcsXG4gICAgJ1NWR1N0b3BFbGVtZW50JyxcbiAgICAnU1ZHU3RyaW5nTGlzdCcsXG4gICAgJ1NWR1N0eWxlRWxlbWVudCcsXG4gICAgJ1NWR1N3aXRjaEVsZW1lbnQnLFxuICAgICdTVkdTeW1ib2xFbGVtZW50JyxcbiAgICAnU1ZHVFNwYW5FbGVtZW50JyxcbiAgICAnU1ZHVGV4dENvbnRlbnRFbGVtZW50JyxcbiAgICAnU1ZHVGV4dEVsZW1lbnQnLFxuICAgICdTVkdUZXh0UGF0aEVsZW1lbnQnLFxuICAgICdTVkdUZXh0UG9zaXRpb25pbmdFbGVtZW50JyxcbiAgICAnU1ZHVGl0bGVFbGVtZW50JyxcbiAgICAnU1ZHVHJhbnNmb3JtJyxcbiAgICAnU1ZHVHJhbnNmb3JtTGlzdCcsXG4gICAgJ1NWR1VuaXRUeXBlcycsXG4gICAgJ1NWR1VzZUVsZW1lbnQnLFxuICAgICdTVkdWaWV3RWxlbWVudCcsXG4gICAgJ1NhZmVBcnJheScsXG4gICAgJ1NjcmVlbicsXG4gICAgJ1NjcmVlbk9yaWVudGF0aW9uJyxcbiAgICAnU2NyaXB0UHJvY2Vzc29yTm9kZScsXG4gICAgJ1NlY3VyaXR5UG9saWN5VmlvbGF0aW9uRXZlbnQnLFxuICAgICdTZWxlY3Rpb24nLFxuICAgICdTZXJ2aWNlV29ya2VyJyxcbiAgICAnU2VydmljZVdvcmtlckNvbnRhaW5lcicsXG4gICAgJ1NlcnZpY2VXb3JrZXJSZWdpc3RyYXRpb24nLFxuICAgICdTZXQnLFxuICAgICdTaGFkb3dSb290JyxcbiAgICAnU2hhcmVkQXJyYXlCdWZmZXInLFxuICAgICdTaGFyZWRXb3JrZXInLFxuICAgICdTb3VyY2VCdWZmZXInLFxuICAgICdTb3VyY2VCdWZmZXJMaXN0JyxcbiAgICAnU3BlZWNoUmVjb2duaXRpb25BbHRlcm5hdGl2ZScsXG4gICAgJ1NwZWVjaFJlY29nbml0aW9uRXJyb3JFdmVudCcsXG4gICAgJ1NwZWVjaFJlY29nbml0aW9uUmVzdWx0JyxcbiAgICAnU3BlZWNoUmVjb2duaXRpb25SZXN1bHRMaXN0JyxcbiAgICAnU3BlZWNoU3ludGhlc2lzJyxcbiAgICAnU3BlZWNoU3ludGhlc2lzRXJyb3JFdmVudCcsXG4gICAgJ1NwZWVjaFN5bnRoZXNpc0V2ZW50JyxcbiAgICAnU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlJyxcbiAgICAnU3BlZWNoU3ludGhlc2lzVm9pY2UnLFxuICAgICdTdGF0aWNSYW5nZScsXG4gICAgJ1N0ZXJlb1Bhbm5lck5vZGUnLFxuICAgICdTdG9yYWdlJyxcbiAgICAnU3RvcmFnZUV2ZW50JyxcbiAgICAnU3RvcmFnZU1hbmFnZXInLFxuICAgICdTdHJpbmcnLFxuICAgICdTdHlsZU1lZGlhJyxcbiAgICAnU3R5bGVTaGVldCcsXG4gICAgJ1N0eWxlU2hlZXRMaXN0JyxcbiAgICAnU3VibWl0RXZlbnQnLFxuICAgICdTdWJ0bGVDcnlwdG8nLFxuICAgICdTeW1ib2wnLFxuICAgICdTeW50YXhFcnJvcicsXG4gICAgJ1RleHQnLFxuICAgICdUZXh0RGVjb2RlcicsXG4gICAgJ1RleHREZWNvZGVyU3RyZWFtJyxcbiAgICAnVGV4dEVuY29kZXInLFxuICAgICdUZXh0RW5jb2RlclN0cmVhbScsXG4gICAgJ1RleHRNZXRyaWNzJyxcbiAgICAnVGV4dFRyYWNrJyxcbiAgICAnVGV4dFRyYWNrQ3VlJyxcbiAgICAnVGV4dFRyYWNrQ3VlTGlzdCcsXG4gICAgJ1RleHRUcmFja0xpc3QnLFxuICAgICdUaW1lUmFuZ2VzJyxcbiAgICAnVG91Y2gnLFxuICAgICdUb3VjaEV2ZW50JyxcbiAgICAnVG91Y2hMaXN0JyxcbiAgICAnVHJhY2tFdmVudCcsXG4gICAgJ1RyYW5zZm9ybVN0cmVhbScsXG4gICAgJ1RyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyJyxcbiAgICAnVHJhbnNpdGlvbkV2ZW50JyxcbiAgICAnVHJlZVdhbGtlcicsXG4gICAgJ1R5cGVFcnJvcicsXG4gICAgJ1VJRXZlbnQnLFxuICAgICdVUklFcnJvcicsXG4gICAgJ1VSTCcsXG4gICAgJ1VSTFNlYXJjaFBhcmFtcycsXG4gICAgJ1VpbnQxNkFycmF5JyxcbiAgICAnVWludDMyQXJyYXknLFxuICAgICdVaW50OEFycmF5JyxcbiAgICAnVWludDhDbGFtcGVkQXJyYXknLFxuICAgICdWQkFycmF5JyxcbiAgICAnVlRUQ3VlJyxcbiAgICAnVlRUUmVnaW9uJyxcbiAgICAnVmFsaWRpdHlTdGF0ZScsXG4gICAgJ1ZhckRhdGUnLFxuICAgICdWaWRlb0NvbG9yU3BhY2UnLFxuICAgICdWaWRlb1BsYXliYWNrUXVhbGl0eScsXG4gICAgJ1Zpc3VhbFZpZXdwb3J0JyxcbiAgICAnV1NIJyxcbiAgICAnV1NjcmlwdCcsXG4gICAgJ1dhdmVTaGFwZXJOb2RlJyxcbiAgICAnV2Vha01hcCcsXG4gICAgJ1dlYWtSZWYnLFxuICAgICdXZWFrU2V0JyxcbiAgICAnV2ViQXNzZW1ibHknLFxuICAgICdXZWJHTDJSZW5kZXJpbmdDb250ZXh0JyxcbiAgICAnV2ViR0xBY3RpdmVJbmZvJyxcbiAgICAnV2ViR0xCdWZmZXInLFxuICAgICdXZWJHTENvbnRleHRFdmVudCcsXG4gICAgJ1dlYkdMRnJhbWVidWZmZXInLFxuICAgICdXZWJHTFByb2dyYW0nLFxuICAgICdXZWJHTFF1ZXJ5JyxcbiAgICAnV2ViR0xSZW5kZXJidWZmZXInLFxuICAgICdXZWJHTFJlbmRlcmluZ0NvbnRleHQnLFxuICAgICdXZWJHTFNhbXBsZXInLFxuICAgICdXZWJHTFNoYWRlcicsXG4gICAgJ1dlYkdMU2hhZGVyUHJlY2lzaW9uRm9ybWF0JyxcbiAgICAnV2ViR0xTeW5jJyxcbiAgICAnV2ViR0xUZXh0dXJlJyxcbiAgICAnV2ViR0xUcmFuc2Zvcm1GZWVkYmFjaycsXG4gICAgJ1dlYkdMVW5pZm9ybUxvY2F0aW9uJyxcbiAgICAnV2ViR0xWZXJ0ZXhBcnJheU9iamVjdCcsXG4gICAgJ1dlYktpdENTU01hdHJpeCcsXG4gICAgJ1dlYlNvY2tldCcsXG4gICAgJ1doZWVsRXZlbnQnLFxuICAgICdXaW5kb3cnLFxuICAgICdXb3JrZXInLFxuICAgICdXb3JrbGV0JyxcbiAgICAnV3JpdGFibGVTdHJlYW0nLFxuICAgICdXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyJyxcbiAgICAnV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyJyxcbiAgICAnWE1MRG9jdW1lbnQnLFxuICAgICdYTUxIdHRwUmVxdWVzdCcsXG4gICAgJ1hNTEh0dHBSZXF1ZXN0RXZlbnRUYXJnZXQnLFxuICAgICdYTUxIdHRwUmVxdWVzdFVwbG9hZCcsXG4gICAgJ1hNTFNlcmlhbGl6ZXInLFxuICAgICdYUGF0aEV2YWx1YXRvcicsXG4gICAgJ1hQYXRoRXhwcmVzc2lvbicsXG4gICAgJ1hQYXRoUmVzdWx0JyxcbiAgICAnWFNMVFByb2Nlc3NvcicsXG4gICAgJ2FkZEV2ZW50TGlzdGVuZXInLFxuICAgICdhbGVydCcsXG4gICAgJ2F0b2InLFxuICAgICdibHVyJyxcbiAgICAnYnRvYScsXG4gICAgJ2NhY2hlcycsXG4gICAgJ2NhbmNlbEFuaW1hdGlvbkZyYW1lJyxcbiAgICAnY2FuY2VsSWRsZUNhbGxiYWNrJyxcbiAgICAnY2FwdHVyZUV2ZW50cycsXG4gICAgJ2NsZWFySW50ZXJ2YWwnLFxuICAgICdjbGVhclRpbWVvdXQnLFxuICAgICdjbGllbnRJbmZvcm1hdGlvbicsXG4gICAgJ2Nsb3NlJyxcbiAgICAnY2xvc2VkJyxcbiAgICAnY29uZmlybScsXG4gICAgJ2NvbnNvbGUnLFxuICAgICdjcmVhdGVJbWFnZUJpdG1hcCcsXG4gICAgJ2Nyb3NzT3JpZ2luSXNvbGF0ZWQnLFxuICAgICdjcnlwdG8nLFxuICAgICdjdXN0b21FbGVtZW50cycsXG4gICAgJ2RlY29kZVVSSScsXG4gICAgJ2RlY29kZVVSSUNvbXBvbmVudCcsXG4gICAgJ2RldmljZVBpeGVsUmF0aW8nLFxuICAgICdkaXNwYXRjaEV2ZW50JyxcbiAgICAnZG9jdW1lbnQnLFxuICAgICdlbmNvZGVVUkknLFxuICAgICdlbmNvZGVVUklDb21wb25lbnQnLFxuICAgICdlc2NhcGUnLFxuICAgICdldmFsJyxcbiAgICAnZXZlbnQnLFxuICAgICdleHRlcm5hbCcsXG4gICAgJ2ZldGNoJyxcbiAgICAnZm9jdXMnLFxuICAgICdmcmFtZUVsZW1lbnQnLFxuICAgICdmcmFtZXMnLFxuICAgICdnZXRDb21wdXRlZFN0eWxlJyxcbiAgICAnZ2V0U2VsZWN0aW9uJyxcbiAgICAnZ2xvYmFsJyxcbiAgICAnZ2xvYmFsVGhpcycsXG4gICAgJ2hpc3RvcnknLFxuICAgICdpbXBvcnRTY3JpcHRzJyxcbiAgICAnaW5kZXhlZERCJyxcbiAgICAnaW5uZXJIZWlnaHQnLFxuICAgICdpbm5lcldpZHRoJyxcbiAgICAnaXNGaW5pdGUnLFxuICAgICdpc05hTicsXG4gICAgJ2lzU2VjdXJlQ29udGV4dCcsXG4gICAgJ2xlbmd0aCcsXG4gICAgJ2xvY2FsU3RvcmFnZScsXG4gICAgJ2xvY2F0aW9uJyxcbiAgICAnbG9jYXRpb25iYXInLFxuICAgICdtYXRjaE1lZGlhJyxcbiAgICAnbWVudWJhcicsXG4gICAgJ21vdmVCeScsXG4gICAgJ21vdmVUbycsXG4gICAgJ25hbWUnLFxuICAgICduYXZpZ2F0b3InLFxuICAgICdvbmFib3J0JyxcbiAgICAnb25hZnRlcnByaW50JyxcbiAgICAnb25hbmltYXRpb25jYW5jZWwnLFxuICAgICdvbmFuaW1hdGlvbmVuZCcsXG4gICAgJ29uYW5pbWF0aW9uaXRlcmF0aW9uJyxcbiAgICAnb25hbmltYXRpb25zdGFydCcsXG4gICAgJ29uYXV4Y2xpY2snLFxuICAgICdvbmJlZm9yZXByaW50JyxcbiAgICAnb25iZWZvcmV1bmxvYWQnLFxuICAgICdvbmJsdXInLFxuICAgICdvbmNhbnBsYXknLFxuICAgICdvbmNhbnBsYXl0aHJvdWdoJyxcbiAgICAnb25jaGFuZ2UnLFxuICAgICdvbmNsaWNrJyxcbiAgICAnb25jbG9zZScsXG4gICAgJ29uY29udGV4dG1lbnUnLFxuICAgICdvbmN1ZWNoYW5nZScsXG4gICAgJ29uZGJsY2xpY2snLFxuICAgICdvbmRldmljZW1vdGlvbicsXG4gICAgJ29uZGV2aWNlb3JpZW50YXRpb24nLFxuICAgICdvbmRyYWcnLFxuICAgICdvbmRyYWdlbmQnLFxuICAgICdvbmRyYWdlbnRlcicsXG4gICAgJ29uZHJhZ2xlYXZlJyxcbiAgICAnb25kcmFnb3ZlcicsXG4gICAgJ29uZHJhZ3N0YXJ0JyxcbiAgICAnb25kcm9wJyxcbiAgICAnb25kdXJhdGlvbmNoYW5nZScsXG4gICAgJ29uZW1wdGllZCcsXG4gICAgJ29uZW5kZWQnLFxuICAgICdvbmVycm9yJyxcbiAgICAnb25mb2N1cycsXG4gICAgJ29uZm9ybWRhdGEnLFxuICAgICdvbmdhbWVwYWRjb25uZWN0ZWQnLFxuICAgICdvbmdhbWVwYWRkaXNjb25uZWN0ZWQnLFxuICAgICdvbmdvdHBvaW50ZXJjYXB0dXJlJyxcbiAgICAnb25oYXNoY2hhbmdlJyxcbiAgICAnb25pbnB1dCcsXG4gICAgJ29uaW52YWxpZCcsXG4gICAgJ29ua2V5ZG93bicsXG4gICAgJ29ua2V5cHJlc3MnLFxuICAgICdvbmtleXVwJyxcbiAgICAnb25sYW5ndWFnZWNoYW5nZScsXG4gICAgJ29ubG9hZCcsXG4gICAgJ29ubG9hZGVkZGF0YScsXG4gICAgJ29ubG9hZGVkbWV0YWRhdGEnLFxuICAgICdvbmxvYWRzdGFydCcsXG4gICAgJ29ubG9zdHBvaW50ZXJjYXB0dXJlJyxcbiAgICAnb25tZXNzYWdlJyxcbiAgICAnb25tZXNzYWdlZXJyb3InLFxuICAgICdvbm1vdXNlZG93bicsXG4gICAgJ29ubW91c2VlbnRlcicsXG4gICAgJ29ubW91c2VsZWF2ZScsXG4gICAgJ29ubW91c2Vtb3ZlJyxcbiAgICAnb25tb3VzZW91dCcsXG4gICAgJ29ubW91c2VvdmVyJyxcbiAgICAnb25tb3VzZXVwJyxcbiAgICAnb25vZmZsaW5lJyxcbiAgICAnb25vbmxpbmUnLFxuICAgICdvbm9yaWVudGF0aW9uY2hhbmdlJyxcbiAgICAnb25wYWdlaGlkZScsXG4gICAgJ29ucGFnZXNob3cnLFxuICAgICdvbnBhdXNlJyxcbiAgICAnb25wbGF5JyxcbiAgICAnb25wbGF5aW5nJyxcbiAgICAnb25wb2ludGVyY2FuY2VsJyxcbiAgICAnb25wb2ludGVyZG93bicsXG4gICAgJ29ucG9pbnRlcmVudGVyJyxcbiAgICAnb25wb2ludGVybGVhdmUnLFxuICAgICdvbnBvaW50ZXJtb3ZlJyxcbiAgICAnb25wb2ludGVyb3V0JyxcbiAgICAnb25wb2ludGVyb3ZlcicsXG4gICAgJ29ucG9pbnRlcnVwJyxcbiAgICAnb25wb3BzdGF0ZScsXG4gICAgJ29ucHJvZ3Jlc3MnLFxuICAgICdvbnJhdGVjaGFuZ2UnLFxuICAgICdvbnJlamVjdGlvbmhhbmRsZWQnLFxuICAgICdvbnJlc2V0JyxcbiAgICAnb25yZXNpemUnLFxuICAgICdvbnNjcm9sbCcsXG4gICAgJ29uc2VjdXJpdHlwb2xpY3l2aW9sYXRpb24nLFxuICAgICdvbnNlZWtlZCcsXG4gICAgJ29uc2Vla2luZycsXG4gICAgJ29uc2VsZWN0JyxcbiAgICAnb25zZWxlY3Rpb25jaGFuZ2UnLFxuICAgICdvbnNlbGVjdHN0YXJ0JyxcbiAgICAnb25zbG90Y2hhbmdlJyxcbiAgICAnb25zdGFsbGVkJyxcbiAgICAnb25zdG9yYWdlJyxcbiAgICAnb25zdWJtaXQnLFxuICAgICdvbnN1c3BlbmQnLFxuICAgICdvbnRpbWV1cGRhdGUnLFxuICAgICdvbnRvZ2dsZScsXG4gICAgJ29udG91Y2hjYW5jZWwnLFxuICAgICdvbnRvdWNoZW5kJyxcbiAgICAnb250b3VjaG1vdmUnLFxuICAgICdvbnRvdWNoc3RhcnQnLFxuICAgICdvbnRyYW5zaXRpb25jYW5jZWwnLFxuICAgICdvbnRyYW5zaXRpb25lbmQnLFxuICAgICdvbnRyYW5zaXRpb25ydW4nLFxuICAgICdvbnRyYW5zaXRpb25zdGFydCcsXG4gICAgJ29udW5oYW5kbGVkcmVqZWN0aW9uJyxcbiAgICAnb251bmxvYWQnLFxuICAgICdvbnZvbHVtZWNoYW5nZScsXG4gICAgJ29ud2FpdGluZycsXG4gICAgJ29ud2Via2l0YW5pbWF0aW9uZW5kJyxcbiAgICAnb253ZWJraXRhbmltYXRpb25pdGVyYXRpb24nLFxuICAgICdvbndlYmtpdGFuaW1hdGlvbnN0YXJ0JyxcbiAgICAnb253ZWJraXR0cmFuc2l0aW9uZW5kJyxcbiAgICAnb253aGVlbCcsXG4gICAgJ29wZW4nLFxuICAgICdvcGVuZXInLFxuICAgICdvcmllbnRhdGlvbicsXG4gICAgJ29yaWdpbicsXG4gICAgJ291dGVySGVpZ2h0JyxcbiAgICAnb3V0ZXJXaWR0aCcsXG4gICAgJ3BhZ2VYT2Zmc2V0JyxcbiAgICAncGFnZVlPZmZzZXQnLFxuICAgICdwYXJlbnQnLFxuICAgICdwYXJzZUZsb2F0JyxcbiAgICAncGFyc2VJbnQnLFxuICAgICdwZXJmb3JtYW5jZScsXG4gICAgJ3BlcnNvbmFsYmFyJyxcbiAgICAncG9zdE1lc3NhZ2UnLFxuICAgICdwcmludCcsXG4gICAgJ3Byb2Nlc3MnLFxuICAgICdwcm9tcHQnLFxuICAgICdxdWV1ZU1pY3JvdGFzaycsXG4gICAgJ3JlbGVhc2VFdmVudHMnLFxuICAgICdyZW1vdmVFdmVudExpc3RlbmVyJyxcbiAgICAncmVwb3J0RXJyb3InLFxuICAgICdyZXF1ZXN0QW5pbWF0aW9uRnJhbWUnLFxuICAgICdyZXF1ZXN0SWRsZUNhbGxiYWNrJyxcbiAgICAncmVzaXplQnknLFxuICAgICdyZXNpemVUbycsXG4gICAgJ3NjcmVlbicsXG4gICAgJ3NjcmVlbkxlZnQnLFxuICAgICdzY3JlZW5Ub3AnLFxuICAgICdzY3JlZW5YJyxcbiAgICAnc2NyZWVuWScsXG4gICAgJ3Njcm9sbCcsXG4gICAgJ3Njcm9sbEJ5JyxcbiAgICAnc2Nyb2xsVG8nLFxuICAgICdzY3JvbGxYJyxcbiAgICAnc2Nyb2xsWScsXG4gICAgJ3Njcm9sbGJhcnMnLFxuICAgICdzZWxmJyxcbiAgICAnc2Vzc2lvblN0b3JhZ2UnLFxuICAgICdzZXRJbnRlcnZhbCcsXG4gICAgJ3NldFRpbWVvdXQnLFxuICAgICdzcGVlY2hTeW50aGVzaXMnLFxuICAgICdzdGF0dXMnLFxuICAgICdzdGF0dXNiYXInLFxuICAgICdzdG9wJyxcbiAgICAnc3RydWN0dXJlZENsb25lJyxcbiAgICAndG9TdHJpbmcnLFxuICAgICd0b29sYmFyJyxcbiAgICAndG9wJyxcbiAgICAndW5kZWZpbmVkJyxcbiAgICAndW5lc2NhcGUnLFxuICAgICd2aXN1YWxWaWV3cG9ydCcsXG4gICAgJ3dlYmtpdFVSTCcsXG4gICAgJ3dpbmRvdydcbl0pO1xuXG5jb25zdCB3cmFwcGVycyQxID0geyBlc20sIGNqcyB9O1xuZnVuY3Rpb24gY3JlYXRlX21vZHVsZShwcm9ncmFtLCBmb3JtYXQsIG5hbWUsIGJhbm5lciwgc3ZlbHRlUGF0aCA9ICdzdmVsdGUnLCBoZWxwZXJzLCBnbG9iYWxzLCBpbXBvcnRzLCBtb2R1bGVfZXhwb3J0cywgZXhwb3J0c19mcm9tKSB7XG4gICAgY29uc3QgaW50ZXJuYWxfcGF0aCA9IGAke3N2ZWx0ZVBhdGh9L2ludGVybmFsYDtcbiAgICBoZWxwZXJzLnNvcnQoKGEsIGIpID0+IChhLm5hbWUgPCBiLm5hbWUpID8gLTEgOiAxKTtcbiAgICBnbG9iYWxzLnNvcnQoKGEsIGIpID0+IChhLm5hbWUgPCBiLm5hbWUpID8gLTEgOiAxKTtcbiAgICBjb25zdCBmb3JtYXR0ZXIgPSB3cmFwcGVycyQxW2Zvcm1hdF07XG4gICAgaWYgKCFmb3JtYXR0ZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBvcHRpb25zLmZvcm1hdCBpcyBpbnZhbGlkIChtdXN0IGJlICR7bGlzdCQxKE9iamVjdC5rZXlzKHdyYXBwZXJzJDEpKX0pYCk7XG4gICAgfVxuICAgIHJldHVybiBmb3JtYXR0ZXIocHJvZ3JhbSwgbmFtZSwgYmFubmVyLCBzdmVsdGVQYXRoLCBpbnRlcm5hbF9wYXRoLCBoZWxwZXJzLCBnbG9iYWxzLCBpbXBvcnRzLCBtb2R1bGVfZXhwb3J0cywgZXhwb3J0c19mcm9tKTtcbn1cbmZ1bmN0aW9uIGVkaXRfc291cmNlKHNvdXJjZSwgc3ZlbHRlUGF0aCkge1xuICAgIHJldHVybiBzb3VyY2UgPT09ICdzdmVsdGUnIHx8IHNvdXJjZS5zdGFydHNXaXRoKCdzdmVsdGUvJylcbiAgICAgICAgPyBzb3VyY2UucmVwbGFjZSgnc3ZlbHRlJywgc3ZlbHRlUGF0aClcbiAgICAgICAgOiBzb3VyY2U7XG59XG5mdW5jdGlvbiBnZXRfaW50ZXJuYWxfZ2xvYmFscyhnbG9iYWxzLCBoZWxwZXJzKSB7XG4gICAgcmV0dXJuIGdsb2JhbHMubGVuZ3RoID4gMCAmJiB7XG4gICAgICAgIHR5cGU6ICdWYXJpYWJsZURlY2xhcmF0aW9uJyxcbiAgICAgICAga2luZDogJ2NvbnN0JyxcbiAgICAgICAgZGVjbGFyYXRpb25zOiBbe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdWYXJpYWJsZURlY2xhcmF0b3InLFxuICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdPYmplY3RQYXR0ZXJuJyxcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczogZ2xvYmFscy5tYXAoZyA9PiAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1Byb3BlcnR5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG9ydGhhbmQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogZy5uYW1lIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZy5hbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdpbml0J1xuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGluaXQ6IGhlbHBlcnMuZmluZCgoeyBuYW1lIH0pID0+IG5hbWUgPT09ICdnbG9iYWxzJykuYWxpYXNcbiAgICAgICAgICAgIH1dXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGVzbShwcm9ncmFtLCBuYW1lLCBiYW5uZXIsIHN2ZWx0ZVBhdGgsIGludGVybmFsX3BhdGgsIGhlbHBlcnMsIGdsb2JhbHMsIGltcG9ydHMsIG1vZHVsZV9leHBvcnRzLCBleHBvcnRzX2Zyb20pIHtcbiAgICBjb25zdCBpbXBvcnRfZGVjbGFyYXRpb24gPSB7XG4gICAgICAgIHR5cGU6ICdJbXBvcnREZWNsYXJhdGlvbicsXG4gICAgICAgIHNwZWNpZmllcnM6IGhlbHBlcnMubWFwKGggPT4gKHtcbiAgICAgICAgICAgIHR5cGU6ICdJbXBvcnRTcGVjaWZpZXInLFxuICAgICAgICAgICAgbG9jYWw6IGguYWxpYXMsXG4gICAgICAgICAgICBpbXBvcnRlZDogeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6IGgubmFtZSB9XG4gICAgICAgIH0pKSxcbiAgICAgICAgc291cmNlOiB7IHR5cGU6ICdMaXRlcmFsJywgdmFsdWU6IGludGVybmFsX3BhdGggfVxuICAgIH07XG4gICAgY29uc3QgaW50ZXJuYWxfZ2xvYmFscyA9IGdldF9pbnRlcm5hbF9nbG9iYWxzKGdsb2JhbHMsIGhlbHBlcnMpO1xuICAgIC8vIGVkaXQgdXNlciBpbXBvcnRzXG4gICAgZnVuY3Rpb24gcmV3cml0ZV9pbXBvcnQobm9kZSkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGVkaXRfc291cmNlKG5vZGUuc291cmNlLnZhbHVlLCBzdmVsdGVQYXRoKTtcbiAgICAgICAgaWYgKG5vZGUuc291cmNlLnZhbHVlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgbm9kZS5zb3VyY2UudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIG5vZGUuc291cmNlLnJhdyA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW1wb3J0cy5mb3JFYWNoKHJld3JpdGVfaW1wb3J0KTtcbiAgICBleHBvcnRzX2Zyb20uZm9yRWFjaChyZXdyaXRlX2ltcG9ydCk7XG4gICAgY29uc3QgZXhwb3J0cyA9IG1vZHVsZV9leHBvcnRzLmxlbmd0aCA+IDAgJiYge1xuICAgICAgICB0eXBlOiAnRXhwb3J0TmFtZWREZWNsYXJhdGlvbicsXG4gICAgICAgIHNwZWNpZmllcnM6IG1vZHVsZV9leHBvcnRzLm1hcCh4ID0+ICh7XG4gICAgICAgICAgICB0eXBlOiAnU3BlY2lmaWVyJyxcbiAgICAgICAgICAgIGxvY2FsOiB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogeC5uYW1lIH0sXG4gICAgICAgICAgICBleHBvcnRlZDogeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6IHguYXMgfVxuICAgICAgICB9KSlcbiAgICB9O1xuICAgIHByb2dyYW0uYm9keSA9IGIgYFxuXHRcdC8qICR7YmFubmVyfSAqL1xuXG5cdFx0JHtpbXBvcnRfZGVjbGFyYXRpb259XG5cdFx0JHtpbnRlcm5hbF9nbG9iYWxzfVxuXHRcdCR7aW1wb3J0c31cblx0XHQke2V4cG9ydHNfZnJvbX1cblxuXHRcdCR7cHJvZ3JhbS5ib2R5fVxuXG5cdFx0ZXhwb3J0IGRlZmF1bHQgJHtuYW1lfTtcblx0XHQke2V4cG9ydHN9XG5cdGA7XG59XG5mdW5jdGlvbiBjanMocHJvZ3JhbSwgbmFtZSwgYmFubmVyLCBzdmVsdGVQYXRoLCBpbnRlcm5hbF9wYXRoLCBoZWxwZXJzLCBnbG9iYWxzLCBpbXBvcnRzLCBtb2R1bGVfZXhwb3J0cywgZXhwb3J0c19mcm9tKSB7XG4gICAgY29uc3QgaW50ZXJuYWxfcmVxdWlyZXMgPSB7XG4gICAgICAgIHR5cGU6ICdWYXJpYWJsZURlY2xhcmF0aW9uJyxcbiAgICAgICAga2luZDogJ2NvbnN0JyxcbiAgICAgICAgZGVjbGFyYXRpb25zOiBbe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdWYXJpYWJsZURlY2xhcmF0b3InLFxuICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdPYmplY3RQYXR0ZXJuJyxcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczogaGVscGVycy5tYXAoaCA9PiAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1Byb3BlcnR5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG9ydGhhbmQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogaC5uYW1lIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogaC5hbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdpbml0J1xuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGluaXQ6IHggYHJlcXVpcmUoXCIke2ludGVybmFsX3BhdGh9XCIpYFxuICAgICAgICAgICAgfV1cbiAgICB9O1xuICAgIGNvbnN0IGludGVybmFsX2dsb2JhbHMgPSBnZXRfaW50ZXJuYWxfZ2xvYmFscyhnbG9iYWxzLCBoZWxwZXJzKTtcbiAgICBjb25zdCB1c2VyX3JlcXVpcmVzID0gaW1wb3J0cy5tYXAobm9kZSA9PiB7XG4gICAgICAgIGNvbnN0IGluaXQgPSB4IGByZXF1aXJlKFwiJHtlZGl0X3NvdXJjZShub2RlLnNvdXJjZS52YWx1ZSwgc3ZlbHRlUGF0aCl9XCIpYDtcbiAgICAgICAgaWYgKG5vZGUuc3BlY2lmaWVycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBiIGAke2luaXR9O2A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdWYXJpYWJsZURlY2xhcmF0aW9uJyxcbiAgICAgICAgICAgIGtpbmQ6ICdjb25zdCcsXG4gICAgICAgICAgICBkZWNsYXJhdGlvbnM6IFt7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdWYXJpYWJsZURlY2xhcmF0b3InLFxuICAgICAgICAgICAgICAgICAgICBpZDogbm9kZS5zcGVjaWZpZXJzWzBdLnR5cGUgPT09ICdJbXBvcnROYW1lc3BhY2VTcGVjaWZpZXInXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiBub2RlLnNwZWNpZmllcnNbMF0ubG9jYWwubmFtZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnT2JqZWN0UGF0dGVybicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczogbm9kZS5zcGVjaWZpZXJzLm1hcChzID0+ICh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQcm9wZXJ0eScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3J0aGFuZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXB1dGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBzLnR5cGUgPT09ICdJbXBvcnRTcGVjaWZpZXInID8gcy5pbXBvcnRlZCA6IHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiAnZGVmYXVsdCcgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHMubG9jYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdpbml0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaW5pdFxuICAgICAgICAgICAgICAgIH1dXG4gICAgICAgIH07XG4gICAgfSk7XG4gICAgY29uc3QgZXhwb3J0cyA9IG1vZHVsZV9leHBvcnRzLm1hcCh4ID0+IGIgYGV4cG9ydHMuJHt7IHR5cGU6ICdJZGVudGlmaWVyJywgbmFtZTogeC5hcyB9fSA9ICR7eyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6IHgubmFtZSB9fTtgKTtcbiAgICBjb25zdCB1c2VyX2V4cG9ydHNfZnJvbSA9IGV4cG9ydHNfZnJvbS5tYXAobm9kZSA9PiB7XG4gICAgICAgIGNvbnN0IGluaXQgPSB4IGByZXF1aXJlKFwiJHtlZGl0X3NvdXJjZShub2RlLnNvdXJjZS52YWx1ZSwgc3ZlbHRlUGF0aCl9XCIpYDtcbiAgICAgICAgcmV0dXJuIG5vZGUuc3BlY2lmaWVycy5tYXAoc3BlY2lmaWVyID0+IHtcbiAgICAgICAgICAgIHJldHVybiBiIGBleHBvcnRzLiR7c3BlY2lmaWVyLmV4cG9ydGVkfSA9ICR7aW5pdH0uJHtzcGVjaWZpZXIubG9jYWx9O2A7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHByb2dyYW0uYm9keSA9IGIgYFxuXHRcdC8qICR7YmFubmVyfSAqL1xuXG5cdFx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFx0JHtpbnRlcm5hbF9yZXF1aXJlc31cblx0XHQke2ludGVybmFsX2dsb2JhbHN9XG5cdFx0JHt1c2VyX3JlcXVpcmVzfVxuXHRcdCR7dXNlcl9leHBvcnRzX2Zyb219XG5cblx0XHQke3Byb2dyYW0uYm9keX1cblxuXHRcdGV4cG9ydHMuZGVmYXVsdCA9ICR7bmFtZX07XG5cdFx0JHtleHBvcnRzfVxuXHRgO1xufVxuXG52YXIgQ2h1bmsgPSBmdW5jdGlvbiBDaHVuayhzdGFydCwgZW5kLCBjb250ZW50KSB7XG5cdHRoaXMuc3RhcnQgPSBzdGFydDtcblx0dGhpcy5lbmQgPSBlbmQ7XG5cdHRoaXMub3JpZ2luYWwgPSBjb250ZW50O1xuXG5cdHRoaXMuaW50cm8gPSAnJztcblx0dGhpcy5vdXRybyA9ICcnO1xuXG5cdHRoaXMuY29udGVudCA9IGNvbnRlbnQ7XG5cdHRoaXMuc3RvcmVOYW1lID0gZmFsc2U7XG5cdHRoaXMuZWRpdGVkID0gZmFsc2U7XG5cblx0Ly8gd2UgbWFrZSB0aGVzZSBub24tZW51bWVyYWJsZSwgZm9yIHNhbml0eSB3aGlsZSBkZWJ1Z2dpbmdcblx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywge1xuXHRcdHByZXZpb3VzOiB7IHdyaXRhYmxlOiB0cnVlLCB2YWx1ZTogbnVsbCB9LFxuXHRcdG5leHQ6ICAgICB7IHdyaXRhYmxlOiB0cnVlLCB2YWx1ZTogbnVsbCB9XG5cdH0pO1xufTtcblxuQ2h1bmsucHJvdG90eXBlLmFwcGVuZExlZnQgPSBmdW5jdGlvbiBhcHBlbmRMZWZ0IChjb250ZW50KSB7XG5cdHRoaXMub3V0cm8gKz0gY29udGVudDtcbn07XG5cbkNodW5rLnByb3RvdHlwZS5hcHBlbmRSaWdodCA9IGZ1bmN0aW9uIGFwcGVuZFJpZ2h0IChjb250ZW50KSB7XG5cdHRoaXMuaW50cm8gPSB0aGlzLmludHJvICsgY29udGVudDtcbn07XG5cbkNodW5rLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uIGNsb25lICgpIHtcblx0dmFyIGNodW5rID0gbmV3IENodW5rKHRoaXMuc3RhcnQsIHRoaXMuZW5kLCB0aGlzLm9yaWdpbmFsKTtcblxuXHRjaHVuay5pbnRybyA9IHRoaXMuaW50cm87XG5cdGNodW5rLm91dHJvID0gdGhpcy5vdXRybztcblx0Y2h1bmsuY29udGVudCA9IHRoaXMuY29udGVudDtcblx0Y2h1bmsuc3RvcmVOYW1lID0gdGhpcy5zdG9yZU5hbWU7XG5cdGNodW5rLmVkaXRlZCA9IHRoaXMuZWRpdGVkO1xuXG5cdHJldHVybiBjaHVuaztcbn07XG5cbkNodW5rLnByb3RvdHlwZS5jb250YWlucyA9IGZ1bmN0aW9uIGNvbnRhaW5zIChpbmRleCkge1xuXHRyZXR1cm4gdGhpcy5zdGFydCA8IGluZGV4ICYmIGluZGV4IDwgdGhpcy5lbmQ7XG59O1xuXG5DaHVuay5wcm90b3R5cGUuZWFjaE5leHQgPSBmdW5jdGlvbiBlYWNoTmV4dCAoZm4pIHtcblx0dmFyIGNodW5rID0gdGhpcztcblx0d2hpbGUgKGNodW5rKSB7XG5cdFx0Zm4oY2h1bmspO1xuXHRcdGNodW5rID0gY2h1bmsubmV4dDtcblx0fVxufTtcblxuQ2h1bmsucHJvdG90eXBlLmVhY2hQcmV2aW91cyA9IGZ1bmN0aW9uIGVhY2hQcmV2aW91cyAoZm4pIHtcblx0dmFyIGNodW5rID0gdGhpcztcblx0d2hpbGUgKGNodW5rKSB7XG5cdFx0Zm4oY2h1bmspO1xuXHRcdGNodW5rID0gY2h1bmsucHJldmlvdXM7XG5cdH1cbn07XG5cbkNodW5rLnByb3RvdHlwZS5lZGl0ID0gZnVuY3Rpb24gZWRpdCAoY29udGVudCwgc3RvcmVOYW1lLCBjb250ZW50T25seSkge1xuXHR0aGlzLmNvbnRlbnQgPSBjb250ZW50O1xuXHRpZiAoIWNvbnRlbnRPbmx5KSB7XG5cdFx0dGhpcy5pbnRybyA9ICcnO1xuXHRcdHRoaXMub3V0cm8gPSAnJztcblx0fVxuXHR0aGlzLnN0b3JlTmFtZSA9IHN0b3JlTmFtZTtcblxuXHR0aGlzLmVkaXRlZCA9IHRydWU7XG5cblx0cmV0dXJuIHRoaXM7XG59O1xuXG5DaHVuay5wcm90b3R5cGUucHJlcGVuZExlZnQgPSBmdW5jdGlvbiBwcmVwZW5kTGVmdCAoY29udGVudCkge1xuXHR0aGlzLm91dHJvID0gY29udGVudCArIHRoaXMub3V0cm87XG59O1xuXG5DaHVuay5wcm90b3R5cGUucHJlcGVuZFJpZ2h0ID0gZnVuY3Rpb24gcHJlcGVuZFJpZ2h0IChjb250ZW50KSB7XG5cdHRoaXMuaW50cm8gPSBjb250ZW50ICsgdGhpcy5pbnRybztcbn07XG5cbkNodW5rLnByb3RvdHlwZS5zcGxpdCA9IGZ1bmN0aW9uIHNwbGl0IChpbmRleCkge1xuXHR2YXIgc2xpY2VJbmRleCA9IGluZGV4IC0gdGhpcy5zdGFydDtcblxuXHR2YXIgb3JpZ2luYWxCZWZvcmUgPSB0aGlzLm9yaWdpbmFsLnNsaWNlKDAsIHNsaWNlSW5kZXgpO1xuXHR2YXIgb3JpZ2luYWxBZnRlciA9IHRoaXMub3JpZ2luYWwuc2xpY2Uoc2xpY2VJbmRleCk7XG5cblx0dGhpcy5vcmlnaW5hbCA9IG9yaWdpbmFsQmVmb3JlO1xuXG5cdHZhciBuZXdDaHVuayA9IG5ldyBDaHVuayhpbmRleCwgdGhpcy5lbmQsIG9yaWdpbmFsQWZ0ZXIpO1xuXHRuZXdDaHVuay5vdXRybyA9IHRoaXMub3V0cm87XG5cdHRoaXMub3V0cm8gPSAnJztcblxuXHR0aGlzLmVuZCA9IGluZGV4O1xuXG5cdGlmICh0aGlzLmVkaXRlZCkge1xuXHRcdC8vIFRPRE8gaXMgdGhpcyBibG9jayBuZWNlc3Nhcnk/Li4uXG5cdFx0bmV3Q2h1bmsuZWRpdCgnJywgZmFsc2UpO1xuXHRcdHRoaXMuY29udGVudCA9ICcnO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuY29udGVudCA9IG9yaWdpbmFsQmVmb3JlO1xuXHR9XG5cblx0bmV3Q2h1bmsubmV4dCA9IHRoaXMubmV4dDtcblx0aWYgKG5ld0NodW5rLm5leHQpIHsgbmV3Q2h1bmsubmV4dC5wcmV2aW91cyA9IG5ld0NodW5rOyB9XG5cdG5ld0NodW5rLnByZXZpb3VzID0gdGhpcztcblx0dGhpcy5uZXh0ID0gbmV3Q2h1bms7XG5cblx0cmV0dXJuIG5ld0NodW5rO1xufTtcblxuQ2h1bmsucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkge1xuXHRyZXR1cm4gdGhpcy5pbnRybyArIHRoaXMuY29udGVudCArIHRoaXMub3V0cm87XG59O1xuXG5DaHVuay5wcm90b3R5cGUudHJpbUVuZCA9IGZ1bmN0aW9uIHRyaW1FbmQgKHJ4KSB7XG5cdHRoaXMub3V0cm8gPSB0aGlzLm91dHJvLnJlcGxhY2UocngsICcnKTtcblx0aWYgKHRoaXMub3V0cm8ubGVuZ3RoKSB7IHJldHVybiB0cnVlOyB9XG5cblx0dmFyIHRyaW1tZWQgPSB0aGlzLmNvbnRlbnQucmVwbGFjZShyeCwgJycpO1xuXG5cdGlmICh0cmltbWVkLmxlbmd0aCkge1xuXHRcdGlmICh0cmltbWVkICE9PSB0aGlzLmNvbnRlbnQpIHtcblx0XHRcdHRoaXMuc3BsaXQodGhpcy5zdGFydCArIHRyaW1tZWQubGVuZ3RoKS5lZGl0KCcnLCB1bmRlZmluZWQsIHRydWUpO1xuXHRcdH1cblx0XHRyZXR1cm4gdHJ1ZTtcblxuXHR9IGVsc2Uge1xuXHRcdHRoaXMuZWRpdCgnJywgdW5kZWZpbmVkLCB0cnVlKTtcblxuXHRcdHRoaXMuaW50cm8gPSB0aGlzLmludHJvLnJlcGxhY2UocngsICcnKTtcblx0XHRpZiAodGhpcy5pbnRyby5sZW5ndGgpIHsgcmV0dXJuIHRydWU7IH1cblx0fVxufTtcblxuQ2h1bmsucHJvdG90eXBlLnRyaW1TdGFydCA9IGZ1bmN0aW9uIHRyaW1TdGFydCAocngpIHtcblx0dGhpcy5pbnRybyA9IHRoaXMuaW50cm8ucmVwbGFjZShyeCwgJycpO1xuXHRpZiAodGhpcy5pbnRyby5sZW5ndGgpIHsgcmV0dXJuIHRydWU7IH1cblxuXHR2YXIgdHJpbW1lZCA9IHRoaXMuY29udGVudC5yZXBsYWNlKHJ4LCAnJyk7XG5cblx0aWYgKHRyaW1tZWQubGVuZ3RoKSB7XG5cdFx0aWYgKHRyaW1tZWQgIT09IHRoaXMuY29udGVudCkge1xuXHRcdFx0dGhpcy5zcGxpdCh0aGlzLmVuZCAtIHRyaW1tZWQubGVuZ3RoKTtcblx0XHRcdHRoaXMuZWRpdCgnJywgdW5kZWZpbmVkLCB0cnVlKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRydWU7XG5cblx0fSBlbHNlIHtcblx0XHR0aGlzLmVkaXQoJycsIHVuZGVmaW5lZCwgdHJ1ZSk7XG5cblx0XHR0aGlzLm91dHJvID0gdGhpcy5vdXRyby5yZXBsYWNlKHJ4LCAnJyk7XG5cdFx0aWYgKHRoaXMub3V0cm8ubGVuZ3RoKSB7IHJldHVybiB0cnVlOyB9XG5cdH1cbn07XG5cbnZhciBidG9hJDIgPSBmdW5jdGlvbiAoKSB7XG5cdHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgZW52aXJvbm1lbnQ6IGB3aW5kb3cuYnRvYWAgb3IgYEJ1ZmZlcmAgc2hvdWxkIGJlIHN1cHBvcnRlZC4nKTtcbn07XG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5idG9hID09PSAnZnVuY3Rpb24nKSB7XG5cdGJ0b2EkMiA9IGZ1bmN0aW9uIChzdHIpIHsgcmV0dXJuIHdpbmRvdy5idG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChzdHIpKSk7IH07XG59IGVsc2UgaWYgKHR5cGVvZiBCdWZmZXIgPT09ICdmdW5jdGlvbicpIHtcblx0YnRvYSQyID0gZnVuY3Rpb24gKHN0cikgeyByZXR1cm4gQnVmZmVyLmZyb20oc3RyLCAndXRmLTgnKS50b1N0cmluZygnYmFzZTY0Jyk7IH07XG59XG5cbnZhciBTb3VyY2VNYXAkMSA9IGZ1bmN0aW9uIFNvdXJjZU1hcChwcm9wZXJ0aWVzKSB7XG5cdHRoaXMudmVyc2lvbiA9IDM7XG5cdHRoaXMuZmlsZSA9IHByb3BlcnRpZXMuZmlsZTtcblx0dGhpcy5zb3VyY2VzID0gcHJvcGVydGllcy5zb3VyY2VzO1xuXHR0aGlzLnNvdXJjZXNDb250ZW50ID0gcHJvcGVydGllcy5zb3VyY2VzQ29udGVudDtcblx0dGhpcy5uYW1lcyA9IHByb3BlcnRpZXMubmFtZXM7XG5cdHRoaXMubWFwcGluZ3MgPSBlbmNvZGUocHJvcGVydGllcy5tYXBwaW5ncyk7XG59O1xuXG5Tb3VyY2VNYXAkMS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZyAoKSB7XG5cdHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbn07XG5cblNvdXJjZU1hcCQxLnByb3RvdHlwZS50b1VybCA9IGZ1bmN0aW9uIHRvVXJsICgpIHtcblx0cmV0dXJuICdkYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtODtiYXNlNjQsJyArIGJ0b2EkMih0aGlzLnRvU3RyaW5nKCkpO1xufTtcblxuZnVuY3Rpb24gZ3Vlc3NJbmRlbnQoY29kZSkge1xuXHR2YXIgbGluZXMgPSBjb2RlLnNwbGl0KCdcXG4nKTtcblxuXHR2YXIgdGFiYmVkID0gbGluZXMuZmlsdGVyKGZ1bmN0aW9uIChsaW5lKSB7IHJldHVybiAvXlxcdCsvLnRlc3QobGluZSk7IH0pO1xuXHR2YXIgc3BhY2VkID0gbGluZXMuZmlsdGVyKGZ1bmN0aW9uIChsaW5lKSB7IHJldHVybiAvXiB7Mix9Ly50ZXN0KGxpbmUpOyB9KTtcblxuXHRpZiAodGFiYmVkLmxlbmd0aCA9PT0gMCAmJiBzcGFjZWQubGVuZ3RoID09PSAwKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHQvLyBNb3JlIGxpbmVzIHRhYmJlZCB0aGFuIHNwYWNlZD8gQXNzdW1lIHRhYnMsIGFuZFxuXHQvLyBkZWZhdWx0IHRvIHRhYnMgaW4gdGhlIGNhc2Ugb2YgYSB0aWUgKG9yIG5vdGhpbmdcblx0Ly8gdG8gZ28gb24pXG5cdGlmICh0YWJiZWQubGVuZ3RoID49IHNwYWNlZC5sZW5ndGgpIHtcblx0XHRyZXR1cm4gJ1xcdCc7XG5cdH1cblxuXHQvLyBPdGhlcndpc2UsIHdlIG5lZWQgdG8gZ3Vlc3MgdGhlIG11bHRpcGxlXG5cdHZhciBtaW4gPSBzcGFjZWQucmVkdWNlKGZ1bmN0aW9uIChwcmV2aW91cywgY3VycmVudCkge1xuXHRcdHZhciBudW1TcGFjZXMgPSAvXiArLy5leGVjKGN1cnJlbnQpWzBdLmxlbmd0aDtcblx0XHRyZXR1cm4gTWF0aC5taW4obnVtU3BhY2VzLCBwcmV2aW91cyk7XG5cdH0sIEluZmluaXR5KTtcblxuXHRyZXR1cm4gbmV3IEFycmF5KG1pbiArIDEpLmpvaW4oJyAnKTtcbn1cblxuZnVuY3Rpb24gZ2V0UmVsYXRpdmVQYXRoKGZyb20sIHRvKSB7XG5cdHZhciBmcm9tUGFydHMgPSBmcm9tLnNwbGl0KC9bL1xcXFxdLyk7XG5cdHZhciB0b1BhcnRzID0gdG8uc3BsaXQoL1svXFxcXF0vKTtcblxuXHRmcm9tUGFydHMucG9wKCk7IC8vIGdldCBkaXJuYW1lXG5cblx0d2hpbGUgKGZyb21QYXJ0c1swXSA9PT0gdG9QYXJ0c1swXSkge1xuXHRcdGZyb21QYXJ0cy5zaGlmdCgpO1xuXHRcdHRvUGFydHMuc2hpZnQoKTtcblx0fVxuXG5cdGlmIChmcm9tUGFydHMubGVuZ3RoKSB7XG5cdFx0dmFyIGkgPSBmcm9tUGFydHMubGVuZ3RoO1xuXHRcdHdoaWxlIChpLS0pIHsgZnJvbVBhcnRzW2ldID0gJy4uJzsgfVxuXHR9XG5cblx0cmV0dXJuIGZyb21QYXJ0cy5jb25jYXQodG9QYXJ0cykuam9pbignLycpO1xufVxuXG52YXIgdG9TdHJpbmckMSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KHRoaW5nKSB7XG5cdHJldHVybiB0b1N0cmluZyQxLmNhbGwodGhpbmcpID09PSAnW29iamVjdCBPYmplY3RdJztcbn1cblxuZnVuY3Rpb24gZ2V0TG9jYXRvciQxKHNvdXJjZSkge1xuXHR2YXIgb3JpZ2luYWxMaW5lcyA9IHNvdXJjZS5zcGxpdCgnXFxuJyk7XG5cdHZhciBsaW5lT2Zmc2V0cyA9IFtdO1xuXG5cdGZvciAodmFyIGkgPSAwLCBwb3MgPSAwOyBpIDwgb3JpZ2luYWxMaW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdGxpbmVPZmZzZXRzLnB1c2gocG9zKTtcblx0XHRwb3MgKz0gb3JpZ2luYWxMaW5lc1tpXS5sZW5ndGggKyAxO1xuXHR9XG5cblx0cmV0dXJuIGZ1bmN0aW9uIGxvY2F0ZShpbmRleCkge1xuXHRcdHZhciBpID0gMDtcblx0XHR2YXIgaiA9IGxpbmVPZmZzZXRzLmxlbmd0aDtcblx0XHR3aGlsZSAoaSA8IGopIHtcblx0XHRcdHZhciBtID0gKGkgKyBqKSA+PiAxO1xuXHRcdFx0aWYgKGluZGV4IDwgbGluZU9mZnNldHNbbV0pIHtcblx0XHRcdFx0aiA9IG07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpID0gbSArIDE7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHZhciBsaW5lID0gaSAtIDE7XG5cdFx0dmFyIGNvbHVtbiA9IGluZGV4IC0gbGluZU9mZnNldHNbbGluZV07XG5cdFx0cmV0dXJuIHsgbGluZTogbGluZSwgY29sdW1uOiBjb2x1bW4gfTtcblx0fTtcbn1cblxudmFyIE1hcHBpbmdzID0gZnVuY3Rpb24gTWFwcGluZ3MoaGlyZXMpIHtcblx0dGhpcy5oaXJlcyA9IGhpcmVzO1xuXHR0aGlzLmdlbmVyYXRlZENvZGVMaW5lID0gMDtcblx0dGhpcy5nZW5lcmF0ZWRDb2RlQ29sdW1uID0gMDtcblx0dGhpcy5yYXcgPSBbXTtcblx0dGhpcy5yYXdTZWdtZW50cyA9IHRoaXMucmF3W3RoaXMuZ2VuZXJhdGVkQ29kZUxpbmVdID0gW107XG5cdHRoaXMucGVuZGluZyA9IG51bGw7XG59O1xuXG5NYXBwaW5ncy5wcm90b3R5cGUuYWRkRWRpdCA9IGZ1bmN0aW9uIGFkZEVkaXQgKHNvdXJjZUluZGV4LCBjb250ZW50LCBsb2MsIG5hbWVJbmRleCkge1xuXHRpZiAoY29udGVudC5sZW5ndGgpIHtcblx0XHR2YXIgc2VnbWVudCA9IFt0aGlzLmdlbmVyYXRlZENvZGVDb2x1bW4sIHNvdXJjZUluZGV4LCBsb2MubGluZSwgbG9jLmNvbHVtbl07XG5cdFx0aWYgKG5hbWVJbmRleCA+PSAwKSB7XG5cdFx0XHRzZWdtZW50LnB1c2gobmFtZUluZGV4KTtcblx0XHR9XG5cdFx0dGhpcy5yYXdTZWdtZW50cy5wdXNoKHNlZ21lbnQpO1xuXHR9IGVsc2UgaWYgKHRoaXMucGVuZGluZykge1xuXHRcdHRoaXMucmF3U2VnbWVudHMucHVzaCh0aGlzLnBlbmRpbmcpO1xuXHR9XG5cblx0dGhpcy5hZHZhbmNlKGNvbnRlbnQpO1xuXHR0aGlzLnBlbmRpbmcgPSBudWxsO1xufTtcblxuTWFwcGluZ3MucHJvdG90eXBlLmFkZFVuZWRpdGVkQ2h1bmsgPSBmdW5jdGlvbiBhZGRVbmVkaXRlZENodW5rIChzb3VyY2VJbmRleCwgY2h1bmssIG9yaWdpbmFsLCBsb2MsIHNvdXJjZW1hcExvY2F0aW9ucykge1xuXHR2YXIgb3JpZ2luYWxDaGFySW5kZXggPSBjaHVuay5zdGFydDtcblx0dmFyIGZpcnN0ID0gdHJ1ZTtcblxuXHR3aGlsZSAob3JpZ2luYWxDaGFySW5kZXggPCBjaHVuay5lbmQpIHtcblx0XHRpZiAodGhpcy5oaXJlcyB8fCBmaXJzdCB8fCBzb3VyY2VtYXBMb2NhdGlvbnNbb3JpZ2luYWxDaGFySW5kZXhdKSB7XG5cdFx0XHR0aGlzLnJhd1NlZ21lbnRzLnB1c2goW3RoaXMuZ2VuZXJhdGVkQ29kZUNvbHVtbiwgc291cmNlSW5kZXgsIGxvYy5saW5lLCBsb2MuY29sdW1uXSk7XG5cdFx0fVxuXG5cdFx0aWYgKG9yaWdpbmFsW29yaWdpbmFsQ2hhckluZGV4XSA9PT0gJ1xcbicpIHtcblx0XHRcdGxvYy5saW5lICs9IDE7XG5cdFx0XHRsb2MuY29sdW1uID0gMDtcblx0XHRcdHRoaXMuZ2VuZXJhdGVkQ29kZUxpbmUgKz0gMTtcblx0XHRcdHRoaXMucmF3W3RoaXMuZ2VuZXJhdGVkQ29kZUxpbmVdID0gdGhpcy5yYXdTZWdtZW50cyA9IFtdO1xuXHRcdFx0dGhpcy5nZW5lcmF0ZWRDb2RlQ29sdW1uID0gMDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bG9jLmNvbHVtbiArPSAxO1xuXHRcdFx0dGhpcy5nZW5lcmF0ZWRDb2RlQ29sdW1uICs9IDE7XG5cdFx0fVxuXG5cdFx0b3JpZ2luYWxDaGFySW5kZXggKz0gMTtcblx0XHRmaXJzdCA9IGZhbHNlO1xuXHR9XG5cblx0dGhpcy5wZW5kaW5nID0gW3RoaXMuZ2VuZXJhdGVkQ29kZUNvbHVtbiwgc291cmNlSW5kZXgsIGxvYy5saW5lLCBsb2MuY29sdW1uXTtcbn07XG5cbk1hcHBpbmdzLnByb3RvdHlwZS5hZHZhbmNlID0gZnVuY3Rpb24gYWR2YW5jZSAoc3RyKSB7XG5cdGlmICghc3RyKSB7IHJldHVybjsgfVxuXG5cdHZhciBsaW5lcyA9IHN0ci5zcGxpdCgnXFxuJyk7XG5cblx0aWYgKGxpbmVzLmxlbmd0aCA+IDEpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aCAtIDE7IGkrKykge1xuXHRcdFx0dGhpcy5nZW5lcmF0ZWRDb2RlTGluZSsrO1xuXHRcdFx0dGhpcy5yYXdbdGhpcy5nZW5lcmF0ZWRDb2RlTGluZV0gPSB0aGlzLnJhd1NlZ21lbnRzID0gW107XG5cdFx0fVxuXHRcdHRoaXMuZ2VuZXJhdGVkQ29kZUNvbHVtbiA9IDA7XG5cdH1cblxuXHR0aGlzLmdlbmVyYXRlZENvZGVDb2x1bW4gKz0gbGluZXNbbGluZXMubGVuZ3RoIC0gMV0ubGVuZ3RoO1xufTtcblxudmFyIG4gPSAnXFxuJztcblxudmFyIHdhcm5lZCA9IHtcblx0aW5zZXJ0TGVmdDogZmFsc2UsXG5cdGluc2VydFJpZ2h0OiBmYWxzZSxcblx0c3RvcmVOYW1lOiBmYWxzZVxufTtcblxudmFyIE1hZ2ljU3RyaW5nID0gZnVuY3Rpb24gTWFnaWNTdHJpbmcoc3RyaW5nLCBvcHRpb25zKSB7XG5cdGlmICggb3B0aW9ucyA9PT0gdm9pZCAwICkgb3B0aW9ucyA9IHt9O1xuXG5cdHZhciBjaHVuayA9IG5ldyBDaHVuaygwLCBzdHJpbmcubGVuZ3RoLCBzdHJpbmcpO1xuXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHtcblx0XHRvcmlnaW5hbDogICAgICAgICAgICAgIHsgd3JpdGFibGU6IHRydWUsIHZhbHVlOiBzdHJpbmcgfSxcblx0XHRvdXRybzogICAgICAgICAgICAgICAgIHsgd3JpdGFibGU6IHRydWUsIHZhbHVlOiAnJyB9LFxuXHRcdGludHJvOiAgICAgICAgICAgICAgICAgeyB3cml0YWJsZTogdHJ1ZSwgdmFsdWU6ICcnIH0sXG5cdFx0Zmlyc3RDaHVuazogICAgICAgICAgICB7IHdyaXRhYmxlOiB0cnVlLCB2YWx1ZTogY2h1bmsgfSxcblx0XHRsYXN0Q2h1bms6ICAgICAgICAgICAgIHsgd3JpdGFibGU6IHRydWUsIHZhbHVlOiBjaHVuayB9LFxuXHRcdGxhc3RTZWFyY2hlZENodW5rOiAgICAgeyB3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGNodW5rIH0sXG5cdFx0YnlTdGFydDogICAgICAgICAgICAgICB7IHdyaXRhYmxlOiB0cnVlLCB2YWx1ZToge30gfSxcblx0XHRieUVuZDogICAgICAgICAgICAgICAgIHsgd3JpdGFibGU6IHRydWUsIHZhbHVlOiB7fSB9LFxuXHRcdGZpbGVuYW1lOiAgICAgICAgICAgICAgeyB3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IG9wdGlvbnMuZmlsZW5hbWUgfSxcblx0XHRpbmRlbnRFeGNsdXNpb25SYW5nZXM6IHsgd3JpdGFibGU6IHRydWUsIHZhbHVlOiBvcHRpb25zLmluZGVudEV4Y2x1c2lvblJhbmdlcyB9LFxuXHRcdHNvdXJjZW1hcExvY2F0aW9uczogICAgeyB3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IHt9IH0sXG5cdFx0c3RvcmVkTmFtZXM6ICAgICAgICAgICB7IHdyaXRhYmxlOiB0cnVlLCB2YWx1ZToge30gfSxcblx0XHRpbmRlbnRTdHI6ICAgICAgICAgICAgIHsgd3JpdGFibGU6IHRydWUsIHZhbHVlOiBndWVzc0luZGVudChzdHJpbmcpIH1cblx0fSk7XG5cblx0dGhpcy5ieVN0YXJ0WzBdID0gY2h1bms7XG5cdHRoaXMuYnlFbmRbc3RyaW5nLmxlbmd0aF0gPSBjaHVuaztcbn07XG5cbk1hZ2ljU3RyaW5nLnByb3RvdHlwZS5hZGRTb3VyY2VtYXBMb2NhdGlvbiA9IGZ1bmN0aW9uIGFkZFNvdXJjZW1hcExvY2F0aW9uIChjaGFyKSB7XG5cdHRoaXMuc291cmNlbWFwTG9jYXRpb25zW2NoYXJdID0gdHJ1ZTtcbn07XG5cbk1hZ2ljU3RyaW5nLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiBhcHBlbmQgKGNvbnRlbnQpIHtcblx0aWYgKHR5cGVvZiBjb250ZW50ICE9PSAnc3RyaW5nJykgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdvdXRybyBjb250ZW50IG11c3QgYmUgYSBzdHJpbmcnKTsgfVxuXG5cdHRoaXMub3V0cm8gKz0gY29udGVudDtcblx0cmV0dXJuIHRoaXM7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUuYXBwZW5kTGVmdCA9IGZ1bmN0aW9uIGFwcGVuZExlZnQgKGluZGV4LCBjb250ZW50KSB7XG5cdGlmICh0eXBlb2YgY29udGVudCAhPT0gJ3N0cmluZycpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignaW5zZXJ0ZWQgY29udGVudCBtdXN0IGJlIGEgc3RyaW5nJyk7IH1cblxuXHR0aGlzLl9zcGxpdChpbmRleCk7XG5cblx0dmFyIGNodW5rID0gdGhpcy5ieUVuZFtpbmRleF07XG5cblx0aWYgKGNodW5rKSB7XG5cdFx0Y2h1bmsuYXBwZW5kTGVmdChjb250ZW50KTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLmludHJvICs9IGNvbnRlbnQ7XG5cdH1cblx0cmV0dXJuIHRoaXM7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUuYXBwZW5kUmlnaHQgPSBmdW5jdGlvbiBhcHBlbmRSaWdodCAoaW5kZXgsIGNvbnRlbnQpIHtcblx0aWYgKHR5cGVvZiBjb250ZW50ICE9PSAnc3RyaW5nJykgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnNlcnRlZCBjb250ZW50IG11c3QgYmUgYSBzdHJpbmcnKTsgfVxuXG5cdHRoaXMuX3NwbGl0KGluZGV4KTtcblxuXHR2YXIgY2h1bmsgPSB0aGlzLmJ5U3RhcnRbaW5kZXhdO1xuXG5cdGlmIChjaHVuaykge1xuXHRcdGNodW5rLmFwcGVuZFJpZ2h0KGNvbnRlbnQpO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMub3V0cm8gKz0gY29udGVudDtcblx0fVxuXHRyZXR1cm4gdGhpcztcbn07XG5cbk1hZ2ljU3RyaW5nLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uIGNsb25lICgpIHtcblx0dmFyIGNsb25lZCA9IG5ldyBNYWdpY1N0cmluZyh0aGlzLm9yaWdpbmFsLCB7IGZpbGVuYW1lOiB0aGlzLmZpbGVuYW1lIH0pO1xuXG5cdHZhciBvcmlnaW5hbENodW5rID0gdGhpcy5maXJzdENodW5rO1xuXHR2YXIgY2xvbmVkQ2h1bmsgPSAoY2xvbmVkLmZpcnN0Q2h1bmsgPSBjbG9uZWQubGFzdFNlYXJjaGVkQ2h1bmsgPSBvcmlnaW5hbENodW5rLmNsb25lKCkpO1xuXG5cdHdoaWxlIChvcmlnaW5hbENodW5rKSB7XG5cdFx0Y2xvbmVkLmJ5U3RhcnRbY2xvbmVkQ2h1bmsuc3RhcnRdID0gY2xvbmVkQ2h1bms7XG5cdFx0Y2xvbmVkLmJ5RW5kW2Nsb25lZENodW5rLmVuZF0gPSBjbG9uZWRDaHVuaztcblxuXHRcdHZhciBuZXh0T3JpZ2luYWxDaHVuayA9IG9yaWdpbmFsQ2h1bmsubmV4dDtcblx0XHR2YXIgbmV4dENsb25lZENodW5rID0gbmV4dE9yaWdpbmFsQ2h1bmsgJiYgbmV4dE9yaWdpbmFsQ2h1bmsuY2xvbmUoKTtcblxuXHRcdGlmIChuZXh0Q2xvbmVkQ2h1bmspIHtcblx0XHRcdGNsb25lZENodW5rLm5leHQgPSBuZXh0Q2xvbmVkQ2h1bms7XG5cdFx0XHRuZXh0Q2xvbmVkQ2h1bmsucHJldmlvdXMgPSBjbG9uZWRDaHVuaztcblxuXHRcdFx0Y2xvbmVkQ2h1bmsgPSBuZXh0Q2xvbmVkQ2h1bms7XG5cdFx0fVxuXG5cdFx0b3JpZ2luYWxDaHVuayA9IG5leHRPcmlnaW5hbENodW5rO1xuXHR9XG5cblx0Y2xvbmVkLmxhc3RDaHVuayA9IGNsb25lZENodW5rO1xuXG5cdGlmICh0aGlzLmluZGVudEV4Y2x1c2lvblJhbmdlcykge1xuXHRcdGNsb25lZC5pbmRlbnRFeGNsdXNpb25SYW5nZXMgPSB0aGlzLmluZGVudEV4Y2x1c2lvblJhbmdlcy5zbGljZSgpO1xuXHR9XG5cblx0T2JqZWN0LmtleXModGhpcy5zb3VyY2VtYXBMb2NhdGlvbnMpLmZvckVhY2goZnVuY3Rpb24gKGxvYykge1xuXHRcdGNsb25lZC5zb3VyY2VtYXBMb2NhdGlvbnNbbG9jXSA9IHRydWU7XG5cdH0pO1xuXG5cdHJldHVybiBjbG9uZWQ7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUuZ2VuZXJhdGVEZWNvZGVkTWFwID0gZnVuY3Rpb24gZ2VuZXJhdGVEZWNvZGVkTWFwIChvcHRpb25zKSB7XG5cdFx0dmFyIHRoaXMkMSA9IHRoaXM7XG5cblx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cblx0dmFyIHNvdXJjZUluZGV4ID0gMDtcblx0dmFyIG5hbWVzID0gT2JqZWN0LmtleXModGhpcy5zdG9yZWROYW1lcyk7XG5cdHZhciBtYXBwaW5ncyA9IG5ldyBNYXBwaW5ncyhvcHRpb25zLmhpcmVzKTtcblxuXHR2YXIgbG9jYXRlID0gZ2V0TG9jYXRvciQxKHRoaXMub3JpZ2luYWwpO1xuXG5cdGlmICh0aGlzLmludHJvKSB7XG5cdFx0bWFwcGluZ3MuYWR2YW5jZSh0aGlzLmludHJvKTtcblx0fVxuXG5cdHRoaXMuZmlyc3RDaHVuay5lYWNoTmV4dChmdW5jdGlvbiAoY2h1bmspIHtcblx0XHR2YXIgbG9jID0gbG9jYXRlKGNodW5rLnN0YXJ0KTtcblxuXHRcdGlmIChjaHVuay5pbnRyby5sZW5ndGgpIHsgbWFwcGluZ3MuYWR2YW5jZShjaHVuay5pbnRybyk7IH1cblxuXHRcdGlmIChjaHVuay5lZGl0ZWQpIHtcblx0XHRcdG1hcHBpbmdzLmFkZEVkaXQoXG5cdFx0XHRcdHNvdXJjZUluZGV4LFxuXHRcdFx0XHRjaHVuay5jb250ZW50LFxuXHRcdFx0XHRsb2MsXG5cdFx0XHRcdGNodW5rLnN0b3JlTmFtZSA/IG5hbWVzLmluZGV4T2YoY2h1bmsub3JpZ2luYWwpIDogLTFcblx0XHRcdCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG1hcHBpbmdzLmFkZFVuZWRpdGVkQ2h1bmsoc291cmNlSW5kZXgsIGNodW5rLCB0aGlzJDEub3JpZ2luYWwsIGxvYywgdGhpcyQxLnNvdXJjZW1hcExvY2F0aW9ucyk7XG5cdFx0fVxuXG5cdFx0aWYgKGNodW5rLm91dHJvLmxlbmd0aCkgeyBtYXBwaW5ncy5hZHZhbmNlKGNodW5rLm91dHJvKTsgfVxuXHR9KTtcblxuXHRyZXR1cm4ge1xuXHRcdGZpbGU6IG9wdGlvbnMuZmlsZSA/IG9wdGlvbnMuZmlsZS5zcGxpdCgvWy9cXFxcXS8pLnBvcCgpIDogbnVsbCxcblx0XHRzb3VyY2VzOiBbb3B0aW9ucy5zb3VyY2UgPyBnZXRSZWxhdGl2ZVBhdGgob3B0aW9ucy5maWxlIHx8ICcnLCBvcHRpb25zLnNvdXJjZSkgOiBudWxsXSxcblx0XHRzb3VyY2VzQ29udGVudDogb3B0aW9ucy5pbmNsdWRlQ29udGVudCA/IFt0aGlzLm9yaWdpbmFsXSA6IFtudWxsXSxcblx0XHRuYW1lczogbmFtZXMsXG5cdFx0bWFwcGluZ3M6IG1hcHBpbmdzLnJhd1xuXHR9O1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLmdlbmVyYXRlTWFwID0gZnVuY3Rpb24gZ2VuZXJhdGVNYXAgKG9wdGlvbnMpIHtcblx0cmV0dXJuIG5ldyBTb3VyY2VNYXAkMSh0aGlzLmdlbmVyYXRlRGVjb2RlZE1hcChvcHRpb25zKSk7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUuZ2V0SW5kZW50U3RyaW5nID0gZnVuY3Rpb24gZ2V0SW5kZW50U3RyaW5nICgpIHtcblx0cmV0dXJuIHRoaXMuaW5kZW50U3RyID09PSBudWxsID8gJ1xcdCcgOiB0aGlzLmluZGVudFN0cjtcbn07XG5cbk1hZ2ljU3RyaW5nLnByb3RvdHlwZS5pbmRlbnQgPSBmdW5jdGlvbiBpbmRlbnQgKGluZGVudFN0ciwgb3B0aW9ucykge1xuXHR2YXIgcGF0dGVybiA9IC9eW15cXHJcXG5dL2dtO1xuXG5cdGlmIChpc09iamVjdChpbmRlbnRTdHIpKSB7XG5cdFx0b3B0aW9ucyA9IGluZGVudFN0cjtcblx0XHRpbmRlbnRTdHIgPSB1bmRlZmluZWQ7XG5cdH1cblxuXHRpbmRlbnRTdHIgPSBpbmRlbnRTdHIgIT09IHVuZGVmaW5lZCA/IGluZGVudFN0ciA6IHRoaXMuaW5kZW50U3RyIHx8ICdcXHQnO1xuXG5cdGlmIChpbmRlbnRTdHIgPT09ICcnKSB7IHJldHVybiB0aGlzOyB9IC8vIG5vb3BcblxuXHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuXHQvLyBQcm9jZXNzIGV4Y2x1c2lvbiByYW5nZXNcblx0dmFyIGlzRXhjbHVkZWQgPSB7fTtcblxuXHRpZiAob3B0aW9ucy5leGNsdWRlKSB7XG5cdFx0dmFyIGV4Y2x1c2lvbnMgPVxuXHRcdFx0dHlwZW9mIG9wdGlvbnMuZXhjbHVkZVswXSA9PT0gJ251bWJlcicgPyBbb3B0aW9ucy5leGNsdWRlXSA6IG9wdGlvbnMuZXhjbHVkZTtcblx0XHRleGNsdXNpb25zLmZvckVhY2goZnVuY3Rpb24gKGV4Y2x1c2lvbikge1xuXHRcdFx0Zm9yICh2YXIgaSA9IGV4Y2x1c2lvblswXTsgaSA8IGV4Y2x1c2lvblsxXTsgaSArPSAxKSB7XG5cdFx0XHRcdGlzRXhjbHVkZWRbaV0gPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0dmFyIHNob3VsZEluZGVudE5leHRDaGFyYWN0ZXIgPSBvcHRpb25zLmluZGVudFN0YXJ0ICE9PSBmYWxzZTtcblx0dmFyIHJlcGxhY2VyID0gZnVuY3Rpb24gKG1hdGNoKSB7XG5cdFx0aWYgKHNob3VsZEluZGVudE5leHRDaGFyYWN0ZXIpIHsgcmV0dXJuIChcIlwiICsgaW5kZW50U3RyICsgbWF0Y2gpOyB9XG5cdFx0c2hvdWxkSW5kZW50TmV4dENoYXJhY3RlciA9IHRydWU7XG5cdFx0cmV0dXJuIG1hdGNoO1xuXHR9O1xuXG5cdHRoaXMuaW50cm8gPSB0aGlzLmludHJvLnJlcGxhY2UocGF0dGVybiwgcmVwbGFjZXIpO1xuXG5cdHZhciBjaGFySW5kZXggPSAwO1xuXHR2YXIgY2h1bmsgPSB0aGlzLmZpcnN0Q2h1bms7XG5cblx0d2hpbGUgKGNodW5rKSB7XG5cdFx0dmFyIGVuZCA9IGNodW5rLmVuZDtcblxuXHRcdGlmIChjaHVuay5lZGl0ZWQpIHtcblx0XHRcdGlmICghaXNFeGNsdWRlZFtjaGFySW5kZXhdKSB7XG5cdFx0XHRcdGNodW5rLmNvbnRlbnQgPSBjaHVuay5jb250ZW50LnJlcGxhY2UocGF0dGVybiwgcmVwbGFjZXIpO1xuXG5cdFx0XHRcdGlmIChjaHVuay5jb250ZW50Lmxlbmd0aCkge1xuXHRcdFx0XHRcdHNob3VsZEluZGVudE5leHRDaGFyYWN0ZXIgPSBjaHVuay5jb250ZW50W2NodW5rLmNvbnRlbnQubGVuZ3RoIC0gMV0gPT09ICdcXG4nO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNoYXJJbmRleCA9IGNodW5rLnN0YXJ0O1xuXG5cdFx0XHR3aGlsZSAoY2hhckluZGV4IDwgZW5kKSB7XG5cdFx0XHRcdGlmICghaXNFeGNsdWRlZFtjaGFySW5kZXhdKSB7XG5cdFx0XHRcdFx0dmFyIGNoYXIgPSB0aGlzLm9yaWdpbmFsW2NoYXJJbmRleF07XG5cblx0XHRcdFx0XHRpZiAoY2hhciA9PT0gJ1xcbicpIHtcblx0XHRcdFx0XHRcdHNob3VsZEluZGVudE5leHRDaGFyYWN0ZXIgPSB0cnVlO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoY2hhciAhPT0gJ1xccicgJiYgc2hvdWxkSW5kZW50TmV4dENoYXJhY3Rlcikge1xuXHRcdFx0XHRcdFx0c2hvdWxkSW5kZW50TmV4dENoYXJhY3RlciA9IGZhbHNlO1xuXG5cdFx0XHRcdFx0XHRpZiAoY2hhckluZGV4ID09PSBjaHVuay5zdGFydCkge1xuXHRcdFx0XHRcdFx0XHRjaHVuay5wcmVwZW5kUmlnaHQoaW5kZW50U3RyKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuX3NwbGl0Q2h1bmsoY2h1bmssIGNoYXJJbmRleCk7XG5cdFx0XHRcdFx0XHRcdGNodW5rID0gY2h1bmsubmV4dDtcblx0XHRcdFx0XHRcdFx0Y2h1bmsucHJlcGVuZFJpZ2h0KGluZGVudFN0cik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y2hhckluZGV4ICs9IDE7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y2hhckluZGV4ID0gY2h1bmsuZW5kO1xuXHRcdGNodW5rID0gY2h1bmsubmV4dDtcblx0fVxuXG5cdHRoaXMub3V0cm8gPSB0aGlzLm91dHJvLnJlcGxhY2UocGF0dGVybiwgcmVwbGFjZXIpO1xuXG5cdHJldHVybiB0aGlzO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIGluc2VydCAoKSB7XG5cdHRocm93IG5ldyBFcnJvcignbWFnaWNTdHJpbmcuaW5zZXJ0KC4uLikgaXMgZGVwcmVjYXRlZC4gVXNlIHByZXBlbmRSaWdodCguLi4pIG9yIGFwcGVuZExlZnQoLi4uKScpO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLmluc2VydExlZnQgPSBmdW5jdGlvbiBpbnNlcnRMZWZ0IChpbmRleCwgY29udGVudCkge1xuXHRpZiAoIXdhcm5lZC5pbnNlcnRMZWZ0KSB7XG5cdFx0Y29uc29sZS53YXJuKCdtYWdpY1N0cmluZy5pbnNlcnRMZWZ0KC4uLikgaXMgZGVwcmVjYXRlZC4gVXNlIG1hZ2ljU3RyaW5nLmFwcGVuZExlZnQoLi4uKSBpbnN0ZWFkJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuXHRcdHdhcm5lZC5pbnNlcnRMZWZ0ID0gdHJ1ZTtcblx0fVxuXG5cdHJldHVybiB0aGlzLmFwcGVuZExlZnQoaW5kZXgsIGNvbnRlbnQpO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLmluc2VydFJpZ2h0ID0gZnVuY3Rpb24gaW5zZXJ0UmlnaHQgKGluZGV4LCBjb250ZW50KSB7XG5cdGlmICghd2FybmVkLmluc2VydFJpZ2h0KSB7XG5cdFx0Y29uc29sZS53YXJuKCdtYWdpY1N0cmluZy5pbnNlcnRSaWdodCguLi4pIGlzIGRlcHJlY2F0ZWQuIFVzZSBtYWdpY1N0cmluZy5wcmVwZW5kUmlnaHQoLi4uKSBpbnN0ZWFkJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuXHRcdHdhcm5lZC5pbnNlcnRSaWdodCA9IHRydWU7XG5cdH1cblxuXHRyZXR1cm4gdGhpcy5wcmVwZW5kUmlnaHQoaW5kZXgsIGNvbnRlbnQpO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbiBtb3ZlIChzdGFydCwgZW5kLCBpbmRleCkge1xuXHRpZiAoaW5kZXggPj0gc3RhcnQgJiYgaW5kZXggPD0gZW5kKSB7IHRocm93IG5ldyBFcnJvcignQ2Fubm90IG1vdmUgYSBzZWxlY3Rpb24gaW5zaWRlIGl0c2VsZicpOyB9XG5cblx0dGhpcy5fc3BsaXQoc3RhcnQpO1xuXHR0aGlzLl9zcGxpdChlbmQpO1xuXHR0aGlzLl9zcGxpdChpbmRleCk7XG5cblx0dmFyIGZpcnN0ID0gdGhpcy5ieVN0YXJ0W3N0YXJ0XTtcblx0dmFyIGxhc3QgPSB0aGlzLmJ5RW5kW2VuZF07XG5cblx0dmFyIG9sZExlZnQgPSBmaXJzdC5wcmV2aW91cztcblx0dmFyIG9sZFJpZ2h0ID0gbGFzdC5uZXh0O1xuXG5cdHZhciBuZXdSaWdodCA9IHRoaXMuYnlTdGFydFtpbmRleF07XG5cdGlmICghbmV3UmlnaHQgJiYgbGFzdCA9PT0gdGhpcy5sYXN0Q2h1bmspIHsgcmV0dXJuIHRoaXM7IH1cblx0dmFyIG5ld0xlZnQgPSBuZXdSaWdodCA/IG5ld1JpZ2h0LnByZXZpb3VzIDogdGhpcy5sYXN0Q2h1bms7XG5cblx0aWYgKG9sZExlZnQpIHsgb2xkTGVmdC5uZXh0ID0gb2xkUmlnaHQ7IH1cblx0aWYgKG9sZFJpZ2h0KSB7IG9sZFJpZ2h0LnByZXZpb3VzID0gb2xkTGVmdDsgfVxuXG5cdGlmIChuZXdMZWZ0KSB7IG5ld0xlZnQubmV4dCA9IGZpcnN0OyB9XG5cdGlmIChuZXdSaWdodCkgeyBuZXdSaWdodC5wcmV2aW91cyA9IGxhc3Q7IH1cblxuXHRpZiAoIWZpcnN0LnByZXZpb3VzKSB7IHRoaXMuZmlyc3RDaHVuayA9IGxhc3QubmV4dDsgfVxuXHRpZiAoIWxhc3QubmV4dCkge1xuXHRcdHRoaXMubGFzdENodW5rID0gZmlyc3QucHJldmlvdXM7XG5cdFx0dGhpcy5sYXN0Q2h1bmsubmV4dCA9IG51bGw7XG5cdH1cblxuXHRmaXJzdC5wcmV2aW91cyA9IG5ld0xlZnQ7XG5cdGxhc3QubmV4dCA9IG5ld1JpZ2h0IHx8IG51bGw7XG5cblx0aWYgKCFuZXdMZWZ0KSB7IHRoaXMuZmlyc3RDaHVuayA9IGZpcnN0OyB9XG5cdGlmICghbmV3UmlnaHQpIHsgdGhpcy5sYXN0Q2h1bmsgPSBsYXN0OyB9XG5cdHJldHVybiB0aGlzO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLm92ZXJ3cml0ZSA9IGZ1bmN0aW9uIG92ZXJ3cml0ZSAoc3RhcnQsIGVuZCwgY29udGVudCwgb3B0aW9ucykge1xuXHRpZiAodHlwZW9mIGNvbnRlbnQgIT09ICdzdHJpbmcnKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ3JlcGxhY2VtZW50IGNvbnRlbnQgbXVzdCBiZSBhIHN0cmluZycpOyB9XG5cblx0d2hpbGUgKHN0YXJ0IDwgMCkgeyBzdGFydCArPSB0aGlzLm9yaWdpbmFsLmxlbmd0aDsgfVxuXHR3aGlsZSAoZW5kIDwgMCkgeyBlbmQgKz0gdGhpcy5vcmlnaW5hbC5sZW5ndGg7IH1cblxuXHRpZiAoZW5kID4gdGhpcy5vcmlnaW5hbC5sZW5ndGgpIHsgdGhyb3cgbmV3IEVycm9yKCdlbmQgaXMgb3V0IG9mIGJvdW5kcycpOyB9XG5cdGlmIChzdGFydCA9PT0gZW5kKVxuXHRcdHsgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3Qgb3ZlcndyaXRlIGEgemVyby1sZW5ndGggcmFuZ2Ug4oCTIHVzZSBhcHBlbmRMZWZ0IG9yIHByZXBlbmRSaWdodCBpbnN0ZWFkJyk7IH1cblxuXHR0aGlzLl9zcGxpdChzdGFydCk7XG5cdHRoaXMuX3NwbGl0KGVuZCk7XG5cblx0aWYgKG9wdGlvbnMgPT09IHRydWUpIHtcblx0XHRpZiAoIXdhcm5lZC5zdG9yZU5hbWUpIHtcblx0XHRcdGNvbnNvbGUud2FybignVGhlIGZpbmFsIGFyZ3VtZW50IHRvIG1hZ2ljU3RyaW5nLm92ZXJ3cml0ZSguLi4pIHNob3VsZCBiZSBhbiBvcHRpb25zIG9iamVjdC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9yaWNoLWhhcnJpcy9tYWdpYy1zdHJpbmcnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG5cdFx0XHR3YXJuZWQuc3RvcmVOYW1lID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRvcHRpb25zID0geyBzdG9yZU5hbWU6IHRydWUgfTtcblx0fVxuXHR2YXIgc3RvcmVOYW1lID0gb3B0aW9ucyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5zdG9yZU5hbWUgOiBmYWxzZTtcblx0dmFyIGNvbnRlbnRPbmx5ID0gb3B0aW9ucyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5jb250ZW50T25seSA6IGZhbHNlO1xuXG5cdGlmIChzdG9yZU5hbWUpIHtcblx0XHR2YXIgb3JpZ2luYWwgPSB0aGlzLm9yaWdpbmFsLnNsaWNlKHN0YXJ0LCBlbmQpO1xuXHRcdHRoaXMuc3RvcmVkTmFtZXNbb3JpZ2luYWxdID0gdHJ1ZTtcblx0fVxuXG5cdHZhciBmaXJzdCA9IHRoaXMuYnlTdGFydFtzdGFydF07XG5cdHZhciBsYXN0ID0gdGhpcy5ieUVuZFtlbmRdO1xuXG5cdGlmIChmaXJzdCkge1xuXHRcdGlmIChlbmQgPiBmaXJzdC5lbmQgJiYgZmlyc3QubmV4dCAhPT0gdGhpcy5ieVN0YXJ0W2ZpcnN0LmVuZF0pIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignQ2Fubm90IG92ZXJ3cml0ZSBhY3Jvc3MgYSBzcGxpdCBwb2ludCcpO1xuXHRcdH1cblxuXHRcdGZpcnN0LmVkaXQoY29udGVudCwgc3RvcmVOYW1lLCBjb250ZW50T25seSk7XG5cblx0XHRpZiAoZmlyc3QgIT09IGxhc3QpIHtcblx0XHRcdHZhciBjaHVuayA9IGZpcnN0Lm5leHQ7XG5cdFx0XHR3aGlsZSAoY2h1bmsgIT09IGxhc3QpIHtcblx0XHRcdFx0Y2h1bmsuZWRpdCgnJywgZmFsc2UpO1xuXHRcdFx0XHRjaHVuayA9IGNodW5rLm5leHQ7XG5cdFx0XHR9XG5cblx0XHRcdGNodW5rLmVkaXQoJycsIGZhbHNlKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Ly8gbXVzdCBiZSBpbnNlcnRpbmcgYXQgdGhlIGVuZFxuXHRcdHZhciBuZXdDaHVuayA9IG5ldyBDaHVuayhzdGFydCwgZW5kLCAnJykuZWRpdChjb250ZW50LCBzdG9yZU5hbWUpO1xuXG5cdFx0Ly8gVE9ETyBsYXN0IGNodW5rIGluIHRoZSBhcnJheSBtYXkgbm90IGJlIHRoZSBsYXN0IGNodW5rLCBpZiBpdCdzIG1vdmVkLi4uXG5cdFx0bGFzdC5uZXh0ID0gbmV3Q2h1bms7XG5cdFx0bmV3Q2h1bmsucHJldmlvdXMgPSBsYXN0O1xuXHR9XG5cdHJldHVybiB0aGlzO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLnByZXBlbmQgPSBmdW5jdGlvbiBwcmVwZW5kIChjb250ZW50KSB7XG5cdGlmICh0eXBlb2YgY29udGVudCAhPT0gJ3N0cmluZycpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignb3V0cm8gY29udGVudCBtdXN0IGJlIGEgc3RyaW5nJyk7IH1cblxuXHR0aGlzLmludHJvID0gY29udGVudCArIHRoaXMuaW50cm87XG5cdHJldHVybiB0aGlzO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLnByZXBlbmRMZWZ0ID0gZnVuY3Rpb24gcHJlcGVuZExlZnQgKGluZGV4LCBjb250ZW50KSB7XG5cdGlmICh0eXBlb2YgY29udGVudCAhPT0gJ3N0cmluZycpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignaW5zZXJ0ZWQgY29udGVudCBtdXN0IGJlIGEgc3RyaW5nJyk7IH1cblxuXHR0aGlzLl9zcGxpdChpbmRleCk7XG5cblx0dmFyIGNodW5rID0gdGhpcy5ieUVuZFtpbmRleF07XG5cblx0aWYgKGNodW5rKSB7XG5cdFx0Y2h1bmsucHJlcGVuZExlZnQoY29udGVudCk7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5pbnRybyA9IGNvbnRlbnQgKyB0aGlzLmludHJvO1xuXHR9XG5cdHJldHVybiB0aGlzO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLnByZXBlbmRSaWdodCA9IGZ1bmN0aW9uIHByZXBlbmRSaWdodCAoaW5kZXgsIGNvbnRlbnQpIHtcblx0aWYgKHR5cGVvZiBjb250ZW50ICE9PSAnc3RyaW5nJykgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnNlcnRlZCBjb250ZW50IG11c3QgYmUgYSBzdHJpbmcnKTsgfVxuXG5cdHRoaXMuX3NwbGl0KGluZGV4KTtcblxuXHR2YXIgY2h1bmsgPSB0aGlzLmJ5U3RhcnRbaW5kZXhdO1xuXG5cdGlmIChjaHVuaykge1xuXHRcdGNodW5rLnByZXBlbmRSaWdodChjb250ZW50KTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLm91dHJvID0gY29udGVudCArIHRoaXMub3V0cm87XG5cdH1cblx0cmV0dXJuIHRoaXM7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlIChzdGFydCwgZW5kKSB7XG5cdHdoaWxlIChzdGFydCA8IDApIHsgc3RhcnQgKz0gdGhpcy5vcmlnaW5hbC5sZW5ndGg7IH1cblx0d2hpbGUgKGVuZCA8IDApIHsgZW5kICs9IHRoaXMub3JpZ2luYWwubGVuZ3RoOyB9XG5cblx0aWYgKHN0YXJ0ID09PSBlbmQpIHsgcmV0dXJuIHRoaXM7IH1cblxuXHRpZiAoc3RhcnQgPCAwIHx8IGVuZCA+IHRoaXMub3JpZ2luYWwubGVuZ3RoKSB7IHRocm93IG5ldyBFcnJvcignQ2hhcmFjdGVyIGlzIG91dCBvZiBib3VuZHMnKTsgfVxuXHRpZiAoc3RhcnQgPiBlbmQpIHsgdGhyb3cgbmV3IEVycm9yKCdlbmQgbXVzdCBiZSBncmVhdGVyIHRoYW4gc3RhcnQnKTsgfVxuXG5cdHRoaXMuX3NwbGl0KHN0YXJ0KTtcblx0dGhpcy5fc3BsaXQoZW5kKTtcblxuXHR2YXIgY2h1bmsgPSB0aGlzLmJ5U3RhcnRbc3RhcnRdO1xuXG5cdHdoaWxlIChjaHVuaykge1xuXHRcdGNodW5rLmludHJvID0gJyc7XG5cdFx0Y2h1bmsub3V0cm8gPSAnJztcblx0XHRjaHVuay5lZGl0KCcnKTtcblxuXHRcdGNodW5rID0gZW5kID4gY2h1bmsuZW5kID8gdGhpcy5ieVN0YXJ0W2NodW5rLmVuZF0gOiBudWxsO1xuXHR9XG5cdHJldHVybiB0aGlzO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLmxhc3RDaGFyID0gZnVuY3Rpb24gbGFzdENoYXIgKCkge1xuXHRpZiAodGhpcy5vdXRyby5sZW5ndGgpXG5cdFx0eyByZXR1cm4gdGhpcy5vdXRyb1t0aGlzLm91dHJvLmxlbmd0aCAtIDFdOyB9XG5cdHZhciBjaHVuayA9IHRoaXMubGFzdENodW5rO1xuXHRkbyB7XG5cdFx0aWYgKGNodW5rLm91dHJvLmxlbmd0aClcblx0XHRcdHsgcmV0dXJuIGNodW5rLm91dHJvW2NodW5rLm91dHJvLmxlbmd0aCAtIDFdOyB9XG5cdFx0aWYgKGNodW5rLmNvbnRlbnQubGVuZ3RoKVxuXHRcdFx0eyByZXR1cm4gY2h1bmsuY29udGVudFtjaHVuay5jb250ZW50Lmxlbmd0aCAtIDFdOyB9XG5cdFx0aWYgKGNodW5rLmludHJvLmxlbmd0aClcblx0XHRcdHsgcmV0dXJuIGNodW5rLmludHJvW2NodW5rLmludHJvLmxlbmd0aCAtIDFdOyB9XG5cdH0gd2hpbGUgKGNodW5rID0gY2h1bmsucHJldmlvdXMpO1xuXHRpZiAodGhpcy5pbnRyby5sZW5ndGgpXG5cdFx0eyByZXR1cm4gdGhpcy5pbnRyb1t0aGlzLmludHJvLmxlbmd0aCAtIDFdOyB9XG5cdHJldHVybiAnJztcbn07XG5cbk1hZ2ljU3RyaW5nLnByb3RvdHlwZS5sYXN0TGluZSA9IGZ1bmN0aW9uIGxhc3RMaW5lICgpIHtcblx0dmFyIGxpbmVJbmRleCA9IHRoaXMub3V0cm8ubGFzdEluZGV4T2Yobik7XG5cdGlmIChsaW5lSW5kZXggIT09IC0xKVxuXHRcdHsgcmV0dXJuIHRoaXMub3V0cm8uc3Vic3RyKGxpbmVJbmRleCArIDEpOyB9XG5cdHZhciBsaW5lU3RyID0gdGhpcy5vdXRybztcblx0dmFyIGNodW5rID0gdGhpcy5sYXN0Q2h1bms7XG5cdGRvIHtcblx0XHRpZiAoY2h1bmsub3V0cm8ubGVuZ3RoID4gMCkge1xuXHRcdFx0bGluZUluZGV4ID0gY2h1bmsub3V0cm8ubGFzdEluZGV4T2Yobik7XG5cdFx0XHRpZiAobGluZUluZGV4ICE9PSAtMSlcblx0XHRcdFx0eyByZXR1cm4gY2h1bmsub3V0cm8uc3Vic3RyKGxpbmVJbmRleCArIDEpICsgbGluZVN0cjsgfVxuXHRcdFx0bGluZVN0ciA9IGNodW5rLm91dHJvICsgbGluZVN0cjtcblx0XHR9XG5cblx0XHRpZiAoY2h1bmsuY29udGVudC5sZW5ndGggPiAwKSB7XG5cdFx0XHRsaW5lSW5kZXggPSBjaHVuay5jb250ZW50Lmxhc3RJbmRleE9mKG4pO1xuXHRcdFx0aWYgKGxpbmVJbmRleCAhPT0gLTEpXG5cdFx0XHRcdHsgcmV0dXJuIGNodW5rLmNvbnRlbnQuc3Vic3RyKGxpbmVJbmRleCArIDEpICsgbGluZVN0cjsgfVxuXHRcdFx0bGluZVN0ciA9IGNodW5rLmNvbnRlbnQgKyBsaW5lU3RyO1xuXHRcdH1cblxuXHRcdGlmIChjaHVuay5pbnRyby5sZW5ndGggPiAwKSB7XG5cdFx0XHRsaW5lSW5kZXggPSBjaHVuay5pbnRyby5sYXN0SW5kZXhPZihuKTtcblx0XHRcdGlmIChsaW5lSW5kZXggIT09IC0xKVxuXHRcdFx0XHR7IHJldHVybiBjaHVuay5pbnRyby5zdWJzdHIobGluZUluZGV4ICsgMSkgKyBsaW5lU3RyOyB9XG5cdFx0XHRsaW5lU3RyID0gY2h1bmsuaW50cm8gKyBsaW5lU3RyO1xuXHRcdH1cblx0fSB3aGlsZSAoY2h1bmsgPSBjaHVuay5wcmV2aW91cyk7XG5cdGxpbmVJbmRleCA9IHRoaXMuaW50cm8ubGFzdEluZGV4T2Yobik7XG5cdGlmIChsaW5lSW5kZXggIT09IC0xKVxuXHRcdHsgcmV0dXJuIHRoaXMuaW50cm8uc3Vic3RyKGxpbmVJbmRleCArIDEpICsgbGluZVN0cjsgfVxuXHRyZXR1cm4gdGhpcy5pbnRybyArIGxpbmVTdHI7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkge1xuXHRcdGlmICggc3RhcnQgPT09IHZvaWQgMCApIHN0YXJ0ID0gMDtcblx0XHRpZiAoIGVuZCA9PT0gdm9pZCAwICkgZW5kID0gdGhpcy5vcmlnaW5hbC5sZW5ndGg7XG5cblx0d2hpbGUgKHN0YXJ0IDwgMCkgeyBzdGFydCArPSB0aGlzLm9yaWdpbmFsLmxlbmd0aDsgfVxuXHR3aGlsZSAoZW5kIDwgMCkgeyBlbmQgKz0gdGhpcy5vcmlnaW5hbC5sZW5ndGg7IH1cblxuXHR2YXIgcmVzdWx0ID0gJyc7XG5cblx0Ly8gZmluZCBzdGFydCBjaHVua1xuXHR2YXIgY2h1bmsgPSB0aGlzLmZpcnN0Q2h1bms7XG5cdHdoaWxlIChjaHVuayAmJiAoY2h1bmsuc3RhcnQgPiBzdGFydCB8fCBjaHVuay5lbmQgPD0gc3RhcnQpKSB7XG5cdFx0Ly8gZm91bmQgZW5kIGNodW5rIGJlZm9yZSBzdGFydFxuXHRcdGlmIChjaHVuay5zdGFydCA8IGVuZCAmJiBjaHVuay5lbmQgPj0gZW5kKSB7XG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH1cblxuXHRcdGNodW5rID0gY2h1bmsubmV4dDtcblx0fVxuXG5cdGlmIChjaHVuayAmJiBjaHVuay5lZGl0ZWQgJiYgY2h1bmsuc3RhcnQgIT09IHN0YXJ0KVxuXHRcdHsgdGhyb3cgbmV3IEVycm9yKChcIkNhbm5vdCB1c2UgcmVwbGFjZWQgY2hhcmFjdGVyIFwiICsgc3RhcnQgKyBcIiBhcyBzbGljZSBzdGFydCBhbmNob3IuXCIpKTsgfVxuXG5cdHZhciBzdGFydENodW5rID0gY2h1bms7XG5cdHdoaWxlIChjaHVuaykge1xuXHRcdGlmIChjaHVuay5pbnRybyAmJiAoc3RhcnRDaHVuayAhPT0gY2h1bmsgfHwgY2h1bmsuc3RhcnQgPT09IHN0YXJ0KSkge1xuXHRcdFx0cmVzdWx0ICs9IGNodW5rLmludHJvO1xuXHRcdH1cblxuXHRcdHZhciBjb250YWluc0VuZCA9IGNodW5rLnN0YXJ0IDwgZW5kICYmIGNodW5rLmVuZCA+PSBlbmQ7XG5cdFx0aWYgKGNvbnRhaW5zRW5kICYmIGNodW5rLmVkaXRlZCAmJiBjaHVuay5lbmQgIT09IGVuZClcblx0XHRcdHsgdGhyb3cgbmV3IEVycm9yKChcIkNhbm5vdCB1c2UgcmVwbGFjZWQgY2hhcmFjdGVyIFwiICsgZW5kICsgXCIgYXMgc2xpY2UgZW5kIGFuY2hvci5cIikpOyB9XG5cblx0XHR2YXIgc2xpY2VTdGFydCA9IHN0YXJ0Q2h1bmsgPT09IGNodW5rID8gc3RhcnQgLSBjaHVuay5zdGFydCA6IDA7XG5cdFx0dmFyIHNsaWNlRW5kID0gY29udGFpbnNFbmQgPyBjaHVuay5jb250ZW50Lmxlbmd0aCArIGVuZCAtIGNodW5rLmVuZCA6IGNodW5rLmNvbnRlbnQubGVuZ3RoO1xuXG5cdFx0cmVzdWx0ICs9IGNodW5rLmNvbnRlbnQuc2xpY2Uoc2xpY2VTdGFydCwgc2xpY2VFbmQpO1xuXG5cdFx0aWYgKGNodW5rLm91dHJvICYmICghY29udGFpbnNFbmQgfHwgY2h1bmsuZW5kID09PSBlbmQpKSB7XG5cdFx0XHRyZXN1bHQgKz0gY2h1bmsub3V0cm87XG5cdFx0fVxuXG5cdFx0aWYgKGNvbnRhaW5zRW5kKSB7XG5cdFx0XHRicmVhaztcblx0XHR9XG5cblx0XHRjaHVuayA9IGNodW5rLm5leHQ7XG5cdH1cblxuXHRyZXR1cm4gcmVzdWx0O1xufTtcblxuLy8gVE9ETyBkZXByZWNhdGUgdGhpcz8gbm90IHJlYWxseSB2ZXJ5IHVzZWZ1bFxuTWFnaWNTdHJpbmcucHJvdG90eXBlLnNuaXAgPSBmdW5jdGlvbiBzbmlwIChzdGFydCwgZW5kKSB7XG5cdHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcblx0Y2xvbmUucmVtb3ZlKDAsIHN0YXJ0KTtcblx0Y2xvbmUucmVtb3ZlKGVuZCwgY2xvbmUub3JpZ2luYWwubGVuZ3RoKTtcblxuXHRyZXR1cm4gY2xvbmU7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUuX3NwbGl0ID0gZnVuY3Rpb24gX3NwbGl0IChpbmRleCkge1xuXHRpZiAodGhpcy5ieVN0YXJ0W2luZGV4XSB8fCB0aGlzLmJ5RW5kW2luZGV4XSkgeyByZXR1cm47IH1cblxuXHR2YXIgY2h1bmsgPSB0aGlzLmxhc3RTZWFyY2hlZENodW5rO1xuXHR2YXIgc2VhcmNoRm9yd2FyZCA9IGluZGV4ID4gY2h1bmsuZW5kO1xuXG5cdHdoaWxlIChjaHVuaykge1xuXHRcdGlmIChjaHVuay5jb250YWlucyhpbmRleCkpIHsgcmV0dXJuIHRoaXMuX3NwbGl0Q2h1bmsoY2h1bmssIGluZGV4KTsgfVxuXG5cdFx0Y2h1bmsgPSBzZWFyY2hGb3J3YXJkID8gdGhpcy5ieVN0YXJ0W2NodW5rLmVuZF0gOiB0aGlzLmJ5RW5kW2NodW5rLnN0YXJ0XTtcblx0fVxufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLl9zcGxpdENodW5rID0gZnVuY3Rpb24gX3NwbGl0Q2h1bmsgKGNodW5rLCBpbmRleCkge1xuXHRpZiAoY2h1bmsuZWRpdGVkICYmIGNodW5rLmNvbnRlbnQubGVuZ3RoKSB7XG5cdFx0Ly8gemVyby1sZW5ndGggZWRpdGVkIGNodW5rcyBhcmUgYSBzcGVjaWFsIGNhc2UgKG92ZXJsYXBwaW5nIHJlcGxhY2VtZW50cylcblx0XHR2YXIgbG9jID0gZ2V0TG9jYXRvciQxKHRoaXMub3JpZ2luYWwpKGluZGV4KTtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXG5cdFx0XHQoXCJDYW5ub3Qgc3BsaXQgYSBjaHVuayB0aGF0IGhhcyBhbHJlYWR5IGJlZW4gZWRpdGVkIChcIiArIChsb2MubGluZSkgKyBcIjpcIiArIChsb2MuY29sdW1uKSArIFwiIOKAkyBcXFwiXCIgKyAoY2h1bmsub3JpZ2luYWwpICsgXCJcXFwiKVwiKVxuXHRcdCk7XG5cdH1cblxuXHR2YXIgbmV3Q2h1bmsgPSBjaHVuay5zcGxpdChpbmRleCk7XG5cblx0dGhpcy5ieUVuZFtpbmRleF0gPSBjaHVuaztcblx0dGhpcy5ieVN0YXJ0W2luZGV4XSA9IG5ld0NodW5rO1xuXHR0aGlzLmJ5RW5kW25ld0NodW5rLmVuZF0gPSBuZXdDaHVuaztcblxuXHRpZiAoY2h1bmsgPT09IHRoaXMubGFzdENodW5rKSB7IHRoaXMubGFzdENodW5rID0gbmV3Q2h1bms7IH1cblxuXHR0aGlzLmxhc3RTZWFyY2hlZENodW5rID0gY2h1bms7XG5cdHJldHVybiB0cnVlO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkge1xuXHR2YXIgc3RyID0gdGhpcy5pbnRybztcblxuXHR2YXIgY2h1bmsgPSB0aGlzLmZpcnN0Q2h1bms7XG5cdHdoaWxlIChjaHVuaykge1xuXHRcdHN0ciArPSBjaHVuay50b1N0cmluZygpO1xuXHRcdGNodW5rID0gY2h1bmsubmV4dDtcblx0fVxuXG5cdHJldHVybiBzdHIgKyB0aGlzLm91dHJvO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiBpc0VtcHR5ICgpIHtcblx0dmFyIGNodW5rID0gdGhpcy5maXJzdENodW5rO1xuXHRkbyB7XG5cdFx0aWYgKGNodW5rLmludHJvLmxlbmd0aCAmJiBjaHVuay5pbnRyby50cmltKCkgfHxcblx0XHRcdFx0Y2h1bmsuY29udGVudC5sZW5ndGggJiYgY2h1bmsuY29udGVudC50cmltKCkgfHxcblx0XHRcdFx0Y2h1bmsub3V0cm8ubGVuZ3RoICYmIGNodW5rLm91dHJvLnRyaW0oKSlcblx0XHRcdHsgcmV0dXJuIGZhbHNlOyB9XG5cdH0gd2hpbGUgKGNodW5rID0gY2h1bmsubmV4dCk7XG5cdHJldHVybiB0cnVlO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLmxlbmd0aCA9IGZ1bmN0aW9uIGxlbmd0aCAoKSB7XG5cdHZhciBjaHVuayA9IHRoaXMuZmlyc3RDaHVuaztcblx0dmFyIGxlbmd0aCA9IDA7XG5cdGRvIHtcblx0XHRsZW5ndGggKz0gY2h1bmsuaW50cm8ubGVuZ3RoICsgY2h1bmsuY29udGVudC5sZW5ndGggKyBjaHVuay5vdXRyby5sZW5ndGg7XG5cdH0gd2hpbGUgKGNodW5rID0gY2h1bmsubmV4dCk7XG5cdHJldHVybiBsZW5ndGg7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUudHJpbUxpbmVzID0gZnVuY3Rpb24gdHJpbUxpbmVzICgpIHtcblx0cmV0dXJuIHRoaXMudHJpbSgnW1xcXFxyXFxcXG5dJyk7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUudHJpbSA9IGZ1bmN0aW9uIHRyaW0gKGNoYXJUeXBlKSB7XG5cdHJldHVybiB0aGlzLnRyaW1TdGFydChjaGFyVHlwZSkudHJpbUVuZChjaGFyVHlwZSk7XG59O1xuXG5NYWdpY1N0cmluZy5wcm90b3R5cGUudHJpbUVuZEFib3J0ZWQgPSBmdW5jdGlvbiB0cmltRW5kQWJvcnRlZCAoY2hhclR5cGUpIHtcblx0dmFyIHJ4ID0gbmV3IFJlZ0V4cCgoY2hhclR5cGUgfHwgJ1xcXFxzJykgKyAnKyQnKTtcblxuXHR0aGlzLm91dHJvID0gdGhpcy5vdXRyby5yZXBsYWNlKHJ4LCAnJyk7XG5cdGlmICh0aGlzLm91dHJvLmxlbmd0aCkgeyByZXR1cm4gdHJ1ZTsgfVxuXG5cdHZhciBjaHVuayA9IHRoaXMubGFzdENodW5rO1xuXG5cdGRvIHtcblx0XHR2YXIgZW5kID0gY2h1bmsuZW5kO1xuXHRcdHZhciBhYm9ydGVkID0gY2h1bmsudHJpbUVuZChyeCk7XG5cblx0XHQvLyBpZiBjaHVuayB3YXMgdHJpbW1lZCwgd2UgaGF2ZSBhIG5ldyBsYXN0Q2h1bmtcblx0XHRpZiAoY2h1bmsuZW5kICE9PSBlbmQpIHtcblx0XHRcdGlmICh0aGlzLmxhc3RDaHVuayA9PT0gY2h1bmspIHtcblx0XHRcdFx0dGhpcy5sYXN0Q2h1bmsgPSBjaHVuay5uZXh0O1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLmJ5RW5kW2NodW5rLmVuZF0gPSBjaHVuaztcblx0XHRcdHRoaXMuYnlTdGFydFtjaHVuay5uZXh0LnN0YXJ0XSA9IGNodW5rLm5leHQ7XG5cdFx0XHR0aGlzLmJ5RW5kW2NodW5rLm5leHQuZW5kXSA9IGNodW5rLm5leHQ7XG5cdFx0fVxuXG5cdFx0aWYgKGFib3J0ZWQpIHsgcmV0dXJuIHRydWU7IH1cblx0XHRjaHVuayA9IGNodW5rLnByZXZpb3VzO1xuXHR9IHdoaWxlIChjaHVuayk7XG5cblx0cmV0dXJuIGZhbHNlO1xufTtcblxuTWFnaWNTdHJpbmcucHJvdG90eXBlLnRyaW1FbmQgPSBmdW5jdGlvbiB0cmltRW5kIChjaGFyVHlwZSkge1xuXHR0aGlzLnRyaW1FbmRBYm9ydGVkKGNoYXJUeXBlKTtcblx0cmV0dXJuIHRoaXM7XG59O1xuTWFnaWNTdHJpbmcucHJvdG90eXBlLnRyaW1TdGFydEFib3J0ZWQgPSBmdW5jdGlvbiB0cmltU3RhcnRBYm9ydGVkIChjaGFyVHlwZSkge1xuXHR2YXIgcnggPSBuZXcgUmVnRXhwKCdeJyArIChjaGFyVHlwZSB8fCAnXFxcXHMnKSArICcrJyk7XG5cblx0dGhpcy5pbnRybyA9IHRoaXMuaW50cm8ucmVwbGFjZShyeCwgJycpO1xuXHRpZiAodGhpcy5pbnRyby5sZW5ndGgpIHsgcmV0dXJuIHRydWU7IH1cblxuXHR2YXIgY2h1bmsgPSB0aGlzLmZpcnN0Q2h1bms7XG5cblx0ZG8ge1xuXHRcdHZhciBlbmQgPSBjaHVuay5lbmQ7XG5cdFx0dmFyIGFib3J0ZWQgPSBjaHVuay50cmltU3RhcnQocngpO1xuXG5cdFx0aWYgKGNodW5rLmVuZCAhPT0gZW5kKSB7XG5cdFx0XHQvLyBzcGVjaWFsIGNhc2UuLi5cblx0XHRcdGlmIChjaHVuayA9PT0gdGhpcy5sYXN0Q2h1bmspIHsgdGhpcy5sYXN0Q2h1bmsgPSBjaHVuay5uZXh0OyB9XG5cblx0XHRcdHRoaXMuYnlFbmRbY2h1bmsuZW5kXSA9IGNodW5rO1xuXHRcdFx0dGhpcy5ieVN0YXJ0W2NodW5rLm5leHQuc3RhcnRdID0gY2h1bmsubmV4dDtcblx0XHRcdHRoaXMuYnlFbmRbY2h1bmsubmV4dC5lbmRdID0gY2h1bmsubmV4dDtcblx0XHR9XG5cblx0XHRpZiAoYWJvcnRlZCkgeyByZXR1cm4gdHJ1ZTsgfVxuXHRcdGNodW5rID0gY2h1bmsubmV4dDtcblx0fSB3aGlsZSAoY2h1bmspO1xuXG5cdHJldHVybiBmYWxzZTtcbn07XG5cbk1hZ2ljU3RyaW5nLnByb3RvdHlwZS50cmltU3RhcnQgPSBmdW5jdGlvbiB0cmltU3RhcnQgKGNoYXJUeXBlKSB7XG5cdHRoaXMudHJpbVN0YXJ0QWJvcnRlZChjaGFyVHlwZSk7XG5cdHJldHVybiB0aGlzO1xufTtcblxuY29uc3QgVU5LTk9XTiA9IHt9O1xuZnVuY3Rpb24gZ2F0aGVyX3Bvc3NpYmxlX3ZhbHVlcyhub2RlLCBzZXQpIHtcbiAgICBpZiAobm9kZS50eXBlID09PSAnTGl0ZXJhbCcpIHtcbiAgICAgICAgc2V0LmFkZChub2RlLnZhbHVlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS50eXBlID09PSAnQ29uZGl0aW9uYWxFeHByZXNzaW9uJykge1xuICAgICAgICBnYXRoZXJfcG9zc2libGVfdmFsdWVzKG5vZGUuY29uc2VxdWVudCwgc2V0KTtcbiAgICAgICAgZ2F0aGVyX3Bvc3NpYmxlX3ZhbHVlcyhub2RlLmFsdGVybmF0ZSwgc2V0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHNldC5hZGQoVU5LTk9XTik7XG4gICAgfVxufVxuXG52YXIgQmxvY2tBcHBsaWVzVG9Ob2RlO1xuKGZ1bmN0aW9uIChCbG9ja0FwcGxpZXNUb05vZGUpIHtcbiAgICBCbG9ja0FwcGxpZXNUb05vZGVbQmxvY2tBcHBsaWVzVG9Ob2RlW1wiTm90UG9zc2libGVcIl0gPSAwXSA9IFwiTm90UG9zc2libGVcIjtcbiAgICBCbG9ja0FwcGxpZXNUb05vZGVbQmxvY2tBcHBsaWVzVG9Ob2RlW1wiUG9zc2libGVcIl0gPSAxXSA9IFwiUG9zc2libGVcIjtcbiAgICBCbG9ja0FwcGxpZXNUb05vZGVbQmxvY2tBcHBsaWVzVG9Ob2RlW1wiVW5rbm93blNlbGVjdG9yVHlwZVwiXSA9IDJdID0gXCJVbmtub3duU2VsZWN0b3JUeXBlXCI7XG59KShCbG9ja0FwcGxpZXNUb05vZGUgfHwgKEJsb2NrQXBwbGllc1RvTm9kZSA9IHt9KSk7XG52YXIgTm9kZUV4aXN0O1xuKGZ1bmN0aW9uIChOb2RlRXhpc3QpIHtcbiAgICBOb2RlRXhpc3RbTm9kZUV4aXN0W1wiUHJvYmFibHlcIl0gPSAxXSA9IFwiUHJvYmFibHlcIjtcbiAgICBOb2RlRXhpc3RbTm9kZUV4aXN0W1wiRGVmaW5pdGVseVwiXSA9IDJdID0gXCJEZWZpbml0ZWx5XCI7XG59KShOb2RlRXhpc3QgfHwgKE5vZGVFeGlzdCA9IHt9KSk7XG5jb25zdCB3aGl0ZWxpc3RfYXR0cmlidXRlX3NlbGVjdG9yID0gbmV3IE1hcChbXG4gICAgWydkZXRhaWxzJywgbmV3IFNldChbJ29wZW4nXSldLFxuICAgIFsnZGlhbG9nJywgbmV3IFNldChbJ29wZW4nXSldXG5dKTtcbmNvbnN0IHJlZ2V4X2lzX3NpbmdsZV9jc3Nfc2VsZWN0b3IgPSAvW15cXFxcXSwoPyEoW14oW10rW15cXFxcXXxbXihbXFxcXF0pWylcXF1dKS87XG5jbGFzcyBTZWxlY3RvciQxIHtcbiAgICBjb25zdHJ1Y3Rvcihub2RlLCBzdHlsZXNoZWV0KSB7XG4gICAgICAgIHRoaXMubm9kZSA9IG5vZGU7XG4gICAgICAgIHRoaXMuc3R5bGVzaGVldCA9IHN0eWxlc2hlZXQ7XG4gICAgICAgIHRoaXMuYmxvY2tzID0gZ3JvdXBfc2VsZWN0b3JzKG5vZGUpO1xuICAgICAgICAvLyB0YWtlIHRyYWlsaW5nIDpnbG9iYWwoLi4uKSBzZWxlY3RvcnMgb3V0IG9mIGNvbnNpZGVyYXRpb25cbiAgICAgICAgbGV0IGkgPSB0aGlzLmJsb2Nrcy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpID4gMCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmJsb2Nrc1tpIC0gMV0uZ2xvYmFsKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgaSAtPSAxO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubG9jYWxfYmxvY2tzID0gdGhpcy5ibG9ja3Muc2xpY2UoMCwgaSk7XG4gICAgICAgIGNvbnN0IGhvc3Rfb25seSA9IHRoaXMuYmxvY2tzLmxlbmd0aCA9PT0gMSAmJiB0aGlzLmJsb2Nrc1swXS5ob3N0O1xuICAgICAgICBjb25zdCByb290X29ubHkgPSB0aGlzLmJsb2Nrcy5sZW5ndGggPT09IDEgJiYgdGhpcy5ibG9ja3NbMF0ucm9vdDtcbiAgICAgICAgdGhpcy51c2VkID0gdGhpcy5sb2NhbF9ibG9ja3MubGVuZ3RoID09PSAwIHx8IGhvc3Rfb25seSB8fCByb290X29ubHk7XG4gICAgfVxuICAgIGFwcGx5KG5vZGUpIHtcbiAgICAgICAgY29uc3QgdG9fZW5jYXBzdWxhdGUgPSBbXTtcbiAgICAgICAgYXBwbHlfc2VsZWN0b3IodGhpcy5sb2NhbF9ibG9ja3Muc2xpY2UoKSwgbm9kZSwgdG9fZW5jYXBzdWxhdGUpO1xuICAgICAgICBpZiAodG9fZW5jYXBzdWxhdGUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdG9fZW5jYXBzdWxhdGUuZm9yRWFjaCgoeyBub2RlLCBibG9jayB9KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHlsZXNoZWV0Lm5vZGVzX3dpdGhfY3NzX2NsYXNzLmFkZChub2RlKTtcbiAgICAgICAgICAgICAgICBibG9jay5zaG91bGRfZW5jYXBzdWxhdGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnVzZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIG1pbmlmeShjb2RlKSB7XG4gICAgICAgIGxldCBjID0gbnVsbDtcbiAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGkpID0+IHtcbiAgICAgICAgICAgIGlmIChpID4gMCkge1xuICAgICAgICAgICAgICAgIGlmIChibG9jay5zdGFydCAtIGMgPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvZGUub3ZlcndyaXRlKGMsIGJsb2NrLnN0YXJ0LCBibG9jay5jb21iaW5hdG9yLm5hbWUgfHwgJyAnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjID0gYmxvY2suZW5kO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgdHJhbnNmb3JtKGNvZGUsIGF0dHIsIG1heF9hbW91bnRfY2xhc3Nfc3BlY2lmaWNpdHlfaW5jcmVhc2VkKSB7XG4gICAgICAgIGNvbnN0IGFtb3VudF9jbGFzc19zcGVjaWZpY2l0eV90b19pbmNyZWFzZSA9IG1heF9hbW91bnRfY2xhc3Nfc3BlY2lmaWNpdHlfaW5jcmVhc2VkIC0gdGhpcy5ibG9ja3MuZmlsdGVyKGJsb2NrID0+IGJsb2NrLnNob3VsZF9lbmNhcHN1bGF0ZSkubGVuZ3RoO1xuICAgICAgICBmdW5jdGlvbiByZW1vdmVfZ2xvYmFsX3BzZXVkb19jbGFzcyhzZWxlY3Rvcikge1xuICAgICAgICAgICAgY29uc3QgZmlyc3QgPSBzZWxlY3Rvci5jaGlsZHJlblswXTtcbiAgICAgICAgICAgIGNvbnN0IGxhc3QgPSBzZWxlY3Rvci5jaGlsZHJlbltzZWxlY3Rvci5jaGlsZHJlbi5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGNvZGUucmVtb3ZlKHNlbGVjdG9yLnN0YXJ0LCBmaXJzdC5zdGFydCkucmVtb3ZlKGxhc3QuZW5kLCBzZWxlY3Rvci5lbmQpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGVuY2Fwc3VsYXRlX2Jsb2NrKGJsb2NrLCBhdHRyKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNlbGVjdG9yIG9mIGJsb2NrLnNlbGVjdG9ycykge1xuICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rvci50eXBlID09PSAnUHNldWRvQ2xhc3NTZWxlY3RvcicgJiYgc2VsZWN0b3IubmFtZSA9PT0gJ2dsb2JhbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlX2dsb2JhbF9wc2V1ZG9fY2xhc3Moc2VsZWN0b3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBpID0gYmxvY2suc2VsZWN0b3JzLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RvciA9IGJsb2NrLnNlbGVjdG9yc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0b3IudHlwZSA9PT0gJ1BzZXVkb0VsZW1lbnRTZWxlY3RvcicgfHwgc2VsZWN0b3IudHlwZSA9PT0gJ1BzZXVkb0NsYXNzU2VsZWN0b3InKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rvci5uYW1lICE9PSAncm9vdCcgJiYgc2VsZWN0b3IubmFtZSAhPT0gJ2hvc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlLnByZXBlbmRSaWdodChzZWxlY3Rvci5zdGFydCwgYXR0cik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rvci50eXBlID09PSAnVHlwZVNlbGVjdG9yJyAmJiBzZWxlY3Rvci5uYW1lID09PSAnKicpIHtcbiAgICAgICAgICAgICAgICAgICAgY29kZS5vdmVyd3JpdGUoc2VsZWN0b3Iuc3RhcnQsIHNlbGVjdG9yLmVuZCwgYXR0cik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZExlZnQoc2VsZWN0b3IuZW5kLCBhdHRyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBpZiAoYmxvY2suZ2xvYmFsKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlX2dsb2JhbF9wc2V1ZG9fY2xhc3MoYmxvY2suc2VsZWN0b3JzWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChibG9jay5zaG91bGRfZW5jYXBzdWxhdGUpXG4gICAgICAgICAgICAgICAgZW5jYXBzdWxhdGVfYmxvY2soYmxvY2ssIGluZGV4ID09PSB0aGlzLmJsb2Nrcy5sZW5ndGggLSAxID8gYXR0ci5yZXBlYXQoYW1vdW50X2NsYXNzX3NwZWNpZmljaXR5X3RvX2luY3JlYXNlICsgMSkgOiBhdHRyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHZhbGlkYXRlKGNvbXBvbmVudCkge1xuICAgICAgICBsZXQgc3RhcnQgPSAwO1xuICAgICAgICBsZXQgZW5kID0gdGhpcy5ibG9ja3MubGVuZ3RoO1xuICAgICAgICBmb3IgKDsgc3RhcnQgPCBlbmQ7IHN0YXJ0ICs9IDEpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5ibG9ja3Nbc3RhcnRdLmdsb2JhbClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKDsgZW5kID4gc3RhcnQ7IGVuZCAtPSAxKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYmxvY2tzW2VuZCAtIDFdLmdsb2JhbClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkgKz0gMSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYmxvY2tzW2ldLmdsb2JhbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IodGhpcy5ibG9ja3NbaV0uc2VsZWN0b3JzWzBdLCBjb21waWxlcl9lcnJvcnMuY3NzX2ludmFsaWRfZ2xvYmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbGlkYXRlX2dsb2JhbF93aXRoX211bHRpcGxlX3NlbGVjdG9ycyhjb21wb25lbnQpO1xuICAgICAgICB0aGlzLnZhbGlkYXRlX2ludmFsaWRfY29tYmluYXRvcl93aXRob3V0X3NlbGVjdG9yKGNvbXBvbmVudCk7XG4gICAgfVxuICAgIHZhbGlkYXRlX2dsb2JhbF93aXRoX211bHRpcGxlX3NlbGVjdG9ycyhjb21wb25lbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuYmxvY2tzLmxlbmd0aCA9PT0gMSAmJiB0aGlzLmJsb2Nrc1swXS5zZWxlY3RvcnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAvLyBzdGFuZGFsb25lIDpnbG9iYWwoKSB3aXRoIG11bHRpcGxlIHNlbGVjdG9ycyBpcyBPS1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgYmxvY2sgb2YgdGhpcy5ibG9ja3MpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc2VsZWN0b3Igb2YgYmxvY2suc2VsZWN0b3JzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdG9yLnR5cGUgPT09ICdQc2V1ZG9DbGFzc1NlbGVjdG9yJyAmJiBzZWxlY3Rvci5uYW1lID09PSAnZ2xvYmFsJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVnZXhfaXNfc2luZ2xlX2Nzc19zZWxlY3Rvci50ZXN0KHNlbGVjdG9yLmNoaWxkcmVuWzBdLnZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50LmVycm9yKHNlbGVjdG9yLCBjb21waWxlcl9lcnJvcnMuY3NzX2ludmFsaWRfZ2xvYmFsX3NlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB2YWxpZGF0ZV9pbnZhbGlkX2NvbWJpbmF0b3Jfd2l0aG91dF9zZWxlY3Rvcihjb21wb25lbnQpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJsb2Nrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgYmxvY2sgPSB0aGlzLmJsb2Nrc1tpXTtcbiAgICAgICAgICAgIGlmIChibG9jay5jb21iaW5hdG9yICYmIGJsb2NrLnNlbGVjdG9ycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuZXJyb3IodGhpcy5ub2RlLCBjb21waWxlcl9lcnJvcnMuY3NzX2ludmFsaWRfc2VsZWN0b3IoY29tcG9uZW50LnNvdXJjZS5zbGljZSh0aGlzLm5vZGUuc3RhcnQsIHRoaXMubm9kZS5lbmQpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWJsb2NrLmNvbWJpbmF0b3IgJiYgYmxvY2suc2VsZWN0b3JzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcih0aGlzLm5vZGUsIGNvbXBpbGVyX2Vycm9ycy5jc3NfaW52YWxpZF9zZWxlY3Rvcihjb21wb25lbnQuc291cmNlLnNsaWNlKHRoaXMubm9kZS5zdGFydCwgdGhpcy5ub2RlLmVuZCkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRfYW1vdW50X2NsYXNzX3NwZWNpZmljaXR5X2luY3JlYXNlZCgpIHtcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBibG9jayBvZiB0aGlzLmJsb2Nrcykge1xuICAgICAgICAgICAgaWYgKGJsb2NrLnNob3VsZF9lbmNhcHN1bGF0ZSkge1xuICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFwcGx5X3NlbGVjdG9yKGJsb2Nrcywgbm9kZSwgdG9fZW5jYXBzdWxhdGUpIHtcbiAgICBjb25zdCBibG9jayA9IGJsb2Nrcy5wb3AoKTtcbiAgICBpZiAoIWJsb2NrKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgaWYgKCFub2RlKSB7XG4gICAgICAgIHJldHVybiAoKGJsb2NrLmdsb2JhbCAmJiBibG9ja3MuZXZlcnkoYmxvY2sgPT4gYmxvY2suZ2xvYmFsKSkgfHxcbiAgICAgICAgICAgIChibG9jay5ob3N0ICYmIGJsb2Nrcy5sZW5ndGggPT09IDApKTtcbiAgICB9XG4gICAgc3dpdGNoIChibG9ja19taWdodF9hcHBseV90b19ub2RlKGJsb2NrLCBub2RlKSkge1xuICAgICAgICBjYXNlIEJsb2NrQXBwbGllc1RvTm9kZS5Ob3RQb3NzaWJsZTpcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgY2FzZSBCbG9ja0FwcGxpZXNUb05vZGUuVW5rbm93blNlbGVjdG9yVHlwZTpcbiAgICAgICAgICAgIC8vIGJhaWwuIFRPRE8gZmlndXJlIG91dCB3aGF0IHRoZXNlIGNvdWxkIGJlXG4gICAgICAgICAgICB0b19lbmNhcHN1bGF0ZS5wdXNoKHsgbm9kZSwgYmxvY2sgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGJsb2NrLmNvbWJpbmF0b3IpIHtcbiAgICAgICAgaWYgKGJsb2NrLmNvbWJpbmF0b3IudHlwZSA9PT0gJ1doaXRlU3BhY2UnKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGFuY2VzdG9yX2Jsb2NrIG9mIGJsb2Nrcykge1xuICAgICAgICAgICAgICAgIGlmIChhbmNlc3Rvcl9ibG9jay5nbG9iYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhbmNlc3Rvcl9ibG9jay5ob3N0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRvX2VuY2Fwc3VsYXRlLnB1c2goeyBub2RlLCBibG9jayB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBwYXJlbnQgPSBub2RlO1xuICAgICAgICAgICAgICAgIHdoaWxlIChwYXJlbnQgPSBnZXRfZWxlbWVudF9wYXJlbnQocGFyZW50KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYmxvY2tfbWlnaHRfYXBwbHlfdG9fbm9kZShhbmNlc3Rvcl9ibG9jaywgcGFyZW50KSAhPT0gQmxvY2tBcHBsaWVzVG9Ob2RlLk5vdFBvc3NpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b19lbmNhcHN1bGF0ZS5wdXNoKHsgbm9kZTogcGFyZW50LCBibG9jazogYW5jZXN0b3JfYmxvY2sgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRvX2VuY2Fwc3VsYXRlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0b19lbmNhcHN1bGF0ZS5wdXNoKHsgbm9kZSwgYmxvY2sgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChibG9ja3MuZXZlcnkoYmxvY2sgPT4gYmxvY2suZ2xvYmFsKSkge1xuICAgICAgICAgICAgICAgIHRvX2VuY2Fwc3VsYXRlLnB1c2goeyBub2RlLCBibG9jayB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChibG9jay5jb21iaW5hdG9yLm5hbWUgPT09ICc+Jykge1xuICAgICAgICAgICAgY29uc3QgaGFzX2dsb2JhbF9wYXJlbnQgPSBibG9ja3MuZXZlcnkoYmxvY2sgPT4gYmxvY2suZ2xvYmFsKTtcbiAgICAgICAgICAgIGlmIChoYXNfZ2xvYmFsX3BhcmVudCB8fCBhcHBseV9zZWxlY3RvcihibG9ja3MsIGdldF9lbGVtZW50X3BhcmVudChub2RlKSwgdG9fZW5jYXBzdWxhdGUpKSB7XG4gICAgICAgICAgICAgICAgdG9fZW5jYXBzdWxhdGUucHVzaCh7IG5vZGUsIGJsb2NrIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGJsb2NrLmNvbWJpbmF0b3IubmFtZSA9PT0gJysnIHx8IGJsb2NrLmNvbWJpbmF0b3IubmFtZSA9PT0gJ34nKSB7XG4gICAgICAgICAgICBjb25zdCBzaWJsaW5ncyA9IGdldF9wb3NzaWJsZV9lbGVtZW50X3NpYmxpbmdzKG5vZGUsIGJsb2NrLmNvbWJpbmF0b3IubmFtZSA9PT0gJysnKTtcbiAgICAgICAgICAgIGxldCBoYXNfbWF0Y2ggPSBmYWxzZTtcbiAgICAgICAgICAgIC8vIE5PVEU6IGlmIHdlIGhhdmUgOmdsb2JhbCgpLCB3ZSBjb3VsZG4ndCBmaWd1cmUgb3V0IHdoYXQgaXMgc2VsZWN0ZWQgd2l0aGluIGA6Z2xvYmFsYCBkdWUgdG8gdGhlXG4gICAgICAgICAgICAvLyBjc3MtdHJlZSBsaW1pdGF0aW9uIHRoYXQgZG9lcyBub3QgcGFyc2UgdGhlIGlubmVyIHNlbGVjdG9yIG9mIDpnbG9iYWxcbiAgICAgICAgICAgIC8vIHNvIHVubGVzcyB3ZSBhcmUgc3VyZSB0aGVyZSB3aWxsIGJlIG5vIHNpYmxpbmcgdG8gbWF0Y2gsIHdlIHdpbGwgY29uc2lkZXIgaXQgYXMgbWF0Y2hlZFxuICAgICAgICAgICAgY29uc3QgaGFzX2dsb2JhbCA9IGJsb2Nrcy5zb21lKGJsb2NrID0+IGJsb2NrLmdsb2JhbCk7XG4gICAgICAgICAgICBpZiAoaGFzX2dsb2JhbCkge1xuICAgICAgICAgICAgICAgIGlmIChzaWJsaW5ncy5zaXplID09PSAwICYmIGdldF9lbGVtZW50X3BhcmVudChub2RlKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRvX2VuY2Fwc3VsYXRlLnB1c2goeyBub2RlLCBibG9jayB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgcG9zc2libGVfc2libGluZyBvZiBzaWJsaW5ncy5rZXlzKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYXBwbHlfc2VsZWN0b3IoYmxvY2tzLnNsaWNlKCksIHBvc3NpYmxlX3NpYmxpbmcsIHRvX2VuY2Fwc3VsYXRlKSkge1xuICAgICAgICAgICAgICAgICAgICB0b19lbmNhcHN1bGF0ZS5wdXNoKHsgbm9kZSwgYmxvY2sgfSk7XG4gICAgICAgICAgICAgICAgICAgIGhhc19tYXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGhhc19tYXRjaDtcbiAgICAgICAgfVxuICAgICAgICAvLyBUT0RPIG90aGVyIGNvbWJpbmF0b3JzXG4gICAgICAgIHRvX2VuY2Fwc3VsYXRlLnB1c2goeyBub2RlLCBibG9jayB9KTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHRvX2VuY2Fwc3VsYXRlLnB1c2goeyBub2RlLCBibG9jayB9KTtcbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmNvbnN0IHJlZ2V4X2JhY2tzbGFzaF9hbmRfZm9sbG93aW5nX2NoYXJhY3RlciA9IC9cXFxcKC4pL2c7XG5mdW5jdGlvbiBibG9ja19taWdodF9hcHBseV90b19ub2RlKGJsb2NrLCBub2RlKSB7XG4gICAgbGV0IGkgPSBibG9jay5zZWxlY3RvcnMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSBibG9jay5zZWxlY3RvcnNbaV07XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0eXBlb2Ygc2VsZWN0b3IubmFtZSA9PT0gJ3N0cmluZycgJiYgc2VsZWN0b3IubmFtZS5yZXBsYWNlKHJlZ2V4X2JhY2tzbGFzaF9hbmRfZm9sbG93aW5nX2NoYXJhY3RlciwgJyQxJyk7XG4gICAgICAgIGlmIChzZWxlY3Rvci50eXBlID09PSAnUHNldWRvQ2xhc3NTZWxlY3RvcicgJiYgKG5hbWUgPT09ICdob3N0JyB8fCBuYW1lID09PSAncm9vdCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gQmxvY2tBcHBsaWVzVG9Ob2RlLk5vdFBvc3NpYmxlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChibG9jay5zZWxlY3RvcnMubGVuZ3RoID09PSAxICYmIHNlbGVjdG9yLnR5cGUgPT09ICdQc2V1ZG9DbGFzc1NlbGVjdG9yJyAmJiBuYW1lID09PSAnZ2xvYmFsJykge1xuICAgICAgICAgICAgcmV0dXJuIEJsb2NrQXBwbGllc1RvTm9kZS5Ob3RQb3NzaWJsZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0b3IudHlwZSA9PT0gJ1BzZXVkb0NsYXNzU2VsZWN0b3InIHx8IHNlbGVjdG9yLnR5cGUgPT09ICdQc2V1ZG9FbGVtZW50U2VsZWN0b3InKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0b3IudHlwZSA9PT0gJ0NsYXNzU2VsZWN0b3InKSB7XG4gICAgICAgICAgICBpZiAoIWF0dHJpYnV0ZV9tYXRjaGVzKG5vZGUsICdjbGFzcycsIG5hbWUsICd+PScsIGZhbHNlKSAmJiAhbm9kZS5jbGFzc2VzLnNvbWUoYyA9PiBjLm5hbWUgPT09IG5hbWUpKVxuICAgICAgICAgICAgICAgIHJldHVybiBCbG9ja0FwcGxpZXNUb05vZGUuTm90UG9zc2libGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZWN0b3IudHlwZSA9PT0gJ0lkU2VsZWN0b3InKSB7XG4gICAgICAgICAgICBpZiAoIWF0dHJpYnV0ZV9tYXRjaGVzKG5vZGUsICdpZCcsIG5hbWUsICc9JywgZmFsc2UpKVxuICAgICAgICAgICAgICAgIHJldHVybiBCbG9ja0FwcGxpZXNUb05vZGUuTm90UG9zc2libGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZWN0b3IudHlwZSA9PT0gJ0F0dHJpYnV0ZVNlbGVjdG9yJykge1xuICAgICAgICAgICAgaWYgKCEod2hpdGVsaXN0X2F0dHJpYnV0ZV9zZWxlY3Rvci5oYXMobm9kZS5uYW1lLnRvTG93ZXJDYXNlKCkpICYmIHdoaXRlbGlzdF9hdHRyaWJ1dGVfc2VsZWN0b3IuZ2V0KG5vZGUubmFtZS50b0xvd2VyQ2FzZSgpKS5oYXMoc2VsZWN0b3IubmFtZS5uYW1lLnRvTG93ZXJDYXNlKCkpKSAmJlxuICAgICAgICAgICAgICAgICFhdHRyaWJ1dGVfbWF0Y2hlcyhub2RlLCBzZWxlY3Rvci5uYW1lLm5hbWUsIHNlbGVjdG9yLnZhbHVlICYmIHVucXVvdGUoc2VsZWN0b3IudmFsdWUpLCBzZWxlY3Rvci5tYXRjaGVyLCBzZWxlY3Rvci5mbGFncykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQmxvY2tBcHBsaWVzVG9Ob2RlLk5vdFBvc3NpYmxlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGVjdG9yLnR5cGUgPT09ICdUeXBlU2VsZWN0b3InKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5uYW1lLnRvTG93ZXJDYXNlKCkgIT09IG5hbWUudG9Mb3dlckNhc2UoKSAmJiBuYW1lICE9PSAnKicgJiYgIW5vZGUuaXNfZHluYW1pY19lbGVtZW50KVxuICAgICAgICAgICAgICAgIHJldHVybiBCbG9ja0FwcGxpZXNUb05vZGUuTm90UG9zc2libGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gQmxvY2tBcHBsaWVzVG9Ob2RlLlVua25vd25TZWxlY3RvclR5cGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIEJsb2NrQXBwbGllc1RvTm9kZS5Qb3NzaWJsZTtcbn1cbmZ1bmN0aW9uIHRlc3RfYXR0cmlidXRlKG9wZXJhdG9yLCBleHBlY3RlZF92YWx1ZSwgY2FzZV9pbnNlbnNpdGl2ZSwgdmFsdWUpIHtcbiAgICBpZiAoY2FzZV9pbnNlbnNpdGl2ZSkge1xuICAgICAgICBleHBlY3RlZF92YWx1ZSA9IGV4cGVjdGVkX3ZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHZhbHVlID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICB9XG4gICAgc3dpdGNoIChvcGVyYXRvcikge1xuICAgICAgICBjYXNlICc9JzogcmV0dXJuIHZhbHVlID09PSBleHBlY3RlZF92YWx1ZTtcbiAgICAgICAgY2FzZSAnfj0nOiByZXR1cm4gdmFsdWUuc3BsaXQoL1xccy8pLmluY2x1ZGVzKGV4cGVjdGVkX3ZhbHVlKTtcbiAgICAgICAgY2FzZSAnfD0nOiByZXR1cm4gYCR7dmFsdWV9LWAuc3RhcnRzV2l0aChgJHtleHBlY3RlZF92YWx1ZX0tYCk7XG4gICAgICAgIGNhc2UgJ149JzogcmV0dXJuIHZhbHVlLnN0YXJ0c1dpdGgoZXhwZWN0ZWRfdmFsdWUpO1xuICAgICAgICBjYXNlICckPSc6IHJldHVybiB2YWx1ZS5lbmRzV2l0aChleHBlY3RlZF92YWx1ZSk7XG4gICAgICAgIGNhc2UgJyo9JzogcmV0dXJuIHZhbHVlLmluY2x1ZGVzKGV4cGVjdGVkX3ZhbHVlKTtcbiAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEVycm9yKFwidGhpcyBzaG91bGRuJ3QgaGFwcGVuXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGF0dHJpYnV0ZV9tYXRjaGVzKG5vZGUsIG5hbWUsIGV4cGVjdGVkX3ZhbHVlLCBvcGVyYXRvciwgY2FzZV9pbnNlbnNpdGl2ZSkge1xuICAgIGNvbnN0IHNwcmVhZCA9IG5vZGUuYXR0cmlidXRlcy5maW5kKGF0dHIgPT4gYXR0ci50eXBlID09PSAnU3ByZWFkJyk7XG4gICAgaWYgKHNwcmVhZClcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgaWYgKG5vZGUuYmluZGluZ3Muc29tZSgoYmluZGluZykgPT4gYmluZGluZy5uYW1lID09PSBuYW1lKSlcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgY29uc3QgYXR0ciA9IG5vZGUuYXR0cmlidXRlcy5maW5kKChhdHRyKSA9PiBhdHRyLm5hbWUgPT09IG5hbWUpO1xuICAgIGlmICghYXR0cilcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChhdHRyLmlzX3RydWUpXG4gICAgICAgIHJldHVybiBvcGVyYXRvciA9PT0gbnVsbDtcbiAgICBpZiAoIWV4cGVjdGVkX3ZhbHVlKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICBpZiAoYXR0ci5jaHVua3MubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXR0ci5jaHVua3NbMF07XG4gICAgICAgIGlmICghdmFsdWUpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICh2YWx1ZS50eXBlID09PSAnVGV4dCcpXG4gICAgICAgICAgICByZXR1cm4gdGVzdF9hdHRyaWJ1dGUob3BlcmF0b3IsIGV4cGVjdGVkX3ZhbHVlLCBjYXNlX2luc2Vuc2l0aXZlLCB2YWx1ZS5kYXRhKTtcbiAgICB9XG4gICAgY29uc3QgcG9zc2libGVfdmFsdWVzID0gbmV3IFNldCgpO1xuICAgIGxldCBwcmV2X3ZhbHVlcyA9IFtdO1xuICAgIGZvciAoY29uc3QgY2h1bmsgb2YgYXR0ci5jaHVua3MpIHtcbiAgICAgICAgY29uc3QgY3VycmVudF9wb3NzaWJsZV92YWx1ZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIGlmIChjaHVuay50eXBlID09PSAnVGV4dCcpIHtcbiAgICAgICAgICAgIGN1cnJlbnRfcG9zc2libGVfdmFsdWVzLmFkZChjaHVuay5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGdhdGhlcl9wb3NzaWJsZV92YWx1ZXMoY2h1bmsubm9kZSwgY3VycmVudF9wb3NzaWJsZV92YWx1ZXMpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGltcG9zc2libGUgdG8gZmluZCBvdXQgYWxsIGNvbWJpbmF0aW9uc1xuICAgICAgICBpZiAoY3VycmVudF9wb3NzaWJsZV92YWx1ZXMuaGFzKFVOS05PV04pKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmIChwcmV2X3ZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBzdGFydF93aXRoX3NwYWNlID0gW107XG4gICAgICAgICAgICBjb25zdCByZW1haW5pbmcgPSBbXTtcbiAgICAgICAgICAgIGN1cnJlbnRfcG9zc2libGVfdmFsdWVzLmZvckVhY2goKGN1cnJlbnRfcG9zc2libGVfdmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmVnZXhfc3RhcnRzX3dpdGhfd2hpdGVzcGFjZS50ZXN0KGN1cnJlbnRfcG9zc2libGVfdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0X3dpdGhfc3BhY2UucHVzaChjdXJyZW50X3Bvc3NpYmxlX3ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbWFpbmluZy5wdXNoKGN1cnJlbnRfcG9zc2libGVfdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHJlbWFpbmluZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0X3dpdGhfc3BhY2UubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBwcmV2X3ZhbHVlcy5mb3JFYWNoKHByZXZfdmFsdWUgPT4gcG9zc2libGVfdmFsdWVzLmFkZChwcmV2X3ZhbHVlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbWJpbmVkID0gW107XG4gICAgICAgICAgICAgICAgcHJldl92YWx1ZXMuZm9yRWFjaCgocHJldl92YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmcuZm9yRWFjaCgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbWJpbmVkLnB1c2gocHJldl92YWx1ZSArIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcHJldl92YWx1ZXMgPSBjb21iaW5lZDtcbiAgICAgICAgICAgICAgICBzdGFydF93aXRoX3NwYWNlLmZvckVhY2goKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWdleF9lbmRzX3dpdGhfd2hpdGVzcGFjZS50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zc2libGVfdmFsdWVzLmFkZCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2X3ZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJldl92YWx1ZXMuZm9yRWFjaChwcmV2X3ZhbHVlID0+IHBvc3NpYmxlX3ZhbHVlcy5hZGQocHJldl92YWx1ZSkpO1xuICAgICAgICAgICAgICAgIHByZXZfdmFsdWVzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY3VycmVudF9wb3NzaWJsZV92YWx1ZXMuZm9yRWFjaCgoY3VycmVudF9wb3NzaWJsZV92YWx1ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlZ2V4X2VuZHNfd2l0aF93aGl0ZXNwYWNlLnRlc3QoY3VycmVudF9wb3NzaWJsZV92YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBwb3NzaWJsZV92YWx1ZXMuYWRkKGN1cnJlbnRfcG9zc2libGVfdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJldl92YWx1ZXMucHVzaChjdXJyZW50X3Bvc3NpYmxlX3ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChwcmV2X3ZhbHVlcy5sZW5ndGggPCBjdXJyZW50X3Bvc3NpYmxlX3ZhbHVlcy5zaXplKSB7XG4gICAgICAgICAgICBwcmV2X3ZhbHVlcy5wdXNoKCcgJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByZXZfdmFsdWVzLmxlbmd0aCA+IDIwKSB7XG4gICAgICAgICAgICAvLyBtaWdodCBncm93IGV4cG9uZW50aWFsbHksIGJhaWwgb3V0XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcmV2X3ZhbHVlcy5mb3JFYWNoKHByZXZfdmFsdWUgPT4gcG9zc2libGVfdmFsdWVzLmFkZChwcmV2X3ZhbHVlKSk7XG4gICAgaWYgKHBvc3NpYmxlX3ZhbHVlcy5oYXMoVU5LTk9XTikpXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIGZvciAoY29uc3QgdmFsdWUgb2YgcG9zc2libGVfdmFsdWVzKSB7XG4gICAgICAgIGlmICh0ZXN0X2F0dHJpYnV0ZShvcGVyYXRvciwgZXhwZWN0ZWRfdmFsdWUsIGNhc2VfaW5zZW5zaXRpdmUsIHZhbHVlKSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiB1bnF1b3RlKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlLnR5cGUgPT09ICdJZGVudGlmaWVyJylcbiAgICAgICAgcmV0dXJuIHZhbHVlLm5hbWU7XG4gICAgY29uc3Qgc3RyID0gdmFsdWUudmFsdWU7XG4gICAgaWYgKHN0clswXSA9PT0gc3RyW3N0ci5sZW5ndGggLSAxXSAmJiBzdHJbMF0gPT09IFwiJ1wiIHx8IHN0clswXSA9PT0gJ1wiJykge1xuICAgICAgICByZXR1cm4gc3RyLnNsaWNlKDEsIHN0ci5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbn1cbmZ1bmN0aW9uIGdldF9lbGVtZW50X3BhcmVudChub2RlKSB7XG4gICAgbGV0IHBhcmVudCA9IG5vZGU7XG4gICAgd2hpbGUgKChwYXJlbnQgPSBwYXJlbnQucGFyZW50KSAmJiBwYXJlbnQudHlwZSAhPT0gJ0VsZW1lbnQnKVxuICAgICAgICA7XG4gICAgcmV0dXJuIHBhcmVudDtcbn1cbmZ1bmN0aW9uIGdldF9wb3NzaWJsZV9lbGVtZW50X3NpYmxpbmdzKG5vZGUsIGFkamFjZW50X29ubHkpIHtcbiAgICBjb25zdCByZXN1bHQgPSBuZXcgTWFwKCk7XG4gICAgbGV0IHByZXYgPSBub2RlO1xuICAgIHdoaWxlIChwcmV2ID0gcHJldi5wcmV2KSB7XG4gICAgICAgIGlmIChwcmV2LnR5cGUgPT09ICdFbGVtZW50Jykge1xuICAgICAgICAgICAgaWYgKCFwcmV2LmF0dHJpYnV0ZXMuZmluZChhdHRyID0+IGF0dHIudHlwZSA9PT0gJ0F0dHJpYnV0ZScgJiYgYXR0ci5uYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzbG90JykpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQuc2V0KHByZXYsIE5vZGVFeGlzdC5EZWZpbml0ZWx5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhZGphY2VudF9vbmx5KSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHJldi50eXBlID09PSAnRWFjaEJsb2NrJyB8fCBwcmV2LnR5cGUgPT09ICdJZkJsb2NrJyB8fCBwcmV2LnR5cGUgPT09ICdBd2FpdEJsb2NrJykge1xuICAgICAgICAgICAgY29uc3QgcG9zc2libGVfbGFzdF9jaGlsZCA9IGdldF9wb3NzaWJsZV9sYXN0X2NoaWxkKHByZXYsIGFkamFjZW50X29ubHkpO1xuICAgICAgICAgICAgYWRkX3RvX21hcChwb3NzaWJsZV9sYXN0X2NoaWxkLCByZXN1bHQpO1xuICAgICAgICAgICAgaWYgKGFkamFjZW50X29ubHkgJiYgaGFzX2RlZmluaXRlX2VsZW1lbnRzKHBvc3NpYmxlX2xhc3RfY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXByZXYgfHwgIWFkamFjZW50X29ubHkpIHtcbiAgICAgICAgbGV0IHBhcmVudCA9IG5vZGU7XG4gICAgICAgIGxldCBza2lwX2VhY2hfZm9yX2xhc3RfY2hpbGQgPSBub2RlLnR5cGUgPT09ICdFbHNlQmxvY2snO1xuICAgICAgICB3aGlsZSAoKHBhcmVudCA9IHBhcmVudC5wYXJlbnQpICYmIChwYXJlbnQudHlwZSA9PT0gJ0VhY2hCbG9jaycgfHwgcGFyZW50LnR5cGUgPT09ICdJZkJsb2NrJyB8fCBwYXJlbnQudHlwZSA9PT0gJ0Vsc2VCbG9jaycgfHwgcGFyZW50LnR5cGUgPT09ICdBd2FpdEJsb2NrJykpIHtcbiAgICAgICAgICAgIGNvbnN0IHBvc3NpYmxlX3NpYmxpbmdzID0gZ2V0X3Bvc3NpYmxlX2VsZW1lbnRfc2libGluZ3MocGFyZW50LCBhZGphY2VudF9vbmx5KTtcbiAgICAgICAgICAgIGFkZF90b19tYXAocG9zc2libGVfc2libGluZ3MsIHJlc3VsdCk7XG4gICAgICAgICAgICBpZiAocGFyZW50LnR5cGUgPT09ICdFYWNoQmxvY2snKSB7XG4gICAgICAgICAgICAgICAgLy8gZmlyc3QgY2hpbGQgb2YgZWFjaCBibG9jayBjYW4gc2VsZWN0IHRoZSBsYXN0IGNoaWxkIG9mIGVhY2ggYmxvY2sgYXMgcHJldmlvdXMgc2libGluZ1xuICAgICAgICAgICAgICAgIGlmIChza2lwX2VhY2hfZm9yX2xhc3RfY2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2tpcF9lYWNoX2Zvcl9sYXN0X2NoaWxkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhZGRfdG9fbWFwKGdldF9wb3NzaWJsZV9sYXN0X2NoaWxkKHBhcmVudCwgYWRqYWNlbnRfb25seSksIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50LnR5cGUgPT09ICdFbHNlQmxvY2snKSB7XG4gICAgICAgICAgICAgICAgc2tpcF9lYWNoX2Zvcl9sYXN0X2NoaWxkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFkamFjZW50X29ubHkgJiYgaGFzX2RlZmluaXRlX2VsZW1lbnRzKHBvc3NpYmxlX3NpYmxpbmdzKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRfcG9zc2libGVfbGFzdF9jaGlsZChibG9jaywgYWRqYWNlbnRfb25seSkge1xuICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBNYXAoKTtcbiAgICBpZiAoYmxvY2sudHlwZSA9PT0gJ0VhY2hCbG9jaycpIHtcbiAgICAgICAgY29uc3QgZWFjaF9yZXN1bHQgPSBsb29wX2NoaWxkKGJsb2NrLmNoaWxkcmVuLCBhZGphY2VudF9vbmx5KTtcbiAgICAgICAgY29uc3QgZWxzZV9yZXN1bHQgPSBibG9jay5lbHNlID8gbG9vcF9jaGlsZChibG9jay5lbHNlLmNoaWxkcmVuLCBhZGphY2VudF9vbmx5KSA6IG5ldyBNYXAoKTtcbiAgICAgICAgY29uc3Qgbm90X2V4aGF1c3RpdmUgPSAhaGFzX2RlZmluaXRlX2VsZW1lbnRzKGVsc2VfcmVzdWx0KTtcbiAgICAgICAgaWYgKG5vdF9leGhhdXN0aXZlKSB7XG4gICAgICAgICAgICBtYXJrX2FzX3Byb2JhYmx5KGVhY2hfcmVzdWx0KTtcbiAgICAgICAgICAgIG1hcmtfYXNfcHJvYmFibHkoZWxzZV9yZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIGFkZF90b19tYXAoZWFjaF9yZXN1bHQsIHJlc3VsdCk7XG4gICAgICAgIGFkZF90b19tYXAoZWxzZV9yZXN1bHQsIHJlc3VsdCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGJsb2NrLnR5cGUgPT09ICdJZkJsb2NrJykge1xuICAgICAgICBjb25zdCBpZl9yZXN1bHQgPSBsb29wX2NoaWxkKGJsb2NrLmNoaWxkcmVuLCBhZGphY2VudF9vbmx5KTtcbiAgICAgICAgY29uc3QgZWxzZV9yZXN1bHQgPSBibG9jay5lbHNlID8gbG9vcF9jaGlsZChibG9jay5lbHNlLmNoaWxkcmVuLCBhZGphY2VudF9vbmx5KSA6IG5ldyBNYXAoKTtcbiAgICAgICAgY29uc3Qgbm90X2V4aGF1c3RpdmUgPSAhaGFzX2RlZmluaXRlX2VsZW1lbnRzKGlmX3Jlc3VsdCkgfHwgIWhhc19kZWZpbml0ZV9lbGVtZW50cyhlbHNlX3Jlc3VsdCk7XG4gICAgICAgIGlmIChub3RfZXhoYXVzdGl2ZSkge1xuICAgICAgICAgICAgbWFya19hc19wcm9iYWJseShpZl9yZXN1bHQpO1xuICAgICAgICAgICAgbWFya19hc19wcm9iYWJseShlbHNlX3Jlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgICAgYWRkX3RvX21hcChpZl9yZXN1bHQsIHJlc3VsdCk7XG4gICAgICAgIGFkZF90b19tYXAoZWxzZV9yZXN1bHQsIHJlc3VsdCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGJsb2NrLnR5cGUgPT09ICdBd2FpdEJsb2NrJykge1xuICAgICAgICBjb25zdCBwZW5kaW5nX3Jlc3VsdCA9IGJsb2NrLnBlbmRpbmcgPyBsb29wX2NoaWxkKGJsb2NrLnBlbmRpbmcuY2hpbGRyZW4sIGFkamFjZW50X29ubHkpIDogbmV3IE1hcCgpO1xuICAgICAgICBjb25zdCB0aGVuX3Jlc3VsdCA9IGJsb2NrLnRoZW4gPyBsb29wX2NoaWxkKGJsb2NrLnRoZW4uY2hpbGRyZW4sIGFkamFjZW50X29ubHkpIDogbmV3IE1hcCgpO1xuICAgICAgICBjb25zdCBjYXRjaF9yZXN1bHQgPSBibG9jay5jYXRjaCA/IGxvb3BfY2hpbGQoYmxvY2suY2F0Y2guY2hpbGRyZW4sIGFkamFjZW50X29ubHkpIDogbmV3IE1hcCgpO1xuICAgICAgICBjb25zdCBub3RfZXhoYXVzdGl2ZSA9ICFoYXNfZGVmaW5pdGVfZWxlbWVudHMocGVuZGluZ19yZXN1bHQpIHx8ICFoYXNfZGVmaW5pdGVfZWxlbWVudHModGhlbl9yZXN1bHQpIHx8ICFoYXNfZGVmaW5pdGVfZWxlbWVudHMoY2F0Y2hfcmVzdWx0KTtcbiAgICAgICAgaWYgKG5vdF9leGhhdXN0aXZlKSB7XG4gICAgICAgICAgICBtYXJrX2FzX3Byb2JhYmx5KHBlbmRpbmdfcmVzdWx0KTtcbiAgICAgICAgICAgIG1hcmtfYXNfcHJvYmFibHkodGhlbl9yZXN1bHQpO1xuICAgICAgICAgICAgbWFya19hc19wcm9iYWJseShjYXRjaF9yZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIGFkZF90b19tYXAocGVuZGluZ19yZXN1bHQsIHJlc3VsdCk7XG4gICAgICAgIGFkZF90b19tYXAodGhlbl9yZXN1bHQsIHJlc3VsdCk7XG4gICAgICAgIGFkZF90b19tYXAoY2F0Y2hfcmVzdWx0LCByZXN1bHQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gaGFzX2RlZmluaXRlX2VsZW1lbnRzKHJlc3VsdCkge1xuICAgIGlmIChyZXN1bHQuc2l6ZSA9PT0gMClcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGZvciAoY29uc3QgZXhpc3Qgb2YgcmVzdWx0LnZhbHVlcygpKSB7XG4gICAgICAgIGlmIChleGlzdCA9PT0gTm9kZUV4aXN0LkRlZmluaXRlbHkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGFkZF90b19tYXAoZnJvbSwgdG8pIHtcbiAgICBmcm9tLmZvckVhY2goKGV4aXN0LCBlbGVtZW50KSA9PiB7XG4gICAgICAgIHRvLnNldChlbGVtZW50LCBoaWdoZXJfZXhpc3RlbmNlKGV4aXN0LCB0by5nZXQoZWxlbWVudCkpKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhpZ2hlcl9leGlzdGVuY2UoZXhpc3QxLCBleGlzdDIpIHtcbiAgICBpZiAoZXhpc3QxID09PSB1bmRlZmluZWQgfHwgZXhpc3QyID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybiBleGlzdDEgfHwgZXhpc3QyO1xuICAgIHJldHVybiBleGlzdDEgPiBleGlzdDIgPyBleGlzdDEgOiBleGlzdDI7XG59XG5mdW5jdGlvbiBtYXJrX2FzX3Byb2JhYmx5KHJlc3VsdCkge1xuICAgIGZvciAoY29uc3Qga2V5IG9mIHJlc3VsdC5rZXlzKCkpIHtcbiAgICAgICAgcmVzdWx0LnNldChrZXksIE5vZGVFeGlzdC5Qcm9iYWJseSk7XG4gICAgfVxufVxuZnVuY3Rpb24gbG9vcF9jaGlsZChjaGlsZHJlbiwgYWRqYWNlbnRfb25seSkge1xuICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBNYXAoKTtcbiAgICBmb3IgKGxldCBpID0gY2hpbGRyZW4ubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTtcbiAgICAgICAgaWYgKGNoaWxkLnR5cGUgPT09ICdFbGVtZW50Jykge1xuICAgICAgICAgICAgcmVzdWx0LnNldChjaGlsZCwgTm9kZUV4aXN0LkRlZmluaXRlbHkpO1xuICAgICAgICAgICAgaWYgKGFkamFjZW50X29ubHkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjaGlsZC50eXBlID09PSAnRWFjaEJsb2NrJyB8fCBjaGlsZC50eXBlID09PSAnSWZCbG9jaycgfHwgY2hpbGQudHlwZSA9PT0gJ0F3YWl0QmxvY2snKSB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZF9yZXN1bHQgPSBnZXRfcG9zc2libGVfbGFzdF9jaGlsZChjaGlsZCwgYWRqYWNlbnRfb25seSk7XG4gICAgICAgICAgICBhZGRfdG9fbWFwKGNoaWxkX3Jlc3VsdCwgcmVzdWx0KTtcbiAgICAgICAgICAgIGlmIChhZGphY2VudF9vbmx5ICYmIGhhc19kZWZpbml0ZV9lbGVtZW50cyhjaGlsZF9yZXN1bHQpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmNsYXNzIEJsb2NrJDIge1xuICAgIGNvbnN0cnVjdG9yKGNvbWJpbmF0b3IpIHtcbiAgICAgICAgdGhpcy5jb21iaW5hdG9yID0gY29tYmluYXRvcjtcbiAgICAgICAgdGhpcy5ob3N0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMucm9vdCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNlbGVjdG9ycyA9IFtdO1xuICAgICAgICB0aGlzLnN0YXJ0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5lbmQgPSBudWxsO1xuICAgICAgICB0aGlzLnNob3VsZF9lbmNhcHN1bGF0ZSA9IGZhbHNlO1xuICAgIH1cbiAgICBhZGQoc2VsZWN0b3IpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0b3JzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydCA9IHNlbGVjdG9yLnN0YXJ0O1xuICAgICAgICAgICAgdGhpcy5ob3N0ID0gc2VsZWN0b3IudHlwZSA9PT0gJ1BzZXVkb0NsYXNzU2VsZWN0b3InICYmIHNlbGVjdG9yLm5hbWUgPT09ICdob3N0JztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJvb3QgPSB0aGlzLnJvb3QgfHwgc2VsZWN0b3IudHlwZSA9PT0gJ1BzZXVkb0NsYXNzU2VsZWN0b3InICYmIHNlbGVjdG9yLm5hbWUgPT09ICdyb290JztcbiAgICAgICAgdGhpcy5zZWxlY3RvcnMucHVzaChzZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuZW5kID0gc2VsZWN0b3IuZW5kO1xuICAgIH1cbiAgICBnZXQgZ2xvYmFsKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuc2VsZWN0b3JzLmxlbmd0aCA+PSAxICYmXG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9yc1swXS50eXBlID09PSAnUHNldWRvQ2xhc3NTZWxlY3RvcicgJiZcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JzWzBdLm5hbWUgPT09ICdnbG9iYWwnICYmXG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9ycy5ldmVyeSgoc2VsZWN0b3IpID0+IHNlbGVjdG9yLnR5cGUgPT09ICdQc2V1ZG9DbGFzc1NlbGVjdG9yJyB8fCBzZWxlY3Rvci50eXBlID09PSAnUHNldWRvRWxlbWVudFNlbGVjdG9yJykpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdyb3VwX3NlbGVjdG9ycyhzZWxlY3Rvcikge1xuICAgIGxldCBibG9jayA9IG5ldyBCbG9jayQyKG51bGwpO1xuICAgIGNvbnN0IGJsb2NrcyA9IFtibG9ja107XG4gICAgc2VsZWN0b3IuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgICAgaWYgKGNoaWxkLnR5cGUgPT09ICdXaGl0ZVNwYWNlJyB8fCBjaGlsZC50eXBlID09PSAnQ29tYmluYXRvcicpIHtcbiAgICAgICAgICAgIGJsb2NrID0gbmV3IEJsb2NrJDIoY2hpbGQpO1xuICAgICAgICAgICAgYmxvY2tzLnB1c2goYmxvY2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYmxvY2suYWRkKGNoaWxkKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBibG9ja3M7XG59XG5cbmNvbnN0IHJlZ2V4X2Nzc19icm93c2VyX3ByZWZpeCA9IC9eLSgod2Via2l0KXwobW96KXwobyl8KG1zKSktLztcbmZ1bmN0aW9uIHJlbW92ZV9jc3NfcHJlZml4KG5hbWUpIHtcbiAgICByZXR1cm4gbmFtZS5yZXBsYWNlKHJlZ2V4X2Nzc19icm93c2VyX3ByZWZpeCwgJycpO1xufVxuY29uc3QgaXNfa2V5ZnJhbWVzX25vZGUgPSAobm9kZSkgPT4gcmVtb3ZlX2Nzc19wcmVmaXgobm9kZS5uYW1lKSA9PT0gJ2tleWZyYW1lcyc7XG5jb25zdCBhdF9ydWxlX2hhc19kZWNsYXJhdGlvbiA9ICh7IGJsb2NrIH0pID0+IGJsb2NrICYmXG4gICAgYmxvY2suY2hpbGRyZW4gJiZcbiAgICBibG9jay5jaGlsZHJlbi5maW5kKChub2RlKSA9PiBub2RlLnR5cGUgPT09ICdEZWNsYXJhdGlvbicpO1xuZnVuY3Rpb24gbWluaWZ5X2RlY2xhcmF0aW9ucyhjb2RlLCBzdGFydCwgZGVjbGFyYXRpb25zKSB7XG4gICAgbGV0IGMgPSBzdGFydDtcbiAgICBkZWNsYXJhdGlvbnMuZm9yRWFjaCgoZGVjbGFyYXRpb24sIGkpID0+IHtcbiAgICAgICAgY29uc3Qgc2VwYXJhdG9yID0gaSA+IDAgPyAnOycgOiAnJztcbiAgICAgICAgaWYgKChkZWNsYXJhdGlvbi5ub2RlLnN0YXJ0IC0gYykgPiBzZXBhcmF0b3IubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb2RlLm92ZXJ3cml0ZShjLCBkZWNsYXJhdGlvbi5ub2RlLnN0YXJ0LCBzZXBhcmF0b3IpO1xuICAgICAgICB9XG4gICAgICAgIGRlY2xhcmF0aW9uLm1pbmlmeShjb2RlKTtcbiAgICAgICAgYyA9IGRlY2xhcmF0aW9uLm5vZGUuZW5kO1xuICAgIH0pO1xuICAgIHJldHVybiBjO1xufVxuY2xhc3MgUnVsZSQxIHtcbiAgICBjb25zdHJ1Y3Rvcihub2RlLCBzdHlsZXNoZWV0LCBwYXJlbnQpIHtcbiAgICAgICAgdGhpcy5ub2RlID0gbm9kZTtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHRoaXMuc2VsZWN0b3JzID0gbm9kZS5wcmVsdWRlLmNoaWxkcmVuLm1hcCgobm9kZSkgPT4gbmV3IFNlbGVjdG9yJDEobm9kZSwgc3R5bGVzaGVldCkpO1xuICAgICAgICB0aGlzLmRlY2xhcmF0aW9ucyA9IG5vZGUuYmxvY2suY2hpbGRyZW4ubWFwKChub2RlKSA9PiBuZXcgRGVjbGFyYXRpb24kMShub2RlKSk7XG4gICAgfVxuICAgIGFwcGx5KG5vZGUpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RvcnMuZm9yRWFjaChzZWxlY3RvciA9PiBzZWxlY3Rvci5hcHBseShub2RlKSk7IC8vIFRPRE8gbW92ZSB0aGUgbG9naWMgaW4gaGVyZT9cbiAgICB9XG4gICAgaXNfdXNlZChkZXYpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50ICYmIHRoaXMucGFyZW50Lm5vZGUudHlwZSA9PT0gJ0F0cnVsZScgJiYgaXNfa2V5ZnJhbWVzX25vZGUodGhpcy5wYXJlbnQubm9kZSkpXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuZGVjbGFyYXRpb25zLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiBkZXY7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdG9ycy5zb21lKHMgPT4gcy51c2VkKTtcbiAgICB9XG4gICAgbWluaWZ5KGNvZGUsIF9kZXYpIHtcbiAgICAgICAgbGV0IGMgPSB0aGlzLm5vZGUuc3RhcnQ7XG4gICAgICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2VsZWN0b3JzLmZvckVhY2goKHNlbGVjdG9yKSA9PiB7XG4gICAgICAgICAgICBpZiAoc2VsZWN0b3IudXNlZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlcGFyYXRvciA9IHN0YXJ0ZWQgPyAnLCcgOiAnJztcbiAgICAgICAgICAgICAgICBpZiAoKHNlbGVjdG9yLm5vZGUuc3RhcnQgLSBjKSA+IHNlcGFyYXRvci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29kZS5vdmVyd3JpdGUoYywgc2VsZWN0b3Iubm9kZS5zdGFydCwgc2VwYXJhdG9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VsZWN0b3IubWluaWZ5KGNvZGUpO1xuICAgICAgICAgICAgICAgIGMgPSBzZWxlY3Rvci5ub2RlLmVuZDtcbiAgICAgICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvZGUucmVtb3ZlKGMsIHRoaXMubm9kZS5ibG9jay5zdGFydCk7XG4gICAgICAgIGMgPSB0aGlzLm5vZGUuYmxvY2suc3RhcnQgKyAxO1xuICAgICAgICBjID0gbWluaWZ5X2RlY2xhcmF0aW9ucyhjb2RlLCBjLCB0aGlzLmRlY2xhcmF0aW9ucyk7XG4gICAgICAgIGNvZGUucmVtb3ZlKGMsIHRoaXMubm9kZS5ibG9jay5lbmQgLSAxKTtcbiAgICB9XG4gICAgdHJhbnNmb3JtKGNvZGUsIGlkLCBrZXlmcmFtZXMsIG1heF9hbW91bnRfY2xhc3Nfc3BlY2lmaWNpdHlfaW5jcmVhc2VkKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudCAmJiB0aGlzLnBhcmVudC5ub2RlLnR5cGUgPT09ICdBdHJ1bGUnICYmIGlzX2tleWZyYW1lc19ub2RlKHRoaXMucGFyZW50Lm5vZGUpKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGNvbnN0IGF0dHIgPSBgLiR7aWR9YDtcbiAgICAgICAgdGhpcy5zZWxlY3RvcnMuZm9yRWFjaChzZWxlY3RvciA9PiBzZWxlY3Rvci50cmFuc2Zvcm0oY29kZSwgYXR0ciwgbWF4X2Ftb3VudF9jbGFzc19zcGVjaWZpY2l0eV9pbmNyZWFzZWQpKTtcbiAgICAgICAgdGhpcy5kZWNsYXJhdGlvbnMuZm9yRWFjaChkZWNsYXJhdGlvbiA9PiBkZWNsYXJhdGlvbi50cmFuc2Zvcm0oY29kZSwga2V5ZnJhbWVzKSk7XG4gICAgfVxuICAgIHZhbGlkYXRlKGNvbXBvbmVudCkge1xuICAgICAgICB0aGlzLnNlbGVjdG9ycy5mb3JFYWNoKHNlbGVjdG9yID0+IHtcbiAgICAgICAgICAgIHNlbGVjdG9yLnZhbGlkYXRlKGNvbXBvbmVudCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB3YXJuX29uX3VudXNlZF9zZWxlY3RvcihoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0b3JzLmZvckVhY2goc2VsZWN0b3IgPT4ge1xuICAgICAgICAgICAgaWYgKCFzZWxlY3Rvci51c2VkKVxuICAgICAgICAgICAgICAgIGhhbmRsZXIoc2VsZWN0b3IpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0X21heF9hbW91bnRfY2xhc3Nfc3BlY2lmaWNpdHlfaW5jcmVhc2VkKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgoLi4udGhpcy5zZWxlY3RvcnMubWFwKHNlbGVjdG9yID0+IHNlbGVjdG9yLmdldF9hbW91bnRfY2xhc3Nfc3BlY2lmaWNpdHlfaW5jcmVhc2VkKCkpKTtcbiAgICB9XG59XG5jbGFzcyBEZWNsYXJhdGlvbiQxIHtcbiAgICBjb25zdHJ1Y3Rvcihub2RlKSB7XG4gICAgICAgIHRoaXMubm9kZSA9IG5vZGU7XG4gICAgfVxuICAgIHRyYW5zZm9ybShjb2RlLCBrZXlmcmFtZXMpIHtcbiAgICAgICAgY29uc3QgcHJvcGVydHkgPSB0aGlzLm5vZGUucHJvcGVydHkgJiYgcmVtb3ZlX2Nzc19wcmVmaXgodGhpcy5ub2RlLnByb3BlcnR5LnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICBpZiAocHJvcGVydHkgPT09ICdhbmltYXRpb24nIHx8IHByb3BlcnR5ID09PSAnYW5pbWF0aW9uLW5hbWUnKSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUudmFsdWUuY2hpbGRyZW4uZm9yRWFjaCgoYmxvY2spID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoYmxvY2sudHlwZSA9PT0gJ0lkZW50aWZpZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBibG9jay5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ZnJhbWVzLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29kZS5vdmVyd3JpdGUoYmxvY2suc3RhcnQsIGJsb2NrLmVuZCwga2V5ZnJhbWVzLmdldChuYW1lKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBtaW5pZnkoY29kZSkge1xuICAgICAgICBpZiAoIXRoaXMubm9kZS5wcm9wZXJ0eSlcbiAgICAgICAgICAgIHJldHVybjsgLy8gQGFwcGx5LCBhbmQgcG9zc2libHkgb3RoZXIgd2VpcmQgY2FzZXM/XG4gICAgICAgIGNvbnN0IGMgPSB0aGlzLm5vZGUuc3RhcnQgKyB0aGlzLm5vZGUucHJvcGVydHkubGVuZ3RoO1xuICAgICAgICBjb25zdCBmaXJzdCA9IHRoaXMubm9kZS52YWx1ZS5jaGlsZHJlblxuICAgICAgICAgICAgPyB0aGlzLm5vZGUudmFsdWUuY2hpbGRyZW5bMF1cbiAgICAgICAgICAgIDogdGhpcy5ub2RlLnZhbHVlO1xuICAgICAgICAvLyBEb24ndCBtaW5pZnkgd2hpdGVzcGFjZSBpbiBjdXN0b20gcHJvcGVydGllcywgc2luY2Ugc29tZSBicm93c2VycyAoQ2hyb21pdW0gPCA5OSlcbiAgICAgICAgLy8gdHJlYXQgLS1mb286IDsgYW5kIC0tZm9vOjsgZGlmZmVyZW50bHlcbiAgICAgICAgaWYgKGZpcnN0LnR5cGUgPT09ICdSYXcnICYmIHJlZ2V4X29ubHlfd2hpdGVzcGFjZXMudGVzdChmaXJzdC52YWx1ZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGxldCBzdGFydCA9IGZpcnN0LnN0YXJ0O1xuICAgICAgICB3aGlsZSAocmVnZXhfd2hpdGVzcGFjZS50ZXN0KGNvZGUub3JpZ2luYWxbc3RhcnRdKSlcbiAgICAgICAgICAgIHN0YXJ0ICs9IDE7XG4gICAgICAgIGlmIChzdGFydCAtIGMgPiAxKSB7XG4gICAgICAgICAgICBjb2RlLm92ZXJ3cml0ZShjLCBzdGFydCwgJzonKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmNsYXNzIEF0cnVsZSQxIHtcbiAgICBjb25zdHJ1Y3Rvcihub2RlKSB7XG4gICAgICAgIHRoaXMubm9kZSA9IG5vZGU7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgdGhpcy5kZWNsYXJhdGlvbnMgPSBbXTtcbiAgICB9XG4gICAgYXBwbHkobm9kZSkge1xuICAgICAgICBpZiAodGhpcy5ub2RlLm5hbWUgPT09ICdtZWRpYScgfHwgdGhpcy5ub2RlLm5hbWUgPT09ICdzdXBwb3J0cycgfHwgdGhpcy5ub2RlLm5hbWUgPT09ICdsYXllcicpIHtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICAgICAgY2hpbGQuYXBwbHkobm9kZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc19rZXlmcmFtZXNfbm9kZSh0aGlzLm5vZGUpKSB7XG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goKHJ1bGUpID0+IHtcbiAgICAgICAgICAgICAgICBydWxlLnNlbGVjdG9ycy5mb3JFYWNoKHNlbGVjdG9yID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3IudXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpc191c2VkKF9kZXYpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIFRPRE9cbiAgICB9XG4gICAgbWluaWZ5KGNvZGUsIGRldikge1xuICAgICAgICBpZiAodGhpcy5ub2RlLm5hbWUgPT09ICdtZWRpYScpIHtcbiAgICAgICAgICAgIGNvbnN0IGV4cHJlc3Npb25fY2hhciA9IGNvZGUub3JpZ2luYWxbdGhpcy5ub2RlLnByZWx1ZGUuc3RhcnRdO1xuICAgICAgICAgICAgbGV0IGMgPSB0aGlzLm5vZGUuc3RhcnQgKyAoZXhwcmVzc2lvbl9jaGFyID09PSAnKCcgPyA2IDogNyk7XG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlLnByZWx1ZGUuc3RhcnQgPiBjKVxuICAgICAgICAgICAgICAgIGNvZGUucmVtb3ZlKGMsIHRoaXMubm9kZS5wcmVsdWRlLnN0YXJ0KTtcbiAgICAgICAgICAgIHRoaXMubm9kZS5wcmVsdWRlLmNoaWxkcmVuLmZvckVhY2goKHF1ZXJ5KSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyBtaW5pZnkgcXVlcmllc1xuICAgICAgICAgICAgICAgIGMgPSBxdWVyeS5lbmQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvZGUucmVtb3ZlKGMsIHRoaXMubm9kZS5ibG9jay5zdGFydCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5ub2RlLm5hbWUgPT09ICdzdXBwb3J0cycpIHtcbiAgICAgICAgICAgIGxldCBjID0gdGhpcy5ub2RlLnN0YXJ0ICsgOTtcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGUucHJlbHVkZS5zdGFydCAtIGMgPiAxKVxuICAgICAgICAgICAgICAgIGNvZGUub3ZlcndyaXRlKGMsIHRoaXMubm9kZS5wcmVsdWRlLnN0YXJ0LCAnICcpO1xuICAgICAgICAgICAgdGhpcy5ub2RlLnByZWx1ZGUuY2hpbGRyZW4uZm9yRWFjaCgocXVlcnkpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPIG1pbmlmeSBxdWVyaWVzXG4gICAgICAgICAgICAgICAgYyA9IHF1ZXJ5LmVuZDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29kZS5yZW1vdmUoYywgdGhpcy5ub2RlLmJsb2NrLnN0YXJ0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGxldCBjID0gdGhpcy5ub2RlLnN0YXJ0ICsgdGhpcy5ub2RlLm5hbWUubGVuZ3RoICsgMTtcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGUucHJlbHVkZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGUucHJlbHVkZS5zdGFydCAtIGMgPiAxKVxuICAgICAgICAgICAgICAgICAgICBjb2RlLm92ZXJ3cml0ZShjLCB0aGlzLm5vZGUucHJlbHVkZS5zdGFydCwgJyAnKTtcbiAgICAgICAgICAgICAgICBjID0gdGhpcy5ub2RlLnByZWx1ZGUuZW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubm9kZS5ibG9jayAmJiB0aGlzLm5vZGUuYmxvY2suc3RhcnQgLSBjID4gMCkge1xuICAgICAgICAgICAgICAgIGNvZGUucmVtb3ZlKGMsIHRoaXMubm9kZS5ibG9jay5zdGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gVE9ETyBvdGhlciBhdHJ1bGVzXG4gICAgICAgIGlmICh0aGlzLm5vZGUuYmxvY2spIHtcbiAgICAgICAgICAgIGxldCBjID0gdGhpcy5ub2RlLmJsb2NrLnN0YXJ0ICsgMTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRlY2xhcmF0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjID0gbWluaWZ5X2RlY2xhcmF0aW9ucyhjb2RlLCBjLCB0aGlzLmRlY2xhcmF0aW9ucyk7XG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIGF0cnVsZSBoYXMgY2hpbGRyZW4sIGxlYXZlIHRoZSBsYXN0IGRlY2xhcmF0aW9uIHNlbWljb2xvbiBhbG9uZVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgYysrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5mb3JFYWNoKGNoaWxkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQuaXNfdXNlZChkZXYpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvZGUucmVtb3ZlKGMsIGNoaWxkLm5vZGUuc3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICBjaGlsZC5taW5pZnkoY29kZSwgZGV2KTtcbiAgICAgICAgICAgICAgICAgICAgYyA9IGNoaWxkLm5vZGUuZW5kO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29kZS5yZW1vdmUoYywgdGhpcy5ub2RlLmJsb2NrLmVuZCAtIDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRyYW5zZm9ybShjb2RlLCBpZCwga2V5ZnJhbWVzLCBtYXhfYW1vdW50X2NsYXNzX3NwZWNpZmljaXR5X2luY3JlYXNlZCkge1xuICAgICAgICBpZiAoaXNfa2V5ZnJhbWVzX25vZGUodGhpcy5ub2RlKSkge1xuICAgICAgICAgICAgdGhpcy5ub2RlLnByZWx1ZGUuY2hpbGRyZW4uZm9yRWFjaCgoeyB0eXBlLCBuYW1lLCBzdGFydCwgZW5kIH0pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ0lkZW50aWZpZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lLnN0YXJ0c1dpdGgoJy1nbG9iYWwtJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUucmVtb3ZlKHN0YXJ0LCBzdGFydCArIDgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5mb3JFYWNoKChydWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5zZWxlY3RvcnMuZm9yRWFjaChzZWxlY3RvciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yLnVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlLm92ZXJ3cml0ZShzdGFydCwgZW5kLCBrZXlmcmFtZXMuZ2V0KG5hbWUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICBjaGlsZC50cmFuc2Zvcm0oY29kZSwgaWQsIGtleWZyYW1lcywgbWF4X2Ftb3VudF9jbGFzc19zcGVjaWZpY2l0eV9pbmNyZWFzZWQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgdmFsaWRhdGUoY29tcG9uZW50KSB7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICBjaGlsZC52YWxpZGF0ZShjb21wb25lbnQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgd2Fybl9vbl91bnVzZWRfc2VsZWN0b3IoaGFuZGxlcikge1xuICAgICAgICBpZiAodGhpcy5ub2RlLm5hbWUgIT09ICdtZWRpYScpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICBjaGlsZC53YXJuX29uX3VudXNlZF9zZWxlY3RvcihoYW5kbGVyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldF9tYXhfYW1vdW50X2NsYXNzX3NwZWNpZmljaXR5X2luY3JlYXNlZCgpIHtcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KC4uLnRoaXMuY2hpbGRyZW4ubWFwKHJ1bGUgPT4gcnVsZS5nZXRfbWF4X2Ftb3VudF9jbGFzc19zcGVjaWZpY2l0eV9pbmNyZWFzZWQoKSkpO1xuICAgIH1cbn1cbmNvbnN0IGdldF9kZWZhdWx0X2Nzc19oYXNoID0gKHsgY3NzLCBoYXNoIH0pID0+IHtcbiAgICByZXR1cm4gYHN2ZWx0ZS0ke2hhc2goY3NzKX1gO1xufTtcbmNsYXNzIFN0eWxlc2hlZXQge1xuICAgIGNvbnN0cnVjdG9yKHsgc291cmNlLCBhc3QsIGNvbXBvbmVudF9uYW1lLCBmaWxlbmFtZSwgZGV2LCBnZXRfY3NzX2hhc2ggPSBnZXRfZGVmYXVsdF9jc3NfaGFzaCB9KSB7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgdGhpcy5rZXlmcmFtZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMubm9kZXNfd2l0aF9jc3NfY2xhc3MgPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgICB0aGlzLmFzdCA9IGFzdDtcbiAgICAgICAgdGhpcy5maWxlbmFtZSA9IGZpbGVuYW1lO1xuICAgICAgICB0aGlzLmRldiA9IGRldjtcbiAgICAgICAgaWYgKGFzdC5jc3MgJiYgYXN0LmNzcy5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBnZXRfY3NzX2hhc2goe1xuICAgICAgICAgICAgICAgIGZpbGVuYW1lLFxuICAgICAgICAgICAgICAgIG5hbWU6IGNvbXBvbmVudF9uYW1lLFxuICAgICAgICAgICAgICAgIGNzczogYXN0LmNzcy5jb250ZW50LnN0eWxlcyxcbiAgICAgICAgICAgICAgICBoYXNoXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuaGFzX3N0eWxlcyA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBzdGFjayA9IFtdO1xuICAgICAgICAgICAgbGV0IGRlcHRoID0gMDtcbiAgICAgICAgICAgIGxldCBjdXJyZW50X2F0cnVsZSA9IG51bGw7XG4gICAgICAgICAgICB3YWxrKGFzdC5jc3MsIHtcbiAgICAgICAgICAgICAgICBlbnRlcjogKG5vZGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ0F0cnVsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0cnVsZSA9IG5ldyBBdHJ1bGUkMShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goYXRydWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50X2F0cnVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfYXRydWxlLmNoaWxkcmVuLnB1c2goYXRydWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGRlcHRoIDw9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnB1c2goYXRydWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc19rZXlmcmFtZXNfbm9kZShub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucHJlbHVkZS5jaGlsZHJlbi5mb3JFYWNoKChleHByZXNzaW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHByZXNzaW9uLnR5cGUgPT09ICdJZGVudGlmaWVyJyAmJiAhZXhwcmVzc2lvbi5uYW1lLnN0YXJ0c1dpdGgoJy1nbG9iYWwtJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMua2V5ZnJhbWVzLnNldChleHByZXNzaW9uLm5hbWUsIGAke3RoaXMuaWR9LSR7ZXhwcmVzc2lvbi5uYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhdF9ydWxlX2hhc19kZWNsYXJhdGlvbihub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0X3J1bGVfZGVjbGFyYXRpb25zID0gbm9kZS5ibG9jay5jaGlsZHJlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG5vZGUgPT4gbm9kZS50eXBlID09PSAnRGVjbGFyYXRpb24nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKG5vZGUgPT4gbmV3IERlY2xhcmF0aW9uJDEobm9kZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1c2hfYXJyYXkkMShhdHJ1bGUuZGVjbGFyYXRpb25zLCBhdF9ydWxlX2RlY2xhcmF0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2F0cnVsZSA9IGF0cnVsZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnUnVsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZSQxKG5vZGUsIHRoaXMsIGN1cnJlbnRfYXRydWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50X2F0cnVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfYXRydWxlLmNoaWxkcmVuLnB1c2gocnVsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChkZXB0aCA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKHJ1bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlcHRoICs9IDE7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBsZWF2ZTogKG5vZGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ0F0cnVsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF9hdHJ1bGUgPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkZXB0aCAtPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5oYXNfc3R5bGVzID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXBwbHkobm9kZSkge1xuICAgICAgICBpZiAoIXRoaXMuaGFzX3N0eWxlcylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuY2hpbGRyZW5baV07XG4gICAgICAgICAgICBjaGlsZC5hcHBseShub2RlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWlmeSgpIHtcbiAgICAgICAgdGhpcy5ub2Rlc193aXRoX2Nzc19jbGFzcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgICBub2RlLmFkZF9jc3NfY2xhc3MoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJlbmRlcihmaWxlLCBzaG91bGRfdHJhbnNmb3JtX3NlbGVjdG9ycykge1xuICAgICAgICBpZiAoIXRoaXMuaGFzX3N0eWxlcykge1xuICAgICAgICAgICAgcmV0dXJuIHsgY29kZTogbnVsbCwgbWFwOiBudWxsIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY29kZSA9IG5ldyBNYWdpY1N0cmluZyh0aGlzLnNvdXJjZSk7XG4gICAgICAgIHdhbGsodGhpcy5hc3QuY3NzLCB7XG4gICAgICAgICAgICBlbnRlcjogKG5vZGUpID0+IHtcbiAgICAgICAgICAgICAgICBjb2RlLmFkZFNvdXJjZW1hcExvY2F0aW9uKG5vZGUuc3RhcnQpO1xuICAgICAgICAgICAgICAgIGNvZGUuYWRkU291cmNlbWFwTG9jYXRpb24obm9kZS5lbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHNob3VsZF90cmFuc2Zvcm1fc2VsZWN0b3JzKSB7XG4gICAgICAgICAgICBjb25zdCBtYXggPSBNYXRoLm1heCguLi50aGlzLmNoaWxkcmVuLm1hcChydWxlID0+IHJ1bGUuZ2V0X21heF9hbW91bnRfY2xhc3Nfc3BlY2lmaWNpdHlfaW5jcmVhc2VkKCkpKTtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgICAgICAgICAgICBjaGlsZC50cmFuc2Zvcm0oY29kZSwgdGhpcy5pZCwgdGhpcy5rZXlmcmFtZXMsIG1heCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgYyA9IDA7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICBpZiAoY2hpbGQuaXNfdXNlZCh0aGlzLmRldikpIHtcbiAgICAgICAgICAgICAgICBjb2RlLnJlbW92ZShjLCBjaGlsZC5ub2RlLnN0YXJ0KTtcbiAgICAgICAgICAgICAgICBjaGlsZC5taW5pZnkoY29kZSwgdGhpcy5kZXYpO1xuICAgICAgICAgICAgICAgIGMgPSBjaGlsZC5ub2RlLmVuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvZGUucmVtb3ZlKGMsIHRoaXMuc291cmNlLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb2RlOiBjb2RlLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBtYXA6IGNvZGUuZ2VuZXJhdGVNYXAoe1xuICAgICAgICAgICAgICAgIGluY2x1ZGVDb250ZW50OiB0cnVlLFxuICAgICAgICAgICAgICAgIHNvdXJjZTogdGhpcy5maWxlbmFtZSxcbiAgICAgICAgICAgICAgICBmaWxlXG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgIH1cbiAgICB2YWxpZGF0ZShjb21wb25lbnQpIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5mb3JFYWNoKGNoaWxkID0+IHtcbiAgICAgICAgICAgIGNoaWxkLnZhbGlkYXRlKGNvbXBvbmVudCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB3YXJuX29uX3VudXNlZF9zZWxlY3RvcnMoY29tcG9uZW50KSB7XG4gICAgICAgIGNvbnN0IGlnbm9yZXMgPSAhdGhpcy5hc3QuY3NzID8gW10gOiBleHRyYWN0X2lnbm9yZXNfYWJvdmVfcG9zaXRpb24odGhpcy5hc3QuY3NzLnN0YXJ0LCB0aGlzLmFzdC5odG1sLmNoaWxkcmVuKTtcbiAgICAgICAgY29tcG9uZW50LnB1c2hfaWdub3JlcyhpZ25vcmVzKTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5mb3JFYWNoKGNoaWxkID0+IHtcbiAgICAgICAgICAgIGNoaWxkLndhcm5fb25fdW51c2VkX3NlbGVjdG9yKChzZWxlY3RvcikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuKHNlbGVjdG9yLm5vZGUsIGNvbXBpbGVyX3dhcm5pbmdzLmNzc191bnVzZWRfc2VsZWN0b3IodGhpcy5zb3VyY2Uuc2xpY2Uoc2VsZWN0b3Iubm9kZS5zdGFydCwgc2VsZWN0b3Iubm9kZS5lbmQpKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbXBvbmVudC5wb3BfaWdub3JlcygpO1xuICAgIH1cbn1cblxuY29uc3QgdGVzdCA9IHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmVudi5URVNUO1xuXG5jbGFzcyBUZW1wbGF0ZVNjb3BlIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJlbnQpIHtcbiAgICAgICAgdGhpcy5vd25lcnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLm5hbWVzID0gbmV3IFNldChwYXJlbnQgPyBwYXJlbnQubmFtZXMgOiBbXSk7XG4gICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzX2Zvcl9uYW1lID0gbmV3IE1hcChwYXJlbnQgPyBwYXJlbnQuZGVwZW5kZW5jaWVzX2Zvcl9uYW1lIDogW10pO1xuICAgIH1cbiAgICBhZGQobmFtZSwgZGVwZW5kZW5jaWVzLCBvd25lcikge1xuICAgICAgICB0aGlzLm5hbWVzLmFkZChuYW1lKTtcbiAgICAgICAgdGhpcy5kZXBlbmRlbmNpZXNfZm9yX25hbWUuc2V0KG5hbWUsIGRlcGVuZGVuY2llcyk7XG4gICAgICAgIHRoaXMub3duZXJzLnNldChuYW1lLCBvd25lcik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBjaGlsZCgpIHtcbiAgICAgICAgY29uc3QgY2hpbGQgPSBuZXcgVGVtcGxhdGVTY29wZSh0aGlzKTtcbiAgICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH1cbiAgICBpc190b3BfbGV2ZWwobmFtZSkge1xuICAgICAgICByZXR1cm4gIXRoaXMucGFyZW50IHx8ICF0aGlzLm5hbWVzLmhhcyhuYW1lKSAmJiB0aGlzLnBhcmVudC5pc190b3BfbGV2ZWwobmFtZSk7XG4gICAgfVxuICAgIGdldF9vd25lcihuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm93bmVycy5nZXQobmFtZSkgfHwgKHRoaXMucGFyZW50ICYmIHRoaXMucGFyZW50LmdldF9vd25lcihuYW1lKSk7XG4gICAgfVxuICAgIGlzX2xldChuYW1lKSB7XG4gICAgICAgIGNvbnN0IG93bmVyID0gdGhpcy5nZXRfb3duZXIobmFtZSk7XG4gICAgICAgIHJldHVybiBvd25lciAmJiAob3duZXIudHlwZSA9PT0gJ0VsZW1lbnQnIHx8IG93bmVyLnR5cGUgPT09ICdJbmxpbmVDb21wb25lbnQnIHx8IG93bmVyLnR5cGUgPT09ICdTbG90VGVtcGxhdGUnKTtcbiAgICB9XG4gICAgaXNfYXdhaXQobmFtZSkge1xuICAgICAgICBjb25zdCBvd25lciA9IHRoaXMuZ2V0X293bmVyKG5hbWUpO1xuICAgICAgICByZXR1cm4gb3duZXIgJiYgKG93bmVyLnR5cGUgPT09ICdUaGVuQmxvY2snIHx8IG93bmVyLnR5cGUgPT09ICdDYXRjaEJsb2NrJyk7XG4gICAgfVxuICAgIGlzX2NvbnN0KG5hbWUpIHtcbiAgICAgICAgY29uc3Qgb3duZXIgPSB0aGlzLmdldF9vd25lcihuYW1lKTtcbiAgICAgICAgcmV0dXJuIG93bmVyICYmIG93bmVyLnR5cGUgPT09ICdDb25zdFRhZyc7XG4gICAgfVxufVxuXG5jbGFzcyBGcmFnbWVudCBleHRlbmRzIE5vZGUkMSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBpbmZvKSB7XG4gICAgICAgIGNvbnN0IHNjb3BlID0gbmV3IFRlbXBsYXRlU2NvcGUoKTtcbiAgICAgICAgc3VwZXIoY29tcG9uZW50LCBudWxsLCBzY29wZSwgaW5mbyk7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IG1hcF9jaGlsZHJlbihjb21wb25lbnQsIHRoaXMsIHNjb3BlLCBpbmZvLmNoaWxkcmVuKTtcbiAgICB9XG59XG5cbi8vIFRoaXMgZmlsZSBpcyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZFxudmFyIGludGVybmFsX2V4cG9ydHMgPSBuZXcgU2V0KFtcIkh0bWxUYWdcIiwgXCJIdG1sVGFnSHlkcmF0aW9uXCIsIFwiU3ZlbHRlQ29tcG9uZW50XCIsIFwiU3ZlbHRlQ29tcG9uZW50RGV2XCIsIFwiU3ZlbHRlQ29tcG9uZW50VHlwZWRcIiwgXCJTdmVsdGVFbGVtZW50XCIsIFwiYWN0aW9uX2Rlc3Ryb3llclwiLCBcImFkZF9hdHRyaWJ1dGVcIiwgXCJhZGRfY2xhc3Nlc1wiLCBcImFkZF9mbHVzaF9jYWxsYmFja1wiLCBcImFkZF9sb2NhdGlvblwiLCBcImFkZF9yZW5kZXJfY2FsbGJhY2tcIiwgXCJhZGRfcmVzaXplX2xpc3RlbmVyXCIsIFwiYWRkX3N0eWxlc1wiLCBcImFkZF90cmFuc2Zvcm1cIiwgXCJhZnRlclVwZGF0ZVwiLCBcImFwcGVuZFwiLCBcImFwcGVuZF9kZXZcIiwgXCJhcHBlbmRfZW1wdHlfc3R5bGVzaGVldFwiLCBcImFwcGVuZF9oeWRyYXRpb25cIiwgXCJhcHBlbmRfaHlkcmF0aW9uX2RldlwiLCBcImFwcGVuZF9zdHlsZXNcIiwgXCJhc3NpZ25cIiwgXCJhdHRyXCIsIFwiYXR0cl9kZXZcIiwgXCJhdHRyaWJ1dGVfdG9fb2JqZWN0XCIsIFwiYmVmb3JlVXBkYXRlXCIsIFwiYmluZFwiLCBcImJpbmRpbmdfY2FsbGJhY2tzXCIsIFwiYmxhbmtfb2JqZWN0XCIsIFwiYnViYmxlXCIsIFwiY2hlY2tfb3V0cm9zXCIsIFwiY2hpbGRyZW5cIiwgXCJjbGFpbV9jb21wb25lbnRcIiwgXCJjbGFpbV9lbGVtZW50XCIsIFwiY2xhaW1faHRtbF90YWdcIiwgXCJjbGFpbV9zcGFjZVwiLCBcImNsYWltX3N2Z19lbGVtZW50XCIsIFwiY2xhaW1fdGV4dFwiLCBcImNsZWFyX2xvb3BzXCIsIFwiY29tcG9uZW50X3N1YnNjcmliZVwiLCBcImNvbXB1dGVfcmVzdF9wcm9wc1wiLCBcImNvbXB1dGVfc2xvdHNcIiwgXCJjb25zdHJ1Y3Rfc3ZlbHRlX2NvbXBvbmVudFwiLCBcImNvbnN0cnVjdF9zdmVsdGVfY29tcG9uZW50X2RldlwiLCBcImNyZWF0ZUV2ZW50RGlzcGF0Y2hlclwiLCBcImNyZWF0ZV9hbmltYXRpb25cIiwgXCJjcmVhdGVfYmlkaXJlY3Rpb25hbF90cmFuc2l0aW9uXCIsIFwiY3JlYXRlX2NvbXBvbmVudFwiLCBcImNyZWF0ZV9pbl90cmFuc2l0aW9uXCIsIFwiY3JlYXRlX291dF90cmFuc2l0aW9uXCIsIFwiY3JlYXRlX3Nsb3RcIiwgXCJjcmVhdGVfc3NyX2NvbXBvbmVudFwiLCBcImN1cnJlbnRfY29tcG9uZW50XCIsIFwiY3VzdG9tX2V2ZW50XCIsIFwiZGF0YXNldF9kZXZcIiwgXCJkZWJ1Z1wiLCBcImRlc3Ryb3lfYmxvY2tcIiwgXCJkZXN0cm95X2NvbXBvbmVudFwiLCBcImRlc3Ryb3lfZWFjaFwiLCBcImRldGFjaFwiLCBcImRldGFjaF9hZnRlcl9kZXZcIiwgXCJkZXRhY2hfYmVmb3JlX2RldlwiLCBcImRldGFjaF9iZXR3ZWVuX2RldlwiLCBcImRldGFjaF9kZXZcIiwgXCJkaXJ0eV9jb21wb25lbnRzXCIsIFwiZGlzcGF0Y2hfZGV2XCIsIFwiZWFjaFwiLCBcImVsZW1lbnRcIiwgXCJlbGVtZW50X2lzXCIsIFwiZW1wdHlcIiwgXCJlbmRfaHlkcmF0aW5nXCIsIFwiZXNjYXBlXCIsIFwiZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZVwiLCBcImVzY2FwZV9vYmplY3RcIiwgXCJleGNsdWRlX2ludGVybmFsX3Byb3BzXCIsIFwiZml4X2FuZF9kZXN0cm95X2Jsb2NrXCIsIFwiZml4X2FuZF9vdXRyb19hbmRfZGVzdHJveV9ibG9ja1wiLCBcImZpeF9wb3NpdGlvblwiLCBcImZsdXNoXCIsIFwiZ2V0QWxsQ29udGV4dHNcIiwgXCJnZXRDb250ZXh0XCIsIFwiZ2V0X2FsbF9kaXJ0eV9mcm9tX3Njb3BlXCIsIFwiZ2V0X2JpbmRpbmdfZ3JvdXBfdmFsdWVcIiwgXCJnZXRfY3VycmVudF9jb21wb25lbnRcIiwgXCJnZXRfY3VzdG9tX2VsZW1lbnRzX3Nsb3RzXCIsIFwiZ2V0X3Jvb3RfZm9yX3N0eWxlXCIsIFwiZ2V0X3Nsb3RfY2hhbmdlc1wiLCBcImdldF9zcHJlYWRfb2JqZWN0XCIsIFwiZ2V0X3NwcmVhZF91cGRhdGVcIiwgXCJnZXRfc3RvcmVfdmFsdWVcIiwgXCJnbG9iYWxzXCIsIFwiZ3JvdXBfb3V0cm9zXCIsIFwiaGFuZGxlX3Byb21pc2VcIiwgXCJoYXNDb250ZXh0XCIsIFwiaGFzX3Byb3BcIiwgXCJoZWFkX3NlbGVjdG9yXCIsIFwiaWRlbnRpdHlcIiwgXCJpbml0XCIsIFwiaW5zZXJ0XCIsIFwiaW5zZXJ0X2RldlwiLCBcImluc2VydF9oeWRyYXRpb25cIiwgXCJpbnNlcnRfaHlkcmF0aW9uX2RldlwiLCBcImludHJvc1wiLCBcImludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyXCIsIFwiaXNfY2xpZW50XCIsIFwiaXNfY3Jvc3NvcmlnaW5cIiwgXCJpc19lbXB0eVwiLCBcImlzX2Z1bmN0aW9uXCIsIFwiaXNfcHJvbWlzZVwiLCBcImlzX3ZvaWRcIiwgXCJsaXN0ZW5cIiwgXCJsaXN0ZW5fZGV2XCIsIFwibG9vcFwiLCBcImxvb3BfZ3VhcmRcIiwgXCJtZXJnZV9zc3Jfc3R5bGVzXCIsIFwibWlzc2luZ19jb21wb25lbnRcIiwgXCJtb3VudF9jb21wb25lbnRcIiwgXCJub29wXCIsIFwibm90X2VxdWFsXCIsIFwibm93XCIsIFwibnVsbF90b19lbXB0eVwiLCBcIm9iamVjdF93aXRob3V0X3Byb3BlcnRpZXNcIiwgXCJvbkRlc3Ryb3lcIiwgXCJvbk1vdW50XCIsIFwib25jZVwiLCBcIm91dHJvX2FuZF9kZXN0cm95X2Jsb2NrXCIsIFwicHJldmVudF9kZWZhdWx0XCIsIFwicHJvcF9kZXZcIiwgXCJxdWVyeV9zZWxlY3Rvcl9hbGxcIiwgXCJyYWZcIiwgXCJydW5cIiwgXCJydW5fYWxsXCIsIFwic2FmZV9ub3RfZXF1YWxcIiwgXCJzY2hlZHVsZV91cGRhdGVcIiwgXCJzZWxlY3RfbXVsdGlwbGVfdmFsdWVcIiwgXCJzZWxlY3Rfb3B0aW9uXCIsIFwic2VsZWN0X29wdGlvbnNcIiwgXCJzZWxlY3RfdmFsdWVcIiwgXCJzZWxmXCIsIFwic2V0Q29udGV4dFwiLCBcInNldF9hdHRyaWJ1dGVzXCIsIFwic2V0X2N1cnJlbnRfY29tcG9uZW50XCIsIFwic2V0X2N1c3RvbV9lbGVtZW50X2RhdGFcIiwgXCJzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YV9tYXBcIiwgXCJzZXRfZGF0YVwiLCBcInNldF9kYXRhX2RldlwiLCBcInNldF9pbnB1dF90eXBlXCIsIFwic2V0X2lucHV0X3ZhbHVlXCIsIFwic2V0X25vd1wiLCBcInNldF9yYWZcIiwgXCJzZXRfc3RvcmVfdmFsdWVcIiwgXCJzZXRfc3R5bGVcIiwgXCJzZXRfc3ZnX2F0dHJpYnV0ZXNcIiwgXCJzcGFjZVwiLCBcInNwcmVhZFwiLCBcInNyY191cmxfZXF1YWxcIiwgXCJzdGFydF9oeWRyYXRpbmdcIiwgXCJzdG9wX3Byb3BhZ2F0aW9uXCIsIFwic3Vic2NyaWJlXCIsIFwic3ZnX2VsZW1lbnRcIiwgXCJ0ZXh0XCIsIFwidGlja1wiLCBcInRpbWVfcmFuZ2VzX3RvX2FycmF5XCIsIFwidG9fbnVtYmVyXCIsIFwidG9nZ2xlX2NsYXNzXCIsIFwidHJhbnNpdGlvbl9pblwiLCBcInRyYW5zaXRpb25fb3V0XCIsIFwidHJ1c3RlZFwiLCBcInVwZGF0ZV9hd2FpdF9ibG9ja19icmFuY2hcIiwgXCJ1cGRhdGVfa2V5ZWRfZWFjaFwiLCBcInVwZGF0ZV9zbG90XCIsIFwidXBkYXRlX3Nsb3RfYmFzZVwiLCBcInZhbGlkYXRlX2NvbXBvbmVudFwiLCBcInZhbGlkYXRlX2R5bmFtaWNfZWxlbWVudFwiLCBcInZhbGlkYXRlX2VhY2hfYXJndW1lbnRcIiwgXCJ2YWxpZGF0ZV9lYWNoX2tleXNcIiwgXCJ2YWxpZGF0ZV9zbG90c1wiLCBcInZhbGlkYXRlX3N0b3JlXCIsIFwidmFsaWRhdGVfdm9pZF9keW5hbWljX2VsZW1lbnRcIiwgXCJ4bGlua19hdHRyXCJdKTtcblxuZnVuY3Rpb24gaXNfdXNlZF9hc19yZWZlcmVuY2Uobm9kZSwgcGFyZW50KSB7XG4gICAgaWYgKCFpc19yZWZlcmVuY2Uobm9kZSwgcGFyZW50KSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmICghcGFyZW50KSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1mYWxsdGhyb3VnaCAqL1xuICAgIHN3aXRjaCAocGFyZW50LnR5cGUpIHtcbiAgICAgICAgLy8gZGlzcmVnYXJkIHRoZSBgZm9vYCBpbiBgY29uc3QgZm9vID0gYmFyYFxuICAgICAgICBjYXNlICdWYXJpYWJsZURlY2xhcmF0b3InOlxuICAgICAgICAgICAgcmV0dXJuIG5vZGUgIT09IHBhcmVudC5pZDtcbiAgICAgICAgLy8gZGlzcmVnYXJkIHRoZSBgZm9vYCwgYGJhcmAgaW4gYGZ1bmN0aW9uIGZvbyhiYXIpe31gXG4gICAgICAgIGNhc2UgJ0Z1bmN0aW9uRGVjbGFyYXRpb24nOlxuICAgICAgICAvLyBkaXNyZWdhcmQgdGhlIGBmb29gIGluIGBpbXBvcnQgeyBmb28gfSBmcm9tICdmb28nYFxuICAgICAgICBjYXNlICdJbXBvcnRTcGVjaWZpZXInOlxuICAgICAgICAvLyBkaXNyZWdhcmQgdGhlIGBmb29gIGluIGBpbXBvcnQgZm9vIGZyb20gJ2ZvbydgXG4gICAgICAgIGNhc2UgJ0ltcG9ydERlZmF1bHRTcGVjaWZpZXInOlxuICAgICAgICAvLyBkaXNyZWdhcmQgdGhlIGBmb29gIGluIGBpbXBvcnQgKiBhcyBmb28gZnJvbSAnZm9vJ2BcbiAgICAgICAgY2FzZSAnSW1wb3J0TmFtZXNwYWNlU3BlY2lmaWVyJzpcbiAgICAgICAgLy8gZGlzcmVnYXJkIHRoZSBgZm9vYCBpbiBgZXhwb3J0IHsgZm9vIH1gXG4gICAgICAgIGNhc2UgJ0V4cG9ydFNwZWNpZmllcic6XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG5cbmNvbnN0IHJlZ2V4X2xlYWRpbmdfZGlyZWN0b3J5X3NlcGFyYXRvciA9IC9eWy9cXFxcXS87XG5jb25zdCByZWdleF9zdGFydHNfd2l0aF90ZXJtX2V4cG9ydCA9IC9eRXhwb3J0LztcbmNvbnN0IHJlZ2V4X2NvbnRhaW5zX3Rlcm1fZnVuY3Rpb24gPSAvRnVuY3Rpb24vO1xuY2xhc3MgQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihhc3QsIHNvdXJjZSwgbmFtZSwgY29tcGlsZV9vcHRpb25zLCBzdGF0cywgd2FybmluZ3MpIHtcbiAgICAgICAgdGhpcy5pZ25vcmVfc3RhY2sgPSBbXTtcbiAgICAgICAgdGhpcy52YXJzID0gW107XG4gICAgICAgIHRoaXMudmFyX2xvb2t1cCA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5pbXBvcnRzID0gW107XG4gICAgICAgIHRoaXMuZXhwb3J0c19mcm9tID0gW107XG4gICAgICAgIHRoaXMuaW5zdGFuY2VfZXhwb3J0c19mcm9tID0gW107XG4gICAgICAgIHRoaXMuaG9pc3RhYmxlX25vZGVzID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLm5vZGVfZm9yX2RlY2xhcmF0aW9uID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLnBhcnRseV9ob2lzdGVkID0gW107XG4gICAgICAgIHRoaXMuZnVsbHlfaG9pc3RlZCA9IFtdO1xuICAgICAgICB0aGlzLnJlYWN0aXZlX2RlY2xhcmF0aW9ucyA9IFtdO1xuICAgICAgICB0aGlzLnJlYWN0aXZlX2RlY2xhcmF0aW9uX25vZGVzID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLmhhc19yZWFjdGl2ZV9hc3NpZ25tZW50cyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmluamVjdGVkX3JlYWN0aXZlX2RlY2xhcmF0aW9uX3ZhcnMgPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMuaGVscGVycyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5nbG9iYWxzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmluZGlyZWN0X2RlcGVuZGVuY2llcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5lbGVtZW50cyA9IFtdO1xuICAgICAgICB0aGlzLmFsaWFzZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMudXNlZF9uYW1lcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5nbG9iYWxseV91c2VkX25hbWVzID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLnNsb3RzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLnNsb3Rfb3V0bGV0cyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5uYW1lID0geyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWUgfTtcbiAgICAgICAgdGhpcy5zdGF0cyA9IHN0YXRzO1xuICAgICAgICB0aGlzLndhcm5pbmdzID0gd2FybmluZ3M7XG4gICAgICAgIHRoaXMuYXN0ID0gYXN0O1xuICAgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgICAgdGhpcy5jb21waWxlX29wdGlvbnMgPSBjb21waWxlX29wdGlvbnM7XG4gICAgICAgIC8vIHRoZSBpbnN0YW5jZSBKUyBnZXRzIG11dGF0ZWQsIHNvIHdlIHBhcmtcbiAgICAgICAgLy8gYSBjb3B5IGhlcmUgZm9yIGxhdGVyLiBUT0RPIHRoaXMgZmVlbHMgZ3Jvc3NcbiAgICAgICAgdGhpcy5vcmlnaW5hbF9hc3QgPSBjbG9uZSh7XG4gICAgICAgICAgICBodG1sOiBhc3QuaHRtbCxcbiAgICAgICAgICAgIGNzczogYXN0LmNzcyxcbiAgICAgICAgICAgIGluc3RhbmNlOiBhc3QuaW5zdGFuY2UsXG4gICAgICAgICAgICBtb2R1bGU6IGFzdC5tb2R1bGVcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZmlsZSA9XG4gICAgICAgICAgICBjb21waWxlX29wdGlvbnMuZmlsZW5hbWUgJiZcbiAgICAgICAgICAgICAgICAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnXG4gICAgICAgICAgICAgICAgICAgID8gY29tcGlsZV9vcHRpb25zLmZpbGVuYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZShwcm9jZXNzLmN3ZCgpLCAnJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKHJlZ2V4X2xlYWRpbmdfZGlyZWN0b3J5X3NlcGFyYXRvciwgJycpXG4gICAgICAgICAgICAgICAgICAgIDogY29tcGlsZV9vcHRpb25zLmZpbGVuYW1lKTtcbiAgICAgICAgdGhpcy5sb2NhdGUgPSBnZXRMb2NhdG9yKHRoaXMuc291cmNlLCB7IG9mZnNldExpbmU6IDEgfSk7XG4gICAgICAgIC8vIHN0eWxlc1xuICAgICAgICB0aGlzLnN0eWxlc2hlZXQgPSBuZXcgU3R5bGVzaGVldCh7XG4gICAgICAgICAgICBzb3VyY2UsXG4gICAgICAgICAgICBhc3QsXG4gICAgICAgICAgICBmaWxlbmFtZTogY29tcGlsZV9vcHRpb25zLmZpbGVuYW1lLFxuICAgICAgICAgICAgY29tcG9uZW50X25hbWU6IG5hbWUsXG4gICAgICAgICAgICBkZXY6IGNvbXBpbGVfb3B0aW9ucy5kZXYsXG4gICAgICAgICAgICBnZXRfY3NzX2hhc2g6IGNvbXBpbGVfb3B0aW9ucy5jc3NIYXNoXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN0eWxlc2hlZXQudmFsaWRhdGUodGhpcyk7XG4gICAgICAgIHRoaXMuY29tcG9uZW50X29wdGlvbnMgPSBwcm9jZXNzX2NvbXBvbmVudF9vcHRpb25zKHRoaXMsIHRoaXMuYXN0Lmh0bWwuY2hpbGRyZW4pO1xuICAgICAgICB0aGlzLm5hbWVzcGFjZSA9XG4gICAgICAgICAgICBuYW1lc3BhY2VzW3RoaXMuY29tcG9uZW50X29wdGlvbnMubmFtZXNwYWNlXSB8fFxuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50X29wdGlvbnMubmFtZXNwYWNlO1xuICAgICAgICBpZiAoY29tcGlsZV9vcHRpb25zLmN1c3RvbUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbXBvbmVudF9vcHRpb25zLnRhZyA9PT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgY29tcGlsZV9vcHRpb25zLnRhZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3ZlbHRlT3B0aW9ucyA9IGFzdC5odG1sLmNoaWxkcmVuLmZpbmQoY2hpbGQgPT4gY2hpbGQubmFtZSA9PT0gJ3N2ZWx0ZTpvcHRpb25zJykgfHwgeyBzdGFydDogMCwgZW5kOiAwIH07XG4gICAgICAgICAgICAgICAgdGhpcy53YXJuKHN2ZWx0ZU9wdGlvbnMsIGNvbXBpbGVyX3dhcm5pbmdzLmN1c3RvbV9lbGVtZW50X25vX3RhZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnRhZyA9IHRoaXMuY29tcG9uZW50X29wdGlvbnMudGFnIHx8IGNvbXBpbGVfb3B0aW9ucy50YWc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRhZyA9IHRoaXMubmFtZS5uYW1lO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud2Fsa19tb2R1bGVfanMoKTtcbiAgICAgICAgdGhpcy5wdXNoX2lnbm9yZXModGhpcy5hc3QuaW5zdGFuY2UgPyBleHRyYWN0X2lnbm9yZXNfYWJvdmVfcG9zaXRpb24odGhpcy5hc3QuaW5zdGFuY2Uuc3RhcnQsIHRoaXMuYXN0Lmh0bWwuY2hpbGRyZW4pIDogW10pO1xuICAgICAgICB0aGlzLndhbGtfaW5zdGFuY2VfanNfcHJlX3RlbXBsYXRlKCk7XG4gICAgICAgIHRoaXMucG9wX2lnbm9yZXMoKTtcbiAgICAgICAgdGhpcy5mcmFnbWVudCA9IG5ldyBGcmFnbWVudCh0aGlzLCBhc3QuaHRtbCk7XG4gICAgICAgIHRoaXMubmFtZSA9IHRoaXMuZ2V0X3VuaXF1ZV9uYW1lKG5hbWUpO1xuICAgICAgICB0aGlzLnB1c2hfaWdub3Jlcyh0aGlzLmFzdC5pbnN0YW5jZSA/IGV4dHJhY3RfaWdub3Jlc19hYm92ZV9wb3NpdGlvbih0aGlzLmFzdC5pbnN0YW5jZS5zdGFydCwgdGhpcy5hc3QuaHRtbC5jaGlsZHJlbikgOiBbXSk7XG4gICAgICAgIHRoaXMud2Fsa19pbnN0YW5jZV9qc19wb3N0X3RlbXBsYXRlKCk7XG4gICAgICAgIHRoaXMucG9wX2lnbm9yZXMoKTtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5mb3JFYWNoKGVsZW1lbnQgPT4gdGhpcy5zdHlsZXNoZWV0LmFwcGx5KGVsZW1lbnQpKTtcbiAgICAgICAgaWYgKCFjb21waWxlX29wdGlvbnMuY3VzdG9tRWxlbWVudClcbiAgICAgICAgICAgIHRoaXMuc3R5bGVzaGVldC5yZWlmeSgpO1xuICAgICAgICB0aGlzLnN0eWxlc2hlZXQud2Fybl9vbl91bnVzZWRfc2VsZWN0b3JzKHRoaXMpO1xuICAgIH1cbiAgICBhZGRfdmFyKG5vZGUsIHZhcmlhYmxlLCBhZGRfdG9fbG9va3VwID0gdHJ1ZSkge1xuICAgICAgICB0aGlzLnZhcnMucHVzaCh2YXJpYWJsZSk7XG4gICAgICAgIGlmIChhZGRfdG9fbG9va3VwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy52YXJfbG9va3VwLmhhcyh2YXJpYWJsZS5uYW1lKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0c192YXIgPSB0aGlzLnZhcl9sb29rdXAuZ2V0KHZhcmlhYmxlLm5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdHNfdmFyLm1vZHVsZSAmJiBleGlzdHNfdmFyLmltcG9ydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3Iobm9kZSwgY29tcGlsZXJfZXJyb3JzLmlsbGVnYWxfdmFyaWFibGVfZGVjbGFyYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmFyX2xvb2t1cC5zZXQodmFyaWFibGUubmFtZSwgdmFyaWFibGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFkZF9yZWZlcmVuY2Uobm9kZSwgbmFtZSkge1xuICAgICAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMudmFyX2xvb2t1cC5nZXQobmFtZSk7XG4gICAgICAgIGlmICh2YXJpYWJsZSkge1xuICAgICAgICAgICAgdmFyaWFibGUucmVmZXJlbmNlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNfcmVzZXJ2ZWRfa2V5d29yZChuYW1lKSkge1xuICAgICAgICAgICAgdGhpcy5hZGRfdmFyKG5vZGUsIHtcbiAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgIGluamVjdGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIHJlZmVyZW5jZWQ6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5hbWVbMF0gPT09ICckJykge1xuICAgICAgICAgICAgdGhpcy5hZGRfdmFyKG5vZGUsIHtcbiAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgIGluamVjdGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIHJlZmVyZW5jZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgbXV0YXRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBzdWJzY3JpYmFibGVfbmFtZSA9IG5hbWUuc2xpY2UoMSk7XG4gICAgICAgICAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMudmFyX2xvb2t1cC5nZXQoc3Vic2NyaWJhYmxlX25hbWUpO1xuICAgICAgICAgICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICAgICAgICAgICAgdmFyaWFibGUucmVmZXJlbmNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyaWFibGUuc3Vic2NyaWJhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbXBpbGVfb3B0aW9ucy52YXJzUmVwb3J0ID09PSAnZnVsbCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZF92YXIobm9kZSwgeyBuYW1lLCByZWZlcmVuY2VkOiB0cnVlIH0sIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXNlZF9uYW1lcy5hZGQobmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWxpYXMobmFtZSkge1xuICAgICAgICBpZiAoIXRoaXMuYWxpYXNlcy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgIHRoaXMuYWxpYXNlcy5zZXQobmFtZSwgdGhpcy5nZXRfdW5pcXVlX25hbWUobmFtZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmFsaWFzZXMuZ2V0KG5hbWUpO1xuICAgIH1cbiAgICBhcHBseV9zdHlsZXNoZWV0KGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5wdXNoKGVsZW1lbnQpO1xuICAgIH1cbiAgICBnbG9iYWwobmFtZSkge1xuICAgICAgICBjb25zdCBhbGlhcyA9IHRoaXMuYWxpYXMobmFtZSk7XG4gICAgICAgIHRoaXMuZ2xvYmFscy5zZXQobmFtZSwgYWxpYXMpO1xuICAgICAgICByZXR1cm4gYWxpYXM7XG4gICAgfVxuICAgIGdlbmVyYXRlKHJlc3VsdCkge1xuICAgICAgICBsZXQganMgPSBudWxsO1xuICAgICAgICBsZXQgY3NzID0gbnVsbDtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgeyBjb21waWxlX29wdGlvbnMsIG5hbWUgfSA9IHRoaXM7XG4gICAgICAgICAgICBjb25zdCB7IGZvcm1hdCA9ICdlc20nIH0gPSBjb21waWxlX29wdGlvbnM7XG4gICAgICAgICAgICBjb25zdCBiYW5uZXIgPSBgJHt0aGlzLmZpbGUgPyBgJHt0aGlzLmZpbGV9IGAgOiAnJ31nZW5lcmF0ZWQgYnkgU3ZlbHRlIHYkeyczLjUyLjAnfWA7XG4gICAgICAgICAgICBjb25zdCBwcm9ncmFtID0geyB0eXBlOiAnUHJvZ3JhbScsIGJvZHk6IHJlc3VsdC5qcyB9O1xuICAgICAgICAgICAgd2Fsayhwcm9ncmFtLCB7XG4gICAgICAgICAgICAgICAgZW50ZXI6IChub2RlLCBwYXJlbnQsIGtleSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnSWRlbnRpZmllcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm5hbWVbMF0gPT09ICdAJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm5hbWVbMV0gPT09ICdfJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhbGlhcyA9IHRoaXMuZ2xvYmFsKG5vZGUubmFtZS5zbGljZSgyKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUubmFtZSA9IGFsaWFzLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmFtZSA9IG5vZGUubmFtZS5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBpbGVfb3B0aW9ucy5oeWRyYXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW50ZXJuYWxfZXhwb3J0cy5oYXMoYCR7bmFtZX1faHlkcmF0aW9uYCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lICs9ICdfaHlkcmF0aW9uJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGludGVybmFsX2V4cG9ydHMuaGFzKGAke25hbWV9SHlkcmF0aW9uYCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lICs9ICdIeWRyYXRpb24nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21waWxlX29wdGlvbnMuZGV2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW50ZXJuYWxfZXhwb3J0cy5oYXMoYCR7bmFtZX1fZGV2YCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lICs9ICdfZGV2JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGludGVybmFsX2V4cG9ydHMuaGFzKGAke25hbWV9RGV2YCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lICs9ICdEZXYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFsaWFzID0gdGhpcy5hbGlhcyhuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJzLnNldChuYW1lLCBhbGlhcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUubmFtZSA9IGFsaWFzLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5uYW1lWzBdICE9PSAnIycgJiYgIWlzX3ZhbGlkKG5vZGUubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGhhY2sgYWxsb3dzIHhgZm9vLiR7YmFyfWAgd2hlcmUgYmFyIGNvdWxkIGJlIGludmFsaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaXRlcmFsID0geyB0eXBlOiAnTGl0ZXJhbCcsIHZhbHVlOiBub2RlLm5hbWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50LnR5cGUgPT09ICdQcm9wZXJ0eScgJiYga2V5ID09PSAna2V5Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQua2V5ID0gbGl0ZXJhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50LnR5cGUgPT09ICdNZW1iZXJFeHByZXNzaW9uJyAmJiBrZXkgPT09ICdwcm9wZXJ0eScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LnByb3BlcnR5ID0gbGl0ZXJhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmNvbXB1dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHJlZmVyZW5jZWRfZ2xvYmFscyA9IEFycmF5LmZyb20odGhpcy5nbG9iYWxzLCAoW25hbWUsIGFsaWFzXSkgPT4gbmFtZSAhPT0gYWxpYXMubmFtZSAmJiB7IG5hbWUsIGFsaWFzIH0pLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgICAgIGlmIChyZWZlcmVuY2VkX2dsb2JhbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJzLnNldCgnZ2xvYmFscycsIHRoaXMuYWxpYXMoJ2dsb2JhbHMnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBpbXBvcnRlZF9oZWxwZXJzID0gQXJyYXkuZnJvbSh0aGlzLmhlbHBlcnMsIChbbmFtZSwgYWxpYXNdKSA9PiAoe1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgYWxpYXNcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNyZWF0ZV9tb2R1bGUocHJvZ3JhbSwgZm9ybWF0LCBuYW1lLCBiYW5uZXIsIGNvbXBpbGVfb3B0aW9ucy5zdmVsdGVQYXRoLCBpbXBvcnRlZF9oZWxwZXJzLCByZWZlcmVuY2VkX2dsb2JhbHMsIHRoaXMuaW1wb3J0cywgdGhpcy52YXJzXG4gICAgICAgICAgICAgICAgLmZpbHRlcih2YXJpYWJsZSA9PiB2YXJpYWJsZS5tb2R1bGUgJiYgdmFyaWFibGUuZXhwb3J0X25hbWUpXG4gICAgICAgICAgICAgICAgLm1hcCh2YXJpYWJsZSA9PiAoe1xuICAgICAgICAgICAgICAgIG5hbWU6IHZhcmlhYmxlLm5hbWUsXG4gICAgICAgICAgICAgICAgYXM6IHZhcmlhYmxlLmV4cG9ydF9uYW1lXG4gICAgICAgICAgICB9KSksIHRoaXMuZXhwb3J0c19mcm9tKTtcbiAgICAgICAgICAgIGNzcyA9IGNvbXBpbGVfb3B0aW9ucy5jdXN0b21FbGVtZW50XG4gICAgICAgICAgICAgICAgPyB7IGNvZGU6IG51bGwsIG1hcDogbnVsbCB9XG4gICAgICAgICAgICAgICAgOiByZXN1bHQuY3NzO1xuICAgICAgICAgICAgY29uc3QganNfc291cmNlbWFwX2VuYWJsZWQgPSBjaGVja19lbmFibGVfc291cmNlbWFwKGNvbXBpbGVfb3B0aW9ucy5lbmFibGVTb3VyY2VtYXAsICdqcycpO1xuICAgICAgICAgICAgaWYgKCFqc19zb3VyY2VtYXBfZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIGpzID0gcHJpbnQocHJvZ3JhbSk7XG4gICAgICAgICAgICAgICAganMubWFwID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZW1hcF9zb3VyY2VfZmlsZW5hbWUgPSBnZXRfc291cmNlbWFwX3NvdXJjZV9maWxlbmFtZShjb21waWxlX29wdGlvbnMpO1xuICAgICAgICAgICAgICAgIGpzID0gcHJpbnQocHJvZ3JhbSwge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VNYXBTb3VyY2U6IHNvdXJjZW1hcF9zb3VyY2VfZmlsZW5hbWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBqcy5tYXAuc291cmNlcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlbWFwX3NvdXJjZV9maWxlbmFtZVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAganMubWFwLnNvdXJjZXNDb250ZW50ID0gW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAganMubWFwID0gYXBwbHlfcHJlcHJvY2Vzc29yX3NvdXJjZW1hcChzb3VyY2VtYXBfc291cmNlX2ZpbGVuYW1lLCBqcy5tYXAsIGNvbXBpbGVfb3B0aW9ucy5zb3VyY2VtYXApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBqcyxcbiAgICAgICAgICAgIGNzcyxcbiAgICAgICAgICAgIGFzdDogdGhpcy5vcmlnaW5hbF9hc3QsXG4gICAgICAgICAgICB3YXJuaW5nczogdGhpcy53YXJuaW5ncyxcbiAgICAgICAgICAgIHZhcnM6IHRoaXMuZ2V0X3ZhcnNfcmVwb3J0KCksXG4gICAgICAgICAgICBzdGF0czogdGhpcy5zdGF0cy5yZW5kZXIoKVxuICAgICAgICB9O1xuICAgIH1cbiAgICBnZXRfdW5pcXVlX25hbWUobmFtZSwgc2NvcGUpIHtcbiAgICAgICAgaWYgKHRlc3QpXG4gICAgICAgICAgICBuYW1lID0gYCR7bmFtZX0kYDtcbiAgICAgICAgbGV0IGFsaWFzID0gbmFtZTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IHJlc2VydmVkLmhhcyhhbGlhcykgfHxcbiAgICAgICAgICAgIHRoaXMudmFyX2xvb2t1cC5oYXMoYWxpYXMpIHx8XG4gICAgICAgICAgICB0aGlzLnVzZWRfbmFtZXMuaGFzKGFsaWFzKSB8fFxuICAgICAgICAgICAgdGhpcy5nbG9iYWxseV91c2VkX25hbWVzLmhhcyhhbGlhcykgfHxcbiAgICAgICAgICAgIChzY29wZSAmJiBzY29wZS5oYXMoYWxpYXMpKTsgYWxpYXMgPSBgJHtuYW1lfV8ke2krK31gKVxuICAgICAgICAgICAgO1xuICAgICAgICB0aGlzLnVzZWRfbmFtZXMuYWRkKGFsaWFzKTtcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiBhbGlhcyB9O1xuICAgIH1cbiAgICBnZXRfdW5pcXVlX25hbWVfbWFrZXIoKSB7XG4gICAgICAgIGNvbnN0IGxvY2FsX3VzZWRfbmFtZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIGZ1bmN0aW9uIGFkZChuYW1lKSB7XG4gICAgICAgICAgICBsb2NhbF91c2VkX25hbWVzLmFkZChuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICByZXNlcnZlZC5mb3JFYWNoKGFkZCk7XG4gICAgICAgIGludGVybmFsX2V4cG9ydHMuZm9yRWFjaChhZGQpO1xuICAgICAgICB0aGlzLnZhcl9sb29rdXAuZm9yRWFjaCgoX3ZhbHVlLCBrZXkpID0+IGFkZChrZXkpKTtcbiAgICAgICAgcmV0dXJuIChuYW1lKSA9PiB7XG4gICAgICAgICAgICBpZiAodGVzdClcbiAgICAgICAgICAgICAgICBuYW1lID0gYCR7bmFtZX0kYDtcbiAgICAgICAgICAgIGxldCBhbGlhcyA9IG5hbWU7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgdGhpcy51c2VkX25hbWVzLmhhcyhhbGlhcykgfHwgbG9jYWxfdXNlZF9uYW1lcy5oYXMoYWxpYXMpOyBhbGlhcyA9IGAke25hbWV9XyR7aSsrfWApXG4gICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgbG9jYWxfdXNlZF9uYW1lcy5hZGQoYWxpYXMpO1xuICAgICAgICAgICAgdGhpcy5nbG9iYWxseV91c2VkX25hbWVzLmFkZChhbGlhcyk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdJZGVudGlmaWVyJyxcbiAgICAgICAgICAgICAgICBuYW1lOiBhbGlhc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0X3ZhcnNfcmVwb3J0KCkge1xuICAgICAgICBjb25zdCB7IGNvbXBpbGVfb3B0aW9ucywgdmFycyB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgdmFyc19yZXBvcnQgPSBjb21waWxlX29wdGlvbnMudmFyc1JlcG9ydCA9PT0gZmFsc2VcbiAgICAgICAgICAgID8gW11cbiAgICAgICAgICAgIDogY29tcGlsZV9vcHRpb25zLnZhcnNSZXBvcnQgPT09ICdmdWxsJ1xuICAgICAgICAgICAgICAgID8gdmFyc1xuICAgICAgICAgICAgICAgIDogdmFycy5maWx0ZXIodiA9PiAhdi5nbG9iYWwgJiYgIXYuaW50ZXJuYWwpO1xuICAgICAgICByZXR1cm4gdmFyc19yZXBvcnQubWFwKHYgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IHYubmFtZSxcbiAgICAgICAgICAgIGV4cG9ydF9uYW1lOiB2LmV4cG9ydF9uYW1lIHx8IG51bGwsXG4gICAgICAgICAgICBpbmplY3RlZDogdi5pbmplY3RlZCB8fCBmYWxzZSxcbiAgICAgICAgICAgIG1vZHVsZTogdi5tb2R1bGUgfHwgZmFsc2UsXG4gICAgICAgICAgICBtdXRhdGVkOiB2Lm11dGF0ZWQgfHwgZmFsc2UsXG4gICAgICAgICAgICByZWFzc2lnbmVkOiB2LnJlYXNzaWduZWQgfHwgZmFsc2UsXG4gICAgICAgICAgICByZWZlcmVuY2VkOiB2LnJlZmVyZW5jZWQgfHwgZmFsc2UsXG4gICAgICAgICAgICB3cml0YWJsZTogdi53cml0YWJsZSB8fCBmYWxzZSxcbiAgICAgICAgICAgIHJlZmVyZW5jZWRfZnJvbV9zY3JpcHQ6IHYucmVmZXJlbmNlZF9mcm9tX3NjcmlwdCB8fCBmYWxzZVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGVycm9yKHBvcywgZSkge1xuICAgICAgICBpZiAodGhpcy5jb21waWxlX29wdGlvbnMuZXJyb3JNb2RlID09PSAnd2FybicpIHtcbiAgICAgICAgICAgIHRoaXMud2Fybihwb3MsIGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXJyb3IoZS5tZXNzYWdlLCB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ1ZhbGlkYXRpb25FcnJvcicsXG4gICAgICAgICAgICAgICAgY29kZTogZS5jb2RlLFxuICAgICAgICAgICAgICAgIHNvdXJjZTogdGhpcy5zb3VyY2UsXG4gICAgICAgICAgICAgICAgc3RhcnQ6IHBvcy5zdGFydCxcbiAgICAgICAgICAgICAgICBlbmQ6IHBvcy5lbmQsXG4gICAgICAgICAgICAgICAgZmlsZW5hbWU6IHRoaXMuY29tcGlsZV9vcHRpb25zLmZpbGVuYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3YXJuKHBvcywgd2FybmluZykge1xuICAgICAgICBpZiAodGhpcy5pZ25vcmVzICYmIHRoaXMuaWdub3Jlcy5oYXMod2FybmluZy5jb2RlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5sb2NhdGUocG9zLnN0YXJ0KTtcbiAgICAgICAgY29uc3QgZW5kID0gdGhpcy5sb2NhdGUocG9zLmVuZCk7XG4gICAgICAgIGNvbnN0IGZyYW1lID0gZ2V0X2NvZGVfZnJhbWUodGhpcy5zb3VyY2UsIHN0YXJ0LmxpbmUgLSAxLCBzdGFydC5jb2x1bW4pO1xuICAgICAgICB0aGlzLndhcm5pbmdzLnB1c2goe1xuICAgICAgICAgICAgY29kZTogd2FybmluZy5jb2RlLFxuICAgICAgICAgICAgbWVzc2FnZTogd2FybmluZy5tZXNzYWdlLFxuICAgICAgICAgICAgZnJhbWUsXG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZCxcbiAgICAgICAgICAgIHBvczogcG9zLnN0YXJ0LFxuICAgICAgICAgICAgZmlsZW5hbWU6IHRoaXMuY29tcGlsZV9vcHRpb25zLmZpbGVuYW1lLFxuICAgICAgICAgICAgdG9TdHJpbmc6ICgpID0+IGAke3dhcm5pbmcubWVzc2FnZX0gKCR7c3RhcnQubGluZX06JHtzdGFydC5jb2x1bW59KVxcbiR7ZnJhbWV9YFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZXh0cmFjdF9pbXBvcnRzKG5vZGUpIHtcbiAgICAgICAgdGhpcy5pbXBvcnRzLnB1c2gobm9kZSk7XG4gICAgfVxuICAgIGV4dHJhY3RfZXhwb3J0cyhub2RlLCBtb2R1bGVfc2NyaXB0ID0gZmFsc2UpIHtcbiAgICAgICAgY29uc3QgaWdub3JlcyA9IGV4dHJhY3Rfc3ZlbHRlX2lnbm9yZV9mcm9tX2NvbW1lbnRzKG5vZGUpO1xuICAgICAgICBpZiAoaWdub3Jlcy5sZW5ndGgpXG4gICAgICAgICAgICB0aGlzLnB1c2hfaWdub3JlcyhpZ25vcmVzKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5fZXh0cmFjdF9leHBvcnRzKG5vZGUsIG1vZHVsZV9zY3JpcHQpO1xuICAgICAgICBpZiAoaWdub3Jlcy5sZW5ndGgpXG4gICAgICAgICAgICB0aGlzLnBvcF9pZ25vcmVzKCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIF9leHRyYWN0X2V4cG9ydHMobm9kZSwgbW9kdWxlX3NjcmlwdCkge1xuICAgICAgICBpZiAobm9kZS50eXBlID09PSAnRXhwb3J0RGVmYXVsdERlY2xhcmF0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3Iobm9kZSwgY29tcGlsZXJfZXJyb3JzLmRlZmF1bHRfZXhwb3J0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZS50eXBlID09PSAnRXhwb3J0TmFtZWREZWNsYXJhdGlvbicpIHtcbiAgICAgICAgICAgIGlmIChub2RlLnNvdXJjZSkge1xuICAgICAgICAgICAgICAgIGlmIChtb2R1bGVfc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhwb3J0c19mcm9tLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluc3RhbmNlX2V4cG9ydHNfZnJvbS5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChub2RlLmRlY2xhcmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuZGVjbGFyYXRpb24udHlwZSA9PT0gJ1ZhcmlhYmxlRGVjbGFyYXRpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuZGVjbGFyYXRpb24uZGVjbGFyYXRpb25zLmZvckVhY2goZGVjbGFyYXRvciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHRyYWN0X25hbWVzKGRlY2xhcmF0b3IuaWQpLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLnZhcl9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlLmV4cG9ydF9uYW1lID0gbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZV9zY3JpcHQgJiYgdmFyaWFibGUud3JpdGFibGUgJiYgISh2YXJpYWJsZS5yZWZlcmVuY2VkIHx8IHZhcmlhYmxlLnJlZmVyZW5jZWRfZnJvbV9zY3JpcHQgfHwgdmFyaWFibGUuc3Vic2NyaWJhYmxlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhcm4oZGVjbGFyYXRvciwgY29tcGlsZXJfd2FybmluZ3MudW51c2VkX2V4cG9ydF9sZXQodGhpcy5uYW1lLm5hbWUsIG5hbWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IG5vZGUuZGVjbGFyYXRpb24uaWQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhcmlhYmxlID0gdGhpcy52YXJfbG9va3VwLmdldChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFibGUuZXhwb3J0X25hbWUgPSBuYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5kZWNsYXJhdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGUuc3BlY2lmaWVycy5mb3JFYWNoKHNwZWNpZmllciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhcmlhYmxlID0gdGhpcy52YXJfbG9va3VwLmdldChzcGVjaWZpZXIubG9jYWwubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGUuZXhwb3J0X25hbWUgPSBzcGVjaWZpZXIuZXhwb3J0ZWQubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbW9kdWxlX3NjcmlwdCAmJiB2YXJpYWJsZS53cml0YWJsZSAmJiAhKHZhcmlhYmxlLnJlZmVyZW5jZWQgfHwgdmFyaWFibGUucmVmZXJlbmNlZF9mcm9tX3NjcmlwdCB8fCB2YXJpYWJsZS5zdWJzY3JpYmFibGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53YXJuKHNwZWNpZmllciwgY29tcGlsZXJfd2FybmluZ3MudW51c2VkX2V4cG9ydF9sZXQodGhpcy5uYW1lLm5hbWUsIHNwZWNpZmllci5leHBvcnRlZC5uYW1lKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBleHRyYWN0X2phdmFzY3JpcHQoc2NyaXB0KSB7XG4gICAgICAgIGlmICghc2NyaXB0KVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiBzY3JpcHQuY29udGVudC5ib2R5LmZpbHRlcihub2RlID0+IHtcbiAgICAgICAgICAgIGlmICghbm9kZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy5ob2lzdGFibGVfbm9kZXMuaGFzKG5vZGUpKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlYWN0aXZlX2RlY2xhcmF0aW9uX25vZGVzLmhhcyhub2RlKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnSW1wb3J0RGVjbGFyYXRpb24nKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdFeHBvcnREZWNsYXJhdGlvbicgJiYgbm9kZS5zcGVjaWZpZXJzLmxlbmd0aCA+IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB3YWxrX21vZHVsZV9qcygpIHtcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcztcbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5hc3QubW9kdWxlO1xuICAgICAgICBpZiAoIXNjcmlwdClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgd2FsayhzY3JpcHQuY29udGVudCwge1xuICAgICAgICAgICAgZW50ZXIobm9kZSkge1xuICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdMYWJlbGVkU3RhdGVtZW50JyAmJiBub2RlLmxhYmVsLm5hbWUgPT09ICckJykge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQud2Fybihub2RlLCBjb21waWxlcl93YXJuaW5ncy5tb2R1bGVfc2NyaXB0X3JlYWN0aXZlX2RlY2xhcmF0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB7IHNjb3BlLCBnbG9iYWxzIH0gPSBjcmVhdGVfc2NvcGVzKHNjcmlwdC5jb250ZW50KTtcbiAgICAgICAgdGhpcy5tb2R1bGVfc2NvcGUgPSBzY29wZTtcbiAgICAgICAgc2NvcGUuZGVjbGFyYXRpb25zLmZvckVhY2goKG5vZGUsIG5hbWUpID0+IHtcbiAgICAgICAgICAgIGlmIChuYW1lWzBdID09PSAnJCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lcnJvcihub2RlLCBjb21waWxlcl9lcnJvcnMuaWxsZWdhbF9kZWNsYXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB3cml0YWJsZSA9IG5vZGUudHlwZSA9PT0gJ1ZhcmlhYmxlRGVjbGFyYXRpb24nICYmIChub2RlLmtpbmQgPT09ICd2YXInIHx8IG5vZGUua2luZCA9PT0gJ2xldCcpO1xuICAgICAgICAgICAgY29uc3QgaW1wb3J0ZWQgPSBub2RlLnR5cGUuc3RhcnRzV2l0aCgnSW1wb3J0Jyk7XG4gICAgICAgICAgICB0aGlzLmFkZF92YXIobm9kZSwge1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgbW9kdWxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGhvaXN0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB3cml0YWJsZSxcbiAgICAgICAgICAgICAgICBpbXBvcnRlZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBnbG9iYWxzLmZvckVhY2goKG5vZGUsIG5hbWUpID0+IHtcbiAgICAgICAgICAgIGlmIChuYW1lWzBdID09PSAnJCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lcnJvcihub2RlLCBjb21waWxlcl9lcnJvcnMuaWxsZWdhbF9zdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRfdmFyKG5vZGUsIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBob2lzdGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHsgYm9keSB9ID0gc2NyaXB0LmNvbnRlbnQ7XG4gICAgICAgIGxldCBpID0gYm9keS5sZW5ndGg7XG4gICAgICAgIHdoaWxlICgtLWkgPj0gMCkge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGJvZHlbaV07XG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnSW1wb3J0RGVjbGFyYXRpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5leHRyYWN0X2ltcG9ydHMobm9kZSk7XG4gICAgICAgICAgICAgICAgYm9keS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVnZXhfc3RhcnRzX3dpdGhfdGVybV9leHBvcnQudGVzdChub2RlLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSB0aGlzLmV4dHJhY3RfZXhwb3J0cyhub2RlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVwbGFjZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYm9keVtpXSA9IHJlcGxhY2VtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYm9keS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHdhbGtfaW5zdGFuY2VfanNfcHJlX3RlbXBsYXRlKCkge1xuICAgICAgICBjb25zdCBzY3JpcHQgPSB0aGlzLmFzdC5pbnN0YW5jZTtcbiAgICAgICAgaWYgKCFzY3JpcHQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIC8vIGluamVjdCB2YXJzIGZvciByZWFjdGl2ZSBkZWNsYXJhdGlvbnNcbiAgICAgICAgc2NyaXB0LmNvbnRlbnQuYm9keS5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgaWYgKG5vZGUudHlwZSAhPT0gJ0xhYmVsZWRTdGF0ZW1lbnQnKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGlmIChub2RlLmJvZHkudHlwZSAhPT0gJ0V4cHJlc3Npb25TdGF0ZW1lbnQnKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IHsgZXhwcmVzc2lvbiB9ID0gbm9kZS5ib2R5O1xuICAgICAgICAgICAgaWYgKGV4cHJlc3Npb24udHlwZSAhPT0gJ0Fzc2lnbm1lbnRFeHByZXNzaW9uJylcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBpZiAoZXhwcmVzc2lvbi5sZWZ0LnR5cGUgPT09ICdNZW1iZXJFeHByZXNzaW9uJylcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBleHRyYWN0X25hbWVzKGV4cHJlc3Npb24ubGVmdCkuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudmFyX2xvb2t1cC5oYXMobmFtZSkgJiYgbmFtZVswXSAhPT0gJyQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5qZWN0ZWRfcmVhY3RpdmVfZGVjbGFyYXRpb25fdmFycy5hZGQobmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB7IHNjb3BlOiBpbnN0YW5jZV9zY29wZSwgbWFwLCBnbG9iYWxzIH0gPSBjcmVhdGVfc2NvcGVzKHNjcmlwdC5jb250ZW50KTtcbiAgICAgICAgdGhpcy5pbnN0YW5jZV9zY29wZSA9IGluc3RhbmNlX3Njb3BlO1xuICAgICAgICB0aGlzLmluc3RhbmNlX3Njb3BlX21hcCA9IG1hcDtcbiAgICAgICAgaW5zdGFuY2Vfc2NvcGUuZGVjbGFyYXRpb25zLmZvckVhY2goKG5vZGUsIG5hbWUpID0+IHtcbiAgICAgICAgICAgIGlmIChuYW1lWzBdID09PSAnJCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lcnJvcihub2RlLCBjb21waWxlcl9lcnJvcnMuaWxsZWdhbF9kZWNsYXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB3cml0YWJsZSA9IG5vZGUudHlwZSA9PT0gJ1ZhcmlhYmxlRGVjbGFyYXRpb24nICYmIChub2RlLmtpbmQgPT09ICd2YXInIHx8IG5vZGUua2luZCA9PT0gJ2xldCcpO1xuICAgICAgICAgICAgY29uc3QgaW1wb3J0ZWQgPSBub2RlLnR5cGUuc3RhcnRzV2l0aCgnSW1wb3J0Jyk7XG4gICAgICAgICAgICB0aGlzLmFkZF92YXIobm9kZSwge1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgaW5pdGlhbGlzZWQ6IGluc3RhbmNlX3Njb3BlLmluaXRpYWxpc2VkX2RlY2xhcmF0aW9ucy5oYXMobmFtZSksXG4gICAgICAgICAgICAgICAgd3JpdGFibGUsXG4gICAgICAgICAgICAgICAgaW1wb3J0ZWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5ub2RlX2Zvcl9kZWNsYXJhdGlvbi5zZXQobmFtZSwgbm9kZSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBOT1RFOiBhZGQgc3RvcmUgdmFyaWFibGUgZmlyc3QsIHRoZW4gb25seSAkc3RvcmUgdmFsdWVcbiAgICAgICAgLy8gYXMgYCRzdG9yZWAgd2lsbCBtYXJrIGBzdG9yZWAgdmFyaWFibGUgYXMgcmVmZXJlbmNlZCBhbmQgc3Vic2NyaWJhYmxlXG4gICAgICAgIGNvbnN0IGdsb2JhbF9rZXlzID0gQXJyYXkuZnJvbShnbG9iYWxzLmtleXMoKSk7XG4gICAgICAgIGNvbnN0IHNvcnRlZF9nbG9iYWxzID0gW1xuICAgICAgICAgICAgLi4uZ2xvYmFsX2tleXMuZmlsdGVyKGtleSA9PiBrZXlbMF0gIT09ICckJyksXG4gICAgICAgICAgICAuLi5nbG9iYWxfa2V5cy5maWx0ZXIoa2V5ID0+IGtleVswXSA9PT0gJyQnKVxuICAgICAgICBdO1xuICAgICAgICBzb3J0ZWRfZ2xvYmFscy5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMudmFyX2xvb2t1cC5oYXMobmFtZSkpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGdsb2JhbHMuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaW5qZWN0ZWRfcmVhY3RpdmVfZGVjbGFyYXRpb25fdmFycy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZF92YXIobm9kZSwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgICAgICBpbmplY3RlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHJlYXNzaWduZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxpc2VkOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc19yZXNlcnZlZF9rZXl3b3JkKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRfdmFyKG5vZGUsIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgaW5qZWN0ZWQ6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5hbWVbMF0gPT09ICckJykge1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnJCcgfHwgbmFtZVsxXSA9PT0gJyQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVycm9yKG5vZGUsIGNvbXBpbGVyX2Vycm9ycy5pbGxlZ2FsX2dsb2JhbChuYW1lKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuYWRkX3Zhcihub2RlLCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGluamVjdGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBtdXRhdGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkX3JlZmVyZW5jZShub2RlLCBuYW1lLnNsaWNlKDEpKTtcbiAgICAgICAgICAgICAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMudmFyX2xvb2t1cC5nZXQobmFtZS5zbGljZSgxKSk7XG4gICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlLnN1YnNjcmliYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlLnJlZmVyZW5jZWRfZnJvbV9zY3JpcHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkX3Zhcihub2RlLCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaG9pc3RhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnRyYWNrX3JlZmVyZW5jZXNfYW5kX211dGF0aW9ucygpO1xuICAgIH1cbiAgICB3YWxrX2luc3RhbmNlX2pzX3Bvc3RfdGVtcGxhdGUoKSB7XG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuYXN0Lmluc3RhbmNlO1xuICAgICAgICBpZiAoIXNjcmlwdClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5wb3N0X3RlbXBsYXRlX3dhbGsoKTtcbiAgICAgICAgdGhpcy5ob2lzdF9pbnN0YW5jZV9kZWNsYXJhdGlvbnMoKTtcbiAgICAgICAgdGhpcy5leHRyYWN0X3JlYWN0aXZlX2RlY2xhcmF0aW9ucygpO1xuICAgIH1cbiAgICBwb3N0X3RlbXBsYXRlX3dhbGsoKSB7XG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuYXN0Lmluc3RhbmNlO1xuICAgICAgICBpZiAoIXNjcmlwdClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcztcbiAgICAgICAgY29uc3QgeyBjb250ZW50IH0gPSBzY3JpcHQ7XG4gICAgICAgIGNvbnN0IHsgaW5zdGFuY2Vfc2NvcGUsIGluc3RhbmNlX3Njb3BlX21hcDogbWFwIH0gPSB0aGlzO1xuICAgICAgICBsZXQgc2NvcGUgPSBpbnN0YW5jZV9zY29wZTtcbiAgICAgICAgY29uc3QgdG9fcmVtb3ZlID0gW107XG4gICAgICAgIGNvbnN0IHJlbW92ZSA9IChwYXJlbnQsIHByb3AsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICB0b19yZW1vdmUudW5zaGlmdChbcGFyZW50LCBwcm9wLCBpbmRleF0pO1xuICAgICAgICB9O1xuICAgICAgICBsZXQgc2NvcGVfdXBkYXRlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBjdXJyZW50X2Z1bmN0aW9uX3N0YWNrID0gW107XG4gICAgICAgIGxldCBjdXJyZW50X2Z1bmN0aW9uID0gbnVsbDtcbiAgICAgICAgd2Fsayhjb250ZW50LCB7XG4gICAgICAgICAgICBlbnRlcihub2RlLCBwYXJlbnQsIHByb3AsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKChub2RlLnR5cGUgPT09ICdGdW5jdGlvbkRlY2xhcmF0aW9uJyB8fCBub2RlLnR5cGUgPT09ICdGdW5jdGlvbkV4cHJlc3Npb24nKSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2Z1bmN0aW9uX3N0YWNrLnB1c2goY3VycmVudF9mdW5jdGlvbiA9IG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobWFwLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZSA9IG1hcC5nZXQobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBkZWVwID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbGV0IG5hbWVzO1xuICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdBc3NpZ25tZW50RXhwcmVzc2lvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVlcCA9IG5vZGUubGVmdC50eXBlID09PSAnTWVtYmVyRXhwcmVzc2lvbic7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzID0gZGVlcFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBbZ2V0X29iamVjdChub2RlLmxlZnQpLm5hbWVdXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGV4dHJhY3RfbmFtZXMobm9kZS5sZWZ0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobm9kZS50eXBlID09PSAnVXBkYXRlRXhwcmVzc2lvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVlcCA9IG5vZGUuYXJndW1lbnQudHlwZSA9PT0gJ01lbWJlckV4cHJlc3Npb24nO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IGdldF9vYmplY3Qobm9kZS5hcmd1bWVudCk7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzID0gW25hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobmFtZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXMuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50X3Njb3BlID0gc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGVjbGFyYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoY3VycmVudF9zY29wZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50X3Njb3BlLmRlY2xhcmF0aW9ucy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb24gPSBjdXJyZW50X3Njb3BlLmRlY2xhcmF0aW9ucy5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3Njb3BlID0gY3VycmVudF9zY29wZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVjbGFyYXRpb24gJiYgZGVjbGFyYXRpb24ua2luZCA9PT0gJ2NvbnN0JyAmJiAhZGVlcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5lcnJvcihub2RlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6ICdhc3NpZ25tZW50LXRvLWNvbnN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1lvdSBhcmUgYXNzaWduaW5nIHRvIGEgY29uc3QnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnSW1wb3J0RGVjbGFyYXRpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5leHRyYWN0X2ltcG9ydHMobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IHRvIHVzZSBhY3R1YWwgcmVtb3ZlXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZShwYXJlbnQsIHByb3AsIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2tpcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmVnZXhfc3RhcnRzX3dpdGhfdGVybV9leHBvcnQudGVzdChub2RlLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gY29tcG9uZW50LmV4dHJhY3RfZXhwb3J0cyhub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcGxhY2UocmVwbGFjZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogdG8gdXNlIGFjdHVhbCByZW1vdmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZShwYXJlbnQsIHByb3AsIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5za2lwKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbXBvbmVudC53YXJuX29uX3VuZGVmaW5lZF9zdG9yZV92YWx1ZV9yZWZlcmVuY2VzKG5vZGUsIHBhcmVudCwgcHJvcCwgc2NvcGUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxlYXZlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoKG5vZGUudHlwZSA9PT0gJ0Z1bmN0aW9uRGVjbGFyYXRpb24nIHx8IG5vZGUudHlwZSA9PT0gJ0Z1bmN0aW9uRXhwcmVzc2lvbicpKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZnVuY3Rpb25fc3RhY2sucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZnVuY3Rpb24gPSBjdXJyZW50X2Z1bmN0aW9uX3N0YWNrW2N1cnJlbnRfZnVuY3Rpb25fc3RhY2subGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGRvIGl0IG9uIGxlYXZlLCB0byBwcmV2ZW50IGluZmluaXRlIGxvb3BcbiAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5kZXYgJiYgY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5sb29wR3VhcmRUaW1lb3V0ID4gMCAmJiAoIWN1cnJlbnRfZnVuY3Rpb24gfHwgKCFjdXJyZW50X2Z1bmN0aW9uLmdlbmVyYXRvciAmJiAhY3VycmVudF9mdW5jdGlvbi5hc3luYykpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvX3JlcGxhY2VfZm9yX2xvb3BfcHJvdGVjdCA9IGNvbXBvbmVudC5sb29wX3Byb3RlY3Qobm9kZSwgc2NvcGUsIGNvbXBvbmVudC5jb21waWxlX29wdGlvbnMubG9vcEd1YXJkVGltZW91dCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b19yZXBsYWNlX2Zvcl9sb29wX3Byb3RlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbGFjZSh0b19yZXBsYWNlX2Zvcl9sb29wX3Byb3RlY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGVfdXBkYXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1hcC5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUgPSBzY29wZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgZm9yIChjb25zdCBbcGFyZW50LCBwcm9wLCBpbmRleF0gb2YgdG9fcmVtb3ZlKSB7XG4gICAgICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudFtwcm9wXS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHBhcmVudFtwcm9wXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNjb3BlX3VwZGF0ZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgc2NvcGUsIG1hcCB9ID0gY3JlYXRlX3Njb3BlcyhzY3JpcHQuY29udGVudCk7XG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlX3Njb3BlID0gc2NvcGU7XG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlX3Njb3BlX21hcCA9IG1hcDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0cmFja19yZWZlcmVuY2VzX2FuZF9tdXRhdGlvbnMoKSB7XG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuYXN0Lmluc3RhbmNlO1xuICAgICAgICBpZiAoIXNjcmlwdClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcztcbiAgICAgICAgY29uc3QgeyBjb250ZW50IH0gPSBzY3JpcHQ7XG4gICAgICAgIGNvbnN0IHsgaW5zdGFuY2Vfc2NvcGUsIG1vZHVsZV9zY29wZSwgaW5zdGFuY2Vfc2NvcGVfbWFwOiBtYXAgfSA9IHRoaXM7XG4gICAgICAgIGxldCBzY29wZSA9IGluc3RhbmNlX3Njb3BlO1xuICAgICAgICB3YWxrKGNvbnRlbnQsIHtcbiAgICAgICAgICAgIGVudGVyKG5vZGUsIHBhcmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChtYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlID0gbWFwLmdldChub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ0Fzc2lnbm1lbnRFeHByZXNzaW9uJyB8fCBub2RlLnR5cGUgPT09ICdVcGRhdGVFeHByZXNzaW9uJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhc3NpZ25lZSA9IG5vZGUudHlwZSA9PT0gJ0Fzc2lnbm1lbnRFeHByZXNzaW9uJyA/IG5vZGUubGVmdCA6IG5vZGUuYXJndW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVzID0gZXh0cmFjdF9uYW1lcyhhc3NpZ25lZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlZXAgPSBhc3NpZ25lZS50eXBlID09PSAnTWVtYmVyRXhwcmVzc2lvbic7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzY29wZV9vd25lciA9IHNjb3BlLmZpbmRfb3duZXIobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGVfb3duZXIgIT09IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHNjb3BlX293bmVyID09PSBpbnN0YW5jZV9zY29wZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbW9kdWxlX3Njb3BlICYmIG1vZHVsZV9zY29wZS5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YXJpYWJsZSA9IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZVtkZWVwID8gJ211dGF0ZWQnIDogJ3JlYXNzaWduZWQnXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXNfdXNlZF9hc19yZWZlcmVuY2Uobm9kZSwgcGFyZW50KSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvYmplY3QgPSBnZXRfb2JqZWN0KG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuZmluZF9vd25lcihvYmplY3QubmFtZSkgPT09IGluc3RhbmNlX3Njb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YXJpYWJsZSA9IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChvYmplY3QubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZS5yZWZlcmVuY2VkX2Zyb21fc2NyaXB0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsZWF2ZShub2RlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hcC5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUgPSBzY29wZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgd2Fybl9vbl91bmRlZmluZWRfc3RvcmVfdmFsdWVfcmVmZXJlbmNlcyhub2RlLCBwYXJlbnQsIHByb3AsIHNjb3BlKSB7XG4gICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdMYWJlbGVkU3RhdGVtZW50JyAmJlxuICAgICAgICAgICAgbm9kZS5sYWJlbC5uYW1lID09PSAnJCcgJiZcbiAgICAgICAgICAgIHBhcmVudC50eXBlICE9PSAnUHJvZ3JhbScpIHtcbiAgICAgICAgICAgIHRoaXMud2Fybihub2RlLCBjb21waWxlcl93YXJuaW5ncy5ub25fdG9wX2xldmVsX3JlYWN0aXZlX2RlY2xhcmF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNfcmVmZXJlbmNlKG5vZGUsIHBhcmVudCkpIHtcbiAgICAgICAgICAgIGNvbnN0IG9iamVjdCA9IGdldF9vYmplY3Qobm9kZSk7XG4gICAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IG9iamVjdDtcbiAgICAgICAgICAgIGlmIChuYW1lWzBdID09PSAnJCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXNjb3BlLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndhcm5faWZfdW5kZWZpbmVkKG5hbWUsIG9iamVjdCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChuYW1lWzFdICE9PSAnJCcgJiYgc2NvcGUuaGFzKG5hbWUuc2xpY2UoMSkpICYmIHNjb3BlLmZpbmRfb3duZXIobmFtZS5zbGljZSgxKSkgIT09IHRoaXMuaW5zdGFuY2Vfc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoKHJlZ2V4X2NvbnRhaW5zX3Rlcm1fZnVuY3Rpb24udGVzdChwYXJlbnQudHlwZSkgJiYgcHJvcCA9PT0gJ3BhcmFtcycpIHx8IChwYXJlbnQudHlwZSA9PT0gJ1ZhcmlhYmxlRGVjbGFyYXRvcicgJiYgcHJvcCA9PT0gJ2lkJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lcnJvcihub2RlLCBjb21waWxlcl9lcnJvcnMuY29udGV4dHVhbF9zdG9yZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbG9vcF9wcm90ZWN0KG5vZGUsIHNjb3BlLCB0aW1lb3V0KSB7XG4gICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdXaGlsZVN0YXRlbWVudCcgfHxcbiAgICAgICAgICAgIG5vZGUudHlwZSA9PT0gJ0ZvclN0YXRlbWVudCcgfHxcbiAgICAgICAgICAgIG5vZGUudHlwZSA9PT0gJ0RvV2hpbGVTdGF0ZW1lbnQnKSB7XG4gICAgICAgICAgICBjb25zdCBndWFyZCA9IHRoaXMuZ2V0X3VuaXF1ZV9uYW1lKCdndWFyZCcsIHNjb3BlKTtcbiAgICAgICAgICAgIHRoaXMudXNlZF9uYW1lcy5hZGQoZ3VhcmQubmFtZSk7XG4gICAgICAgICAgICBjb25zdCBiZWZvcmUgPSBiIGBjb25zdCAke2d1YXJkfSA9IEBsb29wX2d1YXJkKCR7dGltZW91dH0pYDtcbiAgICAgICAgICAgIGNvbnN0IGluc2lkZSA9IGIgYCR7Z3VhcmR9KCk7YDtcbiAgICAgICAgICAgIC8vIHdyYXAgZXhwcmVzc2lvbiBzdGF0ZW1lbnQgd2l0aCBCbG9ja1N0YXRlbWVudFxuICAgICAgICAgICAgaWYgKG5vZGUuYm9keS50eXBlICE9PSAnQmxvY2tTdGF0ZW1lbnQnKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5ib2R5ID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQmxvY2tTdGF0ZW1lbnQnLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBbbm9kZS5ib2R5XVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlLmJvZHkuYm9keS5wdXNoKGluc2lkZVswXSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdCbG9ja1N0YXRlbWVudCcsXG4gICAgICAgICAgICAgICAgYm9keTogW1xuICAgICAgICAgICAgICAgICAgICBiZWZvcmVbMF0sXG4gICAgICAgICAgICAgICAgICAgIG5vZGVcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXdyaXRlX3Byb3BzKGdldF9pbnNlcnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmFzdC5pbnN0YW5jZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcztcbiAgICAgICAgY29uc3QgeyBpbnN0YW5jZV9zY29wZSwgaW5zdGFuY2Vfc2NvcGVfbWFwOiBtYXAgfSA9IHRoaXM7XG4gICAgICAgIGxldCBzY29wZSA9IGluc3RhbmNlX3Njb3BlO1xuICAgICAgICB3YWxrKHRoaXMuYXN0Lmluc3RhbmNlLmNvbnRlbnQsIHtcbiAgICAgICAgICAgIGVudGVyKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVnZXhfY29udGFpbnNfdGVybV9mdW5jdGlvbi50ZXN0KG5vZGUudHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2tpcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobWFwLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZSA9IG1hcC5nZXQobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdFeHBvcnROYW1lZERlY2xhcmF0aW9uJyAmJiBub2RlLmRlY2xhcmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2Uobm9kZS5kZWNsYXJhdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdWYXJpYWJsZURlY2xhcmF0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBgdmFyYCBkb2VzIG5vdCBmb2xsb3cgYmxvY2sgc2NvcGluZ1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5raW5kID09PSAndmFyJyB8fCBzY29wZSA9PT0gaW5zdGFuY2Vfc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGluc2VydHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb3BzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhZGRfbmV3X3Byb3BzKGV4cG9ydGVkLCBsb2NhbCwgZGVmYXVsdF92YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnUHJvcGVydHknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG9ydGhhbmQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdpbml0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBleHBvcnRlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGRlZmF1bHRfdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdBc3NpZ25tZW50UGF0dGVybicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogbG9jYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IGRlZmF1bHRfdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbG9jYWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyYW5zZm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYGBgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBleHBvcnQgbGV0IHsgeCwgeSA9IDEyMyB9ID0gT0JKLCB6ID0gNDU2XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBgYGBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludG9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGBgYFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGV0IHsgeDogeCQsIHk6IHkkID0gMTIzIH0gPSBPQko7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBsZXQgeyB4ID0geCQsIHkgPSB5JCwgeiA9IDQ1NiB9ID0gJCRwcm9wcztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGBgYFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IG5vZGUuZGVjbGFyYXRpb25zLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlY2xhcmF0b3IgPSBub2RlLmRlY2xhcmF0aW9uc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlY2xhcmF0b3IuaWQudHlwZSAhPT0gJ0lkZW50aWZpZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldF9uZXdfbmFtZShsb2NhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSBjb21wb25lbnQudmFyX2xvb2t1cC5nZXQobG9jYWwubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGUuc3Vic2NyaWJhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0cy5wdXNoKGdldF9pbnNlcnQodmFyaWFibGUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZS5leHBvcnRfbmFtZSAmJiB2YXJpYWJsZS53cml0YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFsaWFzX25hbWUgPSBjb21wb25lbnQuZ2V0X3VuaXF1ZV9uYW1lKGxvY2FsLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9uZXdfcHJvcHMoeyB0eXBlOiAnSWRlbnRpZmllcicsIG5hbWU6IHZhcmlhYmxlLmV4cG9ydF9uYW1lIH0sIGxvY2FsLCBhbGlhc19uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWxpYXNfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiByZW5hbWVfaWRlbnRpZmllcnMocGFyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocGFyYW0udHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ09iamVjdFBhdHRlcm4nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhbmRsZV9wcm9wID0gKHByb3ApID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9wLnR5cGUgPT09ICdSZXN0RWxlbWVudCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5hbWVfaWRlbnRpZmllcnMocHJvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChwcm9wLnZhbHVlLnR5cGUgPT09ICdJZGVudGlmaWVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3AudmFsdWUgPSBnZXRfbmV3X25hbWUocHJvcC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5hbWVfaWRlbnRpZmllcnMocHJvcC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtLnByb3BlcnRpZXMuZm9yRWFjaChoYW5kbGVfcHJvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdBcnJheVBhdHRlcm4nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhbmRsZV9lbGVtZW50ID0gKGVsZW1lbnQsIGluZGV4LCBhcnJheSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09PSAnSWRlbnRpZmllcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXlbaW5kZXhdID0gZ2V0X25ld19uYW1lKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuYW1lX2lkZW50aWZpZXJzKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW0uZWxlbWVudHMuZm9yRWFjaChoYW5kbGVfZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdSZXN0RWxlbWVudCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtLmFyZ3VtZW50ID0gZ2V0X25ld19uYW1lKHBhcmFtLmFyZ3VtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnQXNzaWdubWVudFBhdHRlcm4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW0ubGVmdC50eXBlID09PSAnSWRlbnRpZmllcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtLmxlZnQgPSBnZXRfbmV3X25hbWUocGFyYW0ubGVmdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5hbWVfaWRlbnRpZmllcnMocGFyYW0ubGVmdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuYW1lX2lkZW50aWZpZXJzKGRlY2xhcmF0b3IuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSBkZWNsYXJhdG9yLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YXJpYWJsZSA9IGNvbXBvbmVudC52YXJfbG9va3VwLmdldChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNfcHJvcHMgPSB2YXJpYWJsZS5leHBvcnRfbmFtZSAmJiB2YXJpYWJsZS53cml0YWJsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzX3Byb3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRfbmV3X3Byb3BzKHsgdHlwZTogJ0lkZW50aWZpZXInLCBuYW1lOiB2YXJpYWJsZS5leHBvcnRfbmFtZSB9LCBkZWNsYXJhdG9yLmlkLCBkZWNsYXJhdG9yLmluaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5kZWNsYXJhdGlvbnMuc3BsaWNlKGluZGV4LS0sIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZS5zdWJzY3JpYmFibGUgJiYgKGlzX3Byb3BzIHx8IGRlY2xhcmF0b3IuaW5pdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydHMucHVzaChnZXRfaW5zZXJ0KHZhcmlhYmxlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcGxhY2UoYiBgXG5cdFx0XHRcdFx0XHRcdCR7bm9kZS5kZWNsYXJhdGlvbnMubGVuZ3RoID8gbm9kZSA6IG51bGx9XG5cdFx0XHRcdFx0XHRcdCR7cHJvcHMubGVuZ3RoID4gMCAmJiBiIGBsZXQgeyAke3Byb3BzfSB9ID0gJCRwcm9wcztgfVxuXHRcdFx0XHRcdFx0XHQke2luc2VydHN9XG5cdFx0XHRcdFx0XHRgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNraXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsZWF2ZShub2RlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hcC5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUgPSBzY29wZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaG9pc3RfaW5zdGFuY2VfZGVjbGFyYXRpb25zKCkge1xuICAgICAgICAvLyB3ZSBjYW4gc2FmZWx5IGhvaXN0IHZhcmlhYmxlIGRlY2xhcmF0aW9ucyB0aGF0IGFyZVxuICAgICAgICAvLyBpbml0aWFsaXNlZCB0byBsaXRlcmFscywgYW5kIGZ1bmN0aW9ucyB0aGF0IGRvbid0XG4gICAgICAgIC8vIHJlZmVyZW5jZSBpbnN0YW5jZSB2YXJpYWJsZXMgb3RoZXIgdGhhbiBvdGhlclxuICAgICAgICAvLyBob2lzdGFibGUgZnVuY3Rpb25zLiBUT0RPIG90aGVycz9cbiAgICAgICAgY29uc3QgeyBob2lzdGFibGVfbm9kZXMsIHZhcl9sb29rdXAsIGluamVjdGVkX3JlYWN0aXZlX2RlY2xhcmF0aW9uX3ZhcnMsIGltcG9ydHMgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHRvcF9sZXZlbF9mdW5jdGlvbl9kZWNsYXJhdGlvbnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIGNvbnN0IHsgYm9keSB9ID0gdGhpcy5hc3QuaW5zdGFuY2UuY29udGVudDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2R5Lmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gYm9keVtpXTtcbiAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdWYXJpYWJsZURlY2xhcmF0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsbF9ob2lzdGFibGUgPSBub2RlLmRlY2xhcmF0aW9ucy5ldmVyeShkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkLmluaXQpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmluaXQudHlwZSAhPT0gJ0xpdGVyYWwnKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAvLyBldmVyeXRoaW5nIGV4Y2VwdCBjb25zdCB2YWx1ZXMgY2FuIGJlIGNoYW5nZWQgYnkgZS5nLiBzdmVsdGUgZGV2dG9vbHNcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hpY2ggbWVhbnMgd2UgY2FuJ3QgaG9pc3QgaXRcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUua2luZCAhPT0gJ2NvbnN0JyAmJiB0aGlzLmNvbXBpbGVfb3B0aW9ucy5kZXYpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgbmFtZSB9ID0gZC5pZDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdiA9IHRoaXMudmFyX2xvb2t1cC5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2LnJlYXNzaWduZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2LmV4cG9ydF9uYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52YXJfbG9va3VwLmdldChuYW1lKS5yZWFzc2lnbmVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52YXJzLmZpbmQodmFyaWFibGUgPT4gdmFyaWFibGUubmFtZSA9PT0gbmFtZSAmJiB2YXJpYWJsZS5tb2R1bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGFsbF9ob2lzdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5kZWNsYXJhdGlvbnMuZm9yRWFjaChkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhcmlhYmxlID0gdGhpcy52YXJfbG9va3VwLmdldChkLmlkLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGUuaG9pc3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGhvaXN0YWJsZV9ub2Rlcy5hZGQobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIGJvZHkuc3BsaWNlKGktLSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZnVsbHlfaG9pc3RlZC5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdFeHBvcnROYW1lZERlY2xhcmF0aW9uJyAmJlxuICAgICAgICAgICAgICAgIG5vZGUuZGVjbGFyYXRpb24gJiZcbiAgICAgICAgICAgICAgICBub2RlLmRlY2xhcmF0aW9uLnR5cGUgPT09ICdGdW5jdGlvbkRlY2xhcmF0aW9uJykge1xuICAgICAgICAgICAgICAgIHRvcF9sZXZlbF9mdW5jdGlvbl9kZWNsYXJhdGlvbnMuc2V0KG5vZGUuZGVjbGFyYXRpb24uaWQubmFtZSwgbm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnRnVuY3Rpb25EZWNsYXJhdGlvbicpIHtcbiAgICAgICAgICAgICAgICB0b3BfbGV2ZWxfZnVuY3Rpb25fZGVjbGFyYXRpb25zLnNldChub2RlLmlkLm5hbWUsIG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNoZWNrZWQgPSBuZXcgU2V0KCk7XG4gICAgICAgIGNvbnN0IHdhbGtpbmcgPSBuZXcgU2V0KCk7XG4gICAgICAgIGNvbnN0IGlzX2hvaXN0YWJsZSA9IGZuX2RlY2xhcmF0aW9uID0+IHtcbiAgICAgICAgICAgIGlmIChmbl9kZWNsYXJhdGlvbi50eXBlID09PSAnRXhwb3J0TmFtZWREZWNsYXJhdGlvbicpIHtcbiAgICAgICAgICAgICAgICBmbl9kZWNsYXJhdGlvbiA9IGZuX2RlY2xhcmF0aW9uLmRlY2xhcmF0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaW5zdGFuY2Vfc2NvcGUgPSB0aGlzLmluc3RhbmNlX3Njb3BlO1xuICAgICAgICAgICAgbGV0IHNjb3BlID0gdGhpcy5pbnN0YW5jZV9zY29wZTtcbiAgICAgICAgICAgIGNvbnN0IG1hcCA9IHRoaXMuaW5zdGFuY2Vfc2NvcGVfbWFwO1xuICAgICAgICAgICAgbGV0IGhvaXN0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAvLyBoYW5kbGUgY3ljbGVzXG4gICAgICAgICAgICB3YWxraW5nLmFkZChmbl9kZWNsYXJhdGlvbik7XG4gICAgICAgICAgICB3YWxrKGZuX2RlY2xhcmF0aW9uLCB7XG4gICAgICAgICAgICAgICAgZW50ZXIobm9kZSwgcGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaG9pc3RhYmxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2tpcCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWFwLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUgPSBtYXAuZ2V0KG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc19yZWZlcmVuY2Uobm9kZSwgcGFyZW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSBmbGF0dGVuX3JlZmVyZW5jZShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG93bmVyID0gc2NvcGUuZmluZF9vd25lcihuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmplY3RlZF9yZWFjdGl2ZV9kZWNsYXJhdGlvbl92YXJzLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvaXN0YWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobmFtZVswXSA9PT0gJyQnICYmICFvd25lcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvaXN0YWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAob3duZXIgPT09IGluc3RhbmNlX3Njb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSB2YXJfbG9va3VwLmdldChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGUucmVhc3NpZ25lZCB8fCB2YXJpYWJsZS5tdXRhdGVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2lzdGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gZm5fZGVjbGFyYXRpb24uaWQubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZS5ob2lzdGFibGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9wX2xldmVsX2Z1bmN0aW9uX2RlY2xhcmF0aW9ucy5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3RoZXJfZGVjbGFyYXRpb24gPSB0b3BfbGV2ZWxfZnVuY3Rpb25fZGVjbGFyYXRpb25zLmdldChuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdhbGtpbmcuaGFzKG90aGVyX2RlY2xhcmF0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9pc3RhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAob3RoZXJfZGVjbGFyYXRpb24udHlwZSA9PT0gJ0V4cG9ydE5hbWVkRGVjbGFyYXRpb24nICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWxraW5nLmhhcyhvdGhlcl9kZWNsYXJhdGlvbi5kZWNsYXJhdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvaXN0YWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFpc19ob2lzdGFibGUob3RoZXJfZGVjbGFyYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2lzdGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9pc3RhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lwKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGxlYXZlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcC5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlID0gc2NvcGUucGFyZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjaGVja2VkLmFkZChmbl9kZWNsYXJhdGlvbik7XG4gICAgICAgICAgICB3YWxraW5nLmRlbGV0ZShmbl9kZWNsYXJhdGlvbik7XG4gICAgICAgICAgICByZXR1cm4gaG9pc3RhYmxlO1xuICAgICAgICB9O1xuICAgICAgICBmb3IgKGNvbnN0IFtuYW1lLCBub2RlXSBvZiB0b3BfbGV2ZWxfZnVuY3Rpb25fZGVjbGFyYXRpb25zKSB7XG4gICAgICAgICAgICBpZiAoaXNfaG9pc3RhYmxlKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLnZhcl9sb29rdXAuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgIHZhcmlhYmxlLmhvaXN0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaG9pc3RhYmxlX25vZGVzLmFkZChub2RlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gYm9keS5pbmRleE9mKG5vZGUpO1xuICAgICAgICAgICAgICAgIGJvZHkuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuZnVsbHlfaG9pc3RlZC5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgeyBzcGVjaWZpZXJzIH0gb2YgaW1wb3J0cykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBzcGVjaWZpZXIgb2Ygc3BlY2lmaWVycykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhcmlhYmxlID0gdmFyX2xvb2t1cC5nZXQoc3BlY2lmaWVyLmxvY2FsLm5hbWUpO1xuICAgICAgICAgICAgICAgIGlmICghdmFyaWFibGUubXV0YXRlZCB8fCB2YXJpYWJsZS5zdWJzY3JpYmFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFibGUuaG9pc3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZXh0cmFjdF9yZWFjdGl2ZV9kZWNsYXJhdGlvbnMoKSB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHVuc29ydGVkX3JlYWN0aXZlX2RlY2xhcmF0aW9ucyA9IFtdO1xuICAgICAgICB0aGlzLmFzdC5pbnN0YW5jZS5jb250ZW50LmJvZHkuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlnbm9yZXMgPSBleHRyYWN0X3N2ZWx0ZV9pZ25vcmVfZnJvbV9jb21tZW50cyhub2RlKTtcbiAgICAgICAgICAgIGlmIChpZ25vcmVzLmxlbmd0aClcbiAgICAgICAgICAgICAgICB0aGlzLnB1c2hfaWdub3JlcyhpZ25vcmVzKTtcbiAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdMYWJlbGVkU3RhdGVtZW50JyAmJiBub2RlLmxhYmVsLm5hbWUgPT09ICckJykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVhY3RpdmVfZGVjbGFyYXRpb25fbm9kZXMuYWRkKG5vZGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFzc2lnbmVlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhc3NpZ25lZV9ub2RlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbW9kdWxlX2RlcGVuZGVuY2llcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICBsZXQgc2NvcGUgPSB0aGlzLmluc3RhbmNlX3Njb3BlO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hcCA9IHRoaXMuaW5zdGFuY2Vfc2NvcGVfbWFwO1xuICAgICAgICAgICAgICAgIHdhbGsobm9kZS5ib2R5LCB7XG4gICAgICAgICAgICAgICAgICAgIGVudGVyKG5vZGUsIHBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcC5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZSA9IG1hcC5nZXQobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnQXNzaWdubWVudEV4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGVmdCA9IGdldF9vYmplY3Qobm9kZS5sZWZ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYWN0X2lkZW50aWZpZXJzKGxlZnQpLmZvckVhY2gobm9kZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlX25vZGVzLmFkZChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWVzLmFkZChub2RlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm9wZXJhdG9yICE9PSAnPScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwZW5kZW5jaWVzLmFkZChsZWZ0Lm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gJ1VwZGF0ZUV4cHJlc3Npb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaWRlbnRpZmllciA9IGdldF9vYmplY3Qobm9kZS5hcmd1bWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWVzLmFkZChpZGVudGlmaWVyLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNfcmVmZXJlbmNlKG5vZGUsIHBhcmVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpZGVudGlmaWVyID0gZ2V0X29iamVjdChub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFzc2lnbmVlX25vZGVzLmhhcyhpZGVudGlmaWVyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IGlkZW50aWZpZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG93bmVyID0gc2NvcGUuZmluZF9vd25lcihuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFyaWFibGUgPSBjb21wb25lbnQudmFyX2xvb2t1cC5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzaG91bGRfYWRkX2FzX2RlcGVuZGVuY3kgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlLmlzX3JlYWN0aXZlX2RlcGVuZGVuY3kgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlLm1vZHVsZSAmJiB2YXJpYWJsZS53cml0YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZF9hZGRfYXNfZGVwZW5kZW5jeSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZV9kZXBlbmRlbmNpZXMuYWRkKG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzX3dyaXRhYmxlX29yX211dGF0ZWQgPSB2YXJpYWJsZSAmJiAodmFyaWFibGUud3JpdGFibGUgfHwgdmFyaWFibGUubXV0YXRlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaG91bGRfYWRkX2FzX2RlcGVuZGVuY3kgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICghb3duZXIgfHwgb3duZXIgPT09IGNvbXBvbmVudC5pbnN0YW5jZV9zY29wZSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChuYW1lWzBdID09PSAnJCcgfHwgaXNfd3JpdGFibGVfb3JfbXV0YXRlZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcGVuZGVuY2llcy5hZGQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGxlYXZlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUgPSBzY29wZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAobW9kdWxlX2RlcGVuZGVuY2llcy5zaXplID4gMCAmJiBkZXBlbmRlbmNpZXMuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQud2Fybihub2RlLmJvZHksIGNvbXBpbGVyX3dhcm5pbmdzLm1vZHVsZV9zY3JpcHRfdmFyaWFibGVfcmVhY3RpdmVfZGVjbGFyYXRpb24oQXJyYXkuZnJvbShtb2R1bGVfZGVwZW5kZW5jaWVzKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB7IGV4cHJlc3Npb24gfSA9IG5vZGUuYm9keTtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWNsYXJhdGlvbiA9IGV4cHJlc3Npb24gJiYgZXhwcmVzc2lvbi5sZWZ0O1xuICAgICAgICAgICAgICAgIHVuc29ydGVkX3JlYWN0aXZlX2RlY2xhcmF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgYXNzaWduZWVzLFxuICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbmNpZXMsXG4gICAgICAgICAgICAgICAgICAgIG5vZGUsXG4gICAgICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9uXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaWdub3Jlcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgdGhpcy5wb3BfaWdub3JlcygpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbG9va3VwID0gbmV3IE1hcCgpO1xuICAgICAgICB1bnNvcnRlZF9yZWFjdGl2ZV9kZWNsYXJhdGlvbnMuZm9yRWFjaChkZWNsYXJhdGlvbiA9PiB7XG4gICAgICAgICAgICBkZWNsYXJhdGlvbi5hc3NpZ25lZXMuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWxvb2t1cC5oYXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9va3VwLnNldChuYW1lLCBbXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFRPRE8gd2FybiBvciBlcnJvciBpZiBhIG5hbWUgaXMgYXNzaWduZWQgdG8gaW5cbiAgICAgICAgICAgICAgICAvLyBtdWx0aXBsZSByZWFjdGl2ZSBkZWNsYXJhdGlvbnM/XG4gICAgICAgICAgICAgICAgbG9va3VwLmdldChuYW1lKS5wdXNoKGRlY2xhcmF0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY3ljbGUgPSBjaGVja19ncmFwaF9mb3JfY3ljbGVzKHVuc29ydGVkX3JlYWN0aXZlX2RlY2xhcmF0aW9ucy5yZWR1Y2UoKGFjYywgZGVjbGFyYXRpb24pID0+IHtcbiAgICAgICAgICAgIGRlY2xhcmF0aW9uLmFzc2lnbmVlcy5mb3JFYWNoKHYgPT4ge1xuICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9uLmRlcGVuZGVuY2llcy5mb3JFYWNoKHcgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWRlY2xhcmF0aW9uLmFzc2lnbmVlcy5oYXModykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjYy5wdXNoKFt2LCB3XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwgW10pKTtcbiAgICAgICAgaWYgKGN5Y2xlICYmIGN5Y2xlLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgZGVjbGFyYXRpb25MaXN0ID0gbG9va3VwLmdldChjeWNsZVswXSk7XG4gICAgICAgICAgICBjb25zdCBkZWNsYXJhdGlvbiA9IGRlY2xhcmF0aW9uTGlzdFswXTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVycm9yKGRlY2xhcmF0aW9uLm5vZGUsIGNvbXBpbGVyX2Vycm9ycy5jeWNsaWNhbF9yZWFjdGl2ZV9kZWNsYXJhdGlvbihjeWNsZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFkZF9kZWNsYXJhdGlvbiA9IGRlY2xhcmF0aW9uID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlYWN0aXZlX2RlY2xhcmF0aW9ucy5pbmNsdWRlcyhkZWNsYXJhdGlvbikpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgZGVjbGFyYXRpb24uZGVwZW5kZW5jaWVzLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGRlY2xhcmF0aW9uLmFzc2lnbmVlcy5oYXMobmFtZSkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBjb25zdCBlYXJsaWVyX2RlY2xhcmF0aW9ucyA9IGxvb2t1cC5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKGVhcmxpZXJfZGVjbGFyYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIGVhcmxpZXJfZGVjbGFyYXRpb25zLmZvckVhY2goYWRkX2RlY2xhcmF0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucmVhY3RpdmVfZGVjbGFyYXRpb25zLnB1c2goZGVjbGFyYXRpb24pO1xuICAgICAgICB9O1xuICAgICAgICB1bnNvcnRlZF9yZWFjdGl2ZV9kZWNsYXJhdGlvbnMuZm9yRWFjaChhZGRfZGVjbGFyYXRpb24pO1xuICAgIH1cbiAgICB3YXJuX2lmX3VuZGVmaW5lZChuYW1lLCBub2RlLCB0ZW1wbGF0ZV9zY29wZSkge1xuICAgICAgICBpZiAobmFtZVswXSA9PT0gJyQnKSB7XG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJyQnIHx8IG5hbWVbMV0gPT09ICckJyAmJiAhaXNfcmVzZXJ2ZWRfa2V5d29yZChuYW1lKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVycm9yKG5vZGUsIGNvbXBpbGVyX2Vycm9ycy5pbGxlZ2FsX2dsb2JhbChuYW1lKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmhhc19yZWFjdGl2ZV9hc3NpZ25tZW50cyA9IHRydWU7IC8vIFRPRE8gZG9lcyB0aGlzIGJlbG9uZyBoZXJlP1xuICAgICAgICAgICAgaWYgKGlzX3Jlc2VydmVkX2tleXdvcmQobmFtZSkpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgbmFtZSA9IG5hbWUuc2xpY2UoMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmFyX2xvb2t1cC5oYXMobmFtZSkgJiYgIXRoaXMudmFyX2xvb2t1cC5nZXQobmFtZSkuZ2xvYmFsKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAodGVtcGxhdGVfc2NvcGUgJiYgdGVtcGxhdGVfc2NvcGUubmFtZXMuaGFzKG5hbWUpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoZ2xvYmFscy5oYXMobmFtZSkgJiYgbm9kZS50eXBlICE9PSAnSW5saW5lQ29tcG9uZW50JylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy53YXJuKG5vZGUsIGNvbXBpbGVyX3dhcm5pbmdzLm1pc3NpbmdfZGVjbGFyYXRpb24obmFtZSwgISF0aGlzLmFzdC5pbnN0YW5jZSkpO1xuICAgIH1cbiAgICBwdXNoX2lnbm9yZXMoaWdub3Jlcykge1xuICAgICAgICB0aGlzLmlnbm9yZXMgPSBuZXcgU2V0KHRoaXMuaWdub3JlcyB8fCBbXSk7XG4gICAgICAgIGFkZF90b19zZXQodGhpcy5pZ25vcmVzLCBpZ25vcmVzKTtcbiAgICAgICAgdGhpcy5pZ25vcmVfc3RhY2sucHVzaCh0aGlzLmlnbm9yZXMpO1xuICAgIH1cbiAgICBwb3BfaWdub3JlcygpIHtcbiAgICAgICAgdGhpcy5pZ25vcmVfc3RhY2sucG9wKCk7XG4gICAgICAgIHRoaXMuaWdub3JlcyA9IHRoaXMuaWdub3JlX3N0YWNrW3RoaXMuaWdub3JlX3N0YWNrLmxlbmd0aCAtIDFdO1xuICAgIH1cbn1cbmNvbnN0IHJlZ2V4X3ZhbGlkX3RhZ19uYW1lID0gL15bYS16QS1aXVthLXpBLVowLTldKi1bYS16QS1aMC05LV0rJC87XG5mdW5jdGlvbiBwcm9jZXNzX2NvbXBvbmVudF9vcHRpb25zKGNvbXBvbmVudCwgbm9kZXMpIHtcbiAgICBjb25zdCBjb21wb25lbnRfb3B0aW9ucyA9IHtcbiAgICAgICAgaW1tdXRhYmxlOiBjb21wb25lbnQuY29tcGlsZV9vcHRpb25zLmltbXV0YWJsZSB8fCBmYWxzZSxcbiAgICAgICAgYWNjZXNzb3JzOiAnYWNjZXNzb3JzJyBpbiBjb21wb25lbnQuY29tcGlsZV9vcHRpb25zXG4gICAgICAgICAgICA/IGNvbXBvbmVudC5jb21waWxlX29wdGlvbnMuYWNjZXNzb3JzXG4gICAgICAgICAgICA6ICEhY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5jdXN0b21FbGVtZW50LFxuICAgICAgICBwcmVzZXJ2ZVdoaXRlc3BhY2U6ICEhY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5wcmVzZXJ2ZVdoaXRlc3BhY2UsXG4gICAgICAgIG5hbWVzcGFjZTogY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5uYW1lc3BhY2VcbiAgICB9O1xuICAgIGNvbnN0IG5vZGUgPSBub2Rlcy5maW5kKG5vZGUgPT4gbm9kZS5uYW1lID09PSAnc3ZlbHRlOm9wdGlvbnMnKTtcbiAgICBmdW5jdGlvbiBnZXRfdmFsdWUoYXR0cmlidXRlLCB7IGNvZGUsIG1lc3NhZ2UgfSkge1xuICAgICAgICBjb25zdCB7IHZhbHVlIH0gPSBhdHRyaWJ1dGU7XG4gICAgICAgIGNvbnN0IGNodW5rID0gdmFsdWVbMF07XG4gICAgICAgIGlmICghY2h1bmspXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYXR0cmlidXRlLCB7IGNvZGUsIG1lc3NhZ2UgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNodW5rLnR5cGUgPT09ICdUZXh0JylcbiAgICAgICAgICAgIHJldHVybiBjaHVuay5kYXRhO1xuICAgICAgICBpZiAoY2h1bmsuZXhwcmVzc2lvbi50eXBlICE9PSAnTGl0ZXJhbCcpIHtcbiAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYXR0cmlidXRlLCB7IGNvZGUsIG1lc3NhZ2UgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNodW5rLmV4cHJlc3Npb24udmFsdWU7XG4gICAgfVxuICAgIGlmIChub2RlKSB7XG4gICAgICAgIG5vZGUuYXR0cmlidXRlcy5mb3JFYWNoKGF0dHJpYnV0ZSA9PiB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlLnR5cGUgPT09ICdBdHRyaWJ1dGUnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSBhdHRyaWJ1dGU7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RhZyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZyA9IGdldF92YWx1ZShhdHRyaWJ1dGUsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX3RhZ19hdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0YWcgIT09ICdzdHJpbmcnICYmIHRhZyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYXR0cmlidXRlLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF90YWdfYXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWcgJiYgIXJlZ2V4X3ZhbGlkX3RhZ19uYW1lLnRlc3QodGFnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYXR0cmlidXRlLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF90YWdfcHJvcGVydHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhZyAmJiAhY29tcG9uZW50LmNvbXBpbGVfb3B0aW9ucy5jdXN0b21FbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Lndhcm4oYXR0cmlidXRlLCBjb21waWxlcl93YXJuaW5ncy5taXNzaW5nX2N1c3RvbV9lbGVtZW50X2NvbXBpbGVfb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRfb3B0aW9ucy50YWcgPSB0YWc7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlICduYW1lc3BhY2UnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBucyA9IGdldF92YWx1ZShhdHRyaWJ1dGUsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX25hbWVzcGFjZV9hdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBucyAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGF0dHJpYnV0ZSwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfbmFtZXNwYWNlX2F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRfbmFtZXNwYWNlcy5pbmRleE9mKG5zKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGZ1enp5bWF0Y2gobnMsIHZhbGlkX25hbWVzcGFjZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYXR0cmlidXRlLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9uYW1lc3BhY2VfcHJvcGVydHkobnMsIG1hdGNoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRfb3B0aW9ucy5uYW1lc3BhY2UgPSBucztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FjY2Vzc29ycyc6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2ltbXV0YWJsZSc6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ByZXNlcnZlV2hpdGVzcGFjZSc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0X3ZhbHVlKGF0dHJpYnV0ZSwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfYXR0cmlidXRlX3ZhbHVlKG5hbWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQuZXJyb3IoYXR0cmlidXRlLCBjb21waWxlcl9lcnJvcnMuaW52YWxpZF9hdHRyaWJ1dGVfdmFsdWUobmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50X29wdGlvbnNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmVycm9yKGF0dHJpYnV0ZSwgY29tcGlsZXJfZXJyb3JzLmludmFsaWRfb3B0aW9uc19hdHRyaWJ1dGVfdW5rbm93bik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5lcnJvcihhdHRyaWJ1dGUsIGNvbXBpbGVyX2Vycm9ycy5pbnZhbGlkX29wdGlvbnNfYXR0cmlidXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBjb21wb25lbnRfb3B0aW9ucztcbn1cbmZ1bmN0aW9uIGdldF9yZWxhdGl2ZV9wYXRoKGZyb20sIHRvKSB7XG4gICAgY29uc3QgZnJvbV9wYXJ0cyA9IGZyb20uc3BsaXQoL1svXFxcXF0vKTtcbiAgICBjb25zdCB0b19wYXJ0cyA9IHRvLnNwbGl0KC9bL1xcXFxdLyk7XG4gICAgZnJvbV9wYXJ0cy5wb3AoKTsgLy8gZ2V0IGRpcm5hbWVcbiAgICB3aGlsZSAoZnJvbV9wYXJ0c1swXSA9PT0gdG9fcGFydHNbMF0pIHtcbiAgICAgICAgZnJvbV9wYXJ0cy5zaGlmdCgpO1xuICAgICAgICB0b19wYXJ0cy5zaGlmdCgpO1xuICAgIH1cbiAgICBpZiAoZnJvbV9wYXJ0cy5sZW5ndGgpIHtcbiAgICAgICAgbGV0IGkgPSBmcm9tX3BhcnRzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSlcbiAgICAgICAgICAgIGZyb21fcGFydHNbaV0gPSAnLi4nO1xuICAgIH1cbiAgICByZXR1cm4gZnJvbV9wYXJ0cy5jb25jYXQodG9fcGFydHMpLmpvaW4oJy8nKTtcbn1cbmZ1bmN0aW9uIGdldF9iYXNlbmFtZShmaWxlbmFtZSkge1xuICAgIHJldHVybiBmaWxlbmFtZS5zcGxpdCgvWy9cXFxcXS8pLnBvcCgpO1xufVxuZnVuY3Rpb24gZ2V0X3NvdXJjZW1hcF9zb3VyY2VfZmlsZW5hbWUoY29tcGlsZV9vcHRpb25zKSB7XG4gICAgaWYgKCFjb21waWxlX29wdGlvbnMuZmlsZW5hbWUpXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIHJldHVybiBjb21waWxlX29wdGlvbnMub3V0cHV0RmlsZW5hbWVcbiAgICAgICAgPyBnZXRfcmVsYXRpdmVfcGF0aChjb21waWxlX29wdGlvbnMub3V0cHV0RmlsZW5hbWUsIGNvbXBpbGVfb3B0aW9ucy5maWxlbmFtZSlcbiAgICAgICAgOiBnZXRfYmFzZW5hbWUoY29tcGlsZV9vcHRpb25zLmZpbGVuYW1lKTtcbn1cblxuY29uc3QgcmVnZXhfcGVyY2VudGFnZV9jaGFyYWN0ZXJzID0gLyUvZztcbmNvbnN0IHJlZ2V4X2ZpbGVfZW5kaW5nID0gL1xcLlteLl0rJC87XG5jb25zdCByZWdleF9yZXBlYXRlZF9pbnZhbGlkX3ZhcmlhYmxlX2lkZW50aWZpZXJfY2hhcmFjdGVycyA9IC9bXmEtekEtWl8kMC05XSsvZztcbmNvbnN0IHJlZ2V4X3N0YXJ0c193aXRoX2RpZ2l0ID0gL14oXFxkKS87XG5mdW5jdGlvbiBnZXRfbmFtZV9mcm9tX2ZpbGVuYW1lKGZpbGVuYW1lKSB7XG4gICAgaWYgKCFmaWxlbmFtZSlcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgY29uc3QgcGFydHMgPSBmaWxlbmFtZS5zcGxpdCgvWy9cXFxcXS8pLm1hcChlbmNvZGVVUkkpO1xuICAgIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGNvbnN0IGluZGV4X21hdGNoID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV0ubWF0Y2goL15pbmRleChcXC5cXHcrKS8pO1xuICAgICAgICBpZiAoaW5kZXhfbWF0Y2gpIHtcbiAgICAgICAgICAgIHBhcnRzLnBvcCgpO1xuICAgICAgICAgICAgcGFydHNbcGFydHMubGVuZ3RoIC0gMV0gKz0gaW5kZXhfbWF0Y2hbMV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgYmFzZSA9IHBhcnRzLnBvcCgpXG4gICAgICAgIC5yZXBsYWNlKHJlZ2V4X3BlcmNlbnRhZ2VfY2hhcmFjdGVycywgJ3UnKVxuICAgICAgICAucmVwbGFjZShyZWdleF9maWxlX2VuZGluZywgJycpXG4gICAgICAgIC5yZXBsYWNlKHJlZ2V4X3JlcGVhdGVkX2ludmFsaWRfdmFyaWFibGVfaWRlbnRpZmllcl9jaGFyYWN0ZXJzLCAnXycpXG4gICAgICAgIC5yZXBsYWNlKHJlZ2V4X3N0YXJ0c193aXRoX3VuZGVyc2NvcmUsICcnKVxuICAgICAgICAucmVwbGFjZShyZWdleF9lbmRzX3dpdGhfdW5kZXJzY29yZSwgJycpXG4gICAgICAgIC5yZXBsYWNlKHJlZ2V4X3N0YXJ0c193aXRoX2RpZ2l0LCAnXyQxJyk7XG4gICAgaWYgKCFiYXNlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGRlcml2ZSBjb21wb25lbnQgbmFtZSBmcm9tIGZpbGUgJHtmaWxlbmFtZX1gKTtcbiAgICB9XG4gICAgcmV0dXJuIGJhc2VbMF0udG9VcHBlckNhc2UoKSArIGJhc2Uuc2xpY2UoMSk7XG59XG5cbmNvbnN0IHZhbGlkX29wdGlvbnMgPSBbXG4gICAgJ2Zvcm1hdCcsXG4gICAgJ25hbWUnLFxuICAgICdmaWxlbmFtZScsXG4gICAgJ3NvdXJjZW1hcCcsXG4gICAgJ2VuYWJsZVNvdXJjZW1hcCcsXG4gICAgJ2dlbmVyYXRlJyxcbiAgICAnZXJyb3JNb2RlJyxcbiAgICAndmFyc1JlcG9ydCcsXG4gICAgJ291dHB1dEZpbGVuYW1lJyxcbiAgICAnY3NzT3V0cHV0RmlsZW5hbWUnLFxuICAgICdzdmVsdGVQYXRoJyxcbiAgICAnZGV2JyxcbiAgICAnYWNjZXNzb3JzJyxcbiAgICAnaW1tdXRhYmxlJyxcbiAgICAnaHlkcmF0YWJsZScsXG4gICAgJ2xlZ2FjeScsXG4gICAgJ2N1c3RvbUVsZW1lbnQnLFxuICAgICduYW1lc3BhY2UnLFxuICAgICd0YWcnLFxuICAgICdjc3MnLFxuICAgICdsb29wR3VhcmRUaW1lb3V0JyxcbiAgICAncHJlc2VydmVDb21tZW50cycsXG4gICAgJ3ByZXNlcnZlV2hpdGVzcGFjZScsXG4gICAgJ2Nzc0hhc2gnXG5dO1xuY29uc3QgcmVnZXhfdmFsaWRfaWRlbnRpZmllciA9IC9eW2EtekEtWl8kXVthLXpBLVpfJDAtOV0qJC87XG5jb25zdCByZWdleF9zdGFydHNfd2l0aF9sb3dlcmNhc2VfY2hhcmFjdGVyID0gL15bYS16XS87XG5mdW5jdGlvbiB2YWxpZGF0ZV9vcHRpb25zKG9wdGlvbnMsIHdhcm5pbmdzKSB7XG4gICAgY29uc3QgeyBuYW1lLCBmaWxlbmFtZSwgbG9vcEd1YXJkVGltZW91dCwgZGV2LCBuYW1lc3BhY2UgfSA9IG9wdGlvbnM7XG4gICAgT2JqZWN0LmtleXMob3B0aW9ucykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAoIXZhbGlkX29wdGlvbnMuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBmdXp6eW1hdGNoKGtleSwgdmFsaWRfb3B0aW9ucyk7XG4gICAgICAgICAgICBsZXQgbWVzc2FnZSA9IGBVbnJlY29nbml6ZWQgb3B0aW9uICcke2tleX0nYDtcbiAgICAgICAgICAgIGlmIChtYXRjaClcbiAgICAgICAgICAgICAgICBtZXNzYWdlICs9IGAgKGRpZCB5b3UgbWVhbiAnJHttYXRjaH0nPylgO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKG5hbWUgJiYgIXJlZ2V4X3ZhbGlkX2lkZW50aWZpZXIudGVzdChuYW1lKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYG9wdGlvbnMubmFtZSBtdXN0IGJlIGEgdmFsaWQgaWRlbnRpZmllciAoZ290ICcke25hbWV9JylgKTtcbiAgICB9XG4gICAgaWYgKG5hbWUgJiYgcmVnZXhfc3RhcnRzX3dpdGhfbG93ZXJjYXNlX2NoYXJhY3Rlci50ZXN0KG5hbWUpKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSAnb3B0aW9ucy5uYW1lIHNob3VsZCBiZSBjYXBpdGFsaXNlZCc7XG4gICAgICAgIHdhcm5pbmdzLnB1c2goe1xuICAgICAgICAgICAgY29kZTogJ29wdGlvbnMtbG93ZXJjYXNlLW5hbWUnLFxuICAgICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICAgIGZpbGVuYW1lLFxuICAgICAgICAgICAgdG9TdHJpbmc6ICgpID0+IG1lc3NhZ2VcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChsb29wR3VhcmRUaW1lb3V0ICYmICFkZXYpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9ICdvcHRpb25zLmxvb3BHdWFyZFRpbWVvdXQgaXMgZm9yIG9wdGlvbnMuZGV2ID0gdHJ1ZSBvbmx5JztcbiAgICAgICAgd2FybmluZ3MucHVzaCh7XG4gICAgICAgICAgICBjb2RlOiAnb3B0aW9ucy1sb29wLWd1YXJkLXRpbWVvdXQnLFxuICAgICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICAgIGZpbGVuYW1lLFxuICAgICAgICAgICAgdG9TdHJpbmc6ICgpID0+IG1lc3NhZ2VcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChuYW1lc3BhY2UgJiYgdmFsaWRfbmFtZXNwYWNlcy5pbmRleE9mKG5hbWVzcGFjZSkgPT09IC0xKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gZnV6enltYXRjaChuYW1lc3BhY2UsIHZhbGlkX25hbWVzcGFjZXMpO1xuICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBuYW1lc3BhY2UgJyR7bmFtZXNwYWNlfScgKGRpZCB5b3UgbWVhbiAnJHttYXRjaH0nPylgKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBuYW1lc3BhY2UgJyR7bmFtZXNwYWNlfSdgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGNvbXBpbGUoc291cmNlLCBvcHRpb25zID0ge30pIHtcbiAgICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGdlbmVyYXRlOiAnZG9tJywgZGV2OiBmYWxzZSwgZW5hYmxlU291cmNlbWFwOiB0cnVlIH0sIG9wdGlvbnMpO1xuICAgIGNvbnN0IHN0YXRzID0gbmV3IFN0YXRzKCk7XG4gICAgY29uc3Qgd2FybmluZ3MgPSBbXTtcbiAgICB2YWxpZGF0ZV9vcHRpb25zKG9wdGlvbnMsIHdhcm5pbmdzKTtcbiAgICBzdGF0cy5zdGFydCgncGFyc2UnKTtcbiAgICBjb25zdCBhc3QgPSBwYXJzZSQzKHNvdXJjZSwgb3B0aW9ucyk7XG4gICAgc3RhdHMuc3RvcCgncGFyc2UnKTtcbiAgICBzdGF0cy5zdGFydCgnY3JlYXRlIGNvbXBvbmVudCcpO1xuICAgIGNvbnN0IGNvbXBvbmVudCA9IG5ldyBDb21wb25lbnQoYXN0LCBzb3VyY2UsIG9wdGlvbnMubmFtZSB8fCBnZXRfbmFtZV9mcm9tX2ZpbGVuYW1lKG9wdGlvbnMuZmlsZW5hbWUpIHx8ICdDb21wb25lbnQnLCBvcHRpb25zLCBzdGF0cywgd2FybmluZ3MpO1xuICAgIHN0YXRzLnN0b3AoJ2NyZWF0ZSBjb21wb25lbnQnKTtcbiAgICBjb25zdCByZXN1bHQgPSBvcHRpb25zLmdlbmVyYXRlID09PSBmYWxzZVxuICAgICAgICA/IG51bGxcbiAgICAgICAgOiBvcHRpb25zLmdlbmVyYXRlID09PSAnc3NyJ1xuICAgICAgICAgICAgPyBzc3IoY29tcG9uZW50LCBvcHRpb25zKVxuICAgICAgICAgICAgOiBkb20oY29tcG9uZW50LCBvcHRpb25zKTtcbiAgICByZXR1cm4gY29tcG9uZW50LmdlbmVyYXRlKHJlc3VsdCk7XG59XG5cbi8qKlxuICogSW1wb3J0IGRlY29kZWQgc291cmNlbWFwIGZyb20gbW96aWxsYS9zb3VyY2UtbWFwL1NvdXJjZU1hcEdlbmVyYXRvclxuICogRm9ya2VkIGZyb20gc291cmNlLW1hcC9saWIvc291cmNlLW1hcC1nZW5lcmF0b3IuanNcbiAqIGZyb20gbWV0aG9kcyBfc2VyaWFsaXplTWFwcGluZ3MgYW5kIHRvSlNPTi5cbiAqIFdlIGNhbm5vdCB1c2Ugc291cmNlLW1hcC5kLnRzIHR5cGVzLCBiZWNhdXNlIHdlIGFjY2VzcyBoaWRkZW4gcHJvcGVydGllcy5cbiAqL1xuZnVuY3Rpb24gZGVjb2RlZF9zb3VyY2VtYXBfZnJvbV9nZW5lcmF0b3IoZ2VuZXJhdG9yKSB7XG4gICAgbGV0IHByZXZpb3VzX2dlbmVyYXRlZF9saW5lID0gMTtcbiAgICBjb25zdCBjb252ZXJ0ZWRfbWFwcGluZ3MgPSBbW11dO1xuICAgIGxldCByZXN1bHRfbGluZTtcbiAgICBsZXQgcmVzdWx0X3NlZ21lbnQ7XG4gICAgbGV0IG1hcHBpbmc7XG4gICAgY29uc3Qgc291cmNlX2lkeCA9IGdlbmVyYXRvci5fc291cmNlcy50b0FycmF5KClcbiAgICAgICAgLnJlZHVjZSgoYWNjLCB2YWwsIGlkeCkgPT4gKGFjY1t2YWxdID0gaWR4LCBhY2MpLCB7fSk7XG4gICAgY29uc3QgbmFtZV9pZHggPSBnZW5lcmF0b3IuX25hbWVzLnRvQXJyYXkoKVxuICAgICAgICAucmVkdWNlKChhY2MsIHZhbCwgaWR4KSA9PiAoYWNjW3ZhbF0gPSBpZHgsIGFjYyksIHt9KTtcbiAgICBjb25zdCBtYXBwaW5ncyA9IGdlbmVyYXRvci5fbWFwcGluZ3MudG9BcnJheSgpO1xuICAgIHJlc3VsdF9saW5lID0gY29udmVydGVkX21hcHBpbmdzWzBdO1xuICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBtYXBwaW5ncy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBtYXBwaW5nID0gbWFwcGluZ3NbaV07XG4gICAgICAgIGlmIChtYXBwaW5nLmdlbmVyYXRlZExpbmUgPiBwcmV2aW91c19nZW5lcmF0ZWRfbGluZSkge1xuICAgICAgICAgICAgd2hpbGUgKG1hcHBpbmcuZ2VuZXJhdGVkTGluZSA+IHByZXZpb3VzX2dlbmVyYXRlZF9saW5lKSB7XG4gICAgICAgICAgICAgICAgY29udmVydGVkX21hcHBpbmdzLnB1c2goW10pO1xuICAgICAgICAgICAgICAgIHByZXZpb3VzX2dlbmVyYXRlZF9saW5lKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHRfbGluZSA9IGNvbnZlcnRlZF9tYXBwaW5nc1ttYXBwaW5nLmdlbmVyYXRlZExpbmUgLSAxXTsgLy8gbGluZSBpcyBvbmUtYmFzZWRcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpID4gMCkge1xuICAgICAgICAgICAgY29uc3QgcHJldmlvdXNfbWFwcGluZyA9IG1hcHBpbmdzW2kgLSAxXTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIC8vIHNvcnRlZCBieSBzZWxlY3Rpdml0eVxuICAgICAgICAgICAgbWFwcGluZy5nZW5lcmF0ZWRDb2x1bW4gPT09IHByZXZpb3VzX21hcHBpbmcuZ2VuZXJhdGVkQ29sdW1uICYmXG4gICAgICAgICAgICAgICAgbWFwcGluZy5vcmlnaW5hbENvbHVtbiA9PT0gcHJldmlvdXNfbWFwcGluZy5vcmlnaW5hbENvbHVtbiAmJlxuICAgICAgICAgICAgICAgIG1hcHBpbmcubmFtZSA9PT0gcHJldmlvdXNfbWFwcGluZy5uYW1lICYmXG4gICAgICAgICAgICAgICAgbWFwcGluZy5nZW5lcmF0ZWRMaW5lID09PSBwcmV2aW91c19tYXBwaW5nLmdlbmVyYXRlZExpbmUgJiZcbiAgICAgICAgICAgICAgICBtYXBwaW5nLm9yaWdpbmFsTGluZSA9PT0gcHJldmlvdXNfbWFwcGluZy5vcmlnaW5hbExpbmUgJiZcbiAgICAgICAgICAgICAgICBtYXBwaW5nLnNvdXJjZSA9PT0gcHJldmlvdXNfbWFwcGluZy5zb3VyY2UpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXN1bHRfbGluZS5wdXNoKFttYXBwaW5nLmdlbmVyYXRlZENvbHVtbl0pO1xuICAgICAgICByZXN1bHRfc2VnbWVudCA9IHJlc3VsdF9saW5lW3Jlc3VsdF9saW5lLmxlbmd0aCAtIDFdO1xuICAgICAgICBpZiAobWFwcGluZy5zb3VyY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgcmVzdWx0X3NlZ21lbnQucHVzaCguLi5bXG4gICAgICAgICAgICAgICAgc291cmNlX2lkeFttYXBwaW5nLnNvdXJjZV0sXG4gICAgICAgICAgICAgICAgbWFwcGluZy5vcmlnaW5hbExpbmUgLSAxLFxuICAgICAgICAgICAgICAgIG1hcHBpbmcub3JpZ2luYWxDb2x1bW5cbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgaWYgKG1hcHBpbmcubmFtZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0X3NlZ21lbnQucHVzaChuYW1lX2lkeFttYXBwaW5nLm5hbWVdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBtYXAgPSB7XG4gICAgICAgIHZlcnNpb246IGdlbmVyYXRvci5fdmVyc2lvbixcbiAgICAgICAgc291cmNlczogZ2VuZXJhdG9yLl9zb3VyY2VzLnRvQXJyYXkoKSxcbiAgICAgICAgbmFtZXM6IGdlbmVyYXRvci5fbmFtZXMudG9BcnJheSgpLFxuICAgICAgICBtYXBwaW5nczogY29udmVydGVkX21hcHBpbmdzXG4gICAgfTtcbiAgICBpZiAoZ2VuZXJhdG9yLl9maWxlICE9IG51bGwpIHtcbiAgICAgICAgbWFwLmZpbGUgPSBnZW5lcmF0b3IuX2ZpbGU7XG4gICAgfVxuICAgIC8vIG5vdCBuZWVkZWQ6IG1hcC5zb3VyY2VzQ29udGVudCBhbmQgbWFwLnNvdXJjZVJvb3RcbiAgICByZXR1cm4gbWFwO1xufVxuZnVuY3Rpb24gZGVjb2RlX21hcChwcm9jZXNzZWQpIHtcbiAgICBsZXQgZGVjb2RlZF9tYXAgPSB0eXBlb2YgcHJvY2Vzc2VkLm1hcCA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKHByb2Nlc3NlZC5tYXApIDogcHJvY2Vzc2VkLm1hcDtcbiAgICBpZiAodHlwZW9mIChkZWNvZGVkX21hcC5tYXBwaW5ncykgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGRlY29kZWRfbWFwLm1hcHBpbmdzID0gZGVjb2RlKGRlY29kZWRfbWFwLm1hcHBpbmdzKTtcbiAgICB9XG4gICAgaWYgKGRlY29kZWRfbWFwLl9tYXBwaW5ncyAmJiBkZWNvZGVkX21hcC5jb25zdHJ1Y3Rvci5uYW1lID09PSAnU291cmNlTWFwR2VuZXJhdG9yJykge1xuICAgICAgICAvLyBpbXBvcnQgZGVjb2RlZCBzb3VyY2VtYXAgZnJvbSBtb3ppbGxhL3NvdXJjZS1tYXAvU291cmNlTWFwR2VuZXJhdG9yXG4gICAgICAgIGRlY29kZWRfbWFwID0gZGVjb2RlZF9zb3VyY2VtYXBfZnJvbV9nZW5lcmF0b3IoZGVjb2RlZF9tYXApO1xuICAgIH1cbiAgICByZXR1cm4gZGVjb2RlZF9tYXA7XG59XG5cbmZ1bmN0aW9uIHNsaWNlX3NvdXJjZShjb2RlX3NsaWNlLCBvZmZzZXQsIHsgZmlsZV9iYXNlbmFtZSwgZmlsZW5hbWUsIGdldF9sb2NhdGlvbiB9KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc291cmNlOiBjb2RlX3NsaWNlLFxuICAgICAgICBnZXRfbG9jYXRpb246IChpbmRleCkgPT4gZ2V0X2xvY2F0aW9uKGluZGV4ICsgb2Zmc2V0KSxcbiAgICAgICAgZmlsZV9iYXNlbmFtZSxcbiAgICAgICAgZmlsZW5hbWVcbiAgICB9O1xufVxuZnVuY3Rpb24gY2FsY3VsYXRlX3JlcGxhY2VtZW50cyhyZSwgZ2V0X3JlcGxhY2VtZW50LCBzb3VyY2UpIHtcbiAgICBjb25zdCByZXBsYWNlbWVudHMgPSBbXTtcbiAgICBzb3VyY2UucmVwbGFjZShyZSwgKC4uLm1hdGNoKSA9PiB7XG4gICAgICAgIHJlcGxhY2VtZW50cy5wdXNoKGdldF9yZXBsYWNlbWVudCguLi5tYXRjaCkudGhlbihyZXBsYWNlbWVudCA9PiB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVkX3N0cmluZyA9IG1hdGNoWzBdO1xuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gbWF0Y2hbbWF0Y2gubGVuZ3RoIC0gMl07XG4gICAgICAgICAgICByZXR1cm4gKHsgb2Zmc2V0LCBsZW5ndGg6IG1hdGNoZWRfc3RyaW5nLmxlbmd0aCwgcmVwbGFjZW1lbnQgfSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH0pO1xuICAgIHJldHVybiBQcm9taXNlLmFsbChyZXBsYWNlbWVudHMpO1xufVxuZnVuY3Rpb24gcGVyZm9ybV9yZXBsYWNlbWVudHMocmVwbGFjZW1lbnRzLCBzb3VyY2UpIHtcbiAgICBjb25zdCBvdXQgPSBuZXcgTWFwcGVkQ29kZSgpO1xuICAgIGxldCBsYXN0X2VuZCA9IDA7XG4gICAgZm9yIChjb25zdCB7IG9mZnNldCwgbGVuZ3RoLCByZXBsYWNlbWVudCB9IG9mIHJlcGxhY2VtZW50cykge1xuICAgICAgICBjb25zdCB1bmNoYW5nZWRfcHJlZml4ID0gTWFwcGVkQ29kZS5mcm9tX3NvdXJjZShzbGljZV9zb3VyY2Uoc291cmNlLnNvdXJjZS5zbGljZShsYXN0X2VuZCwgb2Zmc2V0KSwgbGFzdF9lbmQsIHNvdXJjZSkpO1xuICAgICAgICBvdXQuY29uY2F0KHVuY2hhbmdlZF9wcmVmaXgpLmNvbmNhdChyZXBsYWNlbWVudCk7XG4gICAgICAgIGxhc3RfZW5kID0gb2Zmc2V0ICsgbGVuZ3RoO1xuICAgIH1cbiAgICBjb25zdCB1bmNoYW5nZWRfc3VmZml4ID0gTWFwcGVkQ29kZS5mcm9tX3NvdXJjZShzbGljZV9zb3VyY2Uoc291cmNlLnNvdXJjZS5zbGljZShsYXN0X2VuZCksIGxhc3RfZW5kLCBzb3VyY2UpKTtcbiAgICByZXR1cm4gb3V0LmNvbmNhdCh1bmNoYW5nZWRfc3VmZml4KTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VfaW5fY29kZShyZWdleCwgZ2V0X3JlcGxhY2VtZW50LCBsb2NhdGlvbikge1xuICAgIGNvbnN0IHJlcGxhY2VtZW50cyA9IGF3YWl0IGNhbGN1bGF0ZV9yZXBsYWNlbWVudHMocmVnZXgsIGdldF9yZXBsYWNlbWVudCwgbG9jYXRpb24uc291cmNlKTtcbiAgICByZXR1cm4gcGVyZm9ybV9yZXBsYWNlbWVudHMocmVwbGFjZW1lbnRzLCBsb2NhdGlvbik7XG59XG5cbmNvbnN0IHJlZ2V4X2ZpbGVwYXRoX3NlcGFyYXRvciA9IC9bL1xcXFxdLztcbmZ1bmN0aW9uIGdldF9maWxlX2Jhc2VuYW1lKGZpbGVuYW1lKSB7XG4gICAgcmV0dXJuIGZpbGVuYW1lLnNwbGl0KHJlZ2V4X2ZpbGVwYXRoX3NlcGFyYXRvcikucG9wKCk7XG59XG4vKipcbiAqIFJlcHJlc2VudHMgaW50ZXJtZWRpYXRlIHN0YXRlcyBvZiB0aGUgcHJlcHJvY2Vzc2luZy5cbiAqL1xuY2xhc3MgUHJlcHJvY2Vzc1Jlc3VsdCB7XG4gICAgY29uc3RydWN0b3Ioc291cmNlLCBmaWxlbmFtZSkge1xuICAgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgICAgdGhpcy5maWxlbmFtZSA9IGZpbGVuYW1lO1xuICAgICAgICAvLyBzb3VyY2VtYXBfbGlzdCBpcyBzb3J0ZWQgaW4gcmV2ZXJzZSBvcmRlciBmcm9tIGxhc3QgbWFwIChpbmRleCAwKSB0byBmaXJzdCBtYXAgKGluZGV4IC0xKVxuICAgICAgICAvLyBzbyB3ZSB1c2Ugc291cmNlbWFwX2xpc3QudW5zaGlmdCgpIHRvIGFkZCBuZXcgbWFwc1xuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYW1wcHJvamVjdC9yZW1hcHBpbmcjbXVsdGlwbGUtdHJhbnNmb3JtYXRpb25zLW9mLWEtZmlsZVxuICAgICAgICB0aGlzLnNvdXJjZW1hcF9saXN0ID0gW107XG4gICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gW107XG4gICAgICAgIHRoaXMudXBkYXRlX3NvdXJjZSh7IHN0cmluZzogc291cmNlIH0pO1xuICAgICAgICAvLyBwcmVwcm9jZXNzIHNvdXJjZSBtdXN0IGJlIHJlbGF0aXZlIHRvIGl0c2VsZiBvciBlcXVhbCBudWxsXG4gICAgICAgIHRoaXMuZmlsZV9iYXNlbmFtZSA9IGZpbGVuYW1lID09IG51bGwgPyBudWxsIDogZ2V0X2ZpbGVfYmFzZW5hbWUoZmlsZW5hbWUpO1xuICAgIH1cbiAgICB1cGRhdGVfc291cmNlKHsgc3RyaW5nOiBzb3VyY2UsIG1hcCwgZGVwZW5kZW5jaWVzIH0pIHtcbiAgICAgICAgaWYgKHNvdXJjZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgICAgICAgIHRoaXMuZ2V0X2xvY2F0aW9uID0gZ2V0TG9jYXRvcihzb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtYXApIHtcbiAgICAgICAgICAgIHRoaXMuc291cmNlbWFwX2xpc3QudW5zaGlmdChtYXApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzLnB1c2goLi4uZGVwZW5kZW5jaWVzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b19wcm9jZXNzZWQoKSB7XG4gICAgICAgIC8vIENvbWJpbmUgYWxsIHRoZSBzb3VyY2UgbWFwcyBmb3IgZWFjaCBwcmVwcm9jZXNzb3IgZnVuY3Rpb24gaW50byBvbmVcbiAgICAgICAgY29uc3QgbWFwID0gY29tYmluZV9zb3VyY2VtYXBzKHRoaXMuZmlsZV9iYXNlbmFtZSwgdGhpcy5zb3VyY2VtYXBfbGlzdCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAvLyBUT0RPIHJldHVybiBzZXBhcmF0ZWQgb3V0cHV0LCBpbiBmdXR1cmUgdmVyc2lvbiB3aGVyZSBzdmVsdGUuY29tcGlsZSBzdXBwb3J0cyBpdDpcbiAgICAgICAgICAgIC8vIHN0eWxlOiB7IGNvZGU6IHN0eWxlQ29kZSwgbWFwOiBzdHlsZU1hcCB9LFxuICAgICAgICAgICAgLy8gc2NyaXB0IHsgY29kZTogc2NyaXB0Q29kZSwgbWFwOiBzY3JpcHRNYXAgfSxcbiAgICAgICAgICAgIC8vIG1hcmt1cCB7IGNvZGU6IG1hcmt1cENvZGUsIG1hcDogbWFya3VwTWFwIH0sXG4gICAgICAgICAgICBjb2RlOiB0aGlzLnNvdXJjZSxcbiAgICAgICAgICAgIGRlcGVuZGVuY2llczogWy4uLm5ldyBTZXQodGhpcy5kZXBlbmRlbmNpZXMpXSxcbiAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgdG9TdHJpbmc6ICgpID0+IHRoaXMuc291cmNlXG4gICAgICAgIH07XG4gICAgfVxufVxuLyoqXG4gKiBDb252ZXJ0IHByZXByb2Nlc3NvciBvdXRwdXQgZm9yIHRoZSB0YWcgY29udGVudCBpbnRvIE1hcHBlZENvZGVcbiAqL1xuZnVuY3Rpb24gcHJvY2Vzc2VkX2NvbnRlbnRfdG9fY29kZShwcm9jZXNzZWQsIGxvY2F0aW9uLCBmaWxlX2Jhc2VuYW1lKSB7XG4gICAgLy8gQ29udmVydCB0aGUgcHJlcHJvY2Vzc2VkIGNvZGUgYW5kIGl0cyBzb3VyY2VtYXAgdG8gYSBNYXBwZWRDb2RlXG4gICAgbGV0IGRlY29kZWRfbWFwO1xuICAgIGlmIChwcm9jZXNzZWQubWFwKSB7XG4gICAgICAgIGRlY29kZWRfbWFwID0gZGVjb2RlX21hcChwcm9jZXNzZWQpO1xuICAgICAgICAvLyBkZWNvZGVkIG1hcCBtYXkgbm90IGhhdmUgc291cmNlcyBmb3IgZW1wdHkgbWFwcyBsaWtlIGB7IG1hcHBpbmdzOiAnJyB9YFxuICAgICAgICBpZiAoZGVjb2RlZF9tYXAuc291cmNlcykge1xuICAgICAgICAgICAgLy8gb2Zmc2V0IG9ubHkgc2VnbWVudHMgcG9pbnRpbmcgYXQgb3JpZ2luYWwgY29tcG9uZW50IHNvdXJjZVxuICAgICAgICAgICAgY29uc3Qgc291cmNlX2luZGV4ID0gZGVjb2RlZF9tYXAuc291cmNlcy5pbmRleE9mKGZpbGVfYmFzZW5hbWUpO1xuICAgICAgICAgICAgaWYgKHNvdXJjZV9pbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBzb3VyY2VtYXBfYWRkX29mZnNldChkZWNvZGVkX21hcCwgbG9jYXRpb24sIHNvdXJjZV9pbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIE1hcHBlZENvZGUuZnJvbV9wcm9jZXNzZWQocHJvY2Vzc2VkLmNvZGUsIGRlY29kZWRfbWFwKTtcbn1cbi8qKlxuICogR2l2ZW4gdGhlIHdob2xlIHRhZyBpbmNsdWRpbmcgY29udGVudCwgcmV0dXJuIGEgYE1hcHBlZENvZGVgXG4gKiByZXByZXNlbnRpbmcgdGhlIHRhZyBjb250ZW50IHJlcGxhY2VkIHdpdGggYHByb2Nlc3NlZGAuXG4gKi9cbmZ1bmN0aW9uIHByb2Nlc3NlZF90YWdfdG9fY29kZShwcm9jZXNzZWQsIHRhZ19uYW1lLCBhdHRyaWJ1dGVzLCBzb3VyY2UpIHtcbiAgICBjb25zdCB7IGZpbGVfYmFzZW5hbWUsIGdldF9sb2NhdGlvbiB9ID0gc291cmNlO1xuICAgIGNvbnN0IGJ1aWxkX21hcHBlZF9jb2RlID0gKGNvZGUsIG9mZnNldCkgPT4gTWFwcGVkQ29kZS5mcm9tX3NvdXJjZShzbGljZV9zb3VyY2UoY29kZSwgb2Zmc2V0LCBzb3VyY2UpKTtcbiAgICBjb25zdCB0YWdfb3BlbiA9IGA8JHt0YWdfbmFtZX0ke2F0dHJpYnV0ZXMgfHwgJyd9PmA7XG4gICAgY29uc3QgdGFnX2Nsb3NlID0gYDwvJHt0YWdfbmFtZX0+YDtcbiAgICBjb25zdCB0YWdfb3Blbl9jb2RlID0gYnVpbGRfbWFwcGVkX2NvZGUodGFnX29wZW4sIDApO1xuICAgIGNvbnN0IHRhZ19jbG9zZV9jb2RlID0gYnVpbGRfbWFwcGVkX2NvZGUodGFnX2Nsb3NlLCB0YWdfb3Blbi5sZW5ndGggKyBzb3VyY2Uuc291cmNlLmxlbmd0aCk7XG4gICAgcGFyc2VfYXR0YWNoZWRfc291cmNlbWFwKHByb2Nlc3NlZCwgdGFnX25hbWUpO1xuICAgIGNvbnN0IGNvbnRlbnRfY29kZSA9IHByb2Nlc3NlZF9jb250ZW50X3RvX2NvZGUocHJvY2Vzc2VkLCBnZXRfbG9jYXRpb24odGFnX29wZW4ubGVuZ3RoKSwgZmlsZV9iYXNlbmFtZSk7XG4gICAgcmV0dXJuIHRhZ19vcGVuX2NvZGUuY29uY2F0KGNvbnRlbnRfY29kZSkuY29uY2F0KHRhZ19jbG9zZV9jb2RlKTtcbn1cbmNvbnN0IHJlZ2V4X3F1b3RlZF92YWx1ZSA9IC9eWydcIl0oLiopWydcIl0kLztcbmZ1bmN0aW9uIHBhcnNlX3RhZ19hdHRyaWJ1dGVzKHN0cikge1xuICAgIC8vIG5vdGU6IHdvbid0IHdvcmsgd2l0aCBhdHRyaWJ1dGUgdmFsdWVzIGNvbnRhaW5pbmcgc3BhY2VzLlxuICAgIHJldHVybiBzdHJcbiAgICAgICAgLnNwbGl0KHJlZ2V4X3doaXRlc3BhY2VzKVxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgIC5yZWR1Y2UoKGF0dHJzLCBhdHRyKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3QgaSA9IGF0dHIuaW5kZXhPZignPScpO1xuICAgICAgICBjb25zdCBba2V5LCB2YWx1ZV0gPSBpID4gMCA/IFthdHRyLnNsaWNlKDAsIGkpLCBhdHRyLnNsaWNlKGkgKyAxKV0gOiBbYXR0cl07XG4gICAgICAgIGNvbnN0IFssIHVucXVvdGVkXSA9ICh2YWx1ZSAmJiB2YWx1ZS5tYXRjaChyZWdleF9xdW90ZWRfdmFsdWUpKSB8fCBbXTtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgYXR0cnMpLCB7IFtrZXldOiAoX2EgPSB1bnF1b3RlZCAhPT0gbnVsbCAmJiB1bnF1b3RlZCAhPT0gdm9pZCAwID8gdW5xdW90ZWQgOiB2YWx1ZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogdHJ1ZSB9KTtcbiAgICB9LCB7fSk7XG59XG5jb25zdCByZWdleF9zdHlsZV90YWdzID0gLzwhLS1bXl0qPy0tPnw8c3R5bGUoXFxzW15dKj8pPyg/Oj4oW15dKj8pPFxcL3N0eWxlPnxcXC8+KS9naTtcbmNvbnN0IHJlZ2V4X3NjcmlwdF90YWdzID0gLzwhLS1bXl0qPy0tPnw8c2NyaXB0KFxcc1teXSo/KT8oPzo+KFteXSo/KTxcXC9zY3JpcHQ+fFxcLz4pL2dpO1xuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIHVwZGF0ZXMgcmVxdWlyZWQgdG8gcHJvY2VzcyBhbGwgaW5zdGFuY2VzIG9mIHRoZSBzcGVjaWZpZWQgdGFnLlxuICovXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzX3RhZyh0YWdfbmFtZSwgcHJlcHJvY2Vzc29yLCBzb3VyY2UpIHtcbiAgICBjb25zdCB7IGZpbGVuYW1lLCBzb3VyY2U6IG1hcmt1cCB9ID0gc291cmNlO1xuICAgIGNvbnN0IHRhZ19yZWdleCA9IHRhZ19uYW1lID09PSAnc3R5bGUnID8gcmVnZXhfc3R5bGVfdGFncyA6IHJlZ2V4X3NjcmlwdF90YWdzO1xuICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IFtdO1xuICAgIGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3Nfc2luZ2xlX3RhZyh0YWdfd2l0aF9jb250ZW50LCBhdHRyaWJ1dGVzID0gJycsIGNvbnRlbnQgPSAnJywgdGFnX29mZnNldCkge1xuICAgICAgICBjb25zdCBub19jaGFuZ2UgPSAoKSA9PiBNYXBwZWRDb2RlLmZyb21fc291cmNlKHNsaWNlX3NvdXJjZSh0YWdfd2l0aF9jb250ZW50LCB0YWdfb2Zmc2V0LCBzb3VyY2UpKTtcbiAgICAgICAgaWYgKCFhdHRyaWJ1dGVzICYmICFjb250ZW50KVxuICAgICAgICAgICAgcmV0dXJuIG5vX2NoYW5nZSgpO1xuICAgICAgICBjb25zdCBwcm9jZXNzZWQgPSBhd2FpdCBwcmVwcm9jZXNzb3Ioe1xuICAgICAgICAgICAgY29udGVudDogY29udGVudCB8fCAnJyxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHBhcnNlX3RhZ19hdHRyaWJ1dGVzKGF0dHJpYnV0ZXMgfHwgJycpLFxuICAgICAgICAgICAgbWFya3VwLFxuICAgICAgICAgICAgZmlsZW5hbWVcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcHJvY2Vzc2VkKVxuICAgICAgICAgICAgcmV0dXJuIG5vX2NoYW5nZSgpO1xuICAgICAgICBpZiAocHJvY2Vzc2VkLmRlcGVuZGVuY2llcylcbiAgICAgICAgICAgIGRlcGVuZGVuY2llcy5wdXNoKC4uLnByb2Nlc3NlZC5kZXBlbmRlbmNpZXMpO1xuICAgICAgICBpZiAoIXByb2Nlc3NlZC5tYXAgJiYgcHJvY2Vzc2VkLmNvZGUgPT09IGNvbnRlbnQpXG4gICAgICAgICAgICByZXR1cm4gbm9fY2hhbmdlKCk7XG4gICAgICAgIHJldHVybiBwcm9jZXNzZWRfdGFnX3RvX2NvZGUocHJvY2Vzc2VkLCB0YWdfbmFtZSwgYXR0cmlidXRlcywgc2xpY2Vfc291cmNlKGNvbnRlbnQsIHRhZ19vZmZzZXQsIHNvdXJjZSkpO1xuICAgIH1cbiAgICBjb25zdCB7IHN0cmluZywgbWFwIH0gPSBhd2FpdCByZXBsYWNlX2luX2NvZGUodGFnX3JlZ2V4LCBwcm9jZXNzX3NpbmdsZV90YWcsIHNvdXJjZSk7XG4gICAgcmV0dXJuIHsgc3RyaW5nLCBtYXAsIGRlcGVuZGVuY2llcyB9O1xufVxuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc19tYXJrdXAocHJvY2Vzcywgc291cmNlKSB7XG4gICAgY29uc3QgcHJvY2Vzc2VkID0gYXdhaXQgcHJvY2Vzcyh7XG4gICAgICAgIGNvbnRlbnQ6IHNvdXJjZS5zb3VyY2UsXG4gICAgICAgIGZpbGVuYW1lOiBzb3VyY2UuZmlsZW5hbWVcbiAgICB9KTtcbiAgICBpZiAocHJvY2Vzc2VkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdHJpbmc6IHByb2Nlc3NlZC5jb2RlLFxuICAgICAgICAgICAgbWFwOiBwcm9jZXNzZWQubWFwXG4gICAgICAgICAgICAgICAgPyAvLyBUT0RPOiBjYW4gd2UgdXNlIGRlY29kZV9zb3VyY2VtYXA/XG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBwcm9jZXNzZWQubWFwID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgICAgICAgICAgICAgPyBKU09OLnBhcnNlKHByb2Nlc3NlZC5tYXApXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHByb2Nlc3NlZC5tYXBcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGRlcGVuZGVuY2llczogcHJvY2Vzc2VkLmRlcGVuZGVuY2llc1xuICAgICAgICB9O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIHByZXByb2Nlc3Moc291cmNlLCBwcmVwcm9jZXNzb3IsIG9wdGlvbnMpIHtcbiAgICBjb25zdCBmaWxlbmFtZSA9IChvcHRpb25zICYmIG9wdGlvbnMuZmlsZW5hbWUpIHx8IHByZXByb2Nlc3Nvci5maWxlbmFtZTsgLy8gbGVnYWN5XG4gICAgY29uc3QgcHJlcHJvY2Vzc29ycyA9IHByZXByb2Nlc3NvciA/IChBcnJheS5pc0FycmF5KHByZXByb2Nlc3NvcikgPyBwcmVwcm9jZXNzb3IgOiBbcHJlcHJvY2Vzc29yXSkgOiBbXTtcbiAgICBjb25zdCBtYXJrdXAgPSBwcmVwcm9jZXNzb3JzLm1hcChwID0+IHAubWFya3VwKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgY29uc3Qgc2NyaXB0ID0gcHJlcHJvY2Vzc29ycy5tYXAocCA9PiBwLnNjcmlwdCkuZmlsdGVyKEJvb2xlYW4pO1xuICAgIGNvbnN0IHN0eWxlID0gcHJlcHJvY2Vzc29ycy5tYXAocCA9PiBwLnN0eWxlKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IFByZXByb2Nlc3NSZXN1bHQoc291cmNlLCBmaWxlbmFtZSk7XG4gICAgLy8gVE9ETyBrZWVwIHRyYWNrOiB3aGF0IHByZXByb2Nlc3NvciBnZW5lcmF0ZWQgd2hhdCBzb3VyY2VtYXA/XG4gICAgLy8gdG8gbWFrZSBkZWJ1Z2dpbmcgZWFzaWVyID0gZGV0ZWN0IGxvdy1yZXNvbHV0aW9uIHNvdXJjZW1hcHMgaW4gZm4gY29tYmluZV9tYXBwaW5nc1xuICAgIGZvciAoY29uc3QgcHJvY2VzcyBvZiBtYXJrdXApIHtcbiAgICAgICAgcmVzdWx0LnVwZGF0ZV9zb3VyY2UoYXdhaXQgcHJvY2Vzc19tYXJrdXAocHJvY2VzcywgcmVzdWx0KSk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgcHJvY2VzcyBvZiBzY3JpcHQpIHtcbiAgICAgICAgcmVzdWx0LnVwZGF0ZV9zb3VyY2UoYXdhaXQgcHJvY2Vzc190YWcoJ3NjcmlwdCcsIHByb2Nlc3MsIHJlc3VsdCkpO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IHByZXByb2Nlc3Mgb2Ygc3R5bGUpIHtcbiAgICAgICAgcmVzdWx0LnVwZGF0ZV9zb3VyY2UoYXdhaXQgcHJvY2Vzc190YWcoJ3N0eWxlJywgcHJlcHJvY2VzcywgcmVzdWx0KSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQudG9fcHJvY2Vzc2VkKCk7XG59XG5cbmNvbnN0IFZFUlNJT04gPSAnMy41Mi4wJztcbi8vIGFkZGl0aW9uYWwgZXhwb3J0cyBhZGRlZCB0aHJvdWdoIGdlbmVyYXRlLXR5cGUtZGVmaW5pdGlvbnMuanNcblxuZXhwb3J0IHsgVkVSU0lPTiwgY29tcGlsZSwgcGFyc2UkMyBhcyBwYXJzZSwgcHJlcHJvY2Vzcywgd2FsayB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29tcGlsZXIubWpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQXFEQTtBQUdBO0FBR0E7QUFHQTtBQUlBO0FBRUE7QUFVQTtBQVlBO0FBSUE7QUFDQTtBQUNBO0FBWUE7QUFZQTtBQWNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBc0JBO0FBR0E7QUFnQkE7QUFvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFvQkE7QUFzQ0E7QUFFQTtBQXdDQTtBQVFBO0FBRUE7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQVVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUtBO0FBa0RBO0FBaUJBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBZ0JBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFVQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFHQTtBQUlBO0FBQ0E7QUFDQTtBQUlBO0FBSUE7QUFJQTtBQUVBO0FBRUE7QUFHQTtBQUlBO0FBSUE7QUFHQTtBQUNBO0FBQ0E7QUE2RUE7QUFLQTtBQWVBO0FBUUE7QUFFQTtBQVdBO0FBTUE7QUFRQTtBQU1BO0FBZUE7QUFFQTtBQWVBO0FBRUE7QUFNQTtBQWlEQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBNEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQVdBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQVNBO0FBQ0E7QUFFQTtBQU9BO0FBQ0E7QUFDQTtBQXlCQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF5QkE7QUFDQTtBQWlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQXdEQTtBQVdBO0FBQ0E7QUFFQTtBQWNBO0FBQ0E7QUFFQTtBQXdCQTtBQWVBO0FBd0VBO0FBa0JBO0FBQ0E7QUFFQTtBQWtCQTtBQUNBO0FBRUE7QUFjQTtBQUVBO0FBK0JBO0FBNkJBO0FBRUE7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBNEJBO0FBRUE7QUFJQTtBQUNBO0FBMENBO0FBaUNBO0FBRUE7QUFDQTtBQVNBO0FBSUE7QUFtQ0E7QUFTQTtBQUdBO0FBbUJBO0FBZ0ZBO0FBMkJBO0FBR0E7QUFnQkE7QUFpQkE7QUFTQTtBQVFBO0FBSUE7QUF1RUE7QUFHQTtBQXNCQTtBQUdBO0FBY0E7QUFJQTtBQWdEQTtBQVdBO0FBT0E7QUFFQTtBQXNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0E7QUE0Q0E7QUFnQkE7QUFZQTtBQVVBO0FBK0NBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBcUVBO0FBa0JBO0FBdUNBO0FBQ0E7QUFDQTtBQStCQTtBQVFBO0FBOEJBO0FBNENBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFtREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBYUE7QUFFQTtBQUlBO0FBRkE7QUFrQ0E7QUFtQkE7QUFpQkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBUUE7QUFDQTtBQTJCQTtBQXdCQTtBQWtDQTtBQW1HQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUErRkE7QUFDQTtBQWlCQTtBQUNBO0FBR0E7QUFlQTtBQXdDQTtBQTREQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBOEJBO0FBbURBO0FBNEJBO0FBU0E7QUFFQTtBQUlBO0FBMkZBO0FBUUE7QUEyQkE7QUFzQkE7QUFhQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBS0E7QUFDQTtBQUVBO0FBb0JBO0FBRUE7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBaURBO0FBQ0E7QUFFQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBNEJBO0FBV0E7QUEyQkE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQXFCQTtBQUVBO0FBRUE7QUFFQTtBQUtBO0FBU0E7QUFDQTtBQUNBO0FBeUNBO0FBa0JBO0FBcUJBO0FBWUE7QUFnQkE7QUFXQTtBQUNBO0FBRUE7QUFDQTtBQWNBO0FBR0E7QUFzRUE7QUFDQTtBQTZEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFjQTtBQW9CQTtBQU9BO0FBU0E7QUFNQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBZ0JBO0FBS0E7QUFLQTtBQVFBO0FBb0JBO0FBV0E7QUFtQkE7QUFlQTtBQW9EQTtBQWFBO0FBUUE7QUFxQkE7QUFDQTtBQVVBO0FBbUJBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXNCQTtBQVdBO0FBYUE7QUF3QkE7QUErQkE7QUErQkE7QUFpQkE7QUE2Q0E7QUF1QkE7QUFjQTtBQXdDQTtBQUNBO0FBQ0E7QUFJQTtBQVdBO0FBbUJBO0FBQ0E7QUFjQTtBQUNBO0FBY0E7QUFDQTtBQUtBO0FBUUE7QUFNQTtBQUNBO0FBQ0E7QUFnQkE7QUFDQTtBQVNBO0FBb0JBO0FBMkJBO0FBV0E7QUFlQTtBQWVBO0FBNEJBO0FBQ0E7QUFtQkE7QUFlQTtBQUNBO0FBQ0E7QUFnQkE7QUFDQTtBQUVBO0FBYUE7QUFJQTtBQW1CQTtBQWdCQTtBQUVBO0FBQ0E7QUFFQTtBQWNBO0FBQ0E7QUEwQ0E7QUFFQTtBQUtBO0FBY0E7QUFFQTtBQW9CQTtBQUNBO0FBQ0E7QUFFQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQVNBO0FBT0E7QUFLQTtBQVdBO0FBYUE7QUFNQTtBQUtBO0FBV0E7QUFVQTtBQVNBO0FBR0E7QUFPQTtBQW1CQTtBQUVBO0FBY0E7QUFDQTtBQUNBO0FBR0E7QUFXQTtBQUtBO0FBRUE7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBR0E7QUFHQTtBQUdBO0FBR0E7QUFHQTtBQUdBO0FBR0E7QUFpQ0E7QUFNQTtBQUtBO0FBQ0E7QUFNQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQW1CQTtBQVNBO0FBTUE7QUFXQTtBQWNBO0FBS0E7QUFFQTtBQVVBO0FBSUE7QUFrQkE7QUFxQkE7QUErQkE7QUFhQTtBQTRCQTtBQWFBO0FBWEE7QUFzQkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTBDQTtBQUNBO0FBUUE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBU0E7QUFJQTtBQWdCQTtBQUVBO0FBV0E7QUF5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBS0E7QUFDQTtBQUVBO0FBbUVBO0FBQ0E7QUFHQTtBQWlCQTtBQXdDQTtBQXNCQTtBQUlBO0FBOENBO0FBdUNBO0FBV0E7QUF5Q0E7QUFDQTtBQUNBO0FBaU5BO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTJDQTtBQXlDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWlCQTtBQXFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBR0E7QUFHQTtBQUdBO0FBR0E7QUFDQTtBQUlBO0FBNEJBO0FBQ0E7QUFDQTtBQXlGQTtBQUNBO0FBQ0E7QUFDQTtBQTZDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQWtEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQXFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFrQkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQWtFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBY0E7QUFXQTtBQUtBO0FBS0E7QUEyQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFhQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBYUE7QUFDQTtBQUNBO0FBOENBO0FBQ0E7QUFDQTtBQWlEQTtBQXNTQTtBQTJHQTtBQTBJQTtBQW1EQTtBQUNBO0FBNkNBO0FBd0hBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUF1QkE7QUFDQTtBQXNEQTtBQUtBO0FBaUJBO0FBQ0E7QUFzQkE7QUFFQTtBQW1CQTtBQUNBO0FBOERBO0FBQ0E7QUF3Q0E7QUFJQTtBQTBCQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFRQTtBQW9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFnREE7QUFtQkE7QUFrRUE7QUFDQTtBQUNBO0FBY0E7QUE2QkE7QUFDQTtBQUNBO0FBbUJBO0FBQ0E7QUFDQTtBQXFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTJEQTtBQTJEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXFCQTtBQUNBO0FBQ0E7QUFJQTtBQWNBO0FBQ0E7QUFDQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBZ0ZBO0FBYUE7QUFTQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFnQkE7QUFFQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBSEE7QUFRQTtBQUNBO0FBS0E7QUFDQTtBQUtBO0FBQ0E7QUFLQTtBQUNBO0FBS0E7QUFDQTtBQUtBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFLQTtBQUVBO0FBS0E7QUFLQTtBQUlBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFRQTtBQUVBO0FBSUE7QUFFQTtBQUlBO0FBQ0E7QUFJQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBS0E7QUFDQTtBQUNBO0FBSUE7QUFFQTtBQUlBO0FBRUE7QUFJQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUtBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE0RUE7QUFxQkE7QUEyQ0E7QUFFQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBT0E7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUVBO0FBSUE7QUFFQTtBQUtBO0FBQ0E7QUFPQTtBQUlBO0FBQ0E7QUFLQTtBQU1BO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFFQTtBQUlBO0FBQ0E7QUFLQTtBQU1BO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUVBO0FBSUE7QUFDQTtBQUVBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFpR0E7QUFXQTtBQU9BO0FBWUE7QUE4SUE7QUFFQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBTUE7QUFFQTtBQU1BO0FBSUE7QUFJQTtBQUdBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQVFBO0FBS0E7QUFDQTtBQU9BO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFLQTtBQUdBO0FBS0E7QUFFQTtBQUlBO0FBRUE7QUFHQTtBQUdBO0FBQ0E7QUFPQTtBQUVBO0FBT0E7QUFJQTtBQUNBO0FBQ0E7QUFLQTtBQTVDQTtBQWtEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUdBO0FBS0E7QUFFQTtBQUlBO0FBRUE7QUFHQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUtBO0FBRUE7QUFDQTtBQU1BO0FBQ0E7QUFLQTtBQS9EQTtBQXlFQTtBQUlBO0FBU0E7QUFDQTtBQVFBO0FBRUE7QUFLQTtBQUVBO0FBSUE7QUFFQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFPQTtBQUVBO0FBSUE7QUFFQTtBQUtBO0FBRUE7QUFLQTtBQUVBO0FBRUE7QUFHQTtBQU1BO0FBRUE7QUFLQTtBQUVBO0FBSUE7QUFNQTtBQUVBO0FBR0E7QUFRQTtBQUVBO0FBRUE7QUFHQTtBQU9BO0FBRUE7QUFFQTtBQUNBO0FBWUE7QUFFQTtBQUtBO0FBRUE7QUFLQTtBQUVBO0FBSUE7QUFJQTtBQU9BO0FBRUE7QUFFQTtBQUlBO0FBT0E7QUFFQTtBQUtBO0FBRUE7QUFFQTtBQUdBO0FBTUE7QUFFQTtBQUtBO0FBRUE7QUFLQTtBQUVBO0FBS0E7QUFFQTtBQUlBO0FBRUE7QUFJQTtBQUVBO0FBR0E7QUFFQTtBQTBDQTtBQUNBO0FBRUE7QUFPQTtBQVlBO0FBS0E7QUFrQkE7QUFNQTtBQThFQTtBQUNBO0FBeUNBO0FBNkNBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBdUlBO0FBVUE7QUFhQTtBQVVBO0FBYUE7QUFXQTtBQWFBO0FBV0E7QUFpQkE7QUFZQTtBQWVBO0FBWUE7QUEwRUE7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUdBO0FBR0E7QUFDQTtBQUlBO0FBb0JBO0FBQ0E7QUFDQTtBQUlBO0FBS0E7QUFDQTtBQVFBO0FBUUE7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUdBO0FBR0E7QUFDQTtBQUlBO0FBWUE7QUFDQTtBQUNBO0FBMERBO0FBUUE7QUFFQTtBQVlBO0FBRUE7QUFFQTtBQUNBO0FBR0E7QUFHQTtBQUNBO0FBSUE7QUEyRkE7QUFtSUE7QUFHQTtBQXlCQTtBQUNBO0FBNklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQXNDQTtBQWVBO0FBSUE7QUF1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQXdCQTtBQWlCQTtBQXFCQTtBQUNBO0FBY0E7QUFhQTtBQUtBO0FBS0E7QUFLQTtBQVNBO0FBaURBO0FBTUE7QUF3VEE7QUFDQTtBQUNBO0FBMkNBO0FBQ0E7QUEyQ0E7QUFhQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFpQkE7QUFDQTtBQUNBO0FBTUE7QUFZQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBeENBO0FBOENBO0FBU0E7QUFDQTtBQUNBO0FBTUE7QUFZQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBL0NBO0FBa0VBO0FBQ0E7QUFDQTtBQU9BO0FBQUE7QUF1Q0E7QUFDQTtBQUNBO0FBSkE7QUF1RUE7QUFPQTtBQXFCQTtBQXNEQTtBQUdBO0FBbUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQTZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUF3QkE7QUFDQTtBQXVCQTtBQWFBO0FBZ0NBO0FBd0pBO0FBb0JBO0FBZUE7QUFDQTtBQTRCQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBbURBO0FBRUE7QUFDQTtBQW1DQTtBQVlBO0FBRUE7QUFHQTtBQXdEQTtBQXNDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQTBFQTtBQUVBO0FBOEJBO0FBV0E7QUFtQkE7QUFPQTtBQUNBO0FBd0ZBO0FBeUNBO0FBZ0RBO0FBU0E7QUE2UUE7QUE0RkE7QUE4REE7QUE2REE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW9CQTtBQTBHQTtBQW1GQTtBQThCQTtBQVNBO0FBSUE7QUFJQTtBQUNBO0FBQ0E7QUFLQTtBQXVCQTtBQUVBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXdDQTtBQUNBO0FBQ0E7QUFFQTtBQWdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFzQkE7QUFDQTtBQUNBO0FBb0JBO0FBdUJBO0FBK0JBO0FBa0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF5R0E7QUFHQTtBQThDQTtBQXloRUE7QUFpQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBSUE7QUFJQTtBQUNBO0FBSUE7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQU1BO0FBb0JBO0FBQ0E7QUFVQTtBQWtHQTtBQXdEQTtBQWFBO0FBSUE7QUFNQTtBQWdCQTtBQUNBO0FBaUNBO0FBb0hBO0FBNERBO0FBQ0E7QUFDQTtBQTRFQTtBQUNBO0FBcUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW1EQTtBQXlCQTtBQXlDQTtBQWNBO0FBOEJBO0FBdURBO0FBeURBO0FBaUVBO0FBY0E7QUF5QkE7QUFnWEE7QUFDQTtBQXFDQTtBQXFCQTtBQThIQTtBQUNBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBT0E7QUFDQTtBQUlBO0FBQ0E7QUFhQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBR0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQVFBO0FBQ0E7QUFJQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQXNCQTtBQUNBO0FBR0E7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBQ0E7QUF3QkE7QUFDQTtBQW9EQTtBQWlCQTtBQUNBO0FBMkNBO0FBQ0E7QUFDQTtBQXVRQTtBQUVBO0FBd0ZBO0FBd0NBO0FBVUE7QUF5QkE7QUFJQTtBQUdBO0FBSUE7QUFDQTtBQUNBO0FBVUE7QUFVQTtBQVNBO0FBQ0E7QUFDQTtBQXdTQTtBQWVBO0FBR0E7QUFHQTtBQTRDQTtBQXlFQTtBQUVBO0FBQ0E7QUE4QkE7QUEyQ0E7QUFXQTtBQU1BO0FBY0E7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQU9BO0FBSUE7QUFHQTtBQVFBO0FBQ0E7QUF5QkE7QUFDQTtBQUNBO0FBQ0E7QUFjQTtBQUNBO0FBQ0E7QUF5SkE7QUFzSUE7QUFDQTtBQU9BO0FBZ0ZBO0FBV0E7QUFxREE7QUFxRUE7QUFRQTtBQVFBO0FBeUJBO0FBeUZBO0FBeUJBO0FBQ0E7QUFDQTtBQTJDQTtBQUNBO0FBd0JBO0FBQ0E7QUFDQTtBQTBCQTtBQXdCQTtBQUNBO0FBMkNBO0FBK3hMQTtBQTJCQTtBQWtwSEE7QUFDQTtBQUtBO0FBQ0E7QUFNQTtBQUNBO0FBS0E7QUFDQTtBQXFHQTtBQUVBO0FBVUE7QUFFQTtBQXlIQTtBQUdBO0FBR0E7QUF3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBZ0JBO0FBQ0E7QUFTQTtBQXlFQTtBQVVBO0FBQ0E7QUFNQTtBQXNCQTtBQUdBO0FBV0E7QUFhQTtBQUdBO0FBV0E7QUFLQTtBQVFBO0FBV0E7QUFLQTtBQUlBO0FBSUE7QUFJQTtBQUdBO0FBTUE7QUFnQkE7QUFnSEE7QUFpTUE7QUFDQTtBQUtBO0FBOEVBO0FBaURBO0FBbUJBO0FBMkRBO0FBV0E7QUFpR0E7QUFDQTtBQUNBO0FBVUE7QUFDQTtBQXFHQTtBQXVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE4T0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXdCQTtBQTBCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQU1BO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFtSEE7QUFxQkE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBcUNBO0FBSUE7QUFTQTtBQUNBO0FBb0JBO0FBaUJBO0FBNkNBO0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTBEQTtBQThEQTtBQUlBO0FBZ0JBO0FBa0JBO0FBT0E7QUFDQTtBQUNBO0FBZ0JBO0FBUUE7QUFDQTtBQW9CQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFHQTtBQWlFQTtBQUNBO0FBU0E7QUFVQTtBQTBCQTtBQWdFQTtBQXlCQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQWdJQTtBQUNBO0FBaUJBO0FBYUE7QUFNQTtBQUlBO0FBOERBO0FBR0E7QUF3Q0E7QUFpQkE7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQXlIQTtBQUNBO0FBQ0E7QUFlQTtBQU9BO0FBU0E7QUFPQTtBQTZCQTtBQUNBO0FBSUE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFzQkE7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXlCQTtBQStGQTtBQW1EQTtBQTZDQTtBQUNBO0FBQ0E7QUFhQTtBQXNCQTtBQW1CQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBR0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQVlBO0FBT0E7QUFDQTtBQUdBO0FBQ0E7QUEwQkE7QUFDQTtBQUdBO0FBQ0E7QUE0SkE7QUFLQTtBQUtBO0FBQ0E7QUFDQTtBQVFBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUlBO0FBc0NBO0FBc0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFRQTtBQUNBO0FBRUE7QUFDQTtBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFTQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBb0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQW1CQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQVdBO0FBQ0E7QUFDQTtBQTRCQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUF3QkE7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQW1CQTtBQUNBO0FBc0JBO0FBS0E7QUFVQTtBQUNBO0FBT0E7QUFHQTtBQUNBO0FBK0RBO0FBQ0E7QUFnREE7QUFLQTtBQXdDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTJEQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFHQTtBQUNBO0FBSUE7QUFFQTtBQUNBO0FBS0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBSUE7QUFDQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUtBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFtQkE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUlBO0FBQ0E7QUFJQTtBQUNBO0FBNkNBO0FBQ0E7QUFRQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBNEJBO0FBa0NBO0FBQ0E7QUE2RUE7QUFDQTtBQUNBO0FBQ0E7QUF3R0E7QUFnQkE7QUFHQTtBQUVBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQW9EQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBU0E7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFpQkE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUF1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBY0E7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQXNCQTtBQUNBO0FBQ0E7QUFDQTtBQStEQTtBQTZCQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBbUJBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBMEJBO0FBQ0E7QUFFQTtBQUNBO0FBTUE7QUE4QkE7QUFDQTtBQUNBO0FBNkNBO0FBRUE7QUFLQTtBQXFCQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQW1DQTtBQUNBO0FBQ0E7QUFpQkE7QUFDQTtBQU9BO0FBQ0E7QUFTQTtBQW9EQTtBQUlBO0FBR0E7QUFjQTtBQVdBO0FBZUE7QUFDQTtBQVNBO0FBQ0E7QUF3RUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQWtCQTtBQUNBO0FBR0E7QUFNQTtBQVFBO0FBWUE7QUFvQ0E7QUFJQTtBQTBCQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFRQTtBQXVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBVUE7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFHQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBS0E7QUFJQTtBQUdBO0FBQ0E7QUFJQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFJQTtBQUVBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFhQTtBQUNBO0FBT0E7QUFDQTtBQUdBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBUUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFJQTtBQUVBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWFBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUlBO0FBS0E7QUFDQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQVFBO0FBQ0E7QUFDQTtBQUlBO0FBMEJBO0FBc0JBO0FBQ0E7QUFDQTtBQUdBO0FBUUE7QUFPQTtBQU9BO0FBaUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUVBO0FBT0E7QUFDQTtBQUNBO0FBVUE7QUFZQTtBQUNBO0FBQ0E7QUFZQTtBQWNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFHQTtBQUNBO0FBR0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBV0E7QUFDQTtBQWtCQTtBQU9BO0FBUUE7QUFLQTtBQUdBO0FBQ0E7QUFFQTtBQUtBO0FBQ0E7QUFlQTtBQXdCQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFHQTtBQUNBO0FBV0E7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFnQkE7QUFDQTtBQVNBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBVUE7QUFDQTtBQWdCQTtBQUNBO0FBU0E7QUFDQTtBQU9BO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQTBCQTtBQUNBO0FBQ0E7QUFDQTtBQTRCQTtBQUdBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQTJCQTtBQUNBO0FBQ0E7QUFVQTtBQVNBO0FBNEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBT0E7QUFDQTtBQW1CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFlQTtBQUNBO0FBMkJBO0FBeUJBO0FBQ0E7QUFDQTtBQXdCQTtBQTJCQTtBQUNBO0FBQ0E7QUFPQTtBQVlBO0FBa0JBO0FBa0JBO0FBNkJBO0FBZ0RBO0FBQ0E7QUFzQkE7QUFDQTtBQWVBO0FBQ0E7QUFDQTtBQW1CQTtBQUNBO0FBQ0E7QUFnRkE7QUFvQkE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQWtCQTtBQUNBO0FBOERBO0FBQ0E7QUFDQTtBQUNBO0FBOERBO0FBK0ZBO0FBSUE7QUFFQTtBQWlCQTtBQUNBO0FBQ0E7QUFlQTtBQThDQTtBQWVBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEwQkE7QUFDQTtBQUNBO0FBdTNCQTtBQWtCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFnQkE7QUFtRkE7QUFnR0E7QUFDQTtBQUNBO0FBS0E7QUFjQTtBQTZSQTtBQUdBO0FBNkVBO0FBU0E7QUEyREE7QUFrQ0E7QUFHQTtBQWdJQTtBQUdBO0FBd0NBO0FBd0JBO0FBdUVBO0FBbUNBO0FBdURBO0FBK0ZBO0FBOENBO0FBMENBO0FBQ0E7QUFDQTtBQWlCQTtBQTJGQTtBQW9EQTtBQXVEQTtBQTZLQTtBQXFFQTtBQUtBO0FBQ0E7QUFnQ0E7QUFTQTtBQVVBO0FBZ0JBO0FBS0E7QUE4T0E7QUFZQTtBQUdBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUEwQ0E7QUFDQTtBQWVBO0FBMklBO0FBNFJBO0FBa0NBO0FBQ0E7QUFxSEE7QUFVQTtBQVlBO0FBb0dBO0FBb0NBO0FBcUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTJFQTtBQUNBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBWUE7QUFDQTtBQTZDQTtBQWdLQTtBQUNBO0FBdUNBO0FBd0dBO0FBNElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFxQkE7QUFLQTtBQWdDQTtBQVNBO0FBOENBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFJQTtBQWdCQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUdBO0FBSUE7QUFFQTtBQVNBO0FBQ0E7QUFDQTtBQWVBO0FBY0E7QUFDQTtBQW9DQTtBQWFBO0FBTUE7QUFDQTs7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/svelte/compiler.mjs\n");

/***/ }),

/***/ "./node_modules/url/url.js":
/*!*********************************!*\
  !*** ./node_modules/url/url.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n\n\nvar punycode = __webpack_require__(/*! punycode */ \"./node_modules/punycode/punycode.js\");\nvar util = __webpack_require__(/*! ./util */ \"./node_modules/url/util.js\");\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = __webpack_require__(/*! querystring */ \"./node_modules/querystring-es3/index.js\");\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && util.isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!util.isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  // Copy chrome, IE, opera backslash-handling behavior.\n  // Back slashes before the query string get converted to forward slashes\n  // See: https://code.google.com/p/chromium/issues/detail?id=25916\n  var queryIndex = url.indexOf('?'),\n      splitter =\n          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',\n      uSplit = url.split(splitter),\n      slashRegex = /\\\\/g;\n  uSplit[0] = uSplit[0].replace(slashRegex, '/');\n  url = uSplit.join(splitter);\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.path = rest;\n      this.href = rest;\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n        if (parseQueryString) {\n          this.query = querystring.parse(this.search.substr(1));\n        } else {\n          this.query = this.search.substr(1);\n        }\n      } else if (parseQueryString) {\n        this.search = '';\n        this.query = {};\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a punycoded representation of \"domain\".\n      // It only converts parts of the domain name that\n      // have non-ASCII characters, i.e. it doesn't matter if\n      // you call it with a domain that already is ASCII-only.\n      this.hostname = punycode.toASCII(this.hostname);\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      if (rest.indexOf(ae) === -1)\n        continue;\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (util.isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      util.isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (util.isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  var tkeys = Object.keys(this);\n  for (var tk = 0; tk < tkeys.length; tk++) {\n    var tkey = tkeys[tk];\n    result[tkey] = this[tkey];\n  }\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    var rkeys = Object.keys(relative);\n    for (var rk = 0; rk < rkeys.length; rk++) {\n      var rkey = rkeys[rk];\n      if (rkey !== 'protocol')\n        result[rkey] = relative[rkey];\n    }\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      var keys = Object.keys(relative);\n      for (var v = 0; v < keys.length; v++) {\n        var k = keys[v];\n        result[k] = relative[k];\n      }\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!util.isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especially happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host || srcPath.length > 1) &&\n      (last === '.' || last === '..') || last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last === '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especially happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdXJsL3VybC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy91cmwvdXJsLmpzPzBiMTYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIHB1bnljb2RlID0gcmVxdWlyZSgncHVueWNvZGUnKTtcbnZhciB1dGlsID0gcmVxdWlyZSgnLi91dGlsJyk7XG5cbmV4cG9ydHMucGFyc2UgPSB1cmxQYXJzZTtcbmV4cG9ydHMucmVzb2x2ZSA9IHVybFJlc29sdmU7XG5leHBvcnRzLnJlc29sdmVPYmplY3QgPSB1cmxSZXNvbHZlT2JqZWN0O1xuZXhwb3J0cy5mb3JtYXQgPSB1cmxGb3JtYXQ7XG5cbmV4cG9ydHMuVXJsID0gVXJsO1xuXG5mdW5jdGlvbiBVcmwoKSB7XG4gIHRoaXMucHJvdG9jb2wgPSBudWxsO1xuICB0aGlzLnNsYXNoZXMgPSBudWxsO1xuICB0aGlzLmF1dGggPSBudWxsO1xuICB0aGlzLmhvc3QgPSBudWxsO1xuICB0aGlzLnBvcnQgPSBudWxsO1xuICB0aGlzLmhvc3RuYW1lID0gbnVsbDtcbiAgdGhpcy5oYXNoID0gbnVsbDtcbiAgdGhpcy5zZWFyY2ggPSBudWxsO1xuICB0aGlzLnF1ZXJ5ID0gbnVsbDtcbiAgdGhpcy5wYXRobmFtZSA9IG51bGw7XG4gIHRoaXMucGF0aCA9IG51bGw7XG4gIHRoaXMuaHJlZiA9IG51bGw7XG59XG5cbi8vIFJlZmVyZW5jZTogUkZDIDM5ODYsIFJGQyAxODA4LCBSRkMgMjM5NlxuXG4vLyBkZWZpbmUgdGhlc2UgaGVyZSBzbyBhdCBsZWFzdCB0aGV5IG9ubHkgaGF2ZSB0byBiZVxuLy8gY29tcGlsZWQgb25jZSBvbiB0aGUgZmlyc3QgbW9kdWxlIGxvYWQuXG52YXIgcHJvdG9jb2xQYXR0ZXJuID0gL14oW2EtejAtOS4rLV0rOikvaSxcbiAgICBwb3J0UGF0dGVybiA9IC86WzAtOV0qJC8sXG5cbiAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIGEgc2ltcGxlIHBhdGggVVJMXG4gICAgc2ltcGxlUGF0aFBhdHRlcm4gPSAvXihcXC9cXC8/KD8hXFwvKVteXFw/XFxzXSopKFxcP1teXFxzXSopPyQvLFxuXG4gICAgLy8gUkZDIDIzOTY6IGNoYXJhY3RlcnMgcmVzZXJ2ZWQgZm9yIGRlbGltaXRpbmcgVVJMcy5cbiAgICAvLyBXZSBhY3R1YWxseSBqdXN0IGF1dG8tZXNjYXBlIHRoZXNlLlxuICAgIGRlbGltcyA9IFsnPCcsICc+JywgJ1wiJywgJ2AnLCAnICcsICdcXHInLCAnXFxuJywgJ1xcdCddLFxuXG4gICAgLy8gUkZDIDIzOTY6IGNoYXJhY3RlcnMgbm90IGFsbG93ZWQgZm9yIHZhcmlvdXMgcmVhc29ucy5cbiAgICB1bndpc2UgPSBbJ3snLCAnfScsICd8JywgJ1xcXFwnLCAnXicsICdgJ10uY29uY2F0KGRlbGltcyksXG5cbiAgICAvLyBBbGxvd2VkIGJ5IFJGQ3MsIGJ1dCBjYXVzZSBvZiBYU1MgYXR0YWNrcy4gIEFsd2F5cyBlc2NhcGUgdGhlc2UuXG4gICAgYXV0b0VzY2FwZSA9IFsnXFwnJ10uY29uY2F0KHVud2lzZSksXG4gICAgLy8gQ2hhcmFjdGVycyB0aGF0IGFyZSBuZXZlciBldmVyIGFsbG93ZWQgaW4gYSBob3N0bmFtZS5cbiAgICAvLyBOb3RlIHRoYXQgYW55IGludmFsaWQgY2hhcnMgYXJlIGFsc28gaGFuZGxlZCwgYnV0IHRoZXNlXG4gICAgLy8gYXJlIHRoZSBvbmVzIHRoYXQgYXJlICpleHBlY3RlZCogdG8gYmUgc2Vlbiwgc28gd2UgZmFzdC1wYXRoXG4gICAgLy8gdGhlbS5cbiAgICBub25Ib3N0Q2hhcnMgPSBbJyUnLCAnLycsICc/JywgJzsnLCAnIyddLmNvbmNhdChhdXRvRXNjYXBlKSxcbiAgICBob3N0RW5kaW5nQ2hhcnMgPSBbJy8nLCAnPycsICcjJ10sXG4gICAgaG9zdG5hbWVNYXhMZW4gPSAyNTUsXG4gICAgaG9zdG5hbWVQYXJ0UGF0dGVybiA9IC9eWythLXowLTlBLVpfLV17MCw2M30kLyxcbiAgICBob3N0bmFtZVBhcnRTdGFydCA9IC9eKFsrYS16MC05QS1aXy1dezAsNjN9KSguKikkLyxcbiAgICAvLyBwcm90b2NvbHMgdGhhdCBjYW4gYWxsb3cgXCJ1bnNhZmVcIiBhbmQgXCJ1bndpc2VcIiBjaGFycy5cbiAgICB1bnNhZmVQcm90b2NvbCA9IHtcbiAgICAgICdqYXZhc2NyaXB0JzogdHJ1ZSxcbiAgICAgICdqYXZhc2NyaXB0Oic6IHRydWVcbiAgICB9LFxuICAgIC8vIHByb3RvY29scyB0aGF0IG5ldmVyIGhhdmUgYSBob3N0bmFtZS5cbiAgICBob3N0bGVzc1Byb3RvY29sID0ge1xuICAgICAgJ2phdmFzY3JpcHQnOiB0cnVlLFxuICAgICAgJ2phdmFzY3JpcHQ6JzogdHJ1ZVxuICAgIH0sXG4gICAgLy8gcHJvdG9jb2xzIHRoYXQgYWx3YXlzIGNvbnRhaW4gYSAvLyBiaXQuXG4gICAgc2xhc2hlZFByb3RvY29sID0ge1xuICAgICAgJ2h0dHAnOiB0cnVlLFxuICAgICAgJ2h0dHBzJzogdHJ1ZSxcbiAgICAgICdmdHAnOiB0cnVlLFxuICAgICAgJ2dvcGhlcic6IHRydWUsXG4gICAgICAnZmlsZSc6IHRydWUsXG4gICAgICAnaHR0cDonOiB0cnVlLFxuICAgICAgJ2h0dHBzOic6IHRydWUsXG4gICAgICAnZnRwOic6IHRydWUsXG4gICAgICAnZ29waGVyOic6IHRydWUsXG4gICAgICAnZmlsZTonOiB0cnVlXG4gICAgfSxcbiAgICBxdWVyeXN0cmluZyA9IHJlcXVpcmUoJ3F1ZXJ5c3RyaW5nJyk7XG5cbmZ1bmN0aW9uIHVybFBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpIHtcbiAgaWYgKHVybCAmJiB1dGlsLmlzT2JqZWN0KHVybCkgJiYgdXJsIGluc3RhbmNlb2YgVXJsKSByZXR1cm4gdXJsO1xuXG4gIHZhciB1ID0gbmV3IFVybDtcbiAgdS5wYXJzZSh1cmwsIHBhcnNlUXVlcnlTdHJpbmcsIHNsYXNoZXNEZW5vdGVIb3N0KTtcbiAgcmV0dXJuIHU7XG59XG5cblVybC5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbih1cmwsIHBhcnNlUXVlcnlTdHJpbmcsIHNsYXNoZXNEZW5vdGVIb3N0KSB7XG4gIGlmICghdXRpbC5pc1N0cmluZyh1cmwpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlBhcmFtZXRlciAndXJsJyBtdXN0IGJlIGEgc3RyaW5nLCBub3QgXCIgKyB0eXBlb2YgdXJsKTtcbiAgfVxuXG4gIC8vIENvcHkgY2hyb21lLCBJRSwgb3BlcmEgYmFja3NsYXNoLWhhbmRsaW5nIGJlaGF2aW9yLlxuICAvLyBCYWNrIHNsYXNoZXMgYmVmb3JlIHRoZSBxdWVyeSBzdHJpbmcgZ2V0IGNvbnZlcnRlZCB0byBmb3J3YXJkIHNsYXNoZXNcbiAgLy8gU2VlOiBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MjU5MTZcbiAgdmFyIHF1ZXJ5SW5kZXggPSB1cmwuaW5kZXhPZignPycpLFxuICAgICAgc3BsaXR0ZXIgPVxuICAgICAgICAgIChxdWVyeUluZGV4ICE9PSAtMSAmJiBxdWVyeUluZGV4IDwgdXJsLmluZGV4T2YoJyMnKSkgPyAnPycgOiAnIycsXG4gICAgICB1U3BsaXQgPSB1cmwuc3BsaXQoc3BsaXR0ZXIpLFxuICAgICAgc2xhc2hSZWdleCA9IC9cXFxcL2c7XG4gIHVTcGxpdFswXSA9IHVTcGxpdFswXS5yZXBsYWNlKHNsYXNoUmVnZXgsICcvJyk7XG4gIHVybCA9IHVTcGxpdC5qb2luKHNwbGl0dGVyKTtcblxuICB2YXIgcmVzdCA9IHVybDtcblxuICAvLyB0cmltIGJlZm9yZSBwcm9jZWVkaW5nLlxuICAvLyBUaGlzIGlzIHRvIHN1cHBvcnQgcGFyc2Ugc3R1ZmYgbGlrZSBcIiAgaHR0cDovL2Zvby5jb20gIFxcblwiXG4gIHJlc3QgPSByZXN0LnRyaW0oKTtcblxuICBpZiAoIXNsYXNoZXNEZW5vdGVIb3N0ICYmIHVybC5zcGxpdCgnIycpLmxlbmd0aCA9PT0gMSkge1xuICAgIC8vIFRyeSBmYXN0IHBhdGggcmVnZXhwXG4gICAgdmFyIHNpbXBsZVBhdGggPSBzaW1wbGVQYXRoUGF0dGVybi5leGVjKHJlc3QpO1xuICAgIGlmIChzaW1wbGVQYXRoKSB7XG4gICAgICB0aGlzLnBhdGggPSByZXN0O1xuICAgICAgdGhpcy5ocmVmID0gcmVzdDtcbiAgICAgIHRoaXMucGF0aG5hbWUgPSBzaW1wbGVQYXRoWzFdO1xuICAgICAgaWYgKHNpbXBsZVBhdGhbMl0pIHtcbiAgICAgICAgdGhpcy5zZWFyY2ggPSBzaW1wbGVQYXRoWzJdO1xuICAgICAgICBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeXN0cmluZy5wYXJzZSh0aGlzLnNlYXJjaC5zdWJzdHIoMSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucXVlcnkgPSB0aGlzLnNlYXJjaC5zdWJzdHIoMSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgICAgICB0aGlzLnNlYXJjaCA9ICcnO1xuICAgICAgICB0aGlzLnF1ZXJ5ID0ge307XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH1cblxuICB2YXIgcHJvdG8gPSBwcm90b2NvbFBhdHRlcm4uZXhlYyhyZXN0KTtcbiAgaWYgKHByb3RvKSB7XG4gICAgcHJvdG8gPSBwcm90b1swXTtcbiAgICB2YXIgbG93ZXJQcm90byA9IHByb3RvLnRvTG93ZXJDYXNlKCk7XG4gICAgdGhpcy5wcm90b2NvbCA9IGxvd2VyUHJvdG87XG4gICAgcmVzdCA9IHJlc3Quc3Vic3RyKHByb3RvLmxlbmd0aCk7XG4gIH1cblxuICAvLyBmaWd1cmUgb3V0IGlmIGl0J3MgZ290IGEgaG9zdFxuICAvLyB1c2VyQHNlcnZlciBpcyAqYWx3YXlzKiBpbnRlcnByZXRlZCBhcyBhIGhvc3RuYW1lLCBhbmQgdXJsXG4gIC8vIHJlc29sdXRpb24gd2lsbCB0cmVhdCAvL2Zvby9iYXIgYXMgaG9zdD1mb28scGF0aD1iYXIgYmVjYXVzZSB0aGF0J3NcbiAgLy8gaG93IHRoZSBicm93c2VyIHJlc29sdmVzIHJlbGF0aXZlIFVSTHMuXG4gIGlmIChzbGFzaGVzRGVub3RlSG9zdCB8fCBwcm90byB8fCByZXN0Lm1hdGNoKC9eXFwvXFwvW15AXFwvXStAW15AXFwvXSsvKSkge1xuICAgIHZhciBzbGFzaGVzID0gcmVzdC5zdWJzdHIoMCwgMikgPT09ICcvLyc7XG4gICAgaWYgKHNsYXNoZXMgJiYgIShwcm90byAmJiBob3N0bGVzc1Byb3RvY29sW3Byb3RvXSkpIHtcbiAgICAgIHJlc3QgPSByZXN0LnN1YnN0cigyKTtcbiAgICAgIHRoaXMuc2xhc2hlcyA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFob3N0bGVzc1Byb3RvY29sW3Byb3RvXSAmJlxuICAgICAgKHNsYXNoZXMgfHwgKHByb3RvICYmICFzbGFzaGVkUHJvdG9jb2xbcHJvdG9dKSkpIHtcblxuICAgIC8vIHRoZXJlJ3MgYSBob3N0bmFtZS5cbiAgICAvLyB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgLywgPywgOywgb3IgIyBlbmRzIHRoZSBob3N0LlxuICAgIC8vXG4gICAgLy8gSWYgdGhlcmUgaXMgYW4gQCBpbiB0aGUgaG9zdG5hbWUsIHRoZW4gbm9uLWhvc3QgY2hhcnMgKmFyZSogYWxsb3dlZFxuICAgIC8vIHRvIHRoZSBsZWZ0IG9mIHRoZSBsYXN0IEAgc2lnbiwgdW5sZXNzIHNvbWUgaG9zdC1lbmRpbmcgY2hhcmFjdGVyXG4gICAgLy8gY29tZXMgKmJlZm9yZSogdGhlIEAtc2lnbi5cbiAgICAvLyBVUkxzIGFyZSBvYm5veGlvdXMuXG4gICAgLy9cbiAgICAvLyBleDpcbiAgICAvLyBodHRwOi8vYUBiQGMvID0+IHVzZXI6YUBiIGhvc3Q6Y1xuICAgIC8vIGh0dHA6Ly9hQGI/QGMgPT4gdXNlcjphIGhvc3Q6YyBwYXRoOi8/QGNcblxuICAgIC8vIHYwLjEyIFRPRE8oaXNhYWNzKTogVGhpcyBpcyBub3QgcXVpdGUgaG93IENocm9tZSBkb2VzIHRoaW5ncy5cbiAgICAvLyBSZXZpZXcgb3VyIHRlc3QgY2FzZSBhZ2FpbnN0IGJyb3dzZXJzIG1vcmUgY29tcHJlaGVuc2l2ZWx5LlxuXG4gICAgLy8gZmluZCB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgYW55IGhvc3RFbmRpbmdDaGFyc1xuICAgIHZhciBob3N0RW5kID0gLTE7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBob3N0RW5kaW5nQ2hhcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBoZWMgPSByZXN0LmluZGV4T2YoaG9zdEVuZGluZ0NoYXJzW2ldKTtcbiAgICAgIGlmIChoZWMgIT09IC0xICYmIChob3N0RW5kID09PSAtMSB8fCBoZWMgPCBob3N0RW5kKSlcbiAgICAgICAgaG9zdEVuZCA9IGhlYztcbiAgICB9XG5cbiAgICAvLyBhdCB0aGlzIHBvaW50LCBlaXRoZXIgd2UgaGF2ZSBhbiBleHBsaWNpdCBwb2ludCB3aGVyZSB0aGVcbiAgICAvLyBhdXRoIHBvcnRpb24gY2Fubm90IGdvIHBhc3QsIG9yIHRoZSBsYXN0IEAgY2hhciBpcyB0aGUgZGVjaWRlci5cbiAgICB2YXIgYXV0aCwgYXRTaWduO1xuICAgIGlmIChob3N0RW5kID09PSAtMSkge1xuICAgICAgLy8gYXRTaWduIGNhbiBiZSBhbnl3aGVyZS5cbiAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYXRTaWduIG11c3QgYmUgaW4gYXV0aCBwb3J0aW9uLlxuICAgICAgLy8gaHR0cDovL2FAYi9jQGQgPT4gaG9zdDpiIGF1dGg6YSBwYXRoOi9jQGRcbiAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnLCBob3N0RW5kKTtcbiAgICB9XG5cbiAgICAvLyBOb3cgd2UgaGF2ZSBhIHBvcnRpb24gd2hpY2ggaXMgZGVmaW5pdGVseSB0aGUgYXV0aC5cbiAgICAvLyBQdWxsIHRoYXQgb2ZmLlxuICAgIGlmIChhdFNpZ24gIT09IC0xKSB7XG4gICAgICBhdXRoID0gcmVzdC5zbGljZSgwLCBhdFNpZ24pO1xuICAgICAgcmVzdCA9IHJlc3Quc2xpY2UoYXRTaWduICsgMSk7XG4gICAgICB0aGlzLmF1dGggPSBkZWNvZGVVUklDb21wb25lbnQoYXV0aCk7XG4gICAgfVxuXG4gICAgLy8gdGhlIGhvc3QgaXMgdGhlIHJlbWFpbmluZyB0byB0aGUgbGVmdCBvZiB0aGUgZmlyc3Qgbm9uLWhvc3QgY2hhclxuICAgIGhvc3RFbmQgPSAtMTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vbkhvc3RDaGFycy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGhlYyA9IHJlc3QuaW5kZXhPZihub25Ib3N0Q2hhcnNbaV0pO1xuICAgICAgaWYgKGhlYyAhPT0gLTEgJiYgKGhvc3RFbmQgPT09IC0xIHx8IGhlYyA8IGhvc3RFbmQpKVxuICAgICAgICBob3N0RW5kID0gaGVjO1xuICAgIH1cbiAgICAvLyBpZiB3ZSBzdGlsbCBoYXZlIG5vdCBoaXQgaXQsIHRoZW4gdGhlIGVudGlyZSB0aGluZyBpcyBhIGhvc3QuXG4gICAgaWYgKGhvc3RFbmQgPT09IC0xKVxuICAgICAgaG9zdEVuZCA9IHJlc3QubGVuZ3RoO1xuXG4gICAgdGhpcy5ob3N0ID0gcmVzdC5zbGljZSgwLCBob3N0RW5kKTtcbiAgICByZXN0ID0gcmVzdC5zbGljZShob3N0RW5kKTtcblxuICAgIC8vIHB1bGwgb3V0IHBvcnQuXG4gICAgdGhpcy5wYXJzZUhvc3QoKTtcblxuICAgIC8vIHdlJ3ZlIGluZGljYXRlZCB0aGF0IHRoZXJlIGlzIGEgaG9zdG5hbWUsXG4gICAgLy8gc28gZXZlbiBpZiBpdCdzIGVtcHR5LCBpdCBoYXMgdG8gYmUgcHJlc2VudC5cbiAgICB0aGlzLmhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZSB8fCAnJztcblxuICAgIC8vIGlmIGhvc3RuYW1lIGJlZ2lucyB3aXRoIFsgYW5kIGVuZHMgd2l0aCBdXG4gICAgLy8gYXNzdW1lIHRoYXQgaXQncyBhbiBJUHY2IGFkZHJlc3MuXG4gICAgdmFyIGlwdjZIb3N0bmFtZSA9IHRoaXMuaG9zdG5hbWVbMF0gPT09ICdbJyAmJlxuICAgICAgICB0aGlzLmhvc3RuYW1lW3RoaXMuaG9zdG5hbWUubGVuZ3RoIC0gMV0gPT09ICddJztcblxuICAgIC8vIHZhbGlkYXRlIGEgbGl0dGxlLlxuICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7XG4gICAgICB2YXIgaG9zdHBhcnRzID0gdGhpcy5ob3N0bmFtZS5zcGxpdCgvXFwuLyk7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGhvc3RwYXJ0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgdmFyIHBhcnQgPSBob3N0cGFydHNbaV07XG4gICAgICAgIGlmICghcGFydCkgY29udGludWU7XG4gICAgICAgIGlmICghcGFydC5tYXRjaChob3N0bmFtZVBhcnRQYXR0ZXJuKSkge1xuICAgICAgICAgIHZhciBuZXdwYXJ0ID0gJyc7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGsgPSBwYXJ0Lmxlbmd0aDsgaiA8IGs7IGorKykge1xuICAgICAgICAgICAgaWYgKHBhcnQuY2hhckNvZGVBdChqKSA+IDEyNykge1xuICAgICAgICAgICAgICAvLyB3ZSByZXBsYWNlIG5vbi1BU0NJSSBjaGFyIHdpdGggYSB0ZW1wb3JhcnkgcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0aGlzIHRvIG1ha2Ugc3VyZSBzaXplIG9mIGhvc3RuYW1lIGlzIG5vdFxuICAgICAgICAgICAgICAvLyBicm9rZW4gYnkgcmVwbGFjaW5nIG5vbi1BU0NJSSBieSBub3RoaW5nXG4gICAgICAgICAgICAgIG5ld3BhcnQgKz0gJ3gnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbmV3cGFydCArPSBwYXJ0W2pdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyB3ZSB0ZXN0IGFnYWluIHdpdGggQVNDSUkgY2hhciBvbmx5XG4gICAgICAgICAgaWYgKCFuZXdwYXJ0Lm1hdGNoKGhvc3RuYW1lUGFydFBhdHRlcm4pKSB7XG4gICAgICAgICAgICB2YXIgdmFsaWRQYXJ0cyA9IGhvc3RwYXJ0cy5zbGljZSgwLCBpKTtcbiAgICAgICAgICAgIHZhciBub3RIb3N0ID0gaG9zdHBhcnRzLnNsaWNlKGkgKyAxKTtcbiAgICAgICAgICAgIHZhciBiaXQgPSBwYXJ0Lm1hdGNoKGhvc3RuYW1lUGFydFN0YXJ0KTtcbiAgICAgICAgICAgIGlmIChiaXQpIHtcbiAgICAgICAgICAgICAgdmFsaWRQYXJ0cy5wdXNoKGJpdFsxXSk7XG4gICAgICAgICAgICAgIG5vdEhvc3QudW5zaGlmdChiaXRbMl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5vdEhvc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHJlc3QgPSAnLycgKyBub3RIb3N0LmpvaW4oJy4nKSArIHJlc3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmhvc3RuYW1lID0gdmFsaWRQYXJ0cy5qb2luKCcuJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5ob3N0bmFtZS5sZW5ndGggPiBob3N0bmFtZU1heExlbikge1xuICAgICAgdGhpcy5ob3N0bmFtZSA9ICcnO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBob3N0bmFtZXMgYXJlIGFsd2F5cyBsb3dlciBjYXNlLlxuICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICB9XG5cbiAgICBpZiAoIWlwdjZIb3N0bmFtZSkge1xuICAgICAgLy8gSUROQSBTdXBwb3J0OiBSZXR1cm5zIGEgcHVueWNvZGVkIHJlcHJlc2VudGF0aW9uIG9mIFwiZG9tYWluXCIuXG4gICAgICAvLyBJdCBvbmx5IGNvbnZlcnRzIHBhcnRzIG9mIHRoZSBkb21haW4gbmFtZSB0aGF0XG4gICAgICAvLyBoYXZlIG5vbi1BU0NJSSBjaGFyYWN0ZXJzLCBpLmUuIGl0IGRvZXNuJ3QgbWF0dGVyIGlmXG4gICAgICAvLyB5b3UgY2FsbCBpdCB3aXRoIGEgZG9tYWluIHRoYXQgYWxyZWFkeSBpcyBBU0NJSS1vbmx5LlxuICAgICAgdGhpcy5ob3N0bmFtZSA9IHB1bnljb2RlLnRvQVNDSUkodGhpcy5ob3N0bmFtZSk7XG4gICAgfVxuXG4gICAgdmFyIHAgPSB0aGlzLnBvcnQgPyAnOicgKyB0aGlzLnBvcnQgOiAnJztcbiAgICB2YXIgaCA9IHRoaXMuaG9zdG5hbWUgfHwgJyc7XG4gICAgdGhpcy5ob3N0ID0gaCArIHA7XG4gICAgdGhpcy5ocmVmICs9IHRoaXMuaG9zdDtcblxuICAgIC8vIHN0cmlwIFsgYW5kIF0gZnJvbSB0aGUgaG9zdG5hbWVcbiAgICAvLyB0aGUgaG9zdCBmaWVsZCBzdGlsbCByZXRhaW5zIHRoZW0sIHRob3VnaFxuICAgIGlmIChpcHY2SG9zdG5hbWUpIHtcbiAgICAgIHRoaXMuaG9zdG5hbWUgPSB0aGlzLmhvc3RuYW1lLnN1YnN0cigxLCB0aGlzLmhvc3RuYW1lLmxlbmd0aCAtIDIpO1xuICAgICAgaWYgKHJlc3RbMF0gIT09ICcvJykge1xuICAgICAgICByZXN0ID0gJy8nICsgcmVzdDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBub3cgcmVzdCBpcyBzZXQgdG8gdGhlIHBvc3QtaG9zdCBzdHVmZi5cbiAgLy8gY2hvcCBvZmYgYW55IGRlbGltIGNoYXJzLlxuICBpZiAoIXVuc2FmZVByb3RvY29sW2xvd2VyUHJvdG9dKSB7XG5cbiAgICAvLyBGaXJzdCwgbWFrZSAxMDAlIHN1cmUgdGhhdCBhbnkgXCJhdXRvRXNjYXBlXCIgY2hhcnMgZ2V0XG4gICAgLy8gZXNjYXBlZCwgZXZlbiBpZiBlbmNvZGVVUklDb21wb25lbnQgZG9lc24ndCB0aGluayB0aGV5XG4gICAgLy8gbmVlZCB0byBiZS5cbiAgICBmb3IgKHZhciBpID0gMCwgbCA9IGF1dG9Fc2NhcGUubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICB2YXIgYWUgPSBhdXRvRXNjYXBlW2ldO1xuICAgICAgaWYgKHJlc3QuaW5kZXhPZihhZSkgPT09IC0xKVxuICAgICAgICBjb250aW51ZTtcbiAgICAgIHZhciBlc2MgPSBlbmNvZGVVUklDb21wb25lbnQoYWUpO1xuICAgICAgaWYgKGVzYyA9PT0gYWUpIHtcbiAgICAgICAgZXNjID0gZXNjYXBlKGFlKTtcbiAgICAgIH1cbiAgICAgIHJlc3QgPSByZXN0LnNwbGl0KGFlKS5qb2luKGVzYyk7XG4gICAgfVxuICB9XG5cblxuICAvLyBjaG9wIG9mZiBmcm9tIHRoZSB0YWlsIGZpcnN0LlxuICB2YXIgaGFzaCA9IHJlc3QuaW5kZXhPZignIycpO1xuICBpZiAoaGFzaCAhPT0gLTEpIHtcbiAgICAvLyBnb3QgYSBmcmFnbWVudCBzdHJpbmcuXG4gICAgdGhpcy5oYXNoID0gcmVzdC5zdWJzdHIoaGFzaCk7XG4gICAgcmVzdCA9IHJlc3Quc2xpY2UoMCwgaGFzaCk7XG4gIH1cbiAgdmFyIHFtID0gcmVzdC5pbmRleE9mKCc/Jyk7XG4gIGlmIChxbSAhPT0gLTEpIHtcbiAgICB0aGlzLnNlYXJjaCA9IHJlc3Quc3Vic3RyKHFtKTtcbiAgICB0aGlzLnF1ZXJ5ID0gcmVzdC5zdWJzdHIocW0gKyAxKTtcbiAgICBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5c3RyaW5nLnBhcnNlKHRoaXMucXVlcnkpO1xuICAgIH1cbiAgICByZXN0ID0gcmVzdC5zbGljZSgwLCBxbSk7XG4gIH0gZWxzZSBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgIC8vIG5vIHF1ZXJ5IHN0cmluZywgYnV0IHBhcnNlUXVlcnlTdHJpbmcgc3RpbGwgcmVxdWVzdGVkXG4gICAgdGhpcy5zZWFyY2ggPSAnJztcbiAgICB0aGlzLnF1ZXJ5ID0ge307XG4gIH1cbiAgaWYgKHJlc3QpIHRoaXMucGF0aG5hbWUgPSByZXN0O1xuICBpZiAoc2xhc2hlZFByb3RvY29sW2xvd2VyUHJvdG9dICYmXG4gICAgICB0aGlzLmhvc3RuYW1lICYmICF0aGlzLnBhdGhuYW1lKSB7XG4gICAgdGhpcy5wYXRobmFtZSA9ICcvJztcbiAgfVxuXG4gIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3RcbiAgaWYgKHRoaXMucGF0aG5hbWUgfHwgdGhpcy5zZWFyY2gpIHtcbiAgICB2YXIgcCA9IHRoaXMucGF0aG5hbWUgfHwgJyc7XG4gICAgdmFyIHMgPSB0aGlzLnNlYXJjaCB8fCAnJztcbiAgICB0aGlzLnBhdGggPSBwICsgcztcbiAgfVxuXG4gIC8vIGZpbmFsbHksIHJlY29uc3RydWN0IHRoZSBocmVmIGJhc2VkIG9uIHdoYXQgaGFzIGJlZW4gdmFsaWRhdGVkLlxuICB0aGlzLmhyZWYgPSB0aGlzLmZvcm1hdCgpO1xuICByZXR1cm4gdGhpcztcbn07XG5cbi8vIGZvcm1hdCBhIHBhcnNlZCBvYmplY3QgaW50byBhIHVybCBzdHJpbmdcbmZ1bmN0aW9uIHVybEZvcm1hdChvYmopIHtcbiAgLy8gZW5zdXJlIGl0J3MgYW4gb2JqZWN0LCBhbmQgbm90IGEgc3RyaW5nIHVybC5cbiAgLy8gSWYgaXQncyBhbiBvYmosIHRoaXMgaXMgYSBuby1vcC5cbiAgLy8gdGhpcyB3YXksIHlvdSBjYW4gY2FsbCB1cmxfZm9ybWF0KCkgb24gc3RyaW5nc1xuICAvLyB0byBjbGVhbiB1cCBwb3RlbnRpYWxseSB3b25reSB1cmxzLlxuICBpZiAodXRpbC5pc1N0cmluZyhvYmopKSBvYmogPSB1cmxQYXJzZShvYmopO1xuICBpZiAoIShvYmogaW5zdGFuY2VvZiBVcmwpKSByZXR1cm4gVXJsLnByb3RvdHlwZS5mb3JtYXQuY2FsbChvYmopO1xuICByZXR1cm4gb2JqLmZvcm1hdCgpO1xufVxuXG5VcmwucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgYXV0aCA9IHRoaXMuYXV0aCB8fCAnJztcbiAgaWYgKGF1dGgpIHtcbiAgICBhdXRoID0gZW5jb2RlVVJJQ29tcG9uZW50KGF1dGgpO1xuICAgIGF1dGggPSBhdXRoLnJlcGxhY2UoLyUzQS9pLCAnOicpO1xuICAgIGF1dGggKz0gJ0AnO1xuICB9XG5cbiAgdmFyIHByb3RvY29sID0gdGhpcy5wcm90b2NvbCB8fCAnJyxcbiAgICAgIHBhdGhuYW1lID0gdGhpcy5wYXRobmFtZSB8fCAnJyxcbiAgICAgIGhhc2ggPSB0aGlzLmhhc2ggfHwgJycsXG4gICAgICBob3N0ID0gZmFsc2UsXG4gICAgICBxdWVyeSA9ICcnO1xuXG4gIGlmICh0aGlzLmhvc3QpIHtcbiAgICBob3N0ID0gYXV0aCArIHRoaXMuaG9zdDtcbiAgfSBlbHNlIGlmICh0aGlzLmhvc3RuYW1lKSB7XG4gICAgaG9zdCA9IGF1dGggKyAodGhpcy5ob3N0bmFtZS5pbmRleE9mKCc6JykgPT09IC0xID9cbiAgICAgICAgdGhpcy5ob3N0bmFtZSA6XG4gICAgICAgICdbJyArIHRoaXMuaG9zdG5hbWUgKyAnXScpO1xuICAgIGlmICh0aGlzLnBvcnQpIHtcbiAgICAgIGhvc3QgKz0gJzonICsgdGhpcy5wb3J0O1xuICAgIH1cbiAgfVxuXG4gIGlmICh0aGlzLnF1ZXJ5ICYmXG4gICAgICB1dGlsLmlzT2JqZWN0KHRoaXMucXVlcnkpICYmXG4gICAgICBPYmplY3Qua2V5cyh0aGlzLnF1ZXJ5KS5sZW5ndGgpIHtcbiAgICBxdWVyeSA9IHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeSh0aGlzLnF1ZXJ5KTtcbiAgfVxuXG4gIHZhciBzZWFyY2ggPSB0aGlzLnNlYXJjaCB8fCAocXVlcnkgJiYgKCc/JyArIHF1ZXJ5KSkgfHwgJyc7XG5cbiAgaWYgKHByb3RvY29sICYmIHByb3RvY29sLnN1YnN0cigtMSkgIT09ICc6JykgcHJvdG9jb2wgKz0gJzonO1xuXG4gIC8vIG9ubHkgdGhlIHNsYXNoZWRQcm90b2NvbHMgZ2V0IHRoZSAvLy4gIE5vdCBtYWlsdG86LCB4bXBwOiwgZXRjLlxuICAvLyB1bmxlc3MgdGhleSBoYWQgdGhlbSB0byBiZWdpbiB3aXRoLlxuICBpZiAodGhpcy5zbGFzaGVzIHx8XG4gICAgICAoIXByb3RvY29sIHx8IHNsYXNoZWRQcm90b2NvbFtwcm90b2NvbF0pICYmIGhvc3QgIT09IGZhbHNlKSB7XG4gICAgaG9zdCA9ICcvLycgKyAoaG9zdCB8fCAnJyk7XG4gICAgaWYgKHBhdGhuYW1lICYmIHBhdGhuYW1lLmNoYXJBdCgwKSAhPT0gJy8nKSBwYXRobmFtZSA9ICcvJyArIHBhdGhuYW1lO1xuICB9IGVsc2UgaWYgKCFob3N0KSB7XG4gICAgaG9zdCA9ICcnO1xuICB9XG5cbiAgaWYgKGhhc2ggJiYgaGFzaC5jaGFyQXQoMCkgIT09ICcjJykgaGFzaCA9ICcjJyArIGhhc2g7XG4gIGlmIChzZWFyY2ggJiYgc2VhcmNoLmNoYXJBdCgwKSAhPT0gJz8nKSBzZWFyY2ggPSAnPycgKyBzZWFyY2g7XG5cbiAgcGF0aG5hbWUgPSBwYXRobmFtZS5yZXBsYWNlKC9bPyNdL2csIGZ1bmN0aW9uKG1hdGNoKSB7XG4gICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChtYXRjaCk7XG4gIH0pO1xuICBzZWFyY2ggPSBzZWFyY2gucmVwbGFjZSgnIycsICclMjMnKTtcblxuICByZXR1cm4gcHJvdG9jb2wgKyBob3N0ICsgcGF0aG5hbWUgKyBzZWFyY2ggKyBoYXNoO1xufTtcblxuZnVuY3Rpb24gdXJsUmVzb2x2ZShzb3VyY2UsIHJlbGF0aXZlKSB7XG4gIHJldHVybiB1cmxQYXJzZShzb3VyY2UsIGZhbHNlLCB0cnVlKS5yZXNvbHZlKHJlbGF0aXZlKTtcbn1cblxuVXJsLnByb3RvdHlwZS5yZXNvbHZlID0gZnVuY3Rpb24ocmVsYXRpdmUpIHtcbiAgcmV0dXJuIHRoaXMucmVzb2x2ZU9iamVjdCh1cmxQYXJzZShyZWxhdGl2ZSwgZmFsc2UsIHRydWUpKS5mb3JtYXQoKTtcbn07XG5cbmZ1bmN0aW9uIHVybFJlc29sdmVPYmplY3Qoc291cmNlLCByZWxhdGl2ZSkge1xuICBpZiAoIXNvdXJjZSkgcmV0dXJuIHJlbGF0aXZlO1xuICByZXR1cm4gdXJsUGFyc2Uoc291cmNlLCBmYWxzZSwgdHJ1ZSkucmVzb2x2ZU9iamVjdChyZWxhdGl2ZSk7XG59XG5cblVybC5wcm90b3R5cGUucmVzb2x2ZU9iamVjdCA9IGZ1bmN0aW9uKHJlbGF0aXZlKSB7XG4gIGlmICh1dGlsLmlzU3RyaW5nKHJlbGF0aXZlKSkge1xuICAgIHZhciByZWwgPSBuZXcgVXJsKCk7XG4gICAgcmVsLnBhcnNlKHJlbGF0aXZlLCBmYWxzZSwgdHJ1ZSk7XG4gICAgcmVsYXRpdmUgPSByZWw7XG4gIH1cblxuICB2YXIgcmVzdWx0ID0gbmV3IFVybCgpO1xuICB2YXIgdGtleXMgPSBPYmplY3Qua2V5cyh0aGlzKTtcbiAgZm9yICh2YXIgdGsgPSAwOyB0ayA8IHRrZXlzLmxlbmd0aDsgdGsrKykge1xuICAgIHZhciB0a2V5ID0gdGtleXNbdGtdO1xuICAgIHJlc3VsdFt0a2V5XSA9IHRoaXNbdGtleV07XG4gIH1cblxuICAvLyBoYXNoIGlzIGFsd2F5cyBvdmVycmlkZGVuLCBubyBtYXR0ZXIgd2hhdC5cbiAgLy8gZXZlbiBocmVmPVwiXCIgd2lsbCByZW1vdmUgaXQuXG4gIHJlc3VsdC5oYXNoID0gcmVsYXRpdmUuaGFzaDtcblxuICAvLyBpZiB0aGUgcmVsYXRpdmUgdXJsIGlzIGVtcHR5LCB0aGVuIHRoZXJlJ3Mgbm90aGluZyBsZWZ0IHRvIGRvIGhlcmUuXG4gIGlmIChyZWxhdGl2ZS5ocmVmID09PSAnJykge1xuICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvLyBocmVmcyBsaWtlIC8vZm9vL2JhciBhbHdheXMgY3V0IHRvIHRoZSBwcm90b2NvbC5cbiAgaWYgKHJlbGF0aXZlLnNsYXNoZXMgJiYgIXJlbGF0aXZlLnByb3RvY29sKSB7XG4gICAgLy8gdGFrZSBldmVyeXRoaW5nIGV4Y2VwdCB0aGUgcHJvdG9jb2wgZnJvbSByZWxhdGl2ZVxuICAgIHZhciBya2V5cyA9IE9iamVjdC5rZXlzKHJlbGF0aXZlKTtcbiAgICBmb3IgKHZhciByayA9IDA7IHJrIDwgcmtleXMubGVuZ3RoOyByaysrKSB7XG4gICAgICB2YXIgcmtleSA9IHJrZXlzW3JrXTtcbiAgICAgIGlmIChya2V5ICE9PSAncHJvdG9jb2wnKVxuICAgICAgICByZXN1bHRbcmtleV0gPSByZWxhdGl2ZVtya2V5XTtcbiAgICB9XG5cbiAgICAvL3VybFBhcnNlIGFwcGVuZHMgdHJhaWxpbmcgLyB0byB1cmxzIGxpa2UgaHR0cDovL3d3dy5leGFtcGxlLmNvbVxuICAgIGlmIChzbGFzaGVkUHJvdG9jb2xbcmVzdWx0LnByb3RvY29sXSAmJlxuICAgICAgICByZXN1bHQuaG9zdG5hbWUgJiYgIXJlc3VsdC5wYXRobmFtZSkge1xuICAgICAgcmVzdWx0LnBhdGggPSByZXN1bHQucGF0aG5hbWUgPSAnLyc7XG4gICAgfVxuXG4gICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGlmIChyZWxhdGl2ZS5wcm90b2NvbCAmJiByZWxhdGl2ZS5wcm90b2NvbCAhPT0gcmVzdWx0LnByb3RvY29sKSB7XG4gICAgLy8gaWYgaXQncyBhIGtub3duIHVybCBwcm90b2NvbCwgdGhlbiBjaGFuZ2luZ1xuICAgIC8vIHRoZSBwcm90b2NvbCBkb2VzIHdlaXJkIHRoaW5nc1xuICAgIC8vIGZpcnN0LCBpZiBpdCdzIG5vdCBmaWxlOiwgdGhlbiB3ZSBNVVNUIGhhdmUgYSBob3N0LFxuICAgIC8vIGFuZCBpZiB0aGVyZSB3YXMgYSBwYXRoXG4gICAgLy8gdG8gYmVnaW4gd2l0aCwgdGhlbiB3ZSBNVVNUIGhhdmUgYSBwYXRoLlxuICAgIC8vIGlmIGl0IGlzIGZpbGU6LCB0aGVuIHRoZSBob3N0IGlzIGRyb3BwZWQsXG4gICAgLy8gYmVjYXVzZSB0aGF0J3Mga25vd24gdG8gYmUgaG9zdGxlc3MuXG4gICAgLy8gYW55dGhpbmcgZWxzZSBpcyBhc3N1bWVkIHRvIGJlIGFic29sdXRlLlxuICAgIGlmICghc2xhc2hlZFByb3RvY29sW3JlbGF0aXZlLnByb3RvY29sXSkge1xuICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhyZWxhdGl2ZSk7XG4gICAgICBmb3IgKHZhciB2ID0gMDsgdiA8IGtleXMubGVuZ3RoOyB2KyspIHtcbiAgICAgICAgdmFyIGsgPSBrZXlzW3ZdO1xuICAgICAgICByZXN1bHRba10gPSByZWxhdGl2ZVtrXTtcbiAgICAgIH1cbiAgICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICByZXN1bHQucHJvdG9jb2wgPSByZWxhdGl2ZS5wcm90b2NvbDtcbiAgICBpZiAoIXJlbGF0aXZlLmhvc3QgJiYgIWhvc3RsZXNzUHJvdG9jb2xbcmVsYXRpdmUucHJvdG9jb2xdKSB7XG4gICAgICB2YXIgcmVsUGF0aCA9IChyZWxhdGl2ZS5wYXRobmFtZSB8fCAnJykuc3BsaXQoJy8nKTtcbiAgICAgIHdoaWxlIChyZWxQYXRoLmxlbmd0aCAmJiAhKHJlbGF0aXZlLmhvc3QgPSByZWxQYXRoLnNoaWZ0KCkpKTtcbiAgICAgIGlmICghcmVsYXRpdmUuaG9zdCkgcmVsYXRpdmUuaG9zdCA9ICcnO1xuICAgICAgaWYgKCFyZWxhdGl2ZS5ob3N0bmFtZSkgcmVsYXRpdmUuaG9zdG5hbWUgPSAnJztcbiAgICAgIGlmIChyZWxQYXRoWzBdICE9PSAnJykgcmVsUGF0aC51bnNoaWZ0KCcnKTtcbiAgICAgIGlmIChyZWxQYXRoLmxlbmd0aCA8IDIpIHJlbFBhdGgudW5zaGlmdCgnJyk7XG4gICAgICByZXN1bHQucGF0aG5hbWUgPSByZWxQYXRoLmpvaW4oJy8nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnBhdGhuYW1lID0gcmVsYXRpdmUucGF0aG5hbWU7XG4gICAgfVxuICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7XG4gICAgcmVzdWx0Lmhvc3QgPSByZWxhdGl2ZS5ob3N0IHx8ICcnO1xuICAgIHJlc3VsdC5hdXRoID0gcmVsYXRpdmUuYXV0aDtcbiAgICByZXN1bHQuaG9zdG5hbWUgPSByZWxhdGl2ZS5ob3N0bmFtZSB8fCByZWxhdGl2ZS5ob3N0O1xuICAgIHJlc3VsdC5wb3J0ID0gcmVsYXRpdmUucG9ydDtcbiAgICAvLyB0byBzdXBwb3J0IGh0dHAucmVxdWVzdFxuICAgIGlmIChyZXN1bHQucGF0aG5hbWUgfHwgcmVzdWx0LnNlYXJjaCkge1xuICAgICAgdmFyIHAgPSByZXN1bHQucGF0aG5hbWUgfHwgJyc7XG4gICAgICB2YXIgcyA9IHJlc3VsdC5zZWFyY2ggfHwgJyc7XG4gICAgICByZXN1bHQucGF0aCA9IHAgKyBzO1xuICAgIH1cbiAgICByZXN1bHQuc2xhc2hlcyA9IHJlc3VsdC5zbGFzaGVzIHx8IHJlbGF0aXZlLnNsYXNoZXM7XG4gICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHZhciBpc1NvdXJjZUFicyA9IChyZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nKSxcbiAgICAgIGlzUmVsQWJzID0gKFxuICAgICAgICAgIHJlbGF0aXZlLmhvc3QgfHxcbiAgICAgICAgICByZWxhdGl2ZS5wYXRobmFtZSAmJiByZWxhdGl2ZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJ1xuICAgICAgKSxcbiAgICAgIG11c3RFbmRBYnMgPSAoaXNSZWxBYnMgfHwgaXNTb3VyY2VBYnMgfHxcbiAgICAgICAgICAgICAgICAgICAgKHJlc3VsdC5ob3N0ICYmIHJlbGF0aXZlLnBhdGhuYW1lKSksXG4gICAgICByZW1vdmVBbGxEb3RzID0gbXVzdEVuZEFicyxcbiAgICAgIHNyY1BhdGggPSByZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLnNwbGl0KCcvJykgfHwgW10sXG4gICAgICByZWxQYXRoID0gcmVsYXRpdmUucGF0aG5hbWUgJiYgcmVsYXRpdmUucGF0aG5hbWUuc3BsaXQoJy8nKSB8fCBbXSxcbiAgICAgIHBzeWNob3RpYyA9IHJlc3VsdC5wcm90b2NvbCAmJiAhc2xhc2hlZFByb3RvY29sW3Jlc3VsdC5wcm90b2NvbF07XG5cbiAgLy8gaWYgdGhlIHVybCBpcyBhIG5vbi1zbGFzaGVkIHVybCwgdGhlbiByZWxhdGl2ZVxuICAvLyBsaW5rcyBsaWtlIC4uLy4uIHNob3VsZCBiZSBhYmxlXG4gIC8vIHRvIGNyYXdsIHVwIHRvIHRoZSBob3N0bmFtZSwgYXMgd2VsbC4gIFRoaXMgaXMgc3RyYW5nZS5cbiAgLy8gcmVzdWx0LnByb3RvY29sIGhhcyBhbHJlYWR5IGJlZW4gc2V0IGJ5IG5vdy5cbiAgLy8gTGF0ZXIgb24sIHB1dCB0aGUgZmlyc3QgcGF0aCBwYXJ0IGludG8gdGhlIGhvc3QgZmllbGQuXG4gIGlmIChwc3ljaG90aWMpIHtcbiAgICByZXN1bHQuaG9zdG5hbWUgPSAnJztcbiAgICByZXN1bHQucG9ydCA9IG51bGw7XG4gICAgaWYgKHJlc3VsdC5ob3N0KSB7XG4gICAgICBpZiAoc3JjUGF0aFswXSA9PT0gJycpIHNyY1BhdGhbMF0gPSByZXN1bHQuaG9zdDtcbiAgICAgIGVsc2Ugc3JjUGF0aC51bnNoaWZ0KHJlc3VsdC5ob3N0KTtcbiAgICB9XG4gICAgcmVzdWx0Lmhvc3QgPSAnJztcbiAgICBpZiAocmVsYXRpdmUucHJvdG9jb2wpIHtcbiAgICAgIHJlbGF0aXZlLmhvc3RuYW1lID0gbnVsbDtcbiAgICAgIHJlbGF0aXZlLnBvcnQgPSBudWxsO1xuICAgICAgaWYgKHJlbGF0aXZlLmhvc3QpIHtcbiAgICAgICAgaWYgKHJlbFBhdGhbMF0gPT09ICcnKSByZWxQYXRoWzBdID0gcmVsYXRpdmUuaG9zdDtcbiAgICAgICAgZWxzZSByZWxQYXRoLnVuc2hpZnQocmVsYXRpdmUuaG9zdCk7XG4gICAgICB9XG4gICAgICByZWxhdGl2ZS5ob3N0ID0gbnVsbDtcbiAgICB9XG4gICAgbXVzdEVuZEFicyA9IG11c3RFbmRBYnMgJiYgKHJlbFBhdGhbMF0gPT09ICcnIHx8IHNyY1BhdGhbMF0gPT09ICcnKTtcbiAgfVxuXG4gIGlmIChpc1JlbEFicykge1xuICAgIC8vIGl0J3MgYWJzb2x1dGUuXG4gICAgcmVzdWx0Lmhvc3QgPSAocmVsYXRpdmUuaG9zdCB8fCByZWxhdGl2ZS5ob3N0ID09PSAnJykgP1xuICAgICAgICAgICAgICAgICAgcmVsYXRpdmUuaG9zdCA6IHJlc3VsdC5ob3N0O1xuICAgIHJlc3VsdC5ob3N0bmFtZSA9IChyZWxhdGl2ZS5ob3N0bmFtZSB8fCByZWxhdGl2ZS5ob3N0bmFtZSA9PT0gJycpID9cbiAgICAgICAgICAgICAgICAgICAgICByZWxhdGl2ZS5ob3N0bmFtZSA6IHJlc3VsdC5ob3N0bmFtZTtcbiAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoO1xuICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5O1xuICAgIHNyY1BhdGggPSByZWxQYXRoO1xuICAgIC8vIGZhbGwgdGhyb3VnaCB0byB0aGUgZG90LWhhbmRsaW5nIGJlbG93LlxuICB9IGVsc2UgaWYgKHJlbFBhdGgubGVuZ3RoKSB7XG4gICAgLy8gaXQncyByZWxhdGl2ZVxuICAgIC8vIHRocm93IGF3YXkgdGhlIGV4aXN0aW5nIGZpbGUsIGFuZCB0YWtlIHRoZSBuZXcgcGF0aCBpbnN0ZWFkLlxuICAgIGlmICghc3JjUGF0aCkgc3JjUGF0aCA9IFtdO1xuICAgIHNyY1BhdGgucG9wKCk7XG4gICAgc3JjUGF0aCA9IHNyY1BhdGguY29uY2F0KHJlbFBhdGgpO1xuICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7XG4gIH0gZWxzZSBpZiAoIXV0aWwuaXNOdWxsT3JVbmRlZmluZWQocmVsYXRpdmUuc2VhcmNoKSkge1xuICAgIC8vIGp1c3QgcHVsbCBvdXQgdGhlIHNlYXJjaC5cbiAgICAvLyBsaWtlIGhyZWY9Jz9mb28nLlxuICAgIC8vIFB1dCB0aGlzIGFmdGVyIHRoZSBvdGhlciB0d28gY2FzZXMgYmVjYXVzZSBpdCBzaW1wbGlmaWVzIHRoZSBib29sZWFuc1xuICAgIGlmIChwc3ljaG90aWMpIHtcbiAgICAgIHJlc3VsdC5ob3N0bmFtZSA9IHJlc3VsdC5ob3N0ID0gc3JjUGF0aC5zaGlmdCgpO1xuICAgICAgLy9vY2NhdGlvbmFseSB0aGUgYXV0aCBjYW4gZ2V0IHN0dWNrIG9ubHkgaW4gaG9zdFxuICAgICAgLy90aGlzIGVzcGVjaWFsbHkgaGFwcGVucyBpbiBjYXNlcyBsaWtlXG4gICAgICAvL3VybC5yZXNvbHZlT2JqZWN0KCdtYWlsdG86bG9jYWwxQGRvbWFpbjEnLCAnbG9jYWwyQGRvbWFpbjInKVxuICAgICAgdmFyIGF1dGhJbkhvc3QgPSByZXN1bHQuaG9zdCAmJiByZXN1bHQuaG9zdC5pbmRleE9mKCdAJykgPiAwID9cbiAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3Quc3BsaXQoJ0AnKSA6IGZhbHNlO1xuICAgICAgaWYgKGF1dGhJbkhvc3QpIHtcbiAgICAgICAgcmVzdWx0LmF1dGggPSBhdXRoSW5Ib3N0LnNoaWZ0KCk7XG4gICAgICAgIHJlc3VsdC5ob3N0ID0gcmVzdWx0Lmhvc3RuYW1lID0gYXV0aEluSG9zdC5zaGlmdCgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoO1xuICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5O1xuICAgIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3RcbiAgICBpZiAoIXV0aWwuaXNOdWxsKHJlc3VsdC5wYXRobmFtZSkgfHwgIXV0aWwuaXNOdWxsKHJlc3VsdC5zZWFyY2gpKSB7XG4gICAgICByZXN1bHQucGF0aCA9IChyZXN1bHQucGF0aG5hbWUgPyByZXN1bHQucGF0aG5hbWUgOiAnJykgK1xuICAgICAgICAgICAgICAgICAgICAocmVzdWx0LnNlYXJjaCA/IHJlc3VsdC5zZWFyY2ggOiAnJyk7XG4gICAgfVxuICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBpZiAoIXNyY1BhdGgubGVuZ3RoKSB7XG4gICAgLy8gbm8gcGF0aCBhdCBhbGwuICBlYXN5LlxuICAgIC8vIHdlJ3ZlIGFscmVhZHkgaGFuZGxlZCB0aGUgb3RoZXIgc3R1ZmYgYWJvdmUuXG4gICAgcmVzdWx0LnBhdGhuYW1lID0gbnVsbDtcbiAgICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0XG4gICAgaWYgKHJlc3VsdC5zZWFyY2gpIHtcbiAgICAgIHJlc3VsdC5wYXRoID0gJy8nICsgcmVzdWx0LnNlYXJjaDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnBhdGggPSBudWxsO1xuICAgIH1cbiAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8gaWYgYSB1cmwgRU5EcyBpbiAuIG9yIC4uLCB0aGVuIGl0IG11c3QgZ2V0IGEgdHJhaWxpbmcgc2xhc2guXG4gIC8vIGhvd2V2ZXIsIGlmIGl0IGVuZHMgaW4gYW55dGhpbmcgZWxzZSBub24tc2xhc2h5LFxuICAvLyB0aGVuIGl0IG11c3QgTk9UIGdldCBhIHRyYWlsaW5nIHNsYXNoLlxuICB2YXIgbGFzdCA9IHNyY1BhdGguc2xpY2UoLTEpWzBdO1xuICB2YXIgaGFzVHJhaWxpbmdTbGFzaCA9IChcbiAgICAgIChyZXN1bHQuaG9zdCB8fCByZWxhdGl2ZS5ob3N0IHx8IHNyY1BhdGgubGVuZ3RoID4gMSkgJiZcbiAgICAgIChsYXN0ID09PSAnLicgfHwgbGFzdCA9PT0gJy4uJykgfHwgbGFzdCA9PT0gJycpO1xuXG4gIC8vIHN0cmlwIHNpbmdsZSBkb3RzLCByZXNvbHZlIGRvdWJsZSBkb3RzIHRvIHBhcmVudCBkaXJcbiAgLy8gaWYgdGhlIHBhdGggdHJpZXMgdG8gZ28gYWJvdmUgdGhlIHJvb3QsIGB1cGAgZW5kcyB1cCA+IDBcbiAgdmFyIHVwID0gMDtcbiAgZm9yICh2YXIgaSA9IHNyY1BhdGgubGVuZ3RoOyBpID49IDA7IGktLSkge1xuICAgIGxhc3QgPSBzcmNQYXRoW2ldO1xuICAgIGlmIChsYXN0ID09PSAnLicpIHtcbiAgICAgIHNyY1BhdGguc3BsaWNlKGksIDEpO1xuICAgIH0gZWxzZSBpZiAobGFzdCA9PT0gJy4uJykge1xuICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7XG4gICAgICB1cCsrO1xuICAgIH0gZWxzZSBpZiAodXApIHtcbiAgICAgIHNyY1BhdGguc3BsaWNlKGksIDEpO1xuICAgICAgdXAtLTtcbiAgICB9XG4gIH1cblxuICAvLyBpZiB0aGUgcGF0aCBpcyBhbGxvd2VkIHRvIGdvIGFib3ZlIHRoZSByb290LCByZXN0b3JlIGxlYWRpbmcgLi5zXG4gIGlmICghbXVzdEVuZEFicyAmJiAhcmVtb3ZlQWxsRG90cykge1xuICAgIGZvciAoOyB1cC0tOyB1cCkge1xuICAgICAgc3JjUGF0aC51bnNoaWZ0KCcuLicpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChtdXN0RW5kQWJzICYmIHNyY1BhdGhbMF0gIT09ICcnICYmXG4gICAgICAoIXNyY1BhdGhbMF0gfHwgc3JjUGF0aFswXS5jaGFyQXQoMCkgIT09ICcvJykpIHtcbiAgICBzcmNQYXRoLnVuc2hpZnQoJycpO1xuICB9XG5cbiAgaWYgKGhhc1RyYWlsaW5nU2xhc2ggJiYgKHNyY1BhdGguam9pbignLycpLnN1YnN0cigtMSkgIT09ICcvJykpIHtcbiAgICBzcmNQYXRoLnB1c2goJycpO1xuICB9XG5cbiAgdmFyIGlzQWJzb2x1dGUgPSBzcmNQYXRoWzBdID09PSAnJyB8fFxuICAgICAgKHNyY1BhdGhbMF0gJiYgc3JjUGF0aFswXS5jaGFyQXQoMCkgPT09ICcvJyk7XG5cbiAgLy8gcHV0IHRoZSBob3N0IGJhY2tcbiAgaWYgKHBzeWNob3RpYykge1xuICAgIHJlc3VsdC5ob3N0bmFtZSA9IHJlc3VsdC5ob3N0ID0gaXNBYnNvbHV0ZSA/ICcnIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyY1BhdGgubGVuZ3RoID8gc3JjUGF0aC5zaGlmdCgpIDogJyc7XG4gICAgLy9vY2NhdGlvbmFseSB0aGUgYXV0aCBjYW4gZ2V0IHN0dWNrIG9ubHkgaW4gaG9zdFxuICAgIC8vdGhpcyBlc3BlY2lhbGx5IGhhcHBlbnMgaW4gY2FzZXMgbGlrZVxuICAgIC8vdXJsLnJlc29sdmVPYmplY3QoJ21haWx0bzpsb2NhbDFAZG9tYWluMScsICdsb2NhbDJAZG9tYWluMicpXG4gICAgdmFyIGF1dGhJbkhvc3QgPSByZXN1bHQuaG9zdCAmJiByZXN1bHQuaG9zdC5pbmRleE9mKCdAJykgPiAwID9cbiAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0LnNwbGl0KCdAJykgOiBmYWxzZTtcbiAgICBpZiAoYXV0aEluSG9zdCkge1xuICAgICAgcmVzdWx0LmF1dGggPSBhdXRoSW5Ib3N0LnNoaWZ0KCk7XG4gICAgICByZXN1bHQuaG9zdCA9IHJlc3VsdC5ob3N0bmFtZSA9IGF1dGhJbkhvc3Quc2hpZnQoKTtcbiAgICB9XG4gIH1cblxuICBtdXN0RW5kQWJzID0gbXVzdEVuZEFicyB8fCAocmVzdWx0Lmhvc3QgJiYgc3JjUGF0aC5sZW5ndGgpO1xuXG4gIGlmIChtdXN0RW5kQWJzICYmICFpc0Fic29sdXRlKSB7XG4gICAgc3JjUGF0aC51bnNoaWZ0KCcnKTtcbiAgfVxuXG4gIGlmICghc3JjUGF0aC5sZW5ndGgpIHtcbiAgICByZXN1bHQucGF0aG5hbWUgPSBudWxsO1xuICAgIHJlc3VsdC5wYXRoID0gbnVsbDtcbiAgfSBlbHNlIHtcbiAgICByZXN1bHQucGF0aG5hbWUgPSBzcmNQYXRoLmpvaW4oJy8nKTtcbiAgfVxuXG4gIC8vdG8gc3VwcG9ydCByZXF1ZXN0Lmh0dHBcbiAgaWYgKCF1dGlsLmlzTnVsbChyZXN1bHQucGF0aG5hbWUpIHx8ICF1dGlsLmlzTnVsbChyZXN1bHQuc2VhcmNoKSkge1xuICAgIHJlc3VsdC5wYXRoID0gKHJlc3VsdC5wYXRobmFtZSA/IHJlc3VsdC5wYXRobmFtZSA6ICcnKSArXG4gICAgICAgICAgICAgICAgICAocmVzdWx0LnNlYXJjaCA/IHJlc3VsdC5zZWFyY2ggOiAnJyk7XG4gIH1cbiAgcmVzdWx0LmF1dGggPSByZWxhdGl2ZS5hdXRoIHx8IHJlc3VsdC5hdXRoO1xuICByZXN1bHQuc2xhc2hlcyA9IHJlc3VsdC5zbGFzaGVzIHx8IHJlbGF0aXZlLnNsYXNoZXM7XG4gIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuVXJsLnByb3RvdHlwZS5wYXJzZUhvc3QgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gIHZhciBwb3J0ID0gcG9ydFBhdHRlcm4uZXhlYyhob3N0KTtcbiAgaWYgKHBvcnQpIHtcbiAgICBwb3J0ID0gcG9ydFswXTtcbiAgICBpZiAocG9ydCAhPT0gJzonKSB7XG4gICAgICB0aGlzLnBvcnQgPSBwb3J0LnN1YnN0cigxKTtcbiAgICB9XG4gICAgaG9zdCA9IGhvc3Quc3Vic3RyKDAsIGhvc3QubGVuZ3RoIC0gcG9ydC5sZW5ndGgpO1xuICB9XG4gIGlmIChob3N0KSB0aGlzLmhvc3RuYW1lID0gaG9zdDtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/url/url.js\n");

/***/ }),

/***/ "./node_modules/url/util.js":
/*!**********************************!*\
  !*** ./node_modules/url/util.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nmodule.exports = {\n  isString: function(arg) {\n    return typeof(arg) === 'string';\n  },\n  isObject: function(arg) {\n    return typeof(arg) === 'object' && arg !== null;\n  },\n  isNull: function(arg) {\n    return arg === null;\n  },\n  isNullOrUndefined: function(arg) {\n    return arg == null;\n  }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdXJsL3V0aWwuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvdXJsL3V0aWwuanM/MzVlOCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc1N0cmluZzogZnVuY3Rpb24oYXJnKSB7XG4gICAgcmV0dXJuIHR5cGVvZihhcmcpID09PSAnc3RyaW5nJztcbiAgfSxcbiAgaXNPYmplY3Q6IGZ1bmN0aW9uKGFyZykge1xuICAgIHJldHVybiB0eXBlb2YoYXJnKSA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xuICB9LFxuICBpc051bGw6IGZ1bmN0aW9uKGFyZykge1xuICAgIHJldHVybiBhcmcgPT09IG51bGw7XG4gIH0sXG4gIGlzTnVsbE9yVW5kZWZpbmVkOiBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4gYXJnID09IG51bGw7XG4gIH1cbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/url/util.js\n");

/***/ })

}]);